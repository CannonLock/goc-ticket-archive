<!DOCTYPE html>
<html lang="en">
  <head>
  <base href="/">
    <title>[24159] FZU_NOVA&#58; ifdh process waits for data from samwebgpvm01.fnal.gov&#58;8480</title>    <meta charset="utf-8" />
    <meta name="verify-v1" content="na5IcAJsZVOfEkboRxuIiZ1zpZgnZiWra+nKcS7nA/o=" />
    <meta name="google-site-verification" content="DLrk3ft4s8b-S2TloLCL2LD_t6wcTjgSluf5pmiu2kA" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />
    <link href="https://ticket.opensciencegrid.org/rss" rel="alternate" type="application/rss+xml" title="GOC Ticket Update feed" />

    <style type="text/css">
      body {
        padding-top: 50px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
     #search {
            width: 300px;
     }

    </style>

<script src="https://code.jquery.com/jquery-3.0.0.js"></script>
<script src="https://code.jquery.com/jquery-migrate-3.0.1.js"></script>

   <link href="//netdna.bootstrapcdn.com/bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet"/>
    <script src="//netdna.bootstrapcdn.com/bootstrap/2.3.2/js/bootstrap.min.js"></script>

    <link href="//netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"/>
    <link href="//ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/themes/smoothness/jquery-ui.min.css" rel="stylesheet"/>
 <script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>


    <link href="//cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/css/select2.min.css" rel="stylesheet" />
    <script src="//cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/js/select2.min.js"></script>

    <link href="css/ticket.css" rel="stylesheet" />
    <script src="lib/jquery.cookie.js"></script>

    <link href="images/tag_orange.png" rel="icon" type="image/png"/>
    <script src='https://www.google.com/recaptcha/api.js'></script>
  </head>

  <body>
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>

            <a class="brand" style="padding: 6px 0px 0px 6px;" href="http://opensciencegrid.org"><img src="https://ticket.opensciencegrid.org/images/osglogo.40x30.png"/></a>
            <ul class="nav">
                <li class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown">GOC Ticket <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    <li><a href="https://my.opensciencegrid.org">MyOSG</a></li>
                    <li><a href="https://oim.opensciencegrid.org">OIM</a></li>
                    <li class="active"><a href="index">Ticket</a></li>
	<li class="divider"></li>
	<li><a href="http://repo.grid.iu.edu">Repo</a></li>
	<li class="divider"></li>
	<li><a href="http://blogs.grid.iu.edu">Blog</a></li>
                    <li><a href="http://display.grid.iu.edu">Display</a></li>
                    <li><a href="http://osggoc.blogspot.com/">News</a></li>
                    </ul>
                </li>
            </ul>
            <ul class="nav pull-right">
                <li><a href="https://ticket.opensciencegrid.org/sso/">Login</a></li>            </ul>

            <div class="nav-collapse">
                <ul class="nav">
			 <li id="menu_submit"><a href="https://ticket.opensciencegrid.org/submit">Submit</a></li><li id="menu_view" class="dropdown"><a href="\#" class="dropdown-toggle" data-toggle="dropdown">View <b class="caret"></b></a><ul class="dropdown-menu"><li id="submenu_listopen"><a href="https://ticket.opensciencegrid.org/list/open">Open Tickets</a></li><li id="submenu_listrecentclose"><a href="https://ticket.opensciencegrid.org/list/recentclose">Recently Closed Tickets</a></li><li class="divider"></li><li id="submenu_alltickets"><a href="https://ticket.opensciencegrid.org/search?q=&amp;sort=id">All Tickets</a></li></ul></li>                </ul>

                <form class="navbar-search pull-right" action="viewer">
                    <input id="search" type="text" name="id" class="search-query span2" placeholder="Search Ticket" value=""/>
                </form>
            </div>
        </div>
      </div>
    </div>

<script type='text/javascript' src='lib/jquery.timeago.js'></script>
<script type='text/javascript' src='lib/byte2size.js'></script>
<style>
#updates .toolbar {
position: relative;
margin-top: 0px;
top: -10px;
font-weight: normal;
}
#updates a.anchor {
position: relative;
top: -50px;
}
#updates .selected pre {
animation:selected 2s;
animation-iteration-count: 2;
animation-direction: alternate;
-webkit-animation:selected 2s; 
-webkit-animation-iteration-count: 2;
-webkit-animation-direction: alternate;
box-shadow: inset 1px 1px 20px #9ad;
border: 1px solid #9ab;
margin: 5px 0px;
padding-left: 10px;
}
@keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ab;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
@-webkit-keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ad;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
#updates pre {
background-color: inherit;
line-height: 15px;
padding: 5px;
}
#updates .header {
color: #999;
}
#updates .update_history pre {
background-color: #eee;
color: #666;
font-size: 85%;
}
#updates .clickable {
cursor: pointer;
}
#updates .clickable:hover {
color: #D98719;
}
#updates .meta_information pre {
background-color: #fed;
}
#similar_tickets {
max-height: 300px;
overflow-y: auto;
pointer-events: none;
padding: 5px;
background-color: #f4f4f4;
}
.btn-toolbar {
margin-bottom: 0;
height: 30px;
}
#peers {
position: fixed;
bottom: 0px;
right: 0px;
z-index: 100;
list-style: none;
padding: 5px 0px 0px 5px;
margin: 0px;
background-color: white;
box-shadow: 0px 0px 10px white;
}
#peers li {
background-color: #ccc;
color: #000;
display: inline-block;
padding: 5px 10px;
margin-right: 5px;
position: relative;
}
/*
#peers li:hover {
background-color: #999;
cursor: pointer;
}
*/
#peers span.ip {
padding-left: 5px;
color: #666;
}
#peers .new {
bottom: -30px;
}
/*
#peers .me {
background-color: red;
}
*/
</style>

<div class="container-fluid">
<ul id="peers"></ul>
<div class="alert alert-danger"><a class="close" href="#" data-dismiss="alert">&times;</a>By the end of May 2018, the ticketing system at https://ticket.opensciencegrid.org will be retired and support will be provided at https://support.opensciencegrid.org. Throughout this transition the support email (help@opensciencegrid.org) will be available as a point of contact.<br><br>                                                   
                                                                                                                                                                                   
Please see the service migration page for details: https://opensciencegrid.github.io/technology/policy/service-migrations-spring-2018/#ticket</div><div id="presence" class="pull-right"></div><div class="ticketgui"><script type="text/javascript" src="https://ticket.opensciencegrid.org/lib/checktab.js"></script>

<script>
var expanded = false;
function expand_description() {
    var desc = $(".description");
    if(!expanded) {
        expanded = true;
        //expand to minheight
        var min = 250;
        if(desc.height() < min) {
            desc.animate({height: min}, 200);
        }
    }
}

$(document).ready(function() {
    $("input[name='nad']").datepicker({
        dateFormat: 'yy-mm-dd'
    });
});

</script>



<style>
.form-horizontal .control-label {
padding-top: inherit;
font-size:90%;
color:#666;
}
label {
margin-bottom: 0px;
}
.controls {
line-height: 18px;
}
</style>
<form class="form-horizontal" action="https://ticket.opensciencegrid.org/viewer/updatebasic?id=24159" method="post">
<div class="page-header">
    <h3><span class="muted">24159</span> / FZU_NOVA&#58; ifdh process waits for data from samwebgpvm01.fnal.gov&#58;8480</h3>
</div>

<div class="row-fluid">
<div class="span5">
    <legend>Contact</legend>
    <div class="control-group">
        <label class="control-label">Full Name</label>
        <div class="controls">Petr Vokac</div>
    </div>
    <div class="control-group">
        <label class="control-label">Email</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">Phone</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">CC</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>

    <legend>Details</legend>
    <div class="control-group"><label class="control-label">Associated VO</label><div class="controls">Nova</div></div><div class="control-group"><label class="control-label">Submitted Via</label><div class="controls">GOC Ticket/submit</div></div><div class="control-group"><label class="control-label">Submitter</label><div class="controls">Petr Vokac</div></div><div class="control-group"><label class="control-label">Support Center</label><div class="controls">Fermilab_FIFE_Offsite</div></div>
    <div class="control-group">
        <label class="control-label">Ticket Type</label>
        <div class="controls"></div>
    </div>
    <div class="control-group">
        <label class="control-label">Priority</label>
        <div class="controls">Normal</div>
    </div>
    <div class="control-group">
        <label class="control-label">Status</label>
        <div class="controls">
Closed</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action</label>
        <div class="controls">WIP</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action Deadline</label>
        <div class="controls flag_red">2015-03-02</div>
    </div>

</div><!--span-->
<div class="span7">
    <legend>Assignees</legend>
    <div class="assignee" style="width: 60%">FNAL (Prod)&nbsp;<a target="_blank" href="https://fermi.service-now.com/nav_to.do?uri=incident.do?sys_id=INC000000509729">INC000000509729</a> <span class="muted"> / Ticket Exchange</span></div>    <br>

    <legend>Assignees</legend>
    TODO
    <br>

    <style>
legend.noborder {
border-bottom: none;
}
</style>

<div id="attachment-list"/>
<script>
$(function () {
    var first = true;
    $.getJSON("https://ticket.opensciencegrid.org/attachment/list?id=24159", function (files) {
        //console.dir(files);
        var html = "<table class=\"table table-condensed\">";
        $(files).each(function() {
            if(first) {
                first = false;
                html += "<legend class=\"noborder\">Attachmenets</legend>";
            }
            html += "<tr class=\"attachment\">";
            html += "<td><img src=\""+this.thumbnail_url+"\"/></td>";
            html += "<td><a href=\""+this.url+"\" target=\"_blank\">"+this.name+"</a></td>";
            html += "<td>"+bytesToSize(this.size, 1)+"</td>";
            html += "</tr>";
        });
        html += "</table>";
        $("#attachment-list").html(html);
    });
});

function download(url) {
    window.open(url, "_blank");
}
</script>


</div><!--span-->
</div><!--row-fluid-->


</form>

</div>
<div id="updates" style="clear: both;">
    <legend>Past Updates
    <div class="btn-toolbar pull-right toolbar">
        <div class="btn-group">
                <a class="btn btn-small" href="/24159?sort=up&"><i class="icon-arrow-up"></i> Sort</a>

        
        <a class="btn btn-small" href="/24159?expandall=true&">Expand Descriptions</a>        <a class="btn btn-small" target="_blank" href="mailto:osg@tick.globalnoc.iu.edu?subject=Open%20Science%20Grid%3A%20FZU_NOVA%26%2358%3B%20ifdh%20process%20waits%20for%20data%20from%20samwebgpvm01.fnal.gov%26%2358%3B8480%20ISSUE%3D24159%20PROJ%3D71"><i class="icon-envelope"></i> Update w/Email</a>
        </div>
    </div><!--btn-toolbar-->
    </legend>

    <div class='update_description'><i onclick="document.location='24159#1425065309'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-02-27T19:28:29+00:00">Feb 27, 2015 07:28 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1425065309">&nbsp;</a></div><pre>While ifdh does have timeouts and retries for connection problems, there is not however a timeout on
reading data, which has not historically been  a problem with SAM-web...I&#39;ll have to look into in
particular how to test this...

-- by mengel at Fri Feb 27 19&#58;27&#58;16 UTC 2015

[Other (must describe below)]
We were not able to trace the cause of the hung connections.

I have created a feature request for ifdh to add a timeout&#58; <a href='https&#58;//cdcvs.fnal.gov/redmine/issues/7977' target='_blank' rel='nofollow'>https&#58;//cdcvs.fnal.gov/redmine/issues/7977</a>
-- by  at Fri Feb 27 19&#58;27&#58;16 UTC 2015

GOCTX Source&#58; <a href='https&#58;//fermi.service-now.com/nav_to.do?uri=incident.do?sys_id=INC000000509729' target='_blank' rel='nofollow'>https&#58;//fermi.service-now.com/nav_to.do?uri=incident.do?sys_id=INC000000509729</a></pre></div><div class='update_description'><i onclick="document.location='24159#1425063049'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-02-27T18:50:49+00:00">Feb 27, 2015 06:50 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1425063049">&nbsp;</a></div><pre>[Other (must describe below)]
We were not able to trace the cause of the hung connections.

I have created a feature request for ifdh to add a timeout&#58; <a href='https&#58;//cdcvs.fnal.gov/redmine/issues/7977' target='_blank' rel='nofollow'>https&#58;//cdcvs.fnal.gov/redmine/issues/7977</a>
-- by  at Fri Feb 27 18&#58;49&#58;57 UTC 2015

GOCTX Source&#58; <a href='https&#58;//fermi.service-now.com/nav_to.do?uri=incident.do?sys_id=INC000000509729' target='_blank' rel='nofollow'>https&#58;//fermi.service-now.com/nav_to.do?uri=incident.do?sys_id=INC000000509729</a></pre></div><div class='update_description'><i onclick="document.location='24159#1425062632'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-02-27T18:43:52+00:00">Feb 27, 2015 06:43 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1425062632">&nbsp;</a></div><pre>I wasn&#39;t able to find anything useful in the logs at our end (not helped by all the http requests appearing to originate from the NAT gateway, making it hard to trace which worker they come from).

I&#39;m pretty sure it wasn&#39;t the autoblocker. NAT or other network weirdness seems a possible, but unprovable, cause.

Having a timeout on these operations is a very sensible suggestion.
-- by illingwo at Fri Feb 27 18&#58;42&#58;14 UTC 2015

GOCTX Source&#58; <a href='https&#58;//fermi.service-now.com/nav_to.do?uri=incident.do?sys_id=INC000000509729' target='_blank' rel='nofollow'>https&#58;//fermi.service-now.com/nav_to.do?uri=incident.do?sys_id=INC000000509729</a></pre></div><div class='update_description'><i onclick="document.location='24159#1425061492'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-02-27T18:24:52+00:00">Feb 27, 2015 06:24 PM UTC</time><a class="anchor" name="1425061492">&nbsp;</a></div><pre>I was asked by operators of our cluster to deal with &#34;idle&#34; NOvA jobs, so I killed stuck ifdh processes. So technically speaking this issue is now resolved.

I still don&#39;t know why ifdh did not get response from samwebgpvm01.fnal.gov in a first place. May be some useful information could be found in samweb cherrypy log files, but because this issue happened almost two weeks ago (and I don&#39;t know exact time) it is now probably too late to figure out what exactly caused stuck ifdh processes. My second suspect was our NAT gateway, but people who take care of this device just said that everything was OK.

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=Petr Vokac 975</pre></div><div class='update_description'><i onclick="document.location='24159#1425058235'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-02-27T17:30:35+00:00">Feb 27, 2015 05:30 PM UTC</time> by <b>Vince Neal</b><a class="anchor" name="1425058235">&nbsp;</a></div><pre>Greetings all,

It appears this issue may be resolved.  Can anyone confirm?

Thank you,
Vince</pre></div><div class='update_description'><i onclick="document.location='24159#1424656685'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-02-23T01:58:05+00:00">Feb 23, 2015 01:58 AM UTC</time><a class="anchor" name="1424656685">&nbsp;</a></div><pre>This doesn&#39;t seem like auto blocker issue, because TCP connection was successfully established and ~50 processes are still stuck in &#34;read&#34; call they made few days back (today I made some tests and ~12k ifdh requests sent within 5 minutes and they were served without any issue). I still don&#39;t know what exactly caused this behavior of ifdh processes a few days in the past at our FZU_NOVA site. Anyway I also looked in ifdh source code and I think it is a bit suboptimal - it never times out reading data from socket (or pipe) and I think that must lead to stuck ifdh process in case of an issue with network communication.

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=Petr Vokac 975</pre></div><div class='update_description'><i onclick="document.location='24159#1424559701'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-02-21T23:01:41+00:00">Feb 21, 2015 11:01 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1424559701">&nbsp;</a></div><pre>reply from&#58; neha@....

Hmm..just read this mail myself..

Looks like Leo decided to solve this one &#58;)

Sorry about this..

- Neha

On Feb 20, 2015, at 9&#58;47 PM, neha@....&#60;mailto&#58;neha@....&#62;
wrote&#58;

Iggffdffd

On Feb 20, 2015 7&#58;52 PM, Steven C Timm &#60;timm@....&#60;mailto&#58;timm@....&#62;&#62; wrote&#58;
I would advise checking with networking at Fermilab to see if there is an auto blocking situation going on here.. if there are too many off-site connections going from many nodes to samwebgpvm01 it could trigger the auto blocker.

Steve Timm

________________________________
From&#58; Fermilab Service Desk [fermi@....&#60;mailto&#58;fermi@....&#62;]
Sent&#58; Friday, February 20, 2015 7&#58;42 PM
To&#58; Paola Buitrago; tx+fermi_fp71@....&#60;mailto&#58;tx+fermi_fp71@....&#62;; Adam L Lyon; Neha Sharma; Gerard Bernabeu Altayo; Arthur E Kreymer; Bo Jayatilaka; Michael Gheith; Jeny Teheran; Michael H Kirby; Michael Diesburg; Nicholas Peregonow; Marko J. Slyz; Robert A Illingworth; Marc W Mengel; Erica Snider; Gabriele Garzoglio; Steven Jones; Steven C Timm; Kenneth Richard Herner; Andrew John Norman; Tanya Levshina; David Dykstra
Subject&#58; Incident INC000000509729 updated -- FZU_NOVA&#58; ifdh process waits for data from samwebgpvm01.fnal.gov&#60;<a href='http&#58;//samwebgpvm01.fnal.gov&#62' target='_blank' rel='nofollow'>http&#58;//samwebgpvm01.fnal.gov&#62</a>;&#58;8480

Incident INC000000509729&#60;<a href='https&#58;//fermi.service-now.com/nav_to.do?uri=incident.do%3Fsys_id=261c4e226f12f900000131012e3ee484%26sysparm_stack=incident_list.do%3Fsysparm_query=active=true&#62' target='_blank' rel='nofollow'>https&#58;//fermi.service-now.com/nav_to.do?uri=incident.do%3Fsys_id=261c4e226f12f900000131012e3ee484%26sysparm_stack=incident_list.do%3Fsysparm_query=active=true&#62</a>; comments have been updated.

Last update&#58;
2015-02-20 19&#58;41&#58;53 CST - Joe Boyd (Additional comments)
Assigning this over to the data handling folks hoping they can advise.

________________________________
Incident State&#58; Work in Progress
Caller&#58; cd-srv-goc-ops
<div id='show_1928403982' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_1928403982'>Assignment Group&#58; REX-DH-Support
Assigned To&#58; Robert Illingworth
Summary&#58;
Most of Nova jobs &#34;running&#34; at our site are stuck for a few days in execution of ifdh (it happened on February 14-18). I&#39;m not sure what caused this behavior, because if I execute same command now it finishes successfully, e.g.&#58;

[nova@aplex07 ~]$ export EXPERIMENT=nova
[nova@aplex07 ~]$ export LD_LIBRARY_PATH=/cvmfs/oasis.opensciencegrid.org/nova/externals/gcc/v4_9_1/Linux64bit+2.6-2.12/lib64&#60;<a href='http&#58;//oasis.opensciencegrid.org/nova/externals/gcc/v4_9_1/Linux64bit+2.6-2.12/lib64&#62' target='_blank' rel='nofollow'>http&#58;//oasis.opensciencegrid.org/nova/externals/gcc/v4_9_1/Linux64bit+2.6-2.12/lib64&#62</a>;
[nova@aplex07 ~]$ /cvmfs/oasis.opensciencegrid.org/nova/externals/ifdhc/v1_4_3a/Linux64bit+2.6-2.12-e6-prof/bin/ifdh&#60;<a href='http&#58;//oasis.opensciencegrid.org/nova/externals/ifdhc/v1_4_3a/Linux64bit+2.6-2.12-e6-prof/bin/ifdh&#62' target='_blank' rel='nofollow'>http&#58;//oasis.opensciencegrid.org/nova/externals/ifdhc/v1_4_3a/Linux64bit+2.6-2.12-e6-prof/bin/ifdh&#62</a>; findProject nsmayer-prod_fcl_FA14-10-03a_nd_genie_fhc_nonswap_QGSC_BERT_draining-20150216_154045_901561000 nova
<a href='http&#58;//samweb.fnal.gov&#58;8480/sam/nova/api/running/projects/nova/nsmayer-prod_fcl_FA14-10-03a_nd_genie_fhc_nonswap_QGSC_BERT_draining-20150216_154045_901561000' target='_blank' rel='nofollow'>http&#58;//samweb.fnal.gov&#58;8480/sam/nova/api/running/projects/nova/nsmayer-prod_fcl_FA14-10-03a_nd_genie_fhc_nonswap_QGSC_BERT_draining-20150216_154045_901561000</a>

Should I just kill all Nova jobs that are stuck and hope we will not face same issue again?

Few details about stuck processes&#58;

[nova@aplex07 ~]$ host aplex07.farm.particle.cz
aplex07.farm.particle.cz has address 172.16.12.7
aplex07.farm.particle.cz has IPv6 address 2001&#58;718&#58;1e01&#58;1717&#58;&#58;12&#58;7

[nova@aplex07 ~]$ ps -fu nova | grep ifdh
nova 28258 28250 0 Feb17 ? 00&#58;00&#58;00 ifdh locateFile neardet_genie_fhc_nonswap_geantonly_20000_r00000022_s60_FA14-10-03_v1_20141010_215652_hero4908.rc.fas.harvard.edu&#60;<a href='http&#58;//rc.fas.harvard.edu&#62' target='_blank' rel='nofollow'>http&#58;//rc.fas.harvard.edu&#62</a>;_1413062181_15203_0.sim.g4.root gsiftp

[nova@aplex07 ~]$ gdb -p 28258
(gdb) bt
#0 0x00000037cd4db4c0 in __read_nocancel () from /lib64/libc.so.6
#1 0x00002b94a57b67a7 in std&#58;&#58;__basic_file&#60;char&#62;&#58;&#58;xsgetn(char*, long) () at basic_file.cc&#58;292
#2 0x00002b94a57f20f0 in std&#58;&#58;basic_filebuf&#60;char, std&#58;&#58;char_traits&#60;char&#62; &#62;&#58;&#58;underflow() ()
at /home/garren/scratch/pe5/gcc/v4_9_1/build/Linux64bit+2.6-2.12/src/gcc-4.9.1/x86_64-unknown-linux-gnu/libstdc++-v3/include/bits/fstream.tcc&#58;235
#3 0x00002b94a57b015c in std&#58;&#58;basic_istream&#60;char, std&#58;&#58;char_traits&#60;char&#62; &#62;&#58;&#58;getline(char*, long, char) ()
at /home/garren/scratch/pe5/gcc/v4_9_1/build/Linux64bit+2.6-2.12/src/gcc-4.9.1/x86_64-unknown-linux-gnu/libstdc++-v3/include/streambuf&#58;344
#4 0x000000000041d6ae in ifdh_util_ns&#58;&#58;WebAPI&#58;&#58;WebAPI(std&#58;&#58;basic_string&#60;char, std&#58;&#58;char_traits&#60;char&#62;, std&#58;&#58;allocator&#60;char&#62; &#62;, int, std&#58;&#58;basic_string&#60;char, std&#58;&#58;char_traits&#60;char&#62;, std&#58;&#58;allocator&#60;char&#62; &#62;) () at WebAPI.cc&#58;298
#5 0x000000000040c04c in ifdh_ns&#58;&#58;do_url_2(int, __va_list_tag*) () at ifdh.cc&#58;320
#6 0x000000000040c7bc in ifdh_ns&#58;&#58;do_url_lst(int, ...) () at ifdh.cc&#58;362
#7 0x000000000040cc35 in ifdh_ns&#58;&#58;ifdh&#58;&#58;locateFile(std&#58;&#58;basic_string&#60;char, std&#58;&#58;char_traits&#60;char&#62;, std&#58;&#58;allocator&#60;char&#62; &#62;, std&#58;&#58;basic_string&#60;char, std&#58;&#58;char_traits&#60;char&#62;, std&#58;&#58;allocator&#60;char&#62; &#62;) () at ifdh.cc&#58;398
#8 0x0000000000406113 in main () at ifdh_main.cc&#58;42

[nova@aplex07 ~]$ lsof -p 28258
COMMAND PID USER FD TYPE DEVICE SIZE/OFF NODE NAME
ifdh 28258 nova cwd DIR 9,3 4096 18874575 /scratch/33020615.torque.farm.particle.cz/glide_DUMdiV/execute/dir_7346/overlay
ifdh 28258 nova rtd DIR 9,1 4096 2 /
ifdh 28258 nova txt REG 0,36 738254 24208866 /cvmfs/oasis.opensciencegrid.org/nova/externals/ifdhc/v1_4_3a/Linux64bit+2.6-2.12-e6-prof/bin/ifdh&#60;<a href='http&#58;//oasis.opensciencegrid.org/nova/externals/ifdhc/v1_4_3a/Linux64bit+2.6-2.12-e6-prof/bin/ifdh&#62' target='_blank' rel='nofollow'>http&#58;//oasis.opensciencegrid.org/nova/externals/ifdhc/v1_4_3a/Linux64bit+2.6-2.12-e6-prof/bin/ifdh&#62</a>;
ifdh 28258 nova mem REG 9,1 157032 1179698 /lib64/ld-2.12.so
ifdh 28258 nova mem REG 9,1 1926760 1180026 /lib64/libc-2.12.so
ifdh 28258 nova mem REG 9,1 145896 1180071 /lib64/libpthread-2.12.so
ifdh 28258 nova mem REG 9,1 22536 1180079 /lib64/libdl-2.12.so
ifdh 28258 nova mem REG 9,1 599392 1180073 /lib64/libm-2.12.so
ifdh 28258 nova mem REG 9,1 113952 1180081 /lib64/libresolv-2.12.so
ifdh 28258 nova mem REG 0,36 6734012 9913788 /cvmfs/oasis.opensciencegrid.org/nova/externals/gcc/v4_9_1/Linux64bit+2.6-2.12/lib64/libstdc++.so.6.0.20&#60;<a href='http&#58;//oasis.opensciencegrid.org/nova/externals/gcc/v4_9_1/Linux64bit+2.6-2.12/lib64/libstdc++.so.6.0.20&#62' target='_blank' rel='nofollow'>http&#58;//oasis.opensciencegrid.org/nova/externals/gcc/v4_9_1/Linux64bit+2.6-2.12/lib64/libstdc++.so.6.0.20&#62</a>;
ifdh 28258 nova mem REG 0,36 548600 9913767 /cvmfs/oasis.opensciencegrid.org/nova/externals/gcc/v4_9_1/Linux64bit+2.6-2.12/lib64/libgcc_s.so.1&#60;<a href='http&#58;//oasis.opensciencegrid.org/nova/externals/gcc/v4_9_1/Linux64bit+2.6-2.12/lib64/libgcc_s.so.1&#62' target='_blank' rel='nofollow'>http&#58;//oasis.opensciencegrid.org/nova/externals/gcc/v4_9_1/Linux64bit+2.6-2.12/lib64/libgcc_s.so.1&#62</a>;
ifdh 28258 nova mem REG 9,1 65928 1179751 /lib64/libnss_files-2.12.so
ifdh 28258 nova mem REG 9,1 27424 1179674 /lib64/libnss_dns-2.12.so
ifdh 28258 nova mem REG 9,1 32024 1180057 /lib64/libnss_sss.so.2
ifdh 28258 nova mem REG 9,1 6806312 524309 /var/lib/sss/mc/passwd
ifdh 28258 nova 0r CHR 1,3 0t0 3973 /dev/null
ifdh 28258 nova 1w FIFO 0,8 0t0 378314309 pipe
ifdh 28258 nova 2w REG 9,3 27684 18874566 /scratch/33020615.torque.farm.particle.cz/glide_DUMdiV/execute/dir_7346/jsb_tmp/JOBSUB_ERR_FILE
ifdh 28258 nova 3r REG 9,1 6806312 524309 /var/lib/sss/mc/passwd
ifdh 28258 nova 4u IPv4 378314416 0t0 TCP aplex07.farm.particle.cz&#58;57544-&#62;samwebgpvm01.fnal.gov&#60;<a href='http&#58;//samwebgpvm01.fnal.gov&#62' target='_blank' rel='nofollow'>http&#58;//samwebgpvm01.fnal.gov&#62</a>;&#58;8480 (ESTABLISHED)
ifdh 28258 nova 5u IPv4 378314416 0t0 TCP aplex07.farm.particle.cz&#58;57544-&#62;samwebgpvm01.fnal.gov&#60;<a href='http&#58;//samwebgpvm01.fnal.gov&#62' target='_blank' rel='nofollow'>http&#58;//samwebgpvm01.fnal.gov&#62</a>;&#58;8480 (ESTABLISHED)
ifdh 28258 nova 7w REG 9,3 0 18874560 /scratch/33020615.torque.farm.particle.cz/glide_DUMdiV/execute/dir_7346/_condor_stdout
ifdh 28258 nova 8w REG 9,3 0 18874561 /scratch/33020615.torque.farm.particle.cz/glide_DUMdiV/execute/dir_7346/_condor_stderr

[nova@aplex07 ~]$ strace -f -tt -p 28258
Process 28258 attached - interrupt to quit
21&#58;50&#58;17.802277 read(4, &#60;unfinished ...&#62;

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=Petr Vokac 975

</div><script type='text/javascript'>
        $('#show_1928403982').click(function() {
            $('#detail_1928403982').slideDown("normal");
            $('#show_1928403982').hide();
            $('#hide_1928403982').show();
        });
        $('#hide_1928403982').click(function() {
            $('#detail_1928403982').slideUp();
            $('#hide_1928403982').hide();
            $('#show_1928403982').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='24159#1424490644'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-02-21T03:50:44+00:00">Feb 21, 2015 03:50 AM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1424490644">&nbsp;</a></div><pre>reply from&#58; neha@....

Iggffdffd

On Feb 20, 2015 7&#58;52 PM, Steven C Timm &#60;timm@....&#62; wrote&#58;
I would advise checking with networking at Fermilab to see if there is an auto blocking situation going on here.. if there are too many off-site connections going from many nodes to samwebgpvm01 it could trigger the auto blocker.

Steve Timm

________________________________
From&#58; Fermilab Service Desk [fermi@....]
Sent&#58; Friday, February 20, 2015 7&#58;42 PM
To&#58; Paola Buitrago; tx+fermi_fp71@....; Adam L Lyon; Neha Sharma; Gerard Bernabeu Altayo; Arthur E Kreymer; Bo Jayatilaka; Michael Gheith; Jeny Teheran; Michael H Kirby; Michael Diesburg; Nicholas Peregonow; Marko J. Slyz; Robert A Illingworth; Marc W Mengel; Erica Snider; Gabriele Garzoglio; Steven Jones; Steven C Timm; Kenneth Richard Herner; Andrew John Norman; Tanya Levshina; David Dykstra
Subject&#58; Incident INC000000509729 updated -- FZU_NOVA&#58; ifdh process waits for data from samwebgpvm01.fnal.gov&#58;8480

Incident INC000000509729&#60;<a href='https&#58;//fermi.service-now.com/nav_to.do?uri=incident.do%3Fsys_id=261c4e226f12f900000131012e3ee484%26sysparm_stack=incident_list.do%3Fsysparm_query=active=true&#62' target='_blank' rel='nofollow'>https&#58;//fermi.service-now.com/nav_to.do?uri=incident.do%3Fsys_id=261c4e226f12f900000131012e3ee484%26sysparm_stack=incident_list.do%3Fsysparm_query=active=true&#62</a>; comments have been updated.

Last update&#58;
2015-02-20 19&#58;41&#58;53 CST - Joe Boyd (Additional comments)
Assigning this over to the data handling folks hoping they can advise.

________________________________
Incident State&#58; Work in Progress
Caller&#58; cd-srv-goc-ops
Assignment Group&#58; REX-DH-Support
Assigned To&#58; Robert Illingworth
Summary&#58;
Most of Nova jobs &#34;running&#34; at our site are stuck for a few days in execution of ifdh (it happened on February 14-18). I&#39;m not sure what caused this behavior, because if I execute same command now it finishes successfully, e.g.&#58;

[nova@aplex07 ~]$ export EXPERIMENT=nova
[nova@aplex07 ~]$ export LD_LIBRARY_PATH=/cvmfs/oasis.opensciencegrid.org/nova/externals/gcc/v4_9_1/Linux64bit+2.6-2.12/lib64
[nova@aplex07 ~]$ /cvmfs/oasis.opensciencegrid.org/nova/externals/ifdhc/v1_4_3a/Linux64bit+2.6-2.12-e6-prof/bin/ifdh findProject nsmayer-prod_fcl_FA14-10-03a_nd_genie_fhc_nonswap_QGSC_BERT_draining-20150216_154045_901561000 nova
<a href='http&#58;//samweb.fnal.gov&#58;8480/sam/nova/api/running/projects/nova/nsmayer-prod_fcl_FA14-10-03a_nd_genie_fhc_nonswap_QGSC_BERT_draining-20150216_154045_901561000' target='_blank' rel='nofollow'>http&#58;//samweb.fnal.gov&#58;8480/sam/nova/api/running/projects/nova/nsmayer-prod_fcl_FA14-10-03a_nd_genie_fhc_nonswap_QGSC_BERT_draining-20150216_154045_901561000</a>

Should I just kill all Nova jobs that are stuck and hope we will not face same issue again?
<div id='show_835897347' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_835897347'>
Few details about stuck processes&#58;

[nova@aplex07 ~]$ host aplex07.farm.particle.cz
aplex07.farm.particle.cz has address 172.16.12.7
aplex07.farm.particle.cz has IPv6 address 2001&#58;718&#58;1e01&#58;1717&#58;&#58;12&#58;7

[nova@aplex07 ~]$ ps -fu nova | grep ifdh
nova 28258 28250 0 Feb17 ? 00&#58;00&#58;00 ifdh locateFile neardet_genie_fhc_nonswap_geantonly_20000_r00000022_s60_FA14-10-03_v1_20141010_215652_hero4908.rc.fas.harvard.edu_1413062181_15203_0.sim.g4.root gsiftp

[nova@aplex07 ~]$ gdb -p 28258
(gdb) bt
#0 0x00000037cd4db4c0 in __read_nocancel () from /lib64/libc.so.6
#1 0x00002b94a57b67a7 in std&#58;&#58;__basic_file&#60;char&#62;&#58;&#58;xsgetn(char*, long) () at basic_file.cc&#58;292
#2 0x00002b94a57f20f0 in std&#58;&#58;basic_filebuf&#60;char, std&#58;&#58;char_traits&#60;char&#62; &#62;&#58;&#58;underflow() ()
at /home/garren/scratch/pe5/gcc/v4_9_1/build/Linux64bit+2.6-2.12/src/gcc-4.9.1/x86_64-unknown-linux-gnu/libstdc++-v3/include/bits/fstream.tcc&#58;235
#3 0x00002b94a57b015c in std&#58;&#58;basic_istream&#60;char, std&#58;&#58;char_traits&#60;char&#62; &#62;&#58;&#58;getline(char*, long, char) ()
at /home/garren/scratch/pe5/gcc/v4_9_1/build/Linux64bit+2.6-2.12/src/gcc-4.9.1/x86_64-unknown-linux-gnu/libstdc++-v3/include/streambuf&#58;344
#4 0x000000000041d6ae in ifdh_util_ns&#58;&#58;WebAPI&#58;&#58;WebAPI(std&#58;&#58;basic_string&#60;char, std&#58;&#58;char_traits&#60;char&#62;, std&#58;&#58;allocator&#60;char&#62; &#62;, int, std&#58;&#58;basic_string&#60;char, std&#58;&#58;char_traits&#60;char&#62;, std&#58;&#58;allocator&#60;char&#62; &#62;) () at WebAPI.cc&#58;298
#5 0x000000000040c04c in ifdh_ns&#58;&#58;do_url_2(int, __va_list_tag*) () at ifdh.cc&#58;320
#6 0x000000000040c7bc in ifdh_ns&#58;&#58;do_url_lst(int, ...) () at ifdh.cc&#58;362
#7 0x000000000040cc35 in ifdh_ns&#58;&#58;ifdh&#58;&#58;locateFile(std&#58;&#58;basic_string&#60;char, std&#58;&#58;char_traits&#60;char&#62;, std&#58;&#58;allocator&#60;char&#62; &#62;, std&#58;&#58;basic_string&#60;char, std&#58;&#58;char_traits&#60;char&#62;, std&#58;&#58;allocator&#60;char&#62; &#62;) () at ifdh.cc&#58;398
#8 0x0000000000406113 in main () at ifdh_main.cc&#58;42

[nova@aplex07 ~]$ lsof -p 28258
COMMAND PID USER FD TYPE DEVICE SIZE/OFF NODE NAME
ifdh 28258 nova cwd DIR 9,3 4096 18874575 /scratch/33020615.torque.farm.particle.cz/glide_DUMdiV/execute/dir_7346/overlay
ifdh 28258 nova rtd DIR 9,1 4096 2 /
ifdh 28258 nova txt REG 0,36 738254 24208866 /cvmfs/oasis.opensciencegrid.org/nova/externals/ifdhc/v1_4_3a/Linux64bit+2.6-2.12-e6-prof/bin/ifdh
ifdh 28258 nova mem REG 9,1 157032 1179698 /lib64/ld-2.12.so
ifdh 28258 nova mem REG 9,1 1926760 1180026 /lib64/libc-2.12.so
ifdh 28258 nova mem REG 9,1 145896 1180071 /lib64/libpthread-2.12.so
ifdh 28258 nova mem REG 9,1 22536 1180079 /lib64/libdl-2.12.so
ifdh 28258 nova mem REG 9,1 599392 1180073 /lib64/libm-2.12.so
ifdh 28258 nova mem REG 9,1 113952 1180081 /lib64/libresolv-2.12.so
ifdh 28258 nova mem REG 0,36 6734012 9913788 /cvmfs/oasis.opensciencegrid.org/nova/externals/gcc/v4_9_1/Linux64bit+2.6-2.12/lib64/libstdc++.so.6.0.20
ifdh 28258 nova mem REG 0,36 548600 9913767 /cvmfs/oasis.opensciencegrid.org/nova/externals/gcc/v4_9_1/Linux64bit+2.6-2.12/lib64/libgcc_s.so.1
ifdh 28258 nova mem REG 9,1 65928 1179751 /lib64/libnss_files-2.12.so
ifdh 28258 nova mem REG 9,1 27424 1179674 /lib64/libnss_dns-2.12.so
ifdh 28258 nova mem REG 9,1 32024 1180057 /lib64/libnss_sss.so.2
ifdh 28258 nova mem REG 9,1 6806312 524309 /var/lib/sss/mc/passwd
ifdh 28258 nova 0r CHR 1,3 0t0 3973 /dev/null
ifdh 28258 nova 1w FIFO 0,8 0t0 378314309 pipe
ifdh 28258 nova 2w REG 9,3 27684 18874566 /scratch/33020615.torque.farm.particle.cz/glide_DUMdiV/execute/dir_7346/jsb_tmp/JOBSUB_ERR_FILE
ifdh 28258 nova 3r REG 9,1 6806312 524309 /var/lib/sss/mc/passwd
ifdh 28258 nova 4u IPv4 378314416 0t0 TCP aplex07.farm.particle.cz&#58;57544-&#62;samwebgpvm01.fnal.gov&#58;8480 (ESTABLISHED)
ifdh 28258 nova 5u IPv4 378314416 0t0 TCP aplex07.farm.particle.cz&#58;57544-&#62;samwebgpvm01.fnal.gov&#58;8480 (ESTABLISHED)
ifdh 28258 nova 7w REG 9,3 0 18874560 /scratch/33020615.torque.farm.particle.cz/glide_DUMdiV/execute/dir_7346/_condor_stdout
ifdh 28258 nova 8w REG 9,3 0 18874561 /scratch/33020615.torque.farm.particle.cz/glide_DUMdiV/execute/dir_7346/_condor_stderr

[nova@aplex07 ~]$ strace -f -tt -p 28258
Process 28258 attached - interrupt to quit
21&#58;50&#58;17.802277 read(4, &#60;unfinished ...&#62;

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=Petr Vokac 975

</div><script type='text/javascript'>
        $('#show_835897347').click(function() {
            $('#detail_835897347').slideDown("normal");
            $('#show_835897347').hide();
            $('#hide_835897347').show();
        });
        $('#hide_835897347').click(function() {
            $('#detail_835897347').slideUp();
            $('#hide_835897347').hide();
            $('#show_835897347').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='24159#1424483738'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-02-21T01:55:38+00:00">Feb 21, 2015 01:55 AM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1424483738">&nbsp;</a></div><pre>reply from&#58; timm@....

I would advise checking with networking at Fermilab to see if there is an auto blocking situation going on here.. if there are too many off-site connections going from many nodes to samwebgpvm01 it could trigger the auto blocker.

Steve Timm

________________________________
From&#58; Fermilab Service Desk [fermi@....]
Sent&#58; Friday, February 20, 2015 7&#58;42 PM
To&#58; Paola Buitrago; tx+fermi_fp71@....; Adam L Lyon; Neha Sharma; Gerard Bernabeu Altayo; Arthur E Kreymer; Bo Jayatilaka; Michael Gheith; Jeny Teheran; Michael H Kirby; Michael Diesburg; Nicholas Peregonow; Marko J. Slyz; Robert A Illingworth; Marc W Mengel; Erica Snider; Gabriele Garzoglio; Steven Jones; Steven C Timm; Kenneth Richard Herner; Andrew John Norman; Tanya Levshina; David Dykstra
Subject&#58; Incident INC000000509729 updated -- FZU_NOVA&#58; ifdh process waits for data from samwebgpvm01.fnal.gov&#58;8480

Incident INC000000509729&#60;<a href='https&#58;//fermi.service-now.com/nav_to.do?uri=incident.do%3Fsys_id=261c4e226f12f900000131012e3ee484%26sysparm_stack=incident_list.do%3Fsysparm_query=active=true&#62' target='_blank' rel='nofollow'>https&#58;//fermi.service-now.com/nav_to.do?uri=incident.do%3Fsys_id=261c4e226f12f900000131012e3ee484%26sysparm_stack=incident_list.do%3Fsysparm_query=active=true&#62</a>; comments have been updated.

Last update&#58;
2015-02-20 19&#58;41&#58;53 CST - Joe Boyd (Additional comments)
Assigning this over to the data handling folks hoping they can advise.

________________________________
Incident State&#58; Work in Progress
Caller&#58; cd-srv-goc-ops
Assignment Group&#58; REX-DH-Support
Assigned To&#58; Robert Illingworth
Summary&#58;
Most of Nova jobs &#34;running&#34; at our site are stuck for a few days in execution of ifdh (it happened on February 14-18). I&#39;m not sure what caused this behavior, because if I execute same command now it finishes successfully, e.g.&#58;

[nova@aplex07 ~]$ export EXPERIMENT=nova
[nova@aplex07 ~]$ export LD_LIBRARY_PATH=/cvmfs/oasis.opensciencegrid.org/nova/externals/gcc/v4_9_1/Linux64bit+2.6-2.12/lib64
[nova@aplex07 ~]$ /cvmfs/oasis.opensciencegrid.org/nova/externals/ifdhc/v1_4_3a/Linux64bit+2.6-2.12-e6-prof/bin/ifdh findProject nsmayer-prod_fcl_FA14-10-03a_nd_genie_fhc_nonswap_QGSC_BERT_draining-20150216_154045_901561000 nova
<a href='http&#58;//samweb.fnal.gov&#58;8480/sam/nova/api/running/projects/nova/nsmayer-prod_fcl_FA14-10-03a_nd_genie_fhc_nonswap_QGSC_BERT_draining-20150216_154045_901561000' target='_blank' rel='nofollow'>http&#58;//samweb.fnal.gov&#58;8480/sam/nova/api/running/projects/nova/nsmayer-prod_fcl_FA14-10-03a_nd_genie_fhc_nonswap_QGSC_BERT_draining-20150216_154045_901561000</a>

Should I just kill all Nova jobs that are stuck and hope we will not face same issue again?

Few details about stuck processes&#58;

<div id='show_1946294530' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_1946294530'>[nova@aplex07 ~]$ host aplex07.farm.particle.cz
aplex07.farm.particle.cz has address 172.16.12.7
aplex07.farm.particle.cz has IPv6 address 2001&#58;718&#58;1e01&#58;1717&#58;&#58;12&#58;7

[nova@aplex07 ~]$ ps -fu nova | grep ifdh
nova 28258 28250 0 Feb17 ? 00&#58;00&#58;00 ifdh locateFile neardet_genie_fhc_nonswap_geantonly_20000_r00000022_s60_FA14-10-03_v1_20141010_215652_hero4908.rc.fas.harvard.edu_1413062181_15203_0.sim.g4.root gsiftp

[nova@aplex07 ~]$ gdb -p 28258
(gdb) bt
#0 0x00000037cd4db4c0 in __read_nocancel () from /lib64/libc.so.6
#1 0x00002b94a57b67a7 in std&#58;&#58;__basic_file&#60;char&#62;&#58;&#58;xsgetn(char*, long) () at basic_file.cc&#58;292
#2 0x00002b94a57f20f0 in std&#58;&#58;basic_filebuf&#60;char, std&#58;&#58;char_traits&#60;char&#62; &#62;&#58;&#58;underflow() ()
at /home/garren/scratch/pe5/gcc/v4_9_1/build/Linux64bit+2.6-2.12/src/gcc-4.9.1/x86_64-unknown-linux-gnu/libstdc++-v3/include/bits/fstream.tcc&#58;235
#3 0x00002b94a57b015c in std&#58;&#58;basic_istream&#60;char, std&#58;&#58;char_traits&#60;char&#62; &#62;&#58;&#58;getline(char*, long, char) ()
at /home/garren/scratch/pe5/gcc/v4_9_1/build/Linux64bit+2.6-2.12/src/gcc-4.9.1/x86_64-unknown-linux-gnu/libstdc++-v3/include/streambuf&#58;344
#4 0x000000000041d6ae in ifdh_util_ns&#58;&#58;WebAPI&#58;&#58;WebAPI(std&#58;&#58;basic_string&#60;char, std&#58;&#58;char_traits&#60;char&#62;, std&#58;&#58;allocator&#60;char&#62; &#62;, int, std&#58;&#58;basic_string&#60;char, std&#58;&#58;char_traits&#60;char&#62;, std&#58;&#58;allocator&#60;char&#62; &#62;) () at WebAPI.cc&#58;298
#5 0x000000000040c04c in ifdh_ns&#58;&#58;do_url_2(int, __va_list_tag*) () at ifdh.cc&#58;320
#6 0x000000000040c7bc in ifdh_ns&#58;&#58;do_url_lst(int, ...) () at ifdh.cc&#58;362
#7 0x000000000040cc35 in ifdh_ns&#58;&#58;ifdh&#58;&#58;locateFile(std&#58;&#58;basic_string&#60;char, std&#58;&#58;char_traits&#60;char&#62;, std&#58;&#58;allocator&#60;char&#62; &#62;, std&#58;&#58;basic_string&#60;char, std&#58;&#58;char_traits&#60;char&#62;, std&#58;&#58;allocator&#60;char&#62; &#62;) () at ifdh.cc&#58;398
#8 0x0000000000406113 in main () at ifdh_main.cc&#58;42

[nova@aplex07 ~]$ lsof -p 28258
COMMAND PID USER FD TYPE DEVICE SIZE/OFF NODE NAME
ifdh 28258 nova cwd DIR 9,3 4096 18874575 /scratch/33020615.torque.farm.particle.cz/glide_DUMdiV/execute/dir_7346/overlay
ifdh 28258 nova rtd DIR 9,1 4096 2 /
ifdh 28258 nova txt REG 0,36 738254 24208866 /cvmfs/oasis.opensciencegrid.org/nova/externals/ifdhc/v1_4_3a/Linux64bit+2.6-2.12-e6-prof/bin/ifdh
ifdh 28258 nova mem REG 9,1 157032 1179698 /lib64/ld-2.12.so
ifdh 28258 nova mem REG 9,1 1926760 1180026 /lib64/libc-2.12.so
ifdh 28258 nova mem REG 9,1 145896 1180071 /lib64/libpthread-2.12.so
ifdh 28258 nova mem REG 9,1 22536 1180079 /lib64/libdl-2.12.so
ifdh 28258 nova mem REG 9,1 599392 1180073 /lib64/libm-2.12.so
ifdh 28258 nova mem REG 9,1 113952 1180081 /lib64/libresolv-2.12.so
ifdh 28258 nova mem REG 0,36 6734012 9913788 /cvmfs/oasis.opensciencegrid.org/nova/externals/gcc/v4_9_1/Linux64bit+2.6-2.12/lib64/libstdc++.so.6.0.20
ifdh 28258 nova mem REG 0,36 548600 9913767 /cvmfs/oasis.opensciencegrid.org/nova/externals/gcc/v4_9_1/Linux64bit+2.6-2.12/lib64/libgcc_s.so.1
ifdh 28258 nova mem REG 9,1 65928 1179751 /lib64/libnss_files-2.12.so
ifdh 28258 nova mem REG 9,1 27424 1179674 /lib64/libnss_dns-2.12.so
ifdh 28258 nova mem REG 9,1 32024 1180057 /lib64/libnss_sss.so.2
ifdh 28258 nova mem REG 9,1 6806312 524309 /var/lib/sss/mc/passwd
ifdh 28258 nova 0r CHR 1,3 0t0 3973 /dev/null
ifdh 28258 nova 1w FIFO 0,8 0t0 378314309 pipe
ifdh 28258 nova 2w REG 9,3 27684 18874566 /scratch/33020615.torque.farm.particle.cz/glide_DUMdiV/execute/dir_7346/jsb_tmp/JOBSUB_ERR_FILE
ifdh 28258 nova 3r REG 9,1 6806312 524309 /var/lib/sss/mc/passwd
ifdh 28258 nova 4u IPv4 378314416 0t0 TCP aplex07.farm.particle.cz&#58;57544-&#62;samwebgpvm01.fnal.gov&#58;8480 (ESTABLISHED)
ifdh 28258 nova 5u IPv4 378314416 0t0 TCP aplex07.farm.particle.cz&#58;57544-&#62;samwebgpvm01.fnal.gov&#58;8480 (ESTABLISHED)
ifdh 28258 nova 7w REG 9,3 0 18874560 /scratch/33020615.torque.farm.particle.cz/glide_DUMdiV/execute/dir_7346/_condor_stdout
ifdh 28258 nova 8w REG 9,3 0 18874561 /scratch/33020615.torque.farm.particle.cz/glide_DUMdiV/execute/dir_7346/_condor_stderr

[nova@aplex07 ~]$ strace -f -tt -p 28258
Process 28258 attached - interrupt to quit
21&#58;50&#58;17.802277 read(4, &#60;unfinished ...&#62;

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=Petr Vokac 975

</div><script type='text/javascript'>
        $('#show_1946294530').click(function() {
            $('#detail_1946294530').slideDown("normal");
            $('#show_1946294530').hide();
            $('#hide_1946294530').show();
        });
        $('#hide_1946294530').click(function() {
            $('#detail_1946294530').slideUp();
            $('#hide_1946294530').hide();
            $('#show_1946294530').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='24159#1424482963'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-02-21T01:42:43+00:00">Feb 21, 2015 01:42 AM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1424482963">&nbsp;</a></div><pre>Assigning this over to the data handling folks hoping they can advise.
-- by boyd at Sat Feb 21 01&#58;41&#58;53 UTC 2015

GOCTX Source&#58; <a href='https&#58;//fermi.service-now.com/nav_to.do?uri=incident.do?sys_id=INC000000509729' target='_blank' rel='nofollow'>https&#58;//fermi.service-now.com/nav_to.do?uri=incident.do?sys_id=INC000000509729</a></pre></div><div class='update_description'><i onclick="document.location='24159#1424470515'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-02-20T22:15:15+00:00">Feb 20, 2015 10:15 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1424470515">&nbsp;</a></div><pre>Most of Nova jobs &#34;running&#34; at our site are stuck for a few days in execution of ifdh (it happened on February 14-18). I&#39;m not sure what caused this behavior, because if I execute same command now it finishes successfully, e.g.&#58;

[nova@aplex07 ~]$ export EXPERIMENT=nova
[nova@aplex07 ~]$ export LD_LIBRARY_PATH=/cvmfs/oasis.opensciencegrid.org/nova/externals/gcc/v4_9_1/Linux64bit+2.6-2.12/lib64
[nova@aplex07 ~]$ /cvmfs/oasis.opensciencegrid.org/nova/externals/ifdhc/v1_4_3a/Linux64bit+2.6-2.12-e6-prof/bin/ifdh findProject nsmayer-prod_fcl_FA14-10-03a_nd_genie_fhc_nonswap_QGSC_BERT_draining-20150216_154045_901561000 nova
<a href='http&#58;//samweb.fnal.gov&#58;8480/sam/nova/api/running/projects/nova/nsmayer-prod_fcl_FA14-10-03a_nd_genie_fhc_nonswap_QGSC_BERT_draining-20150216_154045_901561000' target='_blank' rel='nofollow'>http&#58;//samweb.fnal.gov&#58;8480/sam/nova/api/running/projects/nova/nsmayer-prod_fcl_FA14-10-03a_nd_genie_fhc_nonswap_QGSC_BERT_draining-20150216_154045_901561000</a>

Should I just kill all Nova jobs that are stuck and hope we will not face same issue again?

Few details about stuck processes&#58;

[nova@aplex07 ~]$ host aplex07.farm.particle.cz
aplex07.farm.particle.cz has address 172.16.12.7
aplex07.farm.particle.cz has IPv6 address 2001&#58;718&#58;1e01&#58;1717&#58;&#58;12&#58;7

[nova@aplex07 ~]$ ps -fu nova | grep ifdh
nova     28258 28250  0 Feb17 ?        00&#58;00&#58;00 ifdh locateFile neardet_genie_fhc_nonswap_geantonly_20000_r00000022_s60_FA14-10-03_v1_20141010_215652_hero4908.rc.fas.harvard.edu_1413062181_15203_0.sim.g4.root gsiftp

[nova@aplex07 ~]$ gdb -p 28258
(gdb) bt
#0  0x00000037cd4db4c0 in __read_nocancel () from /lib64/libc.so.6
#1  0x00002b94a57b67a7 in std&#58;&#58;__basic_file&#60;char&#62;&#58;&#58;xsgetn(char*, long) () at basic_file.cc&#58;292
#2  0x00002b94a57f20f0 in std&#58;&#58;basic_filebuf&#60;char, std&#58;&#58;char_traits&#60;char&#62; &#62;&#58;&#58;underflow() ()
at /home/garren/scratch/pe5/gcc/v4_9_1/build/Linux64bit+2.6-2.12/src/gcc-4.9.1/x86_64-unknown-linux-gnu/libstdc++-v3/include/bits/fstream.tcc&#58;235
#3  0x00002b94a57b015c in std&#58;&#58;basic_istream&#60;char, std&#58;&#58;char_traits&#60;char&#62; &#62;&#58;&#58;getline(char*, long, char) ()
at /home/garren/scratch/pe5/gcc/v4_9_1/build/Linux64bit+2.6-2.12/src/gcc-4.9.1/x86_64-unknown-linux-gnu/libstdc++-v3/include/streambuf&#58;344
#4  0x000000000041d6ae in ifdh_util_ns&#58;&#58;WebAPI&#58;&#58;WebAPI(std&#58;&#58;basic_string&#60;char, std&#58;&#58;char_traits&#60;char&#62;, std&#58;&#58;allocator&#60;char&#62; &#62;, int, std&#58;&#58;basic_string&#60;char, std&#58;&#58;char_traits&#60;char&#62;, std&#58;&#58;allocator&#60;char&#62; &#62;) () at WebAPI.cc&#58;298
#5  0x000000000040c04c in ifdh_ns&#58;&#58;do_url_2(int, __va_list_tag*) () at ifdh.cc&#58;320
#6  0x000000000040c7bc in ifdh_ns&#58;&#58;do_url_lst(int, ...) () at ifdh.cc&#58;362
#7  0x000000000040cc35 in ifdh_ns&#58;&#58;ifdh&#58;&#58;locateFile(std&#58;&#58;basic_string&#60;char, std&#58;&#58;char_traits&#60;char&#62;, std&#58;&#58;allocator&#60;char&#62; &#62;, std&#58;&#58;basic_string&#60;char, std&#58;&#58;char_traits&#60;char&#62;, std&#58;&#58;allocator&#60;char&#62; &#62;) () at ifdh.cc&#58;398
#8  0x0000000000406113 in main () at ifdh_main.cc&#58;42

[nova@aplex07 ~]$ lsof -p 28258
COMMAND   PID USER   FD   TYPE    DEVICE SIZE/OFF      NODE NAME
ifdh    28258 nova  cwd    DIR       9,3     4096  18874575 /scratch/33020615.torque.farm.particle.cz/glide_DUMdiV/execute/dir_7346/overlay
<div id='show_2003605722' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_2003605722'>ifdh    28258 nova  rtd    DIR       9,1     4096         2 /
ifdh    28258 nova  txt    REG      0,36   738254  24208866 /cvmfs/oasis.opensciencegrid.org/nova/externals/ifdhc/v1_4_3a/Linux64bit+2.6-2.12-e6-prof/bin/ifdh
ifdh    28258 nova  mem    REG       9,1   157032   1179698 /lib64/ld-2.12.so
ifdh    28258 nova  mem    REG       9,1  1926760   1180026 /lib64/libc-2.12.so
ifdh    28258 nova  mem    REG       9,1   145896   1180071 /lib64/libpthread-2.12.so
ifdh    28258 nova  mem    REG       9,1    22536   1180079 /lib64/libdl-2.12.so
ifdh    28258 nova  mem    REG       9,1   599392   1180073 /lib64/libm-2.12.so
ifdh    28258 nova  mem    REG       9,1   113952   1180081 /lib64/libresolv-2.12.so
ifdh    28258 nova  mem    REG      0,36  6734012   9913788 /cvmfs/oasis.opensciencegrid.org/nova/externals/gcc/v4_9_1/Linux64bit+2.6-2.12/lib64/libstdc++.so.6.0.20
ifdh    28258 nova  mem    REG      0,36   548600   9913767 /cvmfs/oasis.opensciencegrid.org/nova/externals/gcc/v4_9_1/Linux64bit+2.6-2.12/lib64/libgcc_s.so.1
ifdh    28258 nova  mem    REG       9,1    65928   1179751 /lib64/libnss_files-2.12.so
ifdh    28258 nova  mem    REG       9,1    27424   1179674 /lib64/libnss_dns-2.12.so
ifdh    28258 nova  mem    REG       9,1    32024   1180057 /lib64/libnss_sss.so.2
ifdh    28258 nova  mem    REG       9,1  6806312    524309 /var/lib/sss/mc/passwd
ifdh    28258 nova    0r   CHR       1,3      0t0      3973 /dev/null
ifdh    28258 nova    1w  FIFO       0,8      0t0 378314309 pipe
ifdh    28258 nova    2w   REG       9,3    27684  18874566 /scratch/33020615.torque.farm.particle.cz/glide_DUMdiV/execute/dir_7346/jsb_tmp/JOBSUB_ERR_FILE
ifdh    28258 nova    3r   REG       9,1  6806312    524309 /var/lib/sss/mc/passwd
ifdh    28258 nova    4u  IPv4 378314416      0t0       TCP aplex07.farm.particle.cz&#58;57544-&#62;samwebgpvm01.fnal.gov&#58;8480 (ESTABLISHED)
ifdh    28258 nova    5u  IPv4 378314416      0t0       TCP aplex07.farm.particle.cz&#58;57544-&#62;samwebgpvm01.fnal.gov&#58;8480 (ESTABLISHED)
ifdh    28258 nova    7w   REG       9,3        0  18874560 /scratch/33020615.torque.farm.particle.cz/glide_DUMdiV/execute/dir_7346/_condor_stdout
ifdh    28258 nova    8w   REG       9,3        0  18874561 /scratch/33020615.torque.farm.particle.cz/glide_DUMdiV/execute/dir_7346/_condor_stderr

[nova@aplex07 ~]$ strace -f -tt -p 28258
Process 28258 attached - interrupt to quit
21&#58;50&#58;17.802277 read(4, &#60;unfinished ...&#62;

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=Petr Vokac 975

</div><script type='text/javascript'>
        $('#show_2003605722').click(function() {
            $('#detail_2003605722').slideDown("normal");
            $('#show_2003605722').hide();
            $('#hide_2003605722').show();
        });
        $('#hide_2003605722').click(function() {
            $('#detail_2003605722').slideUp();
            $('#hide_2003605722').hide();
            $('#show_2003605722').show();
        });
        </script></pre></div><legend>Similar Recent Tickets <small>modified within the last 30 days</small></legend><div id="similar_tickets"><p class="muted">No similar tickets found.</p></div>
</div>
<script type="text/javascript">
function reset_anchor() {
    $("#updates .selected").removeClass("selected");
    var urls = document.location.toString().split('#'); 
    var anchor = urls[1];
    if(anchor) {
        $("a[name='"+anchor+"']").parents(".update_description").addClass("selected");
    }
}
function submitspam(ticket_id) {
    myret = confirm("Would you like to close this ticket as a security ticket, and submit the ticket content to akismet?");
    if(myret == true) {
        $.ajax("viewer/processspam?id="+ticket_id).done(function() {
            window.location.reload();
        });
    }
}

$(function() {
    reset_anchor();
    var ADDITIONAL_COOKIE_NAME = 'gocticket';
    var options = { path: '/', expires: 365};

    if(window.opener && window.opener.name == "gocticket_list") {
        v = $.cookie("closewindow");
        if(!v) {
            $("#closewindow").attr("checked", "checked"); //on by default
        } else {
            if(v == "checked") {
                $("#closewindow").attr("checked", "checked");
            }
        }
        $("#closewindow").click(function() {
            $.cookie("closewindow", $(this).attr('checked'), options);
        });
    } else {
        $("#closewindow_area").hide();
    }
    function updateTimeago() {
        $("time").timeago();
        setTimeout(updateTimeago, 30*1000);
    }
    updateTimeago();
    $(".description").focus(expand_description);
});
</script>
<hr/>
<footer>
<p>GOC Ticket Version 2.2 | <a href="https://ticket.opensciencegrid.org/goc/submit?app_issue_check=on&amp;app_issue_type=goc&amp;app_goc_url=https%3A%2F%2Fticket.opensciencegrid.org%3A443%2F24159">Report Bugs</a>
 | <a href="https://github.com/opensciencegrid/operations/blob/master/docs/privacy.md">Privacy Policy</a>
</p>

<p> <img align="top" src="/images/tag_orange.png"/> Copyright 2018 The Trustees of Indiana University - Developed for Open Science Grid</p>
</footer>


</div><!--container-fluid-->
<script src="https://ticket1.grid.iu.edu:8443/socket.io/socket.io.js"></script>
<script>
var chat = io.connect('https://ticket1.grid.iu.edu:8443');
chat.on('connect', function() {
    chat.emit('authenticate', {nodekey:'', ticketid: 24159});
});
chat.on('peers', function(peers) {
    $("#peers").html("");
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('peer_disconnect', function(pid) {
    $("#peer_"+pid).hide("slow");
});
chat.on('peer_connected', function(peers) {
    //expect only 1 peer connecting, but..
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('submit', function() {
    if(confirm("This ticket was updated. Do you want to refresh?")) {
        history.go(0);
    }
});

function addPeer(pid, peer) {
    var ipinfo = "";
    if(peer.ip != undefined) {
        ipinfo = "<span class=\"ip\">"+peer.ip+"</span>";
    }
    if(chat.io.engine.id == pid) {
        //don't display myself
        return;
    }
    var html = "<li class=\"new\" id=\"peer_"+pid+"\" class=\"peer\">"+peer.name+ipinfo+"</li>";
    $("#peers").prepend(html);
    $("#peers .new").animate({bottom: 0}, 1000, function() {$(this).removeClass("new")});
}

$(function() {
    $("#ticket_form").submit(function() {
        chat.emit('submit');
        return true;
    });
});
</script>
<script>
//used by searchbox
function parseValue(value) {
    var obj = new Object();
    var tokens = value.split("\t");
    obj.str = tokens[0];
    obj.count = tokens[1];
    return obj;
}

$(function() {
    //bootstrap-2.0.4 stuff
    $(".alert-message").alert();
    $(".dropdown-toggle").dropdown();
    $("span[rel='tooltip']").tooltip();
    $("a[rel=popover]").popover();

    //activate menu that user is currently on
    $("#menu_navigator").addClass("active"); 
    $("#submenu_").addClass("active"); 

    //translate zend validation error message to bootstrap
    $(".errors").addClass("alert").addClass("alert-error");

    //enable autocomplete for search box
    $("#search").autocomplete({
        source: function( request, response ) {
            $.ajax({
                url: "search/autocomplete",
                dataType: "text",
                data: {
                    //featureClass: "P",
                    //style: "full",
                    //maxRows: 12,
                    //name_startsWith: request.term
                    q: request.term
                },
                success: function( data ) {
                    response( $.map( data.split("\n"), function( item ) {
                        if(item == "") return null;
                        return {
                            value: item
                        }
                    }));
                }
            });
        },
        select: function(event, ui) {
            document.location = "search?q="+ui.item.value;
        }
    });
    
});
</script>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-69012-13");
pageTracker._trackPageview();
} catch(err) {}
</script>

</body>
