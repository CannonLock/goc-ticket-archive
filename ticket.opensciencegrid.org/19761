<!DOCTYPE html>
<html lang="en">
  <head>
  <base href="/">
    <title>[19761] VOMS-Admin&#58; Implication of having hostname in cert DN different than actual host/service name</title>    <meta charset="utf-8" />
    <meta name="verify-v1" content="na5IcAJsZVOfEkboRxuIiZ1zpZgnZiWra+nKcS7nA/o=" />
    <meta name="google-site-verification" content="DLrk3ft4s8b-S2TloLCL2LD_t6wcTjgSluf5pmiu2kA" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />
    <link href="https://ticket.opensciencegrid.org/rss" rel="alternate" type="application/rss+xml" title="GOC Ticket Update feed" />

    <style type="text/css">
      body {
        padding-top: 50px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
     #search {
            width: 300px;
     }

    </style>

<script src="https://code.jquery.com/jquery-3.0.0.js"></script>
<script src="https://code.jquery.com/jquery-migrate-3.0.1.js"></script>

   <link href="//netdna.bootstrapcdn.com/bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet"/>
    <script src="//netdna.bootstrapcdn.com/bootstrap/2.3.2/js/bootstrap.min.js"></script>

    <link href="//netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"/>
    <link href="//ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/themes/smoothness/jquery-ui.min.css" rel="stylesheet"/>
 <script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>


    <link href="//cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/css/select2.min.css" rel="stylesheet" />
    <script src="//cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/js/select2.min.js"></script>

    <link href="css/ticket.css" rel="stylesheet" />
    <script src="lib/jquery.cookie.js"></script>

    <link href="images/tag_orange.png" rel="icon" type="image/png"/>
    <script src='https://www.google.com/recaptcha/api.js'></script>
  </head>

  <body>
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>

            <a class="brand" style="padding: 6px 0px 0px 6px;" href="http://opensciencegrid.org"><img src="https://ticket.opensciencegrid.org/images/osglogo.40x30.png"/></a>
            <ul class="nav">
                <li class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown">GOC Ticket <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    <li><a href="https://my.opensciencegrid.org">MyOSG</a></li>
                    <li><a href="https://oim.opensciencegrid.org">OIM</a></li>
                    <li class="active"><a href="index">Ticket</a></li>
	<li class="divider"></li>
	<li><a href="http://repo.grid.iu.edu">Repo</a></li>
	<li class="divider"></li>
	<li><a href="http://blogs.grid.iu.edu">Blog</a></li>
                    <li><a href="http://display.grid.iu.edu">Display</a></li>
                    <li><a href="http://osggoc.blogspot.com/">News</a></li>
                    </ul>
                </li>
            </ul>
            <ul class="nav pull-right">
                <li><a href="https://ticket.opensciencegrid.org/sso/">Login</a></li>            </ul>

            <div class="nav-collapse">
                <ul class="nav">
			 <li id="menu_submit"><a href="https://ticket.opensciencegrid.org/submit">Submit</a></li><li id="menu_view" class="dropdown"><a href="\#" class="dropdown-toggle" data-toggle="dropdown">View <b class="caret"></b></a><ul class="dropdown-menu"><li id="submenu_listopen"><a href="https://ticket.opensciencegrid.org/list/open">Open Tickets</a></li><li id="submenu_listrecentclose"><a href="https://ticket.opensciencegrid.org/list/recentclose">Recently Closed Tickets</a></li><li class="divider"></li><li id="submenu_alltickets"><a href="https://ticket.opensciencegrid.org/search?q=&amp;sort=id">All Tickets</a></li></ul></li>                </ul>

                <form class="navbar-search pull-right" action="viewer">
                    <input id="search" type="text" name="id" class="search-query span2" placeholder="Search Ticket" value=""/>
                </form>
            </div>
        </div>
      </div>
    </div>

<script type='text/javascript' src='lib/jquery.timeago.js'></script>
<script type='text/javascript' src='lib/byte2size.js'></script>
<style>
#updates .toolbar {
position: relative;
margin-top: 0px;
top: -10px;
font-weight: normal;
}
#updates a.anchor {
position: relative;
top: -50px;
}
#updates .selected pre {
animation:selected 2s;
animation-iteration-count: 2;
animation-direction: alternate;
-webkit-animation:selected 2s; 
-webkit-animation-iteration-count: 2;
-webkit-animation-direction: alternate;
box-shadow: inset 1px 1px 20px #9ad;
border: 1px solid #9ab;
margin: 5px 0px;
padding-left: 10px;
}
@keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ab;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
@-webkit-keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ad;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
#updates pre {
background-color: inherit;
line-height: 15px;
padding: 5px;
}
#updates .header {
color: #999;
}
#updates .update_history pre {
background-color: #eee;
color: #666;
font-size: 85%;
}
#updates .clickable {
cursor: pointer;
}
#updates .clickable:hover {
color: #D98719;
}
#updates .meta_information pre {
background-color: #fed;
}
#similar_tickets {
max-height: 300px;
overflow-y: auto;
pointer-events: none;
padding: 5px;
background-color: #f4f4f4;
}
.btn-toolbar {
margin-bottom: 0;
height: 30px;
}
#peers {
position: fixed;
bottom: 0px;
right: 0px;
z-index: 100;
list-style: none;
padding: 5px 0px 0px 5px;
margin: 0px;
background-color: white;
box-shadow: 0px 0px 10px white;
}
#peers li {
background-color: #ccc;
color: #000;
display: inline-block;
padding: 5px 10px;
margin-right: 5px;
position: relative;
}
/*
#peers li:hover {
background-color: #999;
cursor: pointer;
}
*/
#peers span.ip {
padding-left: 5px;
color: #666;
}
#peers .new {
bottom: -30px;
}
/*
#peers .me {
background-color: red;
}
*/
</style>

<div class="container-fluid">
<ul id="peers"></ul>
<div class="alert alert-danger"><a class="close" href="#" data-dismiss="alert">&times;</a>By the end of May 2018, the ticketing system at https://ticket.opensciencegrid.org will be retired and support will be provided at https://support.opensciencegrid.org. Throughout this transition the support email (help@opensciencegrid.org) will be available as a point of contact.<br><br>                                                   
                                                                                                                                                                                   
Please see the service migration page for details: https://opensciencegrid.github.io/technology/policy/service-migrations-spring-2018/#ticket</div><div id="presence" class="pull-right"></div><div class="ticketgui"><script type="text/javascript" src="https://ticket.opensciencegrid.org/lib/checktab.js"></script>

<script>
var expanded = false;
function expand_description() {
    var desc = $(".description");
    if(!expanded) {
        expanded = true;
        //expand to minheight
        var min = 250;
        if(desc.height() < min) {
            desc.animate({height: min}, 200);
        }
    }
}

$(document).ready(function() {
    $("input[name='nad']").datepicker({
        dateFormat: 'yy-mm-dd'
    });
});

</script>



<style>
.form-horizontal .control-label {
padding-top: inherit;
font-size:90%;
color:#666;
}
label {
margin-bottom: 0px;
}
.controls {
line-height: 18px;
}
</style>
<form class="form-horizontal" action="https://ticket.opensciencegrid.org/viewer/updatebasic?id=19761" method="post">
<div class="page-header">
    <h3><span class="muted">19761</span> / VOMS-Admin&#58; Implication of having hostname in cert DN different than actual host/service name</h3>
</div>

<div class="row-fluid">
<div class="span5">
    <legend>Contact</legend>
    <div class="control-group">
        <label class="control-label">Full Name</label>
        <div class="controls">Neha Sharma</div>
    </div>
    <div class="control-group">
        <label class="control-label">Email</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">Phone</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">CC</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>

    <legend>Details</legend>
    <div class="control-group"><label class="control-label">Submitted Via</label><div class="controls">GOC Ticket/submit</div></div><div class="control-group"><label class="control-label">Submitter</label><div class="controls">Neha Sharma</div></div>
    <div class="control-group">
        <label class="control-label">Ticket Type</label>
        <div class="controls">Problem/Request</div>
    </div>
    <div class="control-group">
        <label class="control-label">Priority</label>
        <div class="controls">Normal</div>
    </div>
    <div class="control-group">
        <label class="control-label">Status</label>
        <div class="controls">
Closed</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action</label>
        <div class="controls">Software team waiting for developer</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action Deadline</label>
        <div class="controls flag_red">2014-03-19</div>
    </div>

</div><!--span-->
<div class="span7">
    <legend>Assignees</legend>
    <div class="assignee" style="width: 60%">Software Support (Triage) <span class="muted"> / OSG Software Team</span></div><div class="assignee" style="width: 60%">Carl Edquist <span class="muted"> / OSG Software Team</span></div><div class="assignee" style="width: 60%">Matyas Selmeci <span class="muted"> / OSG Software Team</span></div>    <br>

    <legend>Assignees</legend>
    TODO
    <br>

    <style>
legend.noborder {
border-bottom: none;
}
</style>

<div id="attachment-list"/>
<script>
$(function () {
    var first = true;
    $.getJSON("https://ticket.opensciencegrid.org/attachment/list?id=19761", function (files) {
        //console.dir(files);
        var html = "<table class=\"table table-condensed\">";
        $(files).each(function() {
            if(first) {
                first = false;
                html += "<legend class=\"noborder\">Attachmenets</legend>";
            }
            html += "<tr class=\"attachment\">";
            html += "<td><img src=\""+this.thumbnail_url+"\"/></td>";
            html += "<td><a href=\""+this.url+"\" target=\"_blank\">"+this.name+"</a></td>";
            html += "<td>"+bytesToSize(this.size, 1)+"</td>";
            html += "</tr>";
        });
        html += "</table>";
        $("#attachment-list").html(html);
    });
});

function download(url) {
    window.open(url, "_blank");
}
</script>


</div><!--span-->
</div><!--row-fluid-->


</form>

</div>
<div id="updates" style="clear: both;">
    <legend>Past Updates
    <div class="btn-toolbar pull-right toolbar">
        <div class="btn-group">
                <a class="btn btn-small" href="/19761?sort=up&"><i class="icon-arrow-up"></i> Sort</a>

        
        <a class="btn btn-small" href="/19761?expandall=true&">Expand Descriptions</a>        <a class="btn btn-small" target="_blank" href="mailto:osg@tick.globalnoc.iu.edu?subject=Open%20Science%20Grid%3A%20VOMS-Admin%26%2358%3B%20Implication%20of%20having%20hostname%20in%20cert%20DN%20different%20than%20actual%20host%2Fservice%20name%20ISSUE%3D19761%20PROJ%3D71"><i class="icon-envelope"></i> Update w/Email</a>
        </div>
    </div><!--btn-toolbar-->
    </legend>

    <div class='update_description'><i onclick="document.location='19761#1395179998'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-03-18T21:59:58+00:00">Mar 18, 2014 09:59 PM UTC</time><a class="anchor" name="1395179998">&nbsp;</a></div><pre>Neha,

I am closing this ticket. And if you want open a JIRA ticket for GUMS and include Security team.

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=Edgar Mauricio Fajardo Hernandez 2020</pre></div><div class='update_description'><i onclick="document.location='19761#1395167429'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-03-18T18:30:29+00:00">Mar 18, 2014 06:30 PM UTC</time> by <b>Matyas Selmeci</b><a class="anchor" name="1395167429">&nbsp;</a></div><pre>Hi Neha,
If you think GUMS should accept wildcard certificates, you should open up a JIRA ticket for it. However, that is something that ought to be discussed with the Security Team first.
-Mat</pre></div><div class='update_description'><i onclick="document.location='19761#1395157492'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-03-18T15:44:52+00:00">Mar 18, 2014 03:44 PM UTC</time> by <b>Neha Sharma</b><a class="anchor" name="1395157492">&nbsp;</a></div><pre>That is a perfectly valid question Edgar. VO member updates for all the VOs except des are configured to go against server that presents itself with a non-wildcard cert. Those work fine.

GUMS not working in this use case is a show stopper for us, so we have decided to drop using the wildcard cert.
You may close this ticket.

-Neha</pre></div><div class='update_description'><i onclick="document.location='19761#1395094367'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-03-17T22:12:47+00:00">Mar 17, 2014 10:12 PM UTC</time><a class="anchor" name="1395094367">&nbsp;</a></div><pre>Hi Neha,

This might be an stupid question. But have you tested that GUMS doesn&#39;t complain when you use a certificate without wildcards in here&#58;

<a href='https&#58;//cloudvoms.fnal.gov&#58;8443' target='_blank' rel='nofollow'>https&#58;//cloudvoms.fnal.gov&#58;8443</a>

I just want to make sure this is not a red herring.

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=Edgar Mauricio Fajardo Hernandez 2020</pre></div><div class='update_description'><i onclick="document.location='19761#1394824047'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-03-14T19:07:27+00:00">Mar 14, 2014 07:07 PM UTC</time> by <b>Tim Cartwright</b><a class="anchor" name="1394824047">&nbsp;</a></div><pre>Neha&#58; I am out on vacation next week, so I am turning this ticket over to Mat and Carl.</pre></div><div class='update_description'><i onclick="document.location='19761#1394821690'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-03-14T18:28:10+00:00">Mar 14, 2014 06:28 PM UTC</time> by <b>Neha Sharma</b><a class="anchor" name="1394821690">&nbsp;</a></div><pre>We have found that GUMS is not happy contacting a VOMS-Admin instance that presents a wildcard certificate.

VO member update fails with following error.

AxisFault
faultCode&#58; {<a href='http&#58;//xml.apache.org/axis/' target='_blank' rel='nofollow'>http&#58;//xml.apache.org/axis/</a>}HTTP
faultSubcode&#58;
faultString&#58; (404)Not Found
faultActor&#58;
faultNode&#58;
faultDetail&#58;
{}&#58;return code&#58; 404
...
...
The error message being - &#34;The requested resource () is not available&#34;

14 Mar 2014 11&#58;01&#58;04,132 [WARN ]&#58; User group update for des failed&#58; Couldn&#39;t retrieve users&#58; ; nested exception is&#58;
javax.net.ssl.SSLPeerUnverifiedException&#58; peer not authenticated
14 Mar 2014 11&#58;01&#58;04,336 [WARN ]&#58; User group update for des-archive failed&#58; Couldn&#39;t retrieve users&#58; ; nested exception is&#58;
javax.net.ssl.SSLPeerUnverifiedException&#58; peer not authenticated
14 Mar 2014 11&#58;01&#58;04,532 [WARN ]&#58; User group update for des-production failed&#58; Couldn&#39;t retrieve users&#58; ; nested exception is&#58;
javax.net.ssl.SSLPeerUnverifiedException&#58; peer not authenticated
14 Mar 2014 11&#58;01&#58;05,298 [WARN ]&#58;

Would appreciate help from OSG Software in learning what is it that makes GUMS unhappy?  - does it not like that hostname in the cert is &#34;*.fnal.gov&#34;

VOMS server is deployed here - <a href='https&#58;//cloudvoms.fnal.gov&#58;8443' target='_blank' rel='nofollow'>https&#58;//cloudvoms.fnal.gov&#58;8443</a>

Thanks
-Neha</pre></div><div class='update_description'><i onclick="document.location='19761#1394214511'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-03-07T17:48:31+00:00">Mar 7, 2014 05:48 PM UTC</time> by <b>Neha Sharma</b><a class="anchor" name="1394214511">&nbsp;</a></div><pre>That sounds good to me Tim. Will let you know (soon) when we have such a system available for testing by OSG Software team.

Thank you!
-Neha</pre></div><div class='update_description'><i onclick="document.location='19761#1394207941'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-03-07T15:59:01+00:00">Mar 7, 2014 03:59 PM UTC</time> by <b>Tim Cartwright</b><a class="anchor" name="1394207941">&nbsp;</a></div><pre>Neha, I am not sure what more that I can tell you. To confirm for sure that nothing else will be affected would likely take a fair amount of code review and testing. If you (all) are requesting that of the OSG Software team, we can talk to BrianB, set up a project, figure out effort, priorities, etc. I think that is more than you are looking for, though. At the end of the day, I think that the easiest approach is to make your system available for testing, announce a testing period, and let people (including us) try it. Call it crowd-sourcing, if you like!</pre></div><div class='update_description'><i onclick="document.location='19761#1394016479'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-03-05T10:47:59+00:00">Mar 5, 2014 10:47 AM UTC</time> by <b>Neha Sharma</b><a class="anchor" name="1394016479">&nbsp;</a></div><pre>Pasting the response from Andrei on this-

&#34;Hi,
on the VOMS Admin side nothing should break.
Also the LSC validation should go smooth on the voms-proxy-init client side. Let me know
if you have issues.
Cheers,
Andrea&#34;

Tim - I guess the only other confirmation I need is that there aren&#39;t any tools used by OSG Software or GOC whose functionality would be affected by this (configuring VOMS Admin server to use a wildcard certificate)

If this is confirmed, then we can go ahead and close this ticket.

Thanks
-Neha</pre></div><div class='update_description'><i onclick="document.location='19761#1393971564'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-03-04T22:19:24+00:00">Mar 4, 2014 10:19 PM UTC</time> by <b>Brian Lin</b><a class="anchor" name="1393971564">&nbsp;</a></div><pre>Tim&#58; Have you heard anything from Andrea Ceccanti?</pre></div><div class='update_description'><i onclick="document.location='19761#1393513631'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-02-27T15:07:11+00:00">Feb 27, 2014 03:07 PM UTC</time> by <b>Neha Sharma</b><a class="anchor" name="1393513631">&nbsp;</a></div><pre>Here are some more details on this&#58;

Hi Tim

Yes, we are still using 2.6.1

Just some more background info on this&#58;

We want to deploy VOMS Admin using wildcard cert to prevent users from seeing  &#34;This site is untrusted, are you sure you want to continue&#34;  type of warning messages when they try to access it (if they do not have the Digicert CA loaded in their browser)

We have a test server deployed here <a href='https&#58;//fgt5x1.fnal.gov&#58;8444/' target='_blank' rel='nofollow'>https&#58;//fgt5x1.fnal.gov&#58;8444/</a> . You should be able to access it (need your personal cert loaded in browser) and see what the cert looks like (it&#39;s cool &#58;)

So far, we have done the minimal test of user coming in without Digicert CA loaded in browser (and with it) and successfully being able to access the interface

I have on my list to do following additional tests&#58;

- voms-proxy-init (should work, but still should be tested)
- GUMS (vo member updates)
- edg-mkgridmap (should be able to generate gridmap-file)
- voms-sync (our replica with cms and goc&#39;s osg replica with our primary instance)
- lvs ha check up script

I created the ticket to see if we may have missed any test case&#58; if there was something internal to VOMS/VOMS-Admin that could break or if there were any tools used by GOC or in OSG Software package that could break..because of this change.

Thanks
-Neha</pre></div><div class='update_description'><i onclick="document.location='19761#1393512163'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-02-27T14:42:43+00:00">Feb 27, 2014 02:42 PM UTC</time> by <b>Tim Cartwright</b><a class="anchor" name="1393512163">&nbsp;</a></div><pre>I sent an out-of-ticket email to Andrea Ceccanti, the VOMS Admin developer, about this question. I have no idea myself ... I did not even know that wildcard certificates were possible.</pre></div><div class='update_description'><i onclick="document.location='19761#1393342484'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-02-25T15:34:44+00:00">Feb 25, 2014 03:34 PM UTC</time> by <b>Christopher Pipes</b><a class="anchor" name="1393342484">&nbsp;</a></div><pre>Hello Software Team,

Could you please review this and assist Neha?

Thanks,
Chris</pre></div><div class='update_description'><i onclick="document.location='19761#1393265347'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-02-24T18:09:07+00:00">Feb 24, 2014 06:09 PM UTC</time> by <b>Neha Sharma</b><a class="anchor" name="1393265347">&nbsp;</a></div><pre>Hi
We are looking in to things (any setup/scripts/tools) used/managed by GOC/OSG-Software that could be affected/break if we configure our VOMS Admin server to use a wildcard certificate (have *.fnal.gov as hostname in the DN instead of voms.fnal.gov)

If there is anything that you are aware of that depends on the hostname in DN of cert used by VOMS Admin server being same as the actual host/service name, please let us know

Thanks
-Neha</pre></div><legend>Similar Recent Tickets <small>modified within the last 30 days</small></legend><div id="similar_tickets"><p class="muted">No similar tickets found.</p></div>
</div>
<script type="text/javascript">
function reset_anchor() {
    $("#updates .selected").removeClass("selected");
    var urls = document.location.toString().split('#'); 
    var anchor = urls[1];
    if(anchor) {
        $("a[name='"+anchor+"']").parents(".update_description").addClass("selected");
    }
}
function submitspam(ticket_id) {
    myret = confirm("Would you like to close this ticket as a security ticket, and submit the ticket content to akismet?");
    if(myret == true) {
        $.ajax("viewer/processspam?id="+ticket_id).done(function() {
            window.location.reload();
        });
    }
}

$(function() {
    reset_anchor();
    var ADDITIONAL_COOKIE_NAME = 'gocticket';
    var options = { path: '/', expires: 365};

    if(window.opener && window.opener.name == "gocticket_list") {
        v = $.cookie("closewindow");
        if(!v) {
            $("#closewindow").attr("checked", "checked"); //on by default
        } else {
            if(v == "checked") {
                $("#closewindow").attr("checked", "checked");
            }
        }
        $("#closewindow").click(function() {
            $.cookie("closewindow", $(this).attr('checked'), options);
        });
    } else {
        $("#closewindow_area").hide();
    }
    function updateTimeago() {
        $("time").timeago();
        setTimeout(updateTimeago, 30*1000);
    }
    updateTimeago();
    $(".description").focus(expand_description);
});
</script>
<hr/>
<footer>
<p>GOC Ticket Version 2.2 | <a href="https://ticket.opensciencegrid.org/goc/submit?app_issue_check=on&amp;app_issue_type=goc&amp;app_goc_url=https%3A%2F%2Fticket.opensciencegrid.org%3A443%2F19761">Report Bugs</a>
 | <a href="https://github.com/opensciencegrid/operations/blob/master/docs/privacy.md">Privacy Policy</a>
</p>

<p> <img align="top" src="/images/tag_orange.png"/> Copyright 2018 The Trustees of Indiana University - Developed for Open Science Grid</p>
</footer>


</div><!--container-fluid-->
<script src="https://ticket1.grid.iu.edu:8443/socket.io/socket.io.js"></script>
<script>
var chat = io.connect('https://ticket1.grid.iu.edu:8443');
chat.on('connect', function() {
    chat.emit('authenticate', {nodekey:'', ticketid: 19761});
});
chat.on('peers', function(peers) {
    $("#peers").html("");
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('peer_disconnect', function(pid) {
    $("#peer_"+pid).hide("slow");
});
chat.on('peer_connected', function(peers) {
    //expect only 1 peer connecting, but..
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('submit', function() {
    if(confirm("This ticket was updated. Do you want to refresh?")) {
        history.go(0);
    }
});

function addPeer(pid, peer) {
    var ipinfo = "";
    if(peer.ip != undefined) {
        ipinfo = "<span class=\"ip\">"+peer.ip+"</span>";
    }
    if(chat.io.engine.id == pid) {
        //don't display myself
        return;
    }
    var html = "<li class=\"new\" id=\"peer_"+pid+"\" class=\"peer\">"+peer.name+ipinfo+"</li>";
    $("#peers").prepend(html);
    $("#peers .new").animate({bottom: 0}, 1000, function() {$(this).removeClass("new")});
}

$(function() {
    $("#ticket_form").submit(function() {
        chat.emit('submit');
        return true;
    });
});
</script>
<script>
//used by searchbox
function parseValue(value) {
    var obj = new Object();
    var tokens = value.split("\t");
    obj.str = tokens[0];
    obj.count = tokens[1];
    return obj;
}

$(function() {
    //bootstrap-2.0.4 stuff
    $(".alert-message").alert();
    $(".dropdown-toggle").dropdown();
    $("span[rel='tooltip']").tooltip();
    $("a[rel=popover]").popover();

    //activate menu that user is currently on
    $("#menu_navigator").addClass("active"); 
    $("#submenu_").addClass("active"); 

    //translate zend validation error message to bootstrap
    $(".errors").addClass("alert").addClass("alert-error");

    //enable autocomplete for search box
    $("#search").autocomplete({
        source: function( request, response ) {
            $.ajax({
                url: "search/autocomplete",
                dataType: "text",
                data: {
                    //featureClass: "P",
                    //style: "full",
                    //maxRows: 12,
                    //name_startsWith: request.term
                    q: request.term
                },
                success: function( data ) {
                    response( $.map( data.split("\n"), function( item ) {
                        if(item == "") return null;
                        return {
                            value: item
                        }
                    }));
                }
            });
        },
        select: function(event, ui) {
            document.location = "search?q="+ui.item.value;
        }
    });
    
});
</script>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-69012-13");
pageTracker._trackPageview();
} catch(err) {}
</script>

</body>
