<!DOCTYPE html>
<html lang="en">
  <head>
  <base href="">
    <title>[34178] NOvA CVMFS repo significantly out of date on multiple BNL nodes</title>    <meta charset="utf-8" />
    <meta name="verify-v1" content="na5IcAJsZVOfEkboRxuIiZ1zpZgnZiWra+nKcS7nA/o=" />
    <meta name="google-site-verification" content="DLrk3ft4s8b-S2TloLCL2LD_t6wcTjgSluf5pmiu2kA" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />
    <link href="https://ticket.opensciencegrid.org/rss" rel="alternate" type="application/rss+xml" title="GOC Ticket Update feed" />

    <style type="text/css">
      body {
        padding-top: 50px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
     #search {
            width: 300px;
     }

    </style>

<script src="https://code.jquery.com/jquery-3.0.0.js"></script>
<script src="https://code.jquery.com/jquery-migrate-3.0.1.js"></script>

   <link href="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet"/>
    <script src="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/js/bootstrap.min.js"></script>

    <link href="https://netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"/>
    <link href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/themes/smoothness/jquery-ui.min.css" rel="stylesheet"/>
 <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>


    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/js/select2.min.js"></script>

    <link href="css/ticket.css" rel="stylesheet" />
    <script src="lib/jquery.cookie.js"></script>

    <link href="images/tag_orange.png" rel="icon" type="image/png"/>
    <script src='https://www.google.com/recaptcha/api.js'></script>
  </head>

  <body>
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>

            <a class="brand" style="padding: 6px 0px 0px 6px;" href="http://opensciencegrid.org"><img src="images/osglogo.40x30.png"/></a>
            <ul class="nav">
                <li class="dropdown"><a href="https://ticket.opensciencegrid.org/#" class="dropdown-toggle" data-toggle="dropdown">GOC Ticket <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    <li><a href="https://my.opensciencegrid.org">MyOSG</a></li>
                    <li><a href="https://oim.opensciencegrid.org">OIM</a></li>
                    <li class="active"><a href="https://ticket.opensciencegrid.org/index">Ticket</a></li>
	<li class="divider"></li>
	<li><a href="http://repo.grid.iu.edu">Repo</a></li>
	<li class="divider"></li>
	<li><a href="http://blogs.grid.iu.edu">Blog</a></li>
                    <li><a href="http://display.grid.iu.edu">Display</a></li>
                    <li><a href="http://osggoc.blogspot.com/">News</a></li>
                    </ul>
                </li>
            </ul>
            <ul class="nav pull-right">
                <li><a href="https://ticket.opensciencegrid.org/sso/">Login</a></li>            </ul>

            <div class="nav-collapse">
                <ul class="nav">
			 <li id="menu_submit"><a href="https://ticket.opensciencegrid.org/submit">Submit</a></li><li id="menu_view" class="dropdown"><a href="https://ticket.opensciencegrid.org/\#" class="dropdown-toggle" data-toggle="dropdown">View <b class="caret"></b></a><ul class="dropdown-menu"><li id="submenu_listopen"><a href="https://ticket.opensciencegrid.org/list/open">Open Tickets</a></li><li id="submenu_listrecentclose"><a href="https://ticket.opensciencegrid.org/list/recentclose">Recently Closed Tickets</a></li><li class="divider"></li><li id="submenu_alltickets"><a href="https://ticket.opensciencegrid.org/search?q=&amp;sort=id">All Tickets</a></li></ul></li>                </ul>

                <form class="navbar-search pull-right" action="https://ticket.opensciencegrid.org/viewer">
                    <input id="search" type="text" name="id" class="search-query span2" placeholder="Search Ticket" value=""/>
                </form>
            </div>
        </div>
      </div>
    </div>

<script type='text/javascript' src='lib/jquery.timeago.js'></script>
<script type='text/javascript' src='lib/byte2size.js'></script>
<style>
#updates .toolbar {
position: relative;
margin-top: 0px;
top: -10px;
font-weight: normal;
}
#updates a.anchor {
position: relative;
top: -50px;
}
#updates .selected pre {
animation:selected 2s;
animation-iteration-count: 2;
animation-direction: alternate;
-webkit-animation:selected 2s; 
-webkit-animation-iteration-count: 2;
-webkit-animation-direction: alternate;
box-shadow: inset 1px 1px 20px #9ad;
border: 1px solid #9ab;
margin: 5px 0px;
padding-left: 10px;
}
@keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ab;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
@-webkit-keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ad;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
#updates pre {
background-color: inherit;
line-height: 15px;
padding: 5px;
}
#updates .header {
color: #999;
}
#updates .update_history pre {
background-color: #eee;
color: #666;
font-size: 85%;
}
#updates .clickable {
cursor: pointer;
}
#updates .clickable:hover {
color: #D98719;
}
#updates .meta_information pre {
background-color: #fed;
}
#similar_tickets {
max-height: 300px;
overflow-y: auto;
pointer-events: none;
padding: 5px;
background-color: #f4f4f4;
}
.btn-toolbar {
margin-bottom: 0;
height: 30px;
}
#peers {
position: fixed;
bottom: 0px;
right: 0px;
z-index: 100;
list-style: none;
padding: 5px 0px 0px 5px;
margin: 0px;
background-color: white;
box-shadow: 0px 0px 10px white;
}
#peers li {
background-color: #ccc;
color: #000;
display: inline-block;
padding: 5px 10px;
margin-right: 5px;
position: relative;
}
/*
#peers li:hover {
background-color: #999;
cursor: pointer;
}
*/
#peers span.ip {
padding-left: 5px;
color: #666;
}
#peers .new {
bottom: -30px;
}
/*
#peers .me {
background-color: red;
}
*/
</style>

<div class="container-fluid">
<ul id="peers"></ul>
<div class="alert alert-danger"><a class="close" href="https://ticket.opensciencegrid.org/#" data-dismiss="alert">&times;</a>By the end of May 2018, the ticketing system at https://ticket.opensciencegrid.org will be retired and support will be provided at https://support.opensciencegrid.org. Throughout this transition the support email (help@opensciencegrid.org) will be available as a point of contact.<br><br>                                                   
                                                                                                                                                                                   
Please see the service migration page for details: https://opensciencegrid.github.io/technology/policy/service-migrations-spring-2018/#ticket</div><div id="presence" class="pull-right"></div><div class="ticketgui"><script type="text/javascript" src="lib/checktab.js"></script>

<script>
var expanded = false;
function expand_description() {
    var desc = $(".description");
    if(!expanded) {
        expanded = true;
        //expand to minheight
        var min = 250;
        if(desc.height() < min) {
            desc.animate({height: min}, 200);
        }
    }
}

$(document).ready(function() {
    $("input[name='nad']").datepicker({
        dateFormat: 'yy-mm-dd'
    });
});

</script>



<style>
.form-horizontal .control-label {
padding-top: inherit;
font-size:90%;
color:#666;
}
label {
margin-bottom: 0px;
}
.controls {
line-height: 18px;
}
</style>
<form class="form-horizontal" action="https://ticket.opensciencegrid.org/viewer/updatebasic?id=34178" method="post">
<div class="page-header">
    <h3><span class="muted">34178</span> / NOvA CVMFS repo significantly out of date on multiple BNL nodes</h3>
</div>

<div class="row-fluid">
<div class="span5">
    <legend>Contact</legend>
    <div class="control-group">
        <label class="control-label">Full Name</label>
        <div class="controls">Shreyas Bhat</div>
    </div>
    <div class="control-group">
        <label class="control-label">Email</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">Phone</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">CC</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>

    <legend>Details</legend>
    <div class="control-group"><label class="control-label">Resource Name</label><div class="controls">BNL_ATLAS_1</div></div><div class="control-group"><label class="control-label">Associated VO</label><div class="controls">ATLAS</div></div><div class="control-group"><label class="control-label">Submitted Via</label><div class="controls">GOC Ticket/submit</div></div><div class="control-group"><label class="control-label">Submitter</label><div class="controls">Shreyas Bhat</div></div><div class="control-group"><label class="control-label">Support Center</label><div class="controls">USATLAS</div></div><div class="control-group"><label class="control-label">Ticket Links</label><div class="controls"></div></div>
    <div class="control-group">
        <label class="control-label">Ticket Type</label>
        <div class="controls">Problem/Request</div>
    </div>
    <div class="control-group">
        <label class="control-label">Priority</label>
        <div class="controls">Normal</div>
    </div>
    <div class="control-group">
        <label class="control-label">Status</label>
        <div class="controls">
Closed</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action</label>
        <div class="controls">ENG Action</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action Deadline</label>
        <div class="controls flag_red">2017-06-30</div>
    </div>

</div><!--span-->
<div class="span7">
    <legend>Assignees</legend>
    <div class="assignee" style="width: 60%">USATLAS (BNL Prod)&nbsp;<a target="_blank" href="https://rt.racf.bnl.gov/rt/Ticket/Display.html?id=27569">27569</a> <span class="muted"> / Ticket Exchange</span></div>    <br>

    <legend>Assignees</legend>
    TODO
    <br>

    <style>
legend.noborder {
border-bottom: none;
}
</style>

<div id="attachment-list"/>
<script>
$(function () {
    var first = true;
    $.getJSON("attachment/list/34178", function (files) {
        //console.dir(files);
        var html = "<table class=\"table table-condensed\">";
        $(files).each(function() {
            if(first) {
                first = false;
                html += "<legend class=\"noborder\">Attachmenets</legend>";
            }
            html += "<tr class=\"attachment\">";
            html += "<td><img src="https://ticket.opensciencegrid.org/\&quot;&quot;+this.thumbnail_url+&quot;\&quot;/"></td>";
            html += "<td><a href="https://ticket.opensciencegrid.org/\&quot;&quot;+this.url+&quot;\&quot;" target=\"_blank\">"+this.name+"</a></td>";
            html += "<td>"+bytesToSize(this.size, 1)+"</td>";
            html += "</tr>";
        });
        html += "</table>";
        $("#attachment-list").html(html);
    });
});

function download(url) {
    window.open(url, "_blank");
}
</script>


</div><!--span-->
</div><!--row-fluid-->


</form>

</div>
<div id="updates" style="clear: both;">
    <legend>Past Updates
    <div class="btn-toolbar pull-right toolbar">
        <div class="btn-group">
                <a class="btn btn-small" href="https://ticket.opensciencegrid.org/34178?sort=up&amp;"><i class="icon-arrow-up"></i> Sort</a>

        
        <a class="btn btn-small" href="https://ticket.opensciencegrid.org/34178?expandall=true&amp;">Expand Descriptions</a>        <a class="btn btn-small" target="_blank" href="mailto:osg@tick.globalnoc.iu.edu?subject=Open%20Science%20Grid%3A%20NOvA%20CVMFS%20repo%20significantly%20out%20of%20date%20on%20multiple%20BNL%20nodes%20ISSUE%3D34178%20PROJ%3D71"><i class="icon-envelope"></i> Update w/Email</a>
        </div>
    </div><!--btn-toolbar-->
    </legend>

    <div class='update_description'><i onclick="document.location='34178#1499107333'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-07-03T18:42:13+00:00">Jul 3, 2017 06:42 PM UTC</time><a class="anchor" name="1499107333">&nbsp;</a></div><pre>For whatever reason, I (nor BNL) did not receive multiple recent updates on this ticket. I&#39;m glad testing went well; please let us know of any problems that may arise during the upcoming nova run.

~John

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=destefan/CN=665120/CN=John Steven De Stefano Jr</pre></div><div class='update_description'><i onclick="document.location='34178#1498765150'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-06-29T19:39:10+00:00">Jun 29, 2017 07:39 PM UTC</time><a class="anchor" name="1498765150">&nbsp;</a></div><pre>My test jobs ran fine, and a few Nova and mu2e production jobs ran at BNL yesterday and ran fine as well.  Jeremy told me that Nova is getting ready for a round of job submission - so we&#39;ll keep an eye out.  I&#39;m okay with closing the ticket out.  We can always open another one if needed.

Thanks!
Shreyas

by /DC=org/DC=opensciencegrid/O=Open Science Grid/OU=People/CN=Shreyas Bhat 3733</pre></div><div class='update_description'><i onclick="document.location='34178#1498671788'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-06-28T17:43:08+00:00">Jun 28, 2017 05:43 PM UTC</time><a class="anchor" name="1498671788">&nbsp;</a></div><pre>Dave and I talked about this offline - I&#39;ve gone ahead and un-blacklisted BNL.  I&#39;ve also sent a test job just now.

Jeremy, could you also send a test job to BNL?

Thanks,
Shreyas

by /DC=org/DC=opensciencegrid/O=Open Science Grid/OU=People/CN=Shreyas Bhat 3733</pre></div><div class='update_description'><i onclick="document.location='34178#1498665493'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-06-28T15:58:13+00:00">Jun 28, 2017 03:58 PM UTC</time><a class="anchor" name="1498665493">&nbsp;</a></div><pre>Right now, we still have BNL blacklisted, so no Nova or Mu2e jobs can start there.  Can someone confirm (see John&#39;s comment) that the CVMFS issue is resolved and we can start sending jobs there again?

Thanks,
Shreyas

by /DC=org/DC=opensciencegrid/O=Open Science Grid/OU=People/CN=Shreyas Bhat 3733</pre></div><div class='update_description'><i onclick="document.location='34178#1498663316'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-06-28T15:21:56+00:00">Jun 28, 2017 03:21 PM UTC</time> by <b>echism</b><a class="anchor" name="1498663316">&nbsp;</a></div><pre>Shreyas,

Are the jobs running?

Thanks</pre></div><div class='update_description'><i onclick="document.location='34178#1498487924'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-06-26T14:38:44+00:00">Jun 26, 2017 02:38 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1498487924">&nbsp;</a></div><pre>Hi Shreyas,

<font color='#7F7E6F'>&#62; On Jun 23, 2017, at 9&#58;56 PM, OSG GOC TX via RT &#60;RT-RACF@....&#62;</font>
wrote&#58;
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; Hi John,</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; Can I un-blacklist BNL for Nova and mu2e?</font>

I had made the immediate changes Dave specified last week; the rest
will require some time, but what���s done could be enough for most of
these jobs.

Someone else would need to confirm.

~John

-- by jd at Mon Jun 26 14&#58;37&#58;40 UTC 2017

GOCTX Source&#58; BNL Ticket&#58; Queue=GridServices ID=27569</pre></div><div class='update_description'><i onclick="document.location='34178#1498269303'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-06-24T01:55:03+00:00">Jun 24, 2017 01:55 AM UTC</time><a class="anchor" name="1498269303">&nbsp;</a></div><pre>Hi John,

Can I un-blacklist BNL for Nova and mu2e?

Thanks,
Shreyas

by /DC=org/DC=opensciencegrid/O=Open Science Grid/OU=People/CN=Shreyas Bhat 3733</pre></div><div class='update_description'><i onclick="document.location='34178#1498150148'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-06-22T16:49:08+00:00">Jun 22, 2017 04:49 PM UTC</time><a class="anchor" name="1498150148">&nbsp;</a></div><pre>I had blacklisted BNL for all Nova and mu2e jobs.  It sounds like we&#39;re ready to let these jobs run at BNL - is that right?

by /DC=org/DC=opensciencegrid/O=Open Science Grid/OU=People/CN=Shreyas Bhat 3733</pre></div><div class='update_description'><i onclick="document.location='34178#1498146204'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-06-22T15:43:24+00:00">Jun 22, 2017 03:43 PM UTC</time> by <b>Dave Dykstra</b><a class="anchor" name="1498146204">&nbsp;</a></div><pre>John,

These nova jobs were not trying to access /cvmfs/nova.osgstorage.org so that&#39;s a lower priority to fix.  Nova only uses that on some jobs.  In any case there&#39;s no way that they can function until the nodes are upgraded, so there&#39;s no need to try to configure them or access them at all.  They will be automatically configured after upgrade.

The problem was on /cvmfs/nova.opensciencegrid.org, because the BNL clients were reading with @org@, and the symlink on the BNL stratum 1 was erroneously pointing to the nova.osgstorage.org repo.  The symlink still points there, so you need to fix the symlinks on the stratum 1 first.  Even after you fix the BNL clients to use @fqan@, there may be other old configured clients around the world that need those symlnks to be correct.

Which oasis-config rpm version do you have on your client machines?

The reason for the repositories to appear out of date instead of failing to mount is probably because they&#39;re getting older values out of the cache.

Dave</pre></div><div class='update_description'><i onclick="document.location='34178#1498144703'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-06-22T15:18:23+00:00">Jun 22, 2017 03:18 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1498144703">&nbsp;</a></div><pre>These repository mounts should now be fixed and working on all our
WNs.

Dave claims the CVMFS client on the WNs will be able to mount these
repositories but fail with I/O errors, due to the client version
(2.1.19). Is there a way we can test this, as simple listings and file
reads seem to work?

My remaining question is why the jobs would report incorrect
repository revisions, instead of reporting ���no such file��� errors when
the repositories were not being mounted.

Someone may want to inform the mu2e and nova maintainers that they can
remove the &#96;new_repository&#96; file from their osgstorage.org
repositories.

~John

-- by jd at Thu Jun 22 15&#58;17&#58;42 UTC 2017

GOCTX Source&#58; BNL Ticket&#58; Queue=GridServices ID=27569</pre></div><div class='update_description'><i onclick="document.location='34178#1498083312'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-06-21T22:15:12+00:00">Jun 21, 2017 10:15 PM UTC</time> by <b>Dave Dykstra</b><a class="anchor" name="1498083312">&nbsp;</a></div><pre>[I wrote essentially this reply earlier in the day today but it never got posted and was lost, so I am trying to re-write it from memory]

John,

I&#39;m sorry that you didn&#39;t get notified about the stratum 1 DNS aliases or server short names.  However the situation is not so bad.

When you are ready to change the DNS alias on your stratum 1, you will need to notify the cvmfs development team to change cvmfs-config-default, and when you do that I will notice and request changing the cvmfs-s1bnl.opensciencegrid.org alias to your new alias.  That is actually an advantage to you because it can be updated within days, where on the other hand it will take years to roll out the change to cvmfs-config-default.

The desire to stop supporting the short names has been discussed more than once on the cvmfs-stratum-operations mailing list, which you subscribe to, so if you would have thought about it you could have realized that client configurations would need to use @fqrn@ instead of @org@, and that one day there would be clashes of short names between different domains so the symlinks shouldn&#39;t continue for all domains.  As it is, it only broke updates to a few repositories for a fairly short period, and it is pretty easily fixed, so it didn&#39;t cause great harm.

Dave</pre></div><div class='update_description'><i onclick="document.location='34178#1498082444'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-06-21T22:00:44+00:00">Jun 21, 2017 10:00 PM UTC</time> by <b>Dave Dykstra</b><a class="anchor" name="1498082444">&nbsp;</a></div><pre>Do you have oasis-config-7.3 installed?  I downgraded my test machine all the way back to 2.1.19 (which was a challenge) and @org@ was used for cern.ch, but oasis-config used @fqrn@ for opensciencegrid.org in the oasis-config rpm that went with cvmfs-2.1.19.  The osg-oasis rpm back then (version 4-2) required cvmfs-2.1.19 and oasis-config-7.3   @org@ was used for opensciencegrid.org in the older oasis-config versions which went with cvmfs versions older than 2.1.19.  As far as I know, no other stratum 1 besides BNL ever supported the short names for any domain other than cern.ch and opensciencegrid.org, so for other domains you wouldn&#39;t have had any backup servers when using @org@.

The problem of this ticket was with nova.opensciencegrid.org.  In order for osgstorage.org repositories to fully work you need at least cvmfs-2.2.0.   Older client versions will mount the repo, but will not be able to read any of the files inside (they&#39;ll all get Input/ouput errors) so there&#39;s not much point.  To make osgstorage.org repos work you also need an updated cvmfs-config-osg which handles all CVMFS_SERVER_URL settings (via the configuration repository) and there&#39;s no need for sites to set it in any .local file.</pre></div><div class='update_description'><i onclick="document.location='34178#1498072031'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-06-21T19:07:11+00:00">Jun 21, 2017 07:07 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1498072031">&nbsp;</a></div><pre>I have pushed a code branch into our CM system that fixes this
problem, which is being tested now, and we���ll push it to our WNs
afterward. I should mention that the actual issue was that our WN
clients simply had no config for the new OSG repository domain and,
thus, idea how to mount its repositories; adding a .local file fixes
this in our case, not changing @org@ to @fqrn@, but I made that change
as well anyway.

BTW, @org@ has been in place and working as least at late as v2.1.19,
as it is the default client setting in that version.

~John

-- by jd at Wed Jun 21 19&#58;06&#58;47 UTC 2017

GOCTX Source&#58; BNL Ticket&#58; Queue=GridServices ID=27569</pre></div><div class='update_description'><i onclick="document.location='34178#1497997264'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-06-20T22:21:04+00:00">Jun 20, 2017 10:21 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1497997264">&nbsp;</a></div><pre>Hi Dave,

You refer to discussions and decisions taken ���years ago&#34;, but I was
neither involved in nor notified of these. As I was among the first
Stratum One sites to establish a replica, I wouldn���t have deferred to
instructions others may have created since then. I���ll have a look at
the TWiki pages and work toward a solution tomorrow.

Thanks,
~John

-- by jd at Tue Jun 20 22&#58;20&#58;49 UTC 2017

GOCTX Source&#58; BNL Ticket&#58; Queue=GridServices ID=27569</pre></div><div class='update_description'><i onclick="document.location='34178#1497996787'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-06-20T22:13:07+00:00">Jun 20, 2017 10:13 PM UTC</time> by <b>Dave Dykstra</b><a class="anchor" name="1497996787">&nbsp;</a></div><pre><font color='#7F7E6F'>&#62; I&#39;ve not been told of this distinction in domains, or such expectations from OSG.</font>

This was discussed years ago.  The StratumOnes twiki has always talked about doing it only for cern.ch (and we extended it to opensciencegrid.org), and all the stratum 1 configuration examples talk about it.

<font color='#7F7E6F'>&#62; And, of course, if the short name of one domain</font>
<font color='#7F7E6F'>&#62; equals that of another domain called in parallel, there are going to</font>
<font color='#7F7E6F'>&#62; be conflicts somewhere. Why instead weren&#39;t these repositories given</font>
<font color='#7F7E6F'>&#62; different short names (i.e., &#34;mu2e-storage&#34;) instead of creating a</font>
<font color='#7F7E6F'>&#62; separate domain and reusing the same short names, especially if</font>
<font color='#7F7E6F'>&#62; they&#39;re all hosted by OSG?</font>

Because it was assumed that this problem was solved years ago.  It was the reason for introducing separate domain names, so the same short name can be used without clashes.

<font color='#7F7E6F'>&#62; This problem implies that the client is using repository short names</font>
<font color='#7F7E6F'>&#62; and not their FQDNs for access.</font>

Correct, a client misconfiguration.

<font color='#7F7E6F'>&#62; And, perhaps a silly question, but who created the alias &#39;cvmfs-s1bnl.opensciencegrid.org&#39;,</font>
<font color='#7F7E6F'>&#62; and why was it created without informing us? Our domain may soon be changing, and while</font>
<font color='#7F7E6F'>&#62; I plan to keep a redirecting alias in place temporarily, that &#39;s1bnl&#39; alias would have</font>
<font color='#7F7E6F'>&#62; eventually broken.</font>

That was decided long ago by the oasis development team which included BNL people, soon after there was a government shutdown and threat of both BNL & FNAL going off the network.  The aliases are used so they can be redirected to another site (UNL has a backup) if necessary.

In any case, the cvmfs.racf.bnl.gov alias cannot be removed for years because it is encoded as a cern.ch domain stratum 1 in the cvmfs-config-default rpm, which is installed throughout the world and is unlikely to be upgraded everywhere for years after it is updated.

<font color='#7F7E6F'>&#62; We use .local files to set our server URL first, as, until I was able</font>
<font color='#7F7E6F'>&#62; to update our cvmfs-server package, OSG would not recognize our server</font>
<font color='#7F7E6F'>&#62; for its clients.</font>

I&#39;m not sure what you mean by that.  The only issue I&#39;m aware of is that your stratum 1 didn&#39;t support the geo api for a long tmie, but your clients should still have been able to use other stratum 1s.

<font color='#7F7E6F'>&#62; In that server URL string, we use the &#39;@org@&#39; meta</font>
<font color='#7F7E6F'>&#62; variable, as &#39;@fqdn@&#39; was not accepted earlier, but perhaps changing</font>
<div id='show_120558856' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_120558856'><font color='#7F7E6F'>&#62; this here, or removing the URL as you suggest, would be the answer</font>
<font color='#7F7E6F'>&#62; here.</font>

Definitely @org@ is the wrong thing.  I don&#39;t remember a time when @fqrn@ didn&#39;t work except maybe the 2.0 series.

<font color='#7F7E6F'>&#62; The WN clients are still at 2.1.19, and there is no current plan to</font>
<font color='#7F7E6F'>&#62; upgrade it until our WNs are migrated to EL 7, the installations of</font>
<font color='#7F7E6F'>&#62; which at BNL are configured to use the current, latest client (2.3.5).</font>

That&#39;s shocking.  2.1.20 was released over 2 years ago.   How long will it be before all nodes are upgraded to EL7?  Anyway I think that even with cvmfs-2.1.19 the OSG release had server ordering so you shouldn&#39;t have had to set CVMFS_SERVER_URL except probably for cern.ch.  Test it out on one node to see if it orders the servers correctly without setting CVMFS_SERVER_URL.  Otherwise at least switch to using @fqrn@ in the CVMFS_SERVER_URL on the EL6 nodes.  Hopefully it isn&#39;t still being set for the EL7 nodes.
</div><script type='text/javascript'>
        $('#show_120558856').click(function() {
            $('#detail_120558856').slideDown("normal");
            $('#show_120558856').hide();
            $('#hide_120558856').show();
        });
        $('#hide_120558856').click(function() {
            $('#detail_120558856').slideUp();
            $('#hide_120558856').hide();
            $('#show_120558856').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='34178#1497993961'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-06-20T21:26:01+00:00">Jun 20, 2017 09:26 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1497993961">&nbsp;</a></div><pre>Hi Dave,

<font color='#7F7E6F'>&#62; On Jun 20, 2017, at 3&#58;09 PM, OSG GOC TX via RT &#60;RT-RACF@....&#62;</font>
wrote&#58;
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; &#62; Dave&#58; what you re-stated is exactly what I meant&#58; if a file is</font>
pinned,
<font color='#7F7E6F'>&#62; &#62; it can not be refreshed until its pinned status is changed or the</font>
<font color='#7F7E6F'>&#62; &#62; share has been unmounted.</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; Well yes, if a file is open, the program using it will continue to</font>
use
<font color='#7F7E6F'>&#62; that file.  It should not prevent updates for other programs reading</font>
<font color='#7F7E6F'>&#62; the same repository or even the same file, however.</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; &#62; cvmfs2&#58; (mu2e.opensciencegrid.org) repository name does not match</font>
<font color='#7F7E6F'>&#62; &#62; (found mu2e.osgstorage.org, expected mu2e.opensciencegrid.org)</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; Yes that&#39;s a big problem, and could be the root cause of both the</font>
nova
<font color='#7F7E6F'>&#62; and mu2e problems.  I see that</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; wget -qO-</font>
<font color='#7F7E6F'>&#62; http&#58;//cvmfs-</font>
s1bnl.opensciencegrid.org/cvmfs/mu2e/.cvmfspublished|cat
<font color='#7F7E6F'>&#62; -v|grep ^N</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; returns &#34;Nmu2e.osgstorage.org&#34; and likewise for nova returns</font>
<font color='#7F7E6F'>&#62; &#34;Nnova.osgstorage.org&#34;.</font>
Yes, but requests for the file via the repository&#39;s FQDN return the
correct repository.
<font color='#7F7E6F'>&#62; The script to create repositories on the</font>
<font color='#7F7E6F'>&#62; stratum 1 must always create the symlink without the domain name,</font>
and
<div id='show_1083812535' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_1083812535'><font color='#7F7E6F'>&#62; it overrode the symlink for opensciencegrid.org.   The symlinks are</font>
<font color='#7F7E6F'>&#62; only needed for old client configurations for cern.ch and</font>
<font color='#7F7E6F'>&#62; opensciencegrid,org, because after that every client was supposed to</font>
be
<font color='#7F7E6F'>&#62; using the fully qualified domain names.  Please update your script</font>
to
<font color='#7F7E6F'>&#62; only create the symlinks for those two domains, and by hand recreate</font>
<font color='#7F7E6F'>&#62; the symlinks of nova and mu2e to be for opensciencegrid.org repos.</font>
I���ve not been told of this distinction in domains, or such
expectations from OSG. And, of course, if the short name of one domain
equals that of another domain called in parallel, there are going to
be conflicts somewhere. Why instead weren���t these repositories given
different short names (i.e., ���mu2e-storage���) instead of creating a
separate domain and reusing the same short names, especially if
they���re all hosted by OSG?

This problem implies that the client is using repository short names
and not their FQDNs for access.

And, perhaps a silly question, but who created the alias &#39;cvmfs-
s1bnl.opensciencegrid.org���, and why was it created without informing
us? Our domain may soon be changing, and while I plan to keep a
redirecting alias in place temporarily, that ���s1bnl��� alias would have
eventually broken.
<font color='#7F7E6F'>&#62; You&#39;ve got the same problem for uboone and des.</font>
I would assume so.
<font color='#7F7E6F'>&#62; The ligo and stash</font>
<font color='#7F7E6F'>&#62; symlinks can be removed, because there are no corresponding</font>
<font color='#7F7E6F'>&#62; opensciencegrid.org repos.  Likewise the symlinks for other</font>
<font color='#7F7E6F'>&#62; non-opensciencegrid.org and non-cern.ch repos can be removed&#58; auger,</font>
<font color='#7F7E6F'>&#62; glast, ilc, and snoplus.</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; In addition, BNL must have an old client configuration at least for</font>
<font color='#7F7E6F'>&#62; opensciencegrid.org that does not include the fully qualified</font>
<font color='#7F7E6F'>&#62; repository name.  There should be no need anymore to have</font>
<font color='#7F7E6F'>&#62; /etc/cvmfs/domain.d/opensciencegrid.org.local or</font>
<font color='#7F7E6F'>&#62; /etc/cvmfs/default.local override any CVMFS_SERVER_URL settings.  I</font>
<font color='#7F7E6F'>&#62; recommend removing that and using the default cvmfs-config-osg</font>
<font color='#7F7E6F'>&#62; configuration which will always set the order of the stratum 1s</font>
<font color='#7F7E6F'>&#62; correctly.</font>
We use .local files to set our server URL first, as, until I was able
to update our cvmfs-server package, OSG would not recognize our server
for its clients. In that server URL string, we use the &#39;@org@��� meta
variable, as &#39;@fqdn@&#39; was not accepted earlier, but perhaps changing
this here, or removing the URL as you suggest, would be the answer
here.

The WN clients are still at 2.1.19, and there is no current plan to
upgrade it until our WNs are migrated to EL 7, the installations of
which at BNL are configured to use the current, latest client (2.3.5).

Thanks,
~John

-- by jd at Tue Jun 20 21&#58;25&#58;46 UTC 2017

GOCTX Source&#58; BNL Ticket&#58; Queue=GridServices ID=27569
</div><script type='text/javascript'>
        $('#show_1083812535').click(function() {
            $('#detail_1083812535').slideDown("normal");
            $('#show_1083812535').hide();
            $('#hide_1083812535').show();
        });
        $('#hide_1083812535').click(function() {
            $('#detail_1083812535').slideUp();
            $('#hide_1083812535').hide();
            $('#show_1083812535').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='34178#1497985690'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-06-20T19:08:10+00:00">Jun 20, 2017 07:08 PM UTC</time> by <b>jwolcott@....</b><a class="anchor" name="1497985690">&nbsp;</a></div><pre><font color='#7F7E6F'>&#62; I am sure nova is using the &#39;attr&#39; command, like this, to get the</font>
<font color='#7F7E6F'>&#62; current revision number&#58;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; attr -qg revision /cvmfs/nova.opensciencegrid.org</font>

Agreed, I confirm this.  Sorry I&#39;ve been slow to respond.

-Jeremy

On 06/20/2017 11&#58;35 AM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='34178#1497975084'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-06-20T16:11:24+00:00">Jun 20, 2017 04:11 PM UTC</time> by <b>Dave Dykstra</b><a class="anchor" name="1497975084">&nbsp;</a></div><pre><font color='#7F7E6F'>&#62; Dave&#58; what you re-stated is exactly what I meant&#58; if a file is pinned,</font>
<font color='#7F7E6F'>&#62; it can not be refreshed until its pinned status is changed or the</font>
<font color='#7F7E6F'>&#62; share has been unmounted.</font>

Well yes, if a file is open, the program using it will continue to use that file.  It should not prevent updates for other programs reading the same repository or even the same file, however.

<font color='#7F7E6F'>&#62; cvmfs2&#58; (mu2e.opensciencegrid.org) repository name does not match</font>
<font color='#7F7E6F'>&#62; (found mu2e.osgstorage.org, expected mu2e.opensciencegrid.org)</font>

Yes that&#39;s a big problem, and could be the root cause of both the nova and mu2e problems.  I see that

wget -qO- <a href='http&#58;//cvmfs-s1bnl.opensciencegrid.org/cvmfs/mu2e/.cvmfspublished|cat' target='_blank' rel='nofollow'>http&#58;//cvmfs-s1bnl.opensciencegrid.org/cvmfs/mu2e/.cvmfspublished|cat</a> -v|grep ^N

returns &#34;Nmu2e.osgstorage.org&#34; and likewise for nova returns &#34;Nnova.osgstorage.org&#34;.   The script to create repositories on the stratum 1 must always create the symlink without the domain name, and it overrode the symlink for opensciencegrid.org.   The symlinks are only needed for old client configurations for cern.ch and opensciencegrid,org, because after that every client was supposed to be using the fully qualified domain names.  Please update your script to only create the symlinks for those two domains, and by hand recreate the symlinks of nova and mu2e to be for opensciencegrid.org repos.   You&#39;ve got the same problem for uboone and des.  The ligo and stash symlinks can be removed, because there are no corresponding opensciencegrid.org repos.  Likewise the symlinks for other non-opensciencegrid.org and non-cern.ch repos can be removed&#58; auger, glast, ilc, and snoplus.

In addition, BNL must have an old client configuration at least for opensciencegrid.org that does not include the fully qualified repository name.  There should be no need anymore to have /etc/cvmfs/domain.d/opensciencegrid.org.local or /etc/cvmfs/default.local override any CVMFS_SERVER_URL settings.  I recommend removing that and using the default cvmfs-config-osg configuration which will always set the order of the stratum 1s correctly.</pre></div><div class='update_description'><i onclick="document.location='34178#1497973412'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-06-20T15:43:32+00:00">Jun 20, 2017 03:43 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1497973412">&nbsp;</a></div><pre>Dave&#58; what you re-stated is exactly what I meant&#58; if a file is pinned,
it can not be refreshed until its pinned status is changed or the
share has been unmounted.

I think the problematic file requests may depend on what files are
being requested by the jobs, and whether they expect files from the
&#96;osgstorage.org&#96; domain. I see this in the WN logs, regardless of
whether a repository can be mounted&#58;

cvmfs2&#58; (mu2e.opensciencegrid.org) repository name does not match
(found mu2e.osgstorage.org, expected mu2e.opensciencegrid.org)

I will look into this as a possible broad config issue ASAP  later
today.

~John

-- by jd at Tue Jun 20 15&#58;43&#58;16 UTC 2017

GOCTX Source&#58; BNL Ticket&#58; Queue=GridServices ID=27569</pre></div><div class='update_description'><i onclick="document.location='34178#1497972959'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-06-20T15:35:59+00:00">Jun 20, 2017 03:35 PM UTC</time> by <b>Dave Dykstra</b><a class="anchor" name="1497972959">&nbsp;</a></div><pre>I am sure nova is using the &#39;attr&#39; command, like this, to get the current revision number&#58;

attr -qg revision /cvmfs/nova.opensciencegrid.org

John, I don&#39;t know what you mean about files being held open preventing updates.  Yes if a file is held open it will prevent an unmount, but the cvmfs client should meanwhile accept an update.  If you want to force an update to a cvmfs repository as an administrator while files are being held open, you can always do &#34;sudo cvmfs_talk -i &#60;reponame&#62; remount&#34;.

We have had similar experiences of nodes being out of date before, at the university of Michigan I believe, and I don&#39;t remember what the resolution was or if a root cause was determined.</pre></div><div class='update_description'><i onclick="document.location='34178#1497971822'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-06-20T15:17:02+00:00">Jun 20, 2017 03:17 PM UTC</time><a class="anchor" name="1497971822">&nbsp;</a></div><pre>Hi John,

It looks like a number of those mu2e jobs failed due to CVMFS errors - namely that they couldn&#39;t find the mu2e repo.  Here are some sample jobs&#58;

21164701.6076@....
21164701.6078@....
21164701.6079@....
21164701.6080@....
21164701.6081@....
21164701.6082@....
21164701.6083@....
21164701.6084@....
21164701.6085@....
21164701.6087@....
21164701.6110@....
21164701.6111@....
21164701.6112@....
21164701.6129@....
21164701.6163@....
21164701.6190@....
21164701.6193@....
21164701.6194@....
21164701.6200@....
21164701.6203@....
21164701.6219@....
21164701.6227@....
21164701.720@....

All of the .err files for these jobs have the following lines&#58;

stat&#58; cannot read file system information for &#96;/cvmfs/mu2e.opensciencegrid.org&#39;&#58; No such file or directory
cvmfs-uptodate&#58; Unable to read cvmfs expires time from /cvmfs/mu2e.opensciencegrid.org
./mu2eprodsys.sh&#58; line 337&#58; /cvmfs/mu2e.opensciencegrid.org/setupmu2e-art.sh&#58; No such file or directory

I&#39;ve attached a log file to the ticket.
<div id='show_597401424' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_597401424'>
Thanks,
Shreyas

by /DC=org/DC=opensciencegrid/O=Open Science Grid/OU=People/CN=Shreyas Bhat 3733
</div><script type='text/javascript'>
        $('#show_597401424').click(function() {
            $('#detail_597401424').slideDown("normal");
            $('#show_597401424').hide();
            $('#hide_597401424').show();
        });
        $('#hide_597401424').click(function() {
            $('#detail_597401424').slideUp();
            $('#hide_597401424').hide();
            $('#show_597401424').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='34178#1497970017'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-06-20T14:46:57+00:00">Jun 20, 2017 02:46 PM UTC</time><a class="anchor" name="1497970017">&nbsp;</a></div><pre>I&#39;m not exactly sure about how they get the version - Jeremy Wolcott from NOvA is on this ticket and should know the answer to that.

I&#39;ll look at the mu2e jobs and get back to you on that.

Thanks,
Shreyas

by /DC=org/DC=opensciencegrid/O=Open Science Grid/OU=People/CN=Shreyas Bhat 3733</pre></div><div class='update_description'><i onclick="document.location='34178#1497969697'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-06-20T14:41:37+00:00">Jun 20, 2017 02:41 PM UTC</time><a class="anchor" name="1497969697">&nbsp;</a></div><pre>Adding Dave Dykstra to this ticket.

by /DC=org/DC=opensciencegrid/O=Open Science Grid/OU=People/CN=Shreyas Bhat 3733</pre></div><div class='update_description'><i onclick="document.location='34178#1497969674'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-06-20T14:41:14+00:00">Jun 20, 2017 02:41 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1497969674">&nbsp;</a></div><pre>Hi Shreyas,

No need to open another ticket for mu2e. Can you point me to any job
#s or log files so I can look into this further from the client side?
Also, understanding how you determine whether a mounted repository is
outdated would be useful.

~John

-- by jd at Tue Jun 20 14&#58;41&#58;01 UTC 2017

GOCTX Source&#58; BNL Ticket&#58; Queue=GridServices ID=27569</pre></div><div class='update_description'><i onclick="document.location='34178#1497969320'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-06-20T14:35:20+00:00">Jun 20, 2017 02:35 PM UTC</time><a class="anchor" name="1497969320">&nbsp;</a></div><pre>Hi John,

Thanks for the explanation and that link.

As far as the remaining nodes are concerned, can you tell if a repository file is still pinned, keeping the version held back , or have they refreshed?  We had a bunch of NOvA jobs fail there over the last 24 hours; so I was wondering if it was the same thing.  I&#39;m assuming not, since a number of Mu2e jobs failed as well.  (I can open a new ticket for that if need be).

Thanks,
Shreyas

by /DC=org/DC=opensciencegrid/O=Open Science Grid/OU=People/CN=Shreyas Bhat 3733</pre></div><div class='update_description'><i onclick="document.location='34178#1497891996'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-06-19T17:06:36+00:00">Jun 19, 2017 05:06 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1497891996">&nbsp;</a></div><pre>Hi.

The version currently replicated at BNL is 610, as can verified here&#58;
<a href='http&#58;//cernvm-monitor.cern.ch/cvmfs-monitor/nova.opensciencegrid.org/' target='_blank' rel='nofollow'>http&#58;//cernvm-monitor.cern.ch/cvmfs-monitor/nova.opensciencegrid.org/</a>

This is the same version that any client requesting a new copy of the
repository would receive, and the same version being retrieved via our
caches..

As for why some of our nodes may be using an older version&#58; due to the
nature of CVMFS, when a repository file is ���pinned���, or stays in use,
the repository will not be updated until that pinned file is released,
at which time the repository is unmounted and can be remounted with a
call for the latest version.

A spot-check of a few of the specified nodes showed that the nova
repository was not mounted, and a fresh mount seemed to retrieve the
latest version. How are you determining the mounted version on the
client side?

Also, there was a DNS problem at CERN over the weekend, which I don���t
think would be related, but may be worth mentioning.

~John

-- by jd at Mon Jun 19 17&#58;06&#58;07 UTC 2017

GOCTX Source&#58; BNL Ticket&#58; Queue=GridServices ID=27569</pre></div><div class='update_description'><i onclick="document.location='34178#1497886458'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-06-19T15:34:18+00:00">Jun 19, 2017 03:34 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1497886458">&nbsp;</a></div><pre>Hi,

NOvA is noticing a number of their jobs failing at BNL due to out of date CVMFS repositories.  They have a check in their script to immediately exit if the repo is out of date.  Here is the original text of the ticket sent to us&#58;

-----
Hi,

After numerous instances where OSG sites have had CVMFS repositories that are significantly out-of-date, and NOvA jobs failing because of that, we put a check into our job wrapper script that insists the CVMFS repository on the execute node is the same as (or higher than) a version specified at submit time.  By means of this check, and a subsequent large number of jobs failing it, we&#39;ve discovered that a number of nodes at BNL are significantly behind on the NOvA CVMFS repository.  The current revision is 610, which hasn&#39;t changed for a while, and these nodes report revisions anywhere from 604 to 608.  We discovered 20 nodes in this fashion over this past weekend (several thousand jobs in cluster 18176705.0@.... tripped the check)&#58;

acas0829.usatlas.bnl.gov
acas1014.usatlas.bnl.gov
acas1028.usatlas.bnl.gov
acas1033.usatlas.bnl.gov
acas1038.usatlas.bnl.gov
acas1042.usatlas.bnl.gov
acas1054.usatlas.bnl.gov
acas1068.usatlas.bnl.gov
acas1088.usatlas.bnl.gov
acas1106.usatlas.bnl.gov
acas1137.usatlas.bnl.gov
acas1514.usatlas.bnl.gov
acas1591.usatlas.bnl.gov
acas1608.usatlas.bnl.gov
acas1704.usatlas.bnl.gov
acas1706.usatlas.bnl.gov
acas1903.usatlas.bnl.gov
acas1923.usatlas.bnl.gov
acas1941.usatlas.bnl.gov
acas1963.usatlas.bnl.gov
...
---

Please take a look to see why these nodes&#39; NOvA CVMFS repos aren&#39;t up to date, and check to see if this is an issue on other nodes at BNL.

Please let me know if you have any questions.
<div id='show_1746900812' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_1746900812'>
Thanks very much,

Shreyas Bhat
User Support for Distributed Computing
Fermilab

by /DC=org/DC=opensciencegrid/O=Open Science Grid/OU=People/CN=Shreyas Bhat 3733

</div><script type='text/javascript'>
        $('#show_1746900812').click(function() {
            $('#detail_1746900812').slideDown("normal");
            $('#show_1746900812').hide();
            $('#hide_1746900812').show();
        });
        $('#hide_1746900812').click(function() {
            $('#detail_1746900812').slideUp();
            $('#hide_1746900812').hide();
            $('#show_1746900812').show();
        });
        </script></pre></div><legend>Similar Recent Tickets <small>modified within the last 30 days</small></legend><div id="similar_tickets"><p class="muted">No similar tickets found.</p></div>
</div>
<script type="text/javascript">
function reset_anchor() {
    $("#updates .selected").removeClass("selected");
    var urls = document.location.toString().split('#'); 
    var anchor = urls[1];
    if(anchor) {
        $("a[name='"+anchor+"']").parents(".update_description").addClass("selected");
    }
}
function submitspam(ticket_id) {
    myret = confirm("Would you like to close this ticket as a security ticket, and submit the ticket content to akismet?");
    if(myret == true) {
        $.ajax("viewer/processspam?id="+ticket_id).done(function() {
            window.location.reload();
        });
    }
}

$(function() {
    reset_anchor();
    var ADDITIONAL_COOKIE_NAME = 'gocticket';
    var options = { path: '/', expires: 365};

    if(window.opener && window.opener.name == "gocticket_list") {
        v = $.cookie("closewindow");
        if(!v) {
            $("#closewindow").attr("checked", "checked"); //on by default
        } else {
            if(v == "checked") {
                $("#closewindow").attr("checked", "checked");
            }
        }
        $("#closewindow").click(function() {
            $.cookie("closewindow", $(this).attr('checked'), options);
        });
    } else {
        $("#closewindow_area").hide();
    }
    function updateTimeago() {
        $("time").timeago();
        setTimeout(updateTimeago, 30*1000);
    }
    updateTimeago();
    $(".description").focus(expand_description);
});
</script>
<hr/>
<footer>
<p>GOC Ticket Version 2.2 | <a href="https://ticket.opensciencegrid.org/goc/submit?app_issue_check=on&amp;app_issue_type=goc&amp;app_goc_url=https%3A%2F%2Fticket.opensciencegrid.org%3A443%2F34178">Report Bugs</a>
 | <a href="https://github.com/opensciencegrid/operations/blob/master/docs/privacy.md">Privacy Policy</a>
</p>

<p> <img align="top" src="images/tag_orange.png"/> Copyright 2018 The Trustees of Indiana University - Developed for Open Science Grid</p>
</footer>


</div><!--container-fluid-->
<script src="https://ticket1.grid.iu.edu:8443/socket.io/socket.io.js"></script>
<script>
var chat = io.connect('https://ticket1.grid.iu.edu:8443');
chat.on('connect', function() {
    chat.emit('authenticate', {nodekey:'', ticketid: 34178});
});
chat.on('peers', function(peers) {
    $("#peers").html("");
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('peer_disconnect', function(pid) {
    $("#peer_"+pid).hide("slow");
});
chat.on('peer_connected', function(peers) {
    //expect only 1 peer connecting, but..
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('submit', function() {
    if(confirm("This ticket was updated. Do you want to refresh?")) {
        history.go(0);
    }
});

function addPeer(pid, peer) {
    var ipinfo = "";
    if(peer.ip != undefined) {
        ipinfo = "<span class=\"ip\">"+peer.ip+"</span>";
    }
    if(chat.io.engine.id == pid) {
        //don't display myself
        return;
    }
    var html = "<li class=\"new\" id=\"peer_"+pid+"\" class=\"peer\">"+peer.name+ipinfo+"</li>";
    $("#peers").prepend(html);
    $("#peers .new").animate({bottom: 0}, 1000, function() {$(this).removeClass("new")});
}

$(function() {
    $("#ticket_form").submit(function() {
        chat.emit('submit');
        return true;
    });
});
</script>
<script>
//used by searchbox
function parseValue(value) {
    var obj = new Object();
    var tokens = value.split("\t");
    obj.str = tokens[0];
    obj.count = tokens[1];
    return obj;
}

$(function() {
    //bootstrap-2.0.4 stuff
    $(".alert-message").alert();
    $(".dropdown-toggle").dropdown();
    $("span[rel='tooltip']").tooltip();
    $("a[rel=popover]").popover();

    //activate menu that user is currently on
    $("#menu_navigator").addClass("active"); 
    $("#submenu_").addClass("active"); 

    //translate zend validation error message to bootstrap
    $(".errors").addClass("alert").addClass("alert-error");

    //enable autocomplete for search box
    $("#search").autocomplete({
        source: function( request, response ) {
            $.ajax({
                url: "search/autocomplete",
                dataType: "text",
                data: {
                    //featureClass: "P",
                    //style: "full",
                    //maxRows: 12,
                    //name_startsWith: request.term
                    q: request.term
                },
                success: function( data ) {
                    response( $.map( data.split("\n"), function( item ) {
                        if(item == "") return null;
                        return {
                            value: item
                        }
                    }));
                }
            });
        },
        select: function(event, ui) {
            document.location = "search?q="+ui.item.value;
        }
    });
    
});
</script>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-69012-13");
pageTracker._trackPageview();
} catch(err) {}
</script>

</body>
