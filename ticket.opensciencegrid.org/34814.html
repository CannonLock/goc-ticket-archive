<!DOCTYPE html>
<html lang="en">
  <head>
  <base href="">
    <title>[34814] Jobs at OU_OSCER_ATLAS_MCORE fail with &#34;Connection error&#34;</title>    <meta charset="utf-8" />
    <meta name="verify-v1" content="na5IcAJsZVOfEkboRxuIiZ1zpZgnZiWra+nKcS7nA/o=" />
    <meta name="google-site-verification" content="DLrk3ft4s8b-S2TloLCL2LD_t6wcTjgSluf5pmiu2kA" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />

    <style type="text/css">
      body {
        padding-top: 50px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
     #search {
            width: 300px;
     }

    </style>

<script src="https://code.jquery.com/jquery-3.0.0.js"></script>
<script src="https://code.jquery.com/jquery-migrate-3.0.1.js"></script>

   <link href="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet"/>
    <script src="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/js/bootstrap.min.js"></script>

    <link href="https://netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"/>
    <link href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/themes/smoothness/jquery-ui.min.css" rel="stylesheet"/>
 <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>


    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/js/select2.min.js"></script>

    <link href="css/ticket.css" rel="stylesheet" />
    <script src="lib/jquery.cookie.js"></script>

    <link href="images/tag_orange.png" rel="icon" type="image/png"/>
  </head>

  <body>
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>

            <a class="brand" style="padding: 6px 0px 0px 6px;" href="http://opensciencegrid.org"><img src="images/osglogo.40x30.png"/></a>
            <ul class="nav">
                <li class="dropdown"><a href="https://ticket.opensciencegrid.org/#" class="dropdown-toggle" data-toggle="dropdown">GOC Ticket <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    <li><a href="https://my.opensciencegrid.org">MyOSG</a></li>
                    <li><a href="https://oim.opensciencegrid.org">OIM</a></li>
                    <li class="active"><a href="https://ticket.opensciencegrid.org/index">Ticket</a></li>
	<li class="divider"></li>
	<li><a href="http://repo.grid.iu.edu">Repo</a></li>
	<li class="divider"></li>
	<li><a href="http://blogs.grid.iu.edu">Blog</a></li>
                    <li><a href="http://display.grid.iu.edu">Display</a></li>
                    <li><a href="http://osggoc.blogspot.com/">News</a></li>
                    </ul>
                </li>
            </ul>
            <ul class="nav pull-right">
                <li><a href="https://ticket.opensciencegrid.org/sso/">Login</a></li>            </ul>

            <div class="nav-collapse">
                <ul class="nav">
			 <li id="menu_submit"><a href="https://ticket.opensciencegrid.org/submit">Submit</a></li><li id="menu_view" class="dropdown"><a href="https://ticket.opensciencegrid.org/\#" class="dropdown-toggle" data-toggle="dropdown">View <b class="caret"></b></a><ul class="dropdown-menu"><li id="submenu_listopen"><a href="https://ticket.opensciencegrid.org/list/open">Open Tickets</a></li><li id="submenu_listrecentclose"><a href="https://ticket.opensciencegrid.org/list/recentclose">Recently Closed Tickets</a></li><li class="divider"></li><li id="submenu_alltickets"><a href="https://ticket.opensciencegrid.org/search?q=&amp;sort=id">All Tickets</a></li></ul></li>                </ul>

                <form class="navbar-search pull-right" action="https://ticket.opensciencegrid.org/viewer">
                    <input id="search" type="text" name="id" class="search-query span2" placeholder="Search Ticket" value=""/>
                </form>
            </div>
        </div>
      </div>
    </div>

<script type='text/javascript' src='lib/jquery.timeago.js'></script>
<script type='text/javascript' src='lib/byte2size.js'></script>
<style>
#updates .toolbar {
position: relative;
margin-top: 0px;
top: -10px;
font-weight: normal;
}
#updates a.anchor {
position: relative;
top: -50px;
}
#updates .selected pre {
animation:selected 2s;
animation-iteration-count: 2;
animation-direction: alternate;
-webkit-animation:selected 2s; 
-webkit-animation-iteration-count: 2;
-webkit-animation-direction: alternate;
box-shadow: inset 1px 1px 20px #9ad;
border: 1px solid #9ab;
margin: 5px 0px;
padding-left: 10px;
}
@keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ab;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
@-webkit-keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ad;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
#updates pre {
background-color: inherit;
line-height: 15px;
padding: 5px;
}
#updates .header {
color: #999;
}
#updates .update_history pre {
background-color: #eee;
color: #666;
font-size: 85%;
}
#updates .clickable {
cursor: pointer;
}
#updates .clickable:hover {
color: #D98719;
}
#updates .meta_information pre {
background-color: #fed;
}
#similar_tickets {
max-height: 300px;
overflow-y: auto;
pointer-events: none;
padding: 5px;
background-color: #f4f4f4;
}
.btn-toolbar {
margin-bottom: 0;
height: 30px;
}
#peers {
position: fixed;
bottom: 0px;
right: 0px;
z-index: 100;
list-style: none;
padding: 5px 0px 0px 5px;
margin: 0px;
background-color: white;
box-shadow: 0px 0px 10px white;
}
#peers li {
background-color: #ccc;
color: #000;
display: inline-block;
padding: 5px 10px;
margin-right: 5px;
position: relative;
}
/*
#peers li:hover {
background-color: #999;
cursor: pointer;
}
*/
#peers span.ip {
padding-left: 5px;
color: #666;
}
#peers .new {
bottom: -30px;
}
/*
#peers .me {
background-color: red;
}
*/
</style>

<div class="container-fluid">
<ul id="peers"></ul>
<div class="alert alert-danger"><a class="close" href="https://ticket.opensciencegrid.org/#" data-dismiss="alert">&times;</a>By the end of May 2018, the ticketing system at https://ticket.opensciencegrid.org will be retired and support will be provided at https://support.opensciencegrid.org. Throughout this transition the support email (help@opensciencegrid.org) will be available as a point of contact.<br><br>                                                   
                                                                                                                                                                                   
Please see the service migration page for details: https://opensciencegrid.github.io/technology/policy/service-migrations-spring-2018/#ticket</div><div id="presence" class="pull-right"></div><div class="ticketgui"><script type="text/javascript" src="lib/checktab.js"></script>

<script>
var expanded = false;
function expand_description() {
    var desc = $(".description");
    if(!expanded) {
        expanded = true;
        //expand to minheight
        var min = 250;
        if(desc.height() < min) {
            desc.animate({height: min}, 200);
        }
    }
}

$(document).ready(function() {
    $("input[name='nad']").datepicker({
        dateFormat: 'yy-mm-dd'
    });
});

</script>



<style>
.form-horizontal .control-label {
padding-top: inherit;
font-size:90%;
color:#666;
}
label {
margin-bottom: 0px;
}
.controls {
line-height: 18px;
}
</style>
<form class="form-horizontal" action="https://ticket.opensciencegrid.org/viewer/updatebasic?id=34814" method="post">
<div class="page-header">
    <h3><span class="muted">34814</span> / Jobs at OU_OSCER_ATLAS_MCORE fail with &#34;Connection error&#34;</h3>
</div>

<div class="row-fluid">
<div class="span5">
    <legend>Contact</legend>
    <div class="control-group">
        <label class="control-label">Full Name</label>
        <div class="controls">Michal.Svatos </div>
    </div>
    <div class="control-group">
        <label class="control-label">Email</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">Phone</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">CC</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>

    <legend>Details</legend>
    <div class="control-group"><label class="control-label">Associated VO</label><div class="controls">ATLAS</div></div><div class="control-group"><label class="control-label">Submitted Via</label><div class="controls">GGUS</div></div><div class="control-group"><label class="control-label">Submitter</label><div class="controls">Michal.Svatos</div></div><div class="control-group"><label class="control-label">Support Center</label><div class="controls">USATLAS</div></div><div class="control-group"><label class="control-label">Ticket Links</label><div class="controls"></div></div>
    <div class="control-group">
        <label class="control-label">Ticket Type</label>
        <div class="controls">Problem/Request</div>
    </div>
    <div class="control-group">
        <label class="control-label">Priority</label>
        <div class="controls">Normal</div>
    </div>
    <div class="control-group">
        <label class="control-label">Status</label>
        <div class="controls">
Closed</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action</label>
        <div class="controls">TX Incoming</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action Deadline</label>
        <div class="controls flag_red">2017-09-04</div>
    </div>

</div><!--span-->
<div class="span7">
    <legend>Assignees</legend>
    <div class="assignee" style="width: 60%">GGUS (Prod)&nbsp;<a target="_blank" href="https://ggus.eu/ws/ticket_info.php?ticket=130297">130297</a> <span class="muted"> / Ticket Exchange</span></div><div class="assignee" style="width: 60%">USATLAS (BNL Prod)&nbsp;<a target="_blank" href="https://rt.racf.bnl.gov/rt/Ticket/Display.html?id=27775">27775</a> <span class="muted"> / Ticket Exchange</span></div><div class="assignee" style="width: 60%">Software Support (Triage) <span class="muted"> / OSG Software Team</span></div>    <br>

    <legend>Assignees</legend>
    TODO
    <br>

    <style>
legend.noborder {
border-bottom: none;
}
</style>

<div id="attachment-list"/>
<script>
$(function () {
    var first = true;
    $.getJSON("attachment/list/34814", function (files) {
        //console.dir(files);
        var html = "<table class=\"table table-condensed\">";
        $(files).each(function() {
            if(first) {
                first = false;
                html += "<legend class=\"noborder\">Attachmenets</legend>";
            }
            html += "<tr class=\"attachment\">";
            html += "<td><img src=\""+this.thumbnail_url+"\"/></td>";
            html += "<td><a href=\""+this.url+"\" target=\"_blank\">"+this.name+"</a></td>";
            html += "<td>"+bytesToSize(this.size, 1)+"</td>";
            html += "</tr>";
        });
        html += "</table>";
        $("#attachment-list").html(html);
    });
});

function download(url) {
    window.open(url, "_blank");
}
</script>


</div><!--span-->
</div><!--row-fluid-->


</form>

</div>
<div id="updates" style="clear: both;">
    <legend>Past Updates
    <div class="btn-toolbar pull-right toolbar">
    </div><!--btn-toolbar-->
    </legend>

    <div class='update_description'><i onclick="document.location='34814#1505519989'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-09-15T23:59:49+00:00">Sep 15, 2017 11:59 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1505519989">&nbsp;</a></div><pre>This ticket was closed automatically. If this issue has not been resolved according your expectations or if you need further information, please submit a new ticket referencing this one.&#13;

-- by GGUS SYSTEM at Fri Sep 15 23&#58;59&#58;00 UTC 2017

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=130297' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=130297</a></pre></div><div class='update_description'><i onclick="document.location='34814#1504277129'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-09-01T14:45:29+00:00">Sep 1, 2017 02:45 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1504277129">&nbsp;</a></div><pre>problem with ownership was solved, there are no &#34;Connection error&#34; failures
closing this ticket&#13;

-- by Michal.Svatos at Fri Sep 01 14&#58;44&#58;20 UTC 2017

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=130297' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=130297</a></pre></div><div class='update_description'><i onclick="document.location='34814#1504277059'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-09-01T14:44:19+00:00">Sep 1, 2017 02:44 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1504277059">&nbsp;</a></div><pre>I don&#39;t know what the FILE and keep means. If you are curious I can dig out pilot factories maillist and you can discuss it with them.
Not all the jobs belong to David South. Some belong Junichi Tanaka (e.g. <a href='https&#58;//bigpanda.cern.ch/job?pandaid=3589290862' target='_blank' rel='nofollow'>https&#58;//bigpanda.cern.ch/job?pandaid=3589290862</a>) or ganga robot (e.g. <a href='https&#58;//bigpanda.cern.ch/job?pandaid=3589347027' target='_blank' rel='nofollow'>https&#58;//bigpanda.cern.ch/job?pandaid=3589347027</a>).
I agree about the ticket closure. I will close it.&#13;

-- by Michal.Svatos at Fri Sep 01 14&#58;43&#58;49 UTC 2017

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=130297' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=130297</a></pre></div><div class='update_description'><i onclick="document.location='34814#1504275987'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-09-01T14:26:27+00:00">Sep 1, 2017 02:26 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1504275987">&nbsp;</a></div><pre>Hi Michal,

hmm, I guess that doesn&#39;t help us much then, since we still don&#39;t have
any common source of the failed jobs ...

By the way, I noticed that the directory structure of the various
griduiXY nodes seems to be quite inconsistent, which confuses me.

<a href='http&#58;//gridui18.usatlas.bnl.gov&#58;25880/2017-09-01/OU_OSCER_ATLAS-' target='_blank' rel='nofollow'>http&#58;//gridui18.usatlas.bnl.gov&#58;25880/2017-09-01/OU_OSCER_ATLAS-</a>
htcondor-FILE/
<a href='http&#58;//gridui19.usatlas.bnl.gov&#58;25880/2017-09-01/OU_OSCER_ATLAS-' target='_blank' rel='nofollow'>http&#58;//gridui19.usatlas.bnl.gov&#58;25880/2017-09-01/OU_OSCER_ATLAS-</a>
htcondor-keep/
<a href='http&#58;//gridui19.usatlas.bnl.gov&#58;25880/2017-09-01/OU_OSCER_ATLAS-' target='_blank' rel='nofollow'>http&#58;//gridui19.usatlas.bnl.gov&#58;25880/2017-09-01/OU_OSCER_ATLAS-</a>
htcondor/
<a href='http&#58;//gridui20.usatlas.bnl.gov&#58;25880/2017-09-01/OU_OSCER_ATLAS-' target='_blank' rel='nofollow'>http&#58;//gridui20.usatlas.bnl.gov&#58;25880/2017-09-01/OU_OSCER_ATLAS-</a>
htcondor/
<a href='http&#58;//gridui21.usatlas.bnl.gov&#58;25880/2017-09-01/OU_OSCER_ATLAS-' target='_blank' rel='nofollow'>http&#58;//gridui21.usatlas.bnl.gov&#58;25880/2017-09-01/OU_OSCER_ATLAS-</a>
htcondor/

What do the -FILE and -keep mean?

I still think that this isn&#39;t a site issue, since only a fraction of
jobs fail on random compute OSCER nodes, as you can see here&#58;

<a href='http&#58;//bigpanda.cern.ch/wns/OU_OSCER_ATLAS/' target='_blank' rel='nofollow'>http&#58;//bigpanda.cern.ch/wns/OU_OSCER_ATLAS/</a>
<a href='http&#58;//bigpanda.cern.ch/wns/OU_OSCER_ATLAS_MCORE/' target='_blank' rel='nofollow'>http&#58;//bigpanda.cern.ch/wns/OU_OSCER_ATLAS_MCORE/</a>
<a href='http&#58;//bigpanda.cern.ch/wns/OU_OSCER_ATLAS_OPP/' target='_blank' rel='nofollow'>http&#58;//bigpanda.cern.ch/wns/OU_OSCER_ATLAS_OPP/</a>

Also, as far as I can see, all failed jobs are dsouth
AP_MCGN jobs, which seem to have a high failure rate everywhere, so
I&#39;m
beginning to believe that this is just another failure mode of these
type of job. Or have you seen one of these &#39;auth failed&#39; jobs that
wasn&#39;t from dsouth?

<div id='show_2023143877' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_2023143877'>At any rate, I propose to close this ticket, since the connection
error
issue has been resolved, and then try to track this issue elsewhere.

Thanks,

Horst

-- by hs@.... at Fri Sep 01 14&#58;26&#58;17 UTC 2017

GOCTX Source&#58; BNL Ticket&#58; Queue=SWTier2 ID=27775
</div><script type='text/javascript'>
        $('#show_2023143877').click(function() {
            $('#detail_2023143877').slideDown("normal");
            $('#show_2023143877').hide();
            $('#hide_2023143877').show();
        });
        $('#hide_2023143877').click(function() {
            $('#detail_2023143877').slideUp();
            $('#hide_2023143877').hide();
            $('#show_2023143877').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='34814#1504260431'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-09-01T10:07:11+00:00">Sep 1, 2017 10:07 AM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1504260431">&nbsp;</a></div><pre>oops, another typo -  auth failed jobs come from BNL-gridui[19..21]-jhover machines.&#13;

-- by Michal.Svatos at Fri Sep 01 10&#58;06&#58;16 UTC 2017

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=130297' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=130297</a></pre></div><div class='update_description'><i onclick="document.location='34814#1504258700'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-09-01T09:38:20+00:00">Sep 1, 2017 09:38 AM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1504258700">&nbsp;</a></div><pre>Hi,
you are right, of course, I meant to say OU_OSCER_ATLAS and OU_OSCER_ATLAS_MCORE. Current situation is that these errors now appear only on OU_OSCER_ATLAS, not on mcore or opp queue.
For the pilot factories, the queue gets pilots from BNL-gridui[18..21]-jhover machines (<a href='http&#58;//apfmon.lancs.ac.uk/q/OU_OSCER_ATLAS' target='_blank' rel='nofollow'>http&#58;//apfmon.lancs.ac.uk/q/OU_OSCER_ATLAS</a>), just like the rest of the queues in the US cloud (e.g. <a href='http&#58;//apfmon.lancs.ac.uk/BNL-gridui19-jhover' target='_blank' rel='nofollow'>http&#58;//apfmon.lancs.ac.uk/BNL-gridui19-jhover</a>)
I have run through all auth failed jobs the queue currently has (58 jobs in the last 12 hours) and they come from BNL-gridui[19..20]-jhover machines.&#13;

-- by Michal.Svatos at Fri Sep 01 09&#58;37&#58;14 UTC 2017

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=130297' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=130297</a></pre></div><div class='update_description'><i onclick="document.location='34814#1504214894'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-08-31T21:28:14+00:00">Aug 31, 2017 09:28 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1504214894">&nbsp;</a></div><pre>Hi Michal,

<font color='#7F7E6F'>&#62; For error occurrence, I can say I only see these errors at</font>
<font color='#7F7E6F'>&#62; OU_OSCER_ATLAS_MCORE and OU_OSCER_ATLAS_MCORE.</font>

I assume one of these should say OU_OSCER_ATLAS or OU_OSCER_ATLAS_OPP?
&#58;)

Either way, that shouldn&#39;t really mean much, since all three queues
feed
back into the same local queue (&#39;hep&#39;) on the same backend SLURM
cluster, so there is really NO difference WHATSOEVER in the way the
jobs
of these three queues are processed, so I don&#39;t think that&#39;s going to
help us figure out what&#39;s going on.

Is there a way to figure out which APF or panda server machines are
involved in processing these failed jobs? I still think that the voms
proxy is our primary suspect right now, since the error message
matches
exactly what we are seeing ...

Thanks,

Horst

-- by hs@.... at Thu Aug 31 21&#58;28&#58;00 UTC 2017

GOCTX Source&#58; BNL Ticket&#58; Queue=SWTier2 ID=27775</pre></div><div class='update_description'><i onclick="document.location='34814#1504209229'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-08-31T19:53:49+00:00">Aug 31, 2017 07:53 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1504209229">&nbsp;</a></div><pre>I just clicked through all the jobs that failed with that error and checked modificationhost. I mentioned it just in case. So, it could certainly be just a coincidence.
For error occurrence, I can say I only see these errors at OU_OSCER_ATLAS_MCORE and OU_OSCER_ATLAS_MCORE. So, it does not look as general problem with some APF. There is no pilot factory that would serve just those two queues.
Also, I don&#39;t know much about voms. So, I am not really helpful there.&#13;

-- by Michal.Svatos at Thu Aug 31 19&#58;53&#58;06 UTC 2017

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=130297' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=130297</a></pre></div><div class='update_description'><i onclick="document.location='34814#1504206876'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-08-31T19:14:36+00:00">Aug 31, 2017 07:14 PM UTC</time><a class="anchor" name="1504206876">&nbsp;</a></div><pre>Thanks Elizabeth!

I&#39;m not sure how how much the OSG software team can do about this, though, since this seems to be a CERN software issue, as the setup is done with

source /cvmfs/atlas.cern.ch/repo/sw/local/xrootdsetup.sh

Then again, the invalid voms-proxy is  created by xrdcp, not the setup; and it is also created when you use the xrdcp from xrootd-client-4.6.1-1.osg34.el6.x86_64, so maybe this is a more global problem we discovered here?

Thanks,

Horst

by /DC=org/DC=opensciencegrid/O=Open Science Grid/OU=People/CN=Horst Severini 27</pre></div><div class='update_description'><i onclick="document.location='34814#1504206112'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-08-31T19:01:52+00:00">Aug 31, 2017 07:01 PM UTC</time> by <b>echism</b><a class="anchor" name="1504206112">&nbsp;</a></div><pre>I&#39;m adding software. Software team, check out that VOMS proxy error.</pre></div><div class='update_description'><i onclick="document.location='34814#1504205181'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-08-31T18:46:21+00:00">Aug 31, 2017 06:46 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1504205181">&nbsp;</a></div><pre>Hi Michal,

hmm, that parser error is really weird. Too many items of what
exactly?

I just had a look at c506 and c526, and I can&#39;t find anything
obviously
wrong with them, and looking at the compute node summaries,

<a href='http&#58;//bigpanda.cern.ch/wns/OU_OSCER_ATLAS_MCORE/' target='_blank' rel='nofollow'>http&#58;//bigpanda.cern.ch/wns/OU_OSCER_ATLAS_MCORE/</a>
<a href='http&#58;//bigpanda.cern.ch/wns/OU_OSCER_ATLAS_OPP/' target='_blank' rel='nofollow'>http&#58;//bigpanda.cern.ch/wns/OU_OSCER_ATLAS_OPP/</a>
<a href='http&#58;//bigpanda.cern.ch/wns/OU_OSCER_ATLAS/' target='_blank' rel='nofollow'>http&#58;//bigpanda.cern.ch/wns/OU_OSCER_ATLAS/</a>

and they do show successfull jobs on these nodes as well,
so I&#39;m not convinced that there&#39;s a problem with these.
Maybe they just happened to land on these nodes?

Or do you have a way to verify that ALL of these jobs on these two
nodes
failed, and there are no failures of this type on any other nodes?

I still think we should explore this voms proxy issue further,
since it would explain the error perfectly. Maybe there are some APF
machines which are having problems getting the correct voms proxy?

Thanks,

Horst

-- by hs@.... at Thu Aug 31 18&#58;46&#58;07 UTC 2017

GOCTX Source&#58; BNL Ticket&#58; Queue=SWTier2 ID=27775</pre></div><div class='update_description'><i onclick="document.location='34814#1504198486'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-08-31T16:54:46+00:00">Aug 31, 2017 04:54 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1504198486">&nbsp;</a></div><pre>for me, voms info gives error without init&#58;
-sh-4.1$ voms-proxy-info -all
subject   &#58; /DC=cz/DC=cesnet-ca/O=Institute of Physics of the Academy of Sciences of the CR/CN=Michal Svatos/CN=1038422789
issuer    &#58; /DC=cz/DC=cesnet-ca/O=Institute of Physics of the Academy of Sciences of the CR/CN=Michal Svatos
identity  &#58; /DC=cz/DC=cesnet-ca/O=Institute of Physics of the Academy of Sciences of the CR/CN=Michal Svatos
Error checking proxy policy&#58;ProxyCertInfoExtension parser error, sequence contains too many items

and with init, it is similar to yours.

By the way, just an observation - all the auth failed jobs have failed on either c506.oscer.ou.edu or c526.oscer.ou.edu (in the last 12 hours).&#13;

-- by Michal.Svatos at Thu Aug 31 16&#58;53&#58;40 UTC 2017

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=130297' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=130297</a></pre></div><div class='update_description'><i onclick="document.location='34814#1504197250'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-08-31T16:34:10+00:00">Aug 31, 2017 04:34 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1504197250">&nbsp;</a></div><pre>Thanks Michal!

I just tried this myself from here, and I&#39;m seeing the same issue.
Without a voms-proxy, it prompts me for my pass phrase, and then
fails,
and I have this proxy&#58;

----
subject   &#58; /DC=org/DC=opensciencegrid/O=Open Science
Grid/OU=People/CN=Horst Severini 27/CN=616026118
issuer    &#58; /DC=org/DC=opensciencegrid/O=Open Science
Grid/OU=People/CN=Horst Severini 27
identity  &#58; /DC=org/DC=opensciencegrid/O=Open Science
Grid/OU=People/CN=Horst Severini 27
type      &#58; GT3-style proxy
strength  &#58; 512 bits
path      &#58; /tmp/x509up_u1502
timeleft  &#58; 11&#58;59&#58;53
key usage &#58; Digital Signature, Key Encipherment, Data Encipherment
----

So as you can see, there is no ATLAS proxy, but only a plain grid
proxy,
and only 512 bits, compared to 1024 bits when I get it myself&#58;

----
subject   &#58; /DC=org/DC=opensciencegrid/O=Open Science
Grid/OU=People/CN=Horst Severini 27/CN=1368128170
issuer    &#58; /DC=org/DC=opensciencegrid/O=Open Science
Grid/OU=People/CN=Horst Severini 27
identity  &#58; /DC=org/DC=opensciencegrid/O=Open Science
Grid/OU=People/CN=Horst Severini 27
type      &#58; RFC compliant proxy
strength  &#58; 1024 bits
path      &#58; /tmp/x509up_u1502
<div id='show_904334491' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_904334491'>timeleft  &#58; 48&#58;02&#58;22
key usage &#58; Digital Signature, Key Encipherment, Data Encipherment
=== VO atlas extension information ===
VO        &#58; atlas
subject   &#58; /DC=org/DC=opensciencegrid/O=Open Science
Grid/OU=People/CN=Horst Severini 27
issuer    &#58; /DC=ch/DC=cern/OU=computers/CN=lcg-voms2.cern.ch
attribute &#58; /atlas/Role=production/Capability=NULL
attribute &#58; /atlas/Role=NULL/Capability=NULL
attribute &#58; /atlas/lcg1/Role=NULL/Capability=NULL
attribute &#58; /atlas/usatlas/Role=NULL/Capability=NULL
attribute &#58; nickname = severini (atlas)
timeleft  &#58; 48&#58;02&#58;22
uri       &#58; lcg-voms2.cern.ch&#58;15001
----

Could you please try this again as well, in a fresh shell --
without a voms proxy -- and after the first failed attempt,
type &#39;voms-proxy-info -all&#39;, then get yourself an ATLAS voms proxy
like you did before, and then again &#39;voms-proxy-info -all&#39;,
and then compare the two?

Assuming you&#39;re seeing the same thing, then what does that mean?
That some of the pilots aren&#39;t getting a proper full ATLAS voms proxy?

Thanks a lot,

Horst

-- by hs@.... at Thu Aug 31 16&#58;33&#58;24 UTC 2017

GOCTX Source&#58; BNL Ticket&#58; Queue=SWTier2 ID=27775
</div><script type='text/javascript'>
        $('#show_904334491').click(function() {
            $('#detail_904334491').slideDown("normal");
            $('#show_904334491').hide();
            $('#hide_904334491').show();
        });
        $('#hide_904334491').click(function() {
            $('#detail_904334491').slideUp();
            $('#hide_904334491').hide();
            $('#show_904334491').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='34814#1504196326'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-08-31T16:18:46+00:00">Aug 31, 2017 04:18 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1504196326">&nbsp;</a></div><pre>Well, in the first case I meant without explicitly doing voms-proxy-init -voms atlas first. It authorized my on-the-fly, I guess. It did ask me for password of my certificate.
What are those CN, I don&#39;t know. They are not in voms (<a href='https&#58;//lcg-voms2.cern.ch&#58;8443/voms/atlas/user/load.action?userId=1820' target='_blank' rel='nofollow'>https&#58;//lcg-voms2.cern.ch&#58;8443/voms/atlas/user/load.action?userId=1820</a>)&#13;

-- by Michal.Svatos at Thu Aug 31 16&#58;18&#58;13 UTC 2017

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=130297' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=130297</a></pre></div><div class='update_description'><i onclick="document.location='34814#1504189672'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-08-31T14:27:52+00:00">Aug 31, 2017 02:27 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1504189672">&nbsp;</a></div><pre>Hi Michal,

well yes, you do need a voms proxy for this to work. ;)

Or maybe I&#39;m misunderstanding your comment? Even without the proxy, it
knew about your DN, which I find confusing. Did you have any kind of
grid or voms proxy before you made the first attempt?

I verified that your DN is in our grid-mapfile -- which makes sense,
since your second attempt worked. Is the DN of the failed attempt in
the
job we&#39;re looking at logged somewhere? Oh right, it&#39;s there in the log
file&#58;

<a href='http&#58;//gridui20.usatlas.bnl.gov&#58;25880/2017-08-30/OU_OSCER_ATLAS_MCORE-' target='_blank' rel='nofollow'>http&#58;//gridui20.usatlas.bnl.gov&#58;25880/2017-08-30/OU_OSCER_ATLAS_MCORE-</a>
htcondor/15244383.11.out

/OU=Organic Units/OU=Users/CN=jcaballe/CN=620333/CN=Jose Caballero
Bejar/CN=71719762/CN=1616068896/CN=1186660864
issuer    &#58; /DC=ch/DC=cern/OU=Organic
Units/OU=Users/CN=jcaballe/CN=620333/CN=Jose Caballero
Bejar/CN=71719762/CN=1616068896
identity  &#58; /DC=ch/DC=cern/OU=Organic
Units/OU=Users/CN=jcaballe/CN=620333/CN=Jose Caballero
Bejar/CN=71719762/CN=1616068896
type      &#58; RFC compliant proxy
strength  &#58; 1024 bits

And we do have that DN here as well&#58;

&#34;/DC=ch/DC=cern/OU=Organic
Units/OU=Users/CN=jcaballe/CN=620333/CN=Jose
Caballero Bejar&#34;

But there are three additional numbered CN&#39;s in the log file, which I
<div id='show_792915389' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_792915389'>don&#39;t understand. Does anyone know what these are?

Thanks,

Horst

-- by hs@.... at Thu Aug 31 14&#58;27&#58;02 UTC 2017

GOCTX Source&#58; BNL Ticket&#58; Queue=SWTier2 ID=27775
</div><script type='text/javascript'>
        $('#show_792915389').click(function() {
            $('#detail_792915389').slideDown("normal");
            $('#show_792915389').hide();
            $('#hide_792915389').show();
        });
        $('#hide_792915389').click(function() {
            $('#detail_792915389').slideUp();
            $('#hide_792915389').hide();
            $('#show_792915389').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='34814#1504187383'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-08-31T13:49:43+00:00">Aug 31, 2017 01:49 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1504187383">&nbsp;</a></div><pre>OK, I tried it from lxplus. When I did not setup voms proxy first, I got

-sh-4.1$ source /cvmfs/atlas.cern.ch/repo/sw/local/xrootdsetup.sh; xrdcp -np -f --cksum adler32&#58;print root&#58;//lutse1.lunet.edu&#58;1094//data/osg/cache/atlasdatadisk/rucio/mc16_13TeV/f7/a0/EVNT.11947245._000417.pool.root.1 EVNT.11947245._000417.pool.root.1
170831 15&#58;45&#58;24 24621 cryptossl_X509CreateProxy&#58; Your identity&#58; /DC=cz/DC=cesnet-ca/O=Institute of Physics of the Academy of Sciences of the CR/CN=Michal Svatos
Enter PEM pass phrase&#58;
Run&#58; [FATAL] Auth failed

when I set voms first them it worked&#58;

-sh-4.1$ source /cvmfs/atlas.cern.ch/repo/sw/local/xrootdsetup.sh; xrdcp -np -f --cksum adler32&#58;print root&#58;//lutse1.lunet.edu&#58;1094//data/osg/cache/atlasdatadisk/rucio/mc16_13TeV/f7/a0/EVNT.11947245._000417.pool.root.1 EVNT.11947245._000417.pool.root.1
adler32&#58; c50eb96f EVNT.11947245._000417.pool.root.1 283982440&#13;

-- by Michal.Svatos at Thu Aug 31 13&#58;49&#58;07 UTC 2017

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=130297' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=130297</a></pre></div><div class='update_description'><i onclick="document.location='34814#1504186865'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-08-31T13:41:05+00:00">Aug 31, 2017 01:41 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1504186865">&nbsp;</a></div><pre>Hi Michal,

yes, we&#39;ve seen these auth failures yesterday as well, and we can&#39;t
figure out where they&#39;re coming from. I just tried this command by
hand,
and it works perfectly fine&#58;

source /cvmfs/atlas.cern.ch/repo/sw/local/xrootdsetup.sh; xrdcp -np -f
--cksum adler32&#58;print
root&#58;//lutse1.lunet.edu&#58;1094//data/osg/cache/atlasdatadisk/rucio/mc16_13TeV/f7/a0/EVNT.11947245._000417.pool.root.1
EVNT.11947245._000417.pool.root.1

Could you please try this from lxplus and see if it works from there?
That might help us figure out if there&#39;s an issue depending on where
you&#39;re trying to copy from, or with what certificate.

Thanks a lot,

Horst

-- by hs@.... at Thu Aug 31 13&#58;40&#58;47 UTC 2017

GOCTX Source&#58; BNL Ticket&#58; Queue=SWTier2 ID=27775</pre></div><div class='update_description'><i onclick="document.location='34814#1504172858'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-08-31T09:47:38+00:00">Aug 31, 2017 09:47 AM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1504172858">&nbsp;</a></div><pre>Hi Horst,
the situation improved. Although there is not much running at the queue, most of jobs are successful. Just one thing to point out - there are several jobs which failed with authorization failed. It might be just some remnant after you ownership of the folder. So, I would close this ticket when/if they are gone.

example of auth failed&#58;
job&#58; <a href='https&#58;//bigpanda.cern.ch/job?pandaid=3587145481' target='_blank' rel='nofollow'>https&#58;//bigpanda.cern.ch/job?pandaid=3587145481</a>
log&#58; <a href='http&#58;//gridui19.usatlas.bnl.gov&#58;25880/2017-08-30/OU_OSCER_ATLAS_MCORE-htcondor/16129601.10.out' target='_blank' rel='nofollow'>http&#58;//gridui19.usatlas.bnl.gov&#58;25880/2017-08-30/OU_OSCER_ATLAS_MCORE-htcondor/16129601.10.out</a>
log extract&#58;
2017-08-30 21&#58;02&#58;17| 73257|base.py     | Executing command&#58; source /cvmfs/atlas.cern.ch/repo/sw/local/xrootdsetup.sh; xrdcp -np -f --cksum adler32&#58;print root&#58;//lutse1.lunet.edu&#58;1094//data/osg/cache/atlasdatadisk/rucio/mc16_13TeV/f7/a0/EVNT.11947245._000417.pool.root.1 /lscratch/6749403/Panda_Pilot_70751_1504126912/PandaJob/EVNT.11947245._000417.pool.root.1, timeout=3567
2017-08-30 21&#58;02&#58;18| 73257|base.py     | Command execution time&#58; 0&#58;00&#58;00.715055
2017-08-30 21&#58;02&#58;18| 73257|base.py     | is_timeout=False, rcode = 52, output = Run&#58; [FATAL] Auth failed
2017-08-30 21&#58;02&#58;18| 73257|base.py     | WARNING&#58; [is_stagein=True] Stage file command (source /cvmfs/atlas.cern.ch/repo/sw/local/xrootdsetup.sh; xrdcp -np -f --cksum adler32&#58;print root&#58;//lutse1.lunet.edu&#58;1094//data/osg/cache/atlasdatadisk/rucio/mc16_13TeV/f7/a0/EVNT.11947245._000417.pool.root.1 /lscratch/6749403/Panda_Pilot_70751_1504126912/PandaJob/EVNT.11947245._000417.pool.root.1) failed&#58; Status=52 Output=Run&#58; [FATAL] Auth failed
2017-08-30 21&#58;02&#58;18| 73257|mover.py    | Traceback (most recent call last)&#58;
File &#92;&#34;/lscratch/6749403/Panda_Pilot_70751_1504126912/PandaJob/movers/mover.py&#92;&#34;, line 668, in stagein_real
result = sitemover.get_data(fdata)
File &#92;&#34;/lscratch/6749403/Panda_Pilot_70751_1504126912/PandaJob/movers/base.py&#92;&#34;, line 299, in get_data
return self.stageIn(fspec.turl, dst, fspec)
File &#92;&#34;/lscratch/6749403/Panda_Pilot_70751_1504126912/PandaJob/movers/base.py&#92;&#34;, line 311, in stageIn
dst_checksum, dst_checksum_type = self.stageInFile(source, destination, fspec)
File &#92;&#34;/lscratch/6749403/Panda_Pilot_70751_1504126912/PandaJob/movers/xrdcp_sitemover.py&#92;&#34;, line 169, in stageInFile
return self._stagefile(source, destination, fspec.filesize, is_stagein=True)
File &#92;&#34;/lscratch/6749403/Panda_Pilot_70751_1504126912/PandaJob/movers/xrdcp_sitemover.py&#92;&#34;, line 140, in _stagefile
raise PilotException(error.get(&#39;error&#39;), code=rcode, state=state)
PilotException&#58; PilotException&#58; 1099&#58; Copy operation failed [is_stagein=True]&#58; Run&#58; [FATAL] Auth failed&#13;

-- by Michal.Svatos at Thu Aug 31 09&#58;47&#58;23 UTC 2017

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=130297' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=130297</a></pre></div><div class='update_description'><i onclick="document.location='34814#1504108689'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-08-30T15:58:09+00:00">Aug 30, 2017 03:58 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1504108689">&nbsp;</a></div><pre>Hi again,

okay, I think we fixed the problem. Apparently the last xrootd update
changed the ownership of /var/log/xrootd/ back to the default
xroot.xrootd, while it should be usatlas1.usatlas1, since it needs to
be
run as usatlas1 in order to allow write access to the SE. And that
prevented new log files from being created/written, which in turn
prevents xrootd from started in the first place.

I fixed this and restarted cmsd and xrootd, and now the xrdcp command
works. Can you please try this again from your end as well, to make
sure
everything works as expected again now?

Thanks a lot,

Horst

-- by hs@.... at Wed Aug 30 15&#58;57&#58;50 UTC 2017

GOCTX Source&#58; BNL Ticket&#58; Queue=SWTier2 ID=27775</pre></div><div class='update_description'><i onclick="document.location='34814#1504102272'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-08-30T14:11:12+00:00">Aug 30, 2017 02:11 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1504102272">&nbsp;</a></div><pre>Hi,
I don&#39;t know. The pilot collected logs, as the stdout, etc. are there (<a href='http&#58;//gridui19.usatlas.bnl.gov&#58;25880/2017-08-29/OU_OSCER_ATLAS_MCORE-htcondor/16118327.21.out' target='_blank' rel='nofollow'>http&#58;//gridui19.usatlas.bnl.gov&#58;25880/2017-08-29/OU_OSCER_ATLAS_MCORE-htcondor/16118327.21.out</a>). But the log itself log.11947268._013532.job.log.tgz.1 is not in rucio - command&#58;

-sh-4.1$ rucio list-files mc16_13TeV.410251.Sherpa_221_NNPDF30NNLO_ttbar_SingleLeptonM_MEPS_NLO.simul.log.e5450_e5984_s3126_tid11947268_00|grep log.11947268._013532.job.log.tgz

gives no results. But as the task is not finished and the log dataset no closed, it is possible it was not yet added to rucio and it could become available later. But I am just guessing.&#13;

-- by Michal.Svatos at Wed Aug 30 14&#58;07&#58;04 UTC 2017

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=130297' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=130297</a></pre></div><div class='update_description'><i onclick="document.location='34814#1504101026'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-08-30T13:50:26+00:00">Aug 30, 2017 01:50 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1504101026">&nbsp;</a></div><pre>Hi Michal,

you&#39;re right, the xrdcp command fails for me, too. And I just had a
look
at lutse1, and it seems like xrootd has crashed there. I tried
restarting it, but it refuses to, with some ipv6 misconfiguration
error.
We&#39;re investigating.

I understand that logs aren&#39;t available for lost heartbeat jobs, but
in
the case I was talking about was the conection error job you pointed
us to,

<a href='https&#58;//bigpanda.cern.ch/job?pandaid=3585235913' target='_blank' rel='nofollow'>https&#58;//bigpanda.cern.ch/job?pandaid=3585235913</a>

Do you understand why the &#39;logfiles&#39; link,

<a href='https&#58;//bigpanda.cern.ch/filebrowser/?guid=1439ce69-7a03-4a2e-bb09-' target='_blank' rel='nofollow'>https&#58;//bigpanda.cern.ch/filebrowser/?guid=1439ce69-7a03-4a2e-bb09-</a>
1200b2812e74&lfn=log.11947268._013532.job.log.tgz.1&site=OU_OSCER_ATLAS_MCORE&scope=mc16_13TeV

gives a RUCIO download error there? The log files themselves which are
linked separately in the following column are available, but not in
the
&#39;logfiles&#39; page.

Thanks a lot,

Horst

-- by hs@.... at Wed Aug 30 13&#58;50&#58;16 UTC 2017

GOCTX Source&#58; BNL Ticket&#58; Queue=SWTier2 ID=27775</pre></div><div class='update_description'><i onclick="document.location='34814#1504097414'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-08-30T12:50:14+00:00">Aug 30, 2017 12:50 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1504097414">&nbsp;</a></div><pre>Hi Horst,
so first, it is the xrdcp command that fails

source /cvmfs/atlas.cern.ch/repo/sw/local/xrootdsetup.sh; xrdcp -np -f --cksum adler32&#58;print root&#58;//lutse1.lunet.edu&#58;1094//data/osg/cache/atlasdatadisk/rucio/mc16_13TeV/bb/d5/EVNT.11947263._000868.pool.root.1 EVNT.11947263._000868.pool.root.1

I tried that on lxplus and also got Connection error

The lost heartbeats occasionally happen at low numbers at all sites but current high number of failures (<a href='https&#58;//bigpanda.cern.ch/jobs/?jobtype=production&display_limit=100&produsername=dsouth&transformation=Sim_tf.py&jobstatus=failed&jobstatus=failed&jobdispatchererrorcode=100&display_limit=100' target='_blank' rel='nofollow'>https&#58;//bigpanda.cern.ch/jobs/?jobtype=production&display_limit=100&produsername=dsouth&transformation=Sim_tf.py&jobstatus=failed&jobstatus=failed&jobdispatchererrorcode=100&display_limit=100</a>) is connected to problems of IN2P3-CC_VVL (<a href='https&#58;//ggus.eu/?mode=ticket_info&ticket_id=130246' target='_blank' rel='nofollow'>https&#58;//ggus.eu/?mode=ticket_info&ticket_id=130246</a>). As lost heartbeat means that the job was killed by batch, it also means there was no process that could save logs. So, no logs for lost heartbeats.&#13;

-- by Michal.Svatos at Wed Aug 30 12&#58;49&#58;26 UTC 2017

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=130297' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=130297</a></pre></div><div class='update_description'><i onclick="document.location='34814#1504095810'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-08-30T12:23:30+00:00">Aug 30, 2017 12:23 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1504095810">&nbsp;</a></div><pre>Hi Michal,

thanks for the notice. I noticed some failures like that yesterday,
but
couldn&#39;t figure out what was going on, either.

It&#39;s not clear to me where the timeout is coming from. Is the xrdcp
command against Lucille&#39;s SE timing out? The weird thing about that
would be that we have jobs running on OU_OSCER_ATLAS_OPP, which uses
the
same backend cluster and the same Lucille Storage, and they succeed
fine, so I don&#39;t think it&#39;s an obvious issue with either
OU_OSCER_ATLAS
or Lucille.

I&#39;m also noticing that almost all of these type of job, &#39;dsouth
AP_MCGN Sim_tf.py&#39;, seem to be failing at all sites, like this one at
HU&#58;

<a href='http&#58;//bigpanda.cern.ch/job?pandaid=3584596008' target='_blank' rel='nofollow'>http&#58;//bigpanda.cern.ch/job?pandaid=3584596008</a>

Most of them fail as lost heartbeat, which makes me think that maybe
they run out of memory and the batch system kills them?

Also, I cannot access the log files for the failed job at OSCER,
either.
Looking at

<a href='https&#58;//bigpanda.cern.ch/job?pandaid=3585235913' target='_blank' rel='nofollow'>https&#58;//bigpanda.cern.ch/job?pandaid=3585235913</a>

and then clicking on &#39;logfiles&#39;,

<a href='https&#58;//bigpanda.cern.ch/filebrowser/?guid=1439ce69-7a03-4a2e-bb09-' target='_blank' rel='nofollow'>https&#58;//bigpanda.cern.ch/filebrowser/?guid=1439ce69-7a03-4a2e-bb09-</a>
1200b2812e74&lfn=log.11947268._013532.job.log.tgz.1&site=OU_OSCER_ATLAS_MCORE&scope=mc16_13TeV

<div id='show_25982241' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_25982241'>gives me a RUCIO error.

So maybe these connection errors are only a secondary error caused by
the same &#39;root cause&#39;? I&#39;m not positive about that, but it&#39;s a theory
....

Please let me know if there&#39;s anything else I can look at which would
provide more information.

Thanks a lot,

Horst

-- by hs@.... at Wed Aug 30 12&#58;23&#58;09 UTC 2017

GOCTX Source&#58; BNL Ticket&#58; Queue=SWTier2 ID=27775
</div><script type='text/javascript'>
        $('#show_25982241').click(function() {
            $('#detail_25982241').slideDown("normal");
            $('#show_25982241').hide();
            $('#hide_25982241').show();
        });
        $('#hide_25982241').click(function() {
            $('#detail_25982241').slideUp();
            $('#hide_25982241').hide();
            $('#show_25982241').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='34814#1504084209'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-08-30T09:10:09+00:00">Aug 30, 2017 09:10 AM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1504084209">&nbsp;</a></div><pre>In the last 12 hours, all jobs at OU_OSCER_ATLAS_MCORE failed with

pilot, 1099&#58; STAGEIN FAILED&#58; Get error&#58; Staging input file failed&#58; lfn=EVNT.11947677._000241.pool.root.1, error=Copy operation failed [is_stagein=True]&#58; Run&#58; [FATAL] Connection error

example of failed job&#58;
<a href='https&#58;//bigpanda.cern.ch/job?pandaid=3585235913' target='_blank' rel='nofollow'>https&#58;//bigpanda.cern.ch/job?pandaid=3585235913</a>

stdout (<a href='http&#58;//gridui19.usatlas.bnl.gov&#58;25880/2017-08-29/OU_OSCER_ATLAS_MCORE-htcondor/16118327.21.out' target='_blank' rel='nofollow'>http&#58;//gridui19.usatlas.bnl.gov&#58;25880/2017-08-29/OU_OSCER_ATLAS_MCORE-htcondor/16118327.21.out</a>) extract&#58;
2017-08-29 19&#58;34&#58;15| 104360|base.py     | Executing command&#58; source /cvmfs/atlas.cern.ch/repo/sw/local/xrootdsetup.sh; xrdcp -np -f --cksum adler32&#58;print root&#58;//lutse1.lunet.edu&#58;1094//data/osg/cache/atlasdatadisk/rucio/mc16_13TeV/bb/d5/EVNT.11947263._000868.pool.root.1 /lscratch/6689782/Panda_Pilot_100868_1504035218/PandaJob/EVNT.11947263._000868.pool.root.1, timeout=3528
2017-08-29 19&#58;42&#58;17| 104360|base.py     | Command execution time&#58; 0&#58;08&#58;01.721077
2017-08-29 19&#58;42&#58;17| 104360|base.py     | is_timeout=False, rcode = 51, output = Run&#58; [FATAL] Connection error
2017-08-29 19&#58;42&#58;17| 104360|base.py     | WARNING&#58; [is_stagein=True] Stage file command (source /cvmfs/atlas.cern.ch/repo/sw/local/xrootdsetup.sh; xrdcp -np -f --cksum adler32&#58;print root&#58;//lutse1.lunet.edu&#58;1094//data/osg/cache/atlasdatadisk/rucio/mc16_13TeV/bb/d5/EVNT.11947263._000868.pool.root.1 /lscratch/6689782/Panda_Pilot_100868_1504035218/PandaJob/EVNT.11947263._000868.pool.root.1) failed&#58; Status=51 Output=Run&#58; [FATAL] Connection error
2017-08-29 19&#58;42&#58;17| 104360|mover.py    | Traceback (most recent call last)&#58;
File &#92;&#34;/lscratch/6689782/Panda_Pilot_100868_1504035218/PandaJob/movers/mover.py&#92;&#34;, line 668, in stagein_real
result = sitemover.get_data(fdata)
File &#92;&#34;/lscratch/6689782/Panda_Pilot_100868_1504035218/PandaJob/movers/base.py&#92;&#34;, line 299, in get_data
return self.stageIn(fspec.turl, dst, fspec)
File &#92;&#34;/lscratch/6689782/Panda_Pilot_100868_1504035218/PandaJob/movers/base.py&#92;&#34;, line 311, in stageIn
dst_checksum, dst_checksum_type = self.stageInFile(source, destination, fspec)
File &#92;&#34;/lscratch/6689782/Panda_Pilot_100868_1504035218/PandaJob/movers/xrdcp_sitemover.py&#92;&#34;, line 169, in stageInFile
return self._stagefile(source, destination, fspec.filesize, is_stagein=True)
File &#92;&#34;/lscratch/6689782/Panda_Pilot_100868_1504035218/PandaJob/movers/xrdcp_sitemover.py&#92;&#34;, line 140, in _stagefile
raise PilotException(error.get(&#39;error&#39;), code=rcode, state=state)
PilotException&#58; PilotException&#58; 1099&#58; Copy operation failed [is_stagein=True]&#58; Run&#58; [FATAL] Connection error

stderr (<a href='http&#58;//gridui19.usatlas.bnl.gov&#58;25880/2017-08-29/OU_OSCER_ATLAS_MCORE-htcondor/16118327.21.err' target='_blank' rel='nofollow'>http&#58;//gridui19.usatlas.bnl.gov&#58;25880/2017-08-29/OU_OSCER_ATLAS_MCORE-htcondor/16118327.21.err</a>) content&#58;
/cvmfs/atlas.cern.ch/repo/ATLASLocalRootBase/x86_64/rucio-clients/1.12.0/lib/python2.7/site-packages/requests/__init__.py&#58;80&#58; RequestsDependencyWarning&#58; urllib3 (1.21.1) or chardet (2.2.1) doesn&#39;t match a supported version!
RequestsDependencyWarning)
/cvmfs/atlas.cern.ch/repo/ATLASLocalRootBase/x86_64/rucio-clients/1.12.0/lib/python2.7/site-packages/requests/__init__.py&#58;80&#58; RequestsDependencyWarning&#58; urllib3 (1.21.1) or chardet (2.2.1) doesn&#39;t match a supported version!
RequestsDependencyWarning)
/cvmfs/atlas.cern.ch/repo/ATLASLocalRootBase/x86_64/rucio-clients/1.12.0/lib/python2.7/site-packages/requests/__init__.py&#58;80&#58; RequestsDependencyWarning&#58; urllib3 (1.21.1) or chardet (2.2.1) doesn&#39;t match a supported version!
RequestsDependencyWarning)
INFO&#58;main.base&#58;run&#58; pilot returned rc=0
DEBUG&#58;main.base&#58;run&#58; Leaving with rc=0.
DEBUG&#58;main.base&#58;run&#58; Leaving.
<div id='show_867524218' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_867524218'>DEBUG&#58;main.base&#58;post_run&#58; Starting.
DEBUG&#58;main.base&#58;post_run&#58; Starting.
DEBUG&#58;main.base&#58;exit&#58; Starting.
DEBUG&#58;main.base&#58;exit&#58; existing with RC = 0.
DEBUG&#58;main.base&#58;post_run&#58; Leaving.
DEBUG&#58;main.base&#58;post_run&#58; Leaving.
DEBUG&#58;main.base&#58;execute&#58; Leaving with Rc=0.

[Ticket Origin]
<a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=130297' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=130297</a>

[Ticket History]
Subject&#58; Jobs at OU_OSCER_ATLAS_MCORE fail with &#34;Connection error&#34;
Ticket Type&#58; TEAM
CC&#58; atlas-adc-cloud-US@....;
-- by Michal.Svatos at Wed Aug 30 09&#58;09&#58;47 UTC 2017
</div><script type='text/javascript'>
        $('#show_867524218').click(function() {
            $('#detail_867524218').slideDown("normal");
            $('#show_867524218').hide();
            $('#hide_867524218').show();
        });
        $('#hide_867524218').click(function() {
            $('#detail_867524218').slideUp();
            $('#hide_867524218').hide();
            $('#show_867524218').show();
        });
        </script></pre></div>
</div>
<script type="text/javascript">
function reset_anchor() {
    $("#updates .selected").removeClass("selected");
    var urls = document.location.toString().split('#'); 
    var anchor = urls[1];
    if(anchor) {
        $("a[name='"+anchor+"']").parents(".update_description").addClass("selected");
    }
}
function submitspam(ticket_id) {
    myret = confirm("Would you like to close this ticket as a security ticket, and submit the ticket content to akismet?");
    if(myret == true) {
        $.ajax("viewer/processspam?id="+ticket_id).done(function() {
            window.location.reload();
        });
    }
}

$(function() {
    reset_anchor();
    var ADDITIONAL_COOKIE_NAME = 'gocticket';
    var options = { path: '/', expires: 365};

    if(window.opener && window.opener.name == "gocticket_list") {
        v = $.cookie("closewindow");
        if(!v) {
            $("#closewindow").attr("checked", "checked"); //on by default
        } else {
            if(v == "checked") {
                $("#closewindow").attr("checked", "checked");
            }
        }
        $("#closewindow").click(function() {
            $.cookie("closewindow", $(this).attr('checked'), options);
        });
    } else {
        $("#closewindow_area").hide();
    }
    function updateTimeago() {
        $("time").timeago();
        setTimeout(updateTimeago, 30*1000);
    }
    updateTimeago();
    $(".description").focus(expand_description);
});
</script>
<hr/>
<footer>
<p>GOC Ticket Version 2.2 | <a href="https://ticket.opensciencegrid.org/goc/submit?app_issue_check=on&amp;app_issue_type=goc&amp;app_goc_url=https%3A%2F%2Fticket.opensciencegrid.org%3A443%2F34814">Report Bugs</a>
 | <a href="https://github.com/opensciencegrid/operations/blob/master/docs/privacy.md">Privacy Policy</a>
</p>

<p> <img align="top" src="images/tag_orange.png"/> Copyright 2018 The Trustees of Indiana University - Developed for Open Science Grid</p>
</footer>


</div><!--container-fluid-->
<script>
//used by searchbox
function parseValue(value) {
    var obj = new Object();
    var tokens = value.split("\t");
    obj.str = tokens[0];
    obj.count = tokens[1];
    return obj;
}

$(function() {
    //bootstrap-2.0.4 stuff
    $(".alert-message").alert();
    $(".dropdown-toggle").dropdown();
    $("span[rel='tooltip']").tooltip();
    $("a[rel=popover]").popover();

    //activate menu that user is currently on
    $("#menu_navigator").addClass("active"); 
    $("#submenu_").addClass("active"); 

    //translate zend validation error message to bootstrap
    $(".errors").addClass("alert").addClass("alert-error");

    //enable autocomplete for search box
    $("#search").autocomplete({
        source: function( request, response ) {
            $.ajax({
                url: "search/autocomplete",
                dataType: "text",
                data: {
                    //featureClass: "P",
                    //style: "full",
                    //maxRows: 12,
                    //name_startsWith: request.term
                    q: request.term
                },
                success: function( data ) {
                    response( $.map( data.split("\n"), function( item ) {
                        if(item == "") return null;
                        return {
                            value: item
                        }
                    }));
                }
            });
        },
        select: function(event, ui) {
            document.location = "search?q="+ui.item.value;
        }
    });
    
});
</script>


</body>
