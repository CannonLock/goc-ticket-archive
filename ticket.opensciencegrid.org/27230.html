<!DOCTYPE html>
<html lang="en">
  <head>
  <base href="">
    <title>[27230] set_default_remote_cerequirements is not passed to blahp</title>    <meta charset="utf-8" />
    <meta name="verify-v1" content="na5IcAJsZVOfEkboRxuIiZ1zpZgnZiWra+nKcS7nA/o=" />
    <meta name="google-site-verification" content="DLrk3ft4s8b-S2TloLCL2LD_t6wcTjgSluf5pmiu2kA" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />
    <link href="https://ticket.opensciencegrid.org/rss" rel="alternate" type="application/rss+xml" title="GOC Ticket Update feed" />

    <style type="text/css">
      body {
        padding-top: 50px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
     #search {
            width: 300px;
     }

    </style>

<script src="https://code.jquery.com/jquery-3.0.0.js"></script>
<script src="https://code.jquery.com/jquery-migrate-3.0.1.js"></script>

   <link href="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet"/>
    <script src="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/js/bootstrap.min.js"></script>

    <link href="https://netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"/>
    <link href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/themes/smoothness/jquery-ui.min.css" rel="stylesheet"/>
 <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>


    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/js/select2.min.js"></script>

    <link href="css/ticket.css" rel="stylesheet" />
    <script src="lib/jquery.cookie.js"></script>

    <link href="images/tag_orange.png" rel="icon" type="image/png"/>
  </head>

  <body>
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>

            <a class="brand" style="padding: 6px 0px 0px 6px;" href="http://opensciencegrid.org"><img src="images/osglogo.40x30.png"/></a>
            <ul class="nav">
                <li class="dropdown"><a href="https://ticket.opensciencegrid.org/#" class="dropdown-toggle" data-toggle="dropdown">GOC Ticket <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    <li><a href="https://my.opensciencegrid.org">MyOSG</a></li>
                    <li><a href="https://oim.opensciencegrid.org">OIM</a></li>
                    <li class="active"><a href="https://ticket.opensciencegrid.org/index">Ticket</a></li>
	<li class="divider"></li>
	<li><a href="http://repo.grid.iu.edu">Repo</a></li>
	<li class="divider"></li>
	<li><a href="http://blogs.grid.iu.edu">Blog</a></li>
                    <li><a href="http://display.grid.iu.edu">Display</a></li>
                    <li><a href="http://osggoc.blogspot.com/">News</a></li>
                    </ul>
                </li>
            </ul>
            <ul class="nav pull-right">
                <li><a href="https://ticket.opensciencegrid.org/sso/">Login</a></li>            </ul>

            <div class="nav-collapse">
                <ul class="nav">
			 <li id="menu_submit"><a href="https://ticket.opensciencegrid.org/submit">Submit</a></li><li id="menu_view" class="dropdown"><a href="https://ticket.opensciencegrid.org/\#" class="dropdown-toggle" data-toggle="dropdown">View <b class="caret"></b></a><ul class="dropdown-menu"><li id="submenu_listopen"><a href="https://ticket.opensciencegrid.org/list/open">Open Tickets</a></li><li id="submenu_listrecentclose"><a href="https://ticket.opensciencegrid.org/list/recentclose">Recently Closed Tickets</a></li><li class="divider"></li><li id="submenu_alltickets"><a href="https://ticket.opensciencegrid.org/search?q=&amp;sort=id">All Tickets</a></li></ul></li>                </ul>

                <form class="navbar-search pull-right" action="https://ticket.opensciencegrid.org/viewer">
                    <input id="search" type="text" name="id" class="search-query span2" placeholder="Search Ticket" value=""/>
                </form>
            </div>
        </div>
      </div>
    </div>

<script type='text/javascript' src='lib/jquery.timeago.js'></script>
<script type='text/javascript' src='lib/byte2size.js'></script>
<style>
#updates .toolbar {
position: relative;
margin-top: 0px;
top: -10px;
font-weight: normal;
}
#updates a.anchor {
position: relative;
top: -50px;
}
#updates .selected pre {
animation:selected 2s;
animation-iteration-count: 2;
animation-direction: alternate;
-webkit-animation:selected 2s; 
-webkit-animation-iteration-count: 2;
-webkit-animation-direction: alternate;
box-shadow: inset 1px 1px 20px #9ad;
border: 1px solid #9ab;
margin: 5px 0px;
padding-left: 10px;
}
@keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ab;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
@-webkit-keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ad;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
#updates pre {
background-color: inherit;
line-height: 15px;
padding: 5px;
}
#updates .header {
color: #999;
}
#updates .update_history pre {
background-color: #eee;
color: #666;
font-size: 85%;
}
#updates .clickable {
cursor: pointer;
}
#updates .clickable:hover {
color: #D98719;
}
#updates .meta_information pre {
background-color: #fed;
}
#similar_tickets {
max-height: 300px;
overflow-y: auto;
pointer-events: none;
padding: 5px;
background-color: #f4f4f4;
}
.btn-toolbar {
margin-bottom: 0;
height: 30px;
}
#peers {
position: fixed;
bottom: 0px;
right: 0px;
z-index: 100;
list-style: none;
padding: 5px 0px 0px 5px;
margin: 0px;
background-color: white;
box-shadow: 0px 0px 10px white;
}
#peers li {
background-color: #ccc;
color: #000;
display: inline-block;
padding: 5px 10px;
margin-right: 5px;
position: relative;
}
/*
#peers li:hover {
background-color: #999;
cursor: pointer;
}
*/
#peers span.ip {
padding-left: 5px;
color: #666;
}
#peers .new {
bottom: -30px;
}
/*
#peers .me {
background-color: red;
}
*/
</style>

<div class="container-fluid">
<ul id="peers"></ul>
<div class="alert alert-danger"><a class="close" href="https://ticket.opensciencegrid.org/#" data-dismiss="alert">&times;</a>By the end of May 2018, the ticketing system at https://ticket.opensciencegrid.org will be retired and support will be provided at https://support.opensciencegrid.org. Throughout this transition the support email (help@opensciencegrid.org) will be available as a point of contact.<br><br>                                                   
                                                                                                                                                                                   
Please see the service migration page for details: https://opensciencegrid.github.io/technology/policy/service-migrations-spring-2018/#ticket</div><div id="presence" class="pull-right"></div><div class="ticketgui"><script type="text/javascript" src="lib/checktab.js"></script>

<script>
var expanded = false;
function expand_description() {
    var desc = $(".description");
    if(!expanded) {
        expanded = true;
        //expand to minheight
        var min = 250;
        if(desc.height() < min) {
            desc.animate({height: min}, 200);
        }
    }
}

$(document).ready(function() {
    $("input[name='nad']").datepicker({
        dateFormat: 'yy-mm-dd'
    });
});

</script>



<style>
.form-horizontal .control-label {
padding-top: inherit;
font-size:90%;
color:#666;
}
label {
margin-bottom: 0px;
}
.controls {
line-height: 18px;
}
</style>
<form class="form-horizontal" action="https://ticket.opensciencegrid.org/viewer/updatebasic?id=27230" method="post">
<div class="page-header">
    <h3><span class="muted">27230</span> / set_default_remote_cerequirements is not passed to blahp</h3>
</div>

<div class="row-fluid">
<div class="span5">
    <legend>Contact</legend>
    <div class="control-group">
        <label class="control-label">Full Name</label>
        <div class="controls">John Dockendorf</div>
    </div>
    <div class="control-group">
        <label class="control-label">Email</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">Phone</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">CC</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>

    <legend>Details</legend>
    <div class="control-group"><label class="control-label">Resource Name</label><div class="controls">TAMU_BRAZOS_CE</div></div><div class="control-group"><label class="control-label">Associated VO</label><div class="controls">CMS</div></div><div class="control-group"><label class="control-label">Submitted Via</label><div class="controls">GOC Ticket/submit</div></div><div class="control-group"><label class="control-label">Submitter</label><div class="controls">John Dockendorf</div></div><div class="control-group"><label class="control-label">Support Center</label><div class="controls">USCMS_Tier3</div></div><div class="control-group"><label class="control-label">Ticket Links</label><div class="controls"></div></div>
    <div class="control-group">
        <label class="control-label">Ticket Type</label>
        <div class="controls">Problem/Request</div>
    </div>
    <div class="control-group">
        <label class="control-label">Priority</label>
        <div class="controls">Normal</div>
    </div>
    <div class="control-group">
        <label class="control-label">Status</label>
        <div class="controls">
Closed</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action</label>
        <div class="controls">WIP</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action Deadline</label>
        <div class="controls flag_red">2015-11-19</div>
    </div>

</div><!--span-->
<div class="span7">
    <legend>Assignees</legend>
    <div class="assignee" style="width: 60%">USCMS_Tier3 <span class="muted"> / OSG Support Centers</span></div><div class="assignee" style="width: 60%">Software Support (Triage) <span class="muted"> / OSG Software Team</span></div><div class="assignee" style="width: 60%">Brian Lin <span class="muted"> / OSG Software Team</span></div>    <br>

    <legend>Assignees</legend>
    TODO
    <br>

    <style>
legend.noborder {
border-bottom: none;
}
</style>

<div id="attachment-list"/>
<script>
$(function () {
    var first = true;
    $.getJSON("attachment/list/27230", function (files) {
        //console.dir(files);
        var html = "<table class=\"table table-condensed\">";
        $(files).each(function() {
            if(first) {
                first = false;
                html += "<legend class=\"noborder\">Attachmenets</legend>";
            }
            html += "<tr class=\"attachment\">";
            html += "<td><img src=\""+this.thumbnail_url+"\"/></td>";
            html += "<td><a href=\""+this.url+"\" target=\"_blank\">"+this.name+"</a></td>";
            html += "<td>"+bytesToSize(this.size, 1)+"</td>";
            html += "</tr>";
        });
        html += "</table>";
        $("#attachment-list").html(html);
    });
});

function download(url) {
    window.open(url, "_blank");
}
</script>


</div><!--span-->
</div><!--row-fluid-->


</form>

</div>
<div id="updates" style="clear: both;">
    <legend>Past Updates
    <div class="btn-toolbar pull-right toolbar">
        <div class="btn-group">
                <a class="btn btn-small" href="https://ticket.opensciencegrid.org/27230?sort=up&amp;"><i class="icon-arrow-up"></i> Sort</a>

        
        <a class="btn btn-small" href="https://ticket.opensciencegrid.org/27230?expandall=true&amp;">Expand Descriptions</a>        <a class="btn btn-small" target="_blank" href="mailto:osg@tick.globalnoc.iu.edu?subject=Open%20Science%20Grid%3A%20set_default_remote_cerequirements%20is%20not%20passed%20to%20blahp%20ISSUE%3D27230%20PROJ%3D71"><i class="icon-envelope"></i> Update w/Email</a>
        </div>
    </div><!--btn-toolbar-->
    </legend>

    <div class='update_description'><i onclick="document.location='27230#1447959102'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-11-19T18:51:42+00:00">Nov 19, 2015 06:51 PM UTC</time><a class="anchor" name="1447959102">&nbsp;</a></div><pre>The lines provided by Brian worked.  This can be marked resolved.

Thanks,
- Trey

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=jdockend/CN=750323/CN=John Lloyd Iii Dockendorf</pre></div><div class='update_description'><i onclick="document.location='27230#1447429320'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-11-13T15:42:00+00:00">Nov 13, 2015 03:42 PM UTC</time> by <b>Vince Neal</b><a class="anchor" name="1447429320">&nbsp;</a></div><pre>Hi Trey,

Did the below script from Brian work out?  Please let me know if I may assist.

Thank you,
Vince</pre></div><div class='update_description'><i onclick="document.location='27230#1447183582'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-11-10T19:26:22+00:00">Nov 10, 2015 07:26 PM UTC</time> by <b>Brian Lin</b><a class="anchor" name="1447183582">&nbsp;</a></div><pre>To avoid confusion with the route ad vs the job ad, I wrote something that would copy the job ad&#39;s attribute to a route attribute and then use that in the ifThenElse function&#58;

copy_JobName = &#34;orig_JobName&#34;; &#92;
set_JobName = ifThenElse(orig_JobName isnt null, orig_JobName, Cmd); &#92;
set_default_remote_cerequirements = strcat(&#34;JobName == &#92;&#34;&#34;, JobName, &#34;&#92;&#34;&#34;); &#92;

It worked for me, let me know how that works for you.

- Brian</pre></div><div class='update_description'><i onclick="document.location='27230#1446854795'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-11-07T00:06:35+00:00">Nov 7, 2015 12:06 AM UTC</time><a class="anchor" name="1446854795">&nbsp;</a></div><pre>I applied the set_JobName idea to the Local_PBS route (used by end-users) and my test job is failing with lines below in JobRouterLog

11/06/15 17&#58;23&#58;58 JobRouter (route=Local_PBS)&#58; Setting attribute remote_cerequirements to an evaluated expression
11/06/15 17&#58;23&#58;58 JobRouter (route=Local_PBS)&#58; Failed to evaluate remote_cerequirements
11/06/15 17&#58;23&#58;58 JobRouter failure (src=164372.0,route=Local_PBS)&#58; failed to apply route ClassAd modifications to target ad.

This what I added&#58;

set_JobName = ifThenElse(JobName isnt null, JobName, Cmd); &#92;
set_default_remote_cerequirements = strcat(&#34;JobName == &#92;&#34;&#34;, JobName, &#34;&#92;&#34;&#34;); &#92;

My test job had this line in the submit file&#58;

+JobName = &#34;TEST&#34;

If I use TARGET for JobName in the set_JobName expression, then I don&#39;t get errors but the JobName attribute is ignored.

Thanks,
- Trey

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=jdockend/CN=750323/CN=John Lloyd Iii Dockendorf</pre></div><div class='update_description'><i onclick="document.location='27230#1446848128'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-11-06T22:15:28+00:00">Nov 6, 2015 10:15 PM UTC</time> by <b>Christopher Pipes</b><a class="anchor" name="1446848128">&nbsp;</a></div><pre>Hello Trey and John,

Do either of you have an update on this?

Thanks,
Chris</pre></div><div class='update_description'><i onclick="document.location='27230#1446493752'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-11-02T19:49:12+00:00">Nov 2, 2015 07:49 PM UTC</time> by <b>Brian Lin</b><a class="anchor" name="1446493752">&nbsp;</a></div><pre>But knowing what we know about the issues with &#39;TARGET&#39; we were having before, your route may have to look something like this&#58;

set_JobName = ifThenElse(JobName isnt null, JobName, Cmd); &#92;
set_default_remote_cerequirements = strcat(&#34;JobName == &#92;&#34;&#34;, JobName, &#34;&#92;&#34;&#34;); &#92;</pre></div><div class='update_description'><i onclick="document.location='27230#1446493625'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-11-02T19:47:05+00:00">Nov 2, 2015 07:47 PM UTC</time> by <b>Brian Lin</b><a class="anchor" name="1446493625">&nbsp;</a></div><pre>There isn&#39;t a way for users to set the remote_cerequirements directly and it&#39;s probably good that they don&#39;t because the CE pre-builds a remote_cerequirements expression. You could write something in your routes like this&#58;

set_JobName = ifThenElse(TARGET.JobName isnt null, TARGET.JobName, Cmd); &#92;
set_default_remote_cerequirements = strcat(&#34;JobName == &#92;&#34;&#34;, JobName, &#34;&#92;&#34;&#34;); &#92;

Then a user could set &#39;+JobName&#39; in their submit file to override your default of setting the name to the command being run.</pre></div><div class='update_description'><i onclick="document.location='27230#1446485264'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-11-02T17:27:44+00:00">Nov 2, 2015 05:27 PM UTC</time><a class="anchor" name="1446485264">&nbsp;</a></div><pre>Thanks for the explanation.

One final question.  How would I allow a user to override the JobName I set via set_default_remote_cerequirements?  I tried the following line in a condor submit file and the value was not used&#58;

+remote_cerequirements = JobName == &#34;TEST&#34;

Is it even possible to have a user override what I set in set_default_remote_cerequirements?

Thanks,
- Trey

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=jdockend/CN=750323/CN=John Lloyd Iii Dockendorf</pre></div><div class='update_description'><i onclick="document.location='27230#1446157035'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-10-29T22:17:15+00:00">Oct 29, 2015 10:17 PM UTC</time> by <b>Brian Lin</b><a class="anchor" name="1446157035">&nbsp;</a></div><pre>Trey,

TARGET and MY are used when comparing two ClassAds
(<a href='http&#58;//research.cs.wisc.edu/htcondor/manual/v8.4/4_1HTCondor_s_ClassAd.html#46839' target='_blank' rel='nofollow'>http&#58;//research.cs.wisc.edu/htcondor/manual/v8.4/4_1HTCondor_s_ClassAd.html#46839</a>).
When you prepend attributes in the job router configuration with TARGET,
this means that the job router should check the attribute of the job
it&#39;s routing. If instead you used MY, it would prefer the attribute
that&#39;s defined in the job route itself.

As for the reason why it isn&#39;t working in this case, I&#39;ve got some
theories but I&#39;m not entirely sure. The scope may be changing out from
under us when the job router actually &#39;routes&#39; the job compared to when
it &#39;inspects&#39; a candidate job to be routed. I&#39;ll have to consult someone
on the HTCondor team about it.

- Brian

On 10/29/2015 04&#58;52 PM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='27230#1446155530'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-10-29T21:52:10+00:00">Oct 29, 2015 09:52 PM UTC</time><a class="anchor" name="1446155530">&nbsp;</a></div><pre>Ah, so basically the same as my original attempts but not using TARGET prefix for getting the Cmd value.  This is working, jobs now have somewhat useful names in SLURM.

For my own personal knowledge, and incase someone searches with similar problems, when would using &#34;TARGET.&#34; be appropriate?  Some other properties I set in the routes use TARGET.Owner and things like TARGET.x509UserProxyFirstFQAN.  I assume it&#39;s condor building the final string and passing it to BLAHP, so figured TARGET.Cmd would work.

Thanks,
- Trey

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=jdockend/CN=750323/CN=John Lloyd Iii Dockendorf</pre></div><div class='update_description'><i onclick="document.location='27230#1446154368'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-10-29T21:32:48+00:00">Oct 29, 2015 09:32 PM UTC</time> by <b>Brian Lin</b><a class="anchor" name="1446154368">&nbsp;</a></div><pre>Actually, it seems like you still need the quotes for it to be forwarded to your submit script&#58;

PBS route
set_default_remote_cerequirements = strcat(&#34;JobName == &#92;&#34;&#34;, Cmd, &#34;&#92;&#34;&#34;); &#92;
SAM Route
set_default_remote_cerequirements = strcat(&#34;Walltime == 60 && JobName == &#92;&#34;&#34;, Cmd, &#34;&#92;&#34;&#34;); &#92;</pre></div><div class='update_description'><i onclick="document.location='27230#1446152853'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-10-29T21:07:33+00:00">Oct 29, 2015 09:07 PM UTC</time> by <b>Brian Lin</b><a class="anchor" name="1446152853">&nbsp;</a></div><pre>Trey,

The documentation is certainly wrong on this one, after tinkering a bit, I found the following lines to work for me&#58;

PBS route
set_default_remote_cerequirements = strcat(&#34;JobName == &#34;, Cmd); &#92;
SAM Route
set_default_remote_cerequirements = strcat(&#34;Walltime == 60 && JobName == &#34;, Cmd); &#92;

- Brian</pre></div><div class='update_description'><i onclick="document.location='27230#1446055940'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-10-28T18:12:20+00:00">Oct 28, 2015 06:12 PM UTC</time><a class="anchor" name="1446055940">&nbsp;</a></div><pre>That worked.  I got #Foo=&#34;Bar&#34; in the batch script.  With that working I setup two cases.  One route, Local_PBS, with just setting JobName and one route, used by SAM tests, with JobName and Walltime.

Local_PBS route&#58;
set_default_remote_cerequirements = strcat(&#34;JobName == &#92;&#34;&#34;, TARGET.Cmd, &#34;&#92;&#34;&#34;); &#92;

SAM test route (1 hour walltime and JobName)&#58;
set_default_remote_cerequirements = strcat(&#34;Walltime == 60 && JobName == &#92;&#34;&#34;, TARGET.Cmd, &#34;&#92;&#34;&#34;); &#92;

/etc/blahp/pbs_local_submit_attributes.sh&#58;

if [ -n &#34;$Walltime&#34; ]; then
echo &#34;#PBS -l walltime=$Walltime&#34;
fi

if [ -n &#34;$JobName&#34; ]; then
echo &#34;#PBS -N $JobName&#34;
fi

echo &#34;#SBATCH --export=NONE&#34;

The Local_PBS batch script does not contain &#39;#PBS -N&#39;&#58;

#PBS -l walltime=300
#SBATCH --export=NONE
#PBS -q background-4g

SAM test batch script is missing the job name, but walltime worked just fine&#58;

#PBS -l walltime=60
#SBATCH --export=NONE
#PBS -q background-4g

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=jdockend/CN=750323/CN=John Lloyd Iii Dockendorf</pre></div><div class='update_description'><i onclick="document.location='27230#1446049712'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-10-28T16:28:32+00:00">Oct 28, 2015 04:28 PM UTC</time> by <b>Brian Lin</b><a class="anchor" name="1446049712">&nbsp;</a></div><pre>Does the following work instead?

set_default_remote_cerequirements = &#34;Foo == &#92;&#34;Bar&#92;&#34;&#34;

The strcat is unnecessary in this case since you&#39;re not concatenating multiple strings.</pre></div><div class='update_description'><i onclick="document.location='27230#1446048173'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-10-28T16:02:53+00:00">Oct 28, 2015 04:02 PM UTC</time><a class="anchor" name="1446048173">&nbsp;</a></div><pre>Hi Brian,

Can you please give this a look? It seems to me John is doing the correct stuff and this looks like a bug.

Edgar
OSG SOftware Support

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=Edgar Mauricio Fajardo Hernandez 2020</pre></div><div class='update_description'><i onclick="document.location='27230#1445988251'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-10-27T23:24:11+00:00">Oct 27, 2015 11:24 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1445988251">&nbsp;</a></div><pre>I am attempting to set job names coming from our CE that are not the randomized bl_* named given by BLAHP.  My end goal is to use the job names as a way of routing jobs using SLURM job_submit plugin.  So far I have set this in my JOB_ROUTER_ENTRIES

set_default_remote_cerequirements = strcat(&#34;JobName == &#92;&#34;&#34;, TARGET.Cmd, &#34;&#92;&#34;&#34;); &#92;

I have this in /etc/blahp/pbs_local_submit_attributes.sh

if [ -n &#34;$Walltime&#34; ]; then
echo &#34;#PBS -l walltime=$Walltime&#34;
fi

if [ -n &#34;$JobName&#34; ]; then
echo &#34;#PBS -N $JobName&#34;
fi

echo &#34;#SBATCH --export=NONE&#34;

These are the #PBS and #SBATCH directives present in a batch script generated by BLAHP.

# PBS directives&#58;
#PBS -S /bin/bash
#PBS -o /dev/null
#PBS -e /dev/null
#PBS -l mem=1900mb
#PBS -l pmem=1900mb
#PBS -l pvmem=1900mb
#SBATCH --export=NONE
#PBS -q hepx
#PBS -l nodes=1&#58;ppn=1
#PBS -m n

As a test I set arbitrary strings in set_default_remote_cerequirements = strcat(&#34;Foo == Bar&#34;) and then just did &#39;echo &#39;#Foo=$Foo&#34;&#39; and what was printed in the script was &#39;#Foo=&#39;.  It seems as though nothing from set_default_remote_cerequirements is getting passed to BLAHP.  I&#39;m going off the documentation here&#58; <a href='https&#58;//twiki.opensciencegrid.org/bin/view/Documentation/Release3/JobRouterRecipes#Setting_batch_system_directives' target='_blank' rel='nofollow'>https&#58;//twiki.opensciencegrid.org/bin/view/Documentation/Release3/JobRouterRecipes#Setting_batch_system_directives</a>

These are the packages I have installed currently.  The version for condor is a bit odd as I&#39;m using a version patched by Brian Bockelman to support per-user GlideIns.

blahp-1.18.13.bosco-4.osg32.el6.x86_64
<div id='show_1424976948' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_1424976948'>condor-8.2.9-1.0.osg33.el6.x86_64
condor-classads-8.2.9-1.0.osg33.el6.x86_64
condor-cron-1.0.9-3.osg32.el6.noarch
condor-procd-8.2.9-1.0.osg33.el6.x86_64
condor-python-8.2.9-1.0.osg33.el6.x86_64
htcondor-ce-1.15-1.osg32.el6.x86_64
htcondor-ce-client-1.15-1.osg32.el6.x86_64
htcondor-ce-pbs-1.15-1.osg32.el6.x86_64
osg-htcondor-ce-3.2-7.osg32.el6.x86_64
osg-htcondor-ce-pbs-3.2-7.osg32.el6.x86_64

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=jdockend/CN=750323/CN=John Lloyd Iii Dockendorf

</div><script type='text/javascript'>
        $('#show_1424976948').click(function() {
            $('#detail_1424976948').slideDown("normal");
            $('#show_1424976948').hide();
            $('#hide_1424976948').show();
        });
        $('#hide_1424976948').click(function() {
            $('#detail_1424976948').slideUp();
            $('#hide_1424976948').hide();
            $('#show_1424976948').show();
        });
        </script></pre></div><legend>Similar Recent Tickets <small>modified within the last 30 days</small></legend><div id="similar_tickets"><p class="muted">No similar tickets found.</p></div>
</div>
<script type="text/javascript">
function reset_anchor() {
    $("#updates .selected").removeClass("selected");
    var urls = document.location.toString().split('#'); 
    var anchor = urls[1];
    if(anchor) {
        $("a[name='"+anchor+"']").parents(".update_description").addClass("selected");
    }
}
function submitspam(ticket_id) {
    myret = confirm("Would you like to close this ticket as a security ticket, and submit the ticket content to akismet?");
    if(myret == true) {
        $.ajax("viewer/processspam?id="+ticket_id).done(function() {
            window.location.reload();
        });
    }
}

$(function() {
    reset_anchor();
    var ADDITIONAL_COOKIE_NAME = 'gocticket';
    var options = { path: '/', expires: 365};

    if(window.opener && window.opener.name == "gocticket_list") {
        v = $.cookie("closewindow");
        if(!v) {
            $("#closewindow").attr("checked", "checked"); //on by default
        } else {
            if(v == "checked") {
                $("#closewindow").attr("checked", "checked");
            }
        }
        $("#closewindow").click(function() {
            $.cookie("closewindow", $(this).attr('checked'), options);
        });
    } else {
        $("#closewindow_area").hide();
    }
    function updateTimeago() {
        $("time").timeago();
        setTimeout(updateTimeago, 30*1000);
    }
    updateTimeago();
    $(".description").focus(expand_description);
});
</script>
<hr/>
<footer>
<p>GOC Ticket Version 2.2 | <a href="https://ticket.opensciencegrid.org/goc/submit?app_issue_check=on&amp;app_issue_type=goc&amp;app_goc_url=https%3A%2F%2Fticket.opensciencegrid.org%3A443%2F27230">Report Bugs</a>
 | <a href="https://github.com/opensciencegrid/operations/blob/master/docs/privacy.md">Privacy Policy</a>
</p>

<p> <img align="top" src="images/tag_orange.png"/> Copyright 2018 The Trustees of Indiana University - Developed for Open Science Grid</p>
</footer>


</div><!--container-fluid-->
<script>
//used by searchbox
function parseValue(value) {
    var obj = new Object();
    var tokens = value.split("\t");
    obj.str = tokens[0];
    obj.count = tokens[1];
    return obj;
}

$(function() {
    //bootstrap-2.0.4 stuff
    $(".alert-message").alert();
    $(".dropdown-toggle").dropdown();
    $("span[rel='tooltip']").tooltip();
    $("a[rel=popover]").popover();

    //activate menu that user is currently on
    $("#menu_navigator").addClass("active"); 
    $("#submenu_").addClass("active"); 

    //translate zend validation error message to bootstrap
    $(".errors").addClass("alert").addClass("alert-error");

    //enable autocomplete for search box
    $("#search").autocomplete({
        source: function( request, response ) {
            $.ajax({
                url: "search/autocomplete",
                dataType: "text",
                data: {
                    //featureClass: "P",
                    //style: "full",
                    //maxRows: 12,
                    //name_startsWith: request.term
                    q: request.term
                },
                success: function( data ) {
                    response( $.map( data.split("\n"), function( item ) {
                        if(item == "") return null;
                        return {
                            value: item
                        }
                    }));
                }
            });
        },
        select: function(event, ui) {
            document.location = "search?q="+ui.item.value;
        }
    });
    
});
</script>


</body>
