<!DOCTYPE html>
<html lang="en">
  <head>
  <base href="/">
    <title>[15602] No gratia records from ui-gwms.uchicago.edu</title>    <meta charset="utf-8" />
    <meta name="verify-v1" content="na5IcAJsZVOfEkboRxuIiZ1zpZgnZiWra+nKcS7nA/o=" />
    <meta name="google-site-verification" content="DLrk3ft4s8b-S2TloLCL2LD_t6wcTjgSluf5pmiu2kA" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />
    <link href="https://ticket.opensciencegrid.org/rss" rel="alternate" type="application/rss+xml" title="GOC Ticket Update feed" />

    <style type="text/css">
      body {
        padding-top: 50px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
     #search {
            width: 300px;
     }

    </style>

<script src="https://code.jquery.com/jquery-3.0.0.js"></script>
<script src="https://code.jquery.com/jquery-migrate-3.0.1.js"></script>

   <link href="//netdna.bootstrapcdn.com/bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet"/>
    <script src="//netdna.bootstrapcdn.com/bootstrap/2.3.2/js/bootstrap.min.js"></script>

    <link href="//netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"/>
    <link href="//ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/themes/smoothness/jquery-ui.min.css" rel="stylesheet"/>
 <script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>


    <link href="//cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/css/select2.min.css" rel="stylesheet" />
    <script src="//cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/js/select2.min.js"></script>

    <link href="css/ticket.css" rel="stylesheet" />
    <script src="lib/jquery.cookie.js"></script>

    <link href="images/tag_orange.png" rel="icon" type="image/png"/>
    <script src='https://www.google.com/recaptcha/api.js'></script>
  </head>

  <body>
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>

            <a class="brand" style="padding: 6px 0px 0px 6px;" href="http://opensciencegrid.org"><img src="https://ticket.opensciencegrid.org/images/osglogo.40x30.png"/></a>
            <ul class="nav">
                <li class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown">GOC Ticket <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    <li><a href="https://my.opensciencegrid.org">MyOSG</a></li>
                    <li><a href="https://oim.opensciencegrid.org">OIM</a></li>
                    <li class="active"><a href="index">Ticket</a></li>
	<li class="divider"></li>
	<li><a href="http://repo.grid.iu.edu">Repo</a></li>
	<li class="divider"></li>
	<li><a href="http://blogs.grid.iu.edu">Blog</a></li>
                    <li><a href="http://display.grid.iu.edu">Display</a></li>
                    <li><a href="http://osggoc.blogspot.com/">News</a></li>
                    </ul>
                </li>
            </ul>
            <ul class="nav pull-right">
                <li><a href="https://ticket.opensciencegrid.org/sso/">Login</a></li>            </ul>

            <div class="nav-collapse">
                <ul class="nav">
			 <li id="menu_submit"><a href="https://ticket.opensciencegrid.org/submit">Submit</a></li><li id="menu_view" class="dropdown"><a href="\#" class="dropdown-toggle" data-toggle="dropdown">View <b class="caret"></b></a><ul class="dropdown-menu"><li id="submenu_listopen"><a href="https://ticket.opensciencegrid.org/list/open">Open Tickets</a></li><li id="submenu_listrecentclose"><a href="https://ticket.opensciencegrid.org/list/recentclose">Recently Closed Tickets</a></li><li class="divider"></li><li id="submenu_alltickets"><a href="https://ticket.opensciencegrid.org/search?q=&amp;sort=id">All Tickets</a></li></ul></li>                </ul>

                <form class="navbar-search pull-right" action="viewer">
                    <input id="search" type="text" name="id" class="search-query span2" placeholder="Search Ticket" value=""/>
                </form>
            </div>
        </div>
      </div>
    </div>

<script type='text/javascript' src='lib/jquery.timeago.js'></script>
<script type='text/javascript' src='lib/byte2size.js'></script>
<style>
#updates .toolbar {
position: relative;
margin-top: 0px;
top: -10px;
font-weight: normal;
}
#updates a.anchor {
position: relative;
top: -50px;
}
#updates .selected pre {
animation:selected 2s;
animation-iteration-count: 2;
animation-direction: alternate;
-webkit-animation:selected 2s; 
-webkit-animation-iteration-count: 2;
-webkit-animation-direction: alternate;
box-shadow: inset 1px 1px 20px #9ad;
border: 1px solid #9ab;
margin: 5px 0px;
padding-left: 10px;
}
@keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ab;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
@-webkit-keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ad;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
#updates pre {
background-color: inherit;
line-height: 15px;
padding: 5px;
}
#updates .header {
color: #999;
}
#updates .update_history pre {
background-color: #eee;
color: #666;
font-size: 85%;
}
#updates .clickable {
cursor: pointer;
}
#updates .clickable:hover {
color: #D98719;
}
#updates .meta_information pre {
background-color: #fed;
}
#similar_tickets {
max-height: 300px;
overflow-y: auto;
pointer-events: none;
padding: 5px;
background-color: #f4f4f4;
}
.btn-toolbar {
margin-bottom: 0;
height: 30px;
}
#peers {
position: fixed;
bottom: 0px;
right: 0px;
z-index: 100;
list-style: none;
padding: 5px 0px 0px 5px;
margin: 0px;
background-color: white;
box-shadow: 0px 0px 10px white;
}
#peers li {
background-color: #ccc;
color: #000;
display: inline-block;
padding: 5px 10px;
margin-right: 5px;
position: relative;
}
/*
#peers li:hover {
background-color: #999;
cursor: pointer;
}
*/
#peers span.ip {
padding-left: 5px;
color: #666;
}
#peers .new {
bottom: -30px;
}
/*
#peers .me {
background-color: red;
}
*/
</style>

<div class="container-fluid">
<ul id="peers"></ul>
<div class="alert alert-danger"><a class="close" href="#" data-dismiss="alert">&times;</a>By the end of May 2018, the ticketing system at https://ticket.opensciencegrid.org will be retired and support will be provided at https://support.opensciencegrid.org. Throughout this transition the support email (help@opensciencegrid.org) will be available as a point of contact.<br><br>                                                   
                                                                                                                                                                                   
Please see the service migration page for details: https://opensciencegrid.github.io/technology/policy/service-migrations-spring-2018/#ticket</div><div id="presence" class="pull-right"></div><div class="ticketgui"><script type="text/javascript" src="https://ticket.opensciencegrid.org/lib/checktab.js"></script>

<script>
var expanded = false;
function expand_description() {
    var desc = $(".description");
    if(!expanded) {
        expanded = true;
        //expand to minheight
        var min = 250;
        if(desc.height() < min) {
            desc.animate({height: min}, 200);
        }
    }
}

$(document).ready(function() {
    $("input[name='nad']").datepicker({
        dateFormat: 'yy-mm-dd'
    });
});

</script>



<style>
.form-horizontal .control-label {
padding-top: inherit;
font-size:90%;
color:#666;
}
label {
margin-bottom: 0px;
}
.controls {
line-height: 18px;
}
</style>
<form class="form-horizontal" action="https://ticket.opensciencegrid.org/viewer/updatebasic?id=15602" method="post">
<div class="page-header">
    <h3><span class="muted">15602</span> / No gratia records from ui-gwms.uchicago.edu</h3>
</div>

<div class="row-fluid">
<div class="span5">
    <legend>Contact</legend>
    <div class="control-group">
        <label class="control-label">Full Name</label>
        <div class="controls">Marco Mambelli</div>
    </div>
    <div class="control-group">
        <label class="control-label">Email</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">Phone</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">CC</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>

    <legend>Details</legend>
    <div class="control-group"><label class="control-label">Submitted Via</label><div class="controls">GOC Ticket/submit</div></div><div class="control-group"><label class="control-label">Submitter</label><div class="controls">Marco Mambelli</div></div><div class="control-group"><label class="control-label">Support Center</label><div class="controls">GRATIA Ops</div></div>
    <div class="control-group">
        <label class="control-label">Ticket Type</label>
        <div class="controls">Problem/Request</div>
    </div>
    <div class="control-group">
        <label class="control-label">Priority</label>
        <div class="controls">Normal</div>
    </div>
    <div class="control-group">
        <label class="control-label">Status</label>
        <div class="controls">
Closed</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action</label>
        <div class="controls">ENG Action</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action Deadline</label>
        <div class="controls flag_red">2013-06-19</div>
    </div>

</div><!--span-->
<div class="span7">
    <legend>Assignees</legend>
    <div class="assignee" style="width: 60%">FNAL (Prod)&nbsp;<a target="_blank" href="https://fermi.service-now.com/nav_to.do?uri=incident.do?sys_id=INC000000388190">INC000000388190</a> <span class="muted"> / Ticket Exchange</span></div><div class="assignee" style="width: 60%">Software Support (Triage) <span class="muted"> / OSG Software Team</span></div><div class="assignee" style="width: 60%">Suchandra Thapa <span class="muted"> / OSG Software Team</span></div>    <br>

    <legend>Assignees</legend>
    TODO
    <br>

    <style>
legend.noborder {
border-bottom: none;
}
</style>

<div id="attachment-list"/>
<script>
$(function () {
    var first = true;
    $.getJSON("https://ticket.opensciencegrid.org/attachment/list?id=15602", function (files) {
        //console.dir(files);
        var html = "<table class=\"table table-condensed\">";
        $(files).each(function() {
            if(first) {
                first = false;
                html += "<legend class=\"noborder\">Attachmenets</legend>";
            }
            html += "<tr class=\"attachment\">";
            html += "<td><img src=\""+this.thumbnail_url+"\"/></td>";
            html += "<td><a href=\""+this.url+"\" target=\"_blank\">"+this.name+"</a></td>";
            html += "<td>"+bytesToSize(this.size, 1)+"</td>";
            html += "</tr>";
        });
        html += "</table>";
        $("#attachment-list").html(html);
    });
});

function download(url) {
    window.open(url, "_blank");
}
</script>


</div><!--span-->
</div><!--row-fluid-->


</form>

</div>
<div id="updates" style="clear: both;">
    <legend>Past Updates
    <div class="btn-toolbar pull-right toolbar">
        <div class="btn-group">
                <a class="btn btn-small" href="/15602?sort=up&"><i class="icon-arrow-up"></i> Sort</a>

        
        <a class="btn btn-small" href="/15602?expandall=true&">Expand Descriptions</a>        <a class="btn btn-small" target="_blank" href="mailto:osg@tick.globalnoc.iu.edu?subject=Open%20Science%20Grid%3A%20No%20gratia%20records%20from%20ui-gwms.uchicago.edu%20ISSUE%3D15602%20PROJ%3D71"><i class="icon-envelope"></i> Update w/Email</a>
        </div>
    </div><!--btn-toolbar-->
    </legend>

    <div class='update_description'><i onclick="document.location='15602#1372186731'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-06-25T18:58:51+00:00">Jun 25, 2013 06:58 PM UTC</time> by <b>Marco Mambelli</b><a class="anchor" name="1372186731">&nbsp;</a></div><pre>Solved

Here a query&#58;
<a href='http&#58;//gratiaweb.grid.iu.edu/gratia/xml/project_hours_bar?facility=.*&probe=ui-gwms.uchicago.edu&resource-type=.*&vo=.*&grid=.*&user=.*&endtime=2013-06-25+23%3A59%3A59&exclude-vo=unknown%7Cother&includeFailed=true&exclude-role=NONE&span=86400&role=.*&starttime=2013-06-11+00%3A00%3A00&exclude-facility=NONE&exclude-user=NONE&includeSuccess=true' target='_blank' rel='nofollow'>http&#58;//gratiaweb.grid.iu.edu/gratia/xml/project_hours_bar?facility=.*&probe=ui-gwms.uchicago.edu&resource-type=.*&vo=.*&grid=.*&user=.*&endtime=2013-06-25+23%3A59%3A59&exclude-vo=unknown%7Cother&includeFailed=true&exclude-role=NONE&span=86400&role=.*&starttime=2013-06-11+00%3A00%3A00&exclude-facility=NONE&exclude-user=NONE&includeSuccess=true</a>

Here the summary&#58;
<a href='http&#58;//ui-gwms.uchicago.edu/gratia-summary/' target='_blank' rel='nofollow'>http&#58;//ui-gwms.uchicago.edu/gratia-summary/</a></pre></div><div class='update_description'><i onclick="document.location='15602#1372186562'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-06-25T18:56:02+00:00">Jun 25, 2013 06:56 PM UTC</time> by <b>Tanya Levshina</b><a class="anchor" name="1372186562">&nbsp;</a></div><pre>Marco,

I can see the project name&#58;
<a href='http&#58;//gratiaweb.grid.iu.edu/gratia/xml/project_hours_bar?facility=.*&probe=.*ui-gwms.uchicago.edu&resource-type=BatchPilot&vo=.*&user=.*&endtime=2013-06-25+23%3A59%3A59&exclude-vo=Unknown|unknown|other&includeFailed=true&exclude-role=NONE&span=86400&role=.*&starttime=2013-06-12+00%3A00%3A00&exclude-facility=NONE|Generic|Obsolete&exclude-user=NONE&includeSuccess=true&exclude-projectname=unknown|other' target='_blank' rel='nofollow'>http&#58;//gratiaweb.grid.iu.edu/gratia/xml/project_hours_bar?facility=.*&probe=.*ui-gwms.uchicago.edu&resource-type=BatchPilot&vo=.*&user=.*&endtime=2013-06-25+23%3A59%3A59&exclude-vo=Unknown|unknown|other&includeFailed=true&exclude-role=NONE&span=86400&role=.*&starttime=2013-06-12+00%3A00%3A00&exclude-facility=NONE|Generic|Obsolete&exclude-user=NONE&includeSuccess=true&exclude-projectname=unknown|other</a>

Is it what you would expect?
Thanks,
Tanya</pre></div><div class='update_description'><i onclick="document.location='15602#1372186277'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-06-25T18:51:17+00:00">Jun 25, 2013 06:51 PM UTC</time> by <b>Tanya Levshina</b><a class="anchor" name="1372186277">&nbsp;</a></div><pre>Suchandra,
I need to verify that the problem with gratia/condor still exists.
Tanya</pre></div><div class='update_description'><i onclick="document.location='15602#1372186175'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-06-25T18:49:35+00:00">Jun 25, 2013 06:49 PM UTC</time> by <b>Tanya Levshina</b><a class="anchor" name="1372186175">&nbsp;</a></div><pre>Hi Suchandra,
Could you please look at it. It is urgent.
Thanks,
Tanya</pre></div><div class='update_description'><i onclick="document.location='15602#1372171713'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-06-25T14:48:33+00:00">Jun 25, 2013 02:48 PM UTC</time> by <b>Marco Mambelli</b><a class="anchor" name="1372171713">&nbsp;</a></div><pre>I see some entries in gratia&#58;
<a href='http&#58;//gratiaweb.grid.iu.edu/gratia/xml/project_hours_bar?facility=.*&probe=ui-gwms.uchicago.edu&resource-type=.*&vo=.*&grid=.*&user=.*&endtime=2013-06-25+23%3A59%3A' target='_blank' rel='nofollow'>http&#58;//gratiaweb.grid.iu.edu/gratia/xml/project_hours_bar?facility=.*&probe=ui-gwms.uchicago.edu&resource-type=.*&vo=.*&grid=.*&user=.*&endtime=2013-06-25+23%3A59%3A</a>$

I set the project in the submit file to strings like&#58;
+ProjectName = marco-test-project2
but it seems to remain empty.

Then the summary is still empty&#58;
<a href='http&#58;//ui-gwms.uchicago.edu/gratia-summary/' target='_blank' rel='nofollow'>http&#58;//ui-gwms.uchicago.edu/gratia-summary/</a></pre></div><div class='update_description'><i onclick="document.location='15602#1372102907'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-06-24T19:41:47+00:00">Jun 24, 2013 07:41 PM UTC</time> by <b>Marco Mambelli</b><a class="anchor" name="1372102907">&nbsp;</a></div><pre>I did all the changes suggested to send record and override the VO to UC3 (all jobs are form the UC3 VO and still seems not to send any record).
Or better. The log seem to send them (see 2013-06-24.log attached) but the query seem to be still empty.</pre></div><div class='update_description'><i onclick="document.location='15602#1372098716'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-06-24T18:31:56+00:00">Jun 24, 2013 06:31 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1372098716">&nbsp;</a></div><pre>Marco, have you been able to do anything on this?

-- by timm at Mon Jun 24 18&#58;30&#58;44 UTC 2013

GOCTX Source&#58; <a href='https&#58;//fermi.service-now.com/nav_to.do?uri=incident.do?sys_id=INC000000388190' target='_blank' rel='nofollow'>https&#58;//fermi.service-now.com/nav_to.do?uri=incident.do?sys_id=INC000000388190</a></pre></div><div class='update_description'><i onclick="document.location='15602#1371699521'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-06-20T03:38:41+00:00">Jun 20, 2013 03:38 AM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1371699521">&nbsp;</a></div><pre>Marco, you have several options.  One thing you can do is to make a manual /var/lib/osg/user-vo-map
which manually maps your userid&#39;s to various vo&#39;s.   I believe there is also an option to
append a set of user-vo-map entries on to a automatically generated map.
You are one of the first sites to deploy the new probe that does the Quarantine unknown VO records.
Those records can be unquarantined but I will have to figure out how.

Where is your frontend submitting to, such that you don&#39;t need certificates for the individual users?
Is this internal to U of C or elsewhere?

Steve Timm

-- by timm at Thu Jun 20 03&#58;37&#58;10 UTC 2013

GOCTX Source&#58; <a href='https&#58;//fermi.service-now.com/nav_to.do?uri=incident.do?sys_id=INC000000388190' target='_blank' rel='nofollow'>https&#58;//fermi.service-now.com/nav_to.do?uri=incident.do?sys_id=INC000000388190</a></pre></div><div class='update_description'><i onclick="document.location='15602#1371680996'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-06-19T22:29:56+00:00">Jun 19, 2013 10:29 PM UTC</time> by <b>Marco Mambelli</b><a class="anchor" name="1371680996">&nbsp;</a></div><pre>Hi Steve,
I&#39;m installing the probe on a VO Frontend.
Glideins use my proxy (OSG VO) but it is not in the Condor jobs. I enabled the parameter suggested&#58;
MapUnknownToGroup=&#34;1&#34;
MapGroupToRole=&#34;1&#34;
VOOverride=&#34;UC3&#34;
Do I have to do anything to reprocess the older records?

Is then there any way to have Gratia picking up the VO from an attribute of the job (something that can be added in the submit file)?
Most jobs will be for the UC3 VO but not all.
Then Rob and Chander mentioned to have a &#34;ProjectName&#34; with the job and I don&#39;t see how this can then be retrieved in Gratia.
Thank you,
Marco</pre></div><div class='update_description'><i onclick="document.location='15602#1371675613'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-06-19T21:00:13+00:00">Jun 19, 2013 09:00 PM UTC</time> by <b>Steven Timm</b><a class="anchor" name="1371675613">&nbsp;</a></div><pre>The instructions do mention the CondorLocation under the heading
of Non-Standard condor install, but as you say, that is not your
problem here.

For setting the VO, you have to look at the &#34;Unusual Use Cases&#34;.
Do you have users without certificates?  If so follow one of the
two options there.

IF your users do have certificates, then for some reason that
information isn&#39;t getting to condor and it should be.

Are there files of the form history* in your /var/lib/gratia/data?
Normally that information would be gotten by reading the
condor history file.

Steve Timm

On Wed, 19 Jun 2013, Open Science Grid FootPrints wrote&#58;

<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='15602#1371671713'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-06-19T19:55:13+00:00">Jun 19, 2013 07:55 PM UTC</time> by <b>Marco Mambelli</b><a class="anchor" name="1371671713">&nbsp;</a></div><pre>The instructions did not mention the CondorLocation and the default should have been working since it is installed via RPM and it is in /usr/bin
{pre} -bash-3.2$ which condor_config_val
/usr/bin/condor_config_val
{pre}

The directory was empty (except a quarantine subdirectory)
I restarted condor and now I see some files. All the entries are in the &#34;quarantine&#34; subdir (/var/lib/gratia/data/quarantine).
I think earlier I did only a reconfig instead of a restart.

Now I see that the records are locally suppressed&#58;
14&#58;42&#58;41 CDT Gratia&#58; Info&#58; suppressing record with GlobalJobId condor.ui-gwms.uchicago.edu#50.19#1371670473 due to unknown or null VOName, will be quarantined in /var/lib/gratia/data/quarantine
14&#58;42&#58;41 CDT Gratia&#58; Moving transient input file&#58; /var/lib/gratia/data/history.50.19 to quarantine in /var/lib/gratia/data/quarantine
14&#58;42&#58;41 CDT Gratia&#58; OK&#58; No unsuppressed usage records in this packet&#58; not sending

How do I set the VOName?</pre></div><div class='update_description'><i onclick="document.location='15602#1371663986'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-06-19T17:46:26+00:00">Jun 19, 2013 05:46 PM UTC</time><a class="anchor" name="1371663986">&nbsp;</a></div><pre>There is no CondorLocation variable in the ProbeConfig file that is attached.
The probe needs that, it should be set to the location where the condor_version command lives.
By default /usr/bin.  If your condor executables are elsewhere then you need to set that for sure,
you might need to set it anyway.

Also--in /var/lib/gratia/data
do you see any files of the form history*
there?  There should be one for each job that completes.

Steve

by /DC=org/DC=doegrids/OU=People/CN=Steven Timm 74183</pre></div><div class='update_description'><i onclick="document.location='15602#1371663887'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-06-19T17:44:47+00:00">Jun 19, 2013 05:44 PM UTC</time> by <b>Marco Mambelli</b><a class="anchor" name="1371663887">&nbsp;</a></div><pre>It was in the email. I attached it also to the ticket.</pre></div><div class='update_description'><i onclick="document.location='15602#1371663610'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-06-19T17:40:10+00:00">Jun 19, 2013 05:40 PM UTC</time><a class="anchor" name="1371663610">&nbsp;</a></div><pre>PS--I see that marco sent ProbeConfig to me under separate cover.  Investigating.

Steve

by /DC=org/DC=doegrids/OU=People/CN=Steven Timm 74183</pre></div><div class='update_description'><i onclick="document.location='15602#1371663578'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-06-19T17:39:38+00:00">Jun 19, 2013 05:39 PM UTC</time><a class="anchor" name="1371663578">&nbsp;</a></div><pre>Marco, it looks like your attachment of ProbeConfig didn&#39;t work.
I think you have to go to the goc web ui to attach it directly there.  email attachments get stripped out.
From the gratia log error you show, I am guessing that there are a couple condor settings missing in the ProbeConfig
such that even though your condor is configured correctly, the ProbeConfig is not configured corrrectly to see it.
But will only know that for sure when I see the file.

by /DC=org/DC=doegrids/OU=People/CN=Steven Timm 74183</pre></div><div class='update_description'><i onclick="document.location='15602#1371663087'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-06-19T17:31:27+00:00">Jun 19, 2013 05:31 PM UTC</time> by <b>Marco Mambelli</b><a class="anchor" name="1371663087">&nbsp;</a></div><pre>I Sent Steve ProbeConfig

I have PER_JOB_HISTORY_DIR&#58;
-bash-3.2$ condor_config_val PER_JOB_HISTORY_DIR
/var/lib/gratia/data

The gratia log is complaining about PER_JOB_HISTORY_DIR but as I showed
above I have it set&#58;
12&#58;19&#58;32 CDT Gratia&#58; ERROR&#58; PER_JOB_HISTORY_DIR not set in condor config, please set it
12&#58;19&#58;32 CDT Gratia&#58; ERROR&#58; HTCondor is not configured correctly, exiting</pre></div><div class='update_description'><i onclick="document.location='15602#1371662549'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-06-19T17:22:29+00:00">Jun 19, 2013 05:22 PM UTC</time> by <b>Marco Mambelli</b><a class="anchor" name="1371662549">&nbsp;</a></div><pre>Reply from Steve Timm&#58;

Hi Marco--
I do see BatchPilot records from uc3-sub.uchicago.edu but none from ui-gwms.uchicago.edu.  In fact nothing at all from ui-gwms.uchicago.edu in the database.
What we do see is entries like this in the gratia logs on our side&#58;

2013-06-19 00&#58;11&#58;54,708 gratia.service(Thread-11) [FINE]&#58; RecordProcessor&#58; 0&#58; ProbeDetails (condor&#58;ui-gwms.uchicago.edu, recordId= Record (Id&#58;
ui-gwms.uchicago.edu&#58;19561.0 CreateTime&#58; 19 June 2013 at 00&#58;11&#58;29 GMT KeyInfo&#58; null) )&#58; Ignore duplicate of record 0

It appears that your probe is trying to send something but we are rejecting it as duplicates.

Can you send a copy of /etc/gratia/condor/ProbeConfig?
What do you see in the logs of /var/log/gratia?
Have you got the PER_JOB_HISTORY_DIR configured in your condor config?</pre></div><div class='update_description'><i onclick="document.location='15602#1371662503'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-06-19T17:21:43+00:00">Jun 19, 2013 05:21 PM UTC</time> by <b>Marco Mambelli</b><a class="anchor" name="1371662503">&nbsp;</a></div><pre>I setup the probe on ui-gwms.uchicago.edu following&#58; <a href='https&#58;//twiki.grid.iu.edu/bin/view/Accounting/ProbeConfigGlideinWMS' target='_blank' rel='nofollow'>https&#58;//twiki.grid.iu.edu/bin/view/Accounting/ProbeConfigGlideinWMS</a>

But the query seem empty&#58;
<a href='http&#58;//gratiaweb.grid.iu.edu/gratia/xml/project_hours_bar?facility=.*&probe=ui-gwms.uchicago.edu&resource-type=BatchPilot&vo=.*&grid=.*&user=.*&endtime=2013-06-18+23%3A59%3A59&exclude-vo=unknown%7Cother&includeFailed=true&exclude-role=NONE&span=86400&role=.*&starttime=2013-06-11+00%3A00%3A00&exclude-facility=NONE&exclude-user=NONE&includeSuccess=true' target='_blank' rel='nofollow'>http&#58;//gratiaweb.grid.iu.edu/gratia/xml/project_hours_bar?facility=.*&probe=ui-gwms.uchicago.edu&resource-type=BatchPilot&vo=.*&grid=.*&user=.*&endtime=2013-06-18+23%3A59%3A59&exclude-vo=unknown%7Cother&includeFailed=true&exclude-role=NONE&span=86400&role=.*&starttime=2013-06-11+00%3A00%3A00&exclude-facility=NONE&exclude-user=NONE&includeSuccess=true</a>

There is an email thread with Steve</pre></div><legend>Similar Recent Tickets <small>modified within the last 30 days</small></legend><div id="similar_tickets"><p class="muted">No similar tickets found.</p></div>
</div>
<script type="text/javascript">
function reset_anchor() {
    $("#updates .selected").removeClass("selected");
    var urls = document.location.toString().split('#'); 
    var anchor = urls[1];
    if(anchor) {
        $("a[name='"+anchor+"']").parents(".update_description").addClass("selected");
    }
}
function submitspam(ticket_id) {
    myret = confirm("Would you like to close this ticket as a security ticket, and submit the ticket content to akismet?");
    if(myret == true) {
        $.ajax("viewer/processspam?id="+ticket_id).done(function() {
            window.location.reload();
        });
    }
}

$(function() {
    reset_anchor();
    var ADDITIONAL_COOKIE_NAME = 'gocticket';
    var options = { path: '/', expires: 365};

    if(window.opener && window.opener.name == "gocticket_list") {
        v = $.cookie("closewindow");
        if(!v) {
            $("#closewindow").attr("checked", "checked"); //on by default
        } else {
            if(v == "checked") {
                $("#closewindow").attr("checked", "checked");
            }
        }
        $("#closewindow").click(function() {
            $.cookie("closewindow", $(this).attr('checked'), options);
        });
    } else {
        $("#closewindow_area").hide();
    }
    function updateTimeago() {
        $("time").timeago();
        setTimeout(updateTimeago, 30*1000);
    }
    updateTimeago();
    $(".description").focus(expand_description);
});
</script>
<hr/>
<footer>
<p>GOC Ticket Version 2.2 | <a href="https://ticket.opensciencegrid.org/goc/submit?app_issue_check=on&amp;app_issue_type=goc&amp;app_goc_url=https%3A%2F%2Fticket.opensciencegrid.org%3A443%2F15602">Report Bugs</a>
 | <a href="https://github.com/opensciencegrid/operations/blob/master/docs/privacy.md">Privacy Policy</a>
</p>

<p> <img align="top" src="/images/tag_orange.png"/> Copyright 2018 The Trustees of Indiana University - Developed for Open Science Grid</p>
</footer>


</div><!--container-fluid-->
<script src="https://ticket1.grid.iu.edu:8443/socket.io/socket.io.js"></script>
<script>
var chat = io.connect('https://ticket1.grid.iu.edu:8443');
chat.on('connect', function() {
    chat.emit('authenticate', {nodekey:'', ticketid: 15602});
});
chat.on('peers', function(peers) {
    $("#peers").html("");
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('peer_disconnect', function(pid) {
    $("#peer_"+pid).hide("slow");
});
chat.on('peer_connected', function(peers) {
    //expect only 1 peer connecting, but..
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('submit', function() {
    if(confirm("This ticket was updated. Do you want to refresh?")) {
        history.go(0);
    }
});

function addPeer(pid, peer) {
    var ipinfo = "";
    if(peer.ip != undefined) {
        ipinfo = "<span class=\"ip\">"+peer.ip+"</span>";
    }
    if(chat.io.engine.id == pid) {
        //don't display myself
        return;
    }
    var html = "<li class=\"new\" id=\"peer_"+pid+"\" class=\"peer\">"+peer.name+ipinfo+"</li>";
    $("#peers").prepend(html);
    $("#peers .new").animate({bottom: 0}, 1000, function() {$(this).removeClass("new")});
}

$(function() {
    $("#ticket_form").submit(function() {
        chat.emit('submit');
        return true;
    });
});
</script>
<script>
//used by searchbox
function parseValue(value) {
    var obj = new Object();
    var tokens = value.split("\t");
    obj.str = tokens[0];
    obj.count = tokens[1];
    return obj;
}

$(function() {
    //bootstrap-2.0.4 stuff
    $(".alert-message").alert();
    $(".dropdown-toggle").dropdown();
    $("span[rel='tooltip']").tooltip();
    $("a[rel=popover]").popover();

    //activate menu that user is currently on
    $("#menu_navigator").addClass("active"); 
    $("#submenu_").addClass("active"); 

    //translate zend validation error message to bootstrap
    $(".errors").addClass("alert").addClass("alert-error");

    //enable autocomplete for search box
    $("#search").autocomplete({
        source: function( request, response ) {
            $.ajax({
                url: "search/autocomplete",
                dataType: "text",
                data: {
                    //featureClass: "P",
                    //style: "full",
                    //maxRows: 12,
                    //name_startsWith: request.term
                    q: request.term
                },
                success: function( data ) {
                    response( $.map( data.split("\n"), function( item ) {
                        if(item == "") return null;
                        return {
                            value: item
                        }
                    }));
                }
            });
        },
        select: function(event, ui) {
            document.location = "search?q="+ui.item.value;
        }
    });
    
});
</script>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-69012-13");
pageTracker._trackPageview();
} catch(err) {}
</script>

</body>
