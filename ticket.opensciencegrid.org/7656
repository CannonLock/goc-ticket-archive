<!DOCTYPE html>
<html lang="en">
  <head>
  <base href="">
    <title>[7656] problem with jobmanager-pbs passing output through on OSG 1.0 install at UNM_HPC</title>    <meta charset="utf-8" />
    <meta name="verify-v1" content="na5IcAJsZVOfEkboRxuIiZ1zpZgnZiWra+nKcS7nA/o=" />
    <meta name="google-site-verification" content="DLrk3ft4s8b-S2TloLCL2LD_t6wcTjgSluf5pmiu2kA" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />
    <link href="https://ticket.opensciencegrid.org/rss" rel="alternate" type="application/rss+xml" title="GOC Ticket Update feed" />

    <style type="text/css">
      body {
        padding-top: 50px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
     #search {
            width: 300px;
     }

    </style>

<script src="https://code.jquery.com/jquery-3.0.0.js"></script>
<script src="https://code.jquery.com/jquery-migrate-3.0.1.js"></script>

   <link href="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet"/>
    <script src="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/js/bootstrap.min.js"></script>

    <link href="https://netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"/>
    <link href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/themes/smoothness/jquery-ui.min.css" rel="stylesheet"/>
 <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>


    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/js/select2.min.js"></script>

    <link href="css/ticket.css" rel="stylesheet" />
    <script src="lib/jquery.cookie.js"></script>

    <link href="images/tag_orange.png" rel="icon" type="image/png"/>
    <script src='https://www.google.com/recaptcha/api.js'></script>
  </head>

  <body>
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>

            <a class="brand" style="padding: 6px 0px 0px 6px;" href="http://opensciencegrid.org"><img src="images/osglogo.40x30.png"/></a>
            <ul class="nav">
                <li class="dropdown"><a href="https://ticket.opensciencegrid.org/#" class="dropdown-toggle" data-toggle="dropdown">GOC Ticket <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    <li><a href="https://my.opensciencegrid.org">MyOSG</a></li>
                    <li><a href="https://oim.opensciencegrid.org">OIM</a></li>
                    <li class="active"><a href="https://ticket.opensciencegrid.org/index">Ticket</a></li>
	<li class="divider"></li>
	<li><a href="http://repo.grid.iu.edu">Repo</a></li>
	<li class="divider"></li>
	<li><a href="http://blogs.grid.iu.edu">Blog</a></li>
                    <li><a href="http://display.grid.iu.edu">Display</a></li>
                    <li><a href="http://osggoc.blogspot.com/">News</a></li>
                    </ul>
                </li>
            </ul>
            <ul class="nav pull-right">
                <li><a href="https://ticket.opensciencegrid.org/sso/">Login</a></li>            </ul>

            <div class="nav-collapse">
                <ul class="nav">
			 <li id="menu_submit"><a href="https://ticket.opensciencegrid.org/submit">Submit</a></li><li id="menu_view" class="dropdown"><a href="https://ticket.opensciencegrid.org/\#" class="dropdown-toggle" data-toggle="dropdown">View <b class="caret"></b></a><ul class="dropdown-menu"><li id="submenu_listopen"><a href="https://ticket.opensciencegrid.org/list/open">Open Tickets</a></li><li id="submenu_listrecentclose"><a href="https://ticket.opensciencegrid.org/list/recentclose">Recently Closed Tickets</a></li><li class="divider"></li><li id="submenu_alltickets"><a href="https://ticket.opensciencegrid.org/search?q=&amp;sort=id">All Tickets</a></li></ul></li>                </ul>

                <form class="navbar-search pull-right" action="https://ticket.opensciencegrid.org/viewer">
                    <input id="search" type="text" name="id" class="search-query span2" placeholder="Search Ticket" value=""/>
                </form>
            </div>
        </div>
      </div>
    </div>

<script type='text/javascript' src='lib/jquery.timeago.js'></script>
<script type='text/javascript' src='lib/byte2size.js'></script>
<style>
#updates .toolbar {
position: relative;
margin-top: 0px;
top: -10px;
font-weight: normal;
}
#updates a.anchor {
position: relative;
top: -50px;
}
#updates .selected pre {
animation:selected 2s;
animation-iteration-count: 2;
animation-direction: alternate;
-webkit-animation:selected 2s; 
-webkit-animation-iteration-count: 2;
-webkit-animation-direction: alternate;
box-shadow: inset 1px 1px 20px #9ad;
border: 1px solid #9ab;
margin: 5px 0px;
padding-left: 10px;
}
@keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ab;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
@-webkit-keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ad;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
#updates pre {
background-color: inherit;
line-height: 15px;
padding: 5px;
}
#updates .header {
color: #999;
}
#updates .update_history pre {
background-color: #eee;
color: #666;
font-size: 85%;
}
#updates .clickable {
cursor: pointer;
}
#updates .clickable:hover {
color: #D98719;
}
#updates .meta_information pre {
background-color: #fed;
}
#similar_tickets {
max-height: 300px;
overflow-y: auto;
pointer-events: none;
padding: 5px;
background-color: #f4f4f4;
}
.btn-toolbar {
margin-bottom: 0;
height: 30px;
}
#peers {
position: fixed;
bottom: 0px;
right: 0px;
z-index: 100;
list-style: none;
padding: 5px 0px 0px 5px;
margin: 0px;
background-color: white;
box-shadow: 0px 0px 10px white;
}
#peers li {
background-color: #ccc;
color: #000;
display: inline-block;
padding: 5px 10px;
margin-right: 5px;
position: relative;
}
/*
#peers li:hover {
background-color: #999;
cursor: pointer;
}
*/
#peers span.ip {
padding-left: 5px;
color: #666;
}
#peers .new {
bottom: -30px;
}
/*
#peers .me {
background-color: red;
}
*/
</style>

<div class="container-fluid">
<ul id="peers"></ul>
<div class="alert alert-danger"><a class="close" href="https://ticket.opensciencegrid.org/#" data-dismiss="alert">&times;</a>By the end of May 2018, the ticketing system at https://ticket.opensciencegrid.org will be retired and support will be provided at https://support.opensciencegrid.org. Throughout this transition the support email (help@opensciencegrid.org) will be available as a point of contact.<br><br>                                                   
                                                                                                                                                                                   
Please see the service migration page for details: https://opensciencegrid.github.io/technology/policy/service-migrations-spring-2018/#ticket</div><div id="presence" class="pull-right"></div><div class="ticketgui"><script type="text/javascript" src="lib/checktab.js"></script>

<script>
var expanded = false;
function expand_description() {
    var desc = $(".description");
    if(!expanded) {
        expanded = true;
        //expand to minheight
        var min = 250;
        if(desc.height() < min) {
            desc.animate({height: min}, 200);
        }
    }
}

$(document).ready(function() {
    $("input[name='nad']").datepicker({
        dateFormat: 'yy-mm-dd'
    });
});

</script>



<style>
.form-horizontal .control-label {
padding-top: inherit;
font-size:90%;
color:#666;
}
label {
margin-bottom: 0px;
}
.controls {
line-height: 18px;
}
</style>
<form class="form-horizontal" action="https://ticket.opensciencegrid.org/viewer/updatebasic?id=7656" method="post">
<div class="page-header">
    <h3><span class="muted">7656</span> / problem with jobmanager-pbs passing output through on OSG 1.0 install at UNM_HPC</h3>
</div>

<div class="row-fluid">
<div class="span5">
    <legend>Contact</legend>
    <div class="control-group">
        <label class="control-label">Full Name</label>
        <div class="controls">Dan Felker</div>
    </div>
    <div class="control-group">
        <label class="control-label">Email</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">Phone</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">CC</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>

    <legend>Details</legend>
    
    <div class="control-group">
        <label class="control-label">Ticket Type</label>
        <div class="controls">Problem/Request</div>
    </div>
    <div class="control-group">
        <label class="control-label">Priority</label>
        <div class="controls">Normal</div>
    </div>
    <div class="control-group">
        <label class="control-label">Status</label>
        <div class="controls">
Closed</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action</label>
        <div class="controls">Eng Action</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action Deadline</label>
        <div class="controls flag_red">2010-04-01</div>
    </div>

</div><!--span-->
<div class="span7">
    <legend>Assignees</legend>
    <div class="assignee" style="width: 60%">CSC <span class="muted"> / OSG Support Centers</span></div><div class="assignee" style="width: 60%">Rob Quick <span class="muted"> / OSG GOC Management</span></div>    <br>

    <legend>Assignees</legend>
    TODO
    <br>

    <style>
legend.noborder {
border-bottom: none;
}
</style>

<div id="attachment-list"/>
<script>
$(function () {
    var first = true;
    $.getJSON("https://ticket.opensciencegrid.org/attachment/list?id=7656", function (files) {
        //console.dir(files);
        var html = "<table class=\"table table-condensed\">";
        $(files).each(function() {
            if(first) {
                first = false;
                html += "<legend class=\"noborder\">Attachmenets</legend>";
            }
            html += "<tr class=\"attachment\">";
            html += "<td><img src="https://ticket.opensciencegrid.org/\&quot;&quot;+this.thumbnail_url+&quot;\&quot;/"></td>";
            html += "<td><a href="https://ticket.opensciencegrid.org/\&quot;&quot;+this.url+&quot;\&quot;" target=\"_blank\">"+this.name+"</a></td>";
            html += "<td>"+bytesToSize(this.size, 1)+"</td>";
            html += "</tr>";
        });
        html += "</table>";
        $("#attachment-list").html(html);
    });
});

function download(url) {
    window.open(url, "_blank");
}
</script>


</div><!--span-->
</div><!--row-fluid-->


</form>

</div>
<div id="updates" style="clear: both;">
    <legend>Past Updates
    <div class="btn-toolbar pull-right toolbar">
        <div class="btn-group">
                <a class="btn btn-small" href="https://ticket.opensciencegrid.org/7656?sort=up&amp;"><i class="icon-arrow-up"></i> Sort</a>

        
        <a class="btn btn-small" href="https://ticket.opensciencegrid.org/7656?expandall=true&amp;">Expand Descriptions</a>        <a class="btn btn-small" target="_blank" href="mailto:osg@tick.globalnoc.iu.edu?subject=Open%20Science%20Grid%3A%20problem%20with%20jobmanager-pbs%20passing%20output%20through%20on%20OSG%201.0%20install%20at%20UNM_HPC%20ISSUE%3D7656%20PROJ%3D71"><i class="icon-envelope"></i> Update w/Email</a>
        </div>
    </div><!--btn-toolbar-->
    </legend>

    <div class='update_description'><i onclick="document.location='7656#1270571814'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2010-04-06T16:36:54+00:00">Apr 6, 2010 04:36 PM UTC</time> by <b>Rob Quick</b><a class="anchor" name="1270571814">&nbsp;</a></div><pre>I&#39;ve talked to Tim Thomas and he will initiate a maintenance period for UNM while they work through some organizational and technical issues with the UNM OSG resource. LIGO should temporarily suspend running jobs at UNM until this is worked out. Closing this ticket as it will remain unresolved until UNM is ready to return.</pre></div><div class='update_description'><i onclick="document.location='7656#1270050067'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2010-03-31T15:41:07+00:00">Mar 31, 2010 03:41 PM UTC</time> by <b>Daniel Felker</b><a class="anchor" name="1270050067">&nbsp;</a></div><pre>Rob,

Tim would like to contact you and give you a heads up, could you
please email him your phone #? (I&#39;ve CC&#39;d him on this so you can
contact him directly if you need).

Thanks,
Dan

On Mar 29, 2010, at 8&#58;10 AM, Open Science Grid FootPrints wrote&#58;

<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='7656#1269871852'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2010-03-29T14:10:52+00:00">Mar 29, 2010 02:10 PM UTC</time> by <b>Rob Quick</b><a class="anchor" name="1269871852">&nbsp;</a></div><pre>Adding Tim Thomas to the CC on this ticket. This issue was initially opened on October 21st, 2009.

It looks like Horst suggested a fix in mid-February and we are just waiting for it to be implemented at UNM. For complete ticket history please see&#58; <a href='7656.' target='_blank' rel='nofollow'>https&#58;//ticket.grid.iu.edu/goc/viewer?id=7656.</a>

I&#39;d like to see resolution or explanation from UNM as to when and if they can put this in place sometime this week. I will add it to the OSG Ops meeting and the OSG Production agendas. If I do not see response, I will attempt to call Tim directly and ask him of the status of UNM on OSG.

Thanks,
Rob</pre></div><div class='update_description'><i onclick="document.location='7656#1268681755'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2010-03-15T19:35:55+00:00">Mar 15, 2010 07:35 PM UTC</time> by <b>Rob Quick</b><a class="anchor" name="1268681755">&nbsp;</a></div><pre>Called Dan Felker to talk about this. UNM is going through some administrative changes and the person responsible for the UNM cluster has not yet been determined. I&#39;m going to add Dan Fraser to this ticket and plan on giving UNM a callback in a few weeks to see if they&#39;ve settled on a person who can work with us to get this fixed.</pre></div><div class='update_description'><i onclick="document.location='7656#1267825649'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2010-03-05T21:47:29+00:00">Mar 5, 2010 09:47 PM UTC</time> by <b>Christopher Pipes</b><a class="anchor" name="1267825649">&nbsp;</a></div><pre>Are there any updates on this issue?

Please submit problems, requests, and questions at&#58;
<a href='http&#58;//oim.grid.iu.edu/gocticket' target='_blank' rel='nofollow'>http&#58;//oim.grid.iu.edu/gocticket</a>

Thank You,

Christopher
OSG Grid Operations Center
goc@...., 317-278-9699
Visit the OSG Support Page&#58;
<a href='http&#58;//www.opensciencegrid.org/ops' target='_blank' rel='nofollow'>http&#58;//www.opensciencegrid.org/ops</a>
RSS&#58; <a href='http&#58;//www.grid.iu.edu/news' target='_blank' rel='nofollow'>http&#58;//www.grid.iu.edu/news</a></pre></div><div class='update_description'><i onclick="document.location='7656#1267218864'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2010-02-26T21:14:24+00:00">Feb 26, 2010 09:14 PM UTC</time> by <b>Kyle Gross</b><a class="anchor" name="1267218864">&nbsp;</a></div><pre>Dan,

Have you been able to fix this owner problem, yet? Pleas advise.

Thanks,
Kyle</pre></div><div class='update_description'><i onclick="document.location='7656#1266540338'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2010-02-19T00:45:38+00:00">Feb 19, 2010 12:45 AM UTC</time> by <b>Christopher Pipes</b><a class="anchor" name="1266540338">&nbsp;</a></div><pre>Dan,

Have you been able to fix this owner problem, yet? Pleas advise.

Thanks,

Christopher</pre></div><div class='update_description'><i onclick="document.location='7656#1266006366'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2010-02-12T20:26:06+00:00">Feb 12, 2010 08:26 PM UTC</time> by <b>Horst Severini</b><a class="anchor" name="1266006366">&nbsp;</a></div><pre>Hi Kyle,

I told Dan how to fix it, I&#39;m not the admin of that machine,
so I can&#39;t do it.

Thanks,

Horst</pre></div><div class='update_description'><i onclick="document.location='7656#1265994535'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2010-02-12T17:08:55+00:00">Feb 12, 2010 05:08 PM UTC</time> by <b>Kyle Gross</b><a class="anchor" name="1265994535">&nbsp;</a></div><pre>Horst,

Have you been able to get the owner problem fixed?

Kyle</pre></div><div class='update_description'><i onclick="document.location='7656#1265399047'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2010-02-05T19:44:07+00:00">Feb 5, 2010 07:44 PM UTC</time> by <b>Horst Severini</b><a class="anchor" name="1265399047">&nbsp;</a></div><pre>Hi Christopher,

I remembered yesterday that VDT can&#39;t start on m3 anymore since someone
changed the ownership of the entire OSG tree to the user osg,
which I had noticed some time just before or after Christmas, don&#39;t remember
anymore exactly.

So I asked Dan to restore it from a backup which is in that area
(we don&#39;t know exactly who made it, but presumably the same person
who changed the ownership).

So hopefully after that has been done, Dan can restart the services,
and hopefully then we can continue debugging this!

Thanks,
have a good weekend,

Horst</pre></div><div class='update_description'><i onclick="document.location='7656#1265398787'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2010-02-05T19:39:47+00:00">Feb 5, 2010 07:39 PM UTC</time> by <b>Christopher Pipes</b><a class="anchor" name="1265398787">&nbsp;</a></div><pre>Thanks Shreyas. Dan were you able to turn on vdt-control?

Thanks,

Christopher</pre></div><div class='update_description'><i onclick="document.location='7656#1264796948'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2010-01-29T20:29:08+00:00">Jan 29, 2010 08:29 PM UTC</time> by <b>Shreyas Cholia</b><a class="anchor" name="1264796948">&nbsp;</a></div><pre>Hi Christopher

I am not the admin for this site. I may eventually be helping them out
with figuring out why the globus PBS interface is not working, but I
am not the person that does the VDT or PBS installation here.

-Shreyas

On Fri, Jan 29, 2010 at 10&#58;53 AM, Open Science Grid FootPrints
&#60;osg@....&#62; wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='7656#1264791216'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2010-01-29T18:53:36+00:00">Jan 29, 2010 06:53 PM UTC</time> by <b>Christopher Pipes</b><a class="anchor" name="1264791216">&nbsp;</a></div><pre>Dan, and Shreyas,

Were either of you able turn on vdt-control?

Thanks,

Christopher</pre></div><div class='update_description'><i onclick="document.location='7656#1264190887'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2010-01-22T20:08:07+00:00">Jan 22, 2010 08:08 PM UTC</time> by <b>Horst Severini</b><a class="anchor" name="1264190887">&nbsp;</a></div><pre>HI Dan, and Shreyas,

I just looked at m3 again, and while it&#39;s up and responding,
it seems like most of the OSG stack is turned off, except for apache.

Did anyone turn that off on purpose?
If not, could you please turn it back on?

. /opt/osg/setup.sh
vdt-control --off

# make sure no more osg processes running

vdt-control --on

Thanks,

Horst</pre></div><div class='update_description'><i onclick="document.location='7656#1263325147'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2010-01-12T19:39:07+00:00">Jan 12, 2010 07:39 PM UTC</time> by <b>Shreyas Cholia</b><a class="anchor" name="1263325147">&nbsp;</a></div><pre>That is what I thought - let me know when the site is up, and I can help
debug the PBS issues.

-Shreyas

On 1/12/10 11&#58;24 AM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='7656#1263324251'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2010-01-12T19:24:11+00:00">Jan 12, 2010 07:24 PM UTC</time> by <b>Horst Severini</b><a class="anchor" name="1263324251">&nbsp;</a></div><pre>Hi Shreyas and Dan and all,

<font color='#7F7E6F'>&#62; I haven&#39;t looked at this in a while, because of all the PBS problems</font>
<font color='#7F7E6F'>&#62; we were having. Let me know if I need to do anything.</font>

It would be nice if you could help us trouble shoot why the PBS jobmanager
at UNM_HPC doesn&#39;t propagate the stdout and stderr back from PBS to globus.

But it seems like m3 is currently down, since

globus-job-run m3.alliance.unm.edu/jobmanager-pbs /bin/hostname

errors out, and I can&#39;t even ssh to the machine right now, it just hangs.

Dan, could you please have a look?

Thanks a lot,

Horst</pre></div><div class='update_description'><i onclick="document.location='7656#1263253807'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2010-01-11T23:50:07+00:00">Jan 11, 2010 11:50 PM UTC</time> by <b>Shreyas Cholia</b><a class="anchor" name="1263253807">&nbsp;</a></div><pre>I haven&#39;t looked at this in a while, because of all the PBS problems
we were having. Let me know if I need to do anything.

-S

On Fri, Jan 8, 2010 at 10&#58;47 AM, Open Science Grid FootPrints
&#60;osg@....&#62; wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='7656#1262976426'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2010-01-08T18:47:06+00:00">Jan 8, 2010 06:47 PM UTC</time> by <b>Horst Severini</b><a class="anchor" name="1262976426">&nbsp;</a></div><pre>Hi Christopher,

Tim and I were just talking about that yesterday, that we should
follow up on this again.

Dan or Shreyas, were you able to make any progress on this?

Thanks,

Horst</pre></div><div class='update_description'><i onclick="document.location='7656#1262975598'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2010-01-08T18:33:18+00:00">Jan 8, 2010 06:33 PM UTC</time> by <b>Christopher Pipes</b><a class="anchor" name="1262975598">&nbsp;</a></div><pre>Horst,

Are there any updates on this issue?

Thanks,

Christopher</pre></div><div class='update_description'><i onclick="document.location='7656#1260214507'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2009-12-07T19:35:07+00:00">Dec 7, 2009 07:35 PM UTC</time> by <b>Horst Severini</b><a class="anchor" name="1260214507">&nbsp;</a></div><pre>Hi Chris,

yes, maybe it&#39;d be a good idea to postpone this until the first of January,
since I&#39;ll be gone from today until the 31st.

Thanks,

Horst</pre></div><div class='update_description'><i onclick="document.location='7656#1260213349'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2009-12-07T19:15:49+00:00">Dec 7, 2009 07:15 PM UTC</time> by <b>Christopher Pipes</b><a class="anchor" name="1260213349">&nbsp;</a></div><pre>Horst,

Is there a specific time that I should push this ticket out till since you will be out of the country? Or is there anyone else that might be of some assistance until you return?

Thanks,

Christopher</pre></div><div class='update_description'><i onclick="document.location='7656#1259876768'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2009-12-03T21:46:08+00:00">Dec 3, 2009 09:46 PM UTC</time> by <b>Horst Severini</b><a class="anchor" name="1259876768">&nbsp;</a></div><pre>Hi Shreyas,

well, m3 isn&#39;t down, the firewall just blocks pings.

That said, the OSG stack is currently still not working,
and I think that is because someone must&#39;ve changed the ownership
of the entire osg-1.0.0 tree from root to osg, and that breaks
a lot of things, among them the host certificate.

Dan, any idea when and why this happened?
Do you happen to have a backup from before?

I assume it must&#39;ve happened when someone did a &#39;chown -R osg&#58;osg /home/osg/&#39;
since the osg tree is under the osg home area.

So this will take some time to fix, since I don&#39;t remember off hand
which parts should be owned by root or daemon or rsv or what not.

And I&#39;m currently at CERN, so I&#39;m going to sleep now, and then flying
back to the US tomorrow, but then on to Brazil on Monday, so I won&#39;t be
able to spend a lot of time on this right now.

Sorry,

Horst</pre></div><div class='update_description'><i onclick="document.location='7656#1259875331'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2009-12-03T21:22:11+00:00">Dec 3, 2009 09:22 PM UTC</time> by <b>Shreyas Cholia</b><a class="anchor" name="1259875331">&nbsp;</a></div><pre>Host appears to be down&#58;
ping m3.alliance.unm.edu
3 packets transmitted, 0 packets received, 100% packet loss

Will try again when host is back up.

-Shreyas

Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='7656#1259865988'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2009-12-03T18:46:28+00:00">Dec 3, 2009 06:46 PM UTC</time> by <b>Christopher Pipes</b><a class="anchor" name="1259865988">&nbsp;</a></div><pre>Shreyas,

Were you able to successfully run jobs?

Thanks,

Christopher</pre></div><div class='update_description'><i onclick="document.location='7656#1259607607'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2009-11-30T19:00:07+00:00">Nov 30, 2009 07:00 PM UTC</time> by <b>Shreyas Cholia</b><a class="anchor" name="1259607607">&nbsp;</a></div><pre>Will try this later today. Thanks for the reminder!

-S

Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='7656#1259606624'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2009-11-30T18:43:44+00:00">Nov 30, 2009 06:43 PM UTC</time> by <b>Christopher Pipes</b><a class="anchor" name="1259606624">&nbsp;</a></div><pre>Shreyas,

Have you been able to test this to see if you can run jobs?

Thanks,

Christopher</pre></div><div class='update_description'><i onclick="document.location='7656#1259018750'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2009-11-23T23:25:50+00:00">Nov 23, 2009 11:25 PM UTC</time> by <b>Christopher Pipes</b><a class="anchor" name="1259018750">&nbsp;</a></div><pre>Shreyas,

Have you been able to test this to see if you can run jobs?

Thanks,

Christopher</pre></div><div class='update_description'><i onclick="document.location='7656#1257982326'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2009-11-11T23:32:06+00:00">Nov 11, 2009 11:32 PM UTC</time> by <b>Shreyas Cholia</b><a class="anchor" name="1257982326">&nbsp;</a></div><pre>Hi

Sorry - been a busy week with Supercomputing on the horizon. The
earliest I can look at this is next week.

-Shreyas

Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='7656#1257970807'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2009-11-11T20:20:07+00:00">Nov 11, 2009 08:20 PM UTC</time> by <b>Horst Severini</b><a class="anchor" name="1257970807">&nbsp;</a></div><pre>Hi Elizabeth,

no, I&#39;m afraid we haven&#39;t solved this yet.

Shreyas, have you been able to find anything out from submitting your test jobs?

Thanks,

Horst</pre></div><div class='update_description'><i onclick="document.location='7656#1257969745'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2009-11-11T20:02:25+00:00">Nov 11, 2009 08:02 PM UTC</time> by <b>echism</b><a class="anchor" name="1257969745">&nbsp;</a></div><pre>Is this resolved?

Thank you,
Elizabeth</pre></div><div class='update_description'><i onclick="document.location='7656#1257520446'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2009-11-06T15:14:06+00:00">Nov 6, 2009 03:14 PM UTC</time> by <b>Daniel Felker</b><a class="anchor" name="1257520446">&nbsp;</a></div><pre>All,

User osg is in the system now and should be able to run jobs.

Dan

On Nov 4, 2009, at 3&#58;17 PM, Open Science Grid FootPrints wrote&#58;

<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='7656#1257373027'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2009-11-04T22:17:07+00:00">Nov 4, 2009 10:17 PM UTC</time> by <b>Horst Severini</b><a class="anchor" name="1257373027">&nbsp;</a></div><pre>Hi Shreyas,

good point.

Dan, could you allow the unix user osg to submit jobs to PBS?
Or map Shreyas to another unix user?

Thanks a lot,

Horst</pre></div><div class='update_description'><i onclick="document.location='7656#1257372846'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2009-11-04T22:14:06+00:00">Nov 4, 2009 10:14 PM UTC</time> by <b>Shreyas Cholia</b><a class="anchor" name="1257372846">&nbsp;</a></div><pre>I don&#39;t think we ever got past the point where I could actually run jobs
in the PBS queue as user OSG. If we move past this, I might be able to
do some more debugging.

-Shreyas

Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='7656#1257370686'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2009-11-04T21:38:06+00:00">Nov 4, 2009 09:38 PM UTC</time> by <b>Horst Severini</b><a class="anchor" name="1257370686">&nbsp;</a></div><pre>Hi Christopher,

I don&#39;t have any update, sorry. I don&#39;t have any more bright ideas
at the moment on how where else to look.

I think we need to give someone knowledgeable local access to m3,
so that s/he can debug further why the stdout and stderr is brought back
to the .globus/job/m3... area, but jobmanager-pbs doesn&#39;t pick it up there.

Any volunteers?

Thanks a lot,

Horst</pre></div><div class='update_description'><i onclick="document.location='7656#1257370195'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2009-11-04T21:29:55+00:00">Nov 4, 2009 09:29 PM UTC</time> by <b>Christopher Pipes</b><a class="anchor" name="1257370195">&nbsp;</a></div><pre>Horst or Shreyas,

Do you have any updates at this time? Please let me know if you need help.

Thanks,
Christopher</pre></div><div class='update_description'><i onclick="document.location='7656#1256846705'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2009-10-29T20:05:05+00:00">Oct 29, 2009 08:05 PM UTC</time> by <b>Horst Severini</b><a class="anchor" name="1256846705">&nbsp;</a></div><pre>Hi Shreyas,

my guess is that the unix user osg isn&#39;t authorized to submit jobs to PBS,
is that right Dan?

When I submit a job to jobmanager-pbs, it goes through the system just fine
and puts the proper stdout and stderr into the .globus/jobs/ area,
but the jobmanager doesn&#39;t get it back to the submitter.

So unfortunately that doesn&#39;t help us much, since this is a different error.

Dan, any suggestions?

As I said, local PBS submissions with qsub work perfectly fine, too.

Thanks,

Horst</pre></div><div class='update_description'><i onclick="document.location='7656#1256845267'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2009-10-29T19:41:07+00:00">Oct 29, 2009 07:41 PM UTC</time> by <b>Shreyas Cholia</b><a class="anchor" name="1256845267">&nbsp;</a></div><pre>OK - thanks for the access. Made some progress.

1. The globus fork job works fine.

2. The globus PBS job gives me the following error&#58;

<font color='#7F7E6F'>&#62; globus-job-get-output -err</font>
<a href='https&#58;//m3.alliance.unm.edu&#58;63002/4505/1256844729/' target='_blank' rel='nofollow'>https&#58;//m3.alliance.unm.edu&#58;63002/4505/1256844729/</a>
<font color='#7F7E6F'>&#62; qsub&#58; Job rejected by all possible destinations</font>

This implies that globus is working fine (you need to specify -err to
get the error message)

The job related files are here&#58;
/home/osg/.globus/job/m3.alliance.unm.edu/4505.1256844729

Are you sure the qsub is working properly with PBS?
A simple test would be to submit the &#34;scheduler_pbs_job_script&#34; in the
above directory directly from the command line.

eg.
qsub
/home/osg/.globus/job/m3.alliance.unm.edu/4505.1256844729/scheduler_pbs_job_script

Hope this helps
-Shreyas

Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='7656#1256833565'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2009-10-29T16:26:05+00:00">Oct 29, 2009 04:26 PM UTC</time> by <b>Horst Severini</b><a class="anchor" name="1256833565">&nbsp;</a></div><pre>Hi Shreyas,

sure, give it a try and see what you can find out&#58;

globus-job-run m3.alliance.unm.edu /usr/bin/whoami
globus-job-run m3.alliance.unm.edu/jobmanager-pbs /bin/hostname

You should be mapped to the osg account.

Cheers,

Horst</pre></div><div class='update_description'><i onclick="document.location='7656#1256833026'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2009-10-29T16:17:06+00:00">Oct 29, 2009 04:17 PM UTC</time> by <b>Shreyas Cholia</b><a class="anchor" name="1256833026">&nbsp;</a></div><pre>Is there any way I can submit a job to your system to debug?

-Shreyas

Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='7656#1256827988'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2009-10-29T14:53:08+00:00">Oct 29, 2009 02:53 PM UTC</time> by <b>Horst Severini</b><a class="anchor" name="1256827988">&nbsp;</a></div><pre>Hi Dan,

okay, that&#39;s what I thought. So I think we can rule out the firewall
and the hostname as sources of the problem.

So where else can we look for hints why this isn&#39;t working?

Thanks a lot,

Horst</pre></div><div class='update_description'><i onclick="document.location='7656#1256746086'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2009-10-28T16:08:06+00:00">Oct 28, 2009 04:08 PM UTC</time> by <b>Daniel Felker</b><a class="anchor" name="1256746086">&nbsp;</a></div><pre>It is an iptables firewall list, but we are blocking nothing from
pequena &#60;-&#62; m3 currently to try and keep that off the table as a
problem.

Dan

On Oct 28, 2009, at 9&#58;56 AM, Open Science Grid FootPrints wrote&#58;

<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='7656#1256745366'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2009-10-28T15:56:06+00:00">Oct 28, 2009 03:56 PM UTC</time> by <b>Horst Severini</b><a class="anchor" name="1256745366">&nbsp;</a></div><pre>Hi Shreyas,

yes, there is a firewall; Dan, is it just iptables, or is there
a center wide firewall, I don&#39;t remember?

We did set the GLOBUS_TCP_PORT_RANGE properly in
/opt/osg/vdt/etc/vdt-local-setup.sh , though, and I just tested that,
it matches with the actual open range.

And I don&#39;t think we need to worry about setting GLOBUS_HOSTNAME,
since m3.alliance.unm.edu only has one hostname, and it&#39;s set properly
in the system, so I don&#39;t see how it could not be set properly by Globus.

Are there any other tests we could run to figure out why the stdout/stderr
appear properly in the gass cache, but aren&#39;t picked up by the jobmanager-pbs?

Thanks a lot,

Horst</pre></div><div class='update_description'><i onclick="document.location='7656#1256701445'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2009-10-28T03:44:05+00:00">Oct 28, 2009 03:44 AM UTC</time> by <b>Shreyas Cholia</b><a class="anchor" name="1256701445">&nbsp;</a></div><pre>Are firewalls and hostnames an issue?

We have needed to set the GLOBUS_HOSTNAME (so that the globus endpoint
uses the correct externally visible hostname) and GLOBUS_TCP_PORT_RANGE
(to match open ports in the firewall) environment variables to make sure
everything comes through.

-Shreyas

Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='7656#1256696405'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2009-10-28T02:20:05+00:00">Oct 28, 2009 02:20 AM UTC</time> by <b>Horst Severini</b><a class="anchor" name="1256696405">&nbsp;</a></div><pre>Hi Shreyas and all,

thanks for your input on this. Unfortunately this seems to be a different
problems, since the output of the PBS jobs is brought back to the submit
host just fine. We can submit local PBS jobs with qsub, and the output
appears where it&#39;s supposed to, and as I said in my original email,
Dan was able to disable the globus gass cache cleanup in pbs.pm,
and that verified that the stdout and stderr of the globus-submitted job
was brought back to the gass cache -- or rather, I believe it was
~/.globus/job/m3..../... -- so we&#39;re pretty sure it&#39;s not a problem
on the PBS side.

Where else can we look for hints as to what might be going on here?

Thanks a lot,

Horst</pre></div><div class='update_description'><i onclick="document.location='7656#1256671930'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2009-10-27T19:32:10+00:00">Oct 27, 2009 07:32 PM UTC</time> by <b>Shreyas Cholia</b><a class="anchor" name="1256671930">&nbsp;</a></div><pre>Hmm - I&#39;ve seen similar behavior before. Here is an earlier exchange
with Jeff Dutton. Does this help narrow things down?

-Shreyas

Hi Jeff

I think I know what is going on. Basically, the PBS job is running but
for some reason PBS is not writing it out to the location that globus
expects.

Essentially the following lines are being ignored or failing&#58;

#PBS -o /osg/home/osg/stdout.shreyas
#PBS -e /osg/home/osg/stderr.shreyas

What is even more suspicious is that the job errors out if I don&#39;t use
#PBS -k oe
(The above flag tells it to retain the transient output/error files on
the execution host)/

My guess is that PBS is misconfigured, so that it is unable to write the
output file upon job completion. The job runs successfully and creates
the temporary output file on the execution host. However, it is unable
to write this back out to the user defined output file. What you are
seeing on the filesystem are these files that are being retained because
of the -k option.

Do you have log files for PBS that might show us some errors? You might
also consult with your PBS admin in case he knows what is going on.

-Shreyas

Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='7656#1256667417'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2009-10-27T18:16:57+00:00">Oct 27, 2009 06:16 PM UTC</time> by <b>Christopher Pipes</b><a class="anchor" name="1256667417">&nbsp;</a></div><pre>Shreyas,

Would you mind helping Dan and Horst out on this issue?

Many Thanks,

Christopher</pre></div><div class='update_description'><i onclick="document.location='7656#1256667365'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2009-10-27T18:16:05+00:00">Oct 27, 2009 06:16 PM UTC</time> by <b>Christopher Pipes</b><a class="anchor" name="1256667365">&nbsp;</a></div><pre>Dan and Horst,

Kyle tells me that Shreyas usually helps with issues of PBS, so I am asking him if he can help out with this and maybe get us moving into the right direction.</pre></div><div class='update_description'><i onclick="document.location='7656#1256162586'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2009-10-21T22:03:06+00:00">Oct 21, 2009 10:03 PM UTC</time> by <b>Daniel Felker</b><a class="anchor" name="1256162586">&nbsp;</a></div><pre>Chris,

I think there&#39;s some confusion, Horst was asking on behalf of both
Horst and I, we are confused by the behavior of the scripts. If
there&#39;s more data we can provide let me know.

Dan

On Oct 21, 2009, at 3&#58;57 PM, Open Science Grid FootPrints wrote&#58;

<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='7656#1256162240'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2009-10-21T21:57:20+00:00">Oct 21, 2009 09:57 PM UTC</time> by <b>Christopher Pipes</b><a class="anchor" name="1256162240">&nbsp;</a></div><pre>CSC support,

Could you please look into this issue?

Thanks,

Christopher</pre></div><div class='update_description'><i onclick="document.location='7656#1256085775'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2009-10-21T00:42:55+00:00">Oct 21, 2009 12:42 AM UTC</time> by <b>Christopher Pipes</b><a class="anchor" name="1256085775">&nbsp;</a></div><pre>From&#58; Horst Severini &#60;hs@....&#62;
To&#58; goc@....
cc&#58; hs@...., dfelker@....
Subject&#58; problem with jobmanager-pbs passing output through on OSG 1.0 install at UNM_HPC
Date-Sent&#58; Tuesday, October 20, 2009 5&#58;28 PM -0500

Hi guys,

we seem to be having a problem at UNM_HPC (m3.alliance.unm.edu)
with the PBS job manager, it somehow refuses to pass the output
from PBS through back to the globus job output.

Submitting a job with something like

globus-job-run m3.alliance.unm.edu/jobmanager-pbs /bin/hostname

works fine, the job runs and executes properly on a compute node,
but it returns without any output or error.

Dan managed to disable the deletion of the temporary gass cache area
in pbs.pm, and that clearly shows that the output is getting passed back
from PBS into stdout in ~/.globus/job/m3..../ so there&#39;s no problem
with the PBS submission and execution and output retrieval,
but we don&#39;t understand why the jobmanager isn&#39;t picking it up.

We&#39;re running OSG 1.0 / VDT 1.10.1u on that machine.

Please assigne Dan Felker &#60;dfelker@....&#62; as the primary contact
for this ticket, since he&#39;s the site admin, but keep me in the loop, too.

Dan, feel free to add more information here, or wait till they create
a ticket for this. Probably better to wait ...

Thanks a lot,

<div id='show_291812875' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_291812875'>Horst
</div><script type='text/javascript'>
        $('#show_291812875').click(function() {
            $('#detail_291812875').slideDown("normal");
            $('#show_291812875').hide();
            $('#hide_291812875').show();
        });
        $('#hide_291812875').click(function() {
            $('#detail_291812875').slideUp();
            $('#hide_291812875').hide();
            $('#show_291812875').show();
        });
        </script></pre></div><legend>Similar Recent Tickets <small>modified within the last 30 days</small></legend><div id="similar_tickets"><p class="muted">No similar tickets found.</p></div>
</div>
<script type="text/javascript">
function reset_anchor() {
    $("#updates .selected").removeClass("selected");
    var urls = document.location.toString().split('#'); 
    var anchor = urls[1];
    if(anchor) {
        $("a[name='"+anchor+"']").parents(".update_description").addClass("selected");
    }
}
function submitspam(ticket_id) {
    myret = confirm("Would you like to close this ticket as a security ticket, and submit the ticket content to akismet?");
    if(myret == true) {
        $.ajax("viewer/processspam?id="+ticket_id).done(function() {
            window.location.reload();
        });
    }
}

$(function() {
    reset_anchor();
    var ADDITIONAL_COOKIE_NAME = 'gocticket';
    var options = { path: '/', expires: 365};

    if(window.opener && window.opener.name == "gocticket_list") {
        v = $.cookie("closewindow");
        if(!v) {
            $("#closewindow").attr("checked", "checked"); //on by default
        } else {
            if(v == "checked") {
                $("#closewindow").attr("checked", "checked");
            }
        }
        $("#closewindow").click(function() {
            $.cookie("closewindow", $(this).attr('checked'), options);
        });
    } else {
        $("#closewindow_area").hide();
    }
    function updateTimeago() {
        $("time").timeago();
        setTimeout(updateTimeago, 30*1000);
    }
    updateTimeago();
    $(".description").focus(expand_description);
});
</script>
<hr/>
<footer>
<p>GOC Ticket Version 2.2 | <a href="https://ticket.opensciencegrid.org/goc/submit?app_issue_check=on&amp;app_issue_type=goc&amp;app_goc_url=https%3A%2F%2Fticket.opensciencegrid.org%3A443%2F7656">Report Bugs</a>
 | <a href="https://github.com/opensciencegrid/operations/blob/master/docs/privacy.md">Privacy Policy</a>
</p>

<p> <img align="top" src="images/tag_orange.png"/> Copyright 2018 The Trustees of Indiana University - Developed for Open Science Grid</p>
</footer>


</div><!--container-fluid-->
<script src="https://ticket1.grid.iu.edu:8443/socket.io/socket.io.js"></script>
<script>
var chat = io.connect('https://ticket1.grid.iu.edu:8443');
chat.on('connect', function() {
    chat.emit('authenticate', {nodekey:'', ticketid: 7656});
});
chat.on('peers', function(peers) {
    $("#peers").html("");
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('peer_disconnect', function(pid) {
    $("#peer_"+pid).hide("slow");
});
chat.on('peer_connected', function(peers) {
    //expect only 1 peer connecting, but..
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('submit', function() {
    if(confirm("This ticket was updated. Do you want to refresh?")) {
        history.go(0);
    }
});

function addPeer(pid, peer) {
    var ipinfo = "";
    if(peer.ip != undefined) {
        ipinfo = "<span class=\"ip\">"+peer.ip+"</span>";
    }
    if(chat.io.engine.id == pid) {
        //don't display myself
        return;
    }
    var html = "<li class=\"new\" id=\"peer_"+pid+"\" class=\"peer\">"+peer.name+ipinfo+"</li>";
    $("#peers").prepend(html);
    $("#peers .new").animate({bottom: 0}, 1000, function() {$(this).removeClass("new")});
}

$(function() {
    $("#ticket_form").submit(function() {
        chat.emit('submit');
        return true;
    });
});
</script>
<script>
//used by searchbox
function parseValue(value) {
    var obj = new Object();
    var tokens = value.split("\t");
    obj.str = tokens[0];
    obj.count = tokens[1];
    return obj;
}

$(function() {
    //bootstrap-2.0.4 stuff
    $(".alert-message").alert();
    $(".dropdown-toggle").dropdown();
    $("span[rel='tooltip']").tooltip();
    $("a[rel=popover]").popover();

    //activate menu that user is currently on
    $("#menu_navigator").addClass("active"); 
    $("#submenu_").addClass("active"); 

    //translate zend validation error message to bootstrap
    $(".errors").addClass("alert").addClass("alert-error");

    //enable autocomplete for search box
    $("#search").autocomplete({
        source: function( request, response ) {
            $.ajax({
                url: "search/autocomplete",
                dataType: "text",
                data: {
                    //featureClass: "P",
                    //style: "full",
                    //maxRows: 12,
                    //name_startsWith: request.term
                    q: request.term
                },
                success: function( data ) {
                    response( $.map( data.split("\n"), function( item ) {
                        if(item == "") return null;
                        return {
                            value: item
                        }
                    }));
                }
            });
        },
        select: function(event, ui) {
            document.location = "search?q="+ui.item.value;
        }
    });
    
});
</script>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-69012-13");
pageTracker._trackPageview();
} catch(err) {}
</script>

</body>
