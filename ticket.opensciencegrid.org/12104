<!DOCTYPE html>
<html lang="en">
  <head>
  <base href="">
    <title>[12104] CERN BDII reports no Harvard releases =&#62; jobs won&#39;t run</title>    <meta charset="utf-8" />
    <meta name="verify-v1" content="na5IcAJsZVOfEkboRxuIiZ1zpZgnZiWra+nKcS7nA/o=" />
    <meta name="google-site-verification" content="DLrk3ft4s8b-S2TloLCL2LD_t6wcTjgSluf5pmiu2kA" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />
    <link href="https://ticket.opensciencegrid.org/rss" rel="alternate" type="application/rss+xml" title="GOC Ticket Update feed" />

    <style type="text/css">
      body {
        padding-top: 50px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
     #search {
            width: 300px;
     }

    </style>

<script src="https://code.jquery.com/jquery-3.0.0.js"></script>
<script src="https://code.jquery.com/jquery-migrate-3.0.1.js"></script>

   <link href="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet"/>
    <script src="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/js/bootstrap.min.js"></script>

    <link href="https://netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"/>
    <link href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/themes/smoothness/jquery-ui.min.css" rel="stylesheet"/>
 <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>


    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/js/select2.min.js"></script>

    <link href="css/ticket.css" rel="stylesheet" />
    <script src="lib/jquery.cookie.js"></script>

    <link href="images/tag_orange.png" rel="icon" type="image/png"/>
    <script src='https://www.google.com/recaptcha/api.js'></script>
  </head>

  <body>
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>

            <a class="brand" style="padding: 6px 0px 0px 6px;" href="http://opensciencegrid.org"><img src="images/osglogo.40x30.png"/></a>
            <ul class="nav">
                <li class="dropdown"><a href="https://ticket.opensciencegrid.org/#" class="dropdown-toggle" data-toggle="dropdown">GOC Ticket <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    <li><a href="https://my.opensciencegrid.org">MyOSG</a></li>
                    <li><a href="https://oim.opensciencegrid.org">OIM</a></li>
                    <li class="active"><a href="https://ticket.opensciencegrid.org/index">Ticket</a></li>
	<li class="divider"></li>
	<li><a href="http://repo.grid.iu.edu">Repo</a></li>
	<li class="divider"></li>
	<li><a href="http://blogs.grid.iu.edu">Blog</a></li>
                    <li><a href="http://display.grid.iu.edu">Display</a></li>
                    <li><a href="http://osggoc.blogspot.com/">News</a></li>
                    </ul>
                </li>
            </ul>
            <ul class="nav pull-right">
                <li><a href="https://ticket.opensciencegrid.org/sso/">Login</a></li>            </ul>

            <div class="nav-collapse">
                <ul class="nav">
			 <li id="menu_submit"><a href="https://ticket.opensciencegrid.org/submit">Submit</a></li><li id="menu_view" class="dropdown"><a href="https://ticket.opensciencegrid.org/\#" class="dropdown-toggle" data-toggle="dropdown">View <b class="caret"></b></a><ul class="dropdown-menu"><li id="submenu_listopen"><a href="https://ticket.opensciencegrid.org/list/open">Open Tickets</a></li><li id="submenu_listrecentclose"><a href="https://ticket.opensciencegrid.org/list/recentclose">Recently Closed Tickets</a></li><li class="divider"></li><li id="submenu_alltickets"><a href="https://ticket.opensciencegrid.org/search?q=&amp;sort=id">All Tickets</a></li></ul></li>                </ul>

                <form class="navbar-search pull-right" action="https://ticket.opensciencegrid.org/viewer">
                    <input id="search" type="text" name="id" class="search-query span2" placeholder="Search Ticket" value=""/>
                </form>
            </div>
        </div>
      </div>
    </div>

<script type='text/javascript' src='lib/jquery.timeago.js'></script>
<script type='text/javascript' src='lib/byte2size.js'></script>
<style>
#updates .toolbar {
position: relative;
margin-top: 0px;
top: -10px;
font-weight: normal;
}
#updates a.anchor {
position: relative;
top: -50px;
}
#updates .selected pre {
animation:selected 2s;
animation-iteration-count: 2;
animation-direction: alternate;
-webkit-animation:selected 2s; 
-webkit-animation-iteration-count: 2;
-webkit-animation-direction: alternate;
box-shadow: inset 1px 1px 20px #9ad;
border: 1px solid #9ab;
margin: 5px 0px;
padding-left: 10px;
}
@keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ab;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
@-webkit-keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ad;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
#updates pre {
background-color: inherit;
line-height: 15px;
padding: 5px;
}
#updates .header {
color: #999;
}
#updates .update_history pre {
background-color: #eee;
color: #666;
font-size: 85%;
}
#updates .clickable {
cursor: pointer;
}
#updates .clickable:hover {
color: #D98719;
}
#updates .meta_information pre {
background-color: #fed;
}
#similar_tickets {
max-height: 300px;
overflow-y: auto;
pointer-events: none;
padding: 5px;
background-color: #f4f4f4;
}
.btn-toolbar {
margin-bottom: 0;
height: 30px;
}
#peers {
position: fixed;
bottom: 0px;
right: 0px;
z-index: 100;
list-style: none;
padding: 5px 0px 0px 5px;
margin: 0px;
background-color: white;
box-shadow: 0px 0px 10px white;
}
#peers li {
background-color: #ccc;
color: #000;
display: inline-block;
padding: 5px 10px;
margin-right: 5px;
position: relative;
}
/*
#peers li:hover {
background-color: #999;
cursor: pointer;
}
*/
#peers span.ip {
padding-left: 5px;
color: #666;
}
#peers .new {
bottom: -30px;
}
/*
#peers .me {
background-color: red;
}
*/
</style>

<div class="container-fluid">
<ul id="peers"></ul>
<div class="alert alert-danger"><a class="close" href="https://ticket.opensciencegrid.org/#" data-dismiss="alert">&times;</a>By the end of May 2018, the ticketing system at https://ticket.opensciencegrid.org will be retired and support will be provided at https://support.opensciencegrid.org. Throughout this transition the support email (help@opensciencegrid.org) will be available as a point of contact.<br><br>                                                   
                                                                                                                                                                                   
Please see the service migration page for details: https://opensciencegrid.github.io/technology/policy/service-migrations-spring-2018/#ticket</div><div id="presence" class="pull-right"></div><div class="ticketgui"><script type="text/javascript" src="lib/checktab.js"></script>

<script>
var expanded = false;
function expand_description() {
    var desc = $(".description");
    if(!expanded) {
        expanded = true;
        //expand to minheight
        var min = 250;
        if(desc.height() < min) {
            desc.animate({height: min}, 200);
        }
    }
}

$(document).ready(function() {
    $("input[name='nad']").datepicker({
        dateFormat: 'yy-mm-dd'
    });
});

</script>



<style>
.form-horizontal .control-label {
padding-top: inherit;
font-size:90%;
color:#666;
}
label {
margin-bottom: 0px;
}
.controls {
line-height: 18px;
}
</style>
<form class="form-horizontal" action="https://ticket.opensciencegrid.org/viewer/updatebasic?id=12104" method="post">
<div class="page-header">
    <h3><span class="muted">12104</span> / CERN BDII reports no Harvard releases =&#62; jobs won&#39;t run</h3>
</div>

<div class="row-fluid">
<div class="span5">
    <legend>Contact</legend>
    <div class="control-group">
        <label class="control-label">Full Name</label>
        <div class="controls">Saul Youssef</div>
    </div>
    <div class="control-group">
        <label class="control-label">Email</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">Phone</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">CC</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>

    <legend>Details</legend>
    <div class="control-group"><label class="control-label">Submitted Via</label><div class="controls">GOC Ticket/submit</div></div><div class="control-group"><label class="control-label">Submitter</label><div class="controls">Saul Youssef</div></div>
    <div class="control-group">
        <label class="control-label">Ticket Type</label>
        <div class="controls">Problem/Request</div>
    </div>
    <div class="control-group">
        <label class="control-label">Priority</label>
        <div class="controls">Normal</div>
    </div>
    <div class="control-group">
        <label class="control-label">Status</label>
        <div class="controls">
Closed</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action</label>
        <div class="controls">ENG Action</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action Deadline</label>
        <div class="controls flag_red">2012-05-23</div>
    </div>

</div><!--span-->
<div class="span7">
    <legend>Assignees</legend>
    <div class="assignee" style="width: 60%">Scott Teige <span class="muted"> / OSG Operations Infrastructure</span></div><div class="assignee" style="width: 60%">Doug Strain <span class="muted"> / OSG Storage Team</span></div><div class="assignee" style="width: 60%">Software Support (Triage) <span class="muted"> / OSG Software Team</span></div>    <br>

    <legend>Assignees</legend>
    TODO
    <br>

    <style>
legend.noborder {
border-bottom: none;
}
</style>

<div id="attachment-list"/>
<script>
$(function () {
    var first = true;
    $.getJSON("attachment/list/12104", function (files) {
        //console.dir(files);
        var html = "<table class=\"table table-condensed\">";
        $(files).each(function() {
            if(first) {
                first = false;
                html += "<legend class=\"noborder\">Attachmenets</legend>";
            }
            html += "<tr class=\"attachment\">";
            html += "<td><img src="https://ticket.opensciencegrid.org/\&quot;&quot;+this.thumbnail_url+&quot;\&quot;/"></td>";
            html += "<td><a href="https://ticket.opensciencegrid.org/\&quot;&quot;+this.url+&quot;\&quot;" target=\"_blank\">"+this.name+"</a></td>";
            html += "<td>"+bytesToSize(this.size, 1)+"</td>";
            html += "</tr>";
        });
        html += "</table>";
        $("#attachment-list").html(html);
    });
});

function download(url) {
    window.open(url, "_blank");
}
</script>


</div><!--span-->
</div><!--row-fluid-->


</form>

</div>
<div id="updates" style="clear: both;">
    <legend>Past Updates
    <div class="btn-toolbar pull-right toolbar">
        <div class="btn-group">
                <a class="btn btn-small" href="https://ticket.opensciencegrid.org/12104?sort=up&amp;"><i class="icon-arrow-up"></i> Sort</a>

        
        <a class="btn btn-small" href="https://ticket.opensciencegrid.org/12104?expandall=true&amp;">Expand Descriptions</a>        <a class="btn btn-small" target="_blank" href="mailto:osg@tick.globalnoc.iu.edu?subject=Open%20Science%20Grid%3A%20CERN%20BDII%20reports%20no%20Harvard%20releases%20%3D%26%2362%3B%20jobs%20won%26%2339%3Bt%20run%20ISSUE%3D12104%20PROJ%3D71"><i class="icon-envelope"></i> Update w/Email</a>
        </div>
    </div><!--btn-toolbar-->
    </legend>

    <div class='update_description'><i onclick="document.location='12104#1339168315'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-06-08T15:11:55+00:00">Jun 8, 2012 03:11 PM UTC</time><a class="anchor" name="1339168315">&nbsp;</a></div><pre>Thank you for informing us that this issue has been resolved. I will close this ticket.  Please submit problems, requests, and questions at&#58; <a href='https&#58;//ticket.grid.iu.edu/goc/open' target='_blank' rel='nofollow'>https&#58;//ticket.grid.iu.edu/goc/open</a> OSG Grid Operations Center goc@...., 317-278-9699 Visit the OSG Operations Page&#58; <a href='http&#58;//osggoc.blogspot.com/' target='_blank' rel='nofollow'>http&#58;//osggoc.blogspot.com/</a>

-- by Douglas Strain</pre></div><div class='update_description'><i onclick="document.location='12104#1339168250'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-06-08T15:10:50+00:00">Jun 8, 2012 03:10 PM UTC</time> by <b>Burt Holzman</b><a class="anchor" name="1339168250">&nbsp;</a></div><pre>John,

Thanks so much for the detective work and the patch -- I suspected it must have been a deadlock on a child, but couldn&#39;t reproduce it.

<a href='https&#58;//github.com/holzman/gip/commit/6bd66deb2c2a97e3010f2aebf76f47e8191ae71c' target='_blank' rel='nofollow'>https&#58;//github.com/holzman/gip/commit/6bd66deb2c2a97e3010f2aebf76f47e8191ae71c</a>

We&#39;ll make sure it gets into GIP 1.3.8.</pre></div><div class='update_description'><i onclick="document.location='12104#1339103648'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-06-07T21:14:08+00:00">Jun 7, 2012 09:14 PM UTC</time> by <b>john_brunelle@....</b><a class="anchor" name="1339103648">&nbsp;</a></div><pre>Yup, working, GlueCE info now in the BDII output&#58;

jab@heroatlas&#58;~/box$ curl -s <a href='http&#58;//is.grid.iu.edu/data/cemon_raw_incoming/heroatlas.fas.harvard.edu' target='_blank' rel='nofollow'>http&#58;//is.grid.iu.edu/data/cemon_raw_incoming/heroatlas.fas.harvard.edu</a> | grep GlueCE | wc -l
294

Best,

John

On Thu, 7 Jun 2012, John Brunelle wrote&#58;

<font color='#7F7E6F'>&#62; Well, I got curious and looked at the gip code and it&#39;s already using select</font>
<font color='#7F7E6F'>&#62; and reading from stdout/stderr in parallel!  Nice.  Except it looks like it</font>
<font color='#7F7E6F'>&#62; calls a blocking read instead of a non-blocking read.  I just put in the</font>
<font color='#7F7E6F'>&#62; following patch to runCommand in gip_testing.py and site_topology.py now runs</font>
<font color='#7F7E6F'>&#62; smoothly.  By the looks of the code, it&#39;ll just throw out stderr if exit</font>
<font color='#7F7E6F'>&#62; status is zero, which it is in this case, and consider it an overall success,</font>
<font color='#7F7E6F'>&#62; so I didn&#39;t have to do anything else to make it work.</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; I see GlueCE info in the command line output, but not yet in BDII, but I only</font>
<font color='#7F7E6F'>&#62; made this change minutes ago.  Maybe it&#39;ll show up and this is enought of a</font>
<font color='#7F7E6F'>&#62; fix.  Below is the patch (also attached as a file).  The 4096 block size is</font>
<font color='#7F7E6F'>&#62; arbitrary, it&#39;s not part of the solution.</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; Best,</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; John</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; diff -rupN a/gip_testing.py b/gip_testing.py</font>
<font color='#7F7E6F'>&#62; --- a/gip_testing.py    2011-05-20 13&#58;02&#58;39.000000000 -0400</font>
<font color='#7F7E6F'>&#62; +++ b/gip_testing.py    2012-06-07 16&#58;45&#58;55.000000000 -0400</font>
<font color='#7F7E6F'>&#62; @@ -83,13 +83,13 @@ def runCommand(cmd, force_command=False)</font>
<font color='#7F7E6F'>&#62;         while fdlist&#58;</font>
<font color='#7F7E6F'>&#62;             ready = select.select(fdlist, [], [])</font>
<font color='#7F7E6F'>&#62;             if outfd in ready[0]&#58;</font>
<div id='show_1618040744' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_1618040744'><font color='#7F7E6F'>&#62; -                outchunk = stdout.read()</font>
<font color='#7F7E6F'>&#62; +                outchunk = os.read(outfd, 4096)</font>
<font color='#7F7E6F'>&#62;                 if outchunk == &#39;&#39;&#58;</font>
<font color='#7F7E6F'>&#62;                     fdlist.remove(outfd)</font>
<font color='#7F7E6F'>&#62;                 else&#58;</font>
<font color='#7F7E6F'>&#62;                     outdata.write(outchunk)</font>
<font color='#7F7E6F'>&#62;             if errfd in ready[0]&#58;</font>
<font color='#7F7E6F'>&#62; -                errchunk = stderr.read()</font>
<font color='#7F7E6F'>&#62; +                errchunk = os.read(errfd, 4096)</font>
<font color='#7F7E6F'>&#62;                 if errchunk == &#39;&#39;&#58;</font>
<font color='#7F7E6F'>&#62;                     fdlist.remove(errfd)</font>
<font color='#7F7E6F'>&#62;                 else&#58;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; On Thu, 7 Jun 2012, John Brunelle wrote&#58;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;&#62; Hi Burt,</font>
<font color='#7F7E6F'>&#62;&#62;</font>
<font color='#7F7E6F'>&#62;&#62; I&#39;ve traced this back to interference from the modules package</font>
<font color='#7F7E6F'>&#62;&#62; (<a href='http&#58;//modules.sourceforge.net/' target='_blank' rel='nofollow'>http&#58;//modules.sourceforge.net/</a>) we have installed on our cluster, which</font>
<font color='#7F7E6F'>&#62;&#62; is causing extra text on stderr and a deadlock in the gip code reading the</font>
<font color='#7F7E6F'>&#62;&#62; bqueues output.</font>
<font color='#7F7E6F'>&#62;&#62;</font>
<font color='#7F7E6F'>&#62;&#62; &#34;module&#34; is a function exported through /etc/profile.  When gip forks and</font>
<font color='#7F7E6F'>&#62;&#62; calls bqueues&#58;</font>
<font color='#7F7E6F'>&#62;&#62;</font>
<font color='#7F7E6F'>&#62;&#62; execve(&#34;/bin/sh&#34;, [&#34;/bin/sh&#34;, &#34;-c&#34;, &#34;bqueues -l&#34;]</font>
<font color='#7F7E6F'>&#62;&#62;</font>
<font color='#7F7E6F'>&#62;&#62; it ends up getting this extra text on stderr&#58;</font>
<font color='#7F7E6F'>&#62;&#62;</font>
<font color='#7F7E6F'>&#62;&#62; write(2, &#34;/bin/sh&#58; module&#58; line 1&#58; syntax error&#58; unexpected end of file&#92;n&#34;,</font>
<font color='#7F7E6F'>&#62;&#62; 62) = 62 &#60;0.000010&#62;</font>
<font color='#7F7E6F'>&#62;&#62; write(2, &#34;/bin/sh&#58; error importing function definition for &#96;module&#92;&#39;&#92;n&#34;,</font>
<font color='#7F7E6F'>&#62;&#62; 58) = 58 &#60;0.000007&#62;</font>
<font color='#7F7E6F'>&#62;&#62;</font>
<font color='#7F7E6F'>&#62;&#62; I&#39;m only seeing this with&#58;</font>
<font color='#7F7E6F'>&#62;&#62;</font>
<font color='#7F7E6F'>&#62;&#62; python /opt/osg-1.2.6/gip/providers/site_topology.py</font>
<font color='#7F7E6F'>&#62;&#62;</font>
<font color='#7F7E6F'>&#62;&#62; And it&#39;s repeatable for any user, not just daemon.  Every other script I</font>
<font color='#7F7E6F'>&#62;&#62; write in shell or python (I&#39;ve only tested the subprocess module so far)</font>
<font color='#7F7E6F'>&#62;&#62; does not experience this when calling bqueues.  I&#39;m guessing something</font>
<font color='#7F7E6F'>&#62;&#62; about posix compatibility, or login shell, some obscure detail like that in</font>
<font color='#7F7E6F'>&#62;&#62; the way that python is doing subprocess calls (I haven&#39;t dug into any gip</font>
<font color='#7F7E6F'>&#62;&#62; code to see which of the myriad ways that this can be done in python that</font>
<font color='#7F7E6F'>&#62;&#62; it&#39;s using).</font>
<font color='#7F7E6F'>&#62;&#62;</font>
<font color='#7F7E6F'>&#62;&#62; We must have the module function exported like this, so I&#39;m still digging</font>
<font color='#7F7E6F'>&#62;&#62; to see if I can automatically suppress this error.</font>
<font color='#7F7E6F'>&#62;&#62;</font>
<font color='#7F7E6F'>&#62;&#62;</font>
<font color='#7F7E6F'>&#62;&#62; However, there&#39;s the additional issue of why gip is hanging here and not</font>
<font color='#7F7E6F'>&#62;&#62; picking up the error.  It could chose to fail or just ignore it, since</font>
<font color='#7F7E6F'>&#62;&#62; stdout still has the correct bqueues -l output.  Instead it looks like it&#39;s</font>
<font color='#7F7E6F'>&#62;&#62; in a deadlock from trying to read stderr and stdout serially, rather than</font>
<font color='#7F7E6F'>&#62;&#62; in parallel using select and non-blocking reads on whichever is ready.</font>
<font color='#7F7E6F'>&#62;&#62;</font>
<font color='#7F7E6F'>&#62;&#62; I&#39;ve attached the strace of the site_topology.py/bqueues parent/child pair,</font>
<font color='#7F7E6F'>&#62;&#62; which shows the deadlock&#58;</font>
<font color='#7F7E6F'>&#62;&#62;</font>
<font color='#7F7E6F'>&#62;&#62; The parent creates a pair of pipes for stdout and stderr and then forks&#58;</font>
<font color='#7F7E6F'>&#62;&#62;</font>
<font color='#7F7E6F'>&#62;&#62; 13&#58;32&#58;15.745906 pipe([5, 6])            = 0 &#60;0.000008&#62;</font>
<font color='#7F7E6F'>&#62;&#62; 13&#58;32&#58;15.745946 pipe([7, 8])            = 0 &#60;0.000009&#62;</font>
<font color='#7F7E6F'>&#62;&#62; 13&#58;32&#58;15.745992 clone(child_stack=0,</font>
<font color='#7F7E6F'>&#62;&#62; flags=CLONE_CHILD_CLEARTID|CLONE_CHILD_SETTID|SIGCHLD, child_tidptr=0) =</font>
<font color='#7F7E6F'>&#62;&#62; 27418 &#60;0.000371&#62;</font>
<font color='#7F7E6F'>&#62;&#62;</font>
<font color='#7F7E6F'>&#62;&#62; The child uses file descriptors 6 and 8 for stdout and stderr,</font>
<font color='#7F7E6F'>&#62;&#62; respectively&#58;</font>
<font color='#7F7E6F'>&#62;&#62;</font>
<font color='#7F7E6F'>&#62;&#62; 13&#58;32&#58;15.747824 dup2(6, 1)              = 1 &#60;0.000006&#62;</font>
<font color='#7F7E6F'>&#62;&#62; 13&#58;32&#58;15.747860 dup2(8, 2)              = 2 &#60;0.000006&#62;</font>
<font color='#7F7E6F'>&#62;&#62;</font>
<font color='#7F7E6F'>&#62;&#62; The child writes the error to stderr&#58;</font>
<font color='#7F7E6F'>&#62;&#62;</font>
<font color='#7F7E6F'>&#62;&#62; 13&#58;32&#58;16.708513 write(2, &#34;/bin/sh&#58; module&#58; line 1&#58; syntax error&#58; unexpected</font>
<font color='#7F7E6F'>&#62;&#62; end of file&#92;n&#34;, 62) = 62 &#60;0.000010&#62;</font>
<font color='#7F7E6F'>&#62;&#62; 13&#58;32&#58;16.708576 write(2, &#34;/bin/sh&#58; error importing function definition for</font>
<font color='#7F7E6F'>&#62;&#62; &#96;module&#92;&#39;&#92;n&#34;, 58) = 58 &#60;0.000007&#62;</font>
<font color='#7F7E6F'>&#62;&#62;</font>
<font color='#7F7E6F'>&#62;&#62; The parent reads it from its end of the pipe&#58;</font>
<font color='#7F7E6F'>&#62;&#62;</font>
<font color='#7F7E6F'>&#62;&#62; 13&#58;32&#58;16.709763 read(7, &#34;/bin/sh&#58; module&#58; line 1&#58; syntax error&#58; unexpected</font>
<font color='#7F7E6F'>&#62;&#62; end of file&#92;n/bin/sh&#58; error importing function definition for &#96;module&#92;&#39;&#92;n&#34;,</font>
<font color='#7F7E6F'>&#62;&#62; 8192) = 120 &#60;0.000016&#62;</font>
<font color='#7F7E6F'>&#62;&#62;</font>
<font color='#7F7E6F'>&#62;&#62; But the parent continues to try to read more from stderr, and blocks&#58;</font>
<font color='#7F7E6F'>&#62;&#62;</font>
<font color='#7F7E6F'>&#62;&#62; 13&#58;32&#58;16.709836 read(7,</font>
<font color='#7F7E6F'>&#62;&#62;</font>
<font color='#7F7E6F'>&#62;&#62; Meanwhile the child has put stuff in stdout, and it blocks, since the</font>
<font color='#7F7E6F'>&#62;&#62; parent is not reading it&#58;</font>
<font color='#7F7E6F'>&#62;&#62;</font>
<font color='#7F7E6F'>&#62;&#62; 13&#58;32&#58;17.851350 write(1, &#34; PREEMPTIVE[ss_requeue ns_requeue</font>
<font color='#7F7E6F'>&#62;&#62;</font>
<font color='#7F7E6F'>&#62;&#62; The parent&#39;s read(7,...) (read of stderr) will not complete until it also</font>
<font color='#7F7E6F'>&#62;&#62; reads from 5 (stdout).  Deadlock.  Maybe you haven&#39;t seen this before</font>
<font color='#7F7E6F'>&#62;&#62; because getting data on both stdout and stderr is rare, plus our bqueues</font>
<font color='#7F7E6F'>&#62;&#62; output is humongous, at 111376 bytes, and probably larger than the default</font>
<font color='#7F7E6F'>&#62;&#62; buffer size for a low-level read and is hence getting split up.</font>
<font color='#7F7E6F'>&#62;&#62;</font>
<font color='#7F7E6F'>&#62;&#62; Anyways, that&#39;s were this issue is at.  Something either needs to suppress</font>
<font color='#7F7E6F'>&#62;&#62; this extra error message (I&#39;m trying my best for an environment fix on my</font>
<font color='#7F7E6F'>&#62;&#62; side rather than asking gip to call subprocesses differently) or gip can be</font>
<font color='#7F7E6F'>&#62;&#62; patched to not deadlock and, since it has good bqueues output, ignore the</font>
<font color='#7F7E6F'>&#62;&#62; extra error message, and move on.  In an ideal world, the gip deadlock</font>
<font color='#7F7E6F'>&#62;&#62; should be patched either way, but I understand if there are more pressing</font>
<font color='#7F7E6F'>&#62;&#62; things.</font>
<font color='#7F7E6F'>&#62;&#62;</font>
<font color='#7F7E6F'>&#62;&#62; By the way, our site is not *really* negatively impacted by this, as Alden</font>
<font color='#7F7E6F'>&#62;&#62; from US ATLAS Panda has put in a hack to not require the gip GlueCE info</font>
<font color='#7F7E6F'>&#62;&#62; from us.  Hence the high latency in my getting back to you, sorry.</font>
<font color='#7F7E6F'>&#62;&#62;</font>
<font color='#7F7E6F'>&#62;&#62; Best,</font>
<font color='#7F7E6F'>&#62;&#62;</font>
<font color='#7F7E6F'>&#62;&#62; John</font>
<font color='#7F7E6F'>&#62;&#62;</font>
<font color='#7F7E6F'>&#62;&#62; p.s.</font>
<font color='#7F7E6F'>&#62;&#62;</font>
<font color='#7F7E6F'>&#62;&#62; The error message about the exported function looks very similar to these</font>
<font color='#7F7E6F'>&#62;&#62; threads about modules and sge and multi-line functions (which module is)&#58;</font>
<font color='#7F7E6F'>&#62;&#62;</font>
<font color='#7F7E6F'>&#62;&#62; <a href='http&#58;//comments.gmane.org/gmane.comp.clustering.gridengine.users/18577' target='_blank' rel='nofollow'>http&#58;//comments.gmane.org/gmane.comp.clustering.gridengine.users/18577</a></font>
<font color='#7F7E6F'>&#62;&#62; <a href='http&#58;//comments.gmane.org/gmane.comp.clustering.open-mpi.user/15353' target='_blank' rel='nofollow'>http&#58;//comments.gmane.org/gmane.comp.clustering.open-mpi.user/15353</a></font>
<font color='#7F7E6F'>&#62;&#62;</font>
<font color='#7F7E6F'>&#62;&#62; but the site_topology.py script receives that extraneous stderr text even</font>
<font color='#7F7E6F'>&#62;&#62; if a simple one-liner like this is in /etc/profile&#58;</font>
<font color='#7F7E6F'>&#62;&#62;</font>
<font color='#7F7E6F'>&#62;&#62; function foo () { true; }</font>
<font color='#7F7E6F'>&#62;&#62; export -f foo</font>
<font color='#7F7E6F'>&#62;&#62;</font>
<font color='#7F7E6F'>&#62;&#62; I see the same error as above being passed, except complaining about &#39;foo&#39;</font>
<font color='#7F7E6F'>&#62;&#62; instead of &#39;module&#39;.  So, making module a one-liner does not work.</font>
<font color='#7F7E6F'>&#62;&#62;</font>
<font color='#7F7E6F'>&#62;&#62; On Wed, 6 Jun 2012, Open Science Grid FootPrints wrote&#58;</font>
<font color='#7F7E6F'>&#62;&#62;</font>
<font color='#7F7E6F'>&#62;&#62;&#62; [Duplicate message snipped]</font>
</div><script type='text/javascript'>
        $('#show_1618040744').click(function() {
            $('#detail_1618040744').slideDown("normal");
            $('#show_1618040744').hide();
            $('#hide_1618040744').show();
        });
        $('#hide_1618040744').click(function() {
            $('#detail_1618040744').slideUp();
            $('#hide_1618040744').hide();
            $('#show_1618040744').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='12104#1339103287'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-06-07T21:08:07+00:00">Jun 7, 2012 09:08 PM UTC</time> by <b>john_brunelle@....</b><a class="anchor" name="1339103287">&nbsp;</a></div><pre>Well, I got curious and looked at the gip code and it&#39;s already using
select and reading from stdout/stderr in parallel!  Nice.  Except it looks
like it calls a blocking read instead of a non-blocking read.  I just put
in the following patch to runCommand in gip_testing.py and
site_topology.py now runs smoothly.  By the looks of the code, it&#39;ll just
throw out stderr if exit status is zero, which it is in this case, and
consider it an overall success, so I didn&#39;t have to do anything else to
make it work.

I see GlueCE info in the command line output, but not yet in BDII, but I
only made this change minutes ago.  Maybe it&#39;ll show up and this is
enought of a fix.  Below is the patch (also attached as a file).  The 4096
block size is arbitrary, it&#39;s not part of the solution.

Best,

John

diff -rupN a/gip_testing.py b/gip_testing.py
--- a/gip_testing.py    2011-05-20 13&#58;02&#58;39.000000000 -0400
+++ b/gip_testing.py    2012-06-07 16&#58;45&#58;55.000000000 -0400
@@ -83,13 +83,13 @@ def runCommand(cmd, force_command=False)
while fdlist&#58;
ready = select.select(fdlist, [], [])
if outfd in ready[0]&#58;
-                outchunk = stdout.read()
+                outchunk = os.read(outfd, 4096)
if outchunk == &#39;&#39;&#58;
fdlist.remove(outfd)
else&#58;
outdata.write(outchunk)
if errfd in ready[0]&#58;
-                errchunk = stderr.read()
+                errchunk = os.read(errfd, 4096)
if errchunk == &#39;&#39;&#58;
<div id='show_1342473308' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_1342473308'>fdlist.remove(errfd)
else&#58;

On Thu, 7 Jun 2012, John Brunelle wrote&#58;

<font color='#7F7E6F'>&#62; Hi Burt,</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; I&#39;ve traced this back to interference from the modules package</font>
<font color='#7F7E6F'>&#62; (<a href='http&#58;//modules.sourceforge.net/' target='_blank' rel='nofollow'>http&#58;//modules.sourceforge.net/</a>) we have installed on our cluster, which is</font>
<font color='#7F7E6F'>&#62; causing extra text on stderr and a deadlock in the gip code reading the</font>
<font color='#7F7E6F'>&#62; bqueues output.</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; &#34;module&#34; is a function exported through /etc/profile.  When gip forks and</font>
<font color='#7F7E6F'>&#62; calls bqueues&#58;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; execve(&#34;/bin/sh&#34;, [&#34;/bin/sh&#34;, &#34;-c&#34;, &#34;bqueues -l&#34;]</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; it ends up getting this extra text on stderr&#58;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; write(2, &#34;/bin/sh&#58; module&#58; line 1&#58; syntax error&#58; unexpected end of file&#92;n&#34;,</font>
<font color='#7F7E6F'>&#62; 62) = 62 &#60;0.000010&#62;</font>
<font color='#7F7E6F'>&#62; write(2, &#34;/bin/sh&#58; error importing function definition for &#96;module&#92;&#39;&#92;n&#34;, 58)</font>
<font color='#7F7E6F'>&#62; = 58 &#60;0.000007&#62;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; I&#39;m only seeing this with&#58;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; python /opt/osg-1.2.6/gip/providers/site_topology.py</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; And it&#39;s repeatable for any user, not just daemon.  Every other script I</font>
<font color='#7F7E6F'>&#62; write in shell or python (I&#39;ve only tested the subprocess module so far) does</font>
<font color='#7F7E6F'>&#62; not experience this when calling bqueues.  I&#39;m guessing something about posix</font>
<font color='#7F7E6F'>&#62; compatibility, or login shell, some obscure detail like that in the way that</font>
<font color='#7F7E6F'>&#62; python is doing subprocess calls (I haven&#39;t dug into any gip code to see</font>
<font color='#7F7E6F'>&#62; which of the myriad ways that this can be done in python that it&#39;s using).</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; We must have the module function exported like this, so I&#39;m still digging to</font>
<font color='#7F7E6F'>&#62; see if I can automatically suppress this error.</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; However, there&#39;s the additional issue of why gip is hanging here and not</font>
<font color='#7F7E6F'>&#62; picking up the error.  It could chose to fail or just ignore it, since stdout</font>
<font color='#7F7E6F'>&#62; still has the correct bqueues -l output.  Instead it looks like it&#39;s in a</font>
<font color='#7F7E6F'>&#62; deadlock from trying to read stderr and stdout serially, rather than in</font>
<font color='#7F7E6F'>&#62; parallel using select and non-blocking reads on whichever is ready.</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; I&#39;ve attached the strace of the site_topology.py/bqueues parent/child pair,</font>
<font color='#7F7E6F'>&#62; which shows the deadlock&#58;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; The parent creates a pair of pipes for stdout and stderr and then forks&#58;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; 13&#58;32&#58;15.745906 pipe([5, 6])            = 0 &#60;0.000008&#62;</font>
<font color='#7F7E6F'>&#62; 13&#58;32&#58;15.745946 pipe([7, 8])            = 0 &#60;0.000009&#62;</font>
<font color='#7F7E6F'>&#62; 13&#58;32&#58;15.745992 clone(child_stack=0,</font>
<font color='#7F7E6F'>&#62; flags=CLONE_CHILD_CLEARTID|CLONE_CHILD_SETTID|SIGCHLD, child_tidptr=0) =</font>
<font color='#7F7E6F'>&#62; 27418 &#60;0.000371&#62;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; The child uses file descriptors 6 and 8 for stdout and stderr, respectively&#58;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; 13&#58;32&#58;15.747824 dup2(6, 1)              = 1 &#60;0.000006&#62;</font>
<font color='#7F7E6F'>&#62; 13&#58;32&#58;15.747860 dup2(8, 2)              = 2 &#60;0.000006&#62;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; The child writes the error to stderr&#58;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; 13&#58;32&#58;16.708513 write(2, &#34;/bin/sh&#58; module&#58; line 1&#58; syntax error&#58; unexpected</font>
<font color='#7F7E6F'>&#62; end of file&#92;n&#34;, 62) = 62 &#60;0.000010&#62;</font>
<font color='#7F7E6F'>&#62; 13&#58;32&#58;16.708576 write(2, &#34;/bin/sh&#58; error importing function definition for</font>
<font color='#7F7E6F'>&#62; &#96;module&#92;&#39;&#92;n&#34;, 58) = 58 &#60;0.000007&#62;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; The parent reads it from its end of the pipe&#58;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; 13&#58;32&#58;16.709763 read(7, &#34;/bin/sh&#58; module&#58; line 1&#58; syntax error&#58; unexpected</font>
<font color='#7F7E6F'>&#62; end of file&#92;n/bin/sh&#58; error importing function definition for &#96;module&#92;&#39;&#92;n&#34;,</font>
<font color='#7F7E6F'>&#62; 8192) = 120 &#60;0.000016&#62;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; But the parent continues to try to read more from stderr, and blocks&#58;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; 13&#58;32&#58;16.709836 read(7,</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; Meanwhile the child has put stuff in stdout, and it blocks, since the parent</font>
<font color='#7F7E6F'>&#62; is not reading it&#58;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; 13&#58;32&#58;17.851350 write(1, &#34; PREEMPTIVE[ss_requeue ns_requeue</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; The parent&#39;s read(7,...) (read of stderr) will not complete until it also</font>
<font color='#7F7E6F'>&#62; reads from 5 (stdout).  Deadlock.  Maybe you haven&#39;t seen this before because</font>
<font color='#7F7E6F'>&#62; getting data on both stdout and stderr is rare, plus our bqueues output is</font>
<font color='#7F7E6F'>&#62; humongous, at 111376 bytes, and probably larger than the default buffer size</font>
<font color='#7F7E6F'>&#62; for a low-level read and is hence getting split up.</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; Anyways, that&#39;s were this issue is at.  Something either needs to suppress</font>
<font color='#7F7E6F'>&#62; this extra error message (I&#39;m trying my best for an environment fix on my</font>
<font color='#7F7E6F'>&#62; side rather than asking gip to call subprocesses differently) or gip can be</font>
<font color='#7F7E6F'>&#62; patched to not deadlock and, since it has good bqueues output, ignore the</font>
<font color='#7F7E6F'>&#62; extra error message, and move on.  In an ideal world, the gip deadlock should</font>
<font color='#7F7E6F'>&#62; be patched either way, but I understand if there are more pressing things.</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; By the way, our site is not *really* negatively impacted by this, as Alden</font>
<font color='#7F7E6F'>&#62; from US ATLAS Panda has put in a hack to not require the gip GlueCE info from</font>
<font color='#7F7E6F'>&#62; us.  Hence the high latency in my getting back to you, sorry.</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; Best,</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; John</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; p.s.</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; The error message about the exported function looks very similar to these</font>
<font color='#7F7E6F'>&#62; threads about modules and sge and multi-line functions (which module is)&#58;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; <a href='http&#58;//comments.gmane.org/gmane.comp.clustering.gridengine.users/18577' target='_blank' rel='nofollow'>http&#58;//comments.gmane.org/gmane.comp.clustering.gridengine.users/18577</a></font>
<font color='#7F7E6F'>&#62; <a href='http&#58;//comments.gmane.org/gmane.comp.clustering.open-mpi.user/15353' target='_blank' rel='nofollow'>http&#58;//comments.gmane.org/gmane.comp.clustering.open-mpi.user/15353</a></font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; but the site_topology.py script receives that extraneous stderr text even if</font>
<font color='#7F7E6F'>&#62; a simple one-liner like this is in /etc/profile&#58;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; function foo () { true; }</font>
<font color='#7F7E6F'>&#62; export -f foo</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; I see the same error as above being passed, except complaining about &#39;foo&#39;</font>
<font color='#7F7E6F'>&#62; instead of &#39;module&#39;.  So, making module a one-liner does not work.</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; On Wed, 6 Jun 2012, Open Science Grid FootPrints wrote&#58;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;&#62; [Duplicate message snipped]</font>
</div><script type='text/javascript'>
        $('#show_1342473308').click(function() {
            $('#detail_1342473308').slideDown("normal");
            $('#show_1342473308').hide();
            $('#hide_1342473308').show();
        });
        $('#hide_1342473308').click(function() {
            $('#detail_1342473308').slideUp();
            $('#hide_1342473308').hide();
            $('#show_1342473308').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='12104#1339101488'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-06-07T20:38:08+00:00">Jun 7, 2012 08:38 PM UTC</time> by <b>john_brunelle@....</b><a class="anchor" name="1339101488">&nbsp;</a></div><pre>Hi Burt,

I&#39;ve traced this back to interference from the modules package
(<a href='http&#58;//modules.sourceforge.net/' target='_blank' rel='nofollow'>http&#58;//modules.sourceforge.net/</a>) we have installed on our cluster, which
is causing extra text on stderr and a deadlock in the gip code reading
the bqueues output.

&#34;module&#34; is a function exported through /etc/profile.  When gip forks and
calls bqueues&#58;

execve(&#34;/bin/sh&#34;, [&#34;/bin/sh&#34;, &#34;-c&#34;, &#34;bqueues -l&#34;]

it ends up getting this extra text on stderr&#58;

write(2, &#34;/bin/sh&#58; module&#58; line 1&#58; syntax error&#58; unexpected end of file&#92;n&#34;, 62) = 62 &#60;0.000010&#62;
write(2, &#34;/bin/sh&#58; error importing function definition for &#96;module&#92;&#39;&#92;n&#34;, 58) = 58 &#60;0.000007&#62;

I&#39;m only seeing this with&#58;

python /opt/osg-1.2.6/gip/providers/site_topology.py

And it&#39;s repeatable for any user, not just daemon.  Every other script I
write in shell or python (I&#39;ve only tested the subprocess module so far)
does not experience this when calling bqueues.  I&#39;m guessing something
about posix compatibility, or login shell, some obscure detail like that
in the way that python is doing subprocess calls (I haven&#39;t dug into any
gip code to see which of the myriad ways that this can be done in python
that it&#39;s using).

We must have the module function exported like this, so I&#39;m still digging
to see if I can automatically suppress this error.

However, there&#39;s the additional issue of why gip is hanging here and not
picking up the error.  It could chose to fail or just ignore it, since
stdout still has the correct bqueues -l output.  Instead it looks like
<div id='show_824626191' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_824626191'>it&#39;s in a deadlock from trying to read stderr and stdout serially, rather
than in parallel using select and non-blocking reads on whichever is
ready.

I&#39;ve attached the strace of the site_topology.py/bqueues parent/child
pair, which shows the deadlock&#58;

The parent creates a pair of pipes for stdout and stderr and then forks&#58;

13&#58;32&#58;15.745906 pipe([5, 6])            = 0 &#60;0.000008&#62;
13&#58;32&#58;15.745946 pipe([7, 8])            = 0 &#60;0.000009&#62;
13&#58;32&#58;15.745992 clone(child_stack=0, flags=CLONE_CHILD_CLEARTID|CLONE_CHILD_SETTID|SIGCHLD, child_tidptr=0) = 27418 &#60;0.000371&#62;

The child uses file descriptors 6 and 8 for stdout and stderr,
respectively&#58;

13&#58;32&#58;15.747824 dup2(6, 1)              = 1 &#60;0.000006&#62;
13&#58;32&#58;15.747860 dup2(8, 2)              = 2 &#60;0.000006&#62;

The child writes the error to stderr&#58;

13&#58;32&#58;16.708513 write(2, &#34;/bin/sh&#58; module&#58; line 1&#58; syntax error&#58; unexpected end of file&#92;n&#34;, 62) = 62 &#60;0.000010&#62;
13&#58;32&#58;16.708576 write(2, &#34;/bin/sh&#58; error importing function definition for &#96;module&#92;&#39;&#92;n&#34;, 58) = 58 &#60;0.000007&#62;

The parent reads it from its end of the pipe&#58;

13&#58;32&#58;16.709763 read(7, &#34;/bin/sh&#58; module&#58; line 1&#58; syntax error&#58; unexpected end of file&#92;n/bin/sh&#58; error importing function definition for &#96;module&#92;&#39;&#92;n&#34;, 8192) = 120 &#60;0.000016&#62;

But the parent continues to try to read more from stderr, and blocks&#58;

13&#58;32&#58;16.709836 read(7,

Meanwhile the child has put stuff in stdout, and it blocks, since the
parent is not reading it&#58;

13&#58;32&#58;17.851350 write(1, &#34; PREEMPTIVE[ss_requeue ns_requeue

The parent&#39;s read(7,...) (read of stderr) will not complete until it also
reads from 5 (stdout).  Deadlock.  Maybe you haven&#39;t seen this before
because getting data on both stdout and stderr is rare, plus our bqueues
output is humongous, at 111376 bytes, and probably larger than the default
buffer size for a low-level read and is hence getting split up.

Anyways, that&#39;s were this issue is at.  Something either needs to suppress
this extra error message (I&#39;m trying my best for an environment fix on my
side rather than asking gip to call subprocesses differently) or gip can
be patched to not deadlock and, since it has good bqueues output, ignore
the extra error message, and move on.  In an ideal world, the gip deadlock
should be patched either way, but I understand if there are more pressing
things.

By the way, our site is not *really* negatively impacted by this, as Alden
from US ATLAS Panda has put in a hack to not require the gip GlueCE info
from us.  Hence the high latency in my getting back to you, sorry.

Best,

John

p.s.

The error message about the exported function looks very similar to these
threads about modules and sge and multi-line functions (which module is)&#58;

<a href='http&#58;//comments.gmane.org/gmane.comp.clustering.gridengine.users/18577' target='_blank' rel='nofollow'>http&#58;//comments.gmane.org/gmane.comp.clustering.gridengine.users/18577</a>
<a href='http&#58;//comments.gmane.org/gmane.comp.clustering.open-mpi.user/15353' target='_blank' rel='nofollow'>http&#58;//comments.gmane.org/gmane.comp.clustering.open-mpi.user/15353</a>

but the site_topology.py script receives that extraneous stderr text even
if a simple one-liner like this is in /etc/profile&#58;

function foo () { true; }
export -f foo

I see the same error as above being passed, except complaining about
&#39;foo&#39; instead of &#39;module&#39;.  So, making module a one-liner does not work.

On Wed, 6 Jun 2012, Open Science Grid FootPrints wrote&#58;

<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font>
</div><script type='text/javascript'>
        $('#show_824626191').click(function() {
            $('#detail_824626191').slideDown("normal");
            $('#show_824626191').hide();
            $('#hide_824626191').show();
        });
        $('#hide_824626191').click(function() {
            $('#detail_824626191').slideUp();
            $('#hide_824626191').hide();
            $('#show_824626191').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='12104#1338993848'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-06-06T14:44:08+00:00">Jun 6, 2012 02:44 PM UTC</time> by <b>Burt Holzman</b><a class="anchor" name="1338993848">&nbsp;</a></div><pre>Hi Doug,

bqueues runs fine when run from a command-line GIP, but not from the CEMon-initiated one.  Since the CEMon version runs as daemon, I can&#39;t strace it -- a sysadmin needs to do that.  John, could you catch this in the act?  You could start the strace on the CEMon java process and just gather output for 20 or 30 minutes to make sure we catch an iteration or two.

- B</pre></div><div class='update_description'><i onclick="document.location='12104#1338993533'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-06-06T14:38:53+00:00">Jun 6, 2012 02:38 PM UTC</time><a class="anchor" name="1338993533">&nbsp;</a></div><pre>Hi Burt and John,

This ticket has been stuck for a week now.  It seems like the latest update is that the &#39;bqueues&#39; LSF command is hanging while running GIP but not from the command line.
What is the next step(s)?

Burt, it looks like you have access to their CE.  Can you log in and run gip manually and strace bqueues to see anything interesting, or to see if you can replicate the stuck behavior while running gip manually?

Are there other steps we could take to diagnose this issue?

Doug Strain
OSG Software

-- by Douglas Strain</pre></div><div class='update_description'><i onclick="document.location='12104#1338493372'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-05-31T19:42:52+00:00">May 31, 2012 07:42 PM UTC</time> by <b>Burt Holzman</b><a class="anchor" name="1338493372">&nbsp;</a></div><pre>Still seeing the same behavior -- bqueues -l works fine for me via the fork JM but the daemon user seems to hang with it.  (It might be interesting to see an strace of the bqueues and its parent process when it&#39;s stuck .. what is it waiting for?)</pre></div><div class='update_description'><i onclick="document.location='12104#1338475627'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-05-31T14:47:07+00:00">May 31, 2012 02:47 PM UTC</time> by <b>Burt Holzman</b><a class="anchor" name="1338475627">&nbsp;</a></div><pre>Hi John,

The problem is that the GIP itself is timing out&#58; (from gip/var/logs/gip.log)&#58;

2012-05-31 10&#58;31&#58;28,907 GIP.Wrapper&#58;WARNING /opt/osg-1.2.6/gip/libexec/osg_info_wrapper.py&#58;505&#58;  Attempting to kill pgrp 2474
2012-05-31 10&#58;31&#58;28,909 GIP.Wrapper&#58;WARNING /opt/osg-1.2.6/gip/libexec/osg_info_wrapper.py&#58;504&#58;  The module /opt/osg-1.2.6/gip/providers/batch_system.py timed out!
2012-05-31 10&#58;31&#58;28,910 GIP.Wrapper&#58;WARNING /opt/osg-1.2.6/gip/libexec/osg_info_wrapper.py&#58;505&#58;  Attempting to kill pgrp 2494
2012-05-31 10&#58;31&#58;28,956 GIP.Wrapper&#58;WARNING /opt/osg-1.2.6/gip/libexec/osg_info_wrapper.py&#58;504&#58;  The module /opt/osg-1.2.6/gip/providers/site_topology.py timed out!
2012-05-31 10&#58;31&#58;28,956 GIP.Wrapper&#58;WARNING /opt/osg-1.2.6/gip/libexec/osg_info_wrapper.py&#58;505&#58;  Attempting to kill pgrp 2507

Looking at the process tree, I see the following hanging&#58; (for at least 3 minutes so far)

daemon   31083 30814  0 10&#58;41 pts/1    00&#58;00&#58;00 bqueues -l
daemon   31096 30842  0 10&#58;41 pts/1    00&#58;00&#58;00 bqueues -l
daemon   31268 30850  0 10&#58;41 pts/1    00&#58;00&#58;00 bqueues -l

Any idea why bqueues would be hanging?  It returns relatively quickly for me from the command line.

- B</pre></div><div class='update_description'><i onclick="document.location='12104#1338417488'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-05-30T22:38:08+00:00">May 30, 2012 10:38 PM UTC</time> by <b>Burt Holzman</b><a class="anchor" name="1338417488">&nbsp;</a></div><pre>Hi John,

I&#39;m on the FNAL network.  I&#39;ll take a look at your CE first thing tomorrow.

- B

On May 30, 2012, at 4&#58;30 PM, &#34;Open Science Grid FootPrints&#34; &#60;osg@....&#62; wrote&#58;

<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='12104#1338413349'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-05-30T21:29:09+00:00">May 30, 2012 09:29 PM UTC</time> by <b>john_brunelle@....</b><a class="anchor" name="1338413349">&nbsp;</a></div><pre>Hi Burt,

I updated Generic-Information-Provider to 1.2.0alpha0 (using pacman, so
it pulled in some other VDT-* updates, too)&#58;

[root@heroatlas ~]# vdt-version | grep Generic
Generic Information Provider 1.2.0alpha0                 OK

and also added explicit sourcing of our lsf environment to
osg-info-wrapper&#58;

[root@heroatlas ~]# cat $VDT_LOCATION/gip/libexec/osg-info-wrapper
#!/bin/sh
source /opt/osg-1.2.6/setup.sh
source /etc/profile.d/lsf.sh
/opt/osg-1.2.6/gip/libexec/osg_info_wrapper.py 2&#62; /dev/null

I restarted all services, and the status page at
<a href='http&#58;//is.grid.iu.edu/cgi-bin/status.cgi' target='_blank' rel='nofollow'>http&#58;//is.grid.iu.edu/cgi-bin/status.cgi</a> is showing recent updates, but
still no GlueCE info in our cemon data&#58;

jab@heroatlas&#58;~$ curl -s <a href='http&#58;//is.grid.iu.edu/data/cemon_raw_incoming/heroatlas.fas.harvard.edu' target='_blank' rel='nofollow'>http&#58;//is.grid.iu.edu/data/cemon_raw_incoming/heroatlas.fas.harvard.edu</a> | grep GlueCE
jab@heroatlas&#58;~$

I granted access to your DN, but our gatekeeper is locked down by network
ACLs to only a few source networks.  If you let me know what IP or subnet
you&#39;re coming from, I can make the request to open it up.  On the other
hand, it&#39;s already open to these networks, if you happen to have an
account on one of them&#58;

bu.edu      &#58; 128.197.0.0/16, 192.5.0.0/16
bnl.gov     &#58; 130.199.0.0/16
uta.edu     &#58; 129.107.0.0/16
fnal.gov    &#58; 131.225.0.0/16
uchicago.edu&#58; 128.135.0.0/16
<div id='show_227517656' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_227517656'>OSG testing &#58; 129.79.4.64
INFN-ROMA1  &#58; 141.108.38.0/23 (requested 2012-01-18)
CERN        &#58; 137.138.0.0/16, 128.142.0.0/16

Thanks for your help,

John

On Tue, 29 May 2012, Open Science Grid FootPrints wrote&#58;

<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font>
</div><script type='text/javascript'>
        $('#show_227517656').click(function() {
            $('#detail_227517656').slideDown("normal");
            $('#show_227517656').hide();
            $('#hide_227517656').show();
        });
        $('#hide_227517656').click(function() {
            $('#detail_227517656').slideUp();
            $('#hide_227517656').hide();
            $('#show_227517656').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='12104#1338314347'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-05-29T17:59:07+00:00">May 29, 2012 05:59 PM UTC</time> by <b>Burt Holzman</b><a class="anchor" name="1338314347">&nbsp;</a></div><pre>Sorry, here&#39;s the key bit&#58;

<font color='#7F7E6F'>&#62; Generic Information Provider 1.1.10alpha0                UPDATE</font>
AVAILABLE [1.2.0alpha0]

The last pacman GIP release is 1.2.0alpha0 (we are up to 1.3.7 for the
OSG RPM CE, but most of those address issues with the new filesystem
layout).  That release includes the following fixes that are relevant to
your interests&#58;

* Children with non-zero exit status are now logged properly
* LSF&#58; Bootstrap LSF by sourcing the lsf_profile parameter (if not provided,
we try /lsf/conf/profile.lsf)
* LSF&#58; Ensure max wall time is an integer
* LSF&#58; Use -w option in LSF commands to avoid truncation
* Bugfix&#58; fix the ACBRs to VOLocalViews
* LSF&#58; better parsing of waiting jobs, free slots, host groups
* LSF&#58; bugfix&#58; don&#39;t include queues that are not in the RVF
* Enable publication of WLCG site attributes (admins must set wlcg_tier,
wlcg_parent, wlcg_name in the [site] section of config.ini)
* Better reporting of commands with non-zero exit status
* Remove spaces in storage AccessControlBaseRule
* Remove duplicate software locations

Again, if you want to grant access to the ops VO or to my DN
(/DC=org/DC=doegrids/OU=People/CN=Burt Holzman 380062), I&#39;m happy to run
GIP diagnostics remotely via the fork queue on your gatekeeper and try
to come up with a minimal patch if you want to try that (since it&#39;s my
fault it&#39;s broken in the first place. &#58;)  ) A possible workaround might
be to guarantee that the LSF profile gets sourced by the GIP wrapper --
you could modify $VDT_LOCATION/gip/libexec/osg-info-wrapper to add that
in before it invokes the osg_info_wrapper.py python script, for example.

- B

<div id='show_1444848464' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_1444848464'>On 05/29/12 12&#58;23, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font>
</div><script type='text/javascript'>
        $('#show_1444848464').click(function() {
            $('#detail_1444848464').slideDown("normal");
            $('#show_1444848464').hide();
            $('#hide_1444848464').show();
        });
        $('#hide_1444848464').click(function() {
            $('#detail_1444848464').slideUp();
            $('#hide_1444848464').hide();
            $('#show_1444848464').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='12104#1338312191'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-05-29T17:23:11+00:00">May 29, 2012 05:23 PM UTC</time> by <b>john_brunelle@....</b><a class="anchor" name="1338312191">&nbsp;</a></div><pre>Hi Burt,

We&#39;ve since done several updates.  That version (1.2.6) was just the
initial directory name (I was not expecting to do upgrades in-place as is
the OSG way, otherwise I would not have used a version in the name).
Everything&#39;s been running just fine for a while, though, so there are
indeed some updated we haven&#39;t upgrade to yet.  On the other hand, I&#39;ve
been part of some upgrade-induced failures, too, hence I&#39;m a little
hesitant, but I will do what I have to do &#58;)

What &#34;GIP&#34; package am I supposed to be looking for?  The only one I see
says &#34;OK&#34; rather than &#34;UPDATE AVAILABLE&#34;.  Once I&#39;m sure of what I&#39;m
aiming for, I&#39;ll try the upgrade.

Below is the full vdt-version output.

Thanks,

John

jab@heroatlas&#58;~$ vdt-version | head -n 2

You have installed a subset of VDT version 2.0.0p20&#58;

jab@heroatlas&#58;~$ vdt-version | grep -i gip
Verify GIP output for CEMon 1.5.1                        OK

jab@heroatlas&#58;~$ vdt-version | grep -i cemon
gLite CEMon Server 1.12.1-14                             OK
Verify GIP output for CEMon 1.5.1                        OK

jab@heroatlas&#58;~$ vdt-version

You have installed a subset of VDT version 2.0.0p20&#58;

<div id='show_738914278' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_738914278'>Software                                                 Status
--------                                                 ------
Apache HTTPD 2.2.15                                      UPDATE AVAILABLE [2.2.22]
Bandwidth Test Controller 1.3                            OK
vdt-ca-manage 1.2                                        UPDATE AVAILABLE [1.3]
vdt-update-certs 2.5                                     UPDATE AVAILABLE [2.6]
gLite CEMon Server 1.12.1-14                             OK
CA Certificates 1.28 (includes IGTF 1.47 CAs)            -
Condor Cron For OSG-RSV 7.2.5                            OK
cURL 7.18.2                                              UPDATE AVAILABLE [7.24.0]
dccp (dCache client) 1.8.0-4                             OK
EDG Make Gridmap 3.0.0                                   OK
Fetch CRL 2.6.6                                          UPDATE AVAILABLE [2.8.5]
Generic Information Provider 1.1.10alpha0                UPDATE AVAILABLE [1.2.0alpha0]
Globus Toolkit, pre web-services, client 4.0.8           OK
Globus Toolkit, pre web-services, server 4.0.8           OK
Globus Toolkit, web-services, client 4.0.8               OK
Globus Toolkit, web-services, server 4.0.8               OK
GLUE Schema 1.3                                          OK
GPT 3.2-4.0.8p1                                          OK
Gratia LSF Probe 1.06.16b-1                              UPDATE AVAILABLE [1.07.02e-2.osg]
Gratia Metric Probe 1.06.16b-1                           UPDATE AVAILABLE [1.07.02e-1]
Grid User Management System (GUMS) Client 1.3.17         OK
Java 6 SDK 1.6.0_20                                      UPDATE AVAILABLE [1.6.0_31]
Logrotate 3.7                                            OK
MonALISA 1.8.6                                           OK
MyProxy Client 5.1                                       UPDATE AVAILABLE [5.3]
MySQL 5.0.88                                             UPDATE AVAILABLE [5.0.95]
MySQL Connector/J 5.0.8                                  UPDATE AVAILABLE [5.1.16]
Network Diagnostic Tool 3.5.0                            OK
Network Path and Application Diagnosis Client 1.5.5      OK
OSG RSV Infrastructure 3.2.3                             UPDATE AVAILABLE [3.3.14]
OSG RSV Probes 3.2.3                                     UPDATE AVAILABLE [3.3.14]
OSG Site Web Page Generator 1.3                          OK
One-Way Active Measurement Protocol (One-Way Ping) 3.1   OK
Pegaus Worker Package 2.4.1                              UPDATE AVAILABLE [3.0.1]
PPDG Cert Scripts 2.7                                    OK
PRIMA Authorization Module 0.8.7                         UPDATE AVAILABLE [0.8.8]
PRIMA Authorization Module For GT4 Web Services 0.1.2    OK
pyOpenSSL module 0.9                                     OK
SRM Fermi Client 1.9.5-16                                UPDATE AVAILABLE [1.9.5-23]
SRM Berkeley Client 2.2.1.3.12                           UPDATE AVAILABLE [2.2.1.3.19]
Subversion 1.6.2                                         OK
Syslog-ng 2.0.10                                         OK
Apache Tomcat 5.5.28                                     UPDATE AVAILABLE [5.5.35]
UberFTP 2.4                                              UPDATE AVAILABLE [2.6]
Verify GIP output for CEMon 1.5.1                        OK
VOMS Client 1.8.8-2p1                                    OK
Wget 1.12                                                OK

Status legend&#58;
OK&#58; Software is up to date with the latest release in VDT version 2.0.0
- &#58; Not enough information to determine if updates are available.
Type &#39;man vdt-version&#39; for more information.
jab@heroatlas&#58;~$

On Fri, 25 May 2012, Open Science Grid FootPrints wrote&#58;

<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font>
</div><script type='text/javascript'>
        $('#show_738914278').click(function() {
            $('#detail_738914278').slideDown("normal");
            $('#show_738914278').hide();
            $('#hide_738914278').show();
        });
        $('#hide_738914278').click(function() {
            $('#detail_738914278').slideUp();
            $('#hide_738914278').hide();
            $('#show_738914278').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='12104#1338304100'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-05-29T15:08:20+00:00">May 29, 2012 03:08 PM UTC</time><a class="anchor" name="1338304100">&nbsp;</a></div><pre>Hi John,

It seems that your problem can be solved by an upgrade to a newer version of GIP.  Let us know if you are interested in the GIP team putting together a patch for you, or if you need additional help.  Otherwise, I suggest that we close the ticket.

Doug Strain
OSG Software

-- by Douglas Strain</pre></div><div class='update_description'><i onclick="document.location='12104#1337972991'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-05-25T19:09:51+00:00">May 25, 2012 07:09 PM UTC</time> by <b>Burt Holzman</b><a class="anchor" name="1337972991">&nbsp;</a></div><pre>Hi John,

OSG 1.2.6 corresponds to GIP version 1.1.8, I believe (you can verify this with vdt-version).  That&#39;s more than two years out of date.

There are quite a few bug fixes between then and the last Pacman version&#58; the most important is that when we implemented logging when a child process exits with a non-zero status instead of silently failing. My best guess is that the GIP isn&#39;t sourcing the LSF profile properly or can&#39;t find the binaries.  (The second most important fixes are that we do a much better job finding the LSF binaries).

If you grant the ops VO access to heroatlas (or just my DN), I can try and verify this remotely. I might be able also to provide a quick patch if you are averse to upgrade.

- B</pre></div><div class='update_description'><i onclick="document.location='12104#1337709907'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-05-22T18:05:07+00:00">May 22, 2012 06:05 PM UTC</time> by <b>john_brunelle@....</b><a class="anchor" name="1337709907">&nbsp;</a></div><pre>Hi Douglas.

Below is what I get when I run lsf.py.  I see lots of GlueCE info.  I
assume the permission error I get regarding gip.log is not a problem --
the file is owned by daemon, which is /sbin/nologin&#39;d, otherwise I&#39;d run
as that uid.

Thanks,

John

jab@heroatlas&#58;~$ source /opt/osg/setup.sh
jab@heroatlas&#58;~$ echo $VDT_LOCATION
/opt/osg-1.2.6
jab@heroatlas&#58;~$ echo $GIP_LOCATION
/opt/osg-1.2.6/gip
jab@heroatlas&#58;~$ $GIP_LOCATION/lib/python/gip/providers/lsf.py
Traceback (most recent call last)&#58;
File &#34;/opt/osg-1.2.6/gip/lib/python/gip_common.py&#34;, line 348, in ?
add_giplog_handler()
File &#34;/opt/osg-1.2.6/gip/lib/python/gip_common.py&#34;, line 339, in
add_giplog_handler
maxBytes=1024*1024*10, backupCount=5)
File &#34;/usr/lib64/python2.4/logging/handlers.py&#34;, line 107, in __init__
BaseRotatingHandler.__init__(self, filename, mode, encoding)
File &#34;/usr/lib64/python2.4/logging/handlers.py&#34;, line 59, in __init__
logging.FileHandler.__init__(self, filename, mode, encoding)
File &#34;/usr/lib64/python2.4/logging/__init__.py&#34;, line 757, in __init__
stream = open(filename, mode)
IOError&#58; [Errno 13] Permission denied&#58;
&#39;/opt/osg-1.2.6/gip/var/logs/gip.log&#39;
GIP.common&#58;INFO gip_common&#58;165&#58;  Using GIP SVN revision $Revision&#58; 4045 $
GIP.common&#58;INFO gip_common&#58;170&#58;  Using config file&#58; gip.conf
GIP.common&#58;INFO gip_common&#58;170&#58;  Using config file&#58;
/opt/osg-1.2.6/gip/etc/gip.conf
<div id='show_97517628' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_97517628'>GIP&#58;INFO gip_osg&#58;159&#58;  Using OSG config.ini
/opt/osg-1.2.6/monitoring/config.ini.
GIP&#58;DEBUG gip_osg&#58;637&#58;  Starting to configure information service
endpoints
GIP&#58;INFO gip_osg&#58;702&#58;  Configured BDII endpoints&#58;
<a href='http&#58;//is1.grid.iu.edu&#58;14001' target='_blank' rel='nofollow'>http&#58;//is1.grid.iu.edu&#58;14001</a>, <a href='http&#58;//is2.grid.iu.edu&#58;14001.' target='_blank' rel='nofollow'>http&#58;//is2.grid.iu.edu&#58;14001.</a>
GIP&#58;INFO gip_osg&#58;710&#58;  Configured ReSS endpoints&#58;
<a href='https&#58;//osg-ress-1.fnal.gov&#58;8443/ig/services/CEInfoCollector.' target='_blank' rel='nofollow'>https&#58;//osg-ress-1.fnal.gov&#58;8443/ig/services/CEInfoCollector.</a>
GIP.common&#58;INFO gip_common&#58;225&#58;  Using user-to-VO map location
$VDT_LOCATION/monitoring/osg-user-vo-map.txt.
GIP.common&#58;INFO gip_common&#58;225&#58;  Using user-to-VO map location
$VDT_LOCATION/monitoring/osg-user-vo-map.txt.
GIP.LSF&#58;INFO lsf_common&#58;354&#58;  The RVF lists the following queues&#58;
ATLAS_Production, ATLAS_Install, ATLAS_Analysis.
dn&#58;
GlueCEUniqueID=heroatlas.fas.harvard.edu&#58;2119/jobmanager-lsf-ATLAS_Analysis,mds-vo-name=local,o=grid
objectClass&#58; GlueCETop
objectClass&#58; GlueCE
objectClass&#58; GlueSchemaVersion
objectClass&#58; GlueCEAccessControlBase
objectClass&#58; GlueCEInfo
objectClass&#58; GlueCEPolicy
objectClass&#58; GlueCEState
objectClass&#58; GlueInformationService
objectClass&#58; GlueKey
GlueCEHostingCluster&#58; heroatlas.fas.harvard.edu
GlueCEName&#58; ATLAS_Analysis
GlueCEImplementationName&#58; Globus
GlueCEImplementationVersion&#58; 4.0.6
GlueCEUniqueID&#58;
heroatlas.fas.harvard.edu&#58;2119/jobmanager-lsf-ATLAS_Analysis
GlueCEInfoGatekeeperPort&#58; 2119
GlueCEInfoHostName&#58; heroatlas.fas.harvard.edu
GlueCEInfoLRMSType&#58; lsf
GlueCEInfoLRMSVersion&#58; Platform LSF HPC 7 Update 6, Sep 04 2009
GlueCEInfoGRAMVersion&#58; 2.0
GlueCEInfoTotalCPUs&#58; 0
GlueCEInfoJobManager&#58; lsf
GlueCEInfoContactString&#58;
heroatlas.fas.harvard.edu/jobmanager-lsf-ATLAS_Analysis
GlueCEInfoApplicationDir&#58; /n/data1/ATLAS/osg/app
GlueCEInfoDataDir&#58; /n/data1/ATLAS/osg/data
GlueCEInfoDefaultSE&#58; heroatlas.fas.harvard.edu
GlueCEStateEstimatedResponseTime&#58; 60
GlueCEStateFreeCPUs&#58; 0
GlueCEStateRunningJobs&#58; 220
GlueCEStateStatus&#58; Production
GlueCEStateTotalJobs&#58; 220
GlueCEStateWaitingJobs&#58; 0
GlueCEStateWorstResponseTime&#58; 120
GlueCEStateFreeJobSlots&#58; 0
GlueCEPolicyMaxCPUTime&#58; 1440
GlueCEPolicyMaxObtainableCPUTime&#58; 1440
GlueCEPolicyMaxRunningJobs&#58; 999999
GlueCEPolicyMaxWaitingJobs&#58; 999999
GlueCEPolicyMaxTotalJobs&#58; 1999998
GlueCEPolicyMaxWallClockTime&#58; 1440
GlueCEPolicyMaxObtainableWallClockTime&#58; 1440
GlueCEPolicyPriority&#58; 150
GlueCEPolicyAssignedJobSlots&#58; 0
GlueCEPolicyMaxSlotsPerJob&#58; 1
GlueCEPolicyPreemption&#58; 0
GlueCEAccessControlBaseRule&#58; VO&#58;atlas
GlueCEAccessControlBaseRule&#58; VO&#58;osg
GlueCECapability&#58; CPUScalingReferenceSI00=2000
GlueCECapability&#58; glexec
GlueInformationServiceURL&#58; ldap&#58;//is.grid.iu.edu&#58;2170
GlueForeignKey&#58; GlueClusterUniqueID=heroatlas.fas.harvard.edu
GlueSchemaVersionMajor&#58; 1
GlueSchemaVersionMinor&#58; 3

dn&#58;
GlueCEUniqueID=heroatlas.fas.harvard.edu&#58;2119/jobmanager-lsf-ATLAS_Install,mds-vo-name=local,o=grid
objectClass&#58; GlueCETop
objectClass&#58; GlueCE
objectClass&#58; GlueSchemaVersion
objectClass&#58; GlueCEAccessControlBase
objectClass&#58; GlueCEInfo
objectClass&#58; GlueCEPolicy
objectClass&#58; GlueCEState
objectClass&#58; GlueInformationService
objectClass&#58; GlueKey
GlueCEHostingCluster&#58; heroatlas.fas.harvard.edu
GlueCEName&#58; ATLAS_Install
GlueCEImplementationName&#58; Globus
GlueCEImplementationVersion&#58; 4.0.6
GlueCEUniqueID&#58;
heroatlas.fas.harvard.edu&#58;2119/jobmanager-lsf-ATLAS_Install
GlueCEInfoGatekeeperPort&#58; 2119
GlueCEInfoHostName&#58; heroatlas.fas.harvard.edu
GlueCEInfoLRMSType&#58; lsf
GlueCEInfoLRMSVersion&#58; Platform LSF HPC 7 Update 6, Sep 04 2009
GlueCEInfoGRAMVersion&#58; 2.0
GlueCEInfoTotalCPUs&#58; 0
GlueCEInfoJobManager&#58; lsf
GlueCEInfoContactString&#58;
heroatlas.fas.harvard.edu/jobmanager-lsf-ATLAS_Install
GlueCEInfoApplicationDir&#58; /n/data1/ATLAS/osg/app
GlueCEInfoDataDir&#58; /n/data1/ATLAS/osg/data
GlueCEInfoDefaultSE&#58; heroatlas.fas.harvard.edu
GlueCEStateEstimatedResponseTime&#58; 60
GlueCEStateFreeCPUs&#58; 0
GlueCEStateRunningJobs&#58; 0
GlueCEStateStatus&#58; Production
GlueCEStateTotalJobs&#58; 0
GlueCEStateWaitingJobs&#58; 0
GlueCEStateWorstResponseTime&#58; 86400
GlueCEStateFreeJobSlots&#58; 0
GlueCEPolicyMaxCPUTime&#58; 1440
GlueCEPolicyMaxObtainableCPUTime&#58; 1440
GlueCEPolicyMaxRunningJobs&#58; 999999
GlueCEPolicyMaxWaitingJobs&#58; 999999
GlueCEPolicyMaxTotalJobs&#58; 1999998
GlueCEPolicyMaxWallClockTime&#58; 1440
GlueCEPolicyMaxObtainableWallClockTime&#58; 1440
GlueCEPolicyPriority&#58; 150
GlueCEPolicyAssignedJobSlots&#58; 0
GlueCEPolicyMaxSlotsPerJob&#58; 1
GlueCEPolicyPreemption&#58; 0
GlueCEAccessControlBaseRule&#58; VO&#58;atlas
GlueCEAccessControlBaseRule&#58; VO&#58;osg
GlueCECapability&#58; CPUScalingReferenceSI00=2000
GlueCECapability&#58; glexec
GlueInformationServiceURL&#58; ldap&#58;//is.grid.iu.edu&#58;2170
GlueForeignKey&#58; GlueClusterUniqueID=heroatlas.fas.harvard.edu
GlueSchemaVersionMajor&#58; 1
GlueSchemaVersionMinor&#58; 3

dn&#58;
GlueCEUniqueID=heroatlas.fas.harvard.edu&#58;2119/jobmanager-lsf-ATLAS_Production,mds-vo-name=local,o=grid
objectClass&#58; GlueCETop
objectClass&#58; GlueCE
objectClass&#58; GlueSchemaVersion
objectClass&#58; GlueCEAccessControlBase
objectClass&#58; GlueCEInfo
objectClass&#58; GlueCEPolicy
objectClass&#58; GlueCEState
objectClass&#58; GlueInformationService
objectClass&#58; GlueKey
GlueCEHostingCluster&#58; heroatlas.fas.harvard.edu
GlueCEName&#58; ATLAS_Production
GlueCEImplementationName&#58; Globus
GlueCEImplementationVersion&#58; 4.0.6
GlueCEUniqueID&#58;
heroatlas.fas.harvard.edu&#58;2119/jobmanager-lsf-ATLAS_Production
GlueCEInfoGatekeeperPort&#58; 2119
GlueCEInfoHostName&#58; heroatlas.fas.harvard.edu
GlueCEInfoLRMSType&#58; lsf
GlueCEInfoLRMSVersion&#58; Platform LSF HPC 7 Update 6, Sep 04 2009
GlueCEInfoGRAMVersion&#58; 2.0
GlueCEInfoTotalCPUs&#58; 1908
GlueCEInfoJobManager&#58; lsf
GlueCEInfoContactString&#58;
heroatlas.fas.harvard.edu/jobmanager-lsf-ATLAS_Production
GlueCEInfoApplicationDir&#58; /n/data1/ATLAS/osg/app
GlueCEInfoDataDir&#58; /n/data1/ATLAS/osg/data
GlueCEInfoDefaultSE&#58; heroatlas.fas.harvard.edu
GlueCEStateEstimatedResponseTime&#58; 60
GlueCEStateFreeCPUs&#58; 0
GlueCEStateRunningJobs&#58; 1622
GlueCEStateStatus&#58; Production
GlueCEStateTotalJobs&#58; 1625
GlueCEStateWaitingJobs&#58; 3
GlueCEStateWorstResponseTime&#58; 120
GlueCEStateFreeJobSlots&#58; 0
GlueCEPolicyMaxCPUTime&#58; 1440
GlueCEPolicyMaxObtainableCPUTime&#58; 1440
GlueCEPolicyMaxRunningJobs&#58; 999999
GlueCEPolicyMaxWaitingJobs&#58; 999999
GlueCEPolicyMaxTotalJobs&#58; 1999998
GlueCEPolicyMaxWallClockTime&#58; 1440
GlueCEPolicyMaxObtainableWallClockTime&#58; 1440
GlueCEPolicyPriority&#58; 150
GlueCEPolicyAssignedJobSlots&#58; 1908
GlueCEPolicyMaxSlotsPerJob&#58; 1
GlueCEPolicyPreemption&#58; 0
GlueCEAccessControlBaseRule&#58; VO&#58;atlas
GlueCEAccessControlBaseRule&#58; VO&#58;osg
GlueCECapability&#58; CPUScalingReferenceSI00=2000
GlueCECapability&#58; glexec
GlueInformationServiceURL&#58; ldap&#58;//is.grid.iu.edu&#58;2170
GlueForeignKey&#58; GlueClusterUniqueID=heroatlas.fas.harvard.edu
GlueSchemaVersionMajor&#58; 1
GlueSchemaVersionMinor&#58; 3

GIP.common&#58;INFO gip_common&#58;225&#58;  Using user-to-VO map location
$VDT_LOCATION/monitoring/osg-user-vo-map.txt.
GIP.common&#58;INFO gip_common&#58;225&#58;  Using user-to-VO map location
$VDT_LOCATION/monitoring/osg-user-vo-map.txt.
GIP.LSF&#58;INFO lsf_common&#58;354&#58;  The RVF lists the following queues&#58;
ATLAS_Production, ATLAS_Install, ATLAS_Analysis.
dn&#58;
GlueVOViewLocalID=atlas,GlueCEUniqueID=heroatlas.fas.harvard.edu&#58;2119/jobmanager-lsf-ATLAS_Analysis,mds-vo-name=local,o=grid
objectClass&#58; GlueCETop
objectClass&#58; GlueVOView
objectClass&#58; GlueCEInfo
objectClass&#58; GlueCEState
objectClass&#58; GlueCEAccessControlBase
objectClass&#58; GlueCEPolicy
objectClass&#58; GlueKey
objectClass&#58; GlueSchemaVersion
GlueVOViewLocalID&#58; atlas
GlueCEAccessControlBaseRule&#58; VO&#58;atlas
GlueCEStateRunningJobs&#58; 0
GlueCEStateWaitingJobs&#58; 0
GlueCEStateTotalJobs&#58; 0
GlueCEStateFreeJobSlots&#58; 0
GlueCEStateEstimatedResponseTime&#58; 60
GlueCEStateWorstResponseTime&#58; 86400
GlueCEInfoDefaultSE&#58; heroatlas.fas.harvard.edu
GlueCEInfoApplicationDir&#58; /n/data1/ATLAS/osg/app
GlueCEInfoDataDir&#58; /n/data1/ATLAS/osg/data
GlueChunkKey&#58;
GlueCEUniqueID=heroatlas.fas.harvard.edu&#58;2119/jobmanager-lsf-ATLAS_Analysis
GlueSchemaVersionMajor&#58; 1
GlueSchemaVersionMinor&#58; 3

dn&#58;
GlueVOViewLocalID=osg,GlueCEUniqueID=heroatlas.fas.harvard.edu&#58;2119/jobmanager-lsf-ATLAS_Analysis,mds-vo-name=local,o=grid
objectClass&#58; GlueCETop
objectClass&#58; GlueVOView
objectClass&#58; GlueCEInfo
objectClass&#58; GlueCEState
objectClass&#58; GlueCEAccessControlBase
objectClass&#58; GlueCEPolicy
objectClass&#58; GlueKey
objectClass&#58; GlueSchemaVersion
GlueVOViewLocalID&#58; osg
GlueCEAccessControlBaseRule&#58; VO&#58;osg
GlueCEStateRunningJobs&#58; 0
GlueCEStateWaitingJobs&#58; 0
GlueCEStateTotalJobs&#58; 0
GlueCEStateFreeJobSlots&#58; 0
GlueCEStateEstimatedResponseTime&#58; 60
GlueCEStateWorstResponseTime&#58; 86400
GlueCEInfoDefaultSE&#58; heroatlas.fas.harvard.edu
GlueCEInfoApplicationDir&#58; /n/data1/ATLAS/osg/app
GlueCEInfoDataDir&#58; /n/data1/ATLAS/osg/data
GlueChunkKey&#58;
GlueCEUniqueID=heroatlas.fas.harvard.edu&#58;2119/jobmanager-lsf-ATLAS_Analysis
GlueSchemaVersionMajor&#58; 1
GlueSchemaVersionMinor&#58; 3

dn&#58;
GlueVOViewLocalID=atlas,GlueCEUniqueID=heroatlas.fas.harvard.edu&#58;2119/jobmanager-lsf-ATLAS_Install,mds-vo-name=local,o=grid
objectClass&#58; GlueCETop
objectClass&#58; GlueVOView
objectClass&#58; GlueCEInfo
objectClass&#58; GlueCEState
objectClass&#58; GlueCEAccessControlBase
objectClass&#58; GlueCEPolicy
objectClass&#58; GlueKey
objectClass&#58; GlueSchemaVersion
GlueVOViewLocalID&#58; atlas
GlueCEAccessControlBaseRule&#58; VO&#58;atlas
GlueCEStateRunningJobs&#58; 0
GlueCEStateWaitingJobs&#58; 0
GlueCEStateTotalJobs&#58; 0
GlueCEStateFreeJobSlots&#58; 0
GlueCEStateEstimatedResponseTime&#58; 60
GlueCEStateWorstResponseTime&#58; 86400
GlueCEInfoDefaultSE&#58; heroatlas.fas.harvard.edu
GlueCEInfoApplicationDir&#58; /n/data1/ATLAS/osg/app
GlueCEInfoDataDir&#58; /n/data1/ATLAS/osg/data
GlueChunkKey&#58;
GlueCEUniqueID=heroatlas.fas.harvard.edu&#58;2119/jobmanager-lsf-ATLAS_Install
GlueSchemaVersionMajor&#58; 1
GlueSchemaVersionMinor&#58; 3

dn&#58;
GlueVOViewLocalID=osg,GlueCEUniqueID=heroatlas.fas.harvard.edu&#58;2119/jobmanager-lsf-ATLAS_Install,mds-vo-name=local,o=grid
objectClass&#58; GlueCETop
objectClass&#58; GlueVOView
objectClass&#58; GlueCEInfo
objectClass&#58; GlueCEState
objectClass&#58; GlueCEAccessControlBase
objectClass&#58; GlueCEPolicy
objectClass&#58; GlueKey
objectClass&#58; GlueSchemaVersion
GlueVOViewLocalID&#58; osg
GlueCEAccessControlBaseRule&#58; VO&#58;osg
GlueCEStateRunningJobs&#58; 0
GlueCEStateWaitingJobs&#58; 0
GlueCEStateTotalJobs&#58; 0
GlueCEStateFreeJobSlots&#58; 0
GlueCEStateEstimatedResponseTime&#58; 60
GlueCEStateWorstResponseTime&#58; 86400
GlueCEInfoDefaultSE&#58; heroatlas.fas.harvard.edu
GlueCEInfoApplicationDir&#58; /n/data1/ATLAS/osg/app
GlueCEInfoDataDir&#58; /n/data1/ATLAS/osg/data
GlueChunkKey&#58;
GlueCEUniqueID=heroatlas.fas.harvard.edu&#58;2119/jobmanager-lsf-ATLAS_Install
GlueSchemaVersionMajor&#58; 1
GlueSchemaVersionMinor&#58; 3

dn&#58;
GlueVOViewLocalID=atlas,GlueCEUniqueID=heroatlas.fas.harvard.edu&#58;2119/jobmanager-lsf-ATLAS_Production,mds-vo-name=local,o=grid
objectClass&#58; GlueCETop
objectClass&#58; GlueVOView
objectClass&#58; GlueCEInfo
objectClass&#58; GlueCEState
objectClass&#58; GlueCEAccessControlBase
objectClass&#58; GlueCEPolicy
objectClass&#58; GlueKey
objectClass&#58; GlueSchemaVersion
GlueVOViewLocalID&#58; atlas
GlueCEAccessControlBaseRule&#58; VO&#58;atlas
GlueCEStateRunningJobs&#58; 0
GlueCEStateWaitingJobs&#58; 0
GlueCEStateTotalJobs&#58; 0
GlueCEStateFreeJobSlots&#58; 0
GlueCEStateEstimatedResponseTime&#58; 60
GlueCEStateWorstResponseTime&#58; 86400
GlueCEInfoDefaultSE&#58; heroatlas.fas.harvard.edu
GlueCEInfoApplicationDir&#58; /n/data1/ATLAS/osg/app
GlueCEInfoDataDir&#58; /n/data1/ATLAS/osg/data
GlueChunkKey&#58;
GlueCEUniqueID=heroatlas.fas.harvard.edu&#58;2119/jobmanager-lsf-ATLAS_Production
GlueSchemaVersionMajor&#58; 1
GlueSchemaVersionMinor&#58; 3

dn&#58;
GlueVOViewLocalID=osg,GlueCEUniqueID=heroatlas.fas.harvard.edu&#58;2119/jobmanager-lsf-ATLAS_Production,mds-vo-name=local,o=grid
objectClass&#58; GlueCETop
objectClass&#58; GlueVOView
objectClass&#58; GlueCEInfo
objectClass&#58; GlueCEState
objectClass&#58; GlueCEAccessControlBase
objectClass&#58; GlueCEPolicy
objectClass&#58; GlueKey
objectClass&#58; GlueSchemaVersion
GlueVOViewLocalID&#58; osg
GlueCEAccessControlBaseRule&#58; VO&#58;osg
GlueCEStateRunningJobs&#58; 0
GlueCEStateWaitingJobs&#58; 0
GlueCEStateTotalJobs&#58; 0
GlueCEStateFreeJobSlots&#58; 0
GlueCEStateEstimatedResponseTime&#58; 60
GlueCEStateWorstResponseTime&#58; 86400
GlueCEInfoDefaultSE&#58; heroatlas.fas.harvard.edu
GlueCEInfoApplicationDir&#58; /n/data1/ATLAS/osg/app
GlueCEInfoDataDir&#58; /n/data1/ATLAS/osg/data
GlueChunkKey&#58;
GlueCEUniqueID=heroatlas.fas.harvard.edu&#58;2119/jobmanager-lsf-ATLAS_Production
GlueSchemaVersionMajor&#58; 1
GlueSchemaVersionMinor&#58; 3

On Fri, 18 May 2012, Open Science Grid FootPrints wrote&#58;

<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font>
</div><script type='text/javascript'>
        $('#show_97517628').click(function() {
            $('#detail_97517628').slideDown("normal");
            $('#show_97517628').hide();
            $('#hide_97517628').show();
        });
        $('#hide_97517628').click(function() {
            $('#detail_97517628').slideUp();
            $('#hide_97517628').hide();
            $('#show_97517628').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='12104#1337369416'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-05-18T19:30:16+00:00">May 18, 2012 07:30 PM UTC</time><a class="anchor" name="1337369416">&nbsp;</a></div><pre>Hello,

I have contacted the GIP developers.  It seems that the GIP is reading the LSF rvf file and configuration correctly but is not reporting any functioning batch systems to report GlueCE information.

Could you set the following values&#58;
export VDT_LOCATION=&#60;their location&#62;
export GIP_LOCATION=$VDT_LOCATION/gip
then run&#58;
$GIP_LOCATION/lib/python/gip/providers/lsf.py

This may shed some light on why GIP does not report a functioning CE.

Thanks,
Doug Strain
OSG Software

-- by Douglas Strain</pre></div><div class='update_description'><i onclick="document.location='12104#1337201588'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-05-16T20:53:08+00:00">May 16, 2012 08:53 PM UTC</time> by <b>Saul Youssef</b><a class="anchor" name="1337201588">&nbsp;</a></div><pre>Hi Soichi,

Sorry, I missed the request.  Attached is gip.log.gz as requested and
the output of gzip_info (gzip_info.out.gz).

- Saul

On Wed, May 16, 2012 at 4&#58;01 PM, Open Science Grid FootPrints &#60;
osg@....&#62; wrote&#58;

<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='12104#1337198462'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-05-16T20:01:02+00:00">May 16, 2012 08:01 PM UTC</time> by <b>Soichi Hayashi</b><a class="anchor" name="1337198462">&nbsp;</a></div><pre>Saul, can you submit the log files Doug requested?

Extending NAD.</pre></div><div class='update_description'><i onclick="document.location='12104#1337010902'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-05-14T15:55:02+00:00">May 14, 2012 03:55 PM UTC</time><a class="anchor" name="1337010902">&nbsp;</a></div><pre>Hello,

It is possible that these commands are not running correctly due to a change in configuration or path.  The raw cemon data suggests that GIP is running correctly but is not generating the appropriate GlueCE information so it is likely not able to run the commands correctly (possibly due to a missing path or environment variables).  Can you submit the gip log at the following location&#58;
$VDT_LOCATION/logs/gip.log
This may give hints as to why the GIP is failing.  You may also want to consider running &#34;gip_info&#34; by hand or to run &#34;osg-configure -v&#34; to see if there are any obvious errors or misconfigurations.  Let me know if you have any questions.

Doug Strain
OSG Software

-- by Douglas Strain</pre></div><div class='update_description'><i onclick="document.location='12104#1336683822'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-05-10T21:03:42+00:00">May 10, 2012 09:03 PM UTC</time><a class="anchor" name="1336683822">&nbsp;</a></div><pre>The LCG_GFAL_INFOSYS setting for the Panda run of lcg-info is

LCG_GFAL_INFOSYS=lcg-bdii.cern.ch&#58;2170

Cheers,

Alden

-- by Alden Stradling</pre></div><div class='update_description'><i onclick="document.location='12104#1336592251'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-05-09T19:37:31+00:00">May 9, 2012 07:37 PM UTC</time> by <b>Soichi Hayashi</b><a class="anchor" name="1336592251">&nbsp;</a></div><pre>(Forwarding this ticket to Software Team)

Software Team,

heroatlas.fas.harvard.edu is currently experiencing the issue of missing GlueCE object sent to OSG BDII by GIP. Similar issue has occurred several times in the past where restarting of tomcat has fixed the problem. In this instance, it has not fixed the problem.

On another occasion, such as this &#62; <a href='10566&sort=up' target='_blank' rel='nofollow'>https&#58;//ticket.grid.iu.edu/goc/viewer?id=10566&sort=up</a>
The problem simply disappeared couple of days after it started without explanation.

Can you assist John Brunelle to troubleshoot why his cemon/gip is not reporting GlueCE object?

Thanks,
Soichi</pre></div><div class='update_description'><i onclick="document.location='12104#1336591387'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-05-09T19:23:07+00:00">May 9, 2012 07:23 PM UTC</time> by <b>john_brunelle@....</b><a class="anchor" name="1336591387">&nbsp;</a></div><pre>Hi,

Yes, we have that in our config&#58;

[root@heroatlas ~]# cat $VDT_LOCATION/osg/etc/config.ini | grep -v &#39;^;&#39; | sed &#39;/^$/d&#39; | grep -F -A 9 &#39;[Cemon]&#39;
[Cemon]
osg-ress-servers = <a href='https&#58;//osg-ress-1.fnal.gov&#58;8443/ig/services/CEInfoCollector' target='_blank' rel='nofollow'>https&#58;//osg-ress-1.fnal.gov&#58;8443/ig/services/CEInfoCollector</a>[OLD_CLASSAD]
osg-bdii-servers = <a href='http&#58;//is1.grid.iu.edu&#58;14001' target='_blank' rel='nofollow'>http&#58;//is1.grid.iu.edu&#58;14001</a>[RAW], <a href='http&#58;//is2.grid.iu.edu&#58;14001' target='_blank' rel='nofollow'>http&#58;//is2.grid.iu.edu&#58;14001</a>[RAW]
itb-ress-servers = <a href='https&#58;//osg-ress-4.fnal.gov&#58;8443/ig/services/CEInfoCollector' target='_blank' rel='nofollow'>https&#58;//osg-ress-4.fnal.gov&#58;8443/ig/services/CEInfoCollector</a>[OLD_CLASSAD]
itb-bdii-servers = <a href='http&#58;//is-itb1.grid.iu.edu&#58;14001' target='_blank' rel='nofollow'>http&#58;//is-itb1.grid.iu.edu&#58;14001</a>[RAW], <a href='http&#58;//is-itb2.grid.iu.edu&#58;14001' target='_blank' rel='nofollow'>http&#58;//is-itb2.grid.iu.edu&#58;14001</a>[RAW]

enabled = %(enable)s
ress_servers = %(osg-ress-servers)s
bdii_servers = %(osg-bdii-servers)s
[Gratia]

I have in my notes that we put it in on Jan 22, 2009.

Thanks,

John

On Wed, 9 May 2012, Open Science Grid FootPrints wrote&#58;

<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='12104#1336590748'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-05-09T19:12:28+00:00">May 9, 2012 07:12 PM UTC</time> by <b>Soichi Hayashi</b><a class="anchor" name="1336590748">&nbsp;</a></div><pre>(CC-ed John)

Do you see following in your cemon configuration?

/etc/osg/config.d/30-cemon.ini
[Cemon]
osg-ress-servers = <a href='https&#58;//osg-ress-1.fnal.gov&#58;8443/ig/services/CEInfoCollector' target='_blank' rel='nofollow'>https&#58;//osg-ress-1.fnal.gov&#58;8443/ig/services/CEInfoCollector</a>[OLD_CLASSAD]
osg-bdii-servers = <a href='http&#58;//is1.grid.iu.edu&#58;14001' target='_blank' rel='nofollow'>http&#58;//is1.grid.iu.edu&#58;14001</a>[RAW], <a href='http&#58;//is2.grid.iu.edu&#58;14001' target='_blank' rel='nofollow'>http&#58;//is2.grid.iu.edu&#58;14001</a>[RAW]
enabled = TRUE

Soichi</pre></div><div class='update_description'><i onclick="document.location='12104#1336584187'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-05-09T17:23:07+00:00">May 9, 2012 05:23 PM UTC</time> by <b>Saul Youssef</b><a class="anchor" name="1336584187">&nbsp;</a></div><pre>Hi Soichi,

Thanks for helping.  Can you add &#34;john_brunelle@....&#34; to the
ticket?  I don&#39;t know how to do that myself.

John tried restarting tomcat, the status page said that there was an
update in the past few minutes, but there are still no GlueCE* entries.
Any suggestions from here?

- Saul & John

On Wed, May 9, 2012 at 12&#58;31 PM, Open Science Grid FootPrints &#60;
osg@....&#62; wrote&#58;

<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='12104#1336581127'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-05-09T16:32:07+00:00">May 9, 2012 04:32 PM UTC</time> by <b>Saul Youssef</b><a class="anchor" name="1336581127">&nbsp;</a></div><pre>Adding John to the thread.   - Saul

On Wed, May 9, 2012 at 11&#58;53 AM, Open Science Grid FootPrints &#60;
osg@....&#62; wrote&#58;

<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='12104#1336581079'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-05-09T16:31:19+00:00">May 9, 2012 04:31 PM UTC</time> by <b>Soichi Hayashi</b><a class="anchor" name="1336581079">&nbsp;</a></div><pre>According to raw data received on is.grid.iu.edu, heroatlas.fas.harvard.edu is not sending information with GlueCE object.
<font color='#7F7E6F'>&#62; <a href='http&#58;//is.grid.iu.edu/data/cemon_raw_incoming/heroatlas.fas.harvard.edu' target='_blank' rel='nofollow'>http&#58;//is.grid.iu.edu/data/cemon_raw_incoming/heroatlas.fas.harvard.edu</a></font>
Compare to
<font color='#7F7E6F'>&#62; <a href='http&#58;//is.grid.iu.edu/data/cemon_raw_incoming/atlas.bu.edu' target='_blank' rel='nofollow'>http&#58;//is.grid.iu.edu/data/cemon_raw_incoming/atlas.bu.edu</a></font>

Can you make sure that GIP on heroatlas.fas.harvard.edu is correctly configured, and see if you find anything interesting in the GIP log?

Also, I have seem similar issues in the past and restarting tomcat has magically corrected the issue, which you might want to try.

Thanks,
Soichi</pre></div><div class='update_description'><i onclick="document.location='12104#1336578787'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-05-09T15:53:07+00:00">May 9, 2012 03:53 PM UTC</time> by <b>Saul Youssef</b><a class="anchor" name="1336578787">&nbsp;</a></div><pre>youssef@at4&#58;~$ env | grep LCG
LCG_GFAL_INFOSYS=is.grid.iu.edu&#58;2170

LFC_HOST is not defined.

- Saul

On Wed, May 9, 2012 at 11&#58;44 AM, Open Science Grid FootPrints &#60;
osg@....&#62; wrote&#58;

<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='12104#1336578267'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-05-09T15:44:27+00:00">May 9, 2012 03:44 PM UTC</time> by <b>Soichi Hayashi</b><a class="anchor" name="1336578267">&nbsp;</a></div><pre>Saul,

Can you tell me what your LCG_GFAL_INFOSYS / LFC_HOST environment parameters is set to when you make lcg-info call?

Thank you,
Soichi</pre></div><div class='update_description'><i onclick="document.location='12104#1336577990'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-05-09T15:39:50+00:00">May 9, 2012 03:39 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1336577990">&nbsp;</a></div><pre>[by Saul Youssef]

Hi,

PanDA gets its information about what software releases are at our sites via lcg-info which is fed from the CERN BDII which is fed from the OSG BDII.  Yesterday, jobs stopped running at our Harvard PanDA site.  This was traced to PanDA suddenly thinking that Harvard has no ATLAS software releases.  To see the problem&#58;

lcg-info --vo atlas --list-ce --sed --attr Tag | grep atlas.bu.edu

lists the releases at our BU site.  The same command

lcg-info --vo atlas --list-ce --sed --attr Tag | grep heroatlas

querying the LCG BDII returns nothing, however.  We can&#39;t tell if something is wrong in your export to LCG BDII or something is wrong at the LCG BDII end.  Could you get together with those guys and track down the problem?

Thanks,

Saul Youssef
John Brunelle
NET2</pre></div><legend>Similar Recent Tickets <small>modified within the last 30 days</small></legend><div id="similar_tickets"><p class="muted">No similar tickets found.</p></div>
</div>
<script type="text/javascript">
function reset_anchor() {
    $("#updates .selected").removeClass("selected");
    var urls = document.location.toString().split('#'); 
    var anchor = urls[1];
    if(anchor) {
        $("a[name='"+anchor+"']").parents(".update_description").addClass("selected");
    }
}
function submitspam(ticket_id) {
    myret = confirm("Would you like to close this ticket as a security ticket, and submit the ticket content to akismet?");
    if(myret == true) {
        $.ajax("viewer/processspam?id="+ticket_id).done(function() {
            window.location.reload();
        });
    }
}

$(function() {
    reset_anchor();
    var ADDITIONAL_COOKIE_NAME = 'gocticket';
    var options = { path: '/', expires: 365};

    if(window.opener && window.opener.name == "gocticket_list") {
        v = $.cookie("closewindow");
        if(!v) {
            $("#closewindow").attr("checked", "checked"); //on by default
        } else {
            if(v == "checked") {
                $("#closewindow").attr("checked", "checked");
            }
        }
        $("#closewindow").click(function() {
            $.cookie("closewindow", $(this).attr('checked'), options);
        });
    } else {
        $("#closewindow_area").hide();
    }
    function updateTimeago() {
        $("time").timeago();
        setTimeout(updateTimeago, 30*1000);
    }
    updateTimeago();
    $(".description").focus(expand_description);
});
</script>
<hr/>
<footer>
<p>GOC Ticket Version 2.2 | <a href="https://ticket.opensciencegrid.org/goc/submit?app_issue_check=on&amp;app_issue_type=goc&amp;app_goc_url=https%3A%2F%2Fticket.opensciencegrid.org%3A443%2F12104">Report Bugs</a>
 | <a href="https://github.com/opensciencegrid/operations/blob/master/docs/privacy.md">Privacy Policy</a>
</p>

<p> <img align="top" src="images/tag_orange.png"/> Copyright 2018 The Trustees of Indiana University - Developed for Open Science Grid</p>
</footer>


</div><!--container-fluid-->
<script src="https://ticket1.grid.iu.edu:8443/socket.io/socket.io.js"></script>
<script>
var chat = io.connect('https://ticket1.grid.iu.edu:8443');
chat.on('connect', function() {
    chat.emit('authenticate', {nodekey:'', ticketid: 12104});
});
chat.on('peers', function(peers) {
    $("#peers").html("");
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('peer_disconnect', function(pid) {
    $("#peer_"+pid).hide("slow");
});
chat.on('peer_connected', function(peers) {
    //expect only 1 peer connecting, but..
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('submit', function() {
    if(confirm("This ticket was updated. Do you want to refresh?")) {
        history.go(0);
    }
});

function addPeer(pid, peer) {
    var ipinfo = "";
    if(peer.ip != undefined) {
        ipinfo = "<span class=\"ip\">"+peer.ip+"</span>";
    }
    if(chat.io.engine.id == pid) {
        //don't display myself
        return;
    }
    var html = "<li class=\"new\" id=\"peer_"+pid+"\" class=\"peer\">"+peer.name+ipinfo+"</li>";
    $("#peers").prepend(html);
    $("#peers .new").animate({bottom: 0}, 1000, function() {$(this).removeClass("new")});
}

$(function() {
    $("#ticket_form").submit(function() {
        chat.emit('submit');
        return true;
    });
});
</script>
<script>
//used by searchbox
function parseValue(value) {
    var obj = new Object();
    var tokens = value.split("\t");
    obj.str = tokens[0];
    obj.count = tokens[1];
    return obj;
}

$(function() {
    //bootstrap-2.0.4 stuff
    $(".alert-message").alert();
    $(".dropdown-toggle").dropdown();
    $("span[rel='tooltip']").tooltip();
    $("a[rel=popover]").popover();

    //activate menu that user is currently on
    $("#menu_navigator").addClass("active"); 
    $("#submenu_").addClass("active"); 

    //translate zend validation error message to bootstrap
    $(".errors").addClass("alert").addClass("alert-error");

    //enable autocomplete for search box
    $("#search").autocomplete({
        source: function( request, response ) {
            $.ajax({
                url: "search/autocomplete",
                dataType: "text",
                data: {
                    //featureClass: "P",
                    //style: "full",
                    //maxRows: 12,
                    //name_startsWith: request.term
                    q: request.term
                },
                success: function( data ) {
                    response( $.map( data.split("\n"), function( item ) {
                        if(item == "") return null;
                        return {
                            value: item
                        }
                    }));
                }
            });
        },
        select: function(event, ui) {
            document.location = "search?q="+ui.item.value;
        }
    });
    
});
</script>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-69012-13");
pageTracker._trackPageview();
} catch(err) {}
</script>

</body>
