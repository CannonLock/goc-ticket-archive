<!DOCTYPE html>
<html lang="en">
  <head>
  <base href="">
    <title>[19806] lcg-cp fails with BDII error</title>    <meta charset="utf-8" />
    <meta name="verify-v1" content="na5IcAJsZVOfEkboRxuIiZ1zpZgnZiWra+nKcS7nA/o=" />
    <meta name="google-site-verification" content="DLrk3ft4s8b-S2TloLCL2LD_t6wcTjgSluf5pmiu2kA" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />

    <style type="text/css">
      body {
        padding-top: 50px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
     #search {
            width: 300px;
     }

    </style>

<script src="https://code.jquery.com/jquery-3.0.0.js"></script>
<script src="https://code.jquery.com/jquery-migrate-3.0.1.js"></script>

   <link href="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet"/>
    <script src="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/js/bootstrap.min.js"></script>

    <link href="https://netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"/>
    <link href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/themes/smoothness/jquery-ui.min.css" rel="stylesheet"/>
 <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>


    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/js/select2.min.js"></script>

    <link href="css/ticket.css" rel="stylesheet" />
    <script src="lib/jquery.cookie.js"></script>

    <link href="images/tag_orange.png" rel="icon" type="image/png"/>
  </head>

  <body>
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>

            <a class="brand" style="padding: 6px 0px 0px 6px;" href="http://opensciencegrid.org"><img src="images/osglogo.40x30.png"/></a>
            <ul class="nav">
                <li class="dropdown"><a href="https://ticket.opensciencegrid.org/#" class="dropdown-toggle" data-toggle="dropdown">GOC Ticket <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    <li><a href="https://my.opensciencegrid.org">MyOSG</a></li>
                    <li><a href="https://oim.opensciencegrid.org">OIM</a></li>
                    <li class="active"><a href="https://ticket.opensciencegrid.org/index">Ticket</a></li>
	<li class="divider"></li>
	<li><a href="http://repo.grid.iu.edu">Repo</a></li>
	<li class="divider"></li>
	<li><a href="http://blogs.grid.iu.edu">Blog</a></li>
                    <li><a href="http://display.grid.iu.edu">Display</a></li>
                    <li><a href="http://osggoc.blogspot.com/">News</a></li>
                    </ul>
                </li>
            </ul>
            <ul class="nav pull-right">
                <li><a href="https://ticket.opensciencegrid.org/sso/">Login</a></li>            </ul>

            <div class="nav-collapse">
                <ul class="nav">
			 <li id="menu_submit"><a href="https://ticket.opensciencegrid.org/submit">Submit</a></li><li id="menu_view" class="dropdown"><a href="https://ticket.opensciencegrid.org/\#" class="dropdown-toggle" data-toggle="dropdown">View <b class="caret"></b></a><ul class="dropdown-menu"><li id="submenu_listopen"><a href="https://ticket.opensciencegrid.org/list/open">Open Tickets</a></li><li id="submenu_listrecentclose"><a href="https://ticket.opensciencegrid.org/list/recentclose">Recently Closed Tickets</a></li><li class="divider"></li><li id="submenu_alltickets"><a href="https://ticket.opensciencegrid.org/search?q=&amp;sort=id">All Tickets</a></li></ul></li>                </ul>

                <form class="navbar-search pull-right" action="https://ticket.opensciencegrid.org/viewer">
                    <input id="search" type="text" name="id" class="search-query span2" placeholder="Search Ticket" value=""/>
                </form>
            </div>
        </div>
      </div>
    </div>

<script type='text/javascript' src='lib/jquery.timeago.js'></script>
<script type='text/javascript' src='lib/byte2size.js'></script>
<style>
#updates .toolbar {
position: relative;
margin-top: 0px;
top: -10px;
font-weight: normal;
}
#updates a.anchor {
position: relative;
top: -50px;
}
#updates .selected pre {
animation:selected 2s;
animation-iteration-count: 2;
animation-direction: alternate;
-webkit-animation:selected 2s; 
-webkit-animation-iteration-count: 2;
-webkit-animation-direction: alternate;
box-shadow: inset 1px 1px 20px #9ad;
border: 1px solid #9ab;
margin: 5px 0px;
padding-left: 10px;
}
@keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ab;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
@-webkit-keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ad;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
#updates pre {
background-color: inherit;
line-height: 15px;
padding: 5px;
}
#updates .header {
color: #999;
}
#updates .update_history pre {
background-color: #eee;
color: #666;
font-size: 85%;
}
#updates .clickable {
cursor: pointer;
}
#updates .clickable:hover {
color: #D98719;
}
#updates .meta_information pre {
background-color: #fed;
}
#similar_tickets {
max-height: 300px;
overflow-y: auto;
pointer-events: none;
padding: 5px;
background-color: #f4f4f4;
}
.btn-toolbar {
margin-bottom: 0;
height: 30px;
}
#peers {
position: fixed;
bottom: 0px;
right: 0px;
z-index: 100;
list-style: none;
padding: 5px 0px 0px 5px;
margin: 0px;
background-color: white;
box-shadow: 0px 0px 10px white;
}
#peers li {
background-color: #ccc;
color: #000;
display: inline-block;
padding: 5px 10px;
margin-right: 5px;
position: relative;
}
/*
#peers li:hover {
background-color: #999;
cursor: pointer;
}
*/
#peers span.ip {
padding-left: 5px;
color: #666;
}
#peers .new {
bottom: -30px;
}
/*
#peers .me {
background-color: red;
}
*/
</style>

<div class="container-fluid">
<ul id="peers"></ul>
<div class="alert alert-danger"><a class="close" href="https://ticket.opensciencegrid.org/#" data-dismiss="alert">&times;</a>By the end of May 2018, the ticketing system at https://ticket.opensciencegrid.org will be retired and support will be provided at https://support.opensciencegrid.org. Throughout this transition the support email (help@opensciencegrid.org) will be available as a point of contact.<br><br>                                                   
                                                                                                                                                                                   
Please see the service migration page for details: https://opensciencegrid.github.io/technology/policy/service-migrations-spring-2018/#ticket</div><div id="presence" class="pull-right"></div><div class="ticketgui"><script type="text/javascript" src="lib/checktab.js"></script>

<script>
var expanded = false;
function expand_description() {
    var desc = $(".description");
    if(!expanded) {
        expanded = true;
        //expand to minheight
        var min = 250;
        if(desc.height() < min) {
            desc.animate({height: min}, 200);
        }
    }
}

$(document).ready(function() {
    $("input[name='nad']").datepicker({
        dateFormat: 'yy-mm-dd'
    });
});

</script>



<style>
.form-horizontal .control-label {
padding-top: inherit;
font-size:90%;
color:#666;
}
label {
margin-bottom: 0px;
}
.controls {
line-height: 18px;
}
</style>
<form class="form-horizontal" action="https://ticket.opensciencegrid.org/viewer/updatebasic?id=19806" method="post">
<div class="page-header">
    <h3><span class="muted">19806</span> / lcg-cp fails with BDII error</h3>
</div>

<div class="row-fluid">
<div class="span5">
    <legend>Contact</legend>
    <div class="control-group">
        <label class="control-label">Full Name</label>
        <div class="controls">Jochen Ott</div>
    </div>
    <div class="control-group">
        <label class="control-label">Email</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">Phone</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">CC</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>

    <legend>Details</legend>
    <div class="control-group"><label class="control-label">Associated VO</label><div class="controls">CMS</div></div><div class="control-group"><label class="control-label">Submitted Via</label><div class="controls">GGUS</div></div><div class="control-group"><label class="control-label">Submitter</label><div class="controls">Jochen Ott</div></div><div class="control-group"><label class="control-label">Support Center</label><div class="controls">USCMS_Tier2</div></div>
    <div class="control-group">
        <label class="control-label">Ticket Type</label>
        <div class="controls">Problem/Request</div>
    </div>
    <div class="control-group">
        <label class="control-label">Priority</label>
        <div class="controls">Normal</div>
    </div>
    <div class="control-group">
        <label class="control-label">Status</label>
        <div class="controls">
Closed</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action</label>
        <div class="controls">TX Incoming</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action Deadline</label>
        <div class="controls flag_red">2014-03-11</div>
    </div>

</div><!--span-->
<div class="span7">
    <legend>Assignees</legend>
    <div class="assignee" style="width: 60%">USCMS Tier 2 <span class="muted"> / OSG Support Centers</span></div><div class="assignee" style="width: 60%">GGUS (Prod)&nbsp;<a target="_blank" href="https://ggus.eu/ws/ticket_info.php?ticket=101666">101666</a> <span class="muted"> / Ticket Exchange</span></div>    <br>

    <legend>Assignees</legend>
    TODO
    <br>

    <style>
legend.noborder {
border-bottom: none;
}
</style>

<div id="attachment-list"/>
<script>
$(function () {
    var first = true;
    $.getJSON("attachment/list/19806", function (files) {
        //console.dir(files);
        var html = "<table class=\"table table-condensed\">";
        $(files).each(function() {
            if(first) {
                first = false;
                html += "<legend class=\"noborder\">Attachmenets</legend>";
            }
            html += "<tr class=\"attachment\">";
            html += "<td><img src=\""+this.thumbnail_url+"\"/></td>";
            html += "<td><a href=\""+this.url+"\" target=\"_blank\">"+this.name+"</a></td>";
            html += "<td>"+bytesToSize(this.size, 1)+"</td>";
            html += "</tr>";
        });
        html += "</table>";
        $("#attachment-list").html(html);
    });
});

function download(url) {
    window.open(url, "_blank");
}
</script>


</div><!--span-->
</div><!--row-fluid-->


</form>

</div>
<div id="updates" style="clear: both;">
    <legend>Past Updates
    <div class="btn-toolbar pull-right toolbar">
    </div><!--btn-toolbar-->
    </legend>

    <div class='update_description'><i onclick="document.location='19806#1395878390'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-03-26T23:59:50+00:00">Mar 26, 2014 11:59 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1395878390">&nbsp;</a></div><pre>This ticket was closed automatically. If this issue has not been resolved according your expectations or if you need further information, please submit a new ticket referencing this one.

-- by SYSTEM at Wed Mar 26 23&#58;59&#58;04 UTC 2014

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=101666' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=101666</a></pre></div><div class='update_description'><i onclick="document.location='19806#1394635382'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-03-12T14:43:02+00:00">Mar 12, 2014 02:43 PM UTC</time> by <b>Christopher Pipes</b><a class="anchor" name="1394635382">&nbsp;</a></div><pre>Jochen,

I will close this. Let us know when you need further assistance.

Thanks,
Chris</pre></div><div class='update_description'><i onclick="document.location='19806#1394570637'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-03-11T20:43:57+00:00">Mar 11, 2014 08:43 PM UTC</time><a class="anchor" name="1394570637">&nbsp;</a></div><pre>I can&#39;t close this ticket, at least don&#39;t know how... If someone can, please close this ticket...

In any case, I should point out that, lcg-cp with BDII check is not &#34;officially&#34; supported at any of the osg sites...

-Tapas

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=tapas/CN=665744/CN=Tapas Sarangi</pre></div><div class='update_description'><i onclick="document.location='19806#1394472016'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-03-10T17:20:16+00:00">Mar 10, 2014 05:20 PM UTC</time><a class="anchor" name="1394472016">&nbsp;</a></div><pre>Hi Jochen,

Not sure I understand what you meant by, write test scripts ? I thought you are using a more standard tool for your job submission which was failing earlier, so all you need is to test whatever was failing earlier and see if it works...

-Tapas

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=tapas/CN=665744/CN=Tapas Sarangi</pre></div><div class='update_description'><i onclick="document.location='19806#1394471178'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-03-10T17:06:18+00:00">Mar 10, 2014 05:06 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1394471178">&nbsp;</a></div><pre>Hi Chris,

no&#58; This would mean that I have to write test scripts and submit test jobs with tools I&#39;m not familiar with. This would take (me) hours.

I&#39;ll simply re-open this ticket or create a new one if I observe this behavior.

Regards,

Jochen

-- by Jochen Ott at Mon Mar 10 17&#58;05&#58;21 UTC 2014

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=101666' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=101666</a></pre></div><div class='update_description'><i onclick="document.location='19806#1394469206'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-03-10T16:33:26+00:00">Mar 10, 2014 04:33 PM UTC</time> by <b>Christopher Pipes</b><a class="anchor" name="1394469206">&nbsp;</a></div><pre>Hi Jochen ,

Can you confirm this issue is resolved?

Thanks,
Chris</pre></div><div class='update_description'><i onclick="document.location='19806#1394466852'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-03-10T15:54:12+00:00">Mar 10, 2014 03:54 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1394466852">&nbsp;</a></div><pre>Hi Tapas,

yes, I think you can close the ticket.

Thanks for your help, regards,

Jochen

-- by Jochen Ott at Mon Mar 10 15&#58;53&#58;26 UTC 2014

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=101666' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=101666</a></pre></div><div class='update_description'><i onclick="document.location='19806#1394466321'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-03-10T15:45:21+00:00">Mar 10, 2014 03:45 PM UTC</time><a class="anchor" name="1394466321">&nbsp;</a></div><pre>This ticket is resolved. can we close this ?

-Tapas

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=tapas/CN=665744/CN=Tapas Sarangi</pre></div><div class='update_description'><i onclick="document.location='19806#1394052194'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-03-05T20:43:14+00:00">Mar 5, 2014 08:43 PM UTC</time><a class="anchor" name="1394052194">&nbsp;</a></div><pre>Hi,

lcg-cp should now work with BDII check.

-Tapas

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=tapas/CN=665744/CN=Tapas Sarangi</pre></div><div class='update_description'><i onclick="document.location='19806#1393952645'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-03-04T17:04:05+00:00">Mar 4, 2014 05:04 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1393952645">&nbsp;</a></div><pre>Dear Tapas,

thanks for your message.

I use grid-control (see [1]), a job submission tool that&#39;s been there for many years and could also be considered quite &#34;standard&#34;, as quite some people are using it in CMS and outside.

As I mentioned, for most sites it works just fine &#34;out-of-the-box&#34;.

While in principle, it would be possible to change the code in grid-control, that&#39;s not where such settings belong&#58; Those settings should be considered as part of the tool installation and thus should be done on the site; anything else would be maintenance nightmare.

If you export the BDII environment variable to a value that makes lcg-cp work, it can only improve things&#58;
* lcg-cp will work out of the box, so my scripts will work
* users setting their own LCG_GFAL_INFOSYS continue to work like before.

So I don&#39;t think there is something that one could break by making lcg-cp work out of the box.

Regards,

Jochen

[1] see here&#58;
<a href='https&#58;//ekptrac.physik.uni-karlsruhe.de/trac/grid-control/wiki' target='_blank' rel='nofollow'>https&#58;//ekptrac.physik.uni-karlsruhe.de/trac/grid-control/wiki</a>
The code that is executed on the grid node for copying files is here&#58;
<a href='https&#58;//ekptrac.physik.uni-karlsruhe.de/trac/grid-control/browser/tags/stable/grid-control/packages/grid_control/share/gc-run.lib#L459' target='_blank' rel='nofollow'>https&#58;//ekptrac.physik.uni-karlsruhe.de/trac/grid-control/browser/tags/stable/grid-control/packages/grid_control/share/gc-run.lib#L459</a>
where it should be mentioned that no environment is set up for that; the script assumes (and mostly it&#39;s right) that the commands &#34;just work&#34;.

-- by Jochen Ott at Tue Mar 04 17&#58;03&#58;03 UTC 2014

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=101666' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=101666</a></pre></div><div class='update_description'><i onclick="document.location='19806#1393950221'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-03-04T16:23:41+00:00">Mar 4, 2014 04:23 PM UTC</time><a class="anchor" name="1393950221">&nbsp;</a></div><pre>Hi Jochen,

I haven&#39;t understood completely what is STANDARD and that&#39;s why there is a delay in solving your issue ! For our site, crab jobs, phedex transfers which I consider as standard works just fine. Are you using your own custom script for this ? If yes, I have to understand that the changes I will make for the site that may work for you should work for every other user who may have this problem in future.

-Tapas

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=tapas/CN=665744/CN=Tapas Sarangi</pre></div><div class='update_description'><i onclick="document.location='19806#1393918565'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-03-04T07:36:05+00:00">Mar 4, 2014 07:36 AM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1393918565">&nbsp;</a></div><pre>Hi Tapas,

my job expects that the standard environment found on the worker node has a working lcg-cp. This works for almost all sites without any problems.

If I now start changing the scripts, it might fail on another site because they have their own bdii setting which should not be overridden.

Therefore, I would have to create site-dependent environment variable setting.

This is obviously NOT what the grid is for.

I still think it is reasonable to expect the lcg-cp command working out of the box; it would be VERY band practice for users to start setting environment as this prevents site admins doing the right thing for the jobs.

So please do this setting.

Regards,

Jochen

-- by Jochen Ott at Tue Mar 04 07&#58;35&#58;03 UTC 2014

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=101666' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=101666</a></pre></div><div class='update_description'><i onclick="document.location='19806#1393885146'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-03-03T22:19:06+00:00">Mar 3, 2014 10:19 PM UTC</time><a class="anchor" name="1393885146">&nbsp;</a></div><pre>Hi Jochen,

After some discussion with other OSG sites, it seems that worker nodes on our site are not missing any standard configuration otherwise our site must have seen failure of crab jobs or phedex transfers.

But, there is one environment variable the user must set before invoking a lcg-cp without the --no-bdii option. This variable is set by various scripts in crab jobs or phedex agent.

export LCG_GFAL_INFOSYS=lcg-bdii.cern.ch&#58;2170

-Tapas

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=tapas/CN=665744/CN=Tapas Sarangi</pre></div><div class='update_description'><i onclick="document.location='19806#1393572716'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-02-28T07:31:56+00:00">Feb 28, 2014 07:31 AM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1393572716">&nbsp;</a></div><pre>Hi Tapas,

good&#58; your test shows that there is clearly comething wrong with the software setup on the node.

Any projections on when this is fixed?

Thanks, regards,

Jochen

-- by Jochen Ott at Fri Feb 28 07&#58;31&#58;43 UTC 2014

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=101666' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=101666</a></pre></div><div class='update_description'><i onclick="document.location='19806#1393523610'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-02-27T17:53:30+00:00">Feb 27, 2014 05:53 PM UTC</time><a class="anchor" name="1393523610">&nbsp;</a></div><pre>Hi Jochen,

To give you some more hint, we tried lcg-cp adding &#34;/srm/managerv2?SFN=&#34; to the URL and the copy succeeds.  We also found that without this addition /srm/managerv2 lcg-cp fails to read from FNAL as well.

-Tapas

lcg-cp -vbD srmv2 <a href='srm&#58;//dcache-se-cms.desy.de&#58;8443/srm/managerv2?SFN=pnfs/desy.de/cms/tier2/store/user/jott/zplusjets/dmu_v2//GCe7a97f8eb786.tar.gz' target='_blank' rel='nofollow'>srm&#58;//dcache-se-cms.desy.de&#58;8443/srm/managerv2?SFN=pnfs/desy.de/cms/tier2/store/user/jott/zplusjets/dmu_v2//GCe7a97f8eb786.tar.gz</a> file&#58;///tmp/t1
Using grid catalog type&#58; UNKNOWN
Using grid catalog &#58; (null)
VO name&#58; cms
Checksum type&#58; None
Trying SURL <a href='srm&#58;//dcache-se-cms.desy.de&#58;8443/srm/managerv2?SFN=pnfs/desy.de/cms/tier2/store/user/jott/zplusjets/dmu_v2//GCe7a97f8eb786.tar.gz' target='_blank' rel='nofollow'>srm&#58;//dcache-se-cms.desy.de&#58;8443/srm/managerv2?SFN=pnfs/desy.de/cms/tier2/store/user/jott/zplusjets/dmu_v2//GCe7a97f8eb786.tar.gz</a> ...
Source SE type&#58; SRMv2
Source SRM Request Token&#58; -2015677845
Source URL&#58; <a href='srm&#58;//dcache-se-cms.desy.de&#58;8443/srm/managerv2?SFN=pnfs/desy.de/cms/tier2/store/user/jott/zplusjets/dmu_v2//GCe7a97f8eb786.tar.gz' target='_blank' rel='nofollow'>srm&#58;//dcache-se-cms.desy.de&#58;8443/srm/managerv2?SFN=pnfs/desy.de/cms/tier2/store/user/jott/zplusjets/dmu_v2//GCe7a97f8eb786.tar.gz</a>
File size&#58; 25033138
Source URL for copy&#58; <a href='gsiftp&#58;//dcache-door-cms19.desy.de&#58;2811/pnfs/desy.de/cms/tier2/store/user/jott/zplusjets/dmu_v2/GCe7a97f8eb786.tar.gz' target='_blank' rel='nofollow'>gsiftp&#58;//dcache-door-cms19.desy.de&#58;2811/pnfs/desy.de/cms/tier2/store/user/jott/zplusjets/dmu_v2/GCe7a97f8eb786.tar.gz</a>
Destination URL&#58; file&#58;/tmp/t1
# streams&#58; 1
11534336 bytes   1407.98 KB/sec avg   4608.00 KB/sec inst
Transfer took 10290 ms

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=tapas/CN=665744/CN=Tapas Sarangi</pre></div><div class='update_description'><i onclick="document.location='19806#1393518844'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-02-27T16:34:04+00:00">Feb 27, 2014 04:34 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1393518844">&nbsp;</a></div><pre>Hi Tapas,

it&#39;s not completely clear where exactly the problem is, but it&#39;s more likely to be on the side of the WN and its environment rather than DESY. While I do not have a complete understanding of what goes on &#34;behind the scenes&#34;, it has to be something like this&#58;
The lcg-cp command sees the srm URL from the command line and has to translate it to a transport URL. For that, it asks the BDII service. This is where it fails. Which BDII is asked depends on the settings of the middleware installation of the WN, so the first thing to find ouy is which BDII is used and whether this BDII is working correctly. All of that is WN specific.
Your test shows that the BDII resolved the URLs for fnal correctly, but it seems it fails for the DESY one.

Note that if I execute the command of my original report here (at DESY) it completes successfully. The same is true for many other of my jobs which run somewhere on the grid right now, e.g. at florida&#58; they seem to work fine as well.

So please check the BDII.

Regards,

Jochen

-- by Jochen Ott at Thu Feb 27 16&#58;33&#58;10 UTC 2014

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=101666' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=101666</a></pre></div><div class='update_description'><i onclick="document.location='19806#1393518238'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-02-27T16:23:58+00:00">Feb 27, 2014 04:23 PM UTC</time><a class="anchor" name="1393518238">&nbsp;</a></div><pre>Hi,

The user is trying to read a file from desy and failing, so I don&#39;t understand how something on the WN (g22n12.hep.wisc.edu) can be wrong ?

lcg-cp from other sites (e.g. FNAL) works fine for us (see below).
It seems to me a problem of the SE on <a href='srm&#58;//dcache-se-cms.desy.de&#58;8443' target='_blank' rel='nofollow'>srm&#58;//dcache-se-cms.desy.de&#58;8443</a> rather than at g22n12.hep.wisc.edu .

$ lcg-cp -vbD srmv2 <a href='srm&#58;//cmssrm.fnal.gov&#58;8443/srm/managerv2?SFN=/11/store/mc/Fall13dr/QCD_Pt-50to80_Tune4C_13TeV_pythia8/GEN-SIM-RAW/castor_tsg_PU40bx25_POSTLS162_V2-v1/20000/52D55EB5-A980-E311-AB18-485B39800BBF.root' target='_blank' rel='nofollow'>srm&#58;//cmssrm.fnal.gov&#58;8443/srm/managerv2?SFN=/11/store/mc/Fall13dr/QCD_Pt-50to80_Tune4C_13TeV_pythia8/GEN-SIM-RAW/castor_tsg_PU40bx25_POSTLS162_V2-v1/20000/52D55EB5-A980-E311-AB18-485B39800BBF.root</a> file&#58;///tmp/tt
Using grid catalog type&#58; UNKNOWN
Using grid catalog &#58; (null)
VO name&#58; cms
Checksum type&#58; None
Trying SURL <a href='srm&#58;//cmssrm.fnal.gov&#58;8443/srm/managerv2?SFN=/11/store/mc/Fall13dr/QCD_Pt-50to80_Tune4C_13TeV_pythia8/GEN-SIM-RAW/castor_tsg_PU40bx25_POSTLS162_V2-v1/20000/52D55EB5-A980-E311-AB18-485B39800BBF.root' target='_blank' rel='nofollow'>srm&#58;//cmssrm.fnal.gov&#58;8443/srm/managerv2?SFN=/11/store/mc/Fall13dr/QCD_Pt-50to80_Tune4C_13TeV_pythia8/GEN-SIM-RAW/castor_tsg_PU40bx25_POSTLS162_V2-v1/20000/52D55EB5-A980-E311-AB18-485B39800BBF.root</a> ...
Source SE type&#58; SRMv2
Source SRM Request Token&#58; -1828646003
Source URL&#58; <a href='srm&#58;//cmssrm.fnal.gov&#58;8443/srm/managerv2?SFN=/11/store/mc/Fall13dr/QCD_Pt-50to80_Tune4C_13TeV_pythia8/GEN-SIM-RAW/castor_tsg_PU40bx25_POSTLS162_V2-v1/20000/52D55EB5-A980-E311-AB18-485B39800BBF.root' target='_blank' rel='nofollow'>srm&#58;//cmssrm.fnal.gov&#58;8443/srm/managerv2?SFN=/11/store/mc/Fall13dr/QCD_Pt-50to80_Tune4C_13TeV_pythia8/GEN-SIM-RAW/castor_tsg_PU40bx25_POSTLS162_V2-v1/20000/52D55EB5-A980-E311-AB18-485B39800BBF.root</a>
File size&#58; 3313432979
Source URL for copy&#58; <a href='gsiftp&#58;//cmsstor221.fnal.gov&#58;2811//WAX/11/store/mc/Fall13dr/QCD_Pt-50to80_Tune4C_13TeV_pythia8/GEN-SIM-RAW/castor_tsg_PU40bx25_POSTLS162_V2-v1/20000/52D55EB5-A980-E311-AB18-485B39800BBF.root' target='_blank' rel='nofollow'>gsiftp&#58;//cmsstor221.fnal.gov&#58;2811//WAX/11/store/mc/Fall13dr/QCD_Pt-50to80_Tune4C_13TeV_pythia8/GEN-SIM-RAW/castor_tsg_PU40bx25_POSTLS162_V2-v1/20000/52D55EB5-A980-E311-AB18-485B39800BBF.root</a>
Destination URL&#58; file&#58;/tmp/tt
# streams&#58; 1
217055232 bytes   6623.99 KB/sec avg   8192.00 KB/sec instCopy Cancelled...

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=tapas/CN=665744/CN=Tapas Sarangi</pre></div><div class='update_description'><i onclick="document.location='19806#1393494922'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-02-27T09:55:22+00:00">Feb 27, 2014 09:55 AM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1393494922">&nbsp;</a></div><pre>Dear admins,

My job ran on the CE&#58;
cmsgrid02.hep.wisc.edu&#58;2119/jobmanager-condor-group_cmsprod
on host g22n12.hep.wisc.edu.

One of the first thing it does is to copy files from a SE to the worker node; the exact command was&#58;
lcg-cp -v -n 1 <a href='srm&#58;//dcache-se-cms.desy.de&#58;8443/pnfs/desy.de/cms/tier2/store/user/jott/zplusjets/dmu_v2//GCe7a97f8eb786.tar.gz' target='_blank' rel='nofollow'>srm&#58;//dcache-se-cms.desy.de&#58;8443/pnfs/desy.de/cms/tier2/store/user/jott/zplusjets/dmu_v2//GCe7a97f8eb786.tar.gz</a> file&#58;////var/condor/execute/dir_13708/https_3a_2f_2fwms310.cern.ch_3a9000_2fRAZvkUv7t
TSJUaJZ5zgb3A/17790/GCe7a97f8eb786.tar.gz

This fails with an error message&#58;
Using grid catalog type&#58; UNKNOWN
Using grid catalog &#58; (null)
VO name&#58; cms
Checksum type&#58; None
Trying SURL <a href='srm&#58;//dcache-se-cms.desy.de&#58;8443/pnfs/desy.de/cms/tier2/store/user/jott/zplusjets/dmu_v2//GCe7a97f8eb786.tar.gz' target='_blank' rel='nofollow'>srm&#58;//dcache-se-cms.desy.de&#58;8443/pnfs/desy.de/cms/tier2/store/user/jott/zplusjets/dmu_v2//GCe7a97f8eb786.tar.gz</a> ...
[GFA, NULLL][bdii_query_send][EINVAL] Invalid BDII parameters

lcg_cp&#58; Invalid argument

[Ticket Origin]
<a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=101666' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=101666</a>

[Ticket History]
Subject&#58; lcg-cp fails with BDII error
Ticket Type&#58; USER
CC&#58;
-- by Jochen Ott at Thu Feb 27 09&#58;32&#58;03 UTC 2014

-- by sara bertocco at Thu Feb 27 09&#58;34&#58;01 UTC 2014

-- by Alessandro Paolini at Thu Feb 27 09&#58;49&#58;29 UTC 2014

Hi,
I can write successfully on the SE dcache-se-cms.desy.de, so the problem could be in the WN environment (g22n12.hep.wisc.edu).
<div id='show_194572527' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_194572527'>I&#39;m reassigning the ticket to the resource centre, so the adminc can check what is going wrong.

cheers,
Alessandro

-- by Alessandro Paolini at Thu Feb 27 09&#58;54&#58;55 UTC 2014
</div><script type='text/javascript'>
        $('#show_194572527').click(function() {
            $('#detail_194572527').slideDown("normal");
            $('#show_194572527').hide();
            $('#hide_194572527').show();
        });
        $('#hide_194572527').click(function() {
            $('#detail_194572527').slideUp();
            $('#hide_194572527').hide();
            $('#show_194572527').show();
        });
        </script></pre></div>
</div>
<script type="text/javascript">
function reset_anchor() {
    $("#updates .selected").removeClass("selected");
    var urls = document.location.toString().split('#'); 
    var anchor = urls[1];
    if(anchor) {
        $("a[name='"+anchor+"']").parents(".update_description").addClass("selected");
    }
}
function submitspam(ticket_id) {
    myret = confirm("Would you like to close this ticket as a security ticket, and submit the ticket content to akismet?");
    if(myret == true) {
        $.ajax("viewer/processspam?id="+ticket_id).done(function() {
            window.location.reload();
        });
    }
}

$(function() {
    reset_anchor();
    var ADDITIONAL_COOKIE_NAME = 'gocticket';
    var options = { path: '/', expires: 365};

    if(window.opener && window.opener.name == "gocticket_list") {
        v = $.cookie("closewindow");
        if(!v) {
            $("#closewindow").attr("checked", "checked"); //on by default
        } else {
            if(v == "checked") {
                $("#closewindow").attr("checked", "checked");
            }
        }
        $("#closewindow").click(function() {
            $.cookie("closewindow", $(this).attr('checked'), options);
        });
    } else {
        $("#closewindow_area").hide();
    }
    function updateTimeago() {
        $("time").timeago();
        setTimeout(updateTimeago, 30*1000);
    }
    updateTimeago();
    $(".description").focus(expand_description);
});
</script>
<hr/>
<footer>
<p>GOC Ticket Version 2.2 | <a href="https://ticket.opensciencegrid.org/goc/submit?app_issue_check=on&amp;app_issue_type=goc&amp;app_goc_url=https%3A%2F%2Fticket.opensciencegrid.org%3A443%2F19806">Report Bugs</a>
 | <a href="https://github.com/opensciencegrid/operations/blob/master/docs/privacy.md">Privacy Policy</a>
</p>

<p> <img align="top" src="images/tag_orange.png"/> Copyright 2018 The Trustees of Indiana University - Developed for Open Science Grid</p>
</footer>


</div><!--container-fluid-->
<script>
//used by searchbox
function parseValue(value) {
    var obj = new Object();
    var tokens = value.split("\t");
    obj.str = tokens[0];
    obj.count = tokens[1];
    return obj;
}

$(function() {
    //bootstrap-2.0.4 stuff
    $(".alert-message").alert();
    $(".dropdown-toggle").dropdown();
    $("span[rel='tooltip']").tooltip();
    $("a[rel=popover]").popover();

    //activate menu that user is currently on
    $("#menu_navigator").addClass("active"); 
    $("#submenu_").addClass("active"); 

    //translate zend validation error message to bootstrap
    $(".errors").addClass("alert").addClass("alert-error");

    //enable autocomplete for search box
    $("#search").autocomplete({
        source: function( request, response ) {
            $.ajax({
                url: "search/autocomplete",
                dataType: "text",
                data: {
                    //featureClass: "P",
                    //style: "full",
                    //maxRows: 12,
                    //name_startsWith: request.term
                    q: request.term
                },
                success: function( data ) {
                    response( $.map( data.split("\n"), function( item ) {
                        if(item == "") return null;
                        return {
                            value: item
                        }
                    }));
                }
            });
        },
        select: function(event, ui) {
            document.location = "search?q="+ui.item.value;
        }
    });
    
});
</script>


</body>
