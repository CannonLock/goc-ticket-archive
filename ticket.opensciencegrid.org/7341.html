<!DOCTYPE html>
<html lang="en">
  <head>
  <base href="">
    <title>[7341] security notification form failure</title>    <meta charset="utf-8" />
    <meta name="verify-v1" content="na5IcAJsZVOfEkboRxuIiZ1zpZgnZiWra+nKcS7nA/o=" />
    <meta name="google-site-verification" content="DLrk3ft4s8b-S2TloLCL2LD_t6wcTjgSluf5pmiu2kA" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />
    <link href="https://ticket.opensciencegrid.org/rss" rel="alternate" type="application/rss+xml" title="GOC Ticket Update feed" />

    <style type="text/css">
      body {
        padding-top: 50px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
     #search {
            width: 300px;
     }

    </style>

<script src="https://code.jquery.com/jquery-3.0.0.js"></script>
<script src="https://code.jquery.com/jquery-migrate-3.0.1.js"></script>

   <link href="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet"/>
    <script src="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/js/bootstrap.min.js"></script>

    <link href="https://netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"/>
    <link href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/themes/smoothness/jquery-ui.min.css" rel="stylesheet"/>
 <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>


    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/js/select2.min.js"></script>

    <link href="css/ticket.css" rel="stylesheet" />
    <script src="lib/jquery.cookie.js"></script>

    <link href="images/tag_orange.png" rel="icon" type="image/png"/>
  </head>

  <body>
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>

            <a class="brand" style="padding: 6px 0px 0px 6px;" href="http://opensciencegrid.org"><img src="images/osglogo.40x30.png"/></a>
            <ul class="nav">
                <li class="dropdown"><a href="https://ticket.opensciencegrid.org/#" class="dropdown-toggle" data-toggle="dropdown">GOC Ticket <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    <li><a href="https://my.opensciencegrid.org">MyOSG</a></li>
                    <li><a href="https://oim.opensciencegrid.org">OIM</a></li>
                    <li class="active"><a href="https://ticket.opensciencegrid.org/index">Ticket</a></li>
	<li class="divider"></li>
	<li><a href="http://repo.grid.iu.edu">Repo</a></li>
	<li class="divider"></li>
	<li><a href="http://blogs.grid.iu.edu">Blog</a></li>
                    <li><a href="http://display.grid.iu.edu">Display</a></li>
                    <li><a href="http://osggoc.blogspot.com/">News</a></li>
                    </ul>
                </li>
            </ul>
            <ul class="nav pull-right">
                <li><a href="https://ticket.opensciencegrid.org/sso/">Login</a></li>            </ul>

            <div class="nav-collapse">
                <ul class="nav">
			 <li id="menu_submit"><a href="https://ticket.opensciencegrid.org/submit">Submit</a></li><li id="menu_view" class="dropdown"><a href="https://ticket.opensciencegrid.org/\#" class="dropdown-toggle" data-toggle="dropdown">View <b class="caret"></b></a><ul class="dropdown-menu"><li id="submenu_listopen"><a href="https://ticket.opensciencegrid.org/list/open">Open Tickets</a></li><li id="submenu_listrecentclose"><a href="https://ticket.opensciencegrid.org/list/recentclose">Recently Closed Tickets</a></li><li class="divider"></li><li id="submenu_alltickets"><a href="https://ticket.opensciencegrid.org/search?q=&amp;sort=id">All Tickets</a></li></ul></li>                </ul>

                <form class="navbar-search pull-right" action="https://ticket.opensciencegrid.org/viewer">
                    <input id="search" type="text" name="id" class="search-query span2" placeholder="Search Ticket" value=""/>
                </form>
            </div>
        </div>
      </div>
    </div>

<script type='text/javascript' src='lib/jquery.timeago.js'></script>
<script type='text/javascript' src='lib/byte2size.js'></script>
<style>
#updates .toolbar {
position: relative;
margin-top: 0px;
top: -10px;
font-weight: normal;
}
#updates a.anchor {
position: relative;
top: -50px;
}
#updates .selected pre {
animation:selected 2s;
animation-iteration-count: 2;
animation-direction: alternate;
-webkit-animation:selected 2s; 
-webkit-animation-iteration-count: 2;
-webkit-animation-direction: alternate;
box-shadow: inset 1px 1px 20px #9ad;
border: 1px solid #9ab;
margin: 5px 0px;
padding-left: 10px;
}
@keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ab;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
@-webkit-keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ad;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
#updates pre {
background-color: inherit;
line-height: 15px;
padding: 5px;
}
#updates .header {
color: #999;
}
#updates .update_history pre {
background-color: #eee;
color: #666;
font-size: 85%;
}
#updates .clickable {
cursor: pointer;
}
#updates .clickable:hover {
color: #D98719;
}
#updates .meta_information pre {
background-color: #fed;
}
#similar_tickets {
max-height: 300px;
overflow-y: auto;
pointer-events: none;
padding: 5px;
background-color: #f4f4f4;
}
.btn-toolbar {
margin-bottom: 0;
height: 30px;
}
#peers {
position: fixed;
bottom: 0px;
right: 0px;
z-index: 100;
list-style: none;
padding: 5px 0px 0px 5px;
margin: 0px;
background-color: white;
box-shadow: 0px 0px 10px white;
}
#peers li {
background-color: #ccc;
color: #000;
display: inline-block;
padding: 5px 10px;
margin-right: 5px;
position: relative;
}
/*
#peers li:hover {
background-color: #999;
cursor: pointer;
}
*/
#peers span.ip {
padding-left: 5px;
color: #666;
}
#peers .new {
bottom: -30px;
}
/*
#peers .me {
background-color: red;
}
*/
</style>

<div class="container-fluid">
<ul id="peers"></ul>
<div class="alert alert-danger"><a class="close" href="https://ticket.opensciencegrid.org/#" data-dismiss="alert">&times;</a>By the end of May 2018, the ticketing system at https://ticket.opensciencegrid.org will be retired and support will be provided at https://support.opensciencegrid.org. Throughout this transition the support email (help@opensciencegrid.org) will be available as a point of contact.<br><br>                                                   
                                                                                                                                                                                   
Please see the service migration page for details: https://opensciencegrid.github.io/technology/policy/service-migrations-spring-2018/#ticket</div><div id="presence" class="pull-right"></div><div class="ticketgui"><script type="text/javascript" src="lib/checktab.js"></script>

<script>
var expanded = false;
function expand_description() {
    var desc = $(".description");
    if(!expanded) {
        expanded = true;
        //expand to minheight
        var min = 250;
        if(desc.height() < min) {
            desc.animate({height: min}, 200);
        }
    }
}

$(document).ready(function() {
    $("input[name='nad']").datepicker({
        dateFormat: 'yy-mm-dd'
    });
});

</script>



<style>
.form-horizontal .control-label {
padding-top: inherit;
font-size:90%;
color:#666;
}
label {
margin-bottom: 0px;
}
.controls {
line-height: 18px;
}
</style>
<form class="form-horizontal" action="https://ticket.opensciencegrid.org/viewer/updatebasic?id=7341" method="post">
<div class="page-header">
    <h3><span class="muted">7341</span> / security notification form failure</h3>
</div>

<div class="row-fluid">
<div class="span5">
    <legend>Contact</legend>
    <div class="control-group">
        <label class="control-label">Full Name</label>
        <div class="controls">Jim Basney</div>
    </div>
    <div class="control-group">
        <label class="control-label">Email</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">Phone</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">CC</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>

    <legend>Details</legend>
    
    <div class="control-group">
        <label class="control-label">Ticket Type</label>
        <div class="controls">Problem/Request</div>
    </div>
    <div class="control-group">
        <label class="control-label">Priority</label>
        <div class="controls">Normal</div>
    </div>
    <div class="control-group">
        <label class="control-label">Status</label>
        <div class="controls">
Closed</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action</label>
        <div class="controls">Wait for next notification and confirm this fixed</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action Deadline</label>
        <div class="controls flag_red">2009-09-30</div>
    </div>

</div><!--span-->
<div class="span7">
    <legend>Assignees</legend>
    <div class="assignee" style="width: 60%">Kyle Gross <span class="muted"> / OSG GOC Support Team</span></div><div class="assignee" style="width: 60%">Security Team <span class="muted"> / OSG Support Centers</span></div>    <br>

    <legend>Assignees</legend>
    TODO
    <br>

    <style>
legend.noborder {
border-bottom: none;
}
</style>

<div id="attachment-list"/>
<script>
$(function () {
    var first = true;
    $.getJSON("attachment/list/7341", function (files) {
        //console.dir(files);
        var html = "<table class=\"table table-condensed\">";
        $(files).each(function() {
            if(first) {
                first = false;
                html += "<legend class=\"noborder\">Attachmenets</legend>";
            }
            html += "<tr class=\"attachment\">";
            html += "<td><img src=\""+this.thumbnail_url+"\"/></td>";
            html += "<td><a href=\""+this.url+"\" target=\"_blank\">"+this.name+"</a></td>";
            html += "<td>"+bytesToSize(this.size, 1)+"</td>";
            html += "</tr>";
        });
        html += "</table>";
        $("#attachment-list").html(html);
    });
});

function download(url) {
    window.open(url, "_blank");
}
</script>


</div><!--span-->
</div><!--row-fluid-->


</form>

</div>
<div id="updates" style="clear: both;">
    <legend>Past Updates
    <div class="btn-toolbar pull-right toolbar">
        <div class="btn-group">
                <a class="btn btn-small" href="https://ticket.opensciencegrid.org/7341?sort=up&amp;"><i class="icon-arrow-up"></i> Sort</a>

        
        <a class="btn btn-small" href="https://ticket.opensciencegrid.org/7341?expandall=true&amp;">Expand Descriptions</a>        <a class="btn btn-small" target="_blank" href="mailto:osg@tick.globalnoc.iu.edu?subject=Open%20Science%20Grid%3A%20security%20notification%20form%20failure%20ISSUE%3D7341%20PROJ%3D71"><i class="icon-envelope"></i> Update w/Email</a>
        </div>
    </div><!--btn-toolbar-->
    </legend>

    <div class='update_description'><i onclick="document.location='7341#1253802384'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2009-09-24T14:26:24+00:00">Sep 24, 2009 02:26 PM UTC</time> by <b>Arvind Gopu</b><a class="anchor" name="1253802384">&nbsp;</a></div><pre>I believe this issue has been resolved on a separate ticket (plus email thread between Mine et al). Closing the ticket. -ag</pre></div><div class='update_description'><i onclick="document.location='7341#1253107135'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2009-09-16T13:18:55+00:00">Sep 16, 2009 01:18 PM UTC</time> by <b>Kyle Gross</b><a class="anchor" name="1253107135">&nbsp;</a></div><pre>Are there any updates on this?</pre></div><div class='update_description'><i onclick="document.location='7341#1251812142'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2009-09-01T13:35:42+00:00">Sep 1, 2009 01:35 PM UTC</time> by <b>Soichi Hayashi</b><a class="anchor" name="1251812142">&nbsp;</a></div><pre>Arvind is working to update some of the SQL used in the ticket application. It should be fixed and made available in the next release.</pre></div><div class='update_description'><i onclick="document.location='7341#1251810460'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2009-09-01T13:07:40+00:00">Sep 1, 2009 01:07 PM UTC</time> by <b>Kyle Gross</b><a class="anchor" name="1251810460">&nbsp;</a></div><pre>Are there any updates on this issue?

Please submit problems, requests, and questions at&#58;
<a href='http&#58;//oim.grid.iu.edu/gocticket' target='_blank' rel='nofollow'>http&#58;//oim.grid.iu.edu/gocticket</a>

Thank You,
OSG Grid Operations Center
goc@...., 317-278-9699
Visit the OSG Support Page&#58;
<a href='http&#58;//www.opensciencegrid.org/ops' target='_blank' rel='nofollow'>http&#58;//www.opensciencegrid.org/ops</a>
RSS&#58; <a href='http&#58;//www.grid.iu.edu/news' target='_blank' rel='nofollow'>http&#58;//www.grid.iu.edu/news</a></pre></div><div class='update_description'><i onclick="document.location='7341#1251235032'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2009-08-25T21:17:12+00:00">Aug 25, 2009 09:17 PM UTC</time> by <b>Soichi Hayashi</b><a class="anchor" name="1251235032">&nbsp;</a></div><pre>Sent an revised list with some explanation. As I mentioned in the ticket, we have more fundamental issue in our ticket application which needs to be assessed and corrected soon.</pre></div><div class='update_description'><i onclick="document.location='7341#1251232894'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2009-08-25T20:41:34+00:00">Aug 25, 2009 08:41 PM UTC</time> by <b>Jim Basney</b><a class="anchor" name="1251232894">&nbsp;</a></div><pre>We should not be sending security notifications to the security contacts of inactive resources, VOs, and SCs. The list that Soichi sent me appears to include some of these, so I want to clarify. UCSDT2 is an active OSG resource (AFAIK), so t2support@.... should receive notifications, but the contacts for inactive resources (such as UVA-sunfire) should not be notified.

Thanks,
Jim</pre></div><div class='update_description'><i onclick="document.location='7341#1251230832'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2009-08-25T20:07:12+00:00">Aug 25, 2009 08:07 PM UTC</time> by <b>Soichi Hayashi</b><a class="anchor" name="1251230832">&nbsp;</a></div><pre>Jim,

I&#39;ve sent you an email containing the list of email addresses.</pre></div><div class='update_description'><i onclick="document.location='7341#1251229324'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2009-08-25T19:42:04+00:00">Aug 25, 2009 07:42 PM UTC</time> by <b>Jim Basney</b><a class="anchor" name="1251229324">&nbsp;</a></div><pre>Thanks Soichi. Can I get a list of security contacts that didn&#39;t receive today&#39;s notification (i.e., the &quot;de-activated&quot; security contacts) so I can send it to them separately?

-Jim</pre></div><div class='update_description'><i onclick="document.location='7341#1251228023'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2009-08-25T19:20:23+00:00">Aug 25, 2009 07:20 PM UTC</time> by <b>Soichi Hayashi</b><a class="anchor" name="1251228023">&nbsp;</a></div><pre>Jim

Currently, some OIM contacts were &quot;de-activated&quot; which includes the t2support@..... Instead of activating these contacts, we decided to remove this field from OIM (for various reasons that I&#39;d rather not explain here). We have made sweeping changes to ticket application white ago, but I found the piece of code that was still looking at this field and dropping those contacts with active flag set to false.

I have update the code, tested it and released it to production.

Kyle,

Do we keep this ticket open until Jim sends out yet another notification? Or should I close this for now?</pre></div><div class='update_description'><i onclick="document.location='7341#1251225765'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2009-08-25T18:42:45+00:00">Aug 25, 2009 06:42 PM UTC</time> by <b>Jim Basney</b><a class="anchor" name="1251225765">&nbsp;</a></div><pre>I just sent a new security notification (OSG-SEC-2009-08-25). It appears to have gone out to only some of the registered security contacts. For example, we received it at osg-security-team@.... but UCSDT2 didn&#39;t receive it at t2support@..... In the form output in my browser, the BCC line for the message includes osg-security-team but not t2support. Perhaps the BCC line is being truncated? I can send a snapshot from my browser if that helps.

Thanks,
Jim</pre></div><div class='update_description'><i onclick="document.location='7341#1250717462'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2009-08-19T21:31:02+00:00">Aug 19, 2009 09:31 PM UTC</time> by <b>Soichi Hayashi</b><a class="anchor" name="1250717462">&nbsp;</a></div><pre>Extending NAD until next Monday.</pre></div><div class='update_description'><i onclick="document.location='7341#1250602299'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2009-08-18T13:31:39+00:00">Aug 18, 2009 01:31 PM UTC</time> by <b>Kyle Gross</b><a class="anchor" name="1250602299">&nbsp;</a></div><pre>Jim,

Ok...I&#39;ll leave this ticket open until the next message.</pre></div><div class='update_description'><i onclick="document.location='7341#1250539098'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2009-08-17T19:58:18+00:00">Aug 17, 2009 07:58 PM UTC</time> by <b>Jim Basney</b><a class="anchor" name="1250539098">&nbsp;</a></div><pre>I&#39;d prefer not to bother the security contacts with a test message. I expect we&#39;ll be sending another notification sometime this week with an update on CVE-2009-2692, so that can be our test.

Thanks,
Jim</pre></div><div class='update_description'><i onclick="document.location='7341#1250537791'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2009-08-17T19:36:31+00:00">Aug 17, 2009 07:36 PM UTC</time> by <b>Kyle Gross</b><a class="anchor" name="1250537791">&nbsp;</a></div><pre>Jim,

We would like to do a test message with the new fix in place.  Please let us know when you can send one.

Kyle</pre></div><div class='update_description'><i onclick="document.location='7341#1250531577'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2009-08-17T17:52:57+00:00">Aug 17, 2009 05:52 PM UTC</time> by <b>Soichi Hayashi</b><a class="anchor" name="1250531577">&nbsp;</a></div><pre>There was an issue with the way ticket application was generating the SMTP header information. I have fixed it, but I can not completely test it until next time we send out the notification. Please bare with us until we flush out all of the issues.

Kyle, please keep this ticket open until Jim sends out another notification and confirm that everything works next time.</pre></div><div class='update_description'><i onclick="document.location='7341#1250527840'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2009-08-17T16:50:40+00:00">Aug 17, 2009 04:50 PM UTC</time> by <b>Kyle Gross</b><a class="anchor" name="1250527840">&nbsp;</a></div><pre>Adding Soichi.</pre></div><div class='update_description'><i onclick="document.location='7341#1250280623'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2009-08-14T20:10:23+00:00">Aug 14, 2009 08:10 PM UTC</time> by <b>Jim Basney</b><a class="anchor" name="1250280623">&nbsp;</a></div><pre>Adding Security Team to the ticket.</pre></div><div class='update_description'><i onclick="document.location='7341#1250280576'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2009-08-14T20:09:36+00:00">Aug 14, 2009 08:09 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1250280576">&nbsp;</a></div><pre>Hi,

This afternoon I submitted a security notification using the form at <a href='https&#58;//ticket.grid.iu.edu/goc/simplenotify.' target='_blank' rel='nofollow'>https&#58;//ticket.grid.iu.edu/goc/simplenotify.</a> The resulting page contained &quot;Your request has been processed successfully&quot; and goc@.... received the message, but it appears the security contacts (listed in the BCC) didn&#39;t receive it.

I asked Elizabeth to forward the message to the security contacts, which should take care of the notification today, but I&#39;d appreciate your help in fixing the form so we can use it for future notifications.

Thanks,
Jim Basney</pre></div><legend>Similar Recent Tickets <small>modified within the last 30 days</small></legend><div id="similar_tickets"><p class="muted">No similar tickets found.</p></div>
</div>
<script type="text/javascript">
function reset_anchor() {
    $("#updates .selected").removeClass("selected");
    var urls = document.location.toString().split('#'); 
    var anchor = urls[1];
    if(anchor) {
        $("a[name='"+anchor+"']").parents(".update_description").addClass("selected");
    }
}
function submitspam(ticket_id) {
    myret = confirm("Would you like to close this ticket as a security ticket, and submit the ticket content to akismet?");
    if(myret == true) {
        $.ajax("viewer/processspam?id="+ticket_id).done(function() {
            window.location.reload();
        });
    }
}

$(function() {
    reset_anchor();
    var ADDITIONAL_COOKIE_NAME = 'gocticket';
    var options = { path: '/', expires: 365};

    if(window.opener && window.opener.name == "gocticket_list") {
        v = $.cookie("closewindow");
        if(!v) {
            $("#closewindow").attr("checked", "checked"); //on by default
        } else {
            if(v == "checked") {
                $("#closewindow").attr("checked", "checked");
            }
        }
        $("#closewindow").click(function() {
            $.cookie("closewindow", $(this).attr('checked'), options);
        });
    } else {
        $("#closewindow_area").hide();
    }
    function updateTimeago() {
        $("time").timeago();
        setTimeout(updateTimeago, 30*1000);
    }
    updateTimeago();
    $(".description").focus(expand_description);
});
</script>
<hr/>
<footer>
<p>GOC Ticket Version 2.2 | <a href="https://ticket.opensciencegrid.org/goc/submit?app_issue_check=on&amp;app_issue_type=goc&amp;app_goc_url=https%3A%2F%2Fticket.opensciencegrid.org%3A443%2F7341">Report Bugs</a>
 | <a href="https://github.com/opensciencegrid/operations/blob/master/docs/privacy.md">Privacy Policy</a>
</p>

<p> <img align="top" src="images/tag_orange.png"/> Copyright 2018 The Trustees of Indiana University - Developed for Open Science Grid</p>
</footer>


</div><!--container-fluid-->
<script src="https://ticket1.grid.iu.edu:8443/socket.io/socket.io.js"></script>
<script>
var chat = io.connect('https://ticket1.grid.iu.edu:8443');
chat.on('connect', function() {
    chat.emit('authenticate', {nodekey:'', ticketid: 7341});
});
chat.on('peers', function(peers) {
    $("#peers").html("");
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('peer_disconnect', function(pid) {
    $("#peer_"+pid).hide("slow");
});
chat.on('peer_connected', function(peers) {
    //expect only 1 peer connecting, but..
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('submit', function() {
    if(confirm("This ticket was updated. Do you want to refresh?")) {
        history.go(0);
    }
});

function addPeer(pid, peer) {
    var ipinfo = "";
    if(peer.ip != undefined) {
        ipinfo = "<span class=\"ip\">"+peer.ip+"</span>";
    }
    if(chat.io.engine.id == pid) {
        //don't display myself
        return;
    }
    var html = "<li class=\"new\" id=\"peer_"+pid+"\" class=\"peer\">"+peer.name+ipinfo+"</li>";
    $("#peers").prepend(html);
    $("#peers .new").animate({bottom: 0}, 1000, function() {$(this).removeClass("new")});
}

$(function() {
    $("#ticket_form").submit(function() {
        chat.emit('submit');
        return true;
    });
});
</script>
<script>
//used by searchbox
function parseValue(value) {
    var obj = new Object();
    var tokens = value.split("\t");
    obj.str = tokens[0];
    obj.count = tokens[1];
    return obj;
}

$(function() {
    //bootstrap-2.0.4 stuff
    $(".alert-message").alert();
    $(".dropdown-toggle").dropdown();
    $("span[rel='tooltip']").tooltip();
    $("a[rel=popover]").popover();

    //activate menu that user is currently on
    $("#menu_navigator").addClass("active"); 
    $("#submenu_").addClass("active"); 

    //translate zend validation error message to bootstrap
    $(".errors").addClass("alert").addClass("alert-error");

    //enable autocomplete for search box
    $("#search").autocomplete({
        source: function( request, response ) {
            $.ajax({
                url: "search/autocomplete",
                dataType: "text",
                data: {
                    //featureClass: "P",
                    //style: "full",
                    //maxRows: 12,
                    //name_startsWith: request.term
                    q: request.term
                },
                success: function( data ) {
                    response( $.map( data.split("\n"), function( item ) {
                        if(item == "") return null;
                        return {
                            value: item
                        }
                    }));
                }
            });
        },
        select: function(event, ui) {
            document.location = "search?q="+ui.item.value;
        }
    });
    
});
</script>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-69012-13");
pageTracker._trackPageview();
} catch(err) {}
</script>

</body>
