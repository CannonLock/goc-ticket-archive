<!DOCTYPE html>
<html lang="en">
  <head>
  <base href="">
    <title>[10403] Issues With Gratia Probes After OSG Update</title>    <meta charset="utf-8" />
    <meta name="verify-v1" content="na5IcAJsZVOfEkboRxuIiZ1zpZgnZiWra+nKcS7nA/o=" />
    <meta name="google-site-verification" content="DLrk3ft4s8b-S2TloLCL2LD_t6wcTjgSluf5pmiu2kA" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />
    <meta name="robots" content="noindex, nofollow" />

    <style type="text/css">
      body {
        padding-top: 50px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
     #search {
            width: 300px;
     }

    </style>

<script src="https://code.jquery.com/jquery-3.0.0.js"></script>
<script src="https://code.jquery.com/jquery-migrate-3.0.1.js"></script>

   <link href="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet"/>
    <script src="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/js/bootstrap.min.js"></script>

    <link href="https://netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"/>
    <link href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/themes/smoothness/jquery-ui.min.css" rel="stylesheet"/>
 <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>


    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/js/select2.min.js"></script>

    <link href="css/ticket.css" rel="stylesheet" />
    <script src="lib/jquery.cookie.js"></script>

    <link href="images/tag_orange.png" rel="icon" type="image/png"/>
  </head>

  <body>
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>

            <a class="brand" style="padding: 6px 0px 0px 6px;" href="http://opensciencegrid.org"><img src="images/osglogo.40x30.png"/></a>
            <ul class="nav">
                <li class="dropdown"><a href="https://ticket.opensciencegrid.org/#" class="dropdown-toggle" data-toggle="dropdown">GOC Ticket <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    <li><a href="https://my.opensciencegrid.org">MyOSG</a></li>
                    <li><a href="https://oim.opensciencegrid.org">OIM</a></li>
                    <li class="active"><a href="https://ticket.opensciencegrid.org/index">Ticket</a></li>
	<li class="divider"></li>
	<li><a href="http://repo.grid.iu.edu">Repo</a></li>
	<li class="divider"></li>
	<li><a href="http://blogs.grid.iu.edu">Blog</a></li>
                    <li><a href="http://display.grid.iu.edu">Display</a></li>
                    <li><a href="http://osggoc.blogspot.com/">News</a></li>
                    </ul>
                </li>
            </ul>
            <ul class="nav pull-right">
                <li><a href="https://ticket.opensciencegrid.org/sso/">Login</a></li>            </ul>

            <div class="nav-collapse">
                <ul class="nav">
			 <li id="menu_submit"><a href="https://ticket.opensciencegrid.org/submit">Submit</a></li><li id="menu_view" class="dropdown"><a href="https://ticket.opensciencegrid.org/\#" class="dropdown-toggle" data-toggle="dropdown">View <b class="caret"></b></a><ul class="dropdown-menu"><li id="submenu_listopen"><a href="https://ticket.opensciencegrid.org/list/open">Open Tickets</a></li><li id="submenu_listrecentclose"><a href="https://ticket.opensciencegrid.org/list/recentclose">Recently Closed Tickets</a></li><li class="divider"></li><li id="submenu_alltickets"><a href="https://ticket.opensciencegrid.org/search?q=&amp;sort=id">All Tickets</a></li></ul></li>                </ul>

                <form class="navbar-search pull-right" action="https://ticket.opensciencegrid.org/viewer">
                    <input id="search" type="text" name="id" class="search-query span2" placeholder="Search Ticket" value=""/>
                </form>
            </div>
        </div>
      </div>
    </div>

<script type='text/javascript' src='lib/jquery.timeago.js'></script>
<script type='text/javascript' src='lib/byte2size.js'></script>
<style>
#updates .toolbar {
position: relative;
margin-top: 0px;
top: -10px;
font-weight: normal;
}
#updates a.anchor {
position: relative;
top: -50px;
}
#updates .selected pre {
animation:selected 2s;
animation-iteration-count: 2;
animation-direction: alternate;
-webkit-animation:selected 2s; 
-webkit-animation-iteration-count: 2;
-webkit-animation-direction: alternate;
box-shadow: inset 1px 1px 20px #9ad;
border: 1px solid #9ab;
margin: 5px 0px;
padding-left: 10px;
}
@keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ab;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
@-webkit-keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ad;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
#updates pre {
background-color: inherit;
line-height: 15px;
padding: 5px;
}
#updates .header {
color: #999;
}
#updates .update_history pre {
background-color: #eee;
color: #666;
font-size: 85%;
}
#updates .clickable {
cursor: pointer;
}
#updates .clickable:hover {
color: #D98719;
}
#updates .meta_information pre {
background-color: #fed;
}
#similar_tickets {
max-height: 300px;
overflow-y: auto;
pointer-events: none;
padding: 5px;
background-color: #f4f4f4;
}
.btn-toolbar {
margin-bottom: 0;
height: 30px;
}
#peers {
position: fixed;
bottom: 0px;
right: 0px;
z-index: 100;
list-style: none;
padding: 5px 0px 0px 5px;
margin: 0px;
background-color: white;
box-shadow: 0px 0px 10px white;
}
#peers li {
background-color: #ccc;
color: #000;
display: inline-block;
padding: 5px 10px;
margin-right: 5px;
position: relative;
}
/*
#peers li:hover {
background-color: #999;
cursor: pointer;
}
*/
#peers span.ip {
padding-left: 5px;
color: #666;
}
#peers .new {
bottom: -30px;
}
/*
#peers .me {
background-color: red;
}
*/
</style>

<div class="container-fluid">
<ul id="peers"></ul>
<div class="alert alert-danger"><a class="close" href="https://ticket.opensciencegrid.org/#" data-dismiss="alert">&times;</a>By the end of May 2018, the ticketing system at https://ticket.opensciencegrid.org will be retired and support will be provided at https://support.opensciencegrid.org. Throughout this transition the support email (help@opensciencegrid.org) will be available as a point of contact.<br><br>                                                   
                                                                                                                                                                                   
Please see the service migration page for details: https://opensciencegrid.github.io/technology/policy/service-migrations-spring-2018/#ticket</div><div id="presence" class="pull-right"></div><div class="ticketgui"><script type="text/javascript" src="lib/checktab.js"></script>

<script>
var expanded = false;
function expand_description() {
    var desc = $(".description");
    if(!expanded) {
        expanded = true;
        //expand to minheight
        var min = 250;
        if(desc.height() < min) {
            desc.animate({height: min}, 200);
        }
    }
}

$(document).ready(function() {
    $("input[name='nad']").datepicker({
        dateFormat: 'yy-mm-dd'
    });
});

</script>



<style>
.form-horizontal .control-label {
padding-top: inherit;
font-size:90%;
color:#666;
}
label {
margin-bottom: 0px;
}
.controls {
line-height: 18px;
}
</style>
<form class="form-horizontal" action="https://ticket.opensciencegrid.org/viewer/updatebasic?id=10403" method="post">
<div class="page-header">
    <h3><span class="muted">10403</span> / Issues With Gratia Probes After OSG Update</h3>
</div>

<div class="row-fluid">
<div class="span5">
    <legend>Contact</legend>
    <div class="control-group">
        <label class="control-label">Full Name</label>
        <div class="controls">Ruth Pordes</div>
    </div>
    <div class="control-group">
        <label class="control-label">Email</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">Phone</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">CC</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>

    <legend>Details</legend>
    
    <div class="control-group">
        <label class="control-label">Ticket Type</label>
        <div class="controls">Problem/Request</div>
    </div>
    <div class="control-group">
        <label class="control-label">Priority</label>
        <div class="controls">Normal</div>
    </div>
    <div class="control-group">
        <label class="control-label">Status</label>
        <div class="controls">
Closed</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action</label>
        <div class="controls">Check for updates</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action Deadline</label>
        <div class="controls flag_red">2011-07-01</div>
    </div>

</div><!--span-->
<div class="span7">
    <legend>Assignees</legend>
    <div class="assignee" style="width: 60%">Kyle Gross <span class="muted"> / OSG GOC Support Team</span></div><div class="assignee" style="width: 60%">GRATIA <span class="muted"> / OSG Support Centers</span></div>    <br>

    <legend>Assignees</legend>
    TODO
    <br>

    <style>
legend.noborder {
border-bottom: none;
}
</style>

<div id="attachment-list"/>
<script>
$(function () {
    var first = true;
    $.getJSON("attachment/list/10403", function (files) {
        //console.dir(files);
        var html = "<table class=\"table table-condensed\">";
        $(files).each(function() {
            if(first) {
                first = false;
                html += "<legend class=\"noborder\">Attachmenets</legend>";
            }
            html += "<tr class=\"attachment\">";
            html += "<td><img src=\""+this.thumbnail_url+"\"/></td>";
            html += "<td><a href=\""+this.url+"\" target=\"_blank\">"+this.name+"</a></td>";
            html += "<td>"+bytesToSize(this.size, 1)+"</td>";
            html += "</tr>";
        });
        html += "</table>";
        $("#attachment-list").html(html);
    });
});

function download(url) {
    window.open(url, "_blank");
}
</script>


</div><!--span-->
</div><!--row-fluid-->


</form>

</div>
<div id="updates" style="clear: both;">
    <legend>Past Updates
    <div class="btn-toolbar pull-right toolbar">
    </div><!--btn-toolbar-->
    </legend>

    <div class='update_description'><i onclick="document.location='10403#1310670248'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-07-14T19:04:08+00:00">Jul 14, 2011 07:04 PM UTC</time> by <b>Kyle Gross</b><a class="anchor" name="1310670248">&nbsp;</a></div><pre>Thank you for informing us that this issue has been resolved. I will close this ticket.

Please submit problems, requests, and questions at&#58;
<a href='https&#58;//ticket.grid.iu.edu/goc/open' target='_blank' rel='nofollow'>https&#58;//ticket.grid.iu.edu/goc/open</a>

OSG Grid Operations Center
goc@...., 317-278-9699
Visit the OSG Operations Page&#58;
<a href='http&#58;//osggoc.blogspot.com/' target='_blank' rel='nofollow'>http&#58;//osggoc.blogspot.com/</a></pre></div><div class='update_description'><i onclick="document.location='10403#1309373770'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-06-29T18:56:10+00:00">Jun 29, 2011 06:56 PM UTC</time> by <b>USCMS</b><a class="anchor" name="1309373770">&nbsp;</a></div><pre>The Fermi/Remedy ticket has been updated.

Work Info Type* &#58; Resolution Communications
Date+           &#58;
Source          &#58;
Summary*        &#58; Resolution Information
Notes           &#58; After discussion with OSG management  and the US Atlas facilities manager (Michael Ernst) we decided not
to remove the dupblicates from the Gratia database and not to re-state the WLCG report.

Steve Timm
Submitter*      &#58; timm

Fermi National Accelerator Laboratory Service DeskService Desk&#58; 630.840.2345</pre></div><div class='update_description'><i onclick="document.location='10403#1309373768'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-06-29T18:56:08+00:00">Jun 29, 2011 06:56 PM UTC</time> by <b>USCMS</b><a class="anchor" name="1309373768">&nbsp;</a></div><pre>The Fermi/Remedy ticket has been resolved with the following solution.  Please resolve your ticket.

Resolution Categorization Tier 1 &#58;
Resolution Categorization Tier 2 &#58;
Resolution Categorization Tier 3 &#58;
Resolution                       &#58; After discussion with OSG management  and the US Atlas facilities manager (Michael Ernst) we decided not
to remove the dupblicates from the Gratia database and not to re-state the WLCG report.

Steve Timm
Resolution Method                &#58;

Fermi National Accelerator Laboratory Service DeskService Desk&#58; 630.840.2345</pre></div><div class='update_description'><i onclick="document.location='10403#1309302787'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-06-28T23:13:07+00:00">Jun 28, 2011 11:13 PM UTC</time> by <b>Philippe Canal</b><a class="anchor" name="1309302787">&nbsp;</a></div><pre>Hi Brian,

Technically the 2 set of records are not duplicates even though in practice the 2nd set was talking about the same jobs.
The first set were Grid Jobs properly associated to a user via their DN (thanks to the certinfo)
while the 2nd set were Local jobs with no Grid users (due to the missing certinfo) that &#39;just&#39; happen to have the
same jobid and EndTime.
This is somewhat intentional because it is preferable to keep unrecognized duplicates rather than toss out false duplicates
(and the algorithm was implemented way before the idea that we would get extra information from what is essentially an
external (and thus not always present) source).

Cheers,
Philippe.

On 6/28/11 5&#58;09 PM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='10403#1309298963'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-06-28T22:09:23+00:00">Jun 28, 2011 10:09 PM UTC</time><a class="anchor" name="1309298963">&nbsp;</a></div><pre>Hi,

Sorry, catching up to a long ticket.

I&#39;m a bit concerned that I don&#39;t understand from Philippe&#39;s comments as to *why* the built-in duplicate-detection failed to detect the issue.

Looking at the number of hours that were duplicated, I don&#39;t think this is going to throw off any ATLAS or OSG totals.  I&#39;m fine with not fixing the production database for this case.

Brian

-- by Brian Bockelman</pre></div><div class='update_description'><i onclick="document.location='10403#1309195745'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-06-27T17:29:05+00:00">Jun 27, 2011 05:29 PM UTC</time> by <b>Rob Quick</b><a class="anchor" name="1309195745">&nbsp;</a></div><pre>My opinion is that if Micheal thinks this is not necessary at the WLCG level, it is probably not necessary at the OSG level either. I will bring this up on the Change Management call later today for discussion.

Brian, do you have any thoughts?

Rob</pre></div><div class='update_description'><i onclick="document.location='10403#1309188892'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-06-27T15:34:52+00:00">Jun 27, 2011 03:34 PM UTC</time><a class="anchor" name="1309188892">&nbsp;</a></div><pre>We need a decision within the next day on whether the duplicate
records from UTA should be corrected within the Gratia database
itself.  If not done by July 1 then they will start getting housekept
off the system and there will be nothing we can do.
I believe this is Brian&#39;s call in consultation with higher OSG management.

Steve Timm

-- by Steve Timm</pre></div><div class='update_description'><i onclick="document.location='10403#1308767422'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-06-22T18:30:22+00:00">Jun 22, 2011 06:30 PM UTC</time><a class="anchor" name="1308767422">&nbsp;</a></div><pre>Thanks for updates, Ruth and Patrick.  The only remaining issue&#58;  given that we are
not going to update WLCG database, is it worth updating the gratia database itself?

Steve Timm

-- by Steve Timm</pre></div><div class='update_description'><i onclick="document.location='10403#1308766867'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-06-22T18:21:07+00:00">Jun 22, 2011 06:21 PM UTC</time> by <b>Patrick McGuigan</b><a class="anchor" name="1308766867">&nbsp;</a></div><pre>In our meeting, Michel stated that at this point no significant effort should be expended
in order to restate the reported data to WLCG for the April data for UTA_SWT2.   I think
that we can let the matter drop with respect to WLCG.

Regards,
Patrick

On 06/22/2011 12&#58;45 PM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='10403#1308764707'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-06-22T17:45:07+00:00">Jun 22, 2011 05:45 PM UTC</time> by <b>Patrick McGuigan</b><a class="anchor" name="1308764707">&nbsp;</a></div><pre>Hello,

I am planning on bringing this up in our weekly ATLAS facilities meeting that is occurring
now.  Michael is on the call and we should get an ATLAS position on this shortly.

Patrick

On 06/22/2011 12&#58;39 PM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='10403#1308764348'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-06-22T17:39:08+00:00">Jun 22, 2011 05:39 PM UTC</time> by <b>Ruth Pordes</b><a class="anchor" name="1308764348">&nbsp;</a></div><pre>Fixing Content is the decision of the US ATLAS facilities manager - Michael
Ernst.

Publishing info from OSG to WLCG is an Operations Service - thus Operations
owns ensuring the ticket is solved and closed to the satisfaction of the
Customer.

Either Operations or I as the OSG ATLAS Account Manager can contact Michael
Ernst.

It would be good to be clear on the impact/cost&#58;

Impact - some (?%?) duplicate accounting records for UTA US ATLAS Tier-2
in May accounting?

Cost -
OSG runs query and republishes data to WLCG - Gratia ops and Weigand
OSG needs to work with WLCG to accept the republished data and
republish the report  - John Weigand, OSG operations

Is this correct?

Ruth

<font color='#7F7E6F'>&#62; From&#58; Open Science Grid FootPrints &#60;osg@....&#62;</font>
<font color='#7F7E6F'>&#62; Reply-To&#58; Open Science Grid FootPrints &#60;osg@....&#62;</font>
<font color='#7F7E6F'>&#62; Date&#58; Wed, 22 Jun 2011 12&#58;03&#58;00 -0500</font>
<font color='#7F7E6F'>&#62; To&#58; Ruth Pordes &#60;ruth@....&#62;</font>
<font color='#7F7E6F'>&#62; Subject&#58; Open Science Grid&#58; Issues With Gratia Probes After OSG Update</font>
<font color='#7F7E6F'>&#62; ISSUE=10403 PROJ=71</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='10403#1308762210'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-06-22T17:03:30+00:00">Jun 22, 2011 05:03 PM UTC</time><a class="anchor" name="1308762210">&nbsp;</a></div><pre>This matter is of some urgency since once July 1 comes, the old duplicate
records will get housekept out of the Gratia database and then there
is nothing we can do to correct it.  We need a management decision from
whomever in OSG is responsible for the APEL-WLCG transfer, to decide if
we are going to make this correction, and we need it before June 30 because
both Fermi staff who could do this change, myself and Dan Yocum,are on
vacation the end of that week.

Steve Timm

-- by Steve Timm</pre></div><div class='update_description'><i onclick="document.location='10403#1308674758'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-06-21T16:45:58+00:00">Jun 21, 2011 04:45 PM UTC</time><a class="anchor" name="1308674758">&nbsp;</a></div><pre>-- by John Weigand</pre></div><div class='update_description'><i onclick="document.location='10403#1308673937'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-06-21T16:32:17+00:00">Jun 21, 2011 04:32 PM UTC</time><a class="anchor" name="1308673937">&nbsp;</a></div><pre>This is in response to Steve Timm&#39;s email of 6/21 asking if they
should proceed with the fix of duplicates.

It is fairly easy for us to repopulate the APEL database from
Gratia for April (as I understand it the duplicates are from 4/1 - 4/19).

HOWEVER, there are a couple things that have to occur on the WLCG side
depending on what anyone wants reflected up there&#58;

1. If you want it visible in the EGI portal, the data will have to move
from the APEL db to the EGI db.  This use to be a complete refresh
via a cron job but I would think that has likely changed due to the
volume of data that exists today. I can investigate this if desired.

2. If you want the April Tier 2 MOU report to reflect the new data,
then someone from the VO or OSG has to contact the LCG Accounting
office and request it.  This is something we (Karthik or myself)
cannot do.

If you don&#39;t care about either of the above and just want Gratia to
reflect the correct data, then we need do nothing with respect to
the interface.  The duplicates can be removed at any time.

John Weigand

-- by John Weigand</pre></div><div class='update_description'><i onclick="document.location='10403#1307725954'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-06-10T17:12:34+00:00">Jun 10, 2011 05:12 PM UTC</time> by <b>Kyle Gross</b><a class="anchor" name="1307725954">&nbsp;</a></div><pre>Are there any updates on this issue?  Or can this issue be closed?

Please submit problems, requests, and questions at&#58;
<a href='https&#58;//ticket.grid.iu.edu/goc/open' target='_blank' rel='nofollow'>https&#58;//ticket.grid.iu.edu/goc/open</a>

Thank You,
OSG Grid Operations Center
goc@...., 317-278-9699
Visit the Open Science Grid Operations Page&#58;
<a href='http&#58;//osggoc.blogspot.com/' target='_blank' rel='nofollow'>http&#58;//osggoc.blogspot.com/</a></pre></div><div class='update_description'><i onclick="document.location='10403#1307125340'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-06-03T18:22:20+00:00">Jun 3, 2011 06:22 PM UTC</time> by <b>Kyle Gross</b><a class="anchor" name="1307125340">&nbsp;</a></div><pre>Sorry all, I accidentally clicked the wrong quick description.  (No response vs regular ping)  It&#39;s very obvious that there have been responses.  Sorry if I offended anyone.

-Kyle</pre></div><div class='update_description'><i onclick="document.location='10403#1307124552'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-06-03T18:09:12+00:00">Jun 3, 2011 06:09 PM UTC</time><a class="anchor" name="1307124552">&nbsp;</a></div><pre>So the update is--the combination of Phillipe, John W., Karthik, myself, and Dan have to figure
out if the WLCG stuff needs to be restated, and who should do it.  That will happen at some
Gratia meeting in the future, whenever the next one happens.

Steve Timm

-- by Steve Timm</pre></div><div class='update_description'><i onclick="document.location='10403#1307124468'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-06-03T18:07:48+00:00">Jun 3, 2011 06:07 PM UTC</time><a class="anchor" name="1307124468">&nbsp;</a></div><pre>Date&#58; Thu, 26 May 2011 12&#58;04&#58;40 -0500
From&#58; Philippe Canal &#60;pcanal@....&#62;
To&#58; weigand@....
Cc&#58; Patrick McGuigan &#60;mcguigan@....&#62;, Steven Timm &#60;timm@....&#62;,
gratia-operation@...., karunach@...., mguigan@....
Subject&#58; Re&#58; gratia probes after OSG update (fwd)

<font color='#7F7E6F'>&#62; On a broader scale... is this duplicates problem isolated to this one</font>
site/probe? or is it affecting many sites?

It is an isolated incident that can affects only PBS/LSF sites that
performed an upgrade but did not bring forward the
state of the probe.

Cheers,
Philippe.

-- by Steve Timm</pre></div><div class='update_description'><i onclick="document.location='10403#1307124454'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-06-03T18:07:34+00:00">Jun 3, 2011 06:07 PM UTC</time><a class="anchor" name="1307124454">&nbsp;</a></div><pre>Date&#58; Wed, 25 May 2011 16&#58;22&#58;04 -0500
From&#58; Philippe Canal &#60;pcanal@....&#62;
Cc&#58; Steven Timm &#60;timm@....&#62;, gratia-operation@...., weigand@....
Subject&#58; Re&#58; gratia probes after OSG update (fwd)

Hi Steve, Dan,

If FermiGrid and/or OSG wanted to delete those duplicates records (i.e. in
order for the WLCG reports to be restated),
you (or I) would need to issue the following SQL deletes&#58;

select del_JUR_from_summary(M.dbid) from JobUsageRecord_Meta M,
JobUsageRecord J where M.dbid = J.dbid  and ProbeName =
&#39;pbs&#58;gk04.swt2.uta.edu&#39; and EndTime &#60; &#39;2011-04-19 20&#58;38&#58;06&#39; and  EndTime &#62;
&#39;2011-01-10 10&#58;04&#58;01&#39; and timestampdiff(minute,EndTime,ServerDate) &#62; 700 and
(CommonName like &#39;Generic%&#39; or CommonName = &#39;Unknown&#39;);

-- by Steve Timm</pre></div><div class='update_description'><i onclick="document.location='10403#1307124433'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-06-03T18:07:13+00:00">Jun 3, 2011 06:07 PM UTC</time><a class="anchor" name="1307124433">&nbsp;</a></div><pre>To&#58; Philippe Canal &#60;pcanal@....&#62;, Patrick McGuigan &#60;mcguigan@....&#62;
Cc&#58; Steven Timm &#60;timm@....&#62;, gratia-operation@....,
karunach@...., mguigan@....
Subject&#58; Re&#58; gratia probes after OSG update (fwd)

Patrick/Philippe,

Just an fyi on the cutoff... it is now the 8th (May 8 for April).  We
changed it to coincide with the date the LCG Accounting office pulls the
data off EGI for the monthly MOU reports.

As for re-populating APEL-EGI/WLCG, we can do that but it will not affect
the April MOU report unless someone from the site and/or vo contacts the LCG
Accounting office and asks them to update that months report.  We cannot do
it.  I think there is significant effort on their end but am not certain on
that.   If it is really necessary, it is best to make sure they are on board
before we update the data.
On a broader scale... is this duplicates problem isolated to this one
site/probe? or is it affecting many sites?

John Weigand

-- by Steve Timm</pre></div><div class='update_description'><i onclick="document.location='10403#1307124406'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-06-03T18:06:46+00:00">Jun 3, 2011 06:06 PM UTC</time><a class="anchor" name="1307124406">&nbsp;</a></div><pre>Date&#58; Wed, 25 May 2011 16&#58;22&#58;04 -0500
From&#58; Philippe Canal &#60;pcanal@....&#62;
Cc&#58; Steven Timm &#60;timm@....&#62;, gratia-operation@...., weigand@....
Subject&#58; Re&#58; gratia probes after OSG update (fwd)

Hi Steve, Dan,

If FermiGrid and/or OSG wanted to delete those duplicates records (i.e. in
order for the WLCG reports to be restated),
you (or I) would need to issue the following SQL deletes&#58;

select del_JUR_from_summary(M.dbid) from JobUsageRecord_Meta M,
JobUsageRecord J where M.dbid = J.dbid  and ProbeName =
&#39;pbs&#58;gk04.swt2.uta.edu&#39; and EndTime &#60; &#39;2011-04-19 20&#58;38&#58;06&#39; and  EndTime &#62;
&#39;2011-01-10 10&#58;04&#58;01&#39; and timestampdiff(minute,EndTime,ServerDate) &#62; 700 and
(CommonName like &#39;Generic%&#39; or CommonName = &#39;Unknown&#39;);

Date&#58; Wed, 25 May 2011 16&#58;22&#58;04 -0500
From&#58; Philippe Canal &#60;pcanal@....&#62;
Cc&#58; Steven Timm &#60;timm@....&#62;, gratia-operation@...., weigand@....
Subject&#58; Re&#58; gratia probes after OSG update (fwd)

Hi Steve, Dan,

If FermiGrid and/or OSG wanted to delete those duplicates records (i.e. in
order for the WLCG reports to be restated),
you (or I) would need to issue the following SQL deletes&#58;

select del_JUR_from_summary(M.dbid) from JobUsageRecord_Meta M,
JobUsageRecord J where M.dbid = J.dbid  and ProbeName =
&#39;pbs&#58;gk04.swt2.uta.edu&#39; and EndTime &#60; &#39;2011-04-19 20&#58;38&#58;06&#39; and  EndTime &#62;
&#39;2011-01-10 10&#58;04&#58;01&#39; and timestampdiff(minute,EndTime,ServerDate) &#62; 700 and
(CommonName like &#39;Generic%&#39; or CommonName = &#39;Unknown&#39;);
Date&#58; Wed, 25 May 2011 16&#58;22&#58;04 -0500
From&#58; Philippe Canal &#60;pcanal@....&#62;
<div id='show_1947568608' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_1947568608'>Cc&#58; Steven Timm &#60;timm@....&#62;, gratia-operation@...., weigand@....
Subject&#58; Re&#58; gratia probes after OSG update (fwd)

Hi Steve, Dan,

If FermiGrid and/or OSG wanted to delete those duplicates records (i.e. in
order for the WLCG reports to be restated),
you (or I) would need to issue the following SQL deletes&#58;

select del_JUR_from_summary(M.dbid) from JobUsageRecord_Meta M,
JobUsageRecord J where M.dbid = J.dbid  and ProbeName =
&#39;pbs&#58;gk04.swt2.uta.edu&#39; and EndTime &#60; &#39;2011-04-19 20&#58;38&#58;06&#39; and  EndTime &#62;
&#39;2011-01-10 10&#58;04&#58;01&#39; and timestampdiff(minute,EndTime,ServerDate) &#62; 700 and
(CommonName like &#39;Generic%&#39; or CommonName = &#39;Unknown&#39;);

Date&#58; Wed, 25 May 2011 16&#58;22&#58;04 -0500
From&#58; Philippe Canal &#60;pcanal@....&#62;
Cc&#58; Steven Timm &#60;timm@....&#62;, gratia-operation@...., weigand@....
Subject&#58; Re&#58; gratia probes after OSG update (fwd)

Hi Steve, Dan,

If FermiGrid and/or OSG wanted to delete those duplicates records (i.e. in
order for the WLCG reports to be restated),
you (or I) would need to issue the following SQL deletes&#58;

select del_JUR_from_summary(M.dbid) from JobUsageRecord_Meta M,
JobUsageRecord J where M.dbid = J.dbid  and ProbeName =
&#39;pbs&#58;gk04.swt2.uta.edu&#39; and EndTime &#60; &#39;2011-04-19 20&#58;38&#58;06&#39; and  EndTime &#62;
&#39;2011-01-10 10&#58;04&#58;01&#39; and timestampdiff(minute,EndTime,ServerDate) &#62; 700 and
(CommonName like &#39;Generic%&#39; or CommonName = &#39;Unknown&#39;);

delete T
from ServiceLevel as T
, JobUsageRecord_Meta as M, JobUsageRecord as J where T.dbid = M.dbid and
M.dbid = J.dbid  and ProbeName = &#39;pbs&#58;gk04.swt2.uta.edu&#39; and EndTime &#60;
&#39;2011-04-19 20&#58;38&#58;06&#39; and  EndTime &#62; &#39;2011-01-10 10&#58;04&#58;01&#39; and
timestampdiff(minute,EndTime,ServerDate) &#62; 700 and (CommonName like
&#39;Generic%&#39; or CommonName = &#39;Unknown&#39;);
delete T
from PhaseResource as T
, JobUsageRecord_Meta as M, JobUsageRecord as J where T.dbid = M.dbid and
M.dbid = J.dbid  and ProbeName = &#39;pbs&#58;gk04.swt2.uta.edu&#39; and EndTime &#60;
&#39;2011-04-19 20&#58;38&#58;06&#39; and  EndTime &#62; &#39;2011-01-10 10&#58;04&#58;01&#39; and
timestampdiff(minute,EndTime,ServerDate) &#62; 700 and (CommonName like
&#39;Generic%&#39; or CommonName = &#39;Unknown&#39;);
delete T
from VolumeResource as T
, JobUsageRecord_Meta as M, JobUsageRecord as J where T.dbid = M.dbid and
M.dbid = J.dbid  and ProbeName = &#39;pbs&#58;gk04.swt2.uta.edu&#39; and EndTime &#60;
&#39;2011-04-19 20&#58;38&#58;06&#39; and  EndTime &#62; &#39;2011-01-10 10&#58;04&#58;01&#39; and
timestampdiff(minute,EndTime,ServerDate) &#62; 700 and (CommonName like
&#39;Generic%&#39; or CommonName = &#39;Unknown&#39;);
delete T
from ConsumableResource as T
, JobUsageRecord_Meta as M, JobUsageRecord as J where T.dbid = M.dbid and
M.dbid = J.dbid  and ProbeName = &#39;pbs&#58;gk04.swt2.uta.edu&#39; and EndTime &#60;
&#39;2011-04-19 20&#58;38&#58;06&#39; and  EndTime &#62; &#39;2011-01-10 10&#58;04&#58;01&#39; and
timestampdiff(minute,EndTime,ServerDate) &#62; 700 and (CommonName like
&#39;Generic%&#39; or CommonName = &#39;Unknown&#39;);
delete T
from Resource as T
, JobUsageRecord_Meta as M, JobUsageRecord as J where T.dbid = M.dbid and
M.dbid = J.dbid  and ProbeName = &#39;pbs&#58;gk04.swt2.uta.edu&#39; and EndTime &#60;
&#39;2011-04-19 20&#58;38&#58;06&#39; and  EndTime &#62; &#39;2011-01-10 10&#58;04&#58;01&#39; and
timestampdiff(minute,EndTime,ServerDate) &#62; 700 and (CommonName like
&#39;Generic%&#39; or CommonName = &#39;Unknown&#39;);

delete T
from JobUsageRecord_Xml as T
, JobUsageRecord_Meta as M, JobUsageRecord as J where T.dbid = M.dbid and
M.dbid = J.dbid  and ProbeName = &#39;pbs&#58;gk04.swt2.uta.edu&#39; and EndTime &#60;
&#39;2011-04-19 20&#58;38&#58;06&#39; and  EndTime &#62; &#39;2011-01-10 10&#58;04&#58;01&#39; and
timestampdiff(minute,EndTime,ServerDate) &#62; 700 and (CommonName like
&#39;Generic%&#39; or CommonName = &#39;Unknown&#39;);
delete T
from JobUsageRecord_Origin as T
, JobUsageRecord_Meta as M, JobUsageRecord as J where T.dbid = M.dbid and
M.dbid = J.dbid  and ProbeName = &#39;pbs&#58;gk04.swt2.uta.edu&#39; and EndTime &#60;
&#39;2011-04-19 20&#58;38&#58;06&#39; and  EndTime &#62; &#39;2011-01-10 10&#58;04&#58;01&#39; and
timestampdiff(minute,EndTime,ServerDate) &#62; 700 and (CommonName like
&#39;Generic%&#39; or CommonName = &#39;Unknown&#39;);

delete M,J
from JobUsageRecord_Meta as M, JobUsageRecord as J where M.dbid = J.dbid
and ProbeName = &#39;pbs&#58;gk04.swt2.uta.edu&#39; and EndTime &#60; &#39;2011-04-19 20&#58;38&#58;06&#39;
and  EndTime &#62; &#39;2011-01-10 10&#58;04&#58;01&#39; and
timestampdiff(minute,EndTime,ServerDate) &#62; 700 and (CommonName like
&#39;Generic%&#39; or CommonName = &#39;Unknown&#39;);

Cheers,
Philippe.

-- by Steve Timm

</div><script type='text/javascript'>
        $('#show_1947568608').click(function() {
            $('#detail_1947568608').slideDown("normal");
            $('#show_1947568608').hide();
            $('#hide_1947568608').show();
        });
        $('#hide_1947568608').click(function() {
            $('#detail_1947568608').slideUp();
            $('#hide_1947568608').hide();
            $('#show_1947568608').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='10403#1307124215'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-06-03T18:03:35+00:00">Jun 3, 2011 06:03 PM UTC</time><a class="anchor" name="1307124215">&nbsp;</a></div><pre>Date&#58; Tue, 24 May 2011 15&#58;24&#58;03 -0500
From&#58; Patrick McGuigan &#60;mcguigan@....&#62;
To&#58; Philippe Canal &#60;pcanal@....&#62;
Cc&#58; Steven Timm &#60;timm@....&#62;, gratia-operation@....,
karunach@...., weigand@...., mguigan@....
Subject&#58; Re&#58; gratia probes after OSG update (fwd)

Hi Philippe,

The duplicates were certainly sent before May 15.  I have not checked the
WLCG reported data since the 15th to see if the totals have been restated.

The probe&#39;s name should not have changed.  It is pbs&#58;gk04.swt2.uta.edu

Patrick

-- by Steve Timm</pre></div><div class='update_description'><i onclick="document.location='10403#1307124201'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-06-03T18:03:21+00:00">Jun 3, 2011 06:03 PM UTC</time><a class="anchor" name="1307124201">&nbsp;</a></div><pre>If you look at the text of the ticket there have been a lot of updates over
the course of weeks. I am not sure why you are saying there has been no response.

I will cut and paste a few other emails that have been exchanged outside of the ticket.
Date&#58; Tue, 24 May 2011 15&#58;01&#58;02 -0500
From&#58; Philippe Canal &#60;pcanal@....&#62;
To&#58; Steven Timm &#60;timm@....&#62;
Cc&#58; gratia-operation@...., karunach@...., weigand@....,
mguigan@....
Subject&#58; Re&#58; gratia probes after OSG update (fwd)

<font color='#7F7E6F'>&#62; The duplicate jobs showed up in the data sent to the WLCG for the monthly</font>
accounting updates for April.  Is this expected?

Yes, if they were uploaded before May 15.

<font color='#7F7E6F'>&#62; Should gratia be protected from duplicate entries?</font>

It is as long as it can safely tell they are duplicate.  Did you change the
name of the Probe?
If the Probe name has been changed, then the Collector has no way to know
that the data
was duplicate rather than old data being finally caught up.

As mentioned by Steve, the only way to properly handle this case is to also
bring
work the local state file.

Cheers,
Philippe.

-- by Steve Timm</pre></div><div class='update_description'><i onclick="document.location='10403#1307123798'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-06-03T17:56:38+00:00">Jun 3, 2011 05:56 PM UTC</time> by <b>Kyle Gross</b><a class="anchor" name="1307123798">&nbsp;</a></div><pre>There has been no response to this ticket since its generation.
Please send an update.

Please submit problems, requests, and questions at&#58;
<a href='https&#58;//ticket.grid.iu.edu/goc/open' target='_blank' rel='nofollow'>https&#58;//ticket.grid.iu.edu/goc/open</a>

OSG Grid Operations Center
goc@....,  317-278-9699
Visit the OSG Operations Page&#58;
<a href='http&#58;//osggoc.blogspot.com/' target='_blank' rel='nofollow'>http&#58;//osggoc.blogspot.com/</a></pre></div><div class='update_description'><i onclick="document.location='10403#1306274268'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-05-24T21:57:48+00:00">May 24, 2011 09:57 PM UTC</time><a class="anchor" name="1306274268">&nbsp;</a></div><pre>Hi Patrick,

Those are the only duplicate that made it to the WLCG.   However there are duplicates in the OSG
database going back to January 20th (i.e. 3 months old).

Philippe.

-- by Steve Timm</pre></div><div class='update_description'><i onclick="document.location='10403#1306273976'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-05-24T21:52:56+00:00">May 24, 2011 09:52 PM UTC</time><a class="anchor" name="1306273976">&nbsp;</a></div><pre>Hi Phillipe,

The jobs that were duplicated were jobs that finished between 4/1 and 4/19.  The OSG update was done on
4/19 and jobs after that date were only reported once.

Patrick

-- by Steve Timm</pre></div><div class='update_description'><i onclick="document.location='10403#1306273584'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-05-24T21:46:24+00:00">May 24, 2011 09:46 PM UTC</time><a class="anchor" name="1306273584">&nbsp;</a></div><pre>-- by Steve Timm</pre></div><div class='update_description'><i onclick="document.location='10403#1306273552'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-05-24T21:45:52+00:00">May 24, 2011 09:45 PM UTC</time><a class="anchor" name="1306273552">&nbsp;</a></div><pre>Hi Patrick,

Indeed there is a large number of duplicates&#58;

mysql&#62; select count(*) from JobUsageRecord_Meta M, JobUsageRecord J where M.dbid = J.dbid and ServerDate
<font color='#7F7E6F'>&#62; &#39;2011/04/01&#39; and ProbeName = &#39;pbs&#58;gk04.swt2.uta.edu&#39; and timestampdiff(minute,EndTime,ServerDate) &#62;</font>
18000;
+----------+
| count(*) |
+----------+
|   391372 |
+----------+

They can probably be removed ; however (and John and Karthik should confirm (or not)) the &#39;easy&#39;
deadline for restating the information to WLCG is passed (May 15), and so some effort will be needed to
fully resolved the situation.

Philippe.

-- by Steve Timm</pre></div><div class='update_description'><i onclick="document.location='10403#1306267541'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-05-24T20:05:41+00:00">May 24, 2011 08:05 PM UTC</time><a class="anchor" name="1306267541">&nbsp;</a></div><pre>From Philippe Canal

<font color='#7F7E6F'>&#62; The duplicate jobs showed up in the data sent to the WLCG for the monthly accounting updates for</font>
April.  Is this expected?

Yes, if they were uploaded before May 15.

<font color='#7F7E6F'>&#62; Should gratia be protected from duplicate entries?</font>

It is as long as it can safely tell they are duplicate.  Did you change the name of the Probe?
If the Probe name has been changed, then the Collector has no way to know that the data
was duplicate rather than old data being finally caught up.

As mentioned by Steve, the only way to properly handle this case is to also bring
work the local state file.

Cheers,
Philippe.

-- by Steve Timm</pre></div><div class='update_description'><i onclick="document.location='10403#1306265593'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-05-24T19:33:13+00:00">May 24, 2011 07:33 PM UTC</time><a class="anchor" name="1306265593">&nbsp;</a></div><pre>I&#39;ve filed INC84480 with our service desk to have them investigate why the
remedy ticket number is not getting sent back to  footprints, even though
the remedy incident is getting created corfrectly.

Steve Timm

-- by Steve Timm</pre></div><div class='update_description'><i onclick="document.location='10403#1306246506'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-05-24T14:15:06+00:00">May 24, 2011 02:15 PM UTC</time> by <b>Steven Timm</b><a class="anchor" name="1306246506">&nbsp;</a></div><pre>This ticket is in remedy, it&#39;s issue 84296--can you enter the remedy
number manually into footprints?

Steve Timm

On Tue, 24 May 2011, Open Science Grid FootPrints wrote&#58;

<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='10403#1306241349'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-05-24T12:49:09+00:00">May 24, 2011 12:49 PM UTC</time> by <b>Kyle Gross</b><a class="anchor" name="1306241349">&nbsp;</a></div><pre>Steve,

This ticket has been set up to get to Gratia just like other tickets, but for some reason, Remedy won&#39;t pick it up and return a ticket number.  Any suggestions?

-Kyle</pre></div><div class='update_description'><i onclick="document.location='10403#1305310989'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-05-13T18:23:09+00:00">May 13, 2011 06:23 PM UTC</time> by <b>Kyle Gross</b><a class="anchor" name="1305310989">&nbsp;</a></div><pre>This ticket didn&#39;t appear to route correctly to Gratia.  Perhaps was it because of the ticket exchange outage?</pre></div><div class='update_description'><i onclick="document.location='10403#1305282612'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-05-13T10:30:12+00:00">May 13, 2011 10:30 AM UTC</time> by <b>OSG RA</b><a class="anchor" name="1305282612">&nbsp;</a></div><pre>Adding Gratia SC to the ticket.</pre></div><div class='update_description'><i onclick="document.location='10403#1305251847'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-05-13T01:57:27+00:00">May 13, 2011 01:57 AM UTC</time> by <b>Jeremy Oakes</b><a class="anchor" name="1305251847">&nbsp;</a></div><pre>---------- Forwarded Message ----------
Date&#58; Thursday, May 12, 2011 9&#58;56 PM -0400
From&#58; OSG- Grid Operations Center &#60;goc@....&#62;
To&#58; Ruth Pordes &#60;ruth@....&#62;, Patrick McGuigan &#60;mcguigan@....&#62;, OSG Grid
Operations Center &#60;goc@....&#62;, Karthik Arunachalam
&#60;karunach@....&#62;, Steven Timm &#60;timm@....&#62;
Subject&#58; Re&#58; gratia probes after OSG update Issue=10403

Greetings,

Ticket 10403 has been created in response to your request and has been
assigned to OSG GOC support for investigation.

Thank You,
Jeremy Oakes</pre></div><div class='update_description'><i onclick="document.location='10403#1305251570'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-05-13T01:52:50+00:00">May 13, 2011 01:52 AM UTC</time> by <b>Jeremy Oakes</b><a class="anchor" name="1305251570">&nbsp;</a></div><pre>---------- Forwarded Message ----------
Date&#58; Thursday, May 12, 2011 8&#58;29 PM -0500
From&#58; Ruth Pordes &#60;ruth@....&#62;
To&#58; Patrick McGuigan &#60;mcguigan@....&#62;, OSG Grid Operations Center
&#60;goc@....&#62;, Karthik Arunachalam &#60;karunach@....&#62;, Steven Timm
&#60;timm@....&#62;
Subject&#58; Re&#58; gratia probes after OSG update

This should have a ticket opened at the operations center and be routed
to the gratia support center.

Thank you

Ruth

<font color='#7F7E6F'>&#62; From&#58; Patrick McGuigan &#60;mcguigan@....&#62;</font>
<font color='#7F7E6F'>&#62; Date&#58; Thu, 12 May 2011 16&#58;55&#58;41 -0500</font>
<font color='#7F7E6F'>&#62; To&#58; Steven Timm &#60;timm@....&#62;</font>
<font color='#7F7E6F'>&#62; Cc&#58; &#34;osg-general@....&#34;</font>
<font color='#7F7E6F'>&#62; &#60;osg-general@....&#62; Subject&#58; Re&#58; gratia probes after</font>
<font color='#7F7E6F'>&#62; OSG update</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; Thanks, Steve.</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; Some embedded comments.</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; Patrick</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; On 05/12/2011 04&#58;43 PM, Steven Timm wrote&#58;</font>
<font color='#7F7E6F'>&#62;&#62; On Thu, 12 May 2011, Patrick McGuigan wrote&#58;</font>
<font color='#7F7E6F'>&#62;&#62;</font>
<font color='#7F7E6F'>&#62;&#62;&#62; Hello,</font>
<font color='#7F7E6F'>&#62;&#62;&#62;</font>
<font color='#7F7E6F'>&#62;&#62;&#62; I recently updated the OSG stack on the gatekeeper of one of our</font>
<font color='#7F7E6F'>&#62;&#62;&#62; clusters. By update, I</font>
<div id='show_331944307' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_331944307'><font color='#7F7E6F'>&#62;&#62;&#62; mean a fresh version was installed in a new directory, the old</font>
<font color='#7F7E6F'>&#62;&#62;&#62; version was stopped, the</font>
<font color='#7F7E6F'>&#62;&#62;&#62; new version was configured and started. This sequence went well,</font>
<font color='#7F7E6F'>&#62;&#62;&#62; but there was a problem</font>
<font color='#7F7E6F'>&#62;&#62;&#62; with the gratia probe reporting after the change over. The new</font>
<font color='#7F7E6F'>&#62;&#62;&#62; gratia pbs probe went</font>
<font color='#7F7E6F'>&#62;&#62;&#62; back through too much old data and resent duplicate usage</font>
<font color='#7F7E6F'>&#62;&#62;&#62; information to the collector.</font>
<font color='#7F7E6F'>&#62;&#62;&#62;</font>
<font color='#7F7E6F'>&#62;&#62;&#62; Should gratia be protected from duplicate entries?</font>
<font color='#7F7E6F'>&#62;&#62;</font>
<font color='#7F7E6F'>&#62;&#62; Yes, but this operation depends on people setting the</font>
<font color='#7F7E6F'>&#62;&#62; OLD_VDT_LOCATION directory and bringing forward the</font>
<font color='#7F7E6F'>&#62;&#62; last-record-processed marker into the new gratia directory so it</font>
<font color='#7F7E6F'>&#62;&#62; doesn&#39;t go back again and fetch all jobs from time immemorial.</font>
<font color='#7F7E6F'>&#62;&#62;&#62;</font>
<font color='#7F7E6F'>&#62;&#62;&#62;</font>
<font color='#7F7E6F'>&#62;&#62;&#62; If not, what is the proper way to limit gratia&#39;s pbs probe so that</font>
<font color='#7F7E6F'>&#62;&#62;&#62; it stops processing</font>
<font color='#7F7E6F'>&#62;&#62;&#62; old jobs at a selectable date/or job?</font>
<font color='#7F7E6F'>&#62;&#62;</font>
<font color='#7F7E6F'>&#62;&#62; find that file in your old vdt location and bring it forward by hand.</font>
<font color='#7F7E6F'>&#62;&#62;</font>
<font color='#7F7E6F'>&#62; I will do that for the second cluster.</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;&#62; Until everyone learns to do that, the gratia collector is smart</font>
<font color='#7F7E6F'>&#62;&#62; enough to recognize that</font>
<font color='#7F7E6F'>&#62;&#62; it is getting duplicate records and fast enough to process them</font>
<font color='#7F7E6F'>&#62;&#62; again and throw them in</font>
<font color='#7F7E6F'>&#62;&#62; the duplicate records table as appropriate.</font>
<font color='#7F7E6F'>&#62;&#62;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; The duplicate jobs showed up in the data sent to the WLCG for the</font>
<font color='#7F7E6F'>&#62; monthly accounting</font>
<font color='#7F7E6F'>&#62; updates for April.  Is this expected?</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;&#62; It also helps to suppress unknown VO records because lots</font>
<font color='#7F7E6F'>&#62;&#62; of times an OSG gatekeeper is in front of a PBS cluster where</font>
<font color='#7F7E6F'>&#62;&#62; a lot of jobs are not from OSG, and that cuts the volume</font>
<font color='#7F7E6F'>&#62;&#62; significantly.</font>
<font color='#7F7E6F'>&#62;&#62;</font>
<font color='#7F7E6F'>&#62;&#62; Steve Timm</font>
<font color='#7F7E6F'>&#62;&#62;</font>
<font color='#7F7E6F'>&#62;&#62;&#62;</font>
<font color='#7F7E6F'>&#62;&#62;&#62; Regards,</font>
<font color='#7F7E6F'>&#62;&#62;&#62;</font>
<font color='#7F7E6F'>&#62;&#62;&#62; Patrick</font>
<font color='#7F7E6F'>&#62;&#62;&#62;</font>
<font color='#7F7E6F'>&#62;&#62;</font>

---------- End Forwarded Message ----------
</div><script type='text/javascript'>
        $('#show_331944307').click(function() {
            $('#detail_331944307').slideDown("normal");
            $('#show_331944307').hide();
            $('#hide_331944307').show();
        });
        $('#hide_331944307').click(function() {
            $('#detail_331944307').slideUp();
            $('#hide_331944307').hide();
            $('#show_331944307').show();
        });
        </script></pre></div>
</div>
<script type="text/javascript">
function reset_anchor() {
    $("#updates .selected").removeClass("selected");
    var urls = document.location.toString().split('#'); 
    var anchor = urls[1];
    if(anchor) {
        $("a[name='"+anchor+"']").parents(".update_description").addClass("selected");
    }
}
function submitspam(ticket_id) {
    myret = confirm("Would you like to close this ticket as a security ticket, and submit the ticket content to akismet?");
    if(myret == true) {
        $.ajax("viewer/processspam?id="+ticket_id).done(function() {
            window.location.reload();
        });
    }
}

$(function() {
    reset_anchor();
    var ADDITIONAL_COOKIE_NAME = 'gocticket';
    var options = { path: '/', expires: 365};

    if(window.opener && window.opener.name == "gocticket_list") {
        v = $.cookie("closewindow");
        if(!v) {
            $("#closewindow").attr("checked", "checked"); //on by default
        } else {
            if(v == "checked") {
                $("#closewindow").attr("checked", "checked");
            }
        }
        $("#closewindow").click(function() {
            $.cookie("closewindow", $(this).attr('checked'), options);
        });
    } else {
        $("#closewindow_area").hide();
    }
    function updateTimeago() {
        $("time").timeago();
        setTimeout(updateTimeago, 30*1000);
    }
    updateTimeago();
    $(".description").focus(expand_description);
});
</script>
<hr/>
<footer>
<p>GOC Ticket Version 2.2 | <a href="https://ticket.opensciencegrid.org/goc/submit?app_issue_check=on&amp;app_issue_type=goc&amp;app_goc_url=https%3A%2F%2Fticket.opensciencegrid.org%3A443%2F10403">Report Bugs</a>
 | <a href="https://github.com/opensciencegrid/operations/blob/master/docs/privacy.md">Privacy Policy</a>
</p>

<p> <img align="top" src="images/tag_orange.png"/> Copyright 2018 The Trustees of Indiana University - Developed for Open Science Grid</p>
</footer>


</div><!--container-fluid-->
<script>
//used by searchbox
function parseValue(value) {
    var obj = new Object();
    var tokens = value.split("\t");
    obj.str = tokens[0];
    obj.count = tokens[1];
    return obj;
}

$(function() {
    //bootstrap-2.0.4 stuff
    $(".alert-message").alert();
    $(".dropdown-toggle").dropdown();
    $("span[rel='tooltip']").tooltip();
    $("a[rel=popover]").popover();

    //activate menu that user is currently on
    $("#menu_navigator").addClass("active"); 
    $("#submenu_").addClass("active"); 

    //translate zend validation error message to bootstrap
    $(".errors").addClass("alert").addClass("alert-error");

});
</script>


</body>
