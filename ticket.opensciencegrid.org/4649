<!DOCTYPE html>
<html lang="en">
  <head>
  <base href="/">
    <title>[4649] UMilwaukee edg-mkgridmap Failing w/no errors</title>    <meta charset="utf-8" />
    <meta name="verify-v1" content="na5IcAJsZVOfEkboRxuIiZ1zpZgnZiWra+nKcS7nA/o=" />
    <meta name="google-site-verification" content="DLrk3ft4s8b-S2TloLCL2LD_t6wcTjgSluf5pmiu2kA" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />
    <link href="https://ticket.opensciencegrid.org/rss" rel="alternate" type="application/rss+xml" title="GOC Ticket Update feed" />

    <style type="text/css">
      body {
        padding-top: 50px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
     #search {
            width: 300px;
     }

    </style>

<script src="https://code.jquery.com/jquery-3.0.0.js"></script>
<script src="https://code.jquery.com/jquery-migrate-3.0.1.js"></script>

   <link href="//netdna.bootstrapcdn.com/bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet"/>
    <script src="//netdna.bootstrapcdn.com/bootstrap/2.3.2/js/bootstrap.min.js"></script>

    <link href="//netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"/>
    <link href="//ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/themes/smoothness/jquery-ui.min.css" rel="stylesheet"/>
 <script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>


    <link href="//cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/css/select2.min.css" rel="stylesheet" />
    <script src="//cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/js/select2.min.js"></script>

    <link href="css/ticket.css" rel="stylesheet" />
    <script src="lib/jquery.cookie.js"></script>

    <link href="images/tag_orange.png" rel="icon" type="image/png"/>
    <script src='https://www.google.com/recaptcha/api.js'></script>
  </head>

  <body>
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>

            <a class="brand" style="padding: 6px 0px 0px 6px;" href="http://opensciencegrid.org"><img src="https://ticket.opensciencegrid.org/images/osglogo.40x30.png"/></a>
            <ul class="nav">
                <li class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown">GOC Ticket <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    <li><a href="https://my.opensciencegrid.org">MyOSG</a></li>
                    <li><a href="https://oim.opensciencegrid.org">OIM</a></li>
                    <li class="active"><a href="index">Ticket</a></li>
	<li class="divider"></li>
	<li><a href="http://repo.grid.iu.edu">Repo</a></li>
	<li class="divider"></li>
	<li><a href="http://blogs.grid.iu.edu">Blog</a></li>
                    <li><a href="http://display.grid.iu.edu">Display</a></li>
                    <li><a href="http://osggoc.blogspot.com/">News</a></li>
                    </ul>
                </li>
            </ul>
            <ul class="nav pull-right">
                <li><a href="https://ticket.opensciencegrid.org/sso/">Login</a></li>            </ul>

            <div class="nav-collapse">
                <ul class="nav">
			 <li id="menu_submit"><a href="https://ticket.opensciencegrid.org/submit">Submit</a></li><li id="menu_view" class="dropdown"><a href="\#" class="dropdown-toggle" data-toggle="dropdown">View <b class="caret"></b></a><ul class="dropdown-menu"><li id="submenu_listopen"><a href="https://ticket.opensciencegrid.org/list/open">Open Tickets</a></li><li id="submenu_listrecentclose"><a href="https://ticket.opensciencegrid.org/list/recentclose">Recently Closed Tickets</a></li><li class="divider"></li><li id="submenu_alltickets"><a href="https://ticket.opensciencegrid.org/search?q=&amp;sort=id">All Tickets</a></li></ul></li>                </ul>

                <form class="navbar-search pull-right" action="viewer">
                    <input id="search" type="text" name="id" class="search-query span2" placeholder="Search Ticket" value=""/>
                </form>
            </div>
        </div>
      </div>
    </div>

<script type='text/javascript' src='lib/jquery.timeago.js'></script>
<script type='text/javascript' src='lib/byte2size.js'></script>
<style>
#updates .toolbar {
position: relative;
margin-top: 0px;
top: -10px;
font-weight: normal;
}
#updates a.anchor {
position: relative;
top: -50px;
}
#updates .selected pre {
animation:selected 2s;
animation-iteration-count: 2;
animation-direction: alternate;
-webkit-animation:selected 2s; 
-webkit-animation-iteration-count: 2;
-webkit-animation-direction: alternate;
box-shadow: inset 1px 1px 20px #9ad;
border: 1px solid #9ab;
margin: 5px 0px;
padding-left: 10px;
}
@keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ab;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
@-webkit-keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ad;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
#updates pre {
background-color: inherit;
line-height: 15px;
padding: 5px;
}
#updates .header {
color: #999;
}
#updates .update_history pre {
background-color: #eee;
color: #666;
font-size: 85%;
}
#updates .clickable {
cursor: pointer;
}
#updates .clickable:hover {
color: #D98719;
}
#updates .meta_information pre {
background-color: #fed;
}
#similar_tickets {
max-height: 300px;
overflow-y: auto;
pointer-events: none;
padding: 5px;
background-color: #f4f4f4;
}
.btn-toolbar {
margin-bottom: 0;
height: 30px;
}
#peers {
position: fixed;
bottom: 0px;
right: 0px;
z-index: 100;
list-style: none;
padding: 5px 0px 0px 5px;
margin: 0px;
background-color: white;
box-shadow: 0px 0px 10px white;
}
#peers li {
background-color: #ccc;
color: #000;
display: inline-block;
padding: 5px 10px;
margin-right: 5px;
position: relative;
}
/*
#peers li:hover {
background-color: #999;
cursor: pointer;
}
*/
#peers span.ip {
padding-left: 5px;
color: #666;
}
#peers .new {
bottom: -30px;
}
/*
#peers .me {
background-color: red;
}
*/
</style>

<div class="container-fluid">
<ul id="peers"></ul>
<div class="alert alert-danger"><a class="close" href="#" data-dismiss="alert">&times;</a>By the end of May 2018, the ticketing system at https://ticket.opensciencegrid.org will be retired and support will be provided at https://support.opensciencegrid.org. Throughout this transition the support email (help@opensciencegrid.org) will be available as a point of contact.<br><br>                                                   
                                                                                                                                                                                   
Please see the service migration page for details: https://opensciencegrid.github.io/technology/policy/service-migrations-spring-2018/#ticket</div><div id="presence" class="pull-right"></div><div class="ticketgui"><script type="text/javascript" src="https://ticket.opensciencegrid.org/lib/checktab.js"></script>

<script>
var expanded = false;
function expand_description() {
    var desc = $(".description");
    if(!expanded) {
        expanded = true;
        //expand to minheight
        var min = 250;
        if(desc.height() < min) {
            desc.animate({height: min}, 200);
        }
    }
}

$(document).ready(function() {
    $("input[name='nad']").datepicker({
        dateFormat: 'yy-mm-dd'
    });
});

</script>



<style>
.form-horizontal .control-label {
padding-top: inherit;
font-size:90%;
color:#666;
}
label {
margin-bottom: 0px;
}
.controls {
line-height: 18px;
}
</style>
<form class="form-horizontal" action="https://ticket.opensciencegrid.org/viewer/updatebasic?id=4649" method="post">
<div class="page-header">
    <h3><span class="muted">4649</span> / UMilwaukee edg-mkgridmap Failing w/no errors</h3>
</div>

<div class="row-fluid">
<div class="span5">
    <legend>Contact</legend>
    <div class="control-group">
        <label class="control-label">Full Name</label>
        <div class="controls">Brian Moe</div>
    </div>
    <div class="control-group">
        <label class="control-label">Email</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">Phone</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">CC</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>

    <legend>Details</legend>
    
    <div class="control-group">
        <label class="control-label">Ticket Type</label>
        <div class="controls">Problem/Request</div>
    </div>
    <div class="control-group">
        <label class="control-label">Priority</label>
        <div class="controls">Normal</div>
    </div>
    <div class="control-group">
        <label class="control-label">Status</label>
        <div class="controls">
Closed</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action</label>
        <div class="controls">Closed</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action Deadline</label>
        <div class="controls flag_red">2008-03-27</div>
    </div>

</div><!--span-->
<div class="span7">
    <legend>Assignees</legend>
        <br>

    <legend>Assignees</legend>
    TODO
    <br>

    <style>
legend.noborder {
border-bottom: none;
}
</style>

<div id="attachment-list"/>
<script>
$(function () {
    var first = true;
    $.getJSON("https://ticket.opensciencegrid.org/attachment/list?id=4649", function (files) {
        //console.dir(files);
        var html = "<table class=\"table table-condensed\">";
        $(files).each(function() {
            if(first) {
                first = false;
                html += "<legend class=\"noborder\">Attachmenets</legend>";
            }
            html += "<tr class=\"attachment\">";
            html += "<td><img src=\""+this.thumbnail_url+"\"/></td>";
            html += "<td><a href=\""+this.url+"\" target=\"_blank\">"+this.name+"</a></td>";
            html += "<td>"+bytesToSize(this.size, 1)+"</td>";
            html += "</tr>";
        });
        html += "</table>";
        $("#attachment-list").html(html);
    });
});

function download(url) {
    window.open(url, "_blank");
}
</script>


</div><!--span-->
</div><!--row-fluid-->


</form>

</div>
<div id="updates" style="clear: both;">
    <legend>Past Updates
    <div class="btn-toolbar pull-right toolbar">
        <div class="btn-group">
                <a class="btn btn-small" href="/4649?sort=up&"><i class="icon-arrow-up"></i> Sort</a>

        
        <a class="btn btn-small" href="/4649?expandall=true&">Expand Descriptions</a>        <a class="btn btn-small" target="_blank" href="mailto:osg@tick.globalnoc.iu.edu?subject=Open%20Science%20Grid%3A%20UMilwaukee%20edg-mkgridmap%20Failing%20w%2Fno%20errors%20ISSUE%3D4649%20PROJ%3D71"><i class="icon-envelope"></i> Update w/Email</a>
        </div>
    </div><!--btn-toolbar-->
    </legend>

    <div class='update_description'><i onclick="document.location='4649#1206718789'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2008-03-28T15:39:49+00:00">Mar 28, 2008 03:39 PM UTC</time> by <b>Tim Silvers</b><a class="anchor" name="1206718789">&nbsp;</a></div><pre>&#34;Is my reading correct that this problem seems to have disappeared for
the moment? But we should all be alert for further problems that need
to be debugged?&#34;

Alain, yes, you are correct.

Thank you,

Tim</pre></div><div class='update_description'><i onclick="document.location='4649#1206717011'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2008-03-28T15:10:11+00:00">Mar 28, 2008 03:10 PM UTC</time> by <b>VDT</b><a class="anchor" name="1206717011">&nbsp;</a></div><pre>My attention has dropped, due to the impending VDT release.

Is my reading correct that this problem seems to have disappeared for
the moment? But we should all be alert for further problems that need
to be debugged?

Thanks,
-alain

--
View ticket at &#60;<a href='http&#58;//vdt.cs.wisc.edu/rt/Ticket/Display.html?user=guest&pass=guest&id=3333&#62' target='_blank' rel='nofollow'>http&#58;//vdt.cs.wisc.edu/rt/Ticket/Display.html?user=guest&pass=guest&id=3333&#62</a>;
VDT Support, vdt-support@....</pre></div><div class='update_description'><i onclick="document.location='4649#1206638195'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2008-03-27T17:16:35+00:00">Mar 27, 2008 05:16 PM UTC</time> by <b>Tim Silvers</b><a class="anchor" name="1206638195">&nbsp;</a></div><pre>Hi Brian,

I&#39;ve been watching things and edg-mkgridmap is working normally now. I&#39;m not sure what was
causing the issue. We narrowed it down to CDF but I don&#39;t know what was going on at that end to
cause the issue. The VDT ticket remains open and they can investigate further and possibly look at
correcting any bugs with the script. And there is also the issue with the log timestamps. Both issues
are now in their court and I&#39;m going to close the GOC ticket. As they update their ticket (3333)
their update will be appended to this ticket and mailed to you and I. If you have any questions, let
me know.

Thank you,
Tim Silvers
OSG Grid Operations Center
goc@...., 317-278-9699
Visit the OSG Support Page&#58;
<a href='http&#58;//www.opensciencegrid.org/ops' target='_blank' rel='nofollow'>http&#58;//www.opensciencegrid.org/ops</a>
RSS&#58; <a href='http&#58;//www.grid.iu.edu/news' target='_blank' rel='nofollow'>http&#58;//www.grid.iu.edu/news</a></pre></div><div class='update_description'><i onclick="document.location='4649#1205949534'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2008-03-19T17:58:54+00:00">Mar 19, 2008 05:58 PM UTC</time> by <b>Tim Silvers</b><a class="anchor" name="1205949534">&nbsp;</a></div><pre>Hi Brian,

In response...

&#34;A few semi-unrelated things I saw while looking at the logs&#58;
($VDT_LOCATION//edg/log//edg-mkgridmap.log)

(1) We&#39;re not getting GROW users. Some certificate verification problem.
Is that just us? It&#39;s been going on for quite a while, apparently.&#34;

That&#39;s normal. They&#39;ll be removed from the template soon. They&#39;re no longer members of the OSG
and they also fail on VOMS Monitor (all known issues have been corrected with that service, so you
can always check there for further validation). --Tim

&#34;(2) Bad DNs? Do these get detected and corrected elsewhere?&#34;

Not to my knowledge. Are you talking about that first one from CDF which has the tab or spaces in
it? It&#39;s funny b/c if I go to their VOMS I don&#39;t see that&#58;

<a href='https&#58;//voms.cnaf.infn.it&#58;8443/voms/cdf/services/VOMSCompatibility?method=getGridmapUsers' target='_blank' rel='nofollow'>https&#58;//voms.cnaf.infn.it&#58;8443/voms/cdf/services/VOMSCompatibility?method=getGridmapUsers</a>

Maybe the VDT can help us with that one (regarding error checking). The problem with that DN
itself will likely need to fall back to CDF. --Tim

&#34;(3) Some of the logged messages have timestamps that are off by a month.
I don&#39;t really care, but maybe someone would like to know this.&#34;

Yes. I see this in my logs too. In fact, there are jumps!! Here is an example...

2008-03-10T11-08-24 New grid-mapfile is same as old one&#58; will not replace old one.
2008-02-10T11-08-25 #######################
2008-02-10T11-08-25 Running generate-vo-map
2008-02-10T11-08-25 Reading from &#39;/usr/local/osg-0.7.0/edg/etc/edg-mkgridmap.conf&#39;, writin
g to &#39;/usr/local/osg-0.7.0/monitoring/osg-user-vo-map.txt.new&#39;
2008-02-10T11-08-25 #####################
<div id='show_1652130793' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_1652130793'>2008-02-10T11-08-25 Starting check-vo-map
2008-02-10T11-08-25 Reading from &#39;/usr/local/osg-0.7.0/monitoring/osg-user-vo-map.txt.new&#39;
, writing to &#39;/usr/local/osg-0.7.0/monitoring/osg-user-vo-map.txt&#39;
2008-02-10T11-08-26 VO-map is same, leaving /usr/local/osg-0.7.0/monitoring/osg-user-vo-ma
p.txt untouched
2008-03-10T11-08-29 Finished edg-mkgridmap
2008-03-10T11-08-29 =======================

Thanks for pointing out these issues. The VDT is assigned to the ticket, so they&#39;ll receive these
updates.

Tim
OSG GOC
</div><script type='text/javascript'>
        $('#show_1652130793').click(function() {
            $('#detail_1652130793').slideDown("normal");
            $('#show_1652130793').hide();
            $('#hide_1652130793').show();
        });
        $('#hide_1652130793').click(function() {
            $('#detail_1652130793').slideUp();
            $('#hide_1652130793').hide();
            $('#show_1652130793').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='4649#1205945528'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2008-03-19T16:52:08+00:00">Mar 19, 2008 04:52 PM UTC</time> by <b>Brian Moe</b><a class="anchor" name="1205945528">&nbsp;</a></div><pre>Hi Tim,

I put CDF back into edg-mkgridmap.conf, ran edg-mkgridmap and it ran without
the original &#39;Can&#39;t call method &#34;getData&#34;&#39; error.  CDF users now appear
in our grid-mapfile and edg-mkgridmap is no longer failing on the CDF VO.

A few semi-unrelated things I saw while looking at the logs&#58;
($VDT_LOCATION//edg/log//edg-mkgridmap.log)

(1) We&#39;re not getting GROW users.  Some certificate verification problem.
Is that just us?  It&#39;s been going on for quite a while, apparently.

(2) Bad DNs?  Do these get detected and corrected elsewhere?

(3) Some of the logged messages have timestamps that are off by a month.
I don&#39;t really care, but maybe someone would like to know this.

This is the output from today&#39;s run&#58;  (old logs logs similar)

2008-03-19T11-10-04 =======================
2008-03-19T11-10-05 Running edg-mkgridmap
voms search(<a href='https&#58;//grow-voms.its.uiowa.edu&#58;8443/edg-voms-admin/grow/services/VOMSCompatibility?method=getGridmapUsers' target='_blank' rel='nofollow'>https&#58;//grow-voms.its.uiowa.edu&#58;8443/edg-voms-admin/grow/services/VOMSCompatibility?method=getGridmapUsers</a>)&#58; SSL negotiation failed&#58; error&#58;1407E086&#58;SSL routines&#58;SSL2_SET_CERTIFICATE&#58;certificate verify failed

skipping DN with embedded quoting character &#39;&#34;/C=US/O=National Center for Supercomputing Applications/OU=People/CN=Doru I Marcus&#34;&#39;

skipping DN with embedded quoting character &#39;&#34;/C=US/O=National Center for Supercomputing Applications/CN=Doru I Marcusiu&#34;&#39;

skipping DN with embedded quoting character &#39;&#34;/DC=org/DC=doegrids/OU=People/CN=Shaowen Wang 342981&#34;&#39;

Exit with error(s) (code=65)
2008-03-19T11-10-42 Have new grid-mapfile, updating.
2008-03-19T11-10-42 Old grid-mapfile backed up as&#58; /etc/grid-security/grid-mapfile.backups/grid-mapfile.2008-03-19T11-10-42
2008-03-19T11-10-42 ... removed old backup file&#58; /etc/grid-security/grid-mapfile.backups/grid-mapfile.2008-03-16T10-19-32
2008-02-19T11-10-43 #######################
2008-02-19T11-10-43 Running generate-vo-map
<div id='show_1509683839' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_1509683839'>2008-02-19T11-10-43 Reading from &#39;/opt/osg/grid/edg/etc/edg-mkgridmap.conf&#39;, writing to &#39;/opt/osg/grid/monitoring/osg-user-vo-map.txt.new&#39;
2008-02-19T11-10-44 #####################
2008-02-19T11-10-44 Starting check-vo-map
2008-02-19T11-10-44 Reading from &#39;/opt/osg/grid/monitoring/osg-user-vo-map.txt.new&#39;, writing to &#39;/opt/osg/grid/monitoring/osg-user-vo-map.txt&#39;
2008-02-19T11-10-52 Eliminating account &#39;sbgrid&#39; which doesn&#39;t exist (used by VO &#39;SBGrid&#39;).
2008-02-19T11-10-52 Eliminating account &#39;cigi&#39; which doesn&#39;t exist (used by VO &#39;CIGI&#39;).
2008-02-19T11-10-53 VO-map is different, copying new version to /opt/osg/grid/monitoring/osg-user-vo-map.txt
2008-03-19T11-11-51 Finished edg-mkgridmap
2008-03-19T11-11-51 =======================

So are any of these ticket-worthy?  I&#39;m thinking the GROW problem might
be a serious one... there *are* some (8) grow users in the grid-mapfile though...

Brian

On Wed, Mar 19, 2008 at 12&#58;49&#58;00PM +0000, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font>
</div><script type='text/javascript'>
        $('#show_1509683839').click(function() {
            $('#detail_1509683839').slideDown("normal");
            $('#show_1509683839').hide();
            $('#hide_1509683839').show();
        });
        $('#hide_1509683839').click(function() {
            $('#detail_1509683839').slideUp();
            $('#hide_1509683839').hide();
            $('#show_1509683839').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='4649#1205930959'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2008-03-19T12:49:19+00:00">Mar 19, 2008 12:49 PM UTC</time> by <b>Tim Silvers</b><a class="anchor" name="1205930959">&nbsp;</a></div><pre>Hi Brian,

I&#39;ve noticed that my ITB node is pulling a grid-mapfile with no errors. And VOMS Monitor is now
reporting the correct number of DNs, as is my ITB node&#58;

[root@itb-zero osg-0.7.0]# grep &#39; ligo&#39; /etc/grid-security/grid-mapfile | wc -l
209

And my other ITB node reports the same. One node is running VDT version 1.8.1a and EDG Make
Gridmap 2.9.0 while the other is running VDT version 1.8.1h and EDG Make Gridmap 3.0.0. Again,
both work fine. So whatever problem there was appears to have cleared up. Could you try it again
from you end?

Thanks,

Tim
OSG GOC</pre></div><div class='update_description'><i onclick="document.location='4649#1205784562'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2008-03-17T20:09:22+00:00">Mar 17, 2008 08:09 PM UTC</time> by <b>Tim Silvers</b><a class="anchor" name="1205784562">&nbsp;</a></div><pre>Hi. As an update, I did mention this issue at today&#39;s Operations call. I notified the admins VO/SC
contacts that they should check their grid-mapfiles because they may not be getting updated. No one
had any feedback.

The VDT has an open ticket. No update yet.

Tim</pre></div><div class='update_description'><i onclick="document.location='4649#1204296853'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2008-02-29T14:54:13+00:00">Feb 29, 2008 02:54 PM UTC</time> by <b>Tim Silvers</b><a class="anchor" name="1204296853">&nbsp;</a></div><pre>Hi. I tested this on my two ITB nodes, one running 0.6.0 and one running 0.8.0, and I can verify
you&#39;re correct. Looking at the CDF VOMS, I see that their certificate is not a DOEGrids cert, it&#39;s an
INFN CA cert. Perhaps that is causing the edg-mkgridmap script to choke. But it expires soon, so it
has been on the server for a while, almost a year given it expires March 4 2008. So why is it just
recently causing issues? A change in edg-mkgridmap?

In testing I tried a conf file with just CDF and it failed, nothing was returned. Then I used a conf
file with just Fermilab&#39;s VOMS, I got a response with data. So then I put them together in the conf
file, with CDF first, I got nothing. The script appears to choke on CDF and then dies. Again, in the
edg-mkgridmap.log&#58;

Can&#39;t call method &#34;getData&#34; on an undefined value at /usr/local/osg-0.7.1/edg/libexec/edg-
mkgridmap/edg-mkgridmap.pl line 686.

But it gets better. I put Fermilab before CDF and I got DNs for CDF and Fermilab. Then I changed
the configuration file again so that CDF was first, Fermilab second. And now it works! Yes, the
same configuration that wasn&#39;t working a moment ago, now works! Very odd. I have no idea how to
explain why.

Tim
OSG GOC

PS Good work, Brian!</pre></div><div class='update_description'><i onclick="document.location='4649#1204151289'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2008-02-27T22:28:09+00:00">Feb 27, 2008 10:28 PM UTC</time> by <b>Brian Moe</b><a class="anchor" name="1204151289">&nbsp;</a></div><pre>I think I found the problem.

If I comment out the cdf vo&#58;

#group vomss&#58;//voms.cnaf.infn.it&#58;8443/voms/cdf cdf

in&#58;

$VDT_LOCATION/edg/etc/edg-mkgridmap.conf

Then the grid-mapfile updates just fine.  Is this VOMS working properly?

Brian

On Wed, Feb 27, 2008 at 03&#58;14&#58;00PM +0000, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='4649#1204125294'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2008-02-27T15:14:54+00:00">Feb 27, 2008 03:14 PM UTC</time> by <b>Tim Silvers</b><a class="anchor" name="1204125294">&nbsp;</a></div><pre>Alain,

Steve Gallo from GRASE has also now discovered this issue on his node(s). I&#39;ve pasted in the
details from the linked Footprints ticket (4668)...

Hello,

Our grid-mapfile stopped updating on Feb 18th. I&#39;m seeing an error in
edg-mkgridmap.pl line 686 in the log files, and no new grid-mapfile is
generated when I run edg-mkgridmap. Commands and log output below.

Thanks,
Steve

(smgallo@u2-grid)u2 &#58;&#62;sudo /san/projects1/grid/osg-0.8.0/edg/sbin/edg-mkgridmap
(smgallo@u2-grid)u2 &#58;&#62;cat /san/projects1/grid/osg-0.8.0/edg/log/edg-mkgridmap.log
2008-02-26T11-03-45 =======================
2008-02-26T11-03-45 Running edg-mkgridmap
Can&#39;t call method &#34;getData&#34; on an undefined value at
/san/projects1/grid/osg-0.8.0/edg/libexec/edg-mkgridmap/edg-mkgridmap.pl line 686.
2008-02-26T11-03-55 Have new grid-mapfile, updating.
2008-01-26T11-03-59 #######################
2008-01-26T11-03-59 Running generate-vo-map
2008-01-26T11-03-59 Reading from &#39;/san/projects1/grid/osg-0.8.0/edg/etc/edg-mkgridmap.conf&#39;,
writing to
&#39;/san/projects1/grid/osg-0.8.0/monitoring/osg-user-vo-map.txt.new&#39;
2008-01-26T11-04-01 #####################
2008-01-26T11-04-01 Starting check-vo-map
2008-01-26T11-04-01 Reading from &#39;/san/projects1/grid/osg-0.8.0/monitoring/osg-user-vo-
map.txt.new&#39;, writing to
&#39;/san/projects1/grid/osg-0.8.0/monitoring/osg-user-vo-map.txt&#39;
2008-01-26T11-04-34 VO-map is same, leaving /san/projects1/grid/osg-0.8.0/monitoring/osg-user-
vo-map.txt untouched
2008-02-26T11-07-21 Finished edg-mkgridmap
2008-02-26T11-07-22 =======================
<div id='show_586348172' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_586348172'>
(smgallo@u2-grid)grid-security &#58;&#62;ls -ld grid-mapfile*
-rw-r--r-- 1 root root 779379 Feb 25 13&#58;23 grid-mapfile-
drwxr-xr-x 2 root root 4096 Feb 18 09&#58;02 grid-mapfile.backups/
-rw-r--r-- 1 root root 0 Feb 26 11&#58;03 grid-mapfile.last_checked

--
Steve Gallo
Lead Software Engineer / Database Administrator
smgallo@....
Center for Computational Research
New York State Center of Excellence in Bioinformatics &amp; Life Sciences
University at Buffalo, The State University of New York
701 Ellicott Street, Buffalo, NY 14203
716-881-8960
</div><script type='text/javascript'>
        $('#show_586348172').click(function() {
            $('#detail_586348172').slideDown("normal");
            $('#show_586348172').hide();
            $('#hide_586348172').show();
        });
        $('#hide_586348172').click(function() {
            $('#detail_586348172').slideUp();
            $('#hide_586348172').hide();
            $('#show_586348172').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='4649#1204042688'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2008-02-26T16:18:08+00:00">Feb 26, 2008 04:18 PM UTC</time> by <b>VDT</b><a class="anchor" name="1204042688">&nbsp;</a></div><pre>I&#39;m in all-day meetings, so I can&#39;t debug further today.

When I said there were known bugs, I was talking about older versions,
not OSG 0.8.

-alain

--
View ticket at &#60;<a href='http&#58;//vdt.cs.wisc.edu/rt/Ticket/Display.html?user=guest&pass=guest&id=3333&#62' target='_blank' rel='nofollow'>http&#58;//vdt.cs.wisc.edu/rt/Ticket/Display.html?user=guest&pass=guest&id=3333&#62</a>;
VDT Support, vdt-support@....</pre></div><div class='update_description'><i onclick="document.location='4649#1204036505'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2008-02-26T14:35:05+00:00">Feb 26, 2008 02:35 PM UTC</time> by <b>Tim Silvers</b><a class="anchor" name="1204036505">&nbsp;</a></div><pre>Alain,

On my ITB node running the 0.8.0 package (actually the ITB package 0.7.1) I get the same errors.
I moved the grid-mapfile and ran edg-mkgridmap...

# edg-mkgridmap
mv&#58; cannot stat &#96;/etc/grid-security/grid-mapfile.new&#39;&#58; No such file or directory

Then I touched a grid-mapfile, creating the file with zero size, and still it pulled nothing. The log
only has two entries...

2008-02-26T14-22-51 Finished edg-mkgridmap
2008-02-26T14-22-51 =======================

But looking at the directory...

-rw-r--r-- 1 root   root   706199 Feb  6 21&#58;41 grid-mapfile.MOVED_FOR_TESTING
-rw-r--r-- 1 root   root     1061 Feb 18 20&#58;47 prima-authz.conf
-rw-r--r-- 1 root   root      100 Feb 18 20&#58;47 RENAME-ME_gsi-authz.conf
-rw-r--r-- 1 root   root        0 Feb 26 14&#58;22 grid-mapfile
-rw-r--r-- 1 root   root        0 Feb 26 14&#58;22 grid-mapfile.last_checked

It just sees that there is a new file for today so it didn&#39;t get a new grid-mapfile. You mentioned
that the version of edg-mkgridmap in the 0.8.0 release has known bugs. Can you elaborate? I&#39;ve
seen bugs with it even in 0.6.0, such as flags not working, like verbose. I just tried the --help and -
-version flags, to which edg-mkgridmap paused, but gave me no output. And I&#39;ve seen issues with
this while testing the version on VOMS Monitor. Is there a new package we should download which
could assist us in diagnosing these issues?

Thanks,
Tim
OSG GOC</pre></div><div class='update_description'><i onclick="document.location='4649#1203996788'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2008-02-26T03:33:08+00:00">Feb 26, 2008 03:33 AM UTC</time> by <b>VDT</b><a class="anchor" name="1203996788">&nbsp;</a></div><pre><font color='#7F7E6F'>&#62; If I move the grid-mapfile out of the way, things actually seem worse&#58;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;    [root@nest ~]# cd /etc/grid-security</font>
<font color='#7F7E6F'>&#62;    [root@nest grid-security]# mv grid-mapfile grid-mapfile.sav</font>
<font color='#7F7E6F'>&#62;    [root@nest grid-security]# edg-mkgridmap</font>
<font color='#7F7E6F'>&#62;    mv&#58; cannot stat &#96;/etc/grid-security/grid-mapfile.new&#39;&#58; No such</font>
<font color='#7F7E6F'>&#62; file or directory</font>
<font color='#7F7E6F'>&#62;    [root@nest grid-security]# ls grid-mapfile</font>
<font color='#7F7E6F'>&#62;    ls&#58; grid-mapfile&#58; No such file or directory</font>

The correct edg-mkgridmap was in your PATH? I don&#39;t think it&#39;s set up
in the VDT by default. But in any case, that is really strange.

I can&#39;t explain what you are seeing. As I noted before, it worked on
my test setup.

If you like, I can try to interactively debug on your computer. Is
that a possibility? It will be a day or two before I can do it&#58; I&#39;m in
meetings all day on Tuesday.

-alain

--
View ticket at &#60;<a href='http&#58;//vdt.cs.wisc.edu/rt/Ticket/Display.html?user=guest&pass=guest&id=3333&#62' target='_blank' rel='nofollow'>http&#58;//vdt.cs.wisc.edu/rt/Ticket/Display.html?user=guest&pass=guest&id=3333&#62</a>;
VDT Support, vdt-support@....</pre></div><div class='update_description'><i onclick="document.location='4649#1203967809'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2008-02-25T19:30:09+00:00">Feb 25, 2008 07:30 PM UTC</time> by <b>Brian Moe</b><a class="anchor" name="1203967809">&nbsp;</a></div><pre>Hi Alain,

We&#39;re using OSG 0.8.0.

If I move the grid-mapfile out of the way, things actually seem worse&#58;

[root@nest ~]# cd /etc/grid-security
[root@nest grid-security]# mv grid-mapfile grid-mapfile.sav
[root@nest grid-security]# edg-mkgridmap
mv&#58; cannot stat &#96;/etc/grid-security/grid-mapfile.new&#39;&#58; No such file or directory
[root@nest grid-security]# ls grid-mapfile
ls&#58; grid-mapfile&#58; No such file or directory

Here&#39;s the crontab line&#58;

19 4,10,16,22 * * * /opt/osg/grid/edg/sbin/edg-mkgridmap &#62;&#62; /opt/osg/grid/edg/log/edg-mkgridmap.log 2&#62;&1

As for the logs, here is today&#39;s log in its entirety&#58;

[root@nest log]# cat edg-mkgridmap.log
2008-02-25T04-19-01 =======================
2008-02-25T04-19-01 Running edg-mkgridmap
Can&#39;t call method &#34;getData&#34; on an undefined value at /opt/osg/grid/edg/libexec/edg-mkgridmap/edg-mkgridmap.pl line 685.
2008-02-25T04-19-04 New grid-mapfile is same as old one&#58; will not replace old one.
2008-01-25T04-19-04 #######################
2008-01-25T04-19-04 Running generate-vo-map
2008-01-25T04-19-04 Reading from &#39;/opt/osg/grid/edg/etc/edg-mkgridmap.conf&#39;, writing to &#39;/opt/osg/grid/monitoring/osg-user-vo-map.txt.new&#39;
2008-01-25T04-19-04 #####################
2008-01-25T04-19-04 Starting check-vo-map
2008-01-25T04-19-04 Reading from &#39;/opt/osg/grid/monitoring/osg-user-vo-map.txt.new&#39;, writing to &#39;/opt/osg/grid/monitoring/osg-user-vo-map.txt&#39;
2008-01-25T04-19-05 Eliminating account &#39;sbgrid&#39; which doesn&#39;t exist (used by VO &#39;SBGrid&#39;).
2008-01-25T04-19-05 Eliminating account &#39;cigi&#39; which doesn&#39;t exist (used by VO &#39;CIGI&#39;).
2008-01-25T04-19-05 VO-map is same, leaving /opt/osg/grid/monitoring/osg-user-vo-map.txt untouched
2008-02-25T04-19-32 Finished edg-mkgridmap
2008-02-25T04-19-32 =======================
<div id='show_1913279592' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_1913279592'>2008-02-25T10-19-02 =======================
2008-02-25T10-19-02 Running edg-mkgridmap
Can&#39;t call method &#34;getData&#34; on an undefined value at /opt/osg/grid/edg/libexec/edg-mkgridmap/edg-mkgridmap.pl line 685.
2008-02-25T10-19-07 New grid-mapfile is same as old one&#58; will not replace old one.
2008-01-25T10-19-07 #######################
2008-01-25T10-19-07 Running generate-vo-map
2008-01-25T10-19-07 Reading from &#39;/opt/osg/grid/edg/etc/edg-mkgridmap.conf&#39;, writing to &#39;/opt/osg/grid/monitoring/osg-user-vo-map.txt.new&#39;
2008-01-25T10-19-07 #####################
2008-01-25T10-19-07 Starting check-vo-map
2008-01-25T10-19-07 Reading from &#39;/opt/osg/grid/monitoring/osg-user-vo-map.txt.new&#39;, writing to &#39;/opt/osg/grid/monitoring/osg-user-vo-map.txt&#39;
2008-01-25T10-19-11 Eliminating account &#39;sbgrid&#39; which doesn&#39;t exist (used by VO &#39;SBGrid&#39;).
2008-01-25T10-19-11 Eliminating account &#39;cigi&#39; which doesn&#39;t exist (used by VO &#39;CIGI&#39;).
2008-01-25T10-19-11 VO-map is same, leaving /opt/osg/grid/monitoring/osg-user-vo-map.txt untouched
2008-02-25T10-19-42 Finished edg-mkgridmap
2008-02-25T10-19-42 =======================

Brian

On Fri, Feb 22, 2008 at 07&#58;51&#58;00PM +0000, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font>
</div><script type='text/javascript'>
        $('#show_1913279592').click(function() {
            $('#detail_1913279592').slideDown("normal");
            $('#show_1913279592').hide();
            $('#hide_1913279592').show();
        });
        $('#hide_1913279592').click(function() {
            $('#detail_1913279592').slideUp();
            $('#hide_1913279592').hide();
            $('#show_1913279592').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='4649#1203709868'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2008-02-22T19:51:08+00:00">Feb 22, 2008 07:51 PM UTC</time> by <b>VDT</b><a class="anchor" name="1203709868">&nbsp;</a></div><pre>Brian--

Can you send a larger chunk of the $VDT_LOCATION/edg/log/edg-mkgridmap.log?

I looked at your VOMS web site and verified that the users you listed as
being missing are in the VO. That&#39;s good.

What happens if you move the gridmap file out of the way, then run
edg-mkgridmap manually? (Look in root&#39;s crontab to see how it is
invoked.) Do you get more complete results?

I just ran edg-mkgridmap against the LIGO VO, and I got 205 results,
including the two you mentioned&#58;

&#34;/DC=org/DC=doegrids/OU=People/CN=Amber Stuver 384685&#34;
&#34;/DC=org/DC=doegrids/OU=People/CN=Doichin Denchev 327684&#34;

What version of the VDT are you using for edg-mkgridmap? It&#39;s OSG 0.8,
right? If so, that excludes the possibility of you running an older
version that has known bugs.

-alain

-----------------------------------------------------------------
Alain Roy                         vdt-support@....
VDT Support                   <a href='http&#58;//vdt.cs.wisc.edu/support.html' target='_blank' rel='nofollow'>http&#58;//vdt.cs.wisc.edu/support.html</a>

--
View ticket at &#60;<a href='http&#58;//vdt.cs.wisc.edu/rt/Ticket/Display.html?user=guest&pass=guest&id=3333&#62' target='_blank' rel='nofollow'>http&#58;//vdt.cs.wisc.edu/rt/Ticket/Display.html?user=guest&pass=guest&id=3333&#62</a>;
VDT Support, vdt-support@....</pre></div><div class='update_description'><i onclick="document.location='4649#1203707899'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2008-02-22T19:18:19+00:00">Feb 22, 2008 07:18 PM UTC</time> by <b>Tim Silvers</b><a class="anchor" name="1203707899">&nbsp;</a></div><pre>Brian,

In response...

&#34;The LIGO VOMS itself says there are 205 records, whereas <a href='http&#58;//voms-monitor.grid.iu.edu/' target='_blank' rel='nofollow'>http&#58;//voms-monitor.grid.iu.edu/</a>, as
you mentioned shows 202. Is that normal?&#34;

No. But looking at my grid-mapfile I count 203 records...

$ grep -i &#39; ligo&#39; /etc/grid-security/grid-mapfile | grep -v &#39;#--&#39; | wc -l
203

But I do see that if I go to the LIGO VOMS URL there are 205 records. I know that normally the VO
Admin DN&#39;s are excluded from the count. I&#39;m not sure how to explain the discrepancies at the
moment. Maybe someone in VDT knows.

Tim
OSG GOC</pre></div><div class='update_description'><i onclick="document.location='4649#1203630487'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2008-02-21T21:48:07+00:00">Feb 21, 2008 09:48 PM UTC</time> by <b>Brian Moe</b><a class="anchor" name="1203630487">&nbsp;</a></div><pre>Hi Tim,

I&#39;m so glad it&#39;s not just me.

If if helps, this failure appears to have begun around Feb 18.  This error message
does not appear in my logs until 2008-02-18T16-19-01.

Two examples of LIGO DN&#39;s missing from my grid-mapfile are&#58;

&#34;/DC=org/DC=doegrids/OU=People/CN=Amber Stuver 384685&#34;
&#34;/DC=org/DC=doegrids/OU=People/CN=Doichin Denchev 327684&#34;

Some oddness... The LIGO VOMS itself says there are 205 records,
whereas <a href='http&#58;//voms-monitor.grid.iu.edu/' target='_blank' rel='nofollow'>http&#58;//voms-monitor.grid.iu.edu/</a>, as you mentioned shows 202.
Is that normal?

Thanks,
Brian

On Thu, Feb 21, 2008 at 09&#58;10&#58;00PM +0000, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='4649#1203629408'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2008-02-21T21:30:08+00:00">Feb 21, 2008 09:30 PM UTC</time> by <b>VDT</b><a class="anchor" name="1203629408">&nbsp;</a></div><pre>Greetings from the VDT support system!

This message was generated automatically in response to the creation of a
ticket regarding&#58;

Open Science Grid&#58; UMilwaukee edg-mkgridmap Failing w/no errors ISSUE=4649 PROJ=71

Your original request is copied below for reference.

There is no need to reply to this message right now -- someone from the VDT
team will respond to you as soon as possible.  If you wish to view your
support ticket online, visit&#58;

<a href='http&#58;//vdt.cs.wisc.edu/rt/Ticket/Display.html?user=guest&pass=guest&id=3333' target='_blank' rel='nofollow'>http&#58;//vdt.cs.wisc.edu/rt/Ticket/Display.html?user=guest&pass=guest&id=3333</a>

Your ticket has been assigned an ID as follows&#58;

[vdt-support #3333]

Please include the ticket ID in the subject line of all future email about
this issue.  To do so, you may reply to this message.

Thank you for your interest in the VDT.

-------------------------------------------------------------------------
[Duplicate message snipped]</pre></div><div class='update_description'><i onclick="document.location='4649#1203628237'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2008-02-21T21:10:37+00:00">Feb 21, 2008 09:10 PM UTC</time> by <b>Tim Silvers</b><a class="anchor" name="1203628237">&nbsp;</a></div><pre>Hi Brian,

I see you&#39;re running 0.8.0 according to VORS. I have an ITB node with that OSG version. Normally
I use prima/GUMS, but I changed the configuration to use the grid-mapfile to test the problem
you&#39;re seeing. And I can replicate the issue. The error I get in the edg-mkgridmap.log is identical
except for the line number of the script&#58;

2008-02-21T20-53-19 Running edg-mkgridmap
Can&#39;t call method &#34;getData&#34; on an undefined value at /usr/local/osg-0.7.1/edg/libexec/edg-
mkgridmap/edg-mkgridmap.pl line 686.
2008-02-21T20-53-22 New grid-mapfile is same as old one&#58; will not replace old one.

Looking at the edg-mkgridmap.pl script, line 686 is&#58;

$subject = $sn-&#62;getFirstChild-&#62;getData;

And finally, looking at a before and after of my grid-mapfile&#58;

[root@cobra osg-0.7.1]# ls -l /etc/grid-security/grid-mapfile*
-rw-r--r-- 1 root root 706199 Feb  6 21&#58;41 /etc/grid-security/grid-mapfile
-rw-r--r-- 1 root root      0 Jan 30 15&#58;25 /etc/grid-security/grid-mapfile.last_checked
[root@cobra osg-0.7.1]# edg-mkgridmap
[root@cobra osg-0.7.1]# ls -l /etc/grid-security/grid-mapfile*
-rw-r--r-- 1 root root 706199 Feb  6 21&#58;41 /etc/grid-security/grid-mapfile
-rw-r--r-- 1 root root      0 Feb 21 20&#58;53 /etc/grid-security/grid-mapfile.last_checked

So I&#39;m going to send this to the VDT for further investigation. By the way, which LIGO DN&#39;s are
missing? Can you give me a couple of examples, please? VOMS Monitor (http&#58;//voms-
monitor.grid.iu.edu/) reports there are 202 records.

Thanks,

Tim</pre></div><div class='update_description'><i onclick="document.location='4649#1203540488'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2008-02-20T20:48:08+00:00">Feb 20, 2008 08:48 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1203540488">&nbsp;</a></div><pre>Queues = Grid

Submitter Name&#58; Brian Moe

Application System&#58; bmoe@....

Your Resource/Service Name&#58;
UWMilwaukee

Your VO Support Center&#58;
LIGO

Your Phone Number&#58;
414-229-3656

Description of Problem&#58;
edg-mkgridmap seems to be failing.  The last couple of days I&#39;ve been seeing the following in $VDT_LOCATION/edg/log/edg-mkgridmap.log

2008-02-20T14-31-43 Running edg-mkgridmap
Can&#39;t call method &#34;getData&#34; on an undefined value at /opt/osg/grid/edg/libexec/edg-mkgridmap/edg-mkgridmap.pl line 685.
2008-02-20T14-31-46 New grid-mapfile is same as old one&#58; will not replace old one.

There are new DNs in the LIGO VOMS, that haven&#39;t appeared at my site, so I know this is actually failing.

Also, edg-mkgridmap is not failing nicely.  From all appearances (except for missing DNs and the odd error message in an obscure log file) it appears to be working.  grid-mapfile.last_checked and friends all have nice fresh timestamps, but nothing was actually checked, apparently.</pre></div><legend>Similar Recent Tickets <small>modified within the last 30 days</small></legend><div id="similar_tickets"><p class="muted">No similar tickets found.</p></div>
</div>
<script type="text/javascript">
function reset_anchor() {
    $("#updates .selected").removeClass("selected");
    var urls = document.location.toString().split('#'); 
    var anchor = urls[1];
    if(anchor) {
        $("a[name='"+anchor+"']").parents(".update_description").addClass("selected");
    }
}
function submitspam(ticket_id) {
    myret = confirm("Would you like to close this ticket as a security ticket, and submit the ticket content to akismet?");
    if(myret == true) {
        $.ajax("viewer/processspam?id="+ticket_id).done(function() {
            window.location.reload();
        });
    }
}

$(function() {
    reset_anchor();
    var ADDITIONAL_COOKIE_NAME = 'gocticket';
    var options = { path: '/', expires: 365};

    if(window.opener && window.opener.name == "gocticket_list") {
        v = $.cookie("closewindow");
        if(!v) {
            $("#closewindow").attr("checked", "checked"); //on by default
        } else {
            if(v == "checked") {
                $("#closewindow").attr("checked", "checked");
            }
        }
        $("#closewindow").click(function() {
            $.cookie("closewindow", $(this).attr('checked'), options);
        });
    } else {
        $("#closewindow_area").hide();
    }
    function updateTimeago() {
        $("time").timeago();
        setTimeout(updateTimeago, 30*1000);
    }
    updateTimeago();
    $(".description").focus(expand_description);
});
</script>
<hr/>
<footer>
<p>GOC Ticket Version 2.2 | <a href="https://ticket.opensciencegrid.org/goc/submit?app_issue_check=on&amp;app_issue_type=goc&amp;app_goc_url=https%3A%2F%2Fticket.opensciencegrid.org%3A443%2F4649">Report Bugs</a>
 | <a href="https://github.com/opensciencegrid/operations/blob/master/docs/privacy.md">Privacy Policy</a>
</p>

<p> <img align="top" src="/images/tag_orange.png"/> Copyright 2018 The Trustees of Indiana University - Developed for Open Science Grid</p>
</footer>


</div><!--container-fluid-->
<script src="https://ticket1.grid.iu.edu:8443/socket.io/socket.io.js"></script>
<script>
var chat = io.connect('https://ticket1.grid.iu.edu:8443');
chat.on('connect', function() {
    chat.emit('authenticate', {nodekey:'', ticketid: 4649});
});
chat.on('peers', function(peers) {
    $("#peers").html("");
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('peer_disconnect', function(pid) {
    $("#peer_"+pid).hide("slow");
});
chat.on('peer_connected', function(peers) {
    //expect only 1 peer connecting, but..
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('submit', function() {
    if(confirm("This ticket was updated. Do you want to refresh?")) {
        history.go(0);
    }
});

function addPeer(pid, peer) {
    var ipinfo = "";
    if(peer.ip != undefined) {
        ipinfo = "<span class=\"ip\">"+peer.ip+"</span>";
    }
    if(chat.io.engine.id == pid) {
        //don't display myself
        return;
    }
    var html = "<li class=\"new\" id=\"peer_"+pid+"\" class=\"peer\">"+peer.name+ipinfo+"</li>";
    $("#peers").prepend(html);
    $("#peers .new").animate({bottom: 0}, 1000, function() {$(this).removeClass("new")});
}

$(function() {
    $("#ticket_form").submit(function() {
        chat.emit('submit');
        return true;
    });
});
</script>
<script>
//used by searchbox
function parseValue(value) {
    var obj = new Object();
    var tokens = value.split("\t");
    obj.str = tokens[0];
    obj.count = tokens[1];
    return obj;
}

$(function() {
    //bootstrap-2.0.4 stuff
    $(".alert-message").alert();
    $(".dropdown-toggle").dropdown();
    $("span[rel='tooltip']").tooltip();
    $("a[rel=popover]").popover();

    //activate menu that user is currently on
    $("#menu_navigator").addClass("active"); 
    $("#submenu_").addClass("active"); 

    //translate zend validation error message to bootstrap
    $(".errors").addClass("alert").addClass("alert-error");

    //enable autocomplete for search box
    $("#search").autocomplete({
        source: function( request, response ) {
            $.ajax({
                url: "search/autocomplete",
                dataType: "text",
                data: {
                    //featureClass: "P",
                    //style: "full",
                    //maxRows: 12,
                    //name_startsWith: request.term
                    q: request.term
                },
                success: function( data ) {
                    response( $.map( data.split("\n"), function( item ) {
                        if(item == "") return null;
                        return {
                            value: item
                        }
                    }));
                }
            });
        },
        select: function(event, ui) {
            document.location = "search?q="+ui.item.value;
        }
    });
    
});
</script>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-69012-13");
pageTracker._trackPageview();
} catch(err) {}
</script>

</body>
