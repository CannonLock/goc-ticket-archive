<!DOCTYPE html>
<html lang="en">
  <head>
  <base href="">
    <title>[2644] User/group mapping problems with BNL_ATLAS_1 and BNL_ATLAS_2</title>    <meta charset="utf-8" />
    <meta name="verify-v1" content="na5IcAJsZVOfEkboRxuIiZ1zpZgnZiWra+nKcS7nA/o=" />
    <meta name="google-site-verification" content="DLrk3ft4s8b-S2TloLCL2LD_t6wcTjgSluf5pmiu2kA" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />
    <link href="https://ticket.opensciencegrid.org/rss" rel="alternate" type="application/rss+xml" title="GOC Ticket Update feed" />

    <style type="text/css">
      body {
        padding-top: 50px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
     #search {
            width: 300px;
     }

    </style>

<script src="https://code.jquery.com/jquery-3.0.0.js"></script>
<script src="https://code.jquery.com/jquery-migrate-3.0.1.js"></script>

   <link href="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet"/>
    <script src="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/js/bootstrap.min.js"></script>

    <link href="https://netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"/>
    <link href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/themes/smoothness/jquery-ui.min.css" rel="stylesheet"/>
 <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>


    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/js/select2.min.js"></script>

    <link href="css/ticket.css" rel="stylesheet" />
    <script src="lib/jquery.cookie.js"></script>

    <link href="images/tag_orange.png" rel="icon" type="image/png"/>
    <script src='https://www.google.com/recaptcha/api.js'></script>
  </head>

  <body>
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>

            <a class="brand" style="padding: 6px 0px 0px 6px;" href="http://opensciencegrid.org"><img src="images/osglogo.40x30.png"/></a>
            <ul class="nav">
                <li class="dropdown"><a href="https://ticket.opensciencegrid.org/#" class="dropdown-toggle" data-toggle="dropdown">GOC Ticket <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    <li><a href="https://my.opensciencegrid.org">MyOSG</a></li>
                    <li><a href="https://oim.opensciencegrid.org">OIM</a></li>
                    <li class="active"><a href="https://ticket.opensciencegrid.org/index">Ticket</a></li>
	<li class="divider"></li>
	<li><a href="http://repo.grid.iu.edu">Repo</a></li>
	<li class="divider"></li>
	<li><a href="http://blogs.grid.iu.edu">Blog</a></li>
                    <li><a href="http://display.grid.iu.edu">Display</a></li>
                    <li><a href="http://osggoc.blogspot.com/">News</a></li>
                    </ul>
                </li>
            </ul>
            <ul class="nav pull-right">
                <li><a href="https://ticket.opensciencegrid.org/sso/">Login</a></li>            </ul>

            <div class="nav-collapse">
                <ul class="nav">
			 <li id="menu_submit"><a href="https://ticket.opensciencegrid.org/submit">Submit</a></li><li id="menu_view" class="dropdown"><a href="https://ticket.opensciencegrid.org/\#" class="dropdown-toggle" data-toggle="dropdown">View <b class="caret"></b></a><ul class="dropdown-menu"><li id="submenu_listopen"><a href="https://ticket.opensciencegrid.org/list/open">Open Tickets</a></li><li id="submenu_listrecentclose"><a href="https://ticket.opensciencegrid.org/list/recentclose">Recently Closed Tickets</a></li><li class="divider"></li><li id="submenu_alltickets"><a href="https://ticket.opensciencegrid.org/search?q=&amp;sort=id">All Tickets</a></li></ul></li>                </ul>

                <form class="navbar-search pull-right" action="https://ticket.opensciencegrid.org/viewer">
                    <input id="search" type="text" name="id" class="search-query span2" placeholder="Search Ticket" value=""/>
                </form>
            </div>
        </div>
      </div>
    </div>

<script type='text/javascript' src='lib/jquery.timeago.js'></script>
<script type='text/javascript' src='lib/byte2size.js'></script>
<style>
#updates .toolbar {
position: relative;
margin-top: 0px;
top: -10px;
font-weight: normal;
}
#updates a.anchor {
position: relative;
top: -50px;
}
#updates .selected pre {
animation:selected 2s;
animation-iteration-count: 2;
animation-direction: alternate;
-webkit-animation:selected 2s; 
-webkit-animation-iteration-count: 2;
-webkit-animation-direction: alternate;
box-shadow: inset 1px 1px 20px #9ad;
border: 1px solid #9ab;
margin: 5px 0px;
padding-left: 10px;
}
@keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ab;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
@-webkit-keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ad;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
#updates pre {
background-color: inherit;
line-height: 15px;
padding: 5px;
}
#updates .header {
color: #999;
}
#updates .update_history pre {
background-color: #eee;
color: #666;
font-size: 85%;
}
#updates .clickable {
cursor: pointer;
}
#updates .clickable:hover {
color: #D98719;
}
#updates .meta_information pre {
background-color: #fed;
}
#similar_tickets {
max-height: 300px;
overflow-y: auto;
pointer-events: none;
padding: 5px;
background-color: #f4f4f4;
}
.btn-toolbar {
margin-bottom: 0;
height: 30px;
}
#peers {
position: fixed;
bottom: 0px;
right: 0px;
z-index: 100;
list-style: none;
padding: 5px 0px 0px 5px;
margin: 0px;
background-color: white;
box-shadow: 0px 0px 10px white;
}
#peers li {
background-color: #ccc;
color: #000;
display: inline-block;
padding: 5px 10px;
margin-right: 5px;
position: relative;
}
/*
#peers li:hover {
background-color: #999;
cursor: pointer;
}
*/
#peers span.ip {
padding-left: 5px;
color: #666;
}
#peers .new {
bottom: -30px;
}
/*
#peers .me {
background-color: red;
}
*/
</style>

<div class="container-fluid">
<ul id="peers"></ul>
<div class="alert alert-danger"><a class="close" href="https://ticket.opensciencegrid.org/#" data-dismiss="alert">&times;</a>By the end of May 2018, the ticketing system at https://ticket.opensciencegrid.org will be retired and support will be provided at https://support.opensciencegrid.org. Throughout this transition the support email (help@opensciencegrid.org) will be available as a point of contact.<br><br>                                                   
                                                                                                                                                                                   
Please see the service migration page for details: https://opensciencegrid.github.io/technology/policy/service-migrations-spring-2018/#ticket</div><div id="presence" class="pull-right"></div><div class="ticketgui"><script type="text/javascript" src="lib/checktab.js"></script>

<script>
var expanded = false;
function expand_description() {
    var desc = $(".description");
    if(!expanded) {
        expanded = true;
        //expand to minheight
        var min = 250;
        if(desc.height() < min) {
            desc.animate({height: min}, 200);
        }
    }
}

$(document).ready(function() {
    $("input[name='nad']").datepicker({
        dateFormat: 'yy-mm-dd'
    });
});

</script>



<style>
.form-horizontal .control-label {
padding-top: inherit;
font-size:90%;
color:#666;
}
label {
margin-bottom: 0px;
}
.controls {
line-height: 18px;
}
</style>
<form class="form-horizontal" action="https://ticket.opensciencegrid.org/viewer/updatebasic?id=2644" method="post">
<div class="page-header">
    <h3><span class="muted">2644</span> / User/group mapping problems with BNL_ATLAS_1 and BNL_ATLAS_2</h3>
</div>

<div class="row-fluid">
<div class="span5">
    <legend>Contact</legend>
    <div class="control-group">
        <label class="control-label">Full Name</label>
        <div class="controls">Chris Green</div>
    </div>
    <div class="control-group">
        <label class="control-label">Email</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">Phone</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">CC</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>

    <legend>Details</legend>
    
    <div class="control-group">
        <label class="control-label">Ticket Type</label>
        <div class="controls">Problem/Request</div>
    </div>
    <div class="control-group">
        <label class="control-label">Priority</label>
        <div class="controls">Normal</div>
    </div>
    <div class="control-group">
        <label class="control-label">Status</label>
        <div class="controls">
Closed</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action</label>
        <div class="controls">Kyle will followup w/USATLAS</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action Deadline</label>
        <div class="controls flag_red">2007-04-25</div>
    </div>

</div><!--span-->
<div class="span7">
    <legend>Assignees</legend>
    <div class="assignee" style="width: 60%">Kyle Gross <span class="muted"> / OSG GOC Support Team</span></div>    <br>

    <legend>Assignees</legend>
    TODO
    <br>

    <style>
legend.noborder {
border-bottom: none;
}
</style>

<div id="attachment-list"/>
<script>
$(function () {
    var first = true;
    $.getJSON("https://ticket.opensciencegrid.org/attachment/list?id=2644", function (files) {
        //console.dir(files);
        var html = "<table class=\"table table-condensed\">";
        $(files).each(function() {
            if(first) {
                first = false;
                html += "<legend class=\"noborder\">Attachmenets</legend>";
            }
            html += "<tr class=\"attachment\">";
            html += "<td><img src="https://ticket.opensciencegrid.org/\&quot;&quot;+this.thumbnail_url+&quot;\&quot;/"></td>";
            html += "<td><a href="https://ticket.opensciencegrid.org/\&quot;&quot;+this.url+&quot;\&quot;" target=\"_blank\">"+this.name+"</a></td>";
            html += "<td>"+bytesToSize(this.size, 1)+"</td>";
            html += "</tr>";
        });
        html += "</table>";
        $("#attachment-list").html(html);
    });
});

function download(url) {
    window.open(url, "_blank");
}
</script>


</div><!--span-->
</div><!--row-fluid-->


</form>

</div>
<div id="updates" style="clear: both;">
    <legend>Past Updates
    <div class="btn-toolbar pull-right toolbar">
        <div class="btn-group">
                <a class="btn btn-small" href="https://ticket.opensciencegrid.org/2644?sort=up&amp;"><i class="icon-arrow-up"></i> Sort</a>

        
        <a class="btn btn-small" href="https://ticket.opensciencegrid.org/2644?expandall=true&amp;">Expand Descriptions</a>        <a class="btn btn-small" target="_blank" href="mailto:osg@tick.globalnoc.iu.edu?subject=Open%20Science%20Grid%3A%20User%2Fgroup%20mapping%20problems%20with%20BNL_ATLAS_1%20and%20BNL_ATLAS_2%20ISSUE%3D2644%20PROJ%3D71"><i class="icon-envelope"></i> Update w/Email</a>
        </div>
    </div><!--btn-toolbar-->
    </legend>

    <div class='update_description'><i onclick="document.location='2644#1177610781'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2007-04-26T18:06:21+00:00">Apr 26, 2007 06:06 PM UTC</time> by <b>Kyle Gross</b><a class="anchor" name="1177610781">&nbsp;</a></div><pre>Chris,

It is my understanding that BNL just doesn&#39;t have the effort to tackle this problem
via a workaround or otherwise.  I&#39;m basing this answer off of this quote from John Hover&#58;

&#34;The short answer is that this particular issue just isn&#39;t going to be
solved any time soon, either at BNL by administrative means, or from
within GUMS (which is the eventual slated fix). It just would require
too much work to resolve, given that so few people would currently
encounter it.&#34;

Kyle</pre></div><div class='update_description'><i onclick="document.location='2644#1176906440'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2007-04-18T14:27:20+00:00">Apr 18, 2007 02:27 PM UTC</time> by <b>Chris Green</b><a class="anchor" name="1176906440">&nbsp;</a></div><pre>I understand, thank you for continuing to follow up on this matter. I do
think the ability to handle the same person with different &#34;hats&#34; on is
an important goal for the OSG and while I am disappointed that we are
unable to do this now, I am heartened that there is a solution on the
horizon; I do hope that this feature does in fact make it into 1.3 as
promised. What I am unsure about is why the &#34;workaround&#34; solution of
multiple pool accounts was not implemented&#58; was it not technically
possible in the end, or was there some other reason for not implementing
this?

Thanks,
Chris.

Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='2644#1176906141'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2007-04-18T14:22:21+00:00">Apr 18, 2007 02:22 PM UTC</time> by <b>Kyle Gross</b><a class="anchor" name="1176906141">&nbsp;</a></div><pre>Chris,

Sending this again. Could you please resend your reply? f you replied below the
dotted line, we won&#39;t get the reply.

Thank you much,
Kyle</pre></div><div class='update_description'><i onclick="document.location='2644#1176219985'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2007-04-10T15:46:25+00:00">Apr 10, 2007 03:46 PM UTC</time> by <b>Kyle Gross</b><a class="anchor" name="1176219985">&nbsp;</a></div><pre>Chris,

Can you resend your reply?  If you replied below the dotted line, we won&#39;t get the
reply.  Thank you much,

Kyle</pre></div><div class='update_description'><i onclick="document.location='2644#1175611228'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2007-04-03T14:40:28+00:00">Apr 3, 2007 02:40 PM UTC</time> by <b>Chris Green</b><a class="anchor" name="1175611228">&nbsp;</a></div><pre>Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='2644#1175609958'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2007-04-03T14:19:18+00:00">Apr 3, 2007 02:19 PM UTC</time> by <b>Kyle Gross</b><a class="anchor" name="1175609958">&nbsp;</a></div><pre>Chris,

I am assuming that you saw John&#39;s email about this.  It seems that the problem will
be fixed in the release of GUMS 1.3, but for the time being there&#39;s nothing that can
be done, unfortunately.  We&#39;ve exhausted our resources here at the GOC.  We just hope
you understand this and we look forward to your problem being fixed in the GUMS 1.3
release.

Thanks,
Kyle</pre></div><div class='update_description'><i onclick="document.location='2644#1174598596'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2007-03-22T21:23:16+00:00">Mar 22, 2007 09:23 PM UTC</time> by <b>Mariachi</b><a class="anchor" name="1174598596">&nbsp;</a></div><pre>Hi all, Kyle, Chris...

I&#39;m the author of the long explanation quoted below.

The short answer is that this particular issue just isn&#39;t going to be
solved any time soon, either at BNL by administrative means, or from
within GUMS (which is the eventual slated fix). It just would require
too much work to resolve, given that so few people would currently
encounter it.

The permanent solution to this issue will be fully provided in GUMS
release 1.3. (1.2 is coming out next month). This fix requires a GUMS
database schema change, which is why it didn&#39;t make it into the 1.2
release.

Sorry to bear bad news. You should close this ticket and mark it as
&#34;unsolved&#34;, if you have that option.

Cheers,

--john

Jerome LAURET wrote&#58;
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;     Dear Kyle,</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;     I believe Dantong Yu is the VO contact person for all Atlas</font>
<font color='#7F7E6F'>&#62; related issues. His Email address is dtyu@.... . GUMS itself is</font>
<font color='#7F7E6F'>&#62; maintained (partly ; unless I am all wrong and he is only the taking</font>
<font color='#7F7E6F'>&#62; care of VOMS) by John Hoover jhover@.... and you may have</font>
<font color='#7F7E6F'>&#62; both as CC in the Email you may send.</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;     I am adding both of them for your convenience.</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;     Dantong&John, could you please assist Kyle and the GOC with</font>
<div id='show_2020137804' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_2020137804'><font color='#7F7E6F'>&#62; this?</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;     Thank you,</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; Open Science Grid FootPrints wrote&#58;</font>
<font color='#7F7E6F'>&#62;&#62; [Duplicate message snipped]</font>
</div><script type='text/javascript'>
        $('#show_2020137804').click(function() {
            $('#detail_2020137804').slideDown("normal");
            $('#show_2020137804').hide();
            $('#hide_2020137804').show();
        });
        $('#hide_2020137804').click(function() {
            $('#detail_2020137804').slideUp();
            $('#hide_2020137804').hide();
            $('#show_2020137804').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='2644#1174597524'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2007-03-22T21:05:24+00:00">Mar 22, 2007 09:05 PM UTC</time> by <b>Jerome Lauret</b><a class="anchor" name="1174597524">&nbsp;</a></div><pre>Dear Kyle,

I believe Dantong Yu is the VO contact person for all Atlas
related issues. His Email address is dtyu@.... . GUMS itself is
maintained (partly ; unless I am all wrong and he is only the taking
care of VOMS) by John Hoover jhover@.... and you may have
both as CC in the Email you may send.

I am adding both of them for your convenience.

Dantong&John, could you please assist Kyle and the GOC with
this?

Thank you,

Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='2644#1174591193'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2007-03-22T19:19:53+00:00">Mar 22, 2007 07:19 PM UTC</time> by <b>Kyle Gross</b><a class="anchor" name="1174591193">&nbsp;</a></div><pre>Jerome,

I&#39;m sorry to bother you, but we (the GOC) have been pushing the USATLAS support
center for some information as to this ticket for quite some time. (Since last year)
If you wouldn&#39;t mind, we&#39;d appreciate it if you could track down exactly who we need
to talk to?  The issue is as follows&#58;

&#34;This issue has uncovered a rather complicated problem with the GUMS
configuration at BNL (and any site using pool accounts rather than group
accounts). All our grid pool accounts are in a single pool &#34;bnlPool&#34;,
and GUMS has write access to our global LDAP in order to place pool
accounts in the proper group after a GUMS mapping.

A result of this is that a user in multiple VOs appears to get mapped to
the same pool account regardless of the VO the voms proxy is from. It
also appears that the pool account is placed in the VO-specific UNIX
group corresponding to whatever VO the most recent GUMS mapping was done
for.

This plays havoc with filesystem access for that pool account.

A few approaches could be imagined to resolve this&#58;
1) Place all pool account in one generic primary group, and have the VO
assignments be cumulative, i.e. pool account blah would be in multiple
VO secondary groups. While this might work for read access to VO files,
it apparently wouldn&#39;t work for group-owned sticky directories.

2) Force multi-VO users to use different certs. This is workable, but
would be one-step-forward, two-steps-back. The whole point of SSL Certs
is that each user has only one.

3) Create separate pools in GUMS for each VO rather than drawing from a
single global pool. This would make the same user cert map to different
UNIX accounts depending on the VO the proxy was made from. The negative
result of this would be that each VO individually will need to have
<div id='show_639149906' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_639149906'>sufficient pool accounts assigned to it to handle current and future
membership. This is compicated since some VOs have 45 members, while
others have 4500.

My plan is to switch BNL over to plan #3. Although I want to do some
testing first.&#34;

Any help would be much appreciated.  Thank you!

Kyle
</div><script type='text/javascript'>
        $('#show_639149906').click(function() {
            $('#detail_639149906').slideDown("normal");
            $('#show_639149906').hide();
            $('#hide_639149906').show();
        });
        $('#hide_639149906').click(function() {
            $('#detail_639149906').slideUp();
            $('#hide_639149906').hide();
            $('#show_639149906').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='2644#1173465189'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2007-03-09T18:33:09+00:00">Mar 9, 2007 06:33 PM UTC</time> by <b>Kyle Gross</b><a class="anchor" name="1173465189">&nbsp;</a></div><pre>Chris,

So, by saying you&#39;ve heard nothing for months, you mean the issue is definitely still
ongoing?

Thanks,

Kyle</pre></div><div class='update_description'><i onclick="document.location='2644#1172004508'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2007-02-20T20:48:28+00:00">Feb 20, 2007 08:48 PM UTC</time> by <b>Chris Green</b><a class="anchor" name="1172004508">&nbsp;</a></div><pre>Hi Kyle,

I don&#39;t know if you&#39;re pinging me or the BML folks, but I&#39;ve heard
nothing for months.

Thanks,
Chris.

Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='2644#1172003420'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2007-02-20T20:30:20+00:00">Feb 20, 2007 08:30 PM UTC</time> by <b>Kyle Gross</b><a class="anchor" name="1172003420">&nbsp;</a></div><pre>Pinging again for updates.  Has this issue been resolved?

Kyle</pre></div><div class='update_description'><i onclick="document.location='2644#1170969797'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2007-02-08T21:23:17+00:00">Feb 8, 2007 09:23 PM UTC</time> by <b>Kyle Gross</b><a class="anchor" name="1170969797">&nbsp;</a></div><pre>Pinging again for updates.</pre></div><div class='update_description'><i onclick="document.location='2644#1170083613'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2007-01-29T15:13:33+00:00">Jan 29, 2007 03:13 PM UTC</time> by <b>Kyle Gross</b><a class="anchor" name="1170083613">&nbsp;</a></div><pre>I have heard nothing about this.  Is this working properly now, or are there still
problems?

Kyle</pre></div><div class='update_description'><i onclick="document.location='2644#1168876132'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2007-01-15T15:48:52+00:00">Jan 15, 2007 03:48 PM UTC</time> by <b>Kyle Gross</b><a class="anchor" name="1168876132">&nbsp;</a></div><pre>Pinging for an update as to how you are testing multiple pool accounts at BNL.

Thanks.

Kyle</pre></div><div class='update_description'><i onclick="document.location='2644#1167861190'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2007-01-03T21:53:10+00:00">Jan 3, 2007 09:53 PM UTC</time> by <b>Kyle Gross</b><a class="anchor" name="1167861190">&nbsp;</a></div><pre>John Hover,

Could you elaborate as to how you are testing multiple pool accounts at BNL, please?
Thanks!

Kyle</pre></div><div class='update_description'><i onclick="document.location='2644#1167861172'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2007-01-03T21:52:52+00:00">Jan 3, 2007 09:52 PM UTC</time> by <b>Kyle Gross</b><a class="anchor" name="1167861172">&nbsp;</a></div><pre>Chris,

I suspect that the strangeness with you getting the ticket late has to do with the
new ticket exchange we set up with ATLAS.  It&#39;s not perfect, but it is improving all
the time.

Kyle</pre></div><div class='update_description'><i onclick="document.location='2644#1167229141'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2006-12-27T14:19:01+00:00">Dec 27, 2006 02:19 PM UTC</time> by <b>Tim Silvers</b><a class="anchor" name="1167229141">&nbsp;</a></div><pre>Kyle,

I&#39;ve reassigned this ticket from Leigh to you.

Tim</pre></div><div class='update_description'><i onclick="document.location='2644#1166667925'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2006-12-21T02:25:25+00:00">Dec 21, 2006 02:25 AM UTC</time> by <b>leighg</b><a class="anchor" name="1166667925">&nbsp;</a></div><pre>Dear USAtlas Support-

I am not sure. This ticket history shows the following&#58;
11/01/2006      	 6&#58;23 PM      	Leigh Grundhofer      	Changed ENG Next Action Item,
Changed ENG Next Action Date/Time (UTC), Changed Destination VO Support Center to
USATLAS
Changed Status to Support Agency
Appended a Description
Added Assignee &#58; OSG Support Centers USATLAS
Notification mail sent&#58; Customer&#58; greenc@....; Assignee&#58;
Leigh Grundhofer USATLAS

11/01/2006      	6&#58;37 PM      	tomw@....      	Appended a Description
Incoming mail&#58; From&#58; tomw@....; To&#58;
osg@....; Cc&#58; usatlas-support-l@....
Notification mail sent&#58; Customer&#58; greenc@....; Cc&#58;
tomw@....; Assignee&#58; Leigh Grundhofer USATLAS

So on 11/01 email was sent to usatlas-support-1@.....

leigh</pre></div><div class='update_description'><i onclick="document.location='2644#1166048356'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2006-12-13T22:19:16+00:00">Dec 13, 2006 10:19 PM UTC</time> by <b>Chris Green</b><a class="anchor" name="1166048356">&nbsp;</a></div><pre>Hi GOC,

This ticket has been open for months&#58; why did I just get a creation
notification for it?

Thanks,
Chris.

Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='2644#1165340030'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2006-12-05T17:33:50+00:00">Dec 5, 2006 05:33 PM UTC</time> by <b>leighg</b><a class="anchor" name="1165340030">&nbsp;</a></div><pre>Hello-

Have you been able to provide a correction for the user/group mapping issue?

Thanks-
leigh</pre></div><div class='update_description'><i onclick="document.location='2644#1164725970'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2006-11-28T14:59:30+00:00">Nov 28, 2006 02:59 PM UTC</time> by <b>Mariachi</b><a class="anchor" name="1164725970">&nbsp;</a></div><pre>This issue has uncovered a rather complicated problem with the GUMS
configuration at BNL (and any site using pool accounts rather than group
accounts). All our grid pool accounts are in a single pool &#34;bnlPool&#34;,
and GUMS has write access to our global LDAP in order to place pool
accounts in the proper group after a GUMS mapping.

A result of this is that a user in multiple VOs appears to get mapped to
the same pool account regardless of the VO the voms proxy is from. It
also appears that the pool account is placed in the VO-specific UNIX
group corresponding to whatever VO the most recent GUMS mapping was done
for.

This plays havoc with filesystem access for that pool account.

A few approaches could be imagined to resolve this&#58;
1) Place all pool account in one generic primary group, and have the VO
assignments be cumulative, i.e. pool account blah would be in multiple
VO secondary groups. While this might work for read access to VO files,
it apparently wouldn&#39;t work for group-owned sticky directories.

2) Force multi-VO users to use different certs. This is workable, but
would be one-step-forward, two-steps-back. The whole point of SSL Certs
is that each user has only one.

3) Create separate pools in GUMS for each VO rather than drawing from a
single global pool. This would make the same user cert map to different
UNIX accounts depending on the VO the proxy was made from. The negative
result of this would be that each VO individually will need to have
sufficient pool accounts assigned to it to handle current and future
membership. This is compicated since some VOs have 45 members, while
others have 4500.

My plan is to switch BNL over to plan #3. Although I want to do some
testing first.

<div id='show_553186834' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_553186834'>Cheers,

--john

Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font>
</div><script type='text/javascript'>
        $('#show_553186834').click(function() {
            $('#detail_553186834').slideDown("normal");
            $('#show_553186834').hide();
            $('#hide_553186834').show();
        });
        $('#hide_553186834').click(function() {
            $('#detail_553186834').slideUp();
            $('#hide_553186834').hide();
            $('#show_553186834').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='2644#1164720327'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2006-11-28T13:25:27+00:00">Nov 28, 2006 01:25 PM UTC</time> by <b>leighg</b><a class="anchor" name="1164720327">&nbsp;</a></div><pre>John-

Could you let me know the status of this issue?

Thanks
leighg</pre></div><div class='update_description'><i onclick="document.location='2644#1164129019'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2006-11-21T17:10:19+00:00">Nov 21, 2006 05:10 PM UTC</time> by <b>leighg</b><a class="anchor" name="1164129019">&nbsp;</a></div><pre>Ticket URL&#58; <a href='https&#58;//rt-racf.bnl.gov/rt/Ticket/Display.html?id=940' target='_blank' rel='nofollow'>https&#58;//rt-racf.bnl.gov/rt/Ticket/Display.html?id=940</a>
Requestors&#58; leighg@....
Queue&#58; GridServices
Owner&#58; jhover
Status&#58; open
Transaction&#58; Correspondence added by jhover
Subject&#58; Re&#58; [rt-racf.bnl.gov #940] User/group mapping problems with
+BNL_ATLAS_1 and BNL_ATLAS_2   ISSUE=2644 PROJ=71

This issue has uncovered a rather complicated problem with the GUMS
configuration at BNL (and any site using pool accounts rather than group
accounts). All our grid pool accounts are in a single pool &#34;bnlPool&#34;,
and GUMS has write access to our global LDAP in order to place pool
accounts in the proper group after a GUMS mapping.

A result of this is that a user in multiple VOs appears to get mapped to
the same pool account regardless of the VO the voms proxy is from. It
also appears that the pool account is placed in the VO-specific UNIX
group corresponding to whatever VO the most recent GUMS mapping was done
for.

This plays havoc with filesystem access for that pool account.

A few approaches could be imagined to resolve this&#58;
1) Place all pool account in one generic primary group, and have the VO
assignments be cumulative, i.e. pool account blah would be in multiple
VO secondary groups. While this might work for read access to VO files,
it apparently wouldn&#39;t work for group-owned sticky directories.

2) Force multi-VO users to use different certs. This is workable, but
would be one-step-forward, two-steps-back. The whole point of SSL Certs
is that each user has only one.

3) Create separate pools in GUMS for each VO rather than drawing from a
single global pool. This would make the same user cert map to different
<div id='show_12149052' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_12149052'>UNIX accounts depending on the VO the proxy was made from. The negative
result of this would be that each VO individually will need to have
sufficient pool accounts assigned to it to handle current and future
membership. This is compicated since some VOs have 45 members, while
others have 4500.

My plan is to switch BNL over to plan #3. Although I want to do some
testing first.

Cheers,

--john
</div><script type='text/javascript'>
        $('#show_12149052').click(function() {
            $('#detail_12149052').slideDown("normal");
            $('#show_12149052').hide();
            $('#hide_12149052').show();
        });
        $('#hide_12149052').click(function() {
            $('#detail_12149052').slideUp();
            $('#hide_12149052').hide();
            $('#show_12149052').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='2644#1163548690'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2006-11-14T23:58:10+00:00">Nov 14, 2006 11:58 PM UTC</time> by <b>leighg</b><a class="anchor" name="1163548690">&nbsp;</a></div><pre>Hello-

Any update on this issue regarding User/group mappings?

thanks -

leigh</pre></div><div class='update_description'><i onclick="document.location='2644#1162863085'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2006-11-07T01:31:25+00:00">Nov 7, 2006 01:31 AM UTC</time> by <b>leighg</b><a class="anchor" name="1162863085">&nbsp;</a></div><pre>Hello Xin-

I will also leave the questions for John, but I wanted to let you know
that VORS collects the information regulary (in case of updates) from
the site. If a site is inaccessable then this information is not available.
The BNL_ATLAS_1 /2 site was down for awhile and it is now back
up. The information is again available in VORS.

Thanks-
leigh</pre></div><div class='update_description'><i onclick="document.location='2644#1162849225'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2006-11-06T21:40:25+00:00">Nov 6, 2006 09:40 PM UTC</time> by <b>Xin zhao</b><a class="anchor" name="1162849225">&nbsp;</a></div><pre>Hi GOC,

I will leave the main questions for John to answer.
About the missing BNL informaiton in VORS, I think these information
are retrieved from &#34;Operations registration database&#34;? If we need to
re-register our resources, please let us know, and please also point
us to the right forms to fill up.

Thanks,
Xin

On Mon, 2006-11-06 at 15&#58;22, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='2644#1162844546'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2006-11-06T20:22:26+00:00">Nov 6, 2006 08:22 PM UTC</time> by <b>Chris Green</b><a class="anchor" name="1162844546">&nbsp;</a></div><pre>Hi,

Thanks for your reply. This email contains lots of information, and a
few specific requests. In order to improve the overall clarity of the
email I have marked each request with &#34;}}}{{{&#34;.

In order  to be able to work on non-GUMS sites I have obtained multiple
DOE certs and have rationalized my cert membership. In particular, my
KCA cert is only valid in one VO now&#58; Fermilab. My basic DOE cert
however, is valid in DZero, GADU, DES (shortly, awaiting approval),
Fermilab and SDSS (shortly, awaiting approval). I also have specific DOE
certs in GADU, DES, DZero and SDSS. The current state of my held
certificates is as follows&#58;

------------------------------------------------------------------------
subject= /DC=org/DC=doegrids/OU=People/CN=Christopher H. Green 851859
serial=22BE
subject= /DC=org/DC=doegrids/OU=People/CN=Christopher H. Green (DES) 572851
serial=2D94
subject= /DC=org/DC=doegrids/OU=People/CN=Christopher H. Green (DZERO)
110307
serial=2D92
subject= /DC=org/DC=doegrids/OU=People/CN=Christopher H. Green (GADU) 478276
serial=2D93
subject= /DC=org/DC=doegrids/OU=People/CN=Christopher H. Green (SDSS) 519040
serial=2D95
subject= /DC=gov/DC=fnal/O=Fermilab/OU=People/CN=Chris Green/UID=greenc
serial=380D6D
------------------------------------------------------------------------

Late last week I removed my KCA cert from all except the Fermilab VO,
which is why you can&#39;t see my second cert listed.

As of right now, neither BNL_ATLAS_1 or BNL_ATLAS_2 are showing up on
VORS as supporting any site at all! Can someone take a look at this,
<div id='show_476226964' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_476226964'>please? }}}{{{

Going back to last week when I had my KCA cert in multiple VOs (take
GADU, DZERO and Fermilab, for example)&#58; it did not matter what my VOMS
proxy said, I came in and obtained a non-valid unix groupd ID (always
the same one). Similarly my basic DOE cert always came in as GADU group
regardless of VOMS-proxy information.

My KCA cert (as I mention above) is now enabled only in the Fermilab VO&#58;
however, as of right now&#58;

------------------------------------------------------------------------
[greenc@cd-psg1] ~ $ voms-proxy-info -all
WARNING&#58; Unable to verify signature! Server certificate possibly not
installed.
Error&#58; Cannot find certificate of AC issuer for vo fermilab
subject   &#58; /DC=gov/DC=fnal/O=Fermilab/OU=People/CN=Chris
Green/USERID=greenc/CN=proxy
issuer    &#58; /DC=gov/DC=fnal/O=Fermilab/OU=People/CN=Chris
Green/USERID=greenc
identity  &#58; /DC=gov/DC=fnal/O=Fermilab/OU=People/CN=Chris
Green/USERID=greenc
type      &#58; proxy
strength  &#58; 512 bits
path      &#58; /tmp/x509up_u8483
timeleft  &#58; 163&#58;04&#58;43
=== VO fermilab extension information ===
VO        &#58; fermilab
subject   &#58; /DC=gov/DC=fnal/O=Fermilab/OU=People/CN=Chris
Green/USERID=greenc
issuer    &#58; /DC=org/DC=doegrids/OU=Services/CN=host/fermigrid2.fnal.gov
attribute &#58; /fermilab/miniboone/Role=NULL/Capability=NULL
attribute &#58; /fermilab/Role=NULL/Capability=NULL
attribute &#58; /fermilab/test/Role=NULL/Capability=NULL
timeleft  &#58; 23&#58;59&#58;42
[greenc@cd-psg1] ~ $ !globus
globus-job-run gridgk01.racf.bnl.gov /usr/bin/id
uid=73817(grid3817) gid=69909(gadu) groups=8775(stargrid),69909(gadu)
context=user_u&#58;system_r&#58;initrc_t
[greenc@cd-psg1] ~ $
------------------------------------------------------------------------

ie this cert/VO combination (KCA with fermilab&#58;/fermilab/miniboone
VO/group) is being mapped to a group of which this cert is no longer a
member! You correctly state that previously, my Fermilab/KCA VOMS proxy
was being mapped to 69919. Unfortunately 69919 was not listed in the
/etc/group file of the head node (no text translation is listed) so
GridFTP attempts to and from the head node failed.

Could someone fix this so that the /fermilab/... VOMS information maps
correctly to the fermilab group(69919) and that this group has an entry
in /etc/group on all machines? }}}{{{

While we&#39;re still on the subject of the Fermilab VO, here&#39;s what happens
when I use my basic DOE cert to do the same thing&#58;

------------------------------------------------------------------------
[greenc@cd-psg1] ~ $ voms-proxy-init -cert
/afs/fnal.gov/files/home/room3/greenc/.globus/usercert-DOE.pem -key
/afs/fnal.gov/files/home/room3/greenc/.globus/userkey-DOE.pem -userconf
/afs/fnal.gov/files/home/room3/greenc/.glite/vomses -voms
fermilab&#58;/fermilab/miniboone -valid 168&#58;0
Cannot find file or dir&#58; $prefix/etc/vomses
Your identity&#58; /DC=org/DC=doegrids/OU=People/CN=Christopher H. Green 851859
Enter GRID pass phrase&#58;
Creating temporary proxy .............................................. Done
Contacting  fermigrid2.fnal.gov&#58;15001
[/DC=org/DC=doegrids/OU=Services/CN=host/fermigrid2.fnal.gov] &#34;fermilab&#34;
Done

Warning&#58;

Creating proxy ...................................... Done
Your proxy is valid until Mon Nov 13 14&#58;02&#58;46 2006
[greenc@cd-psg1] ~ $ voms-proxy-info -all
WARNING&#58; Unable to verify signature! Server certificate possibly not
installed.
Error&#58; Cannot find certificate of AC issuer for vo fermilab
subject   &#58; /DC=org/DC=doegrids/OU=People/CN=Christopher H. Green
851859/CN=proxy
issuer    &#58; /DC=org/DC=doegrids/OU=People/CN=Christopher H. Green 851859
identity  &#58; /DC=org/DC=doegrids/OU=People/CN=Christopher H. Green 851859
type      &#58; proxy
strength  &#58; 512 bits
path      &#58; /tmp/x509up_u8483
timeleft  &#58; 167&#58;59&#58;11
=== VO fermilab extension information ===
VO        &#58; fermilab
subject   &#58; /DC=org/DC=doegrids/OU=People/CN=Christopher H. Green 851859
issuer    &#58; /DC=org/DC=doegrids/OU=Services/CN=host/fermigrid2.fnal.gov
attribute &#58; /fermilab/miniboone/Role=NULL/Capability=NULL
attribute &#58; /fermilab/Role=NULL/Capability=NULL
attribute &#58; /fermilab/test/Role=NULL/Capability=NULL
timeleft  &#58; 23&#58;59&#58;11
[greenc@cd-psg1] ~ $ globus-job-run gridgk01.racf.bnl.gov /usr/bin/id
uid=75002(grid5002) gid=69909(gadu) groups=69909(gadu)
context=user_u&#58;system_r&#58;initrc_t
------------------------------------------------------------------------

ie different pool account (as expected) but same wrong group setting.
Can someone please take a look at this also? }}}{{{

Now that we&#39;re on to the basic DOE cert, I can get into different VOs
based on this cert -- DZero, for instance&#58;

------------------------------------------------------------------------
[greenc@cd-psg1] ~ $ voms-proxy-init -cert
/afs/fnal.gov/files/home/room3/greenc/.globus/usercert-DOE.pem -key
/afs/fnal.gov/files/home/room3/greenc/.globus/userkey-DOE.pem -userconf
/afs/fnal.gov/files/home/room3/greenc/.glite/vomses -voms
dzero&#58;/dzero/users -valid 168&#58;0
Cannot find file or dir&#58; $prefix/etc/vomses
Your identity&#58; /DC=org/DC=doegrids/OU=People/CN=Christopher H. Green 851859
Enter GRID pass phrase&#58;
Creating temporary proxy ................................... Done
Contacting  fermigrid2.fnal.gov&#58;15002
[/DC=org/DC=doegrids/OU=Services/CN=host/fermigrid2.fnal.gov] &#34;dzero&#34; Done

Warning&#58;

Creating proxy ..................................... Done
Your proxy is valid until Mon Nov 13 14&#58;08&#58;02 2006
[greenc@cd-psg1] ~ $ voms-proxy-info -all
WARNING&#58; Unable to verify signature! Server certificate possibly not
installed.
Error&#58; Cannot find certificate of AC issuer for vo dzero
subject   &#58; /DC=org/DC=doegrids/OU=People/CN=Christopher H. Green
851859/CN=proxy
issuer    &#58; /DC=org/DC=doegrids/OU=People/CN=Christopher H. Green 851859
identity  &#58; /DC=org/DC=doegrids/OU=People/CN=Christopher H. Green 851859
type      &#58; proxy
strength  &#58; 512 bits
path      &#58; /tmp/x509up_u8483
timeleft  &#58; 167&#58;59&#58;54
=== VO dzero extension information ===
VO        &#58; dzero
subject   &#58; /DC=org/DC=doegrids/OU=People/CN=Christopher H. Green 851859
issuer    &#58; /DC=org/DC=doegrids/OU=Services/CN=host/fermigrid2.fnal.gov
attribute &#58; /dzero/users/Role=NULL/Capability=NULL
attribute &#58; /dzero/Role=NULL/Capability=NULL
timeleft  &#58; 23&#58;59&#58;54
[greenc@cd-psg1] ~ $ globus-job-run gridgk01.racf.bnl.gov /usr/bin/id
uid=75002(grid5002) gid=69909(gadu) groups=69909(gadu)
context=user_u&#58;system_r&#58;initrc_t
------------------------------------------------------------------------

ie&#58; same cert, same UID and GID regardless of VOMS proxy info. I&#39;m
assuming this is all part of the same problem but I&#39;m going to put the
request marker here to get this fixed for completeness&#58; }}}{{{

In the case of the DES VO, I get something different for this cert&#58;

------------------------------------------------------------------------
[greenc@cd-psg1] ~ $ voms-proxy-init -cert
/afs/fnal.gov/files/home/room3/greenc/.globus/usercert-DOE.pem -key
/afs/fnal.gov/files/home/room3/greenc/.globus/userkey-DOE.pem -userconf
/afs/fnal.gov/files/home/room3/greenc/.glite/vomses -voms des&#58;/des
-valid 168&#58;0
Cannot find file or dir&#58; $prefix/etc/vomses
Your identity&#58; /DC=org/DC=doegrids/OU=People/CN=Christopher H. Green 851859
Enter GRID pass phrase&#58;
Creating temporary proxy ........................................ Done
Contacting  fermigrid2.fnal.gov&#58;15017
[/DC=org/DC=doegrids/OU=Services/CN=host/fermigrid2.fnal.gov] &#34;des&#34; Done

Warning&#58;

Creating proxy
............................................................... Done
Your proxy is valid until Mon Nov 13 14&#58;09&#58;30 2006
[greenc@cd-psg1] ~ $ voms-proxy-info -all
WARNING&#58; Unable to verify signature! Server certificate possibly not
installed.
Error&#58; Cannot find certificate of AC issuer for vo des
subject   &#58; /DC=org/DC=doegrids/OU=People/CN=Christopher H. Green
851859/CN=proxy
issuer    &#58; /DC=org/DC=doegrids/OU=People/CN=Christopher H. Green 851859
identity  &#58; /DC=org/DC=doegrids/OU=People/CN=Christopher H. Green 851859
type      &#58; proxy
strength  &#58; 512 bits
path      &#58; /tmp/x509up_u8483
timeleft  &#58; 167&#58;59&#58;57
=== VO des extension information ===
VO        &#58; des
subject   &#58; /DC=org/DC=doegrids/OU=People/CN=Christopher H. Green 851859
issuer    &#58; /DC=org/DC=doegrids/OU=Services/CN=host/fermigrid2.fnal.gov
attribute &#58; /des/Role=NULL/Capability=NULL
timeleft  &#58; 23&#58;59&#58;57
[greenc@cd-psg1] ~ $ globus-job-run gridgk01.racf.bnl.gov /usr/bin/id
GRAM Job submission failed because authentication with the remote server
failed (error code 7)
------------------------------------------------------------------------

Of course, this could be because you don&#39;t support this VO.

I hope I have been able to clarify the situation, and why it is
different now than when I first reported the problem. I also hope I have
been able to show however, that the problem (or another analogous one)
still exists. I would be glad to answer more questions if you need
further information or I have failed to clarify anything.

Thanks for your time and help,

Chris.

--
Chris Green &#60;greenc@....&#62;, FNAL CD/CCF.
&#39;Phone (630) 840-2167.
</div><script type='text/javascript'>
        $('#show_476226964').click(function() {
            $('#detail_476226964').slideDown("normal");
            $('#show_476226964').hide();
            $('#hide_476226964').show();
        });
        $('#hide_476226964').click(function() {
            $('#detail_476226964').slideUp();
            $('#hide_476226964').hide();
            $('#show_476226964').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='2644#1162819525'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2006-11-06T13:25:25+00:00">Nov 6, 2006 01:25 PM UTC</time> by <b>leighg</b><a class="anchor" name="1162819525">&nbsp;</a></div><pre>Ticket URL&#58; <a href='https&#58;//rt-racf.bnl.gov/rt/Ticket/Display.html?id=940' target='_blank' rel='nofollow'>https&#58;//rt-racf.bnl.gov/rt/Ticket/Display.html?id=940</a>
Requestors&#58; leighg@....
Queue&#58; GridServices
Owner&#58; jhover
Status&#58; new
Transaction&#58; Correspondence added by jhover
Subject&#58; Re&#58; [rt-racf.bnl.gov #940] User/group mapping problems with BNL_ATLAS_1
and BNL_ATLAS_2   ISSUE=2644 PROJ=71

What VO, vo group, and vo Role is he wanted to actually use? It would be
useful to see the output of &#39;voms-proxy-info -all&#39; for each.

I see the following DN in the gadu VO&#58;
/DC=org/DC=doegrids/OU=People/CN=Christopher H. Green 851859

This is a DOEGrids certficate. There is no other Christopher Green DNs
in that VO. Mr. Green would not have been able to perform a full
voms-proxy-init against gadu with his KCA certificate. This DN doesn&#39;t
appear to be enabled for any roles at all.

Looking at the fermilab VO, I see two DNs with the e-mail greenc@....&#58;
/DC=gov/DC=fnal/O=Fermilab/OU=People/CN=Chris Green/UID=greenc
(I assume this is what he means by KCA cert)
and
/DC=org/DC=doegrids/OU=People/CN=Christopher H. Green 851859

Based on what he is reporting, the mapping behavior at BNL is correct.
If he does a GADU voms proxy he should be mapped to
uid=75002(grid5002) gid=69909(gadu) groups=69909(gadu)

If he does a FERMILAB voms proxy, he would have to specify which
certificate to use. ( I can&#39;t tell which Roles are authorized for which
DN. ) Which Fermilab pool account he would get mapped to depends on
which cert he uses. But the account he lists&#58;
uid=73817(grid3817) gid=69919 groups=8775(stargrid),69919
<div id='show_1392887439' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_1392887439'>is in the group fermilab (gid 69919).

[&#39;stargrid&#39; is just a group for users whose grid home directories are on
STAR storage--ATLAS and STAR share the load for storage of grid pool
account home directories. Shouldn&#39;t be relevant to the problem here.]

For a simple grid proxy, he would get mapped to the first match, which
in this case would be gadu before fermilab, because that is the order in
which they are configured for our gatekeeper within GUMS.

I just tidied up some settings in our gums.config to handle the case
where he has a Fermilab VOMS proxy using the DOEgrids cert. He would now
get mapped to the fermilab pool account (whereas before he would bet
mapped to the gadu account in this case).

Cheers,

--john

--
John R. Hover
RHIC/Atlas Computing Facility, Bldg. 510M
Physics Department
Brookhaven National Laboratory
Upton, NY 11793
email&#58; jhover@....
tel&#58; 631-344-5828
</div><script type='text/javascript'>
        $('#show_1392887439').click(function() {
            $('#detail_1392887439').slideDown("normal");
            $('#show_1392887439').hide();
            $('#hide_1392887439').show();
        });
        $('#hide_1392887439').click(function() {
            $('#detail_1392887439').slideUp();
            $('#hide_1392887439').hide();
            $('#show_1392887439').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='2644#1162406240'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2006-11-01T18:37:20+00:00">Nov 1, 2006 06:37 PM UTC</time> by <b>tomw@....</b><a class="anchor" name="1162406240">&nbsp;</a></div><pre>On Wed, 1 Nov 2006, Open Science Grid FootPrints wrote&#58;

<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='2644#1162405398'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2006-11-01T18:23:18+00:00">Nov 1, 2006 06:23 PM UTC</time> by <b>leighg</b><a class="anchor" name="1162405398">&nbsp;</a></div><pre>Hello USAtlas Support Center-

Chris Green is recieving errors  surrounding use of Role Based authorization
services provided  by your local GUMS.
Chris is using voms-proxy-init to setup his roles but these seem to be
problems on the BNL sites related to the user/group id to which his jobs
are mapped. He explains&#58;

&#34;
I have discovered that my job-push (and pull) tests fail whenever the cert used is my
KCA cert. The
output of the /usr/bin/id command might be illustrative here&#58;

CERT
Command output
DOE
uid=75002(grid5002) gid=69909(gadu) groups=69909(gadu) context=user_u&#58;system_r&#58;initrc_t
KCA
uid=73817(grid3817) gid=69919 groups=8775(stargrid),69919
context=user_u&#58;system_r&#58;initrc_t

The actual cause of the failure of GRIDFTP with my KCA cert is (I believe) the GID
69919 which
appears not to map to a name; &#34;stargrid&#34; is also strange as I know nothing about what
it is and
why I might be associated with it. However, it appears that there is a one-to-one
mapping between
DN, UID and GID regardless of current VO.
&#34;

Thanks-
leigh</pre></div><div class='update_description'><i onclick="document.location='2644#1162402480'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2006-11-01T17:34:40+00:00">Nov 1, 2006 05:34 PM UTC</time> by <b>Chris Green</b><a class="anchor" name="1162402480">&nbsp;</a></div><pre>Hi Leigh,

I think I understand the disconnect now. I am presenting a voms-proxy to
the site, not just a grid proxy. So, the BNL GUMS should have all the
information it needs to decide how to map this particular job based on
the VO/Group and Role information in the proxy. Am I misunderstanding
what should happen in this case?

Thanks,
Chris.

Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='2644#1162401182'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2006-11-01T17:13:02+00:00">Nov 1, 2006 05:13 PM UTC</time> by <b>leighg</b><a class="anchor" name="1162401182">&nbsp;</a></div><pre>Chris-

The last technical doc I have seen on the subject says this&#58;

6.3 What should be the default user mapping if a request comes in with a standard
proxy certificate without an indication of the desired role? Presumably the users
will register the same DN+CA in multiple VOMRS. If a user subsequently uses a legacy
client, what happens to the request since there is no way to determine which VO
should be used? [remember, the user may not know or have control over the site and
set of servers the job is sent to.]

This is the &#34;what is the default VO/role&#34; question from above. In Grid03 the user had
to &#34;know&#34; which of his certificates is mapped to which of his VOs at what site. This
has been reduced to &#34;to which role is my certificate mapped to at site X&#34;.

This question is currently being discussed (2005-01-17).

In the current architecture it is up to the GUMS administrator to define this
behavior (default mapping) for the local site. I see that this may breed confusion
and issues on the user sites if the GUMS administrators at different sites may
different default mapping choices. (And they will).
E.g. if I run at FNAL my default (primary) VO may be USCMS, at BNL my default VO may
be USATLAS.
-&#62; should we include a field in VOMRS which identifies a VO as a primary VO?
-&#62; should we recommend that there is no default mapping? Then legacy proxy support
would have to be specifically requested from the site/GUMS administrator.

From
<a href='http&#58;//www.fnal.gov/docs/products/voprivilege/documents/transition-to-privilege.html' target='_blank' rel='nofollow'>http&#58;//www.fnal.gov/docs/products/voprivilege/documents/transition-to-privilege.html</a>

Please let me know if you have udpates beyond this.

Thanks
leigh</pre></div><div class='update_description'><i onclick="document.location='2644#1162399039'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2006-11-01T16:37:19+00:00">Nov 1, 2006 04:37 PM UTC</time> by <b>Chris Green</b><a class="anchor" name="1162399039">&nbsp;</a></div><pre>Hi Leigh,

In general, I understand that this is true (I hope to be able to respond
to your comments later today and get a revised report up on the TWiki).
However, in BNL&#39;s case, I believe they are using GUMS and this therefore
becomes a GUMS configuration issue since it is technically possible to
do the desired mapping. I do understand though, that it would not be a
high priority for a fix since there *is* a workaround that I have
already started to put in place by obtaining five new certificates.

Thanks for looking in to this,
Chris.

--
Chris Green &#60;greenc@....&#62;, FNAL CD/CCF.
&#39;Phone (630) 840-2167.

Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='2644#1162398034'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2006-11-01T16:20:34+00:00">Nov 1, 2006 04:20 PM UTC</time> by <b>leighg</b><a class="anchor" name="1162398034">&nbsp;</a></div><pre>Chris-

As I explained in response to the user-support docuement.

you must have an seperate DN for each VO.

The privledge system can not garantee correct mapping
with the same DN mapped to multiple VO&#39;s.

Please let me know if you have further questions.

leigh</pre></div><div class='update_description'><i onclick="document.location='2644#1161908987'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2006-10-27T00:29:47+00:00">Oct 27, 2006 12:29 AM UTC</time> by <b>leighg</b><a class="anchor" name="1161908987">&nbsp;</a></div><pre>Hi,

I&#39;m afraid I&#39;m having some problems running on BNL_ATLAS_{1,2} that I think can be
traced to
these sites&#39; user and group mapping scheme.

I am a member of several VOs and VO groups as I am helping these groups get access to
resources
on the wider OSG and develop tools to facilitate same. My two certs are KCA and DOE,
with DNs as
follows&#58;

/DC=org/DC=doegrids/OU=People/CN=Christopher H. Green 851859

and

/DC=gov/DC=fnal/O=Fermilab/OU=People/CN=Chris Green/UID=greenc

They are both mapped to&#58;

fermilab&#58;/fermilab
fermilab&#58;/fermilab/miniboone
gadu&#58;/gadu
dzero&#58;/dzero

I have a set of tests to examine a site, which are run with a particular cert., VO,
group and role.
These are&#58;
ping (and/or &#34;globus-ping&#34;)
globus-job-run of /usr/bin/printenv
globus-job-run of /usr/bin/id
globus-url-copy of small file to /tmp
Retrieval of said small file
Removal of same.
I have discovered that my job-push (and pull) tests fail whenever the cert used is my
<div id='show_1945517795' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_1945517795'>KCA cert. The
output of the /usr/bin/id command might be illustrative here&#58;

CERT
Command output
DOE
uid=75002(grid5002) gid=69909(gadu) groups=69909(gadu) context=user_u&#58;system_r&#58;initrc_t
KCA
uid=73817(grid3817) gid=69919 groups=8775(stargrid),69919
context=user_u&#58;system_r&#58;initrc_t

The actual cause of the failure of GRIDFTP with my KCA cert is (I believe) the GID
69919 which
appears not to map to a name; &#34;stargrid&#34; is also strange as I know nothing about what
it is and
why I might be associated with it. However, it appears that there is a one-to-one
mapping between
DN, UID and GID regardless of current VO.

Quite apart from the extant technical problem (GRIDFTP fails when using KCA cert), I
would like to
open a dialog with the appropriate people at BNL on the collective behalf of the
VO/groups with
which I am currently working (I cannot currently find contact information under VORS
or gridcat).
Specificallly, MiniBooNE (a relatively small neutrino experiment at Fermilab), D0 (a
larger collider
experiment, also at Fermilab) and GADU (a small bio-infomatics collaboration at ANL)
are in
various stages of planning and/or executing large processing runs which would be
helped greatly by
being able to run on an opportunistic basis at BNL.

All three of these VOs have software that they install under (usually, I believe)
OSG_APP.
MiniBooNE&#39;s jobs check for the correct version of their software under OSG_APP and (with
appropriate locking) install it if it is missing. This and many other otherwise
reasonable actions
become problematic if a job for a particular VO cannot be guaranteed to be running as
the same
user or in the alternative, the same group. I am also personally aware of one user
who is a bona-
fide physics user in both the ATLAS and CDF experiments for whom being able to operate
independently in both VOs will shortly become essential.

I&#39;d be grateful if you could bring these matters (the immediate technical problem and
the wider
issues) to the attention of these sites&#39; contacts in the hope of helping these VOs in
particular, and
in addition advancing the wider aims of OSG.

Thanks for your time and help,
Chris.

--
Chris Green &#60;greenc@....&#62;, FNAL CD/CCF.
&#39;Phone (630) 840-2167.
</div><script type='text/javascript'>
        $('#show_1945517795').click(function() {
            $('#detail_1945517795').slideDown("normal");
            $('#show_1945517795').hide();
            $('#hide_1945517795').show();
        });
        $('#hide_1945517795').click(function() {
            $('#detail_1945517795').slideUp();
            $('#hide_1945517795').hide();
            $('#show_1945517795').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='2644#1161722364'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2006-10-24T20:39:24+00:00">Oct 24, 2006 08:39 PM UTC</time> by <b>Tim Silvers</b><a class="anchor" name="1161722364">&nbsp;</a></div><pre>Hi,

I&#39;m afraid I&#39;m having some problems running on BNL_ATLAS_{1,2} that I think can be traced to
these sites&#39; user and group mapping scheme.

I am a member of several VOs and VO groups as I am helping these groups get access to resources
on the wider OSG and develop tools to facilitate same. My two certs are KCA and DOE, with DNs as
follows&#58;

/DC=org/DC=doegrids/OU=People/CN=Christopher H. Green 851859

and

/DC=gov/DC=fnal/O=Fermilab/OU=People/CN=Chris Green/UID=greenc

They are both mapped to&#58;

fermilab&#58;/fermilab
fermilab&#58;/fermilab/miniboone
gadu&#58;/gadu
dzero&#58;/dzero

I have a set of tests to examine a site, which are run with a particular cert., VO, group and role.
These are&#58;
ping (and/or &#34;globus-ping&#34;)
globus-job-run of /usr/bin/printenv
globus-job-run of /usr/bin/id
globus-url-copy of small file to /tmp
Retrieval of said small file
Removal of same.
I have discovered that my job-push (and pull) tests fail whenever the cert used is my KCA cert. The
output of the /usr/bin/id command might be illustrative here&#58;

CERT
Command output
<div id='show_57180514' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_57180514'>DOE
uid=75002(grid5002) gid=69909(gadu) groups=69909(gadu) context=user_u&#58;system_r&#58;initrc_t
KCA
uid=73817(grid3817) gid=69919 groups=8775(stargrid),69919 context=user_u&#58;system_r&#58;initrc_t

The actual cause of the failure of GRIDFTP with my KCA cert is (I believe) the GID 69919 which
appears not to map to a name; &#34;stargrid&#34; is also strange as I know nothing about what it is and
why I might be associated with it. However, it appears that there is a one-to-one mapping between
DN, UID and GID regardless of current VO.

Quite apart from the extant technical problem (GRIDFTP fails when using KCA cert), I would like to
open a dialog with the appropriate people at BNL on the collective behalf of the VO/groups with
which I am currently working (I cannot currently find contact information under VORS or gridcat).
Specificallly, MiniBooNE (a relatively small neutrino experiment at Fermilab), D0 (a larger collider
experiment, also at Fermilab) and GADU (a small bio-infomatics collaboration at ANL) are in
various stages of planning and/or executing large processing runs which would be helped greatly by
being able to run on an opportunistic basis at BNL.

All three of these VOs have software that they install under (usually, I believe) OSG_APP.
MiniBooNE&#39;s jobs check for the correct version of their software under OSG_APP and (with
appropriate locking) install it if it is missing. This and many other otherwise reasonable actions
become problematic if a job for a particular VO cannot be guaranteed to be running as the same
user or in the alternative, the same group. I am also personally aware of one user who is a bona-
fide physics user in both the ATLAS and CDF experiments for whom being able to operate
independently in both VOs will shortly become essential.

I&#39;d be grateful if you could bring these matters (the immediate technical problem and the wider
issues) to the attention of these sites&#39; contacts in the hope of helping these VOs in particular, and
in addition advancing the wider aims of OSG.

Thanks for your time and help,
Chris.

--
Chris Green &#60;greenc@....&#62;, FNAL CD/CCF.
&#39;Phone (630) 840-2167.
</div><script type='text/javascript'>
        $('#show_57180514').click(function() {
            $('#detail_57180514').slideDown("normal");
            $('#show_57180514').hide();
            $('#hide_57180514').show();
        });
        $('#hide_57180514').click(function() {
            $('#detail_57180514').slideUp();
            $('#hide_57180514').hide();
            $('#show_57180514').show();
        });
        </script></pre></div><legend>Similar Recent Tickets <small>modified within the last 30 days</small></legend><div id="similar_tickets"><p class="muted">No similar tickets found.</p></div>
</div>
<script type="text/javascript">
function reset_anchor() {
    $("#updates .selected").removeClass("selected");
    var urls = document.location.toString().split('#'); 
    var anchor = urls[1];
    if(anchor) {
        $("a[name='"+anchor+"']").parents(".update_description").addClass("selected");
    }
}
function submitspam(ticket_id) {
    myret = confirm("Would you like to close this ticket as a security ticket, and submit the ticket content to akismet?");
    if(myret == true) {
        $.ajax("viewer/processspam?id="+ticket_id).done(function() {
            window.location.reload();
        });
    }
}

$(function() {
    reset_anchor();
    var ADDITIONAL_COOKIE_NAME = 'gocticket';
    var options = { path: '/', expires: 365};

    if(window.opener && window.opener.name == "gocticket_list") {
        v = $.cookie("closewindow");
        if(!v) {
            $("#closewindow").attr("checked", "checked"); //on by default
        } else {
            if(v == "checked") {
                $("#closewindow").attr("checked", "checked");
            }
        }
        $("#closewindow").click(function() {
            $.cookie("closewindow", $(this).attr('checked'), options);
        });
    } else {
        $("#closewindow_area").hide();
    }
    function updateTimeago() {
        $("time").timeago();
        setTimeout(updateTimeago, 30*1000);
    }
    updateTimeago();
    $(".description").focus(expand_description);
});
</script>
<hr/>
<footer>
<p>GOC Ticket Version 2.2 | <a href="https://ticket.opensciencegrid.org/goc/submit?app_issue_check=on&amp;app_issue_type=goc&amp;app_goc_url=https%3A%2F%2Fticket.opensciencegrid.org%3A443%2F2644">Report Bugs</a>
 | <a href="https://github.com/opensciencegrid/operations/blob/master/docs/privacy.md">Privacy Policy</a>
</p>

<p> <img align="top" src="images/tag_orange.png"/> Copyright 2018 The Trustees of Indiana University - Developed for Open Science Grid</p>
</footer>


</div><!--container-fluid-->
<script src="https://ticket1.grid.iu.edu:8443/socket.io/socket.io.js"></script>
<script>
var chat = io.connect('https://ticket1.grid.iu.edu:8443');
chat.on('connect', function() {
    chat.emit('authenticate', {nodekey:'', ticketid: 2644});
});
chat.on('peers', function(peers) {
    $("#peers").html("");
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('peer_disconnect', function(pid) {
    $("#peer_"+pid).hide("slow");
});
chat.on('peer_connected', function(peers) {
    //expect only 1 peer connecting, but..
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('submit', function() {
    if(confirm("This ticket was updated. Do you want to refresh?")) {
        history.go(0);
    }
});

function addPeer(pid, peer) {
    var ipinfo = "";
    if(peer.ip != undefined) {
        ipinfo = "<span class=\"ip\">"+peer.ip+"</span>";
    }
    if(chat.io.engine.id == pid) {
        //don't display myself
        return;
    }
    var html = "<li class=\"new\" id=\"peer_"+pid+"\" class=\"peer\">"+peer.name+ipinfo+"</li>";
    $("#peers").prepend(html);
    $("#peers .new").animate({bottom: 0}, 1000, function() {$(this).removeClass("new")});
}

$(function() {
    $("#ticket_form").submit(function() {
        chat.emit('submit');
        return true;
    });
});
</script>
<script>
//used by searchbox
function parseValue(value) {
    var obj = new Object();
    var tokens = value.split("\t");
    obj.str = tokens[0];
    obj.count = tokens[1];
    return obj;
}

$(function() {
    //bootstrap-2.0.4 stuff
    $(".alert-message").alert();
    $(".dropdown-toggle").dropdown();
    $("span[rel='tooltip']").tooltip();
    $("a[rel=popover]").popover();

    //activate menu that user is currently on
    $("#menu_navigator").addClass("active"); 
    $("#submenu_").addClass("active"); 

    //translate zend validation error message to bootstrap
    $(".errors").addClass("alert").addClass("alert-error");

    //enable autocomplete for search box
    $("#search").autocomplete({
        source: function( request, response ) {
            $.ajax({
                url: "search/autocomplete",
                dataType: "text",
                data: {
                    //featureClass: "P",
                    //style: "full",
                    //maxRows: 12,
                    //name_startsWith: request.term
                    q: request.term
                },
                success: function( data ) {
                    response( $.map( data.split("\n"), function( item ) {
                        if(item == "") return null;
                        return {
                            value: item
                        }
                    }));
                }
            });
        },
        select: function(event, ui) {
            document.location = "search?q="+ui.item.value;
        }
    });
    
});
</script>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-69012-13");
pageTracker._trackPageview();
} catch(err) {}
</script>

</body>
