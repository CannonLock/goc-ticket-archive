<!DOCTYPE html>
<html lang="en">
  <head>
  <base href="">
    <title>[4963] Gratia inquiry - SBGrid-Harvard-Exp</title>    <meta charset="utf-8" />
    <meta name="verify-v1" content="na5IcAJsZVOfEkboRxuIiZ1zpZgnZiWra+nKcS7nA/o=" />
    <meta name="google-site-verification" content="DLrk3ft4s8b-S2TloLCL2LD_t6wcTjgSluf5pmiu2kA" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />
    <link href="https://ticket.opensciencegrid.org/rss" rel="alternate" type="application/rss+xml" title="GOC Ticket Update feed" />

    <style type="text/css">
      body {
        padding-top: 50px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
     #search {
            width: 300px;
     }

    </style>

<script src="https://code.jquery.com/jquery-3.0.0.js"></script>
<script src="https://code.jquery.com/jquery-migrate-3.0.1.js"></script>

   <link href="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet"/>
    <script src="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/js/bootstrap.min.js"></script>

    <link href="https://netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"/>
    <link href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/themes/smoothness/jquery-ui.min.css" rel="stylesheet"/>
 <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>


    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/js/select2.min.js"></script>

    <link href="css/ticket.css" rel="stylesheet" />
    <script src="lib/jquery.cookie.js"></script>

    <link href="images/tag_orange.png" rel="icon" type="image/png"/>
    <script src='https://www.google.com/recaptcha/api.js'></script>
  </head>

  <body>
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>

            <a class="brand" style="padding: 6px 0px 0px 6px;" href="http://opensciencegrid.org"><img src="images/osglogo.40x30.png"/></a>
            <ul class="nav">
                <li class="dropdown"><a href="https://ticket.opensciencegrid.org/#" class="dropdown-toggle" data-toggle="dropdown">GOC Ticket <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    <li><a href="https://my.opensciencegrid.org">MyOSG</a></li>
                    <li><a href="https://oim.opensciencegrid.org">OIM</a></li>
                    <li class="active"><a href="https://ticket.opensciencegrid.org/index">Ticket</a></li>
	<li class="divider"></li>
	<li><a href="http://repo.grid.iu.edu">Repo</a></li>
	<li class="divider"></li>
	<li><a href="http://blogs.grid.iu.edu">Blog</a></li>
                    <li><a href="http://display.grid.iu.edu">Display</a></li>
                    <li><a href="http://osggoc.blogspot.com/">News</a></li>
                    </ul>
                </li>
            </ul>
            <ul class="nav pull-right">
                <li><a href="https://ticket.opensciencegrid.org/sso/">Login</a></li>            </ul>

            <div class="nav-collapse">
                <ul class="nav">
			 <li id="menu_submit"><a href="https://ticket.opensciencegrid.org/submit">Submit</a></li><li id="menu_view" class="dropdown"><a href="https://ticket.opensciencegrid.org/\#" class="dropdown-toggle" data-toggle="dropdown">View <b class="caret"></b></a><ul class="dropdown-menu"><li id="submenu_listopen"><a href="https://ticket.opensciencegrid.org/list/open">Open Tickets</a></li><li id="submenu_listrecentclose"><a href="https://ticket.opensciencegrid.org/list/recentclose">Recently Closed Tickets</a></li><li class="divider"></li><li id="submenu_alltickets"><a href="https://ticket.opensciencegrid.org/search?q=&amp;sort=id">All Tickets</a></li></ul></li>                </ul>

                <form class="navbar-search pull-right" action="https://ticket.opensciencegrid.org/viewer">
                    <input id="search" type="text" name="id" class="search-query span2" placeholder="Search Ticket" value=""/>
                </form>
            </div>
        </div>
      </div>
    </div>

<script type='text/javascript' src='lib/jquery.timeago.js'></script>
<script type='text/javascript' src='lib/byte2size.js'></script>
<style>
#updates .toolbar {
position: relative;
margin-top: 0px;
top: -10px;
font-weight: normal;
}
#updates a.anchor {
position: relative;
top: -50px;
}
#updates .selected pre {
animation:selected 2s;
animation-iteration-count: 2;
animation-direction: alternate;
-webkit-animation:selected 2s; 
-webkit-animation-iteration-count: 2;
-webkit-animation-direction: alternate;
box-shadow: inset 1px 1px 20px #9ad;
border: 1px solid #9ab;
margin: 5px 0px;
padding-left: 10px;
}
@keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ab;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
@-webkit-keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ad;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
#updates pre {
background-color: inherit;
line-height: 15px;
padding: 5px;
}
#updates .header {
color: #999;
}
#updates .update_history pre {
background-color: #eee;
color: #666;
font-size: 85%;
}
#updates .clickable {
cursor: pointer;
}
#updates .clickable:hover {
color: #D98719;
}
#updates .meta_information pre {
background-color: #fed;
}
#similar_tickets {
max-height: 300px;
overflow-y: auto;
pointer-events: none;
padding: 5px;
background-color: #f4f4f4;
}
.btn-toolbar {
margin-bottom: 0;
height: 30px;
}
#peers {
position: fixed;
bottom: 0px;
right: 0px;
z-index: 100;
list-style: none;
padding: 5px 0px 0px 5px;
margin: 0px;
background-color: white;
box-shadow: 0px 0px 10px white;
}
#peers li {
background-color: #ccc;
color: #000;
display: inline-block;
padding: 5px 10px;
margin-right: 5px;
position: relative;
}
/*
#peers li:hover {
background-color: #999;
cursor: pointer;
}
*/
#peers span.ip {
padding-left: 5px;
color: #666;
}
#peers .new {
bottom: -30px;
}
/*
#peers .me {
background-color: red;
}
*/
</style>

<div class="container-fluid">
<ul id="peers"></ul>
<div class="alert alert-danger"><a class="close" href="https://ticket.opensciencegrid.org/#" data-dismiss="alert">&times;</a>By the end of May 2018, the ticketing system at https://ticket.opensciencegrid.org will be retired and support will be provided at https://support.opensciencegrid.org. Throughout this transition the support email (help@opensciencegrid.org) will be available as a point of contact.<br><br>                                                   
                                                                                                                                                                                   
Please see the service migration page for details: https://opensciencegrid.github.io/technology/policy/service-migrations-spring-2018/#ticket</div><div id="presence" class="pull-right"></div><div class="ticketgui"><script type="text/javascript" src="lib/checktab.js"></script>

<script>
var expanded = false;
function expand_description() {
    var desc = $(".description");
    if(!expanded) {
        expanded = true;
        //expand to minheight
        var min = 250;
        if(desc.height() < min) {
            desc.animate({height: min}, 200);
        }
    }
}

$(document).ready(function() {
    $("input[name='nad']").datepicker({
        dateFormat: 'yy-mm-dd'
    });
});

</script>



<style>
.form-horizontal .control-label {
padding-top: inherit;
font-size:90%;
color:#666;
}
label {
margin-bottom: 0px;
}
.controls {
line-height: 18px;
}
</style>
<form class="form-horizontal" action="https://ticket.opensciencegrid.org/viewer/updatebasic?id=4963" method="post">
<div class="page-header">
    <h3><span class="muted">4963</span> / Gratia inquiry - SBGrid-Harvard-Exp</h3>
</div>

<div class="row-fluid">
<div class="span5">
    <legend>Contact</legend>
    <div class="control-group">
        <label class="control-label">Full Name</label>
        <div class="controls">Ian Stokes-rees</div>
    </div>
    <div class="control-group">
        <label class="control-label">Email</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">Phone</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">CC</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>

    <legend>Details</legend>
    
    <div class="control-group">
        <label class="control-label">Ticket Type</label>
        <div class="controls">Problem/Request</div>
    </div>
    <div class="control-group">
        <label class="control-label">Priority</label>
        <div class="controls">Normal</div>
    </div>
    <div class="control-group">
        <label class="control-label">Status</label>
        <div class="controls">
Closed</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action</label>
        <div class="controls">assist with gratia</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action Deadline</label>
        <div class="controls flag_red">2008-07-18</div>
    </div>

</div><!--span-->
<div class="span7">
    <legend>Assignees</legend>
    <div class="assignee" style="width: 60%">OSG-GOC <span class="muted"> / OSG Support Centers</span></div>    <br>

    <legend>Assignees</legend>
    TODO
    <br>

    <style>
legend.noborder {
border-bottom: none;
}
</style>

<div id="attachment-list"/>
<script>
$(function () {
    var first = true;
    $.getJSON("attachment/list/4963", function (files) {
        //console.dir(files);
        var html = "<table class=\"table table-condensed\">";
        $(files).each(function() {
            if(first) {
                first = false;
                html += "<legend class=\"noborder\">Attachmenets</legend>";
            }
            html += "<tr class=\"attachment\">";
            html += "<td><img src="\&quot;&quot;+this.thumbnail_url+&quot;\&quot;/"></td>";
            html += "<td><a href="\&quot;&quot;+this.url+&quot;\&quot;" target=\"_blank\">"+this.name+"</a></td>";
            html += "<td>"+bytesToSize(this.size, 1)+"</td>";
            html += "</tr>";
        });
        html += "</table>";
        $("#attachment-list").html(html);
    });
});

function download(url) {
    window.open(url, "_blank");
}
</script>


</div><!--span-->
</div><!--row-fluid-->


</form>

</div>
<div id="updates" style="clear: both;">
    <legend>Past Updates
    <div class="btn-toolbar pull-right toolbar">
        <div class="btn-group">
                <a class="btn btn-small" href="https://ticket.opensciencegrid.org/4963?sort=up&amp;"><i class="icon-arrow-up"></i> Sort</a>

        
        <a class="btn btn-small" href="https://ticket.opensciencegrid.org/4963?expandall=true&amp;">Expand Descriptions</a>        <a class="btn btn-small" target="_blank" href="mailto:osg@tick.globalnoc.iu.edu?subject=Open%20Science%20Grid%3A%20Gratia%20inquiry%20-%20SBGrid-Harvard-Exp%20ISSUE%3D4963%20PROJ%3D71"><i class="icon-envelope"></i> Update w/Email</a>
        </div>
    </div><!--btn-toolbar-->
    </legend>

    <div class='update_description'><i onclick="document.location='4963#1216325136'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2008-07-17T20:05:36+00:00">Jul 17, 2008 08:05 PM UTC</time> by <b>echism</b><a class="anchor" name="1216325136">&nbsp;</a></div><pre>Closing until further notice. Will reopen as appropriate.</pre></div><div class='update_description'><i onclick="document.location='4963#1215723908'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2008-07-10T21:05:08+00:00">Jul 10, 2008 09:05 PM UTC</time> by <b>Ian Stokes-Rees</b><a class="anchor" name="1215723908">&nbsp;</a></div><pre>No, we don&#39;t have a local Gratia collector setup. This is low priority for us now, so this ticket can be considered closed. Otherwise I think everything else is running.

Ian

Open Science Grid FootPrints wrote&#58;  [Duplicate message snipped]</pre></div><div class='update_description'><i onclick="document.location='4963#1215721417'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2008-07-10T20:23:37+00:00">Jul 10, 2008 08:23 PM UTC</time> by <b>echism</b><a class="anchor" name="1215721417">&nbsp;</a></div><pre>Ian,

Is this resolved? I see that you are at least reporting, are you populating your own
logs as well?

Thank you,
Elizabeth</pre></div><div class='update_description'><i onclick="document.location='4963#1215459849'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2008-07-07T19:44:09+00:00">Jul 7, 2008 07:44 PM UTC</time> by <b>Philippe Canal</b><a class="anchor" name="1215459849">&nbsp;</a></div><pre>Hi,

The metric probe is the RSV probe and indeed this should not report to
<a href='http&#58;//gratia.opensciencegrid.org&#58;8880' target='_blank' rel='nofollow'>http&#58;//gratia.opensciencegrid.org&#58;8880</a>

Cheers,
Philippe.

-----Original Message-----
From&#58; owner-gratia-operation@....
[mailto&#58;owner-gratia-operation@....] On Behalf Of Open
Science Grid FootPrints
Sent&#58; Monday, July 07, 2008 2&#58;05 PM
To&#58; gratia-operation@....
Subject&#58; Open Science Grid&#58; Gratia inquiry - SBGrid-Harvard-Exp ISSUE=4963
PROJ=71

[Duplicate message snipped]</pre></div><div class='update_description'><i onclick="document.location='4963#1215457508'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2008-07-07T19:05:08+00:00">Jul 7, 2008 07:05 PM UTC</time> by <b>Ian Stokes-Rees</b><a class="anchor" name="1215457508">&nbsp;</a></div><pre>I stopped then restarted tomcat-55 this morning. That momentarily seemed to fix GIP and Gratia, but then it seems to have died again. This time a tomcat restart hasn&#39;t helped. From an earlier entry on this ticket, I tried&#58;

wget -q -O - &#39;<a href='http&#58;//gratia.opensciencegrid.org&#58;8880/gratia-administration/monitor-status.html?allsites=1&#39' target='_blank' rel='nofollow'>http&#58;//gratia.opensciencegrid.org&#58;8880/gratia-administration/monitor-status.html?allsites=1&#39</a>; | grep -i harv

SBGrid-Harvard-Exp|condor&#58;abitibi.sbgrid.org|2008-07-07 16&#58;28&#58;48
SBGrid-Harvard-Exp|metric&#58;abitibi.sbgrid.org|2008-06-24 14&#58;08&#58;29

but I&#39;m not sure what the difference is between &#34;condor&#34; and &#34;metric&#34;.

We have some people coming tomorrow from OSG Central Committee to help us troubleshoot our site. Hopefully they can help us get to the bottom of it.

Ian

Open Science Grid FootPrints wrote&#58;  [Duplicate message snipped]</pre></div><div class='update_description'><i onclick="document.location='4963#1215455973'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2008-07-07T18:39:33+00:00">Jul 7, 2008 06:39 PM UTC</time> by <b>echism</b><a class="anchor" name="1215455973">&nbsp;</a></div><pre>Ian,

Have you had a chance to look at this? I know you&#39;ve been busy.

Thanks,
Elizabeth</pre></div><div class='update_description'><i onclick="document.location='4963#1214852709'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2008-06-30T19:05:09+00:00">Jun 30, 2008 07:05 PM UTC</time> by <b>Chris Green</b><a class="anchor" name="1214852709">&nbsp;</a></div><pre>Hi,

It looks like Ian might be conflating two problems.

The first (the original purpose of this ticket) is that Ian&#39;s gatekeeper
wasn&#39;t reporting data to the official OSG Gratia site,
gratia.opensciencegrid.org&#58;8880 (a.k.a. gratia-osg.fnal.gov&#58;8880). Based
on what Elizabeth was seeing, this appears to have been resolved.

Of course, if we are receiving records but Ian&#39;s own collector is not,
that suggests we might be dealing with something as simple as the
gatekeeper&#39;s ProbeConfig sending the data to the &#34;wrong&#34; place. If Ian
is implementing a local collector his probes should be sending there and
his collector should be set up to replicate to us.

Ian, you should be using the latest collector from VDT as available in
1.10.1e (I think)&#58; version 0.34.9.

Let me know if it&#39;s not as simple as reconfiguring your gatekeeper probe.

Thanks,
Chris.

Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='4963#1214846600'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2008-06-30T17:23:20+00:00">Jun 30, 2008 05:23 PM UTC</time> by <b>echism</b><a class="anchor" name="1214846600">&nbsp;</a></div><pre>Ian,

I see you reporting here&#58; <a href='http&#58;//gratia-osg.fnal.gov&#58;8880/gratia-reporting/' target='_blank' rel='nofollow'>http&#58;//gratia-osg.fnal.gov&#58;8880/gratia-reporting/</a>
If you look at the &#34;usage by site&#34; section, this does indeed appear to be resolved.
Can you clarify what problems remain?

Thank you,
Elizabeth</pre></div><div class='update_description'><i onclick="document.location='4963#1214596266'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2008-06-27T19:51:06+00:00">Jun 27, 2008 07:51 PM UTC</time> by <b>echism</b><a class="anchor" name="1214596266">&nbsp;</a></div><pre>Are there any updates on this?

Thank you,
Elizabeth</pre></div><div class='update_description'><i onclick="document.location='4963#1213992566'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2008-06-20T20:09:26+00:00">Jun 20, 2008 08:09 PM UTC</time> by <b>echism</b><a class="anchor" name="1213992566">&nbsp;</a></div><pre>Gratia-ops and Chris,

We haven&#39;t heard back on this issue. Could you respond to Ian&#39;s inquiry? See below&#58;

No, I don&#39;t think it is. It looks to me like my Gratia deployment is hosed. I don&#39;t
see any good data coming out of it. If you can access&#58;

<a href='https&#58;//abitibi.sbgrid.org&#58;8443/gratia-administration' target='_blank' rel='nofollow'>https&#58;//abitibi.sbgrid.org&#58;8443/gratia-administration</a>
<a href='https&#58;//abitibi.sbgrid.org&#58;8443/gratia-reporting/' target='_blank' rel='nofollow'>https&#58;//abitibi.sbgrid.org&#58;8443/gratia-reporting/</a>

you can look for yourself. Perhaps it is best to wait until next week when OSG v1.0
is released, based on (I assume) VDT 1.10, then I can try to get it up and running again.

I am working through the troubleshooting guide. My first comment, is that I would
like to have the configuration where we do all accounting locally and then mirror
this to a central accounting collector. That said, in the first instance I am happy
just to get it working.

Questions&#58;

* Should I be reporting to gratia.opensciencegrid.org&#58;8880 or rsv.grid.iu.edu&#58;8880?

* I run the gratia-site-diag script and it returns an error regarding
gratia-probe-metric. I don&#39;t have this service and there is no documentation I can
find on how to install it. Here are the error messages I get which I can&#39;t do
anything about (the configure_gratia command has been executed)&#58;

<font color='#7F7E6F'>&#62; Checking for existence and date of probe log file gratia-probe-metric.log ...</font>
<font color='#7F7E6F'>&#62; WARNING&#58; gratia-probe-metric.log does not exist&#58;</font>
is probe service enabled with vdt-control --on?
<font color='#7F7E6F'>&#62; Checking gratia_probe_metric_ProbeConfig&#58;</font>
<font color='#7F7E6F'>&#62; Please run the following commands&#58;</font>
<font color='#7F7E6F'>&#62; /opt/vdt/vdt/setup/configure_gratia --probe metric --probe-cron --report-to</font>
gratia.opensciencegrid.org&#58;8880
<font color='#7F7E6F'>&#62; Check by re-running this diagnostics script and hand-correcting</font>
<div id='show_1501151710' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_1501151710'>any remaining problems.
<font color='#7F7E6F'>&#62; Obtain and run gratia-repair-tmpfiles (instructions and download at</font>
<a href='https&#58;//twiki.grid.iu.edu/twiki/bin/view/Accounting/TroubleShootingInstructions' target='_blank' rel='nofollow'>https&#58;//twiki.grid.iu.edu/twiki/bin/view/Accounting/TroubleShootingInstructions</a>)
to clear any backlogged XML files if they exist.
<font color='#7F7E6F'>&#62; Finally, execute&#58;</font>
<font color='#7F7E6F'>&#62; vdt-control --on gratia-metric</font>

* I have run gratia-repair-tmpfiles but it didn&#39;t seem to do anything. The output is
below&#58;

[root@abitibi gratia]# chmod a+x gratia-repair-tmpfiles
[root@abitibi gratia]# ./gratia-repair-tmpfiles
INFO&#58; defaulting replace string to &#34;gratia.opensciencegrid.org_8880&#34;

Please let me know how to proceed to get Gratia working.

Ian

Thank you,
Elizabeth
</div><script type='text/javascript'>
        $('#show_1501151710').click(function() {
            $('#detail_1501151710').slideDown("normal");
            $('#show_1501151710').hide();
            $('#hide_1501151710').show();
        });
        $('#hide_1501151710').click(function() {
            $('#detail_1501151710').slideUp();
            $('#hide_1501151710').hide();
            $('#show_1501151710').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='4963#1213382828'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2008-06-13T18:47:08+00:00">Jun 13, 2008 06:47 PM UTC</time> by <b>Ian Stokes-Rees</b><a class="anchor" name="1213382828">&nbsp;</a></div><pre>No, I don&#39;t think it is. It looks to me like my Gratia deployment is hosed. I don&#39;t see any good data coming out of it. If you can access&#58;

<a href='https&#58;//abitibi.sbgrid.org&#58;8443/gratia-administration' target='_blank' rel='nofollow'>https&#58;//abitibi.sbgrid.org&#58;8443/gratia-administration</a>
<a href='https&#58;//abitibi.sbgrid.org&#58;8443/gratia-reporting/' target='_blank' rel='nofollow'>https&#58;//abitibi.sbgrid.org&#58;8443/gratia-reporting/</a>

you can look for yourself. Perhaps it is best to wait until next week when OSG v1.0 is released, based on (I assume) VDT 1.10, then I can try to get it up and running again.

I am working through the troubleshooting guide. My first comment, is that I would like to have the configuration where we do all accounting locally and then mirror this to a central accounting collector. That said, in the first instance I am happy just to get it working.

Questions&#58;

* Should I be reporting to gratia.opensciencegrid.org&#58;8880 or rsv.grid.iu.edu&#58;8880?

* I run the gratia-site-diag script and it returns an error regarding gratia-probe-metric. I don&#39;t have this service and there is no documentation I can find on how to install it. Here are the error messages I get which I can&#39;t do anything about (the configure_gratia command has been executed)&#58;

&gt; Checking for existence and date of probe log file gratia-probe-metric.log ...
&gt; WARNING&#58; gratia-probe-metric.log does not exist&#58;
is probe service enabled with vdt-control --on?
&gt; Checking gratia_probe_metric_ProbeConfig&#58;
&gt; Please run the following commands&#58;
&gt; /opt/vdt/vdt/setup/configure_gratia --probe metric --probe-cron --report-to gratia.opensciencegrid.org&#58;8880
&gt; Check by re-running this diagnostics script and hand-correcting
any remaining problems.
&gt; Obtain and run gratia-repair-tmpfiles (instructions and download at
<a href='https&#58;//twiki.grid.iu.edu/twiki/bin/view/Accounting/TroubleShootingInstructions' target='_blank' rel='nofollow'>https&#58;//twiki.grid.iu.edu/twiki/bin/view/Accounting/TroubleShootingInstructions</a>)
to clear any backlogged XML files if they exist.
&gt; Finally, execute&#58;
&gt; vdt-control --on gratia-metric

* I have run gratia-repair-tmpfiles but it didn&#39;t seem to do anything. The output is below&#58;

[root@abitibi gratia]# chmod a+x gratia-repair-tmpfiles
[root@abitibi gratia]# ./gratia-repair-tmpfiles
INFO&#58; defaulting replace string to &#34;gratia.opensciencegrid.org_8880&#34;

<div id='show_1923412212' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_1923412212'>Please let me know how to proceed to get Gratia working.

Ian

Open Science Grid FootPrints wrote&#58;  [Duplicate message snipped]
</div><script type='text/javascript'>
        $('#show_1923412212').click(function() {
            $('#detail_1923412212').slideDown("normal");
            $('#show_1923412212').hide();
            $('#hide_1923412212').show();
        });
        $('#hide_1923412212').click(function() {
            $('#detail_1923412212').slideUp();
            $('#hide_1923412212').hide();
            $('#show_1923412212').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='4963#1213312471'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2008-06-12T23:14:31+00:00">Jun 12, 2008 11:14 PM UTC</time> by <b>echism</b><a class="anchor" name="1213312471">&nbsp;</a></div><pre>Ian,

Chris Green asked in an earlier update that we confirm that this was resolved to your
satisfaction. Is it resolved?

Thank you,
Elizabeth</pre></div><div class='update_description'><i onclick="document.location='4963#1212775304'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2008-06-06T18:01:44+00:00">Jun 6, 2008 06:01 PM UTC</time> by <b>echism</b><a class="anchor" name="1212775304">&nbsp;</a></div><pre>Ian,

We never heard back from you on this. Could you confirm that whether this is or is
not resolved?

Thank you,
Elizabeth</pre></div><div class='update_description'><i onclick="document.location='4963#1212182048'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2008-05-30T21:14:08+00:00">May 30, 2008 09:14 PM UTC</time> by <b>Chris Green</b><a class="anchor" name="1212182048">&nbsp;</a></div><pre>Hi,

Please confirm with the admin, but I think we resolved the Gratia part
of this ticket offline.

Thanks,
Chris.

Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='4963#1212175459'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2008-05-30T19:24:19+00:00">May 30, 2008 07:24 PM UTC</time> by <b>echism</b><a class="anchor" name="1212175459">&nbsp;</a></div><pre>Hello,

Are there any updates on this issue?&#39;

Thank you,
Elizabeth</pre></div><div class='update_description'><i onclick="document.location='4963#1210640648'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2008-05-13T01:04:08+00:00">May 13, 2008 01:04 AM UTC</time> by <b>Ian Stokes-Rees</b><a class="anchor" name="1210640648">&nbsp;</a></div><pre>Hi,

I now don&#39;t seem to have any RSV or Gratia probes running, although I can&#39;t tell for sure.

Open Science Grid FootPrints wrote&#58;
So, there was a probe running on abitibi.hms.harvard.edu that stopped reporting on or about 2008/03/20 and has been running since on abitibi.sbgrid.org. However, it has not been configured with the correct site name.  I&#39;ve run the test script downloaded from the TWiki site. It still reports that my SiteName is abitibi.sbgrid.org, although when I look for any occurances of SiteName I can only find SBGrid-Harvard-Exp in my ProbeConfig file. Why would this be?
GOC, please advise on whether the correct thing to do is re-run configure-osg,sh or hand-edit the ProbeConfig file (the fact that this is wrong may indicate more problems that running configure-osg.sh again should fix).  I never heard back from the GOC.

Also, I think my RSV probes are no longer running -- they used to be listed when I did &#34;condor_q&#34; but I re-installed Condor and reset all the job pools, now the jobs are gone -- how do I get these back?

Cheers,

Ian
-- Ian Stokes-Rees W&#58; <a href='http&#58;//sbgrid.org' target='_blank' rel='nofollow'>http&#58;//sbgrid.org</a> ijstokes@.... T&#58; +1 617 418-4168 SBGrid, Harvard Medical School F&#58; +1 617 432-5600</pre></div><div class='update_description'><i onclick="document.location='4963#1210244289'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2008-05-08T10:58:09+00:00">May 8, 2008 10:58 AM UTC</time> by <b>Chris Green</b><a class="anchor" name="1210244289">&nbsp;</a></div><pre>Hi,,

There should never be anything in your gratia log file -- the one you
mentioned, that is. The information should all be in dated log files in
the same directory -- 2008-05-07.log, for instance.

Chris.

Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='4963#1210212968'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2008-05-08T02:16:08+00:00">May 8, 2008 02:16 AM UTC</time> by <b>Ian Stokes-Rees</b><a class="anchor" name="1210212968">&nbsp;</a></div><pre>Do I need to restart anything after doing this? If so what, and on which machines.

I&#39;m assuming the answer is to change it &#34;globally&#34; in my (shared) $CONDOR_DIR/etc/condor_config with&#58;

PER_JOB_HISTORY_DIR=/opt/vdt/gratia/var/data

tacked on the end and then

$ condor_off
$ condor_on

on the pool &#34;head&#34; node

If I&#39;ve got any of that wrong, please let me know, otherwise, let me know if that fixes it.

BTW, this still doesn&#39;t answer why I don&#39;t have anything in my gratia log file.

Cheers,

Ian

Open Science Grid FootPrints wrote&#58;  [Duplicate message snipped]</pre></div><div class='update_description'><i onclick="document.location='4963#1210205768'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2008-05-08T00:16:08+00:00">May 8, 2008 12:16 AM UTC</time> by <b>Chris Green</b><a class="anchor" name="1210205768">&nbsp;</a></div><pre>Further note&#58;

The OSG VO is running nightly tests on your site and this involves
running multiple fork and two GT2 batch jobs on your gatekeeper. These
jobs (at least last night) ran to completion, see

<a href='http&#58;//user-support.opensciencegrid.org/site_tests/osg/latest/' target='_blank' rel='nofollow'>http&#58;//user-support.opensciencegrid.org/site_tests/osg/latest/</a>

If you are running Condor version 6.9.0 or higher, please set the Condor
configuration value&#58;

PER_JOB_HISTORY_DIR

to $VDT_LOCATION/gratia/var/data

The need to do this will be removed in OSG 1.0 (although it will still
be the most efficient way to operate for Condor &#62;=6.9.0).

Please reply to the ticket if this is what you need to do so we can
verify the effects, or if we need to investigate further why jobs are
not being reported to Gratia.

Thanks,
Chris.

Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='4963#1210205228'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2008-05-08T00:07:08+00:00">May 8, 2008 12:07 AM UTC</time> by <b>Chris Green</b><a class="anchor" name="1210205228">&nbsp;</a></div><pre>Hi,

From&#58;
wget -q -O - &#39;<a href='http&#58;//gratia.opensciencegrid.org&#58;8880/gratia-administration/monitor-status.html?allsites=1&#39' target='_blank' rel='nofollow'>http&#58;//gratia.opensciencegrid.org&#58;8880/gratia-administration/monitor-status.html?allsites=1&#39</a>; | grep harv  I see&#58;
abitibi.sbgrid.org|condor&#58;abitibi.sbgrid.org|2008-05-07 23&#58;14&#58;02 abitibi.sbgrid.org|condor&#58;abitibi.hms.harvard.edu|2008-03-20 21&#58;35&#58;20 SBGrid-Harvard-East|condor&#58;mn.in.swlab|2008-05-07 23&#58;26&#58;13 Times are in UTC.

So, there was a probe running on abitibi.hms.harvard.edu that stopped reporting on or about 2008/03/20 and has been running since on abitibi.sbgrid.org. However, it has not been configured with the correct site name.

GOC, please advise on whether the correct thing to do is re-run configure-osg,sh or hand-edit the ProbeConfig file (the fact that this is wrong may indicate more problems that running configure-osg.sh again should fix).

Note however that
condor&#58;abitibi.sbgrid.org only ever sent 2 real job records; and
condor&#58;abitibi.hms.harvard.edu none. By contrast,
condor&#58;mn.in.swlab  has sent 4799 records in total. You might want to check that your gateway is actually accepting VOs.

Regardless, Ian&#58; please confirm that the correct site name should be&#58;

SBGrid-Harvard-Exp

This has already been corrected in our probe&#39;s translation tables but you should correct on your local system anyway.

In future, please see

<a href='https&#58;//twiki.grid.iu.edu/twiki/bin/view/Accounting/TroubleShootingInstructions' target='_blank' rel='nofollow'>https&#58;//twiki.grid.iu.edu/twiki/bin/view/Accounting/TroubleShootingInstructions</a>

I will endeavor to update the documentation to reflect your experiences.

Thanks,
Chris.

Open Science Grid FootPrints wrote&#58;  [Duplicate message snipped]</pre></div><div class='update_description'><i onclick="document.location='4963#1210190648'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2008-05-07T20:04:08+00:00">May 7, 2008 08:04 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1210190648">&nbsp;</a></div><pre>Queues = Grid

Submitter Name&#58; Ian Stokes-Rees

Application System&#58; ijstokes@....

Your Resource/Service Name&#58;
SBGrid-Harvard-Exp

Your VO Support Center&#58;
SBGrid

Your Phone Number&#58;
617-432-5608 x75

Description of Problem&#58;
My Gratia reporting is not running.  vdt-control lists it as being present (gratia-condor      | cron   | enable), the crontab entry is there, but the log file is empty&#58;

/opt/vdt/gratia/var/logs/gratia-probe-condor.log

I can&#39;t find any documentation on how I&#39;m supposed to test, configure, debug, or manually run gratia.

I read a general email sent to OSG-Sites which said our site was not reporting to Gratia and I should contact the GOC.  I would like to i) fix this; ii) be told where the documentation is so that I don&#39;t  need to email GOC in the future for this problem; and iii) understand what went wrong that Gratia stopped working.

Cheers,

Ian</pre></div><legend>Similar Recent Tickets <small>modified within the last 30 days</small></legend><div id="similar_tickets"><p class="muted">No similar tickets found.</p></div>
</div>
<script type="text/javascript">
function reset_anchor() {
    $("#updates .selected").removeClass("selected");
    var urls = document.location.toString().split('#'); 
    var anchor = urls[1];
    if(anchor) {
        $("a[name='"+anchor+"']").parents(".update_description").addClass("selected");
    }
}
function submitspam(ticket_id) {
    myret = confirm("Would you like to close this ticket as a security ticket, and submit the ticket content to akismet?");
    if(myret == true) {
        $.ajax("viewer/processspam?id="+ticket_id).done(function() {
            window.location.reload();
        });
    }
}

$(function() {
    reset_anchor();
    var ADDITIONAL_COOKIE_NAME = 'gocticket';
    var options = { path: '/', expires: 365};

    if(window.opener && window.opener.name == "gocticket_list") {
        v = $.cookie("closewindow");
        if(!v) {
            $("#closewindow").attr("checked", "checked"); //on by default
        } else {
            if(v == "checked") {
                $("#closewindow").attr("checked", "checked");
            }
        }
        $("#closewindow").click(function() {
            $.cookie("closewindow", $(this).attr('checked'), options);
        });
    } else {
        $("#closewindow_area").hide();
    }
    function updateTimeago() {
        $("time").timeago();
        setTimeout(updateTimeago, 30*1000);
    }
    updateTimeago();
    $(".description").focus(expand_description);
});
</script>
<hr/>
<footer>
<p>GOC Ticket Version 2.2 | <a href="https://ticket.opensciencegrid.org/goc/submit?app_issue_check=on&amp;app_issue_type=goc&amp;app_goc_url=https%3A%2F%2Fticket.opensciencegrid.org%3A443%2F4963">Report Bugs</a>
 | <a href="https://github.com/opensciencegrid/operations/blob/master/docs/privacy.md">Privacy Policy</a>
</p>

<p> <img align="top" src="images/tag_orange.png"/> Copyright 2018 The Trustees of Indiana University - Developed for Open Science Grid</p>
</footer>


</div><!--container-fluid-->
<script src="https://ticket1.grid.iu.edu:8443/socket.io/socket.io.js"></script>
<script>
var chat = io.connect('https://ticket1.grid.iu.edu:8443');
chat.on('connect', function() {
    chat.emit('authenticate', {nodekey:'', ticketid: 4963});
});
chat.on('peers', function(peers) {
    $("#peers").html("");
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('peer_disconnect', function(pid) {
    $("#peer_"+pid).hide("slow");
});
chat.on('peer_connected', function(peers) {
    //expect only 1 peer connecting, but..
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('submit', function() {
    if(confirm("This ticket was updated. Do you want to refresh?")) {
        history.go(0);
    }
});

function addPeer(pid, peer) {
    var ipinfo = "";
    if(peer.ip != undefined) {
        ipinfo = "<span class=\"ip\">"+peer.ip+"</span>";
    }
    if(chat.io.engine.id == pid) {
        //don't display myself
        return;
    }
    var html = "<li class=\"new\" id=\"peer_"+pid+"\" class=\"peer\">"+peer.name+ipinfo+"</li>";
    $("#peers").prepend(html);
    $("#peers .new").animate({bottom: 0}, 1000, function() {$(this).removeClass("new")});
}

$(function() {
    $("#ticket_form").submit(function() {
        chat.emit('submit');
        return true;
    });
});
</script>
<script>
//used by searchbox
function parseValue(value) {
    var obj = new Object();
    var tokens = value.split("\t");
    obj.str = tokens[0];
    obj.count = tokens[1];
    return obj;
}

$(function() {
    //bootstrap-2.0.4 stuff
    $(".alert-message").alert();
    $(".dropdown-toggle").dropdown();
    $("span[rel='tooltip']").tooltip();
    $("a[rel=popover]").popover();

    //activate menu that user is currently on
    $("#menu_navigator").addClass("active"); 
    $("#submenu_").addClass("active"); 

    //translate zend validation error message to bootstrap
    $(".errors").addClass("alert").addClass("alert-error");

    //enable autocomplete for search box
    $("#search").autocomplete({
        source: function( request, response ) {
            $.ajax({
                url: "search/autocomplete",
                dataType: "text",
                data: {
                    //featureClass: "P",
                    //style: "full",
                    //maxRows: 12,
                    //name_startsWith: request.term
                    q: request.term
                },
                success: function( data ) {
                    response( $.map( data.split("\n"), function( item ) {
                        if(item == "") return null;
                        return {
                            value: item
                        }
                    }));
                }
            });
        },
        select: function(event, ui) {
            document.location = "search?q="+ui.item.value;
        }
    });
    
});
</script>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-69012-13");
pageTracker._trackPageview();
} catch(err) {}
</script>

</body>
