<!DOCTYPE html>
<html lang="en">
  <head>
  <base href="">
    <title>[25290] OSG Jobs not releasing resources with SIGTERM</title>    <meta charset="utf-8" />
    <meta name="verify-v1" content="na5IcAJsZVOfEkboRxuIiZ1zpZgnZiWra+nKcS7nA/o=" />
    <meta name="google-site-verification" content="DLrk3ft4s8b-S2TloLCL2LD_t6wcTjgSluf5pmiu2kA" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />
    <link href="https://ticket.opensciencegrid.org/rss" rel="alternate" type="application/rss+xml" title="GOC Ticket Update feed" />

    <style type="text/css">
      body {
        padding-top: 50px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
     #search {
            width: 300px;
     }

    </style>

<script src="https://code.jquery.com/jquery-3.0.0.js"></script>
<script src="https://code.jquery.com/jquery-migrate-3.0.1.js"></script>

   <link href="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet"/>
    <script src="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/js/bootstrap.min.js"></script>

    <link href="https://netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"/>
    <link href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/themes/smoothness/jquery-ui.min.css" rel="stylesheet"/>
 <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>


    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/js/select2.min.js"></script>

    <link href="css/ticket.css" rel="stylesheet" />
    <script src="lib/jquery.cookie.js"></script>

    <link href="images/tag_orange.png" rel="icon" type="image/png"/>
    <script src='https://www.google.com/recaptcha/api.js'></script>
  </head>

  <body>
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>

            <a class="brand" style="padding: 6px 0px 0px 6px;" href="http://opensciencegrid.org"><img src="images/osglogo.40x30.png"/></a>
            <ul class="nav">
                <li class="dropdown"><a href="https://ticket.opensciencegrid.org/#" class="dropdown-toggle" data-toggle="dropdown">GOC Ticket <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    <li><a href="https://my.opensciencegrid.org">MyOSG</a></li>
                    <li><a href="https://oim.opensciencegrid.org">OIM</a></li>
                    <li class="active"><a href="https://ticket.opensciencegrid.org/index">Ticket</a></li>
	<li class="divider"></li>
	<li><a href="http://repo.grid.iu.edu">Repo</a></li>
	<li class="divider"></li>
	<li><a href="http://blogs.grid.iu.edu">Blog</a></li>
                    <li><a href="http://display.grid.iu.edu">Display</a></li>
                    <li><a href="http://osggoc.blogspot.com/">News</a></li>
                    </ul>
                </li>
            </ul>
            <ul class="nav pull-right">
                <li><a href="https://ticket.opensciencegrid.org/sso/">Login</a></li>            </ul>

            <div class="nav-collapse">
                <ul class="nav">
			 <li id="menu_submit"><a href="https://ticket.opensciencegrid.org/submit">Submit</a></li><li id="menu_view" class="dropdown"><a href="https://ticket.opensciencegrid.org/\#" class="dropdown-toggle" data-toggle="dropdown">View <b class="caret"></b></a><ul class="dropdown-menu"><li id="submenu_listopen"><a href="https://ticket.opensciencegrid.org/list/open">Open Tickets</a></li><li id="submenu_listrecentclose"><a href="https://ticket.opensciencegrid.org/list/recentclose">Recently Closed Tickets</a></li><li class="divider"></li><li id="submenu_alltickets"><a href="https://ticket.opensciencegrid.org/search?q=&amp;sort=id">All Tickets</a></li></ul></li>                </ul>

                <form class="navbar-search pull-right" action="https://ticket.opensciencegrid.org/viewer">
                    <input id="search" type="text" name="id" class="search-query span2" placeholder="Search Ticket" value=""/>
                </form>
            </div>
        </div>
      </div>
    </div>

<script type='text/javascript' src='lib/jquery.timeago.js'></script>
<script type='text/javascript' src='lib/byte2size.js'></script>
<style>
#updates .toolbar {
position: relative;
margin-top: 0px;
top: -10px;
font-weight: normal;
}
#updates a.anchor {
position: relative;
top: -50px;
}
#updates .selected pre {
animation:selected 2s;
animation-iteration-count: 2;
animation-direction: alternate;
-webkit-animation:selected 2s; 
-webkit-animation-iteration-count: 2;
-webkit-animation-direction: alternate;
box-shadow: inset 1px 1px 20px #9ad;
border: 1px solid #9ab;
margin: 5px 0px;
padding-left: 10px;
}
@keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ab;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
@-webkit-keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ad;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
#updates pre {
background-color: inherit;
line-height: 15px;
padding: 5px;
}
#updates .header {
color: #999;
}
#updates .update_history pre {
background-color: #eee;
color: #666;
font-size: 85%;
}
#updates .clickable {
cursor: pointer;
}
#updates .clickable:hover {
color: #D98719;
}
#updates .meta_information pre {
background-color: #fed;
}
#similar_tickets {
max-height: 300px;
overflow-y: auto;
pointer-events: none;
padding: 5px;
background-color: #f4f4f4;
}
.btn-toolbar {
margin-bottom: 0;
height: 30px;
}
#peers {
position: fixed;
bottom: 0px;
right: 0px;
z-index: 100;
list-style: none;
padding: 5px 0px 0px 5px;
margin: 0px;
background-color: white;
box-shadow: 0px 0px 10px white;
}
#peers li {
background-color: #ccc;
color: #000;
display: inline-block;
padding: 5px 10px;
margin-right: 5px;
position: relative;
}
/*
#peers li:hover {
background-color: #999;
cursor: pointer;
}
*/
#peers span.ip {
padding-left: 5px;
color: #666;
}
#peers .new {
bottom: -30px;
}
/*
#peers .me {
background-color: red;
}
*/
</style>

<div class="container-fluid">
<ul id="peers"></ul>
<div class="alert alert-danger"><a class="close" href="https://ticket.opensciencegrid.org/#" data-dismiss="alert">&times;</a>By the end of May 2018, the ticketing system at https://ticket.opensciencegrid.org will be retired and support will be provided at https://support.opensciencegrid.org. Throughout this transition the support email (help@opensciencegrid.org) will be available as a point of contact.<br><br>                                                   
                                                                                                                                                                                   
Please see the service migration page for details: https://opensciencegrid.github.io/technology/policy/service-migrations-spring-2018/#ticket</div><div id="presence" class="pull-right"></div><div class="ticketgui"><script type="text/javascript" src="lib/checktab.js"></script>

<script>
var expanded = false;
function expand_description() {
    var desc = $(".description");
    if(!expanded) {
        expanded = true;
        //expand to minheight
        var min = 250;
        if(desc.height() < min) {
            desc.animate({height: min}, 200);
        }
    }
}

$(document).ready(function() {
    $("input[name='nad']").datepicker({
        dateFormat: 'yy-mm-dd'
    });
});

</script>



<style>
.form-horizontal .control-label {
padding-top: inherit;
font-size:90%;
color:#666;
}
label {
margin-bottom: 0px;
}
.controls {
line-height: 18px;
}
</style>
<form class="form-horizontal" action="https://ticket.opensciencegrid.org/viewer/updatebasic?id=25290" method="post">
<div class="page-header">
    <h3><span class="muted">25290</span> / OSG Jobs not releasing resources with SIGTERM</h3>
</div>

<div class="row-fluid">
<div class="span5">
    <legend>Contact</legend>
    <div class="control-group">
        <label class="control-label">Full Name</label>
        <div class="controls">Gabriel Araujo von Winckler</div>
    </div>
    <div class="control-group">
        <label class="control-label">Email</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">Phone</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">CC</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>

    <legend>Details</legend>
    <div class="control-group"><label class="control-label">Associated VO</label><div class="controls">OSG</div></div><div class="control-group"><label class="control-label">Submitted Via</label><div class="controls">GOC Ticket/submit</div></div><div class="control-group"><label class="control-label">Submitter</label><div class="controls">Gabriel Araujo von Winckler</div></div><div class="control-group"><label class="control-label">Support Center</label><div class="controls">CSC</div></div><div class="control-group"><label class="control-label">Ticket Links</label><div class="controls"></div></div>
    <div class="control-group">
        <label class="control-label">Ticket Type</label>
        <div class="controls">Problem/Request</div>
    </div>
    <div class="control-group">
        <label class="control-label">Priority</label>
        <div class="controls">Normal</div>
    </div>
    <div class="control-group">
        <label class="control-label">Status</label>
        <div class="controls">
Closed</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action</label>
        <div class="controls">WIP</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action Deadline</label>
        <div class="controls flag_red">2015-06-12</div>
    </div>

</div><!--span-->
<div class="span7">
    <legend>Assignees</legend>
    <div class="assignee" style="width: 60%">CSC <span class="muted"> / OSG Support Centers</span></div><div class="assignee" style="width: 60%">Rob Quick <span class="muted"> / OSG GOC Management</span></div>    <br>

    <legend>Assignees</legend>
    TODO
    <br>

    <style>
legend.noborder {
border-bottom: none;
}
</style>

<div id="attachment-list"/>
<script>
$(function () {
    var first = true;
    $.getJSON("https://ticket.opensciencegrid.org/attachment/list?id=25290", function (files) {
        //console.dir(files);
        var html = "<table class=\"table table-condensed\">";
        $(files).each(function() {
            if(first) {
                first = false;
                html += "<legend class=\"noborder\">Attachmenets</legend>";
            }
            html += "<tr class=\"attachment\">";
            html += "<td><img src="https://ticket.opensciencegrid.org/\&quot;&quot;+this.thumbnail_url+&quot;\&quot;/"></td>";
            html += "<td><a href="https://ticket.opensciencegrid.org/\&quot;&quot;+this.url+&quot;\&quot;" target=\"_blank\">"+this.name+"</a></td>";
            html += "<td>"+bytesToSize(this.size, 1)+"</td>";
            html += "</tr>";
        });
        html += "</table>";
        $("#attachment-list").html(html);
    });
});

function download(url) {
    window.open(url, "_blank");
}
</script>


</div><!--span-->
</div><!--row-fluid-->


</form>

</div>
<div id="updates" style="clear: both;">
    <legend>Past Updates
    <div class="btn-toolbar pull-right toolbar">
        <div class="btn-group">
                <a class="btn btn-small" href="https://ticket.opensciencegrid.org/25290?sort=up&amp;"><i class="icon-arrow-up"></i> Sort</a>

        
        <a class="btn btn-small" href="https://ticket.opensciencegrid.org/25290?expandall=true&amp;">Expand Descriptions</a>        <a class="btn btn-small" target="_blank" href="mailto:osg@tick.globalnoc.iu.edu?subject=Open%20Science%20Grid%3A%20OSG%20Jobs%20not%20releasing%20resources%20with%20SIGTERM%20ISSUE%3D25290%20PROJ%3D71"><i class="icon-envelope"></i> Update w/Email</a>
        </div>
    </div><!--btn-toolbar-->
    </legend>

    <div class='update_description'><i onclick="document.location='25290#1434138288'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-06-12T19:44:48+00:00">Jun 12, 2015 07:44 PM UTC</time> by <b>Christopher Pipes</b><a class="anchor" name="1434138288">&nbsp;</a></div><pre>Thanks for the update, Mats. I&#39;ll close this for now if you get more info or the and the issue reoccurs then we can reopen the ticket.

Thanks,
Chris</pre></div><div class='update_description'><i onclick="document.location='25290#1434042388'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-06-11T17:06:28+00:00">Jun 11, 2015 05:06 PM UTC</time><a class="anchor" name="1434042388">&nbsp;</a></div><pre>The user is currently not running any jobs so I have not been able to verify that the problem has been fixed. However, the users tells me it has so maybe we should just close this ticket.

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=Mats Rynge 45</pre></div><div class='update_description'><i onclick="document.location='25290#1433784490'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-06-08T17:28:10+00:00">Jun 8, 2015 05:28 PM UTC</time> by <b>Christopher Pipes</b><a class="anchor" name="1433784490">&nbsp;</a></div><pre>Hi Mats,

Have you been able to get a good test case?

Thanks,
Chris</pre></div><div class='update_description'><i onclick="document.location='25290#1433265928'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-06-02T17:25:28+00:00">Jun 2, 2015 05:25 PM UTC</time><a class="anchor" name="1433265928">&nbsp;</a></div><pre>I haven&#39;t seen the problem again, but the user has been switching workloads and that is why I haven&#39;t been able to test. Please give me a few more days to see if I can get a good test case.

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=Mats Rynge 45</pre></div><div class='update_description'><i onclick="document.location='25290#1433263694'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-06-02T16:48:14+00:00">Jun 2, 2015 04:48 PM UTC</time> by <b>Christopher Pipes</b><a class="anchor" name="1433263694">&nbsp;</a></div><pre>Hi Mats and Gabriel,

Is this still an issue? Was Mats able to correct the problem?

Thanks,
Chris</pre></div><div class='update_description'><i onclick="document.location='25290#1432646574'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-05-26T13:22:54+00:00">May 26, 2015 01:22 PM UTC</time> by <b>Christopher Pipes</b><a class="anchor" name="1432646574">&nbsp;</a></div><pre>Hi Mats,

How has the test gone? Should this be resolved now?

Thanks,
Chris</pre></div><div class='update_description'><i onclick="document.location='25290#1432136333'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-05-20T15:38:53+00:00">May 20, 2015 03:38 PM UTC</time><a class="anchor" name="1432136333">&nbsp;</a></div><pre>Sorry for the delay. I think we have identified the issue, and we are testing now.

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=Mats Rynge 45</pre></div><div class='update_description'><i onclick="document.location='25290#1432052835'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-05-19T16:27:15+00:00">May 19, 2015 04:27 PM UTC</time> by <b>Christopher Pipes</b><a class="anchor" name="1432052835">&nbsp;</a></div><pre>Hi Mats,

Please take a look at this and update when you can.

Thanks,
Chris</pre></div><div class='update_description'><i onclick="document.location='25290#1431455137'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-05-12T18:25:37+00:00">May 12, 2015 06:25 PM UTC</time><a class="anchor" name="1431455137">&nbsp;</a></div><pre>I haven&#39;t had time to look yet. Sorry.

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=Mats Rynge 45</pre></div><div class='update_description'><i onclick="document.location='25290#1431452770'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-05-12T17:46:10+00:00">May 12, 2015 05:46 PM UTC</time> by <b>Christopher Pipes</b><a class="anchor" name="1431452770">&nbsp;</a></div><pre>Hi Mats,

Do you have an update on this? If there is anything I can do to help let me know.

Thanks,
Chris</pre></div><div class='update_description'><i onclick="document.location='25290#1430944301'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-05-06T20:31:41+00:00">May 6, 2015 08:31 PM UTC</time><a class="anchor" name="1430944301">&nbsp;</a></div><pre>Mats,

Yes, the parent process go away cleanly.
I noticed this processes a few days ago, then we started to receive many high load warnings.
I would guess 7 days ago.

Best regards,
Gabriel

by /C=BR/O=ANSP/OU=ANSPGrid CA/OU=People/CN=Gabriel A. von Winckler</pre></div><div class='update_description'><i onclick="document.location='25290#1430939117'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-05-06T19:05:17+00:00">May 6, 2015 07:05 PM UTC</time><a class="anchor" name="1430939117">&nbsp;</a></div><pre>Gabriel,

I will try to recreate this. Does the parent process go away cleanly? How long have you seen these processes keep going?

Thanks,

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=Mats Rynge 45</pre></div><div class='update_description'><i onclick="document.location='25290#1430936591'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-05-06T18:23:11+00:00">May 6, 2015 06:23 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1430936591">&nbsp;</a></div><pre>Hi,

A specific job (using root.exe) from OSG VO is not releasing resources after the queue system (SLURM) tries to preempt with SIGTERM.
Orphan process keep running and adding load to the worker nodes&#58;

osg      19737  0.0  0.0  37116  1480 ?        S    12&#58;59   0&#58;00 root -b -q phpythia.C(10000000,&#34;pythia_MB.cfg&#34;,1)
osg      19738 99.6  0.6 1086248 112720 ?      R    12&#58;59 132&#58;26  &#92;_ /tmp/glide_Sb2pHq/execute/dir_18946/run_area/root/bin/root.exe -splash -b -q phpythia.C(1
osg      19779  0.0  0.0  37116  1480 ?        S    13&#58;00   0&#58;00 root -b -q phpythia.C(10000000,&#34;pythia_MB.cfg&#34;,1)
osg      19780 99.7  0.6 1086236 113964 ?      R    13&#58;00 131&#58;11  &#92;_ /tmp/glide_qNjTB1/execute/dir_18943/run_area/root/bin/root.exe -splash -b -q phpythia.C(1
osg      19908  0.0  0.0  37116  1484 ?        S    13&#58;06   0&#58;00 root -b -q phpythia.C(10000000,&#34;pythia_MB.cfg&#34;,1)
osg      19909 99.7  0.6 1086200 110092 ?      R    13&#58;06 125&#58;30  &#92;_ /tmp/glide_1r5Ken/execute/dir_18944/run_area/root/bin/root.exe -splash -b -q phpythia.C(1

Kill (-15) does not affect the processes, only SIGKILL (-9) terminates them.

[root@node018 ~]# pgrep -u osg root
19737
19738
19779
19780
19908
19909
[root@node018 ~]# pkill -u osg root
[root@node018 ~]# pgrep -u osg root
19737
19738
19779
19780
19908
19909
[root@node018 ~]# pkill -9 -u osg root
[root@node018 ~]# pgrep -u osg root
[root@node018 ~]#

by /C=BR/O=ANSP/OU=ANSPGrid CA/OU=People/CN=Gabriel A. von Winckler</pre></div><legend>Similar Recent Tickets <small>modified within the last 30 days</small></legend><div id="similar_tickets"><p class="muted">No similar tickets found.</p></div>
</div>
<script type="text/javascript">
function reset_anchor() {
    $("#updates .selected").removeClass("selected");
    var urls = document.location.toString().split('#'); 
    var anchor = urls[1];
    if(anchor) {
        $("a[name='"+anchor+"']").parents(".update_description").addClass("selected");
    }
}
function submitspam(ticket_id) {
    myret = confirm("Would you like to close this ticket as a security ticket, and submit the ticket content to akismet?");
    if(myret == true) {
        $.ajax("viewer/processspam?id="+ticket_id).done(function() {
            window.location.reload();
        });
    }
}

$(function() {
    reset_anchor();
    var ADDITIONAL_COOKIE_NAME = 'gocticket';
    var options = { path: '/', expires: 365};

    if(window.opener && window.opener.name == "gocticket_list") {
        v = $.cookie("closewindow");
        if(!v) {
            $("#closewindow").attr("checked", "checked"); //on by default
        } else {
            if(v == "checked") {
                $("#closewindow").attr("checked", "checked");
            }
        }
        $("#closewindow").click(function() {
            $.cookie("closewindow", $(this).attr('checked'), options);
        });
    } else {
        $("#closewindow_area").hide();
    }
    function updateTimeago() {
        $("time").timeago();
        setTimeout(updateTimeago, 30*1000);
    }
    updateTimeago();
    $(".description").focus(expand_description);
});
</script>
<hr/>
<footer>
<p>GOC Ticket Version 2.2 | <a href="https://ticket.opensciencegrid.org/goc/submit?app_issue_check=on&amp;app_issue_type=goc&amp;app_goc_url=https%3A%2F%2Fticket.opensciencegrid.org%3A443%2F25290">Report Bugs</a>
 | <a href="https://github.com/opensciencegrid/operations/blob/master/docs/privacy.md">Privacy Policy</a>
</p>

<p> <img align="top" src="images/tag_orange.png"/> Copyright 2018 The Trustees of Indiana University - Developed for Open Science Grid</p>
</footer>


</div><!--container-fluid-->
<script src="https://ticket1.grid.iu.edu:8443/socket.io/socket.io.js"></script>
<script>
var chat = io.connect('https://ticket1.grid.iu.edu:8443');
chat.on('connect', function() {
    chat.emit('authenticate', {nodekey:'', ticketid: 25290});
});
chat.on('peers', function(peers) {
    $("#peers").html("");
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('peer_disconnect', function(pid) {
    $("#peer_"+pid).hide("slow");
});
chat.on('peer_connected', function(peers) {
    //expect only 1 peer connecting, but..
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('submit', function() {
    if(confirm("This ticket was updated. Do you want to refresh?")) {
        history.go(0);
    }
});

function addPeer(pid, peer) {
    var ipinfo = "";
    if(peer.ip != undefined) {
        ipinfo = "<span class=\"ip\">"+peer.ip+"</span>";
    }
    if(chat.io.engine.id == pid) {
        //don't display myself
        return;
    }
    var html = "<li class=\"new\" id=\"peer_"+pid+"\" class=\"peer\">"+peer.name+ipinfo+"</li>";
    $("#peers").prepend(html);
    $("#peers .new").animate({bottom: 0}, 1000, function() {$(this).removeClass("new")});
}

$(function() {
    $("#ticket_form").submit(function() {
        chat.emit('submit');
        return true;
    });
});
</script>
<script>
//used by searchbox
function parseValue(value) {
    var obj = new Object();
    var tokens = value.split("\t");
    obj.str = tokens[0];
    obj.count = tokens[1];
    return obj;
}

$(function() {
    //bootstrap-2.0.4 stuff
    $(".alert-message").alert();
    $(".dropdown-toggle").dropdown();
    $("span[rel='tooltip']").tooltip();
    $("a[rel=popover]").popover();

    //activate menu that user is currently on
    $("#menu_navigator").addClass("active"); 
    $("#submenu_").addClass("active"); 

    //translate zend validation error message to bootstrap
    $(".errors").addClass("alert").addClass("alert-error");

    //enable autocomplete for search box
    $("#search").autocomplete({
        source: function( request, response ) {
            $.ajax({
                url: "search/autocomplete",
                dataType: "text",
                data: {
                    //featureClass: "P",
                    //style: "full",
                    //maxRows: 12,
                    //name_startsWith: request.term
                    q: request.term
                },
                success: function( data ) {
                    response( $.map( data.split("\n"), function( item ) {
                        if(item == "") return null;
                        return {
                            value: item
                        }
                    }));
                }
            });
        },
        select: function(event, ui) {
            document.location = "search?q="+ui.item.value;
        }
    });
    
});
</script>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-69012-13");
pageTracker._trackPageview();
} catch(err) {}
</script>

</body>
