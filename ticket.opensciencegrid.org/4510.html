<!DOCTYPE html>
<html lang="en">
  <head>
  <base href="">
    <title>[4510] dCache - srmrm not working at wisconsin after upgrade to 1.8.0-9</title>    <meta charset="utf-8" />
    <meta name="verify-v1" content="na5IcAJsZVOfEkboRxuIiZ1zpZgnZiWra+nKcS7nA/o=" />
    <meta name="google-site-verification" content="DLrk3ft4s8b-S2TloLCL2LD_t6wcTjgSluf5pmiu2kA" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />
    <link href="https://ticket.opensciencegrid.org/rss" rel="alternate" type="application/rss+xml" title="GOC Ticket Update feed" />

    <style type="text/css">
      body {
        padding-top: 50px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
     #search {
            width: 300px;
     }

    </style>

<script src="https://code.jquery.com/jquery-3.0.0.js"></script>
<script src="https://code.jquery.com/jquery-migrate-3.0.1.js"></script>

   <link href="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet"/>
    <script src="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/js/bootstrap.min.js"></script>

    <link href="https://netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"/>
    <link href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/themes/smoothness/jquery-ui.min.css" rel="stylesheet"/>
 <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>


    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/js/select2.min.js"></script>

    <link href="css/ticket.css" rel="stylesheet" />
    <script src="lib/jquery.cookie.js"></script>

    <link href="images/tag_orange.png" rel="icon" type="image/png"/>
  </head>

  <body>
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>

            <a class="brand" style="padding: 6px 0px 0px 6px;" href="http://opensciencegrid.org"><img src="images/osglogo.40x30.png"/></a>
            <ul class="nav">
                <li class="dropdown"><a href="https://ticket.opensciencegrid.org/#" class="dropdown-toggle" data-toggle="dropdown">GOC Ticket <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    <li><a href="https://my.opensciencegrid.org">MyOSG</a></li>
                    <li><a href="https://oim.opensciencegrid.org">OIM</a></li>
                    <li class="active"><a href="https://ticket.opensciencegrid.org/index">Ticket</a></li>
	<li class="divider"></li>
	<li><a href="http://repo.grid.iu.edu">Repo</a></li>
	<li class="divider"></li>
	<li><a href="http://blogs.grid.iu.edu">Blog</a></li>
                    <li><a href="http://display.grid.iu.edu">Display</a></li>
                    <li><a href="http://osggoc.blogspot.com/">News</a></li>
                    </ul>
                </li>
            </ul>
            <ul class="nav pull-right">
                <li><a href="https://ticket.opensciencegrid.org/sso/">Login</a></li>            </ul>

            <div class="nav-collapse">
                <ul class="nav">
			 <li id="menu_submit"><a href="https://ticket.opensciencegrid.org/submit">Submit</a></li><li id="menu_view" class="dropdown"><a href="https://ticket.opensciencegrid.org/\#" class="dropdown-toggle" data-toggle="dropdown">View <b class="caret"></b></a><ul class="dropdown-menu"><li id="submenu_listopen"><a href="https://ticket.opensciencegrid.org/list/open">Open Tickets</a></li><li id="submenu_listrecentclose"><a href="https://ticket.opensciencegrid.org/list/recentclose">Recently Closed Tickets</a></li><li class="divider"></li><li id="submenu_alltickets"><a href="https://ticket.opensciencegrid.org/search?q=&amp;sort=id">All Tickets</a></li></ul></li>                </ul>

                <form class="navbar-search pull-right" action="https://ticket.opensciencegrid.org/viewer">
                    <input id="search" type="text" name="id" class="search-query span2" placeholder="Search Ticket" value=""/>
                </form>
            </div>
        </div>
      </div>
    </div>

<script type='text/javascript' src='lib/jquery.timeago.js'></script>
<script type='text/javascript' src='lib/byte2size.js'></script>
<style>
#updates .toolbar {
position: relative;
margin-top: 0px;
top: -10px;
font-weight: normal;
}
#updates a.anchor {
position: relative;
top: -50px;
}
#updates .selected pre {
animation:selected 2s;
animation-iteration-count: 2;
animation-direction: alternate;
-webkit-animation:selected 2s; 
-webkit-animation-iteration-count: 2;
-webkit-animation-direction: alternate;
box-shadow: inset 1px 1px 20px #9ad;
border: 1px solid #9ab;
margin: 5px 0px;
padding-left: 10px;
}
@keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ab;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
@-webkit-keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ad;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
#updates pre {
background-color: inherit;
line-height: 15px;
padding: 5px;
}
#updates .header {
color: #999;
}
#updates .update_history pre {
background-color: #eee;
color: #666;
font-size: 85%;
}
#updates .clickable {
cursor: pointer;
}
#updates .clickable:hover {
color: #D98719;
}
#updates .meta_information pre {
background-color: #fed;
}
#similar_tickets {
max-height: 300px;
overflow-y: auto;
pointer-events: none;
padding: 5px;
background-color: #f4f4f4;
}
.btn-toolbar {
margin-bottom: 0;
height: 30px;
}
#peers {
position: fixed;
bottom: 0px;
right: 0px;
z-index: 100;
list-style: none;
padding: 5px 0px 0px 5px;
margin: 0px;
background-color: white;
box-shadow: 0px 0px 10px white;
}
#peers li {
background-color: #ccc;
color: #000;
display: inline-block;
padding: 5px 10px;
margin-right: 5px;
position: relative;
}
/*
#peers li:hover {
background-color: #999;
cursor: pointer;
}
*/
#peers span.ip {
padding-left: 5px;
color: #666;
}
#peers .new {
bottom: -30px;
}
/*
#peers .me {
background-color: red;
}
*/
</style>

<div class="container-fluid">
<ul id="peers"></ul>
<div class="alert alert-danger"><a class="close" href="https://ticket.opensciencegrid.org/#" data-dismiss="alert">&times;</a>By the end of May 2018, the ticketing system at https://ticket.opensciencegrid.org will be retired and support will be provided at https://support.opensciencegrid.org. Throughout this transition the support email (help@opensciencegrid.org) will be available as a point of contact.<br><br>                                                   
                                                                                                                                                                                   
Please see the service migration page for details: https://opensciencegrid.github.io/technology/policy/service-migrations-spring-2018/#ticket</div><div id="presence" class="pull-right"></div><div class="ticketgui"><script type="text/javascript" src="lib/checktab.js"></script>

<script>
var expanded = false;
function expand_description() {
    var desc = $(".description");
    if(!expanded) {
        expanded = true;
        //expand to minheight
        var min = 250;
        if(desc.height() < min) {
            desc.animate({height: min}, 200);
        }
    }
}

$(document).ready(function() {
    $("input[name='nad']").datepicker({
        dateFormat: 'yy-mm-dd'
    });
});

</script>



<style>
.form-horizontal .control-label {
padding-top: inherit;
font-size:90%;
color:#666;
}
label {
margin-bottom: 0px;
}
.controls {
line-height: 18px;
}
</style>
<form class="form-horizontal" action="https://ticket.opensciencegrid.org/viewer/updatebasic?id=4510" method="post">
<div class="page-header">
    <h3><span class="muted">4510</span> / dCache - srmrm not working at wisconsin after upgrade to 1.8.0-9</h3>
</div>

<div class="row-fluid">
<div class="span5">
    <legend>Contact</legend>
    <div class="control-group">
        <label class="control-label">Full Name</label>
        <div class="controls">Neha Sharma</div>
    </div>
    <div class="control-group">
        <label class="control-label">Email</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">Phone</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">CC</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>

    <legend>Details</legend>
    
    <div class="control-group">
        <label class="control-label">Ticket Type</label>
        <div class="controls">Problem/Request</div>
    </div>
    <div class="control-group">
        <label class="control-label">Priority</label>
        <div class="controls">Normal</div>
    </div>
    <div class="control-group">
        <label class="control-label">Status</label>
        <div class="controls">
Closed</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action</label>
        <div class="controls">Neha will followup/update</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action Deadline</label>
        <div class="controls flag_red">2008-01-30</div>
    </div>

</div><!--span-->
<div class="span7">
    <legend>Assignees</legend>
    <div class="assignee" style="width: 60%">Neha Sharma <span class="muted"> / OSG Storage Team</span></div>    <br>

    <legend>Assignees</legend>
    TODO
    <br>

    <style>
legend.noborder {
border-bottom: none;
}
</style>

<div id="attachment-list"/>
<script>
$(function () {
    var first = true;
    $.getJSON("attachment/list/4510", function (files) {
        //console.dir(files);
        var html = "<table class=\"table table-condensed\">";
        $(files).each(function() {
            if(first) {
                first = false;
                html += "<legend class=\"noborder\">Attachmenets</legend>";
            }
            html += "<tr class=\"attachment\">";
            html += "<td><img src=\""+this.thumbnail_url+"\"/></td>";
            html += "<td><a href=\""+this.url+"\" target=\"_blank\">"+this.name+"</a></td>";
            html += "<td>"+bytesToSize(this.size, 1)+"</td>";
            html += "</tr>";
        });
        html += "</table>";
        $("#attachment-list").html(html);
    });
});

function download(url) {
    window.open(url, "_blank");
}
</script>


</div><!--span-->
</div><!--row-fluid-->


</form>

</div>
<div id="updates" style="clear: both;">
    <legend>Past Updates
    <div class="btn-toolbar pull-right toolbar">
        <div class="btn-group">
                <a class="btn btn-small" href="https://ticket.opensciencegrid.org/4510?sort=up&amp;"><i class="icon-arrow-up"></i> Sort</a>

        
        <a class="btn btn-small" href="https://ticket.opensciencegrid.org/4510?expandall=true&amp;">Expand Descriptions</a>        <a class="btn btn-small" target="_blank" href="mailto:osg@tick.globalnoc.iu.edu?subject=Open%20Science%20Grid%3A%20dCache%20-%20srmrm%20not%20working%20at%20wisconsin%20after%20upgrade%20to%201.8.0-9%20ISSUE%3D4510%20PROJ%3D71"><i class="icon-envelope"></i> Update w/Email</a>
        </div>
    </div><!--btn-toolbar-->
    </legend>

    <div class='update_description'><i onclick="document.location='4510#1201191214'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2008-01-24T16:13:34+00:00">Jan 24, 2008 04:13 PM UTC</time> by <b>Neha Sharma</b><a class="anchor" name="1201191214">&nbsp;</a></div><pre>Timur et. al.,

The problem is solved!  Your message below somehow made me think of examining our
pnfs mount point on the pnfs server.  Before this, we had been entirely focussed on
the dcache configuration when looking for an answer to our problem.  The mounts
looked like this&#58;

localhost&#58;/fs on /pnfs/fs type nfs (rw,udp,intr,noac,hard,nfsvers=2,addr=127.0.0.1)
cmspnfs&#58;/pnfs on /pnfs/hep.wisc.edu type nfs (rw,intr,noac,hard,addr=144.92.180.14)

Changing /pnfs/hep.wisc.edu from a mount point to a symlink --&#62; /pnfs/fs/usr made the
&#34;illegal argument exception&#34; stop happening in the pnfs manager.

It turns out that when we upgraded, our dcache, we had to swap in some different
hardware for our pnfs server at the last minute.  An unfortunate consequence of this
is that the mounting of /pnfs/hep.wisc.edu was preserved from the previous
incarnation of this swapped-in hardware.

Is it expected that the pnfs manager is vulnerable to this kind of configuration
problem for file deletion operations but apparently very little else if anything?

We are not sure why we did not catch this problem at the time of running install.sh.
I do note a slight error in install.sh related to this, but it still should have
indicated a problem, so this doesn&#39;t completely explain it.  The error is here&#58;

if [ -e &#34;${SERVER_ID}&#34; ] ; then
echo &#34;[ERROR] The file/directory ${PNFS_ROOT}/${SERVER_ID}
is in the way. Please move it out&#34;
echo &#34;        of the way and call me again. Exiting.&#34;
else

Note that it does not exit even though it says it will.  Further down in the script,
there is a second redundant block of code that tries to do similar checks.  It uses
&#39;find&#39; to read the value of the symlink, which is a rather expensive operation in a
case like ours where /pnfs/hep.wisc.edu is actually a mount point for the entire pnfs
<div id='show_390350924' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_390350924'>filesystem!  Here&#39;s the code, which gets executed even if ${PNFS_ROOT}/${SERVER_ID}
is not a symlink.

serverIdLinkedTo=&#96;find ${PNFS_ROOT}/${SERVER_ID} -type l -printf &#39;%l&#39;&#96;

Anyway, it&#39;s great to have the problem fixed.

--Dan

Timur Perelmutov wrote&#58;
Hi Dan,

Since I do not quite understand the issue and would benefit from DESY&#39;s advise, I
include Patrick and Tigran in discussion. So is that correct that upgrading to new
version of dCache addressed the performance issues, but advisory delete still does
not work?

The code that fails is this one&#58;

PnfsFile pf =  new PnfsFile( this.pnfsidToPath(pnfsId) );
&#60;snip&#62;
rc = pf.delete();
&#60;snip&#62;
if( ! rc ) {
if( pf.isDirectory() &amp;&amp; ( pf.list().length != 0 ) ) {
_logNameSpace.error(pnfsId + &#34;&#58; is not empty&#34;);
throw new IllegalArgumentException( &#34;Directory  &#34; + pnfsId + &#34; not
empty&#34;);
} else{
279&#58;                _logNameSpace.error(pnfsId+ &#34;&#58; unknown reason&#34;);
280&#58;                throw new IllegalArgumentException( &#34;Failed to remove entry &#34; +
pnfsId + &#34; &#58; Unknown reason.&#34;);
281&#58;            }
}

This appears to be the problem in the execution of PnfsFile delete() method which
should internally just cause the regular file system delete. It looks like file
either already does not exist, or there is no permission to delete the file.

Do you have any sorts of errors in pnfs log itself related to this pnfs id or pnfs name?

Do you have a corresponding log of srm domain?

Patrick, Tigran,

This appears to be the pnfs manager issue and I would appreciate your advise on how
to debug the issue.

Dan,

Can you add my DN to the authorization files, and tell me the path to which I can
write and try to delete a file using srm tools myself?

My DN is &#34;/DC=org/DC=doegrids/OU=People/CN=Timur Perelmutov 683749&#34;

Thanks,
Timur
Dan Bradley wrote&#58;
Timur,

We upgraded to dcache 1.8.0-12, but we still have the problem with
srm-advisory-delete.  We are no longer using Brian&#39;s customized jars for the pnfs
manager, since (so far) this appears to be unnecessary.

srm-advisory-delete fails in precisely the same way.  Here is the familiar error we
see in the pnfsManager logs&#58;

01/23 10&#58;46&#58;36 Cell(PnfsManager@pnfsDomain) &#58; java.lang.IllegalArgumentException&#58;
Failed to remove entry 0001000000000000021EDF68 &#58; Unknown reason.
01/23 10&#58;46&#58;36 Cell(PnfsManager@pnfsDomain) &#58;   at
diskCacheV111.namespace.provider.BasicNameSpaceProvider.deleteEntry(BasicNameSpaceProvider.java&#58;280)

01/23 10&#58;46&#58;36 Cell(PnfsManager@pnfsDomain) &#58;   at
diskCacheV111.namespace.PnfsManagerV3.deleteEntry(PnfsManagerV3.java&#58;1049)
01/23 10&#58;46&#58;36 Cell(PnfsManager@pnfsDomain) &#58;   at
diskCacheV111.namespace.PnfsManagerV3.processPnfsMessage(PnfsManagerV3.java&#58;1294)
01/23 10&#58;46&#58;36 Cell(PnfsManager@pnfsDomain) &#58;   at
diskCacheV111.namespace.PnfsManagerV3$ProcessThread.run(PnfsManagerV3.java&#58;1212)
01/23 10&#58;46&#58;36 Cell(PnfsManager@pnfsDomain) &#58;   at java.lang.Thread.run(Thread.java&#58;595)

The SAM stage-out tests for Wisconsin have been failing for most of the month of
January because of this problem.  We have no clue about what is causing
&#34;IllegalArgumentException&#34;.  Can any additional information be provided as to what
causes this error?

You can see the versions of our dcache components here&#58;

<a href='http&#58;//cms-dcache.hep.wisc.edu&#58;2288/cellInfo' target='_blank' rel='nofollow'>http&#58;//cms-dcache.hep.wisc.edu&#58;2288/cellInfo</a>

--Dan
</div><script type='text/javascript'>
        $('#show_390350924').click(function() {
            $('#detail_390350924').slideDown("normal");
            $('#show_390350924').hide();
            $('#hide_390350924').show();
        });
        $('#hide_390350924').click(function() {
            $('#detail_390350924').slideUp();
            $('#hide_390350924').hide();
            $('#show_390350924').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='4510#1200500206'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2008-01-16T16:16:46+00:00">Jan 16, 2008 04:16 PM UTC</time> by <b>Neha Sharma</b><a class="anchor" name="1200500206">&nbsp;</a></div><pre>Since our upgrade to dCache 1.8.0-9, srm-advisory-delete is no longer working against
the Wisconsin SRM service.

Here&#39;s the error that I see in the SRM logs&#58;

01/09 14&#58;16&#58;15 Cell(SRM-cmsdcache03@srm-cmsdcache03Domain) &#58; srm&#58;
advisoryDelete(User [name=osg_uscms01, uid=622, gid=622,
root=/],/pnfs/hep.wisc.edu/data3/phedex_heartbeat/test.transfer.1199909616) Error
Delete failed&#58; NULL

We have the following in dCacheSetup&#58;

AdvisoryDelete=true

I have verified that the same version of srm-advisory-delete I am using (from OSG
0.6.0) works against the current FNAL SRM server.  It certainly used to work against
Wisconsin before the upgrade.

What should we try next?

Thanks,
--Dan

If I recall correctly,  srm-advisory-delete was deprecated.  Use srm-delete. --Jon

I should also note that when I remove a file with &#39;rm /pnfs/...&#39;, it works without
any problem.  In the case where I try to do it with srm-advisory-delete, I also
observe the following in the pnfsManager log&#58;

09 Jan 2008 16&#58;09&#58;17 0001000000000000021E0F88&#58; unknown reason
01/09 16&#58;09&#58;17 Cell(PnfsManager@pnfsDomain) &#58; delete failed
java.lang.IllegalArgumentException&#58; Failed to remove entry 0001000000000000021E0F88 &#58;
Unknown reason.
01/09 16&#58;09&#58;17 Cell(PnfsManager@pnfsDomain) &#58; java.lang.IllegalArgumentException&#58;
Failed to remove entry 0001000000000000021E0F88 &#58; Unknown reason.
<div id='show_2111119920' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_2111119920'>01/09 16&#58;09&#58;17 Cell(PnfsManager@pnfsDomain) &#58;   at
diskCacheV111.namespace.provider.BasicNameSpaceProvider.deleteEntry(BasicNameSpaceProvider.java&#58;280)
01/09 16&#58;09&#58;17 Cell(PnfsManager@pnfsDomain) &#58;   at
diskCacheV111.namespace.PnfsManagerV3.deleteEntry(PnfsManagerV3.java&#58;1016)
01/09 16&#58;09&#58;17 Cell(PnfsManager@pnfsDomain) &#58;   at
diskCacheV111.namespace.PnfsManagerV3.processPnfsMessage(PnfsManagerV3.java&#58;1260)
01/09 16&#58;09&#58;17 Cell(PnfsManager@pnfsDomain) &#58;   at
diskCacheV111.namespace.PnfsManagerV3$ProcessThread.run(PnfsManagerV3.java&#58;1179)
01/09 16&#58;09&#58;17 Cell(PnfsManager@pnfsDomain) &#58;   at java.lang.Thread.run(Thread.java&#58;595)

--Dan

The srm v1 client supplied in OSG 0.8.0 has no srm-delete.  It has
srm-advisory-delete.  The stage-out test in SAM fails at our site because
srm-advisory-delete fails.  Other existing software may depend on this as well.

--Dan

It&#39;s called srmrm, not srm-delete.  Sorry for the confusion.   I checked, it exists
in the dcache client tools rpm.

Timur said srm-advisory-delete will work only under certain configurations.  He didn&#39;t
specify further...

--Jon

Ok, I tested srmrm, and it doesn&#39;t work for us either.  It fails with all the same
symptoms as srm-advisory-delete.

Here&#39;s what I see in the pnfs manager log&#58;

01/11 13&#58;55&#58;35 CellNucleus(PnfsManager@pnfsDomain) &#58; messageThread &#58; delivering
message done &#58; &#60;CM&#58;
S=[&#62;SRM-cmsdcache03@srm-cmsdcache03Domain&#58;*@srm-cmsdcache03Domain&#58;*@dCacheDomain];D=[&#62;PnfsManager@local];C=diskCacheV111.vehicles.PnfsDeleteEntryMessage;O=&#60;1200081335624&#58;10848&#62;;LO=&#60;1200081335624&#58;10847&#62;&#62;
01/11 13&#58;55&#58;35 Cell(PnfsManager@pnfsDomain) &#58; class
diskCacheV111.vehicles.PnfsFlagMessage processed in 22 milis
01/11 13&#58;55&#58;35 Cell(PnfsManager@pnfsDomain) &#58; delete PNFS entry for
///pnfs/hep.wisc.edu/cmsprod/test_dd
11 Jan 2008 13&#58;55&#58;35 0001000000000000021DFD98&#58; unknown reason
01/11 13&#58;55&#58;35 Cell(PnfsManager@pnfsDomain) &#58; delete failed
java.lang.IllegalArgumentException&#58; Failed to remove entry 0001000000000000021DFD98 &#58;
Unknown reason.
01/11 13&#58;55&#58;35 Cell(PnfsManager@pnfsDomain) &#58; java.lang.IllegalArgumentException&#58;
Failed to remove entry 0001000000000000021DFD98 &#58; Unknown reason.
01/11 13&#58;55&#58;35 Cell(PnfsManager@pnfsDomain) &#58;   at
diskCacheV111.namespace.provider.BasicNameSpaceProvider.deleteEntry(BasicNameSpaceProvider.java&#58;280)
01/11 13&#58;55&#58;35 Cell(PnfsManager@pnfsDomain) &#58;   at
diskCacheV111.namespace.PnfsManagerV3.deleteEntry(PnfsManagerV3.java&#58;934)
01/11 13&#58;55&#58;35 Cell(PnfsManager@pnfsDomain) &#58;   at
diskCacheV111.namespace.PnfsManagerV3.processPnfsMessage(PnfsManagerV3.java&#58;1169)
01/11 13&#58;55&#58;35 Cell(PnfsManager@pnfsDomain) &#58;   at
diskCacheV111.namespace.PnfsManagerV3$ProcessThread.run(PnfsManagerV3.java&#58;1086)
01/11 13&#58;55&#58;35 Cell(PnfsManager@pnfsDomain) &#58;   at java.lang.Thread.run(Thread.java&#58;595)
01/11 13&#58;55&#58;35 Cell(PnfsManager@pnfsDomain) &#58; class
diskCacheV111.vehicles.PnfsDeleteEntryMessage processed in 90 milis

Here is the command I am running&#58;

$ srmrm <a href='srm&#58;//cmssrm.hep.wisc.edu&#58;8443/pnfs/hep.wisc.edu/cmsprod/test_dd' target='_blank' rel='nofollow'>srm&#58;//cmssrm.hep.wisc.edu&#58;8443/pnfs/hep.wisc.edu/cmsprod/test_dd</a>
Return code&#58; SRM_FAILURE
Explanation&#58; problem with one or more files&#58;
Delete failed&#58; NULL

file#0 &#58; <a href='srm&#58;//cmssrm.hep.wisc.edu&#58;8443/pnfs/hep.wisc.edu/cmsprod/test_dd' target='_blank' rel='nofollow'>srm&#58;//cmssrm.hep.wisc.edu&#58;8443/pnfs/hep.wisc.edu/cmsprod/test_dd</a>,
SRM_FAILURE, &#34;Delete failed&#58; NULL&#34;

srmrm is a v2 protocol, so you can&#39;t use v1 syntax.
Here is what works for me&#58;

$ ls -l  /pnfs/fs/usr/cms/WAX/5/pageDcache/jon.deleteme
-rw-rw-r--  1 cmsprod us_cms 0 Jan 11 17&#58;55
/pnfs/fs/usr/cms/WAX/5/pageDcache/jon.deleteme

$ srmrm    srm&#58;//cmssrm&#58;8443/srm/managerv2?SFN=/5/pageDcache/jon.deleteme

$ ls -l  /pnfs/fs/usr/cms/WAX/5/pageDcache/jon.deleteme
ls&#58; /pnfs/fs/usr/cms/WAX/5/pageDcache/jon.deleteme&#58; No such file or directory

--Jon

Inserting /srm/managerv2?SFN= into my srm URL makes no difference.  Note that the
error message about &#34;illegal argument&#34; that I am getting is showing up in the pnfs
manager logs.  I&#39;m guessing we have something messed up at that layer, but I have no
idea what it could be.

--Dan
</div><script type='text/javascript'>
        $('#show_2111119920').click(function() {
            $('#detail_2111119920').slideDown("normal");
            $('#show_2111119920').hide();
            $('#hide_2111119920').show();
        });
        $('#hide_2111119920').click(function() {
            $('#detail_2111119920').slideUp();
            $('#hide_2111119920').hide();
            $('#show_2111119920').show();
        });
        </script></pre></div><legend>Similar Recent Tickets <small>modified within the last 30 days</small></legend><div id="similar_tickets"><p class="muted">No similar tickets found.</p></div>
</div>
<script type="text/javascript">
function reset_anchor() {
    $("#updates .selected").removeClass("selected");
    var urls = document.location.toString().split('#'); 
    var anchor = urls[1];
    if(anchor) {
        $("a[name='"+anchor+"']").parents(".update_description").addClass("selected");
    }
}
function submitspam(ticket_id) {
    myret = confirm("Would you like to close this ticket as a security ticket, and submit the ticket content to akismet?");
    if(myret == true) {
        $.ajax("viewer/processspam?id="+ticket_id).done(function() {
            window.location.reload();
        });
    }
}

$(function() {
    reset_anchor();
    var ADDITIONAL_COOKIE_NAME = 'gocticket';
    var options = { path: '/', expires: 365};

    if(window.opener && window.opener.name == "gocticket_list") {
        v = $.cookie("closewindow");
        if(!v) {
            $("#closewindow").attr("checked", "checked"); //on by default
        } else {
            if(v == "checked") {
                $("#closewindow").attr("checked", "checked");
            }
        }
        $("#closewindow").click(function() {
            $.cookie("closewindow", $(this).attr('checked'), options);
        });
    } else {
        $("#closewindow_area").hide();
    }
    function updateTimeago() {
        $("time").timeago();
        setTimeout(updateTimeago, 30*1000);
    }
    updateTimeago();
    $(".description").focus(expand_description);
});
</script>
<hr/>
<footer>
<p>GOC Ticket Version 2.2 | <a href="https://ticket.opensciencegrid.org/goc/submit?app_issue_check=on&amp;app_issue_type=goc&amp;app_goc_url=https%3A%2F%2Fticket.opensciencegrid.org%3A443%2F4510">Report Bugs</a>
 | <a href="https://github.com/opensciencegrid/operations/blob/master/docs/privacy.md">Privacy Policy</a>
</p>

<p> <img align="top" src="images/tag_orange.png"/> Copyright 2018 The Trustees of Indiana University - Developed for Open Science Grid</p>
</footer>


</div><!--container-fluid-->
<script>
//used by searchbox
function parseValue(value) {
    var obj = new Object();
    var tokens = value.split("\t");
    obj.str = tokens[0];
    obj.count = tokens[1];
    return obj;
}

$(function() {
    //bootstrap-2.0.4 stuff
    $(".alert-message").alert();
    $(".dropdown-toggle").dropdown();
    $("span[rel='tooltip']").tooltip();
    $("a[rel=popover]").popover();

    //activate menu that user is currently on
    $("#menu_navigator").addClass("active"); 
    $("#submenu_").addClass("active"); 

    //translate zend validation error message to bootstrap
    $(".errors").addClass("alert").addClass("alert-error");

    //enable autocomplete for search box
    $("#search").autocomplete({
        source: function( request, response ) {
            $.ajax({
                url: "search/autocomplete",
                dataType: "text",
                data: {
                    //featureClass: "P",
                    //style: "full",
                    //maxRows: 12,
                    //name_startsWith: request.term
                    q: request.term
                },
                success: function( data ) {
                    response( $.map( data.split("\n"), function( item ) {
                        if(item == "") return null;
                        return {
                            value: item
                        }
                    }));
                }
            });
        },
        select: function(event, ui) {
            document.location = "search?q="+ui.item.value;
        }
    });
    
});
</script>


</body>
