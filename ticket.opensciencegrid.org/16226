<!DOCTYPE html>
<html lang="en">
  <head>
  <base href="/">
    <title>[16226] OSG Production Resource Group Baylor-Tier3-CE Failing Critical Metrics</title>    <meta charset="utf-8" />
    <meta name="verify-v1" content="na5IcAJsZVOfEkboRxuIiZ1zpZgnZiWra+nKcS7nA/o=" />
    <meta name="google-site-verification" content="DLrk3ft4s8b-S2TloLCL2LD_t6wcTjgSluf5pmiu2kA" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />
    <link href="https://ticket.opensciencegrid.org/rss" rel="alternate" type="application/rss+xml" title="GOC Ticket Update feed" />

    <style type="text/css">
      body {
        padding-top: 50px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
     #search {
            width: 300px;
     }

    </style>

<script src="https://code.jquery.com/jquery-3.0.0.js"></script>
<script src="https://code.jquery.com/jquery-migrate-3.0.1.js"></script>

   <link href="//netdna.bootstrapcdn.com/bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet"/>
    <script src="//netdna.bootstrapcdn.com/bootstrap/2.3.2/js/bootstrap.min.js"></script>

    <link href="//netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"/>
    <link href="//ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/themes/smoothness/jquery-ui.min.css" rel="stylesheet"/>
 <script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>


    <link href="//cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/css/select2.min.css" rel="stylesheet" />
    <script src="//cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/js/select2.min.js"></script>

    <link href="css/ticket.css" rel="stylesheet" />
    <script src="lib/jquery.cookie.js"></script>

    <link href="images/tag_orange.png" rel="icon" type="image/png"/>
    <script src='https://www.google.com/recaptcha/api.js'></script>
  </head>

  <body>
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>

            <a class="brand" style="padding: 6px 0px 0px 6px;" href="http://opensciencegrid.org"><img src="https://ticket.opensciencegrid.org/images/osglogo.40x30.png"/></a>
            <ul class="nav">
                <li class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown">GOC Ticket <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    <li><a href="https://my.opensciencegrid.org">MyOSG</a></li>
                    <li><a href="https://oim.opensciencegrid.org">OIM</a></li>
                    <li class="active"><a href="index">Ticket</a></li>
	<li class="divider"></li>
	<li><a href="http://repo.grid.iu.edu">Repo</a></li>
	<li class="divider"></li>
	<li><a href="http://blogs.grid.iu.edu">Blog</a></li>
                    <li><a href="http://display.grid.iu.edu">Display</a></li>
                    <li><a href="http://osggoc.blogspot.com/">News</a></li>
                    </ul>
                </li>
            </ul>
            <ul class="nav pull-right">
                <li><a href="https://ticket.opensciencegrid.org/sso/">Login</a></li>            </ul>

            <div class="nav-collapse">
                <ul class="nav">
			 <li id="menu_submit"><a href="https://ticket.opensciencegrid.org/submit">Submit</a></li><li id="menu_view" class="dropdown"><a href="\#" class="dropdown-toggle" data-toggle="dropdown">View <b class="caret"></b></a><ul class="dropdown-menu"><li id="submenu_listopen"><a href="https://ticket.opensciencegrid.org/list/open">Open Tickets</a></li><li id="submenu_listrecentclose"><a href="https://ticket.opensciencegrid.org/list/recentclose">Recently Closed Tickets</a></li><li class="divider"></li><li id="submenu_alltickets"><a href="https://ticket.opensciencegrid.org/search?q=&amp;sort=id">All Tickets</a></li></ul></li>                </ul>

                <form class="navbar-search pull-right" action="viewer">
                    <input id="search" type="text" name="id" class="search-query span2" placeholder="Search Ticket" value=""/>
                </form>
            </div>
        </div>
      </div>
    </div>

<script type='text/javascript' src='lib/jquery.timeago.js'></script>
<script type='text/javascript' src='lib/byte2size.js'></script>
<style>
#updates .toolbar {
position: relative;
margin-top: 0px;
top: -10px;
font-weight: normal;
}
#updates a.anchor {
position: relative;
top: -50px;
}
#updates .selected pre {
animation:selected 2s;
animation-iteration-count: 2;
animation-direction: alternate;
-webkit-animation:selected 2s; 
-webkit-animation-iteration-count: 2;
-webkit-animation-direction: alternate;
box-shadow: inset 1px 1px 20px #9ad;
border: 1px solid #9ab;
margin: 5px 0px;
padding-left: 10px;
}
@keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ab;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
@-webkit-keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ad;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
#updates pre {
background-color: inherit;
line-height: 15px;
padding: 5px;
}
#updates .header {
color: #999;
}
#updates .update_history pre {
background-color: #eee;
color: #666;
font-size: 85%;
}
#updates .clickable {
cursor: pointer;
}
#updates .clickable:hover {
color: #D98719;
}
#updates .meta_information pre {
background-color: #fed;
}
#similar_tickets {
max-height: 300px;
overflow-y: auto;
pointer-events: none;
padding: 5px;
background-color: #f4f4f4;
}
.btn-toolbar {
margin-bottom: 0;
height: 30px;
}
#peers {
position: fixed;
bottom: 0px;
right: 0px;
z-index: 100;
list-style: none;
padding: 5px 0px 0px 5px;
margin: 0px;
background-color: white;
box-shadow: 0px 0px 10px white;
}
#peers li {
background-color: #ccc;
color: #000;
display: inline-block;
padding: 5px 10px;
margin-right: 5px;
position: relative;
}
/*
#peers li:hover {
background-color: #999;
cursor: pointer;
}
*/
#peers span.ip {
padding-left: 5px;
color: #666;
}
#peers .new {
bottom: -30px;
}
/*
#peers .me {
background-color: red;
}
*/
</style>

<div class="container-fluid">
<ul id="peers"></ul>
<div class="alert alert-danger"><a class="close" href="#" data-dismiss="alert">&times;</a>By the end of May 2018, the ticketing system at https://ticket.opensciencegrid.org will be retired and support will be provided at https://support.opensciencegrid.org. Throughout this transition the support email (help@opensciencegrid.org) will be available as a point of contact.<br><br>                                                   
                                                                                                                                                                                   
Please see the service migration page for details: https://opensciencegrid.github.io/technology/policy/service-migrations-spring-2018/#ticket</div><div id="presence" class="pull-right"></div><div class="ticketgui"><script type="text/javascript" src="https://ticket.opensciencegrid.org/lib/checktab.js"></script>

<script>
var expanded = false;
function expand_description() {
    var desc = $(".description");
    if(!expanded) {
        expanded = true;
        //expand to minheight
        var min = 250;
        if(desc.height() < min) {
            desc.animate({height: min}, 200);
        }
    }
}

$(document).ready(function() {
    $("input[name='nad']").datepicker({
        dateFormat: 'yy-mm-dd'
    });
});

</script>



<style>
.form-horizontal .control-label {
padding-top: inherit;
font-size:90%;
color:#666;
}
label {
margin-bottom: 0px;
}
.controls {
line-height: 18px;
}
</style>
<form class="form-horizontal" action="https://ticket.opensciencegrid.org/viewer/updatebasic?id=16226" method="post">
<div class="page-header">
    <h3><span class="muted">16226</span> / OSG Production Resource Group Baylor-Tier3-CE Failing Critical Metrics</h3>
</div>

<div class="row-fluid">
<div class="span5">
    <legend>Contact</legend>
    <div class="control-group">
        <label class="control-label">Full Name</label>
        <div class="controls">Christopher Pipes</div>
    </div>
    <div class="control-group">
        <label class="control-label">Email</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">Phone</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">CC</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>

    <legend>Details</legend>
    <div class="control-group"><label class="control-label">Resource Name</label><div class="controls">Baylor-Tier3-CE</div></div><div class="control-group"><label class="control-label">Associated VO</label><div class="controls">CMS</div></div><div class="control-group"><label class="control-label">Submitted Via</label><div class="controls">GOC Ticket/submit</div></div><div class="control-group"><label class="control-label">Submitter</label><div class="controls">Christopher Pipes</div></div><div class="control-group"><label class="control-label">Support Center</label><div class="controls">USCMS_Tier3</div></div>
    <div class="control-group">
        <label class="control-label">Ticket Type</label>
        <div class="controls">Problem/Request</div>
    </div>
    <div class="control-group">
        <label class="control-label">Priority</label>
        <div class="controls">Normal</div>
    </div>
    <div class="control-group">
        <label class="control-label">Status</label>
        <div class="controls">
Closed</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action</label>
        <div class="controls">ENG Action</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action Deadline</label>
        <div class="controls flag_red">2013-08-21</div>
    </div>

</div><!--span-->
<div class="span7">
    <legend>Assignees</legend>
    <div class="assignee" style="width: 60%">USCMS_Tier3 <span class="muted"> / OSG Support Centers</span></div>    <br>

    <legend>Assignees</legend>
    TODO
    <br>

    <style>
legend.noborder {
border-bottom: none;
}
</style>

<div id="attachment-list"/>
<script>
$(function () {
    var first = true;
    $.getJSON("https://ticket.opensciencegrid.org/attachment/list?id=16226", function (files) {
        //console.dir(files);
        var html = "<table class=\"table table-condensed\">";
        $(files).each(function() {
            if(first) {
                first = false;
                html += "<legend class=\"noborder\">Attachmenets</legend>";
            }
            html += "<tr class=\"attachment\">";
            html += "<td><img src=\""+this.thumbnail_url+"\"/></td>";
            html += "<td><a href=\""+this.url+"\" target=\"_blank\">"+this.name+"</a></td>";
            html += "<td>"+bytesToSize(this.size, 1)+"</td>";
            html += "</tr>";
        });
        html += "</table>";
        $("#attachment-list").html(html);
    });
});

function download(url) {
    window.open(url, "_blank");
}
</script>


</div><!--span-->
</div><!--row-fluid-->


</form>

</div>
<div id="updates" style="clear: both;">
    <legend>Past Updates
    <div class="btn-toolbar pull-right toolbar">
        <div class="btn-group">
                <a class="btn btn-small" href="/16226?sort=up&"><i class="icon-arrow-up"></i> Sort</a>

        
        <a class="btn btn-small" href="/16226?expandall=true&">Expand Descriptions</a>        <a class="btn btn-small" target="_blank" href="mailto:osg@tick.globalnoc.iu.edu?subject=Open%20Science%20Grid%3A%20OSG%20Production%20Resource%20Group%20Baylor-Tier3-CE%20Failing%20Critical%20Metrics%20ISSUE%3D16226%20PROJ%3D71"><i class="icon-envelope"></i> Update w/Email</a>
        </div>
    </div><!--btn-toolbar-->
    </legend>

    <div class='update_description'><i onclick="document.location='16226#1377106648'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-08-21T17:37:28+00:00">Aug 21, 2013 05:37 PM UTC</time> by <b>Christopher Pipes</b><a class="anchor" name="1377106648">&nbsp;</a></div><pre>Hi Mike,

I don&#39;t see Baylor-Tier3-CE or Baylor-Tier3-SE failing metric any more I will close the tickets out.

Thanks,
Chris</pre></div><div class='update_description'><i onclick="document.location='16226#1376700047'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-08-17T00:40:47+00:00">Aug 17, 2013 12:40 AM UTC</time> by <b>Christopher Pipes</b><a class="anchor" name="1376700047">&nbsp;</a></div><pre>Hello Mike,

Have you been able to determine the cause of the failed metrics?

Thanks,
Chris</pre></div><div class='update_description'><i onclick="document.location='16226#1375810151'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-08-06T17:29:11+00:00">Aug 6, 2013 05:29 PM UTC</time> by <b>Christopher Pipes</b><a class="anchor" name="1375810151">&nbsp;</a></div><pre>Hello Mike,

Have you been able to determine the cause of the failed metrics?

Thanks,
Chris</pre></div><div class='update_description'><i onclick="document.location='16226#1375462992'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-08-02T17:03:12+00:00">Aug 2, 2013 05:03 PM UTC</time> by <b>mike_hutcheson@....</b><a class="anchor" name="1375462992">&nbsp;</a></div><pre>Could this be related to replacing our host and service certs a couple of weeks ago (July 17)?  We&#39;re using gridmap  file instead of GUMS.  Below are the dates and DN  of the certificates I updated.  Do they look okay?  Did I miss any services?

On the SE&#58;

Host&#58;
#openssl x509 -in hostcert.pem -dates -subject -noout
notBefore=Jul 17 00&#58;00&#58;00 2013 GMT
notAfter=Aug 22 12&#58;00&#58;00 2014 GMT
subject= /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=Services/CN=kodiak-se.baylor.edu

Bestman&#58;
#openssl x509 -in bestmancert.pem -dates -subject -noout
notBefore=Jul 17 00&#58;00&#58;00 2013 GMT
notAfter=Aug 22 12&#58;00&#58;00 2014 GMT
subject= /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=Services/CN=kodiak-se.baylor.edu

On the CE&#58;

Host&#58;
openssl x509 -in hostcert.pem -dates -subject -noout
notBefore=Jul 16 00&#58;00&#58;00 2013 GMT
notAfter=Aug 21 12&#58;00&#58;00 2014 GMT
subject= /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=Services/CN=kodiak-ce.baylor.edu

RSV&#58;
openssl x509 -in rsvcert.pem -dates -subject -noout
notBefore=Jul 17 00&#58;00&#58;00 2013 GMT
notAfter=Aug 22 12&#58;00&#58;00 2014 GMT
subject= /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=Services/CN=rsv/kodiak-ce.baylor.edu

HTTP&#58;
openssl x509 -in httpcert.pem -dates -subject -noout
notBefore=Jul 17 00&#58;00&#58;00 2013 GMT
notAfter=Aug 22 12&#58;00&#58;00 2014 GMT
subject= /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=Services/CN=http/kodiak-ce.baylor.edu</pre></div><div class='update_description'><i onclick="document.location='16226#1375461909'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-08-02T16:45:09+00:00">Aug 2, 2013 04:45 PM UTC</time> by <b>mike_hutcheson@....</b><a class="anchor" name="1375461909">&nbsp;</a></div><pre>I may have screwed something up recently.  I&#39;ll play around a bit and see if I can backtrack to when things used to work.</pre></div><div class='update_description'><i onclick="document.location='16226#1375390088'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-08-01T20:48:08+00:00">Aug 1, 2013 08:48 PM UTC</time> by <b>doug johnson</b><a class="anchor" name="1375390088">&nbsp;</a></div><pre>Greetings,

This can happen for a number of reasons&#58;

1) You are not updating CRLs at all.
2) There is one (or more) CRL that has not been update for 72 hours.

#2 happens at least once a week at Colorado. It starts yellow and
eventually turns to red. Then the site fixes things on their end and the
probe turns green again.

The upshot of this is you have to look carefully at the error
message. Currently at Colorado we are seeing a yellow&#58;

detailsData&#58; WARNING&#58; 103 CRLs tested.
0 had not been updated for at least 72 hours;
1 CRLs have not been updated for at least 9 hours;
102 CRLs have been updated with the last 9 hours.

2013-08-01T18&#58;30&#58;09Z
WARNING&#58; CRL file for CA with hash 4b2783ac has not been updated since 2013/08/01 00&#58;47&#58;11

Also, different versions of RSV will turn the probe red after differing
amounts of time. I believe the older, OSG 1.2, RSV probes skipped the
yellow state and went right to the red state.

OK, a little more. When I look at what Baylor is reporting to the GOC in
terms of RSV probes, you are basically failing everything due to
Condor_G submission failure. This looks to me like the RSV user
certificate or proxy is not passing authorization at your site. I notice
that it fails for both your CE ans SE. Are you using GUMS? A service
certificate? A user proxy? Something is most likely failing to
authenicate.

Hope this helps,
<div id='show_869008100' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_869008100'>doug

<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; ------------=_1375387214-6487-0</font>
<font color='#7F7E6F'>&#62; Content-Type&#58; text/plain; charset=&#34;utf-8&#34;</font>
<font color='#7F7E6F'>&#62; Content-Disposition&#58; inline</font>
<font color='#7F7E6F'>&#62; Content-Transfer-Encoding&#58; quoted-printable</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font>
</div><script type='text/javascript'>
        $('#show_869008100').click(function() {
            $('#detail_869008100').slideDown("normal");
            $('#show_869008100').hide();
            $('#hide_869008100').show();
        });
        $('#hide_869008100').click(function() {
            $('#detail_869008100').slideUp();
            $('#hide_869008100').hide();
            $('#show_869008100').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='16226#1375388471'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-08-01T20:21:11+00:00">Aug 1, 2013 08:21 PM UTC</time> by <b>mike_hutcheson@....</b><a class="anchor" name="1375388471">&nbsp;</a></div><pre>Will do, Rob.  Thanks for letting me know.</pre></div><div class='update_description'><i onclick="document.location='16226#1375387214'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-08-01T20:00:14+00:00">Aug 1, 2013 08:00 PM UTC</time> by <b>USCMS_Tier3</b><a class="anchor" name="1375387214">&nbsp;</a></div><pre>Hi Mike,
While logged into kodiak.baylor.edu I looked at
<a href='http&#58;//kodiak-ce.baylor.edu/rsv/' target='_blank' rel='nofollow'>http&#58;//kodiak-ce.baylor.edu/rsv/</a>
in firefox.
Although the hostcert-expiry and httpcert expiry are green,
the cacert-expiry and crl-expiry are red.
Can you check the cron jobs and associated log files?
thx,
-rob

On Tue, Jul 30, 2013 at 2&#58;43 PM, Open Science Grid FootPrints
&#60;osg@....&#62; wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='16226#1375213410'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-07-30T19:43:30+00:00">Jul 30, 2013 07:43 PM UTC</time> by <b>Christopher Pipes</b><a class="anchor" name="1375213410">&nbsp;</a></div><pre>Greetings,

The OSG resource Baylor-Tier3-CE is failing one or more critical metrics as noted on the following page&#58;

<a href='http&#58;//tinyurl.com/Failing-Metrics' target='_blank' rel='nofollow'>http&#58;//tinyurl.com/Failing-Metrics</a>

Please go to this page and find your Resource listing to see the failure(s). Please attempt to let us know the status of these issues or correct the issues as soon as possible.

Thank you,
Christopher P.</pre></div><legend>Similar Recent Tickets <small>modified within the last 30 days</small></legend><div id="similar_tickets"><p class="muted">No similar tickets found.</p></div>
</div>
<script type="text/javascript">
function reset_anchor() {
    $("#updates .selected").removeClass("selected");
    var urls = document.location.toString().split('#'); 
    var anchor = urls[1];
    if(anchor) {
        $("a[name='"+anchor+"']").parents(".update_description").addClass("selected");
    }
}
function submitspam(ticket_id) {
    myret = confirm("Would you like to close this ticket as a security ticket, and submit the ticket content to akismet?");
    if(myret == true) {
        $.ajax("viewer/processspam?id="+ticket_id).done(function() {
            window.location.reload();
        });
    }
}

$(function() {
    reset_anchor();
    var ADDITIONAL_COOKIE_NAME = 'gocticket';
    var options = { path: '/', expires: 365};

    if(window.opener && window.opener.name == "gocticket_list") {
        v = $.cookie("closewindow");
        if(!v) {
            $("#closewindow").attr("checked", "checked"); //on by default
        } else {
            if(v == "checked") {
                $("#closewindow").attr("checked", "checked");
            }
        }
        $("#closewindow").click(function() {
            $.cookie("closewindow", $(this).attr('checked'), options);
        });
    } else {
        $("#closewindow_area").hide();
    }
    function updateTimeago() {
        $("time").timeago();
        setTimeout(updateTimeago, 30*1000);
    }
    updateTimeago();
    $(".description").focus(expand_description);
});
</script>
<hr/>
<footer>
<p>GOC Ticket Version 2.2 | <a href="https://ticket.opensciencegrid.org/goc/submit?app_issue_check=on&amp;app_issue_type=goc&amp;app_goc_url=https%3A%2F%2Fticket.opensciencegrid.org%3A443%2F16226">Report Bugs</a>
 | <a href="https://github.com/opensciencegrid/operations/blob/master/docs/privacy.md">Privacy Policy</a>
</p>

<p> <img align="top" src="/images/tag_orange.png"/> Copyright 2018 The Trustees of Indiana University - Developed for Open Science Grid</p>
</footer>


</div><!--container-fluid-->
<script src="https://ticket1.grid.iu.edu:8443/socket.io/socket.io.js"></script>
<script>
var chat = io.connect('https://ticket1.grid.iu.edu:8443');
chat.on('connect', function() {
    chat.emit('authenticate', {nodekey:'', ticketid: 16226});
});
chat.on('peers', function(peers) {
    $("#peers").html("");
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('peer_disconnect', function(pid) {
    $("#peer_"+pid).hide("slow");
});
chat.on('peer_connected', function(peers) {
    //expect only 1 peer connecting, but..
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('submit', function() {
    if(confirm("This ticket was updated. Do you want to refresh?")) {
        history.go(0);
    }
});

function addPeer(pid, peer) {
    var ipinfo = "";
    if(peer.ip != undefined) {
        ipinfo = "<span class=\"ip\">"+peer.ip+"</span>";
    }
    if(chat.io.engine.id == pid) {
        //don't display myself
        return;
    }
    var html = "<li class=\"new\" id=\"peer_"+pid+"\" class=\"peer\">"+peer.name+ipinfo+"</li>";
    $("#peers").prepend(html);
    $("#peers .new").animate({bottom: 0}, 1000, function() {$(this).removeClass("new")});
}

$(function() {
    $("#ticket_form").submit(function() {
        chat.emit('submit');
        return true;
    });
});
</script>
<script>
//used by searchbox
function parseValue(value) {
    var obj = new Object();
    var tokens = value.split("\t");
    obj.str = tokens[0];
    obj.count = tokens[1];
    return obj;
}

$(function() {
    //bootstrap-2.0.4 stuff
    $(".alert-message").alert();
    $(".dropdown-toggle").dropdown();
    $("span[rel='tooltip']").tooltip();
    $("a[rel=popover]").popover();

    //activate menu that user is currently on
    $("#menu_navigator").addClass("active"); 
    $("#submenu_").addClass("active"); 

    //translate zend validation error message to bootstrap
    $(".errors").addClass("alert").addClass("alert-error");

    //enable autocomplete for search box
    $("#search").autocomplete({
        source: function( request, response ) {
            $.ajax({
                url: "search/autocomplete",
                dataType: "text",
                data: {
                    //featureClass: "P",
                    //style: "full",
                    //maxRows: 12,
                    //name_startsWith: request.term
                    q: request.term
                },
                success: function( data ) {
                    response( $.map( data.split("\n"), function( item ) {
                        if(item == "") return null;
                        return {
                            value: item
                        }
                    }));
                }
            });
        },
        select: function(event, ui) {
            document.location = "search?q="+ui.item.value;
        }
    });
    
});
</script>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-69012-13");
pageTracker._trackPageview();
} catch(err) {}
</script>

</body>
