<!DOCTYPE html>
<html lang="en">
  <head>
  <base href="/">
    <title>[33047] WLCG accounting for T2_US_Wisconsin/GLOW</title>    <meta charset="utf-8" />
    <meta name="verify-v1" content="na5IcAJsZVOfEkboRxuIiZ1zpZgnZiWra+nKcS7nA/o=" />
    <meta name="google-site-verification" content="DLrk3ft4s8b-S2TloLCL2LD_t6wcTjgSluf5pmiu2kA" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />
    <link href="https://ticket.opensciencegrid.org/rss" rel="alternate" type="application/rss+xml" title="GOC Ticket Update feed" />

    <style type="text/css">
      body {
        padding-top: 50px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
     #search {
            width: 300px;
     }

    </style>

<script src="https://code.jquery.com/jquery-3.0.0.js"></script>
<script src="https://code.jquery.com/jquery-migrate-3.0.1.js"></script>

   <link href="//netdna.bootstrapcdn.com/bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet"/>
    <script src="//netdna.bootstrapcdn.com/bootstrap/2.3.2/js/bootstrap.min.js"></script>

    <link href="//netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"/>
    <link href="//ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/themes/smoothness/jquery-ui.min.css" rel="stylesheet"/>
 <script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>


    <link href="//cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/css/select2.min.css" rel="stylesheet" />
    <script src="//cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/js/select2.min.js"></script>

    <link href="css/ticket.css" rel="stylesheet" />
    <script src="lib/jquery.cookie.js"></script>

    <link href="images/tag_orange.png" rel="icon" type="image/png"/>
    <script src='https://www.google.com/recaptcha/api.js'></script>
  </head>

  <body>
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>

            <a class="brand" style="padding: 6px 0px 0px 6px;" href="http://opensciencegrid.org"><img src="https://ticket.opensciencegrid.org/images/osglogo.40x30.png"/></a>
            <ul class="nav">
                <li class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown">GOC Ticket <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    <li><a href="https://my.opensciencegrid.org">MyOSG</a></li>
                    <li><a href="https://oim.opensciencegrid.org">OIM</a></li>
                    <li class="active"><a href="index">Ticket</a></li>
	<li class="divider"></li>
	<li><a href="http://repo.grid.iu.edu">Repo</a></li>
	<li class="divider"></li>
	<li><a href="http://blogs.grid.iu.edu">Blog</a></li>
                    <li><a href="http://display.grid.iu.edu">Display</a></li>
                    <li><a href="http://osggoc.blogspot.com/">News</a></li>
                    </ul>
                </li>
            </ul>
            <ul class="nav pull-right">
                <li><a href="https://ticket.opensciencegrid.org/sso/">Login</a></li>            </ul>

            <div class="nav-collapse">
                <ul class="nav">
			 <li id="menu_submit"><a href="https://ticket.opensciencegrid.org/submit">Submit</a></li><li id="menu_view" class="dropdown"><a href="\#" class="dropdown-toggle" data-toggle="dropdown">View <b class="caret"></b></a><ul class="dropdown-menu"><li id="submenu_listopen"><a href="https://ticket.opensciencegrid.org/list/open">Open Tickets</a></li><li id="submenu_listrecentclose"><a href="https://ticket.opensciencegrid.org/list/recentclose">Recently Closed Tickets</a></li><li class="divider"></li><li id="submenu_alltickets"><a href="https://ticket.opensciencegrid.org/search?q=&amp;sort=id">All Tickets</a></li></ul></li>                </ul>

                <form class="navbar-search pull-right" action="viewer">
                    <input id="search" type="text" name="id" class="search-query span2" placeholder="Search Ticket" value=""/>
                </form>
            </div>
        </div>
      </div>
    </div>

<script type='text/javascript' src='lib/jquery.timeago.js'></script>
<script type='text/javascript' src='lib/byte2size.js'></script>
<style>
#updates .toolbar {
position: relative;
margin-top: 0px;
top: -10px;
font-weight: normal;
}
#updates a.anchor {
position: relative;
top: -50px;
}
#updates .selected pre {
animation:selected 2s;
animation-iteration-count: 2;
animation-direction: alternate;
-webkit-animation:selected 2s; 
-webkit-animation-iteration-count: 2;
-webkit-animation-direction: alternate;
box-shadow: inset 1px 1px 20px #9ad;
border: 1px solid #9ab;
margin: 5px 0px;
padding-left: 10px;
}
@keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ab;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
@-webkit-keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ad;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
#updates pre {
background-color: inherit;
line-height: 15px;
padding: 5px;
}
#updates .header {
color: #999;
}
#updates .update_history pre {
background-color: #eee;
color: #666;
font-size: 85%;
}
#updates .clickable {
cursor: pointer;
}
#updates .clickable:hover {
color: #D98719;
}
#updates .meta_information pre {
background-color: #fed;
}
#similar_tickets {
max-height: 300px;
overflow-y: auto;
pointer-events: none;
padding: 5px;
background-color: #f4f4f4;
}
.btn-toolbar {
margin-bottom: 0;
height: 30px;
}
#peers {
position: fixed;
bottom: 0px;
right: 0px;
z-index: 100;
list-style: none;
padding: 5px 0px 0px 5px;
margin: 0px;
background-color: white;
box-shadow: 0px 0px 10px white;
}
#peers li {
background-color: #ccc;
color: #000;
display: inline-block;
padding: 5px 10px;
margin-right: 5px;
position: relative;
}
/*
#peers li:hover {
background-color: #999;
cursor: pointer;
}
*/
#peers span.ip {
padding-left: 5px;
color: #666;
}
#peers .new {
bottom: -30px;
}
/*
#peers .me {
background-color: red;
}
*/
</style>

<div class="container-fluid">
<ul id="peers"></ul>
<div class="alert alert-danger"><a class="close" href="#" data-dismiss="alert">&times;</a>By the end of May 2018, the ticketing system at https://ticket.opensciencegrid.org will be retired and support will be provided at https://support.opensciencegrid.org. Throughout this transition the support email (help@opensciencegrid.org) will be available as a point of contact.<br><br>                                                   
                                                                                                                                                                                   
Please see the service migration page for details: https://opensciencegrid.github.io/technology/policy/service-migrations-spring-2018/#ticket</div><div id="presence" class="pull-right"></div><div class="ticketgui"><script type="text/javascript" src="https://ticket.opensciencegrid.org/lib/checktab.js"></script>

<script>
var expanded = false;
function expand_description() {
    var desc = $(".description");
    if(!expanded) {
        expanded = true;
        //expand to minheight
        var min = 250;
        if(desc.height() < min) {
            desc.animate({height: min}, 200);
        }
    }
}

$(document).ready(function() {
    $("input[name='nad']").datepicker({
        dateFormat: 'yy-mm-dd'
    });
});

</script>



<style>
.form-horizontal .control-label {
padding-top: inherit;
font-size:90%;
color:#666;
}
label {
margin-bottom: 0px;
}
.controls {
line-height: 18px;
}
</style>
<form class="form-horizontal" action="https://ticket.opensciencegrid.org/viewer/updatebasic?id=33047" method="post">
<div class="page-header">
    <h3><span class="muted">33047</span> / WLCG accounting for T2_US_Wisconsin/GLOW</h3>
</div>

<div class="row-fluid">
<div class="span5">
    <legend>Contact</legend>
    <div class="control-group">
        <label class="control-label">Full Name</label>
        <div class="controls">Daniel Bradley</div>
    </div>
    <div class="control-group">
        <label class="control-label">Email</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">Phone</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">CC</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>

    <legend>Details</legend>
    <div class="control-group"><label class="control-label">Resource Name</label><div class="controls">GLOW_SUBMIT1</div></div><div class="control-group"><label class="control-label">Associated VO</label><div class="controls">CMS</div></div><div class="control-group"><label class="control-label">Submitted Via</label><div class="controls">GOC Ticket/submit</div></div><div class="control-group"><label class="control-label">Submitter</label><div class="controls">Daniel Bradley</div></div><div class="control-group"><label class="control-label">Support Center</label><div class="controls">USCMS_Tier2</div></div><div class="control-group"><label class="control-label">Ticket Links</label><div class="controls"></div></div>
    <div class="control-group">
        <label class="control-label">Ticket Type</label>
        <div class="controls">Problem/Request</div>
    </div>
    <div class="control-group">
        <label class="control-label">Priority</label>
        <div class="controls">Normal</div>
    </div>
    <div class="control-group">
        <label class="control-label">Status</label>
        <div class="controls">
Resolved</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action</label>
        <div class="controls">Brian Please Review</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action Deadline</label>
        <div class="controls flag_red">2017-04-07</div>
    </div>

</div><!--span-->
<div class="span7">
    <legend>Assignees</legend>
    <div class="assignee" style="width: 60%">Scott Teige <span class="muted"> / OSG Operations Infrastructure</span></div><div class="assignee" style="width: 60%">USCMS Tier 2 <span class="muted"> / OSG Support Centers</span></div><div class="assignee" style="width: 60%">Rob Quick <span class="muted"> / OSG GOC Management</span></div><div class="assignee" style="width: 60%">Carl Edquist <span class="muted"> / OSG Software Team</span></div><div class="assignee" style="width: 60%">Brian Lin <span class="muted"> / OSG Software Team</span></div>    <br>

    <legend>Assignees</legend>
    TODO
    <br>

    <style>
legend.noborder {
border-bottom: none;
}
</style>

<div id="attachment-list"/>
<script>
$(function () {
    var first = true;
    $.getJSON("https://ticket.opensciencegrid.org/attachment/list?id=33047", function (files) {
        //console.dir(files);
        var html = "<table class=\"table table-condensed\">";
        $(files).each(function() {
            if(first) {
                first = false;
                html += "<legend class=\"noborder\">Attachmenets</legend>";
            }
            html += "<tr class=\"attachment\">";
            html += "<td><img src=\""+this.thumbnail_url+"\"/></td>";
            html += "<td><a href=\""+this.url+"\" target=\"_blank\">"+this.name+"</a></td>";
            html += "<td>"+bytesToSize(this.size, 1)+"</td>";
            html += "</tr>";
        });
        html += "</table>";
        $("#attachment-list").html(html);
    });
});

function download(url) {
    window.open(url, "_blank");
}
</script>


</div><!--span-->
</div><!--row-fluid-->


</form>

</div>
<div id="updates" style="clear: both;">
    <legend>Past Updates
    <div class="btn-toolbar pull-right toolbar">
        <div class="btn-group">
                <a class="btn btn-small" href="/33047?sort=up&"><i class="icon-arrow-up"></i> Sort</a>

        
        <a class="btn btn-small" href="/33047?expandall=true&">Expand Descriptions</a>        <a class="btn btn-small" target="_blank" href="mailto:osg@tick.globalnoc.iu.edu?subject=Open%20Science%20Grid%3A%20WLCG%20accounting%20for%20T2_US_Wisconsin%2FGLOW%20ISSUE%3D33047%20PROJ%3D71"><i class="icon-envelope"></i> Update w/Email</a>
        </div>
    </div><!--btn-toolbar-->
    </legend>

    <div class='update_description'><i onclick="document.location='33047#1491487465'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-04-06T14:04:25+00:00">Apr 6, 2017 02:04 PM UTC</time> by <b>Scott Teige</b><a class="anchor" name="1491487465">&nbsp;</a></div><pre>Resolving per customer request.</pre></div><div class='update_description'><i onclick="document.location='33047#1491405168'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-04-05T15:12:48+00:00">Apr 5, 2017 03:12 PM UTC</time> by <b>Vince Neal</b><a class="anchor" name="1491405168">&nbsp;</a></div><pre>Thank you for informing us that this issue has been resolved. I will close this ticket.
Please submit problems, requests, and questions at&#58; <a href='https&#58;//ticket.grid.iu.edu/goc/open' target='_blank' rel='nofollow'>https&#58;//ticket.grid.iu.edu/goc/open</a>

OSG Grid Operations Center
goc@...., 317-278-9699
Visit the OSG Operations Page&#58; <a href='http&#58;//osggoc.blogspot.com/' target='_blank' rel='nofollow'>http&#58;//osggoc.blogspot.com/</a></pre></div><div class='update_description'><i onclick="document.location='33047#1491401303'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-04-05T14:08:23+00:00">Apr 5, 2017 02:08 PM UTC</time><a class="anchor" name="1491401303">&nbsp;</a></div><pre>Consider this ticket resolved.  Our questions about gratia accounting have been answered.

Thanks,
--Dan

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=dbradley/CN=614788/CN=Daniel Charles Bradley</pre></div><div class='update_description'><i onclick="document.location='33047#1491398828'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-04-05T13:27:08+00:00">Apr 5, 2017 01:27 PM UTC</time> by <b>Scott Teige</b><a class="anchor" name="1491398828">&nbsp;</a></div><pre>Should we consider this issue resolved or do we need to leave this ticket open?</pre></div><div class='update_description'><i onclick="document.location='33047#1491339187'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-04-04T20:53:07+00:00">Apr 4, 2017 08:53 PM UTC</time><a class="anchor" name="1491339187">&nbsp;</a></div><pre>As for the discrepancy between the CMS dashboard and the gratia usage records, we can now rule out one of the possible sources of trouble.  All of the relevant job submission nodes are being monitored by gratia.

We know of one other possible cause of discrepancy in February&#58; one of our main CEs was drained and upgraded in a way that resulted in loss of gratia reports for the duration of the draining period.  If that is really the full explanation, then this was a one time effect, and we are not all that concerned about it.  The March report will tell us whether we can put this to rest.

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=dbradley/CN=614788/CN=Daniel Charles Bradley</pre></div><div class='update_description'><i onclick="document.location='33047#1491338706'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-04-04T20:45:06+00:00">Apr 4, 2017 08:45 PM UTC</time><a class="anchor" name="1491338706">&nbsp;</a></div><pre>Thanks for clarifying things, Scott.

The conclusion I draw from all this is that the usage records from the loginXX.hep.wisc.edu gratia probes _are_ being included in the GLOW/T2_US_Wisconsin WLCG reports, because the apel report files contain GlobalUserName values that correspond to CMS jobs submitted on the loginXX.hep.wisc.edu machines, and, as has been demonstrated, those same report files match the WLCG report exactly.

That&#39;s all we wanted to know.

Thanks!
--Dan

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=dbradley/CN=614788/CN=Daniel Charles Bradley</pre></div><div class='update_description'><i onclick="document.location='33047#1491338657'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-04-04T20:44:17+00:00">Apr 4, 2017 08:44 PM UTC</time> by <b>Rob Quick</b><a class="anchor" name="1491338657">&nbsp;</a></div><pre>James,

Can you send a link to the CMS dashboard so we can compare? I don&#39;t see the link in the ticket.

Thanks,
Rob</pre></div><div class='update_description'><i onclick="document.location='33047#1491335575'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-04-04T19:52:55+00:00">Apr 4, 2017 07:52 PM UTC</time> by <b>Scott Teige</b><a class="anchor" name="1491335575">&nbsp;</a></div><pre>I can&#39;t type, CPU hours do match exactly but are&#58; 53,177,824</pre></div><div class='update_description'><i onclick="document.location='33047#1491335052'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-04-04T19:44:12+00:00">Apr 4, 2017 07:44 PM UTC</time> by <b>Scott Teige</b><a class="anchor" name="1491335052">&nbsp;</a></div><pre>Comparing as before for GLOW&#58;

Job count matches exactly&#58; 830,947
CPU hours matches exactly 53,144,824

hmmmm. Your call.</pre></div><div class='update_description'><i onclick="document.location='33047#1491331991'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-04-04T18:53:11+00:00">Apr 4, 2017 06:53 PM UTC</time> by <b>letts@....</b><a class="anchor" name="1491331991">&nbsp;</a></div><pre>CMS Dashboard shows a lot more activity at the site during the month. It is a generally reliable standard.

James

<font color='#7F7E6F'>&#62; On Apr 4, 2017, at 7&#58;02 PM, Open Science Grid FootPrints &#60;osg@....&#62; wrote&#58;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; i) Determine if the content generated in 1) is rational (requiring correctness requires a known standard, none exists)</font></pre></div><div class='update_description'><i onclick="document.location='33047#1491329499'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-04-04T18:11:39+00:00">Apr 4, 2017 06:11 PM UTC</time> by <b>Scott Teige</b><a class="anchor" name="1491329499">&nbsp;</a></div><pre>On the last update, what must be computed from the OSG report is
(Normalized CPU seconds)*(number of cores)/(3600)
summed over the VOs (atlas and CMS) and
summed over GlobalUserName

The numbers for the individual VOs also match.

So progress to date&#58;
1) Compare January to February
2) Convert OSG normed-seconds to WLCG Wallclock Work HS06 hours with&#58;
(Normalized CPU seconds)*(number of cores)/(3600)
3) This satisfies condition ii) for WLCG-Feb data. The numbers transported
from operations to APEL match the numbers posted on the far end.

That is to say, the algorithm is known and understood, transport worked, and receiving end posts correctly (at least in January)</pre></div><div class='update_description'><i onclick="document.location='33047#1491328608'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-04-04T17:56:48+00:00">Apr 4, 2017 05:56 PM UTC</time> by <b>Scott Teige</b><a class="anchor" name="1491328608">&nbsp;</a></div><pre>On to CPU (for bottom line fans, I can make the numbers agree exactly here too)

From  <a href='http&#58;//reports.grid.iu.edu/reports/02_2017.apel' target='_blank' rel='nofollow'>http&#58;//reports.grid.iu.edu/reports/02_2017.apel</a> I get&#58;

Seconds	cores	hours	hours*cores
Atlas	1	2332213	1	647.8369444	647.8369444
Atlas	2	13071309138	1	3630919.205	3630919.205
Atlas	3	82786418790	1	22996227.44	22996227.44
Atlas	4	258425	1	71.78472222	71.78472222
CMS	5	2945996	1	818.3322222	818.3322222
Atlas	6	1306133968	2	362814.9911	725629.9822
Atlas	7	196705172	2	54640.32556	109280.6511
Atlas	8	24694828161	8	6859674.489	54877395.91
Atlas	9	5358786650	8	1488551.847	11908414.78
sum	1.2742E+11		35,394,366.25	94,249,405.93

Again, the 94,249,405 number matches *exactly* what is reported for January here&#58;
<a href='https&#58;//accounting.egi.eu/tier2/site/BNL-ATLAS/normelap_processors/VO/DATE/2017/2/2017/4/lhc/onlyinfrajobs/' target='_blank' rel='nofollow'>https&#58;//accounting.egi.eu/tier2/site/BNL-ATLAS/normelap_processors/VO/DATE/2017/2/2017/4/lhc/onlyinfrajobs/</a></pre></div><div class='update_description'><i onclick="document.location='33047#1491328318'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-04-04T17:51:58+00:00">Apr 4, 2017 05:51 PM UTC</time> by <b>Scott Teige</b><a class="anchor" name="1491328318">&nbsp;</a></div><pre>Lets compare number of jobs to eliminate any problems with normalization factors, cores, etc.
and choose a resource with a manageable number of resources&#58;

From <a href='http&#58;//reports.grid.iu.edu/reports/02_2017.apel' target='_blank' rel='nofollow'>http&#58;//reports.grid.iu.edu/reports/02_2017.apel</a>  **** observe this is for February  *****
For the BNL-ATLAS resource I get
Atlas	13424
Atlas	163713
Atlas	802801
Atlas	49
CMS	13021
Atlas	78873
Atlas	38128
Atlas	151132
Atlas	27336
Total	1288477

Which I compare to&#58;
<a href='https&#58;//accounting.egi.eu/tier2/site/BNL-ATLAS/njobs/VO/DATE/2017/2/2017/4/lhc/onlyinfrajobs/' target='_blank' rel='nofollow'>https&#58;//accounting.egi.eu/tier2/site/BNL-ATLAS/njobs/VO/DATE/2017/2/2017/4/lhc/onlyinfrajobs/</a>

By my reckoning the January column of the egi document matches *exactly* the values derived
from the February entry on reports.grid.iu.edu. The month mismatch is due to the fact that
the last &#34;January&#34; report is sent on *February 3rd* to allow long running jobs to complete and
be accounted in the proper month. (Proper is defined by the receiving end and is based on
the convention that a job *started* in January should be counted as a January job)</pre></div><div class='update_description'><i onclick="document.location='33047#1491325331'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-04-04T17:02:11+00:00">Apr 4, 2017 05:02 PM UTC</time> by <b>Scott Teige</b><a class="anchor" name="1491325331">&nbsp;</a></div><pre>Status update&#58;

1) The report was generated on time, host machine&#58; oim.grid.iu.edu
2) A copy of the report was made available for web viewing on time, host machine&#58; reports.grid.iu.edu
3) The report text was transported to the APEL production endpoint on time, host machine reports-itb.grid.iu.edu
(This runs on an itb labeled instance because this was the origin negotiated during development,
there was reluctance on the receiving end to change it when development concluded)
4) The generated report text matches the transported text. Five fields were checked manually,
all matched exactly.

Two tasks remain&#58;
i) Determine if the content generated in 1) is rational (requiring correctness requires a known standard, none exists)
ii) Determine that the numbers posted match the numbers sent. (to eliminate a translation problem on the receiving end)</pre></div><div class='update_description'><i onclick="document.location='33047#1491323463'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-04-04T16:31:03+00:00">Apr 4, 2017 04:31 PM UTC</time> by <b>Rob Quick</b><a class="anchor" name="1491323463">&nbsp;</a></div><pre>I have yet to make the math work I get 56,613,900,525 Normalized Wall Seconds pretty similar to Dan. the APEL report is in Hours so this translates to 15726083 Normalized Wall Hours (a factor of 3 too small). I basically summed all GLOW hours and divided by 3600. Can anyone tell me what&#39;s wrong with my logic?

Rob</pre></div><div class='update_description'><i onclick="document.location='33047#1491298743'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-04-04T09:39:03+00:00">Apr 4, 2017 09:39 AM UTC</time> by <b>Rob Quick</b><a class="anchor" name="1491298743">&nbsp;</a></div><pre>So here is the APEL page for GLOW during Feb and it matches the report <a href='https&#58;//accounting.egi.eu/tier2/site/GLOW/normelap_processors/VO/DATE/2017/2/2017/2/lhc/onlyinfrajobs/.' target='_blank' rel='nofollow'>https&#58;//accounting.egi.eu/tier2/site/GLOW/normelap_processors/VO/DATE/2017/2/2017/2/lhc/onlyinfrajobs/.</a>

My initial attempts to calculate the GLOW VO Normalize Wall Duration at <a href='http&#58;//reports.grid.iu.edu/reports/02_2017.apel' target='_blank' rel='nofollow'>http&#58;//reports.grid.iu.edu/reports/02_2017.apel</a> to match this number have failed. I&#39;m sure it&#39;s a math error on my end. If I remember correctly this report is in seconds and will need to adjusted to hours to match.

I&#39;m moving into a conference venue for the afternoon CEST and will try again to match our report with APEL but will not have a lot of time today. Scott, can you attempt this when you arrive?

I think we can eliminate that the error was introduced in the report generation at APEL phase.

Rob</pre></div><div class='update_description'><i onclick="document.location='33047#1491295060'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-04-04T08:37:40+00:00">Apr 4, 2017 08:37 AM UTC</time><a class="anchor" name="1491295060">&nbsp;</a></div><pre>Adding myself in cc.
JAMES

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=jletts/CN=409293/CN=James Letts</pre></div><div class='update_description'><i onclick="document.location='33047#1491257022'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-04-03T22:03:42+00:00">Apr 3, 2017 10:03 PM UTC</time> by <b>Carl Edquist</b><a class="anchor" name="1491257022">&nbsp;</a></div><pre>Oh right, the GLOW Site...

Ok, well I know there are some hoops for computing the Site in the apel report.  It could be that it doesn&#39;t always correspond 100% to the OIM &#34;Site&#34;, even though maybe it should (?)

Off hand I&#39;m not sure what the pipeline looks like for generating the WLCG report (pdf) from the apel report text, assuming that&#39;s the source...

Carl</pre></div><div class='update_description'><i onclick="document.location='33047#1491256544'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-04-03T21:55:44+00:00">Apr 3, 2017 09:55 PM UTC</time><a class="anchor" name="1491256544">&nbsp;</a></div><pre>Hi Carl,

I don&#39;t know if it is correct to say that the &#34;GLOW vo&#34; and T2_US_Wisconsin are 1-1.  The GLOW _site_ and T2_US_Wisconsin are 1-1.  The GLOW resource group and T2_US_Wisconsin are also 1-1.

This can be seen in the &#34;GLOW Site&#34; section of the OIM topology page.

<a href='http&#58;//oim.opensciencegrid.org/oim/topology' target='_blank' rel='nofollow'>http&#58;//oim.opensciencegrid.org/oim/topology</a>

All of the CEs and submit nodes listed there are part of T2_US_Wisconsin.

--Dan

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=dbradley/CN=614788/CN=Daniel Charles Bradley</pre></div><div class='update_description'><i onclick="document.location='33047#1491256170'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-04-03T21:49:30+00:00">Apr 3, 2017 09:49 PM UTC</time> by <b>Carl Edquist</b><a class="anchor" name="1491256170">&nbsp;</a></div><pre>Dan, do you know if the GLOW vo and the T2_US_Wisconsin federation are 1-1?  (Or is there anything GLOW not in T2_US_Wisconsin, or vice-versa?)

Scott, if we do find and resolve the problem with this, are we able to correct previous months?  I have in my head that we can for 3 months back, but I don&#39;t remember exactly.

Thanks,
Carl</pre></div><div class='update_description'><i onclick="document.location='33047#1491254525'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-04-03T21:22:05+00:00">Apr 3, 2017 09:22 PM UTC</time><a class="anchor" name="1491254525">&nbsp;</a></div><pre>The file 02_2017.apel on the page linked to via &#34;Reports Current&#34; on <a href='http&#58;//steige.grid.iu.edu/steige/textw.html' target='_blank' rel='nofollow'>http&#58;//steige.grid.iu.edu/steige/textw.html</a> contains some DNs in GLOW that I think could only have come from the loginXX.hep.wisc.edu machines.  If this file is the source of data for the WLCG reports, then that seems to affirm that loginXX.hep.wisc.edu probes are being counted for WLCG.

However, if I total up NormalisedWallDuration for site GLOW in 02_2017.apel, I get 57,858,125,290.  In the WLCG report linked below, the value reported for T2_US_Wisconsin is 52,377,417.  Since these two numbers do not match, that leads me to question whether this actually is the source of information used to create the WLCG report.

<a href='https&#58;//espace.cern.ch/WLCG-document-repository/Accounting/Tier-2/2017/02_WLCG-T2-accounting_Feb2017.pdf' target='_blank' rel='nofollow'>https&#58;//espace.cern.ch/WLCG-document-repository/Accounting/Tier-2/2017/02_WLCG-T2-accounting_Feb2017.pdf</a>

So the question still remains.

--Dan

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=dbradley/CN=614788/CN=Daniel Charles Bradley</pre></div><div class='update_description'><i onclick="document.location='33047#1491224717'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-04-03T13:05:17+00:00">Apr 3, 2017 01:05 PM UTC</time> by <b>Scott Teige</b><a class="anchor" name="1491224717">&nbsp;</a></div><pre>(sorry for linking my homepage but)
You can verify the reports are current here&#58;
<a href='http&#58;//steige.grid.iu.edu/steige/textw.html' target='_blank' rel='nofollow'>http&#58;//steige.grid.iu.edu/steige/textw.html</a>
the &#34;Reports Current&#58;&#34; link. The link also takes you to the content of the report.
The actual script is maintanined by Carl Edqvist and i have not seen any requests
that I do anything about it recently.
S</pre></div><div class='update_description'><i onclick="document.location='33047#1490987947'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-03-31T19:19:07+00:00">Mar 31, 2017 07:19 PM UTC</time> by <b>Brian Lin</b><a class="anchor" name="1490987947">&nbsp;</a></div><pre>Hey Ajit, sorry for the radio silence. We&#39;re currently working on the script that uploads Gratia data to the WLCG. I believe Rob/Scott are responsible for running the current version of the script, so if they could verify that it&#39;s actually running without issues, Carl can start looking into why the records may not be reported.

- Brian</pre></div><div class='update_description'><i onclick="document.location='33047#1490987661'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-03-31T19:14:21+00:00">Mar 31, 2017 07:14 PM UTC</time><a class="anchor" name="1490987661">&nbsp;</a></div><pre>In case it helps, here is a link to a gratia page showing the usage that has been reported by these probes&#58;

<a href='https&#58;//gracc.opensciencegrid.org/dashboard/db/payload-jobs-summary?var-VOName=All&var-Project=All&var-Facility=All&var-User=All&var-ExitCode=All&var-Probe=condor&#58' target='_blank' rel='nofollow'>https&#58;//gracc.opensciencegrid.org/dashboard/db/payload-jobs-summary?var-VOName=All&var-Project=All&var-Facility=All&var-User=All&var-ExitCode=All&var-Probe=condor&#58</a>;login01.hep.wisc.edu&var-Probe=condor&#58;login02.hep.wisc.edu&var-Probe=condor&#58;login03.hep.wisc.edu&var-Probe=condor&#58;login04.hep.wisc.edu&var-Probe=condor&#58;login05.hep.wisc.edu&var-Probe=condor&#58;login06.hep.wisc.edu&var-Probe=condor&#58;uwlogin.cern.ch&var-interval=1d&orgId=1

Everything there looks correct.  We just need to be sure this usage is getting added to the WLCG report.

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=dbradley/CN=614788/CN=Daniel Charles Bradley</pre></div><div class='update_description'><i onclick="document.location='33047#1490985252'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-03-31T18:34:12+00:00">Mar 31, 2017 06:34 PM UTC</time><a class="anchor" name="1490985252">&nbsp;</a></div><pre>Oops.  I just noticed that I did not respond to Brian&#39;s question from 11 days ago.

We have SuppressGridLocalRecords=&#34;0&#34;.  My original message in this ticket details how SiteName is set.

Our question is simply this&#58; _are_ these probes being included in the WLCG accounting for T2_US_Wisconsin aka GLOW?

Thanks,
--Dan

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=dbradley/CN=614788/CN=Daniel Charles Bradley</pre></div><div class='update_description'><i onclick="document.location='33047#1490982789'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-03-31T17:53:09+00:00">Mar 31, 2017 05:53 PM UTC</time> by <b>ajit@....</b><a class="anchor" name="1490982789">&nbsp;</a></div><pre>Was wondering if there is any progress on this ? The CMS T2 management is eager to get this understood/resolved asap, and have WLCG correct the February accounting discrepancy for Wisconsin, if necessary. Also, we could revert the configuration changes that we made, and see if the discrepancy goes away in the April accounting report.

Thanks,
- Ajit

On 03/22/2017 10&#58;09 AM, Open Science Grid FootPrints wrote&#58;
[Duplicate message snipped]</pre></div><div class='update_description'><i onclick="document.location='33047#1490195356'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-03-22T15:09:16+00:00">Mar 22, 2017 03:09 PM UTC</time><a class="anchor" name="1490195356">&nbsp;</a></div><pre>In case it isn&#39;t clear&#58; I don&#39;t know whether or not the usage stats for the gratia probes I mentioned are getting credited to T2_US_Wisconsin in WLCG reporting or not.  We are trying to explain some discrepancies in the WLCG report, so we are wondering whether or not the configuration change to these probes caused them to stop being counted.

--Dan

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=dbradley/CN=614788/CN=Daniel Charles Bradley</pre></div><div class='update_description'><i onclick="document.location='33047#1490194883'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-03-22T15:01:23+00:00">Mar 22, 2017 03:01 PM UTC</time> by <b>Brian Lin</b><a class="anchor" name="1490194883">&nbsp;</a></div><pre>Rob, Scott&#58; Dan&#39;s accounting numbers are not making it up to WLCG and Tanya mentioned that you guys are responsible for the WLCG reporting. Could you take a look to see why the numbers are not being reported? The Gratia probe recently updated the host_description field for the records such that it reflected the gwms frontend it was submitted from if it&#39;s not running in a glidein. Perhaps that&#39;s why there&#39;s an issue.

Thanks,
Brian</pre></div><div class='update_description'><i onclick="document.location='33047#1490022436'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-03-20T15:07:16+00:00">Mar 20, 2017 03:07 PM UTC</time> by <b>Brian Lin</b><a class="anchor" name="1490022436">&nbsp;</a></div><pre>Dan, do you have SuppressGridLocalRecords=&#34;0&#34; set in each of your ProbeConfigs? How about the SiteName vars in your configuration, are they set to login0{1-6}.hep.wisc.edu and uwlogin.cern.ch? If that&#39;s the case, the probe is doing what it should be and I&#39;m not entirely sure where the problem with WLCG accounting stands.

Shreyas, can you help clear this up?

Thanks,
Brian</pre></div><div class='update_description'><i onclick="document.location='33047#1489777499'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-03-17T19:04:59+00:00">Mar 17, 2017 07:04 PM UTC</time> by <b>Vince Neal</b><a class="anchor" name="1489777499">&nbsp;</a></div><pre>Hi Dan,

I have added Brian Lin to this ticket so he can shed some light on the situation.

Thank you,</pre></div><div class='update_description'><i onclick="document.location='33047#1489685928'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-03-16T17:38:48+00:00">Mar 16, 2017 05:38 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1489685928">&nbsp;</a></div><pre>Hello,

At the request of OSG accounting admins (Brian Lin, Shreyas Bhat) in January, we changed our gratia configuration on condor submit nodes in the Wisconsin CMS Tier-2 site, T2_US_Wisconsin, aka GLOW.  We suspect that this may have caused gratia usage stats from those submit nodes to no longer be attributed to our site in WLCG accounting.  We would like to confirm that the usage by jobs submitted from these submit nodes is attributed to our site in WLCG accounting, and if it is not, we&#39;d like that to be corrected.

I am not sure who to contact about this, so hopefully you can get us connected to the right people.

Prior to the change, the affected submit nodes were configured with the following gratia condor probe configuration&#58;

SiteName=&#34;GLOW&#34;

After the change, they now use a specific site name that is unique to each submit node.  The following values are used for SiteName&#58;

GLOW_SUBMIT1
GLOW_SUBMIT2
GLOW_SUBMIT3
GLOW_SUBMIT4
GLOW_SUBMIT5
GLOW_SUBMIT6
GLOW_SUBMIT_CERN

Each of the submit nodes is registered in OIM and has WLCG Accounting Name in OIM set to T2_US_Wisconsin.  The setting &#34;Part of Interop Accounting&#34; is True and &#34;Part of Interop Monitoring&#34; is False.

The gratia probe names corresponding to the SiteName values listed above are&#58;

condor&#58;login01.hep.wisc.edu
condor&#58;login02.hep.wisc.edu
condor&#58;login03.hep.wisc.edu
condor&#58;login04.hep.wisc.edu
condor&#58;login05.hep.wisc.edu
condor&#58;login06.hep.wisc.edu
condor&#58;uwlogin.cern.ch

The change to the configuration happened on Jan 5, 2017.

Please let us know if there is any additional information we can provide to help with this query.
<div id='show_470107673' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_470107673'>
Thanks,
--Dan Bradley

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=dbradley/CN=614788/CN=Daniel Charles Bradley

</div><script type='text/javascript'>
        $('#show_470107673').click(function() {
            $('#detail_470107673').slideDown("normal");
            $('#show_470107673').hide();
            $('#hide_470107673').show();
        });
        $('#hide_470107673').click(function() {
            $('#detail_470107673').slideUp();
            $('#hide_470107673').hide();
            $('#show_470107673').show();
        });
        </script></pre></div><legend>Similar Recent Tickets <small>modified within the last 30 days</small></legend><div id="similar_tickets"><p class="muted">No similar tickets found.</p></div>
</div>
<script type="text/javascript">
function reset_anchor() {
    $("#updates .selected").removeClass("selected");
    var urls = document.location.toString().split('#'); 
    var anchor = urls[1];
    if(anchor) {
        $("a[name='"+anchor+"']").parents(".update_description").addClass("selected");
    }
}
function submitspam(ticket_id) {
    myret = confirm("Would you like to close this ticket as a security ticket, and submit the ticket content to akismet?");
    if(myret == true) {
        $.ajax("viewer/processspam?id="+ticket_id).done(function() {
            window.location.reload();
        });
    }
}

$(function() {
    reset_anchor();
    var ADDITIONAL_COOKIE_NAME = 'gocticket';
    var options = { path: '/', expires: 365};

    if(window.opener && window.opener.name == "gocticket_list") {
        v = $.cookie("closewindow");
        if(!v) {
            $("#closewindow").attr("checked", "checked"); //on by default
        } else {
            if(v == "checked") {
                $("#closewindow").attr("checked", "checked");
            }
        }
        $("#closewindow").click(function() {
            $.cookie("closewindow", $(this).attr('checked'), options);
        });
    } else {
        $("#closewindow_area").hide();
    }
    function updateTimeago() {
        $("time").timeago();
        setTimeout(updateTimeago, 30*1000);
    }
    updateTimeago();
    $(".description").focus(expand_description);
});
</script>
<hr/>
<footer>
<p>GOC Ticket Version 2.2 | <a href="https://ticket.opensciencegrid.org/goc/submit?app_issue_check=on&amp;app_issue_type=goc&amp;app_goc_url=https%3A%2F%2Fticket.opensciencegrid.org%3A443%2F33047">Report Bugs</a>
 | <a href="https://github.com/opensciencegrid/operations/blob/master/docs/privacy.md">Privacy Policy</a>
</p>

<p> <img align="top" src="/images/tag_orange.png"/> Copyright 2018 The Trustees of Indiana University - Developed for Open Science Grid</p>
</footer>


</div><!--container-fluid-->
<script src="https://ticket1.grid.iu.edu:8443/socket.io/socket.io.js"></script>
<script>
var chat = io.connect('https://ticket1.grid.iu.edu:8443');
chat.on('connect', function() {
    chat.emit('authenticate', {nodekey:'', ticketid: 33047});
});
chat.on('peers', function(peers) {
    $("#peers").html("");
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('peer_disconnect', function(pid) {
    $("#peer_"+pid).hide("slow");
});
chat.on('peer_connected', function(peers) {
    //expect only 1 peer connecting, but..
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('submit', function() {
    if(confirm("This ticket was updated. Do you want to refresh?")) {
        history.go(0);
    }
});

function addPeer(pid, peer) {
    var ipinfo = "";
    if(peer.ip != undefined) {
        ipinfo = "<span class=\"ip\">"+peer.ip+"</span>";
    }
    if(chat.io.engine.id == pid) {
        //don't display myself
        return;
    }
    var html = "<li class=\"new\" id=\"peer_"+pid+"\" class=\"peer\">"+peer.name+ipinfo+"</li>";
    $("#peers").prepend(html);
    $("#peers .new").animate({bottom: 0}, 1000, function() {$(this).removeClass("new")});
}

$(function() {
    $("#ticket_form").submit(function() {
        chat.emit('submit');
        return true;
    });
});
</script>
<script>
//used by searchbox
function parseValue(value) {
    var obj = new Object();
    var tokens = value.split("\t");
    obj.str = tokens[0];
    obj.count = tokens[1];
    return obj;
}

$(function() {
    //bootstrap-2.0.4 stuff
    $(".alert-message").alert();
    $(".dropdown-toggle").dropdown();
    $("span[rel='tooltip']").tooltip();
    $("a[rel=popover]").popover();

    //activate menu that user is currently on
    $("#menu_navigator").addClass("active"); 
    $("#submenu_").addClass("active"); 

    //translate zend validation error message to bootstrap
    $(".errors").addClass("alert").addClass("alert-error");

    //enable autocomplete for search box
    $("#search").autocomplete({
        source: function( request, response ) {
            $.ajax({
                url: "search/autocomplete",
                dataType: "text",
                data: {
                    //featureClass: "P",
                    //style: "full",
                    //maxRows: 12,
                    //name_startsWith: request.term
                    q: request.term
                },
                success: function( data ) {
                    response( $.map( data.split("\n"), function( item ) {
                        if(item == "") return null;
                        return {
                            value: item
                        }
                    }));
                }
            });
        },
        select: function(event, ui) {
            document.location = "search?q="+ui.item.value;
        }
    });
    
});
</script>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-69012-13");
pageTracker._trackPageview();
} catch(err) {}
</script>

</body>
