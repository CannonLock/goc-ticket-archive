<!DOCTYPE html>
<html lang="en">
  <head>
  <base href="">
    <title>[29196] Assistance need to migrate CE from GRAM to HTCondor-CE</title>    <meta charset="utf-8" />
    <meta name="verify-v1" content="na5IcAJsZVOfEkboRxuIiZ1zpZgnZiWra+nKcS7nA/o=" />
    <meta name="google-site-verification" content="DLrk3ft4s8b-S2TloLCL2LD_t6wcTjgSluf5pmiu2kA" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />
    <link href="https://ticket.opensciencegrid.org/rss" rel="alternate" type="application/rss+xml" title="GOC Ticket Update feed" />

    <style type="text/css">
      body {
        padding-top: 50px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
     #search {
            width: 300px;
     }

    </style>

<script src="https://code.jquery.com/jquery-3.0.0.js"></script>
<script src="https://code.jquery.com/jquery-migrate-3.0.1.js"></script>

   <link href="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet"/>
    <script src="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/js/bootstrap.min.js"></script>

    <link href="https://netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"/>
    <link href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/themes/smoothness/jquery-ui.min.css" rel="stylesheet"/>
 <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>


    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/js/select2.min.js"></script>

    <link href="css/ticket.css" rel="stylesheet" />
    <script src="lib/jquery.cookie.js"></script>

    <link href="images/tag_orange.png" rel="icon" type="image/png"/>
  </head>

  <body>
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>

            <a class="brand" style="padding: 6px 0px 0px 6px;" href="http://opensciencegrid.org"><img src="images/osglogo.40x30.png"/></a>
            <ul class="nav">
                <li class="dropdown"><a href="https://ticket.opensciencegrid.org/#" class="dropdown-toggle" data-toggle="dropdown">GOC Ticket <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    <li><a href="https://my.opensciencegrid.org">MyOSG</a></li>
                    <li><a href="https://oim.opensciencegrid.org">OIM</a></li>
                    <li class="active"><a href="https://ticket.opensciencegrid.org/index">Ticket</a></li>
	<li class="divider"></li>
	<li><a href="http://repo.grid.iu.edu">Repo</a></li>
	<li class="divider"></li>
	<li><a href="http://blogs.grid.iu.edu">Blog</a></li>
                    <li><a href="http://display.grid.iu.edu">Display</a></li>
                    <li><a href="http://osggoc.blogspot.com/">News</a></li>
                    </ul>
                </li>
            </ul>
            <ul class="nav pull-right">
                <li><a href="https://ticket.opensciencegrid.org/sso/">Login</a></li>            </ul>

            <div class="nav-collapse">
                <ul class="nav">
			 <li id="menu_submit"><a href="https://ticket.opensciencegrid.org/submit">Submit</a></li><li id="menu_view" class="dropdown"><a href="https://ticket.opensciencegrid.org/\#" class="dropdown-toggle" data-toggle="dropdown">View <b class="caret"></b></a><ul class="dropdown-menu"><li id="submenu_listopen"><a href="https://ticket.opensciencegrid.org/list/open">Open Tickets</a></li><li id="submenu_listrecentclose"><a href="https://ticket.opensciencegrid.org/list/recentclose">Recently Closed Tickets</a></li><li class="divider"></li><li id="submenu_alltickets"><a href="https://ticket.opensciencegrid.org/search?q=&amp;sort=id">All Tickets</a></li></ul></li>                </ul>

                <form class="navbar-search pull-right" action="https://ticket.opensciencegrid.org/viewer">
                    <input id="search" type="text" name="id" class="search-query span2" placeholder="Search Ticket" value=""/>
                </form>
            </div>
        </div>
      </div>
    </div>

<script type='text/javascript' src='lib/jquery.timeago.js'></script>
<script type='text/javascript' src='lib/byte2size.js'></script>
<style>
#updates .toolbar {
position: relative;
margin-top: 0px;
top: -10px;
font-weight: normal;
}
#updates a.anchor {
position: relative;
top: -50px;
}
#updates .selected pre {
animation:selected 2s;
animation-iteration-count: 2;
animation-direction: alternate;
-webkit-animation:selected 2s; 
-webkit-animation-iteration-count: 2;
-webkit-animation-direction: alternate;
box-shadow: inset 1px 1px 20px #9ad;
border: 1px solid #9ab;
margin: 5px 0px;
padding-left: 10px;
}
@keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ab;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
@-webkit-keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ad;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
#updates pre {
background-color: inherit;
line-height: 15px;
padding: 5px;
}
#updates .header {
color: #999;
}
#updates .update_history pre {
background-color: #eee;
color: #666;
font-size: 85%;
}
#updates .clickable {
cursor: pointer;
}
#updates .clickable:hover {
color: #D98719;
}
#updates .meta_information pre {
background-color: #fed;
}
#similar_tickets {
max-height: 300px;
overflow-y: auto;
pointer-events: none;
padding: 5px;
background-color: #f4f4f4;
}
.btn-toolbar {
margin-bottom: 0;
height: 30px;
}
#peers {
position: fixed;
bottom: 0px;
right: 0px;
z-index: 100;
list-style: none;
padding: 5px 0px 0px 5px;
margin: 0px;
background-color: white;
box-shadow: 0px 0px 10px white;
}
#peers li {
background-color: #ccc;
color: #000;
display: inline-block;
padding: 5px 10px;
margin-right: 5px;
position: relative;
}
/*
#peers li:hover {
background-color: #999;
cursor: pointer;
}
*/
#peers span.ip {
padding-left: 5px;
color: #666;
}
#peers .new {
bottom: -30px;
}
/*
#peers .me {
background-color: red;
}
*/
</style>

<div class="container-fluid">
<ul id="peers"></ul>
<div class="alert alert-danger"><a class="close" href="https://ticket.opensciencegrid.org/#" data-dismiss="alert">&times;</a>By the end of May 2018, the ticketing system at https://ticket.opensciencegrid.org will be retired and support will be provided at https://support.opensciencegrid.org. Throughout this transition the support email (help@opensciencegrid.org) will be available as a point of contact.<br><br>                                                   
                                                                                                                                                                                   
Please see the service migration page for details: https://opensciencegrid.github.io/technology/policy/service-migrations-spring-2018/#ticket</div><div id="presence" class="pull-right"></div><div class="ticketgui"><script type="text/javascript" src="lib/checktab.js"></script>

<script>
var expanded = false;
function expand_description() {
    var desc = $(".description");
    if(!expanded) {
        expanded = true;
        //expand to minheight
        var min = 250;
        if(desc.height() < min) {
            desc.animate({height: min}, 200);
        }
    }
}

$(document).ready(function() {
    $("input[name='nad']").datepicker({
        dateFormat: 'yy-mm-dd'
    });
});

</script>



<style>
.form-horizontal .control-label {
padding-top: inherit;
font-size:90%;
color:#666;
}
label {
margin-bottom: 0px;
}
.controls {
line-height: 18px;
}
</style>
<form class="form-horizontal" action="https://ticket.opensciencegrid.org/viewer/updatebasic?id=29196" method="post">
<div class="page-header">
    <h3><span class="muted">29196</span> / Assistance need to migrate CE from GRAM to HTCondor-CE</h3>
</div>

<div class="row-fluid">
<div class="span5">
    <legend>Contact</legend>
    <div class="control-group">
        <label class="control-label">Full Name</label>
        <div class="controls">Gabriel Araujo von Winckler</div>
    </div>
    <div class="control-group">
        <label class="control-label">Email</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">Phone</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">CC</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>

    <legend>Details</legend>
    <div class="control-group"><label class="control-label">Submitted Via</label><div class="controls">GOC Ticket/submit</div></div><div class="control-group"><label class="control-label">Submitter</label><div class="controls">Gabriel Araujo von Winckler</div></div><div class="control-group"><label class="control-label">Ticket Links</label><div class="controls"></div></div>
    <div class="control-group">
        <label class="control-label">Ticket Type</label>
        <div class="controls">Problem/Request</div>
    </div>
    <div class="control-group">
        <label class="control-label">Priority</label>
        <div class="controls">Normal</div>
    </div>
    <div class="control-group">
        <label class="control-label">Status</label>
        <div class="controls">
Closed</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action</label>
        <div class="controls">Waiting on response from Gabriel</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action Deadline</label>
        <div class="controls flag_red">2016-04-28</div>
    </div>

</div><!--span-->
<div class="span7">
    <legend>Assignees</legend>
    <div class="assignee" style="width: 60%">Software Support (Triage) <span class="muted"> / OSG Software Team</span></div><div class="assignee" style="width: 60%">Brian Lin <span class="muted"> / OSG Software Team</span></div>    <br>

    <legend>Assignees</legend>
    TODO
    <br>

    <style>
legend.noborder {
border-bottom: none;
}
</style>

<div id="attachment-list"/>
<script>
$(function () {
    var first = true;
    $.getJSON("attachment/list/29196", function (files) {
        //console.dir(files);
        var html = "<table class=\"table table-condensed\">";
        $(files).each(function() {
            if(first) {
                first = false;
                html += "<legend class=\"noborder\">Attachmenets</legend>";
            }
            html += "<tr class=\"attachment\">";
            html += "<td><img src=\""+this.thumbnail_url+"\"/></td>";
            html += "<td><a href=\""+this.url+"\" target=\"_blank\">"+this.name+"</a></td>";
            html += "<td>"+bytesToSize(this.size, 1)+"</td>";
            html += "</tr>";
        });
        html += "</table>";
        $("#attachment-list").html(html);
    });
});

function download(url) {
    window.open(url, "_blank");
}
</script>


</div><!--span-->
</div><!--row-fluid-->


</form>

</div>
<div id="updates" style="clear: both;">
    <legend>Past Updates
    <div class="btn-toolbar pull-right toolbar">
        <div class="btn-group">
                <a class="btn btn-small" href="https://ticket.opensciencegrid.org/29196?sort=up&amp;"><i class="icon-arrow-up"></i> Sort</a>

        
        <a class="btn btn-small" href="https://ticket.opensciencegrid.org/29196?expandall=true&amp;">Expand Descriptions</a>        <a class="btn btn-small" target="_blank" href="mailto:osg@tick.globalnoc.iu.edu?subject=Open%20Science%20Grid%3A%20Assistance%20need%20to%20migrate%20CE%20from%20GRAM%20to%20HTCondor-CE%20ISSUE%3D29196%20PROJ%3D71"><i class="icon-envelope"></i> Update w/Email</a>
        </div>
    </div><!--btn-toolbar-->
    </legend>

    <div class='update_description'><i onclick="document.location='29196#1461601984'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-04-25T16:33:04+00:00">Apr 25, 2016 04:33 PM UTC</time><a class="anchor" name="1461601984">&nbsp;</a></div><pre>Thanks for the checkup.
Please go ahead and close this ticket.

Best regards,
Gabriel

by /C=BR/O=ANSP/OU=ANSPGrid CA/OU=People/CN=Gabriel A. von Winckler</pre></div><div class='update_description'><i onclick="document.location='29196#1461601509'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-04-25T16:25:09+00:00">Apr 25, 2016 04:25 PM UTC</time> by <b>Brian Lin</b><a class="anchor" name="1461601509">&nbsp;</a></div><pre>I just submitted a job and it looks like it ran successfully and landed on node233 so I think you&#39;re good to go! I&#39;ll close this ticket unless you have any other concerns.</pre></div><div class='update_description'><i onclick="document.location='29196#1461591477'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-04-25T13:37:57+00:00">Apr 25, 2016 01:37 PM UTC</time><a class="anchor" name="1461591477">&nbsp;</a></div><pre>Brain,

No changes in the last 10 days.
Do you think we are good to go?
I plan to decommission the globus gatekeeper but I didn&#39;t set a time frame yet.

Thanks,
Gabriel

by /C=BR/O=ANSP/OU=ANSPGrid CA/OU=People/CN=Gabriel A. von Winckler</pre></div><div class='update_description'><i onclick="document.location='29196#1461350907'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-04-22T18:48:27+00:00">Apr 22, 2016 06:48 PM UTC</time> by <b>Brian Lin</b><a class="anchor" name="1461350907">&nbsp;</a></div><pre>Gabriel,

My local universe jobs (jobs that run directly on the CE) are completing and returning output now. Did you make any changes on the CE?

Thanks,
Brian</pre></div><div class='update_description'><i onclick="document.location='29196#1460759115'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-04-15T22:25:15+00:00">Apr 15, 2016 10:25 PM UTC</time><a class="anchor" name="1460759115">&nbsp;</a></div><pre>Hi,

I can&#39;t attach because de file type isn&#39;t allowed.
The file is here <a href='https&#58;//www.ncc.unesp.br/' target='_blank' rel='nofollow'>https&#58;//www.ncc.unesp.br/</a>~winckler/condor-ce.tar.bz2

Thanks,
Gabriel

by /C=BR/O=ANSP/OU=ANSPGrid CA/OU=People/CN=Gabriel A. von Winckler</pre></div><div class='update_description'><i onclick="document.location='29196#1460748154'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-04-15T19:22:34+00:00">Apr 15, 2016 07:22 PM UTC</time> by <b>Brian Lin</b><a class="anchor" name="1460748154">&nbsp;</a></div><pre>I&#39;m still not having running any local universe jobs, could you tar your entire /var/log/condor-ce dir and attach it?

Thanks,
Brian</pre></div><div class='update_description'><i onclick="document.location='29196#1460743945'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-04-15T18:12:25+00:00">Apr 15, 2016 06:12 PM UTC</time><a class="anchor" name="1460743945">&nbsp;</a></div><pre>Brian,

I think that syncing the clocks solved the problem.
All WN were in sync, but the CE was off by 80 seconds.

I ran condor_ce_run successfully a few times, but I&#39;m hitting the same WN (node004).

Could you rerun your tests?

Thanks,
Gabriel

by /C=BR/O=ANSP/OU=ANSPGrid CA/OU=People/CN=Gabriel A. von Winckler</pre></div><div class='update_description'><i onclick="document.location='29196#1460741739'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-04-15T17:35:39+00:00">Apr 15, 2016 05:35 PM UTC</time><a class="anchor" name="1460741739">&nbsp;</a></div><pre>Brian,

Pretty strange indeed.

I executed condor_ce_run sometimes and in at least 2 turn it copied and displayed the stdout. But in most times, do not.

I&#39;m attaching a new SchedLog. Note the job 27 and 29, the _condor_stdout is sent, but in the in 31 is not. There is a message&#58;
04/15/16 14&#58;17&#58;44 Skipping file _condor_stdout, t&#58; 1460740515&#60;=1460740580, s&#58; N/A

Is this related to the different clock in the worker nodes? The diference would be 65 seconds.
This could explain why sometimes it works and others, don&#39;t.

I&#39;ll try to sync all clocks. But do you know the accepted tolerance?

Regards,
Gabriel

by /C=BR/O=ANSP/OU=ANSPGrid CA/OU=People/CN=Gabriel A. von Winckler</pre></div><div class='update_description'><i onclick="document.location='29196#1460663792'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-04-14T19:56:32+00:00">Apr 14, 2016 07:56 PM UTC</time> by <b>Brian Lin</b><a class="anchor" name="1460663792">&nbsp;</a></div><pre>Gabriel,

There&#39;s some pretty strange stuff going on with your CE, my local universe jobs appear to be completing on your CE but I don&#39;t get any output back. Could you attach the output of &#96;condor_ce_config_val -dump&#96; as well as /var/log/condor-ce/SchedLog?

Thanks,
Brian</pre></div><div class='update_description'><i onclick="document.location='29196#1460662152'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-04-14T19:29:12+00:00">Apr 14, 2016 07:29 PM UTC</time> by <b>Brian Lin</b><a class="anchor" name="1460662152">&nbsp;</a></div><pre>Gabriel,

condor_ce_run should print the stdout of the command that you specify.
You can run &#39;condor_ce-trace -d &#96;hostname&#96;&#39; for more verbose output.
Since I have submit auth at your CE I&#39;ll try to poke around a bit to see
if I can find any obvious issues.

- Brian</pre></div><div class='update_description'><i onclick="document.location='29196#1460661679'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-04-14T19:21:19+00:00">Apr 14, 2016 07:21 PM UTC</time><a class="anchor" name="1460661679">&nbsp;</a></div><pre>Marian,

After the pbs_status patch, I could execute all the troubleshooting without errors.
The condor_ce_run doesn&#39;t display the output (as globus-job-run did) but I guess this is normal. The exit code is 0. (But I don&#39;t know were the output goes.)

I don&#39;t have a pilot factory so I don&#39;t know if it&#39;s working or not. I&#39;ll try a condor-g jog tomorrow.

You job is Idle in our queue&#58;
JOBID PARTITION     NAME     USER ST       TIME  NODES NODELIST(REASON)
1534415       osg bl_2e4ca  cmsprod PD       0&#58;00      1 (Resources)

So I guess everything is ok for now.

Thanks,
Gabriel

by /C=BR/O=ANSP/OU=ANSPGrid CA/OU=People/CN=Gabriel A. von Winckler</pre></div><div class='update_description'><i onclick="document.location='29196#1460660507'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-04-14T19:01:47+00:00">Apr 14, 2016 07:01 PM UTC</time><a class="anchor" name="1460660507">&nbsp;</a></div><pre>Worth of looking into JobRouterLog if you can. It seems my submitted job gets from idle to held in cycles...

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=zvada/CN=684832/CN=Marian Zvada</pre></div><div class='update_description'><i onclick="document.location='29196#1460660183'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-04-14T18:56:23+00:00">Apr 14, 2016 06:56 PM UTC</time><a class="anchor" name="1460660183">&nbsp;</a></div><pre>I had this issue&#58;

$ condor_ce_ping -verbose -name ce.grid.unesp.br -pool ce.grid.unesp.br&#58;9619 WRITE
WRITE failed!
SECMAN&#58;2010&#58;Received &#34;DENIED&#34; from server for user gsi@unmapped using method GSI.
AUTHENTICATE&#58;1004&#58;Failed to authenticate using FS

I noticed later that my proxy expired thus I wasn&#39;t mapped properly. That&#39;s the result of WRITE failed. Now it&#39;s good....

I just sent to your CE &#34;condor_ce_trace ce.grid.unesp.br -d&#34;, it looks like job got into queue and is idle. Also, I can see that one job of yours is marked as Completed&#58;
$ condor_ce_q -name ce.grid.unesp.br -pool ce.grid.unesp.br&#58;9619
-- Schedd&#58; ce.grid.unesp.br &#58; &#60;200.145.46.35&#58;9619?...
ID      OWNER            SUBMITTED     RUN_TIME ST PRI SIZE CMD
13.0   winckler        4/14 13&#58;13   0+00&#58;00&#58;00 C  0   0.0  env
15.0   cmsprod         4/14 13&#58;51   0+00&#58;00&#58;00 I  0   0.1  env
16.0   cmsprod         4/14 13&#58;52   0+00&#58;00&#58;00 I  0   0.1  env

Could you summarize a bit Gabriel if you are facing any issues still?

Thanks,
Marian

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=zvada/CN=684832/CN=Marian Zvada</pre></div><div class='update_description'><i onclick="document.location='29196#1460659632'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-04-14T18:47:12+00:00">Apr 14, 2016 06:47 PM UTC</time> by <b>Brian Lin</b><a class="anchor" name="1460659632">&nbsp;</a></div><pre>FWIW, my condor_ping works fine against your CE.

- Brian</pre></div><div class='update_description'><i onclick="document.location='29196#1460659309'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-04-14T18:41:49+00:00">Apr 14, 2016 06:41 PM UTC</time><a class="anchor" name="1460659309">&nbsp;</a></div><pre>Marian,

I&#39;ll do the pull request.

Regarding the authentication, I seems to work for me.

[winckler@access ~]$ condor_ce_ping -verbose -name ce.grid.unesp.br -pool ce.grid.unesp.br&#58;9619 WRITE
Remote Version&#58;              $CondorVersion&#58; 8.4.5 Mar 22 2016 $
Local  Version&#58;              $CondorVersion&#58; 8.4.4 Feb 04 2016 $
Session ID&#58;                  ce&#58;9936&#58;1460659126&#58;2
Instruction&#58;                 WRITE
Command&#58;                     60021
Encryption&#58;                  none
Integrity&#58;                   MD5
Authenticated using&#58;         GSI
All authentication methods&#58;  FS,GSI
Remote Mapping&#58;              winckler@....
Authorized&#58;                  TRUE

Information about authentication methods that were attempted but failed&#58;
AUTHENTICATE&#58;1004&#58;Failed to authenticate using FS

The RSV also seems ok&#58;

[root@ce condor-ce]# rsv-control --run org.osg.htcondor-ce.job-routes --host ce.grid.unesp.br

Running metric org.osg.htcondor-ce.job-routes&#58;

metricName&#58; org.osg.htcondor-ce.job-routes
metricType&#58; status
timestamp&#58; 2016-04-14 15&#58;42&#58;07 BRT
metricStatus&#58; OK
serviceType&#58; OSG-HTCondor-CE
serviceURI&#58; ce.grid.unesp.br
gatheredAt&#58; ce.grid.unesp.br
<div id='show_1572452053' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_1572452053'>summaryData&#58; OK
detailsData&#58; Available job router entries&#58;
[ GridResource = &#34;batch pbs&#34;; TargetUniverse = 9; name = &#34;Local_PBS&#34;; ]

EOT

[root@ce condor-ce]# rsv-control --run org.osg.htcondor-ce.authentication --host ce.grid.unesp.br

Running metric org.osg.htcondor-ce.authentication&#58;

metricName&#58; org.osg.htcondor-ce.authentication
metricType&#58; status
timestamp&#58; 2016-04-14 15&#58;42&#58;15 BRT
metricStatus&#58; OK
serviceType&#58; OSG-HTCondor-CE
serviceURI&#58; ce.grid.unesp.br
gatheredAt&#58; ce.grid.unesp.br
summaryData&#58; OK
detailsData&#58; Output from condor_ce_ping -pool ce.grid.unesp.br&#58;9619 -name ce.grid.unesp.br -table READ WRITE&#58;
Instruction Authentication Encryption Integrity Decision Identity
READ           none       none      none    ALLOW unauthenticated@unmapped
WRITE             FS       none       MD5    ALLOW rsv@....

EOT

Can you detail your issue?
Thanks,
Gabriel

by /C=BR/O=ANSP/OU=ANSPGrid CA/OU=People/CN=Gabriel A. von Winckler
</div><script type='text/javascript'>
        $('#show_1572452053').click(function() {
            $('#detail_1572452053').slideDown("normal");
            $('#show_1572452053').hide();
            $('#hide_1572452053').show();
        });
        $('#hide_1572452053').click(function() {
            $('#detail_1572452053').slideUp();
            $('#hide_1572452053').hide();
            $('#show_1572452053').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='29196#1460656469'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-04-14T17:54:29+00:00">Apr 14, 2016 05:54 PM UTC</time><a class="anchor" name="1460656469">&nbsp;</a></div><pre>Gabriel&#58;

please go ahead and do pull request with that patch. The source for the script is in here&#58;
<a href='https&#58;//github.com/osg-bosco/BLAH/blob/v1_18_bosco/src/scripts/pbs_status.py' target='_blank' rel='nofollow'>https&#58;//github.com/osg-bosco/BLAH/blob/v1_18_bosco/src/scripts/pbs_status.py</a>

Thanks,
Marian

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=zvada/CN=684832/CN=Marian Zvada</pre></div><div class='update_description'><i onclick="document.location='29196#1460654572'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-04-14T17:22:52+00:00">Apr 14, 2016 05:22 PM UTC</time><a class="anchor" name="1460654572">&nbsp;</a></div><pre>Hi Gabriel,

I also added Derek to this thread, he seem to be familiar with this error... Looking at your patch change looks to me reasonable. Derek, could you point Gabriel which repo would be right to request pull request?

Other than that, are you saying this fixed your submit issue or not? I tried remotely condor_ce_ping WRITE against your schedd and it looks there is still something unresolved/blocked. Does that work if you run it locally? Probably new set of log files would help if you can share.

Thanks,
Marian

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=zvada/CN=684832/CN=Marian Zvada</pre></div><div class='update_description'><i onclick="document.location='29196#1460651529'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-04-14T16:32:09+00:00">Apr 14, 2016 04:32 PM UTC</time><a class="anchor" name="1460651529">&nbsp;</a></div><pre>Marian,

The problem is the --noconvert flag that is used in sacct.
There are some issues about this problem in *gratia* subsystem&#58;
<a href='https&#58;//jira.opensciencegrid.org/browse/SOFTWARE-1588' target='_blank' rel='nofollow'>https&#58;//jira.opensciencegrid.org/browse/SOFTWARE-1588</a>
<a href='https&#58;//ticket.grid.iu.edu/27490' target='_blank' rel='nofollow'>https&#58;//ticket.grid.iu.edu/27490</a>

I&#39;m attaching a patch with the minimal set of changes that makes my site work without change the execution for the latest versions of Slurm.
It also fix a close() issue.

Let me know if you have any doubts.
Would it be possible to apply this patch to the software repo?

Thanks,
Gabriel

by /C=BR/O=ANSP/OU=ANSPGrid CA/OU=People/CN=Gabriel A. von Winckler</pre></div><div class='update_description'><i onclick="document.location='29196#1460504608'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-04-12T23:43:28+00:00">Apr 12, 2016 11:43 PM UTC</time><a class="anchor" name="1460504608">&nbsp;</a></div><pre>Marian,

Thanks for the reply.
No extra info on messages, but I could call pbs_status.py with debug&#58;

04/12/16 20&#58;34&#58;58 1802438 Checking cache for jobid pbs
04/12/16 20&#58;34&#58;58 1802438 Starting query to fill cache.
04/12/16 20&#58;34&#58;58 1802438 Starting qstat.
04/12/16 20&#58;34&#58;59 1802438 Finished qstat (time=0.568631).
04/12/16 20&#58;34&#58;59 1802438 Finished query to fill cache.
close failed in file object destructor&#58;
IOError&#58; [Errno 9] Bad file descriptor
04/12/16 20&#58;34&#58;59 1802438 Jobid pbs not in cache; querying PBS
04/12/16 20&#58;34&#58;59 1802438 Starting qstat.
04/12/16 20&#58;35&#58;00 1802438 Finished qstat (time=0.420702).
04/12/16 20&#58;35&#58;00 1802438 Querying sacct for completed job for jobid&#58; pbs
sacct&#58; unrecognized option &#39;--noconvert&#39;
04/12/16 20&#58;35&#58;00 1802438 Finished querying PBS for jobid pbs
04/12/16 20&#58;35&#58;00 1802438 0[RemoteUserCpu=0; ImageSize=0; BatchJobId=&#34;pbs&#34;; JobStatus=4; ExitCode=0; ]

Since is late now, I will try to understand the missing --noconvert flag tomorrow.
In any case, our slurm version is 14.11.5.

Get back to you tomorrow.
Regards,
Gabriel

by /C=BR/O=ANSP/OU=ANSPGrid CA/OU=People/CN=Gabriel A. von Winckler</pre></div><div class='update_description'><i onclick="document.location='29196#1460495009'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-04-12T21:03:29+00:00">Apr 12, 2016 09:03 PM UTC</time><a class="anchor" name="1460495009">&nbsp;</a></div><pre>Hi Gabriel,

this sounds like something funky going on with your python executing pbs_status.py. What does it say if you launch it from command line?
Also, anything suspicious in /var/log/messages maybe (since you said something about file descriptors)?

Otherwise your CE seems to respond just fine when I did basic checks remotely [*]... We need to figure out what&#39;s an issue with blahp, though.

Thanks,
Marian

[*]
$ condor_ce_status -pool ce.grid.unesp.br&#58;9619 -any
MyType             TargetType         Name

Collector          None               My Pool - ce.grid.unesp.br@....p.
Scheduler          None               ce.grid.unesp.br
DaemonMaster       None               ce.grid.unesp.br
Job_Router         None               htcondor-ce@....
Submitter          None               winckler@....

$ condor_ce_q -name ce.grid.unesp.br -pool ce.grid.unesp.br&#58;9619
-- Schedd&#58; ce.grid.unesp.br &#58; &#60;200.145.46.35&#58;9619?...
ID      OWNER            SUBMITTED     RUN_TIME ST PRI SIZE CMD
0 jobs; 0 completed, 0 removed, 0 idle, 0 running, 0 held, 0 suspended

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=zvada/CN=684832/CN=Marian Zvada</pre></div><div class='update_description'><i onclick="document.location='29196#1460491994'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-04-12T20:13:14+00:00">Apr 12, 2016 08:13 PM UTC</time><a class="anchor" name="1460491994">&nbsp;</a></div><pre>Thanks.

I do have the PBS-SLURM scripts because they are also needed for the globus-gatekeeper.
I will wait for the Marian insights.

Thanks,
Gabriel

by /C=BR/O=ANSP/OU=ANSPGrid CA/OU=People/CN=Gabriel A. von Winckler</pre></div><div class='update_description'><i onclick="document.location='29196#1460491328'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-04-12T20:02:08+00:00">Apr 12, 2016 08:02 PM UTC</time> by <b>Brian Lin</b><a class="anchor" name="1460491328">&nbsp;</a></div><pre>Gabriel,

Marian knows more about the HTCondor-CE/SLURM interaction so I&#39;ve added
him to the ticket. One caveat is that that you need the PBS-SLURM
translation layer in place at this time.

Cheers,
Brian</pre></div><div class='update_description'><i onclick="document.location='29196#1460490065'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-04-12T19:41:05+00:00">Apr 12, 2016 07:41 PM UTC</time><a class="anchor" name="1460490065">&nbsp;</a></div><pre>Brian,

Now the authentication is working, the RSV metrics are green, the jobs match the queue (see the log below) but doesn&#39;t start.
I&#39;ve the feeling that the condor-ce is not issuing the sbatch (or squeue) command. Which daemon should to that?

In all logs, the only thing suspicious is&#58;
abrt&#58; detected unhandled Python exception in &#39;/usr/libexec/blahp/pbs_status.py&#39;
The trace only says&#58; IOError&#58; [Errno 9] Bad file descriptor

Any ideias?
Thanks

[root@ce ~]# condor_ce_q -l | condor_ce_job_router_info -match-jobs -ignore-prior-routing -jobads -

Matching jobs against routes to find candidate jobs.

Checking for candidate jobs. routing table is&#58;
Route Name             Submitted/Max        Idle/Max     Throttle
Local_PBS                      0/  10000       0/   2000     none

Umbrella constraint&#58; ((target.x509userproxysubject =!= UNDEFINED) && (target.x509UserProxyExpiration =!= UNDEFINED) && (time() &#60; target.x509UserProxyExpiration) && (target.JobUniverse =?= 5 || target.JobUniverse =?= 1)) && ( (true) ) && (target.ProcId &#62;= 0 && target.JobStatus == 1 && (target.StageInStart is undefined || target.StageInFinish isnt undefined) && target.Managed isnt &#34;ScheddDone&#34; && target.Managed isnt &#34;External&#34; && target.Owner isnt Undefined && target.RoutedBy isnt &#34;htcondor-ce&#34;)
Checking Job src=5,0 against all routes
Route Matches&#58; Local_PBS
Found candidate job src=5,0,route=Local_PBS
1 candidate jobs found

by /C=BR/O=ANSP/OU=ANSPGrid CA/OU=People/CN=Gabriel A. von Winckler</pre></div><div class='update_description'><i onclick="document.location='29196#1460484631'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-04-12T18:10:31+00:00">Apr 12, 2016 06:10 PM UTC</time> by <b>Brian Lin</b><a class="anchor" name="1460484631">&nbsp;</a></div><pre>Glad that worked. Let me know if you get stuck troubleshooting your CE-SLURM interaction.</pre></div><div class='update_description'><i onclick="document.location='29196#1460483313'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-04-12T17:48:33+00:00">Apr 12, 2016 05:48 PM UTC</time><a class="anchor" name="1460483313">&nbsp;</a></div><pre>Thank you!!!

With this change the daemons are talking with each other and I can submit from the client.
I still can&#39;t run the job on the SLURM, but I can debug this now.
I think it&#39;s related to an error creating the out, err and log in the /home.

Best regards,
Gabriel

by /C=BR/O=ANSP/OU=ANSPGrid CA/OU=People/CN=Gabriel A. von Winckler</pre></div><div class='update_description'><i onclick="document.location='29196#1460481357'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-04-12T17:15:57+00:00">Apr 12, 2016 05:15 PM UTC</time> by <b>Brian Lin</b><a class="anchor" name="1460481357">&nbsp;</a></div><pre>Try adding the following line to the top of &#39;/etc/condor-ce/condor_mapfile&#39;&#58;

GSI &#34;^&#92;/C&#92;=BR&#92;/O&#92;=ANSP&#92;/OU&#92;=ANSPGrid&#92; CA&#92;/OU&#92;=Services&#92;/CN&#92;=(host&#92;/)?([A-Za-z0-9.&#92;-]*)$&#34; &#92;2@....

Then restart the condor-ce service.</pre></div><div class='update_description'><i onclick="document.location='29196#1460479198'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-04-12T16:39:58+00:00">Apr 12, 2016 04:39 PM UTC</time><a class="anchor" name="1460479198">&nbsp;</a></div><pre>Brian,

Our LRM is slurm.
I&#39;m attaching a snap of the logs since they are too large. This begins with the last restart and the last lines repeat periodically.

Thanks,
Gabriel

by /C=BR/O=ANSP/OU=ANSPGrid CA/OU=People/CN=Gabriel A. von Winckler</pre></div><div class='update_description'><i onclick="document.location='29196#1460473453'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-04-12T15:04:13+00:00">Apr 12, 2016 03:04 PM UTC</time> by <b>Brian Lin</b><a class="anchor" name="1460473453">&nbsp;</a></div><pre>Gabriel,

Have you bumped the log levels of your CE? I&#39;d be interested in the contents of /var/log/condor-ce (particularly the MasterLog and the SchedLog) because it looks like the Schedd isn&#39;t starting. What&#39;s your underlying batch system?

Thanks,
Brian</pre></div><div class='update_description'><i onclick="document.location='29196#1460472014'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-04-12T14:40:14+00:00">Apr 12, 2016 02:40 PM UTC</time> by <b>Tim Theisen</b><a class="anchor" name="1460472014">&nbsp;</a></div><pre>Assigning to Brian</pre></div><div class='update_description'><i onclick="document.location='29196#1460057299'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-04-07T19:28:19+00:00">Apr 7, 2016 07:28 PM UTC</time><a class="anchor" name="1460057299">&nbsp;</a></div><pre>Vince,

I had already followed the troubleshooting before issuing the ticket.
I double checked, but I couldn&#39;t find the error messages as described.

The only one suspicious is&#58;
04/07/16 16&#58;21&#58;23 ZKM&#58; successful mapping to GSS_ASSIST_GRIDMAP
04/07/16 16&#58;21&#58;23 SECMAN&#58; FAILED&#58; Received &#34;DENIED&#34; from server for user gsi@unmapped using method GSI.
04/07/16 16&#58;21&#58;23 ERROR&#58; SECMAN&#58;2010&#58;Received &#34;DENIED&#34; from server for user gsi@unmapped using method GSI.
04/07/16 16&#58;21&#58;23 Failed to start non-blocking update to &#60;200.145.46.35&#58;9619&#62;.

I reviewed my authentication settings, and they seems ok (we are using GUMS). The globus-gatekeeper is working...

Thanks.

by /C=BR/O=ANSP/OU=ANSPGrid CA/OU=People/CN=Gabriel A. von Winckler</pre></div><div class='update_description'><i onclick="document.location='29196#1460049462'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-04-07T17:17:42+00:00">Apr 7, 2016 05:17 PM UTC</time> by <b>Vince Neal</b><a class="anchor" name="1460049462">&nbsp;</a></div><pre>To further troubleshoot
[root@ce ~]# condor_ce_ping -verbose -name ce.grid.unesp.br -pool ce.grid.unesp.br&#58;9619 WRITE
ERROR&#58; couldn&#39;t locate ce.grid.unesp.br!

Could you please increase debugging levels on the CE?
<a href='https&#58;//twiki.grid.iu.edu/bin/view/Documentation/Release3/TroubleshootingHTCondorCE#condor_ce_ping' target='_blank' rel='nofollow'>https&#58;//twiki.grid.iu.edu/bin/view/Documentation/Release3/TroubleshootingHTCondorCE#condor_ce_ping</a>

If you see “ERROR&#58; couldn’t locate (null)!”, that means the HTCondor-CE schedd (the daemon that schedules jobs) cannot be reached. To track down the issue, increase debugging levels on the CE&#58;
MASTER_DEBUG = D_FULLDEBUG
SCHEDD_DEBUG = D_FULLDEBUG
Then look in the Master log and Schedd log for any errors.

If you see “gsi@unmapped” in the “Remote Mapping” line, this means that either your credentials are not mapped on the CE or that authentication is not set up at all. To set up authentication, refer to our installation document.

Thank you,</pre></div><div class='update_description'><i onclick="document.location='29196#1460036162'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-04-07T13:36:02+00:00">Apr 7, 2016 01:36 PM UTC</time><a class="anchor" name="1460036162">&nbsp;</a></div><pre>Hi,

[root@ce ~]# condor_status -schedd
Error&#58; communication error
CEDAR&#58;6001&#58;Failed to connect to &#60;200.145.46.35&#58;9618&#62;

[root@ce ~]# condor_ce_status -schedd
[root@ce ~]# echo $?
0

[root@ce ~]# condor_ce_config_val -v JOB_ROUTER_SCHEDD2_POOL JOB_ROUTER_SCHEDD2_NAME
Not defined&#58; JOB_ROUTER_SCHEDD2_POOL
[root@ce ~]# condor_ce_config_val -v JOB_ROUTER_SCHEDD2_NAME
Not defined&#58; JOB_ROUTER_SCHEDD2_NAME

Thanks

by /C=BR/O=ANSP/OU=ANSPGrid CA/OU=People/CN=Gabriel A. von Winckler</pre></div><div class='update_description'><i onclick="document.location='29196#1459974812'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-04-06T20:33:32+00:00">Apr 6, 2016 08:33 PM UTC</time> by <b>Vince Neal</b><a class="anchor" name="1459974812">&nbsp;</a></div><pre>Good afternoon,

Could you post the output of the following commands?

condor_status -schedd

condor_ce_config_val -v JOB_ROUTER_SCHEDD2_POOL JOB_ROUTER_SCHEDD2_NAME

Thank you,</pre></div><div class='update_description'><i onclick="document.location='29196#1459810398'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-04-04T22:53:18+00:00">Apr 4, 2016 10:53 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1459810398">&nbsp;</a></div><pre>I&#39;m trying to migrate our CE gatekeeper from GRAM to HTCondor-CE. Initially my plain is to keep both gatekeepers enabled. The LRM is SLURM.

I&#39;ve followed the HTCondor-CE instructions, but the condor daemons  aren&#39;t communicating with each other.

The most useful errors are&#58;

[root@ce ~]# condor_ce_status -any
MyType             TargetType         Name

Collector          None               My Pool - ce.grid.unesp.br@....p.

[root@ce ~]# condor_ce_ping -verbose -name ce.grid.unesp.br -pool ce.grid.unesp.br&#58;9619 WRITE
ERROR&#58; couldn&#39;t locate ce.grid.unesp.br!

[root@ce ~]# condor_ce_trace ce.grid.unesp.br
Testing HTCondor-CE collector connectivity.
- Successful ping of collector on &#60;200.145.46.35&#58;9619&#62;.

********************************************************************************
2016-04-04 19&#58;42&#58;59 Could not find CE&#39;s schedd. Please contact the site&#39;s system
administrator to ensure that CE you&#39;re trying to contact is functional.
********************************************************************************

In the /var/log/condor-ce/MasterLog, I see&#58;
04/04/16 19&#58;34&#58;39 ZKM&#58; successful mapping to GSS_ASSIST_GRIDMAP
04/04/16 19&#58;34&#58;39 SECMAN&#58; FAILED&#58; Received &#34;DENIED&#34; from server for user gsi@unmapped using method GSI.
04/04/16 19&#58;34&#58;39 ERROR&#58; SECMAN&#58;2010&#58;Received &#34;DENIED&#34; from server for user gsi@unmapped using method GSI.
04/04/16 19&#58;34&#58;39 Failed to start non-blocking update to &#60;200.145.46.35&#58;9619&#62;.

Any advise will be appreciated

by /C=BR/O=ANSP/OU=ANSPGrid CA/OU=People/CN=Gabriel A. von Winckler</pre></div><legend>Similar Recent Tickets <small>modified within the last 30 days</small></legend><div id="similar_tickets"><p class="muted">No similar tickets found.</p></div>
</div>
<script type="text/javascript">
function reset_anchor() {
    $("#updates .selected").removeClass("selected");
    var urls = document.location.toString().split('#'); 
    var anchor = urls[1];
    if(anchor) {
        $("a[name='"+anchor+"']").parents(".update_description").addClass("selected");
    }
}
function submitspam(ticket_id) {
    myret = confirm("Would you like to close this ticket as a security ticket, and submit the ticket content to akismet?");
    if(myret == true) {
        $.ajax("viewer/processspam?id="+ticket_id).done(function() {
            window.location.reload();
        });
    }
}

$(function() {
    reset_anchor();
    var ADDITIONAL_COOKIE_NAME = 'gocticket';
    var options = { path: '/', expires: 365};

    if(window.opener && window.opener.name == "gocticket_list") {
        v = $.cookie("closewindow");
        if(!v) {
            $("#closewindow").attr("checked", "checked"); //on by default
        } else {
            if(v == "checked") {
                $("#closewindow").attr("checked", "checked");
            }
        }
        $("#closewindow").click(function() {
            $.cookie("closewindow", $(this).attr('checked'), options);
        });
    } else {
        $("#closewindow_area").hide();
    }
    function updateTimeago() {
        $("time").timeago();
        setTimeout(updateTimeago, 30*1000);
    }
    updateTimeago();
    $(".description").focus(expand_description);
});
</script>
<hr/>
<footer>
<p>GOC Ticket Version 2.2 | <a href="https://ticket.opensciencegrid.org/goc/submit?app_issue_check=on&amp;app_issue_type=goc&amp;app_goc_url=https%3A%2F%2Fticket.opensciencegrid.org%3A443%2F29196">Report Bugs</a>
 | <a href="https://github.com/opensciencegrid/operations/blob/master/docs/privacy.md">Privacy Policy</a>
</p>

<p> <img align="top" src="images/tag_orange.png"/> Copyright 2018 The Trustees of Indiana University - Developed for Open Science Grid</p>
</footer>


</div><!--container-fluid-->
<script>
var chat = io.connect('https://ticket1.grid.iu.edu:8443');
chat.on('connect', function() {
    chat.emit('authenticate', {nodekey:'', ticketid: 29196});
});
chat.on('peers', function(peers) {
    $("#peers").html("");
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('peer_disconnect', function(pid) {
    $("#peer_"+pid).hide("slow");
});
chat.on('peer_connected', function(peers) {
    //expect only 1 peer connecting, but..
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('submit', function() {
    if(confirm("This ticket was updated. Do you want to refresh?")) {
        history.go(0);
    }
});

function addPeer(pid, peer) {
    var ipinfo = "";
    if(peer.ip != undefined) {
        ipinfo = "<span class=\"ip\">"+peer.ip+"</span>";
    }
    if(chat.io.engine.id == pid) {
        //don't display myself
        return;
    }
    var html = "<li class=\"new\" id=\"peer_"+pid+"\" class=\"peer\">"+peer.name+ipinfo+"</li>";
    $("#peers").prepend(html);
    $("#peers .new").animate({bottom: 0}, 1000, function() {$(this).removeClass("new")});
}

$(function() {
    $("#ticket_form").submit(function() {
        chat.emit('submit');
        return true;
    });
});
</script>
<script>
//used by searchbox
function parseValue(value) {
    var obj = new Object();
    var tokens = value.split("\t");
    obj.str = tokens[0];
    obj.count = tokens[1];
    return obj;
}

$(function() {
    //bootstrap-2.0.4 stuff
    $(".alert-message").alert();
    $(".dropdown-toggle").dropdown();
    $("span[rel='tooltip']").tooltip();
    $("a[rel=popover]").popover();

    //activate menu that user is currently on
    $("#menu_navigator").addClass("active"); 
    $("#submenu_").addClass("active"); 

    //translate zend validation error message to bootstrap
    $(".errors").addClass("alert").addClass("alert-error");

    //enable autocomplete for search box
    $("#search").autocomplete({
        source: function( request, response ) {
            $.ajax({
                url: "search/autocomplete",
                dataType: "text",
                data: {
                    //featureClass: "P",
                    //style: "full",
                    //maxRows: 12,
                    //name_startsWith: request.term
                    q: request.term
                },
                success: function( data ) {
                    response( $.map( data.split("\n"), function( item ) {
                        if(item == "") return null;
                        return {
                            value: item
                        }
                    }));
                }
            });
        },
        select: function(event, ui) {
            document.location = "search?q="+ui.item.value;
        }
    });
    
});
</script>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-69012-13");
pageTracker._trackPageview();
} catch(err) {}
</script>

</body>
