<!DOCTYPE html>
<html lang="en">
  <head>
  <base href="">
    <title>[31053] UCSD Many job killed &#58; Exitcode 137</title>    <meta charset="utf-8" />
    <meta name="verify-v1" content="na5IcAJsZVOfEkboRxuIiZ1zpZgnZiWra+nKcS7nA/o=" />
    <meta name="google-site-verification" content="DLrk3ft4s8b-S2TloLCL2LD_t6wcTjgSluf5pmiu2kA" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />

    <style type="text/css">
      body {
        padding-top: 50px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
     #search {
            width: 300px;
     }

    </style>

<script src="https://code.jquery.com/jquery-3.0.0.js"></script>
<script src="https://code.jquery.com/jquery-migrate-3.0.1.js"></script>

   <link href="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet"/>
    <script src="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/js/bootstrap.min.js"></script>

    <link href="https://netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"/>
    <link href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/themes/smoothness/jquery-ui.min.css" rel="stylesheet"/>
 <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>


    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/js/select2.min.js"></script>

    <link href="css/ticket.css" rel="stylesheet" />
    <script src="lib/jquery.cookie.js"></script>

    <link href="images/tag_orange.png" rel="icon" type="image/png"/>
  </head>

  <body>
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>

            <a class="brand" style="padding: 6px 0px 0px 6px;" href="http://opensciencegrid.org"><img src="images/osglogo.40x30.png"/></a>
            <ul class="nav">
                <li class="dropdown"><a href="https://ticket.opensciencegrid.org/#" class="dropdown-toggle" data-toggle="dropdown">GOC Ticket <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    <li><a href="https://my.opensciencegrid.org">MyOSG</a></li>
                    <li><a href="https://oim.opensciencegrid.org">OIM</a></li>
                    <li class="active"><a href="https://ticket.opensciencegrid.org/index">Ticket</a></li>
	<li class="divider"></li>
	<li><a href="http://repo.grid.iu.edu">Repo</a></li>
	<li class="divider"></li>
	<li><a href="http://blogs.grid.iu.edu">Blog</a></li>
                    <li><a href="http://display.grid.iu.edu">Display</a></li>
                    <li><a href="http://osggoc.blogspot.com/">News</a></li>
                    </ul>
                </li>
            </ul>
            <ul class="nav pull-right">
                <li><a href="https://ticket.opensciencegrid.org/sso/">Login</a></li>            </ul>

            <div class="nav-collapse">
                <ul class="nav">
			 <li id="menu_submit"><a href="https://ticket.opensciencegrid.org/submit">Submit</a></li><li id="menu_view" class="dropdown"><a href="https://ticket.opensciencegrid.org/\#" class="dropdown-toggle" data-toggle="dropdown">View <b class="caret"></b></a><ul class="dropdown-menu"><li id="submenu_listopen"><a href="https://ticket.opensciencegrid.org/list/open">Open Tickets</a></li><li id="submenu_listrecentclose"><a href="https://ticket.opensciencegrid.org/list/recentclose">Recently Closed Tickets</a></li><li class="divider"></li><li id="submenu_alltickets"><a href="https://ticket.opensciencegrid.org/search?q=&amp;sort=id">All Tickets</a></li></ul></li>                </ul>

                <form class="navbar-search pull-right" action="https://ticket.opensciencegrid.org/viewer">
                    <input id="search" type="text" name="id" class="search-query span2" placeholder="Search Ticket" value=""/>
                </form>
            </div>
        </div>
      </div>
    </div>

<script type='text/javascript' src='lib/jquery.timeago.js'></script>
<script type='text/javascript' src='lib/byte2size.js'></script>
<style>
#updates .toolbar {
position: relative;
margin-top: 0px;
top: -10px;
font-weight: normal;
}
#updates a.anchor {
position: relative;
top: -50px;
}
#updates .selected pre {
animation:selected 2s;
animation-iteration-count: 2;
animation-direction: alternate;
-webkit-animation:selected 2s; 
-webkit-animation-iteration-count: 2;
-webkit-animation-direction: alternate;
box-shadow: inset 1px 1px 20px #9ad;
border: 1px solid #9ab;
margin: 5px 0px;
padding-left: 10px;
}
@keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ab;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
@-webkit-keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ad;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
#updates pre {
background-color: inherit;
line-height: 15px;
padding: 5px;
}
#updates .header {
color: #999;
}
#updates .update_history pre {
background-color: #eee;
color: #666;
font-size: 85%;
}
#updates .clickable {
cursor: pointer;
}
#updates .clickable:hover {
color: #D98719;
}
#updates .meta_information pre {
background-color: #fed;
}
#similar_tickets {
max-height: 300px;
overflow-y: auto;
pointer-events: none;
padding: 5px;
background-color: #f4f4f4;
}
.btn-toolbar {
margin-bottom: 0;
height: 30px;
}
#peers {
position: fixed;
bottom: 0px;
right: 0px;
z-index: 100;
list-style: none;
padding: 5px 0px 0px 5px;
margin: 0px;
background-color: white;
box-shadow: 0px 0px 10px white;
}
#peers li {
background-color: #ccc;
color: #000;
display: inline-block;
padding: 5px 10px;
margin-right: 5px;
position: relative;
}
/*
#peers li:hover {
background-color: #999;
cursor: pointer;
}
*/
#peers span.ip {
padding-left: 5px;
color: #666;
}
#peers .new {
bottom: -30px;
}
/*
#peers .me {
background-color: red;
}
*/
</style>

<div class="container-fluid">
<ul id="peers"></ul>
<div class="alert alert-danger"><a class="close" href="https://ticket.opensciencegrid.org/#" data-dismiss="alert">&times;</a>By the end of May 2018, the ticketing system at https://ticket.opensciencegrid.org will be retired and support will be provided at https://support.opensciencegrid.org. Throughout this transition the support email (help@opensciencegrid.org) will be available as a point of contact.<br><br>                                                   
                                                                                                                                                                                   
Please see the service migration page for details: https://opensciencegrid.github.io/technology/policy/service-migrations-spring-2018/#ticket</div><div id="presence" class="pull-right"></div><div class="ticketgui"><script type="text/javascript" src="lib/checktab.js"></script>

<script>
var expanded = false;
function expand_description() {
    var desc = $(".description");
    if(!expanded) {
        expanded = true;
        //expand to minheight
        var min = 250;
        if(desc.height() < min) {
            desc.animate({height: min}, 200);
        }
    }
}

$(document).ready(function() {
    $("input[name='nad']").datepicker({
        dateFormat: 'yy-mm-dd'
    });
});

</script>



<style>
.form-horizontal .control-label {
padding-top: inherit;
font-size:90%;
color:#666;
}
label {
margin-bottom: 0px;
}
.controls {
line-height: 18px;
}
</style>
<form class="form-horizontal" action="https://ticket.opensciencegrid.org/viewer/updatebasic?id=31053" method="post">
<div class="page-header">
    <h3><span class="muted">31053</span> / UCSD Many job killed &#58; Exitcode 137</h3>
</div>

<div class="row-fluid">
<div class="span5">
    <legend>Contact</legend>
    <div class="control-group">
        <label class="control-label">Full Name</label>
        <div class="controls">jean-roch vlimant</div>
    </div>
    <div class="control-group">
        <label class="control-label">Email</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">Phone</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">CC</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>

    <legend>Details</legend>
    <div class="control-group"><label class="control-label">Associated VO</label><div class="controls">CMS</div></div><div class="control-group"><label class="control-label">Submitted Via</label><div class="controls">GGUS</div></div><div class="control-group"><label class="control-label">Submitter</label><div class="controls">jean-roch vlimant</div></div><div class="control-group"><label class="control-label">Support Center</label><div class="controls">USCMS_Tier2</div></div><div class="control-group"><label class="control-label">Ticket Links</label><div class="controls"></div></div>
    <div class="control-group">
        <label class="control-label">Ticket Type</label>
        <div class="controls">Problem/Request</div>
    </div>
    <div class="control-group">
        <label class="control-label">Priority</label>
        <div class="controls">Normal</div>
    </div>
    <div class="control-group">
        <label class="control-label">Status</label>
        <div class="controls">
Closed</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action</label>
        <div class="controls">Possibly Close</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action Deadline</label>
        <div class="controls flag_red">2016-10-28</div>
    </div>

</div><!--span-->
<div class="span7">
    <legend>Assignees</legend>
    <div class="assignee" style="width: 60%">USCMS Tier 2 <span class="muted"> / OSG Support Centers</span></div><div class="assignee" style="width: 60%">GGUS (Prod)&nbsp;<a target="_blank" href="https://ggus.eu/ws/ticket_info.php?ticket=123602">123602</a> <span class="muted"> / Ticket Exchange</span></div>    <br>

    <legend>Assignees</legend>
    TODO
    <br>

    <style>
legend.noborder {
border-bottom: none;
}
</style>

<div id="attachment-list"/>
<script>
$(function () {
    var first = true;
    $.getJSON("attachment/list/31053", function (files) {
        //console.dir(files);
        var html = "<table class=\"table table-condensed\">";
        $(files).each(function() {
            if(first) {
                first = false;
                html += "<legend class=\"noborder\">Attachmenets</legend>";
            }
            html += "<tr class=\"attachment\">";
            html += "<td><img src=\""+this.thumbnail_url+"\"/></td>";
            html += "<td><a href=\""+this.url+"\" target=\"_blank\">"+this.name+"</a></td>";
            html += "<td>"+bytesToSize(this.size, 1)+"</td>";
            html += "</tr>";
        });
        html += "</table>";
        $("#attachment-list").html(html);
    });
});

function download(url) {
    window.open(url, "_blank");
}
</script>


</div><!--span-->
</div><!--row-fluid-->


</form>

</div>
<div id="updates" style="clear: both;">
    <legend>Past Updates
    <div class="btn-toolbar pull-right toolbar">
    </div><!--btn-toolbar-->
    </legend>

    <div class='update_description'><i onclick="document.location='31053#1478908836'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-11-12T00:00:36+00:00">Nov 12, 2016 12:00 AM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1478908836">&nbsp;</a></div><pre>This ticket was closed automatically. If this issue has not been resolved according your expectations or if you need further information, please submit a new ticket referencing this one.

-- by GGUS SYSTEM at Fri Nov 11 23&#58;59&#58;05 UTC 2016

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=123602' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=123602</a></pre></div><div class='update_description'><i onclick="document.location='31053#1477660018'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-10-28T13:06:58+00:00">Oct 28, 2016 01:06 PM UTC</time> by <b>Christopher Pipes</b><a class="anchor" name="1477660018">&nbsp;</a></div><pre>I am going to close this at the EOB today if no one objects. It can be reopened if issues are found to still be present.

Thanks,
Chris</pre></div><div class='update_description'><i onclick="document.location='31053#1477494920'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-10-26T15:15:20+00:00">Oct 26, 2016 03:15 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1477494920">&nbsp;</a></div><pre>Dear All,

Since cgroups have been turned off, I reenabled the site.

Regards,
Gaston Lyons

-- by Gaston Lyons at Wed Oct 26 15&#58;14&#58;12 UTC 2016

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=123602' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=123602</a></pre></div><div class='update_description'><i onclick="document.location='31053#1477493180'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-10-26T14:46:20+00:00">Oct 26, 2016 02:46 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1477493180">&nbsp;</a></div><pre>It will be good if the issue gets solved and the site re-enabled for production.

-- by jean-roch vlimant at Wed Oct 26 14&#58;45&#58;36 UTC 2016

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=123602' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=123602</a></pre></div><div class='update_description'><i onclick="document.location='31053#1477403702'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-10-25T13:55:02+00:00">Oct 25, 2016 01:55 PM UTC</time> by <b>Christopher Pipes</b><a class="anchor" name="1477403702">&nbsp;</a></div><pre>Hello All,

Are there any objections to closing this ticket?

Thanks,
Chris</pre></div><div class='update_description'><i onclick="document.location='31053#1476804911'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-10-18T15:35:11+00:00">Oct 18, 2016 03:35 PM UTC</time> by <b>Terrence Martin</b><a class="anchor" name="1476804911">&nbsp;</a></div><pre>Thats a good question.

eTerrence

On 10/18/16 5&#58;58 AM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='31053#1476795487'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-10-18T12:58:07+00:00">Oct 18, 2016 12:58 PM UTC</time> by <b>Christopher Pipes</b><a class="anchor" name="1476795487">&nbsp;</a></div><pre>Hello All,

Does anyone have an update for this? Is this resolved?

Thanks,
Chris</pre></div><div class='update_description'><i onclick="document.location='31053#1476459868'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-10-14T15:44:28+00:00">Oct 14, 2016 03:44 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1476459868">&nbsp;</a></div><pre>Dear All,

If everybody agrees we&#39;ll the site out of drain on monday, since the issues should be fixed by turning off cgroups. If jobs keep failing, we&#39;ll check out other avenues.

Cheers,
Gaston Lyons
Site Support Team.

-- by Gaston Lyons at Fri Oct 14 15&#58;43&#58;46 UTC 2016

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=123602' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=123602</a></pre></div><div class='update_description'><i onclick="document.location='31053#1476434051'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-10-14T08:34:11+00:00">Oct 14, 2016 08:34 AM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1476434051">&nbsp;</a></div><pre>Hi,

We need to get the answer from Terrence if turning off cgroups helped, so then we could re-enable USCD.

-- by Rokas maciulaitis at Fri Oct 14 08&#58;33&#58;09 UTC 2016

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=123602' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=123602</a></pre></div><div class='update_description'><i onclick="document.location='31053#1476397679'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-10-13T22:27:59+00:00">Oct 13, 2016 10:27 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1476397679">&nbsp;</a></div><pre>Hi, can anyone from the site support team or the site update this thread ? can we re-enable UCSD and have it contribute to the rereco ?
it is one of the US site with most free space at the moment, so it&#39;d be nice if the site issue had been solved.

-- by jean-roch vlimant at Thu Oct 13 22&#58;27&#58;01 UTC 2016

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=123602' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=123602</a></pre></div><div class='update_description'><i onclick="document.location='31053#1476215535'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-10-11T19:52:15+00:00">Oct 11, 2016 07:52 PM UTC</time> by <b>Christopher Pipes</b><a class="anchor" name="1476215535">&nbsp;</a></div><pre>Hello All,

Does anyone have any new information on this since Terrence&#39;s last update? Are things looking better?

Thanks,
Chris</pre></div><div class='update_description'><i onclick="document.location='31053#1475873333'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-10-07T20:48:53+00:00">Oct 7, 2016 08:48 PM UTC</time> by <b>Christopher Pipes</b><a class="anchor" name="1475873333">&nbsp;</a></div><pre>Hello All,

Does anyone have any new information on this since Terrence&#39;s last update? Are things looking better?

Thanks,
Chris</pre></div><div class='update_description'><i onclick="document.location='31053#1475599458'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-10-04T16:44:18+00:00">Oct 4, 2016 04:44 PM UTC</time> by <b>Christopher Pipes</b><a class="anchor" name="1475599458">&nbsp;</a></div><pre>Hello All,

Did turning off cgroups help?

Thanks,
Chris</pre></div><div class='update_description'><i onclick="document.location='31053#1475325568'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-10-01T12:39:28+00:00">Oct 1, 2016 12:39 PM UTC</time> by <b>Christopher Pipes</b><a class="anchor" name="1475325568">&nbsp;</a></div><pre>Hello All,

Does anyone have any new information on this since Terrence&#39;s last update? Are things looking better?

Thanks,
Chris</pre></div><div class='update_description'><i onclick="document.location='31053#1475092275'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-09-28T19:51:15+00:00">Sep 28, 2016 07:51 PM UTC</time> by <b>Christopher Pipes</b><a class="anchor" name="1475092275">&nbsp;</a></div><pre>Hello All,

Did turning off cgroups help?

Thanks,
Chris</pre></div><div class='update_description'><i onclick="document.location='31053#1474494071'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-09-21T21:41:11+00:00">Sep 21, 2016 09:41 PM UTC</time> by <b>Terrence Martin</b><a class="anchor" name="1474494071">&nbsp;</a></div><pre>Ahh, but what can happen is that the process could get killed because
someone else in that 8 core slot was not behaving properly. It is the
cumulative memory consumption per 8 core slot, not just one user. So
that specific job might not be to blame, but it pushed that user over so
it got killed.

Now that 8 core slot should only belong to CMS since that is what the
pilots are asking for.

Clearly though the watchdogs are not catching things if I am killing off
single CMSRun jobs that are pushing total consumption for that 8 core
slot above 22GB of RAM.

Also In the meeting yesterday UNL has reported seeing similar activity,
but they are not being perhaps as harsh as I am so it is not perhaps
accurate to say UCSD is the only site that this is happening at.

As far as more or less restrictive, the entire site is using the same
cgroup configuration.

I am going to turn cgroups off for now and see how things go.

Terrence

On 9/21/2016 1&#58;14 PM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='31053#1474488894'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-09-21T20:14:54+00:00">Sep 21, 2016 08:14 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1474488894">&nbsp;</a></div><pre>Hi Terrence,

for central production, in terms of memory and threads, jobs are using the threads they declare to use, and we have watchdogs tightly set to the memory requirement. In the log I send, the process is terminated with RSS of ~600M, exit code 137.
UCSD is the only site killing task this way, so there must be something going on, but not for all jobs.

Is there a possibility that part of the cluster is having a more restricted limit than the rest ?

I would not bother bothering if there wasn&#39;t something fishy and wide. Sorry for bothering anyways.
I&#39;d appreciate if site support could take over and debug this through.
Gaston, Stephan ?

-- by jean-roch vlimant at Wed Sep 21 20&#58;14&#58;00 UTC 2016

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=123602' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=123602</a></pre></div><div class='update_description'><i onclick="document.location='31053#1474484350'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-09-21T18:59:10+00:00">Sep 21, 2016 06:59 PM UTC</time> by <b>Terrence Martin</b><a class="anchor" name="1474484350">&nbsp;</a></div><pre>Access is good, but I feel pretty strongly that a lot of this issue is
that CMS jobs are routinely using too much memory and are getting
killed. I have many kernel logs of consumption above 21GB for a single 8
core slot.

Now to give some background, at UCSD we use pool users. So each 8 core
slot runs as a single UID. Each of those UID is given a total of 21GB of
RAM, that is 2.5GB/CPU. If the total consumption for that user ID (8
core slot) exceeds 21GB then the kernel kills the job.

I see this constantly, up and to including today, the below log shows
the job was using 24000252kB or 22GB of RAM when the oom killer zapped it.

Sep 21 11&#58;41&#58;25 cabinet-0-0-17 kernel&#58; cmsRun invoked oom-killer&#58;
gfp_mask=0xd0, order=0, oom_adj=12, oom_score_adj=800
Sep 21 11&#58;41&#58;25 cabinet-0-0-17 kernel&#58; cmsRun cpuset=/ mems_allowed=0-1
Sep 21 11&#58;41&#58;25 cabinet-0-0-17 kernel&#58; Pid&#58; 2488873, comm&#58; cmsRun Not
...
Sep 21 11&#58;41&#58;25 cabinet-0-0-17 kernel&#58; Task in /jobsmem killed as a
result of limit of /jobsmem
Sep 21 11&#58;41&#58;25 cabinet-0-0-17 kernel&#58; memory&#58; usage 22527992kB, limit
22528000kB, failcnt 3643542449
Sep 21 11&#58;41&#58;25 cabinet-0-0-17 kernel&#58; memory+swap&#58; usage 24000252kB,
limit 9007199254740991kB, failcnt 0

The other possibility is that users are still doing things they should
not and submitting jobs that are starting more threads then they are
supposed to. So while each job may sit at a reasonable 1.7GB of RAM, the
total count of all the jobs for that particular 8CPU slot will exceed
that due to more threads running that should be.

I have seen CMS users, local, but still, send jobs where the thread
count is too high.

So it may not be any one job, but the fact that the jobs are creating
<div id='show_413154138' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_413154138'>too many threads.

I might be able to put a limit of 8 CPU threads / UID with cgroups and
if that triggers issues then I can report on that.

Terrence

On 9/21/2016 9&#58;38 AM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font>
</div><script type='text/javascript'>
        $('#show_413154138').click(function() {
            $('#detail_413154138').slideDown("normal");
            $('#show_413154138').hide();
            $('#hide_413154138').show();
        });
        $('#hide_413154138').click(function() {
            $('#detail_413154138').slideUp();
            $('#hide_413154138').hide();
            $('#show_413154138').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='31053#1474476529'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-09-21T16:48:49+00:00">Sep 21, 2016 04:48 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1474476529">&nbsp;</a></div><pre>Hi,

I have seen Terrence posting to HN, so he must have access to it.

one log file, in local storage  /store/unmerged/logs/prod/2016/9/20/pdmvserv_TOP-RunIISummer15wmLHEGS-00045_00159_v0__160919_161919_7676/Production/0026/0/07f6f848-7eaf-11e6-ab5c-002590494c06-238-0-logArchive.tar.gz

Cheers,
Jean-Roch

-- by jean-roch vlimant at Wed Sep 21 16&#58;48&#58;36 UTC 2016

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=123602' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=123602</a></pre></div><div class='update_description'><i onclick="document.location='31053#1474475882'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-09-21T16:38:02+00:00">Sep 21, 2016 04:38 PM UTC</time> by <b>Christopher Pipes</b><a class="anchor" name="1474475882">&nbsp;</a></div><pre>Hello,

Could someone with GGUS help Terrence get the access he needs?

Thanks,
Chris</pre></div><div class='update_description'><i onclick="document.location='31053#1474313923'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-09-19T19:38:43+00:00">Sep 19, 2016 07:38 PM UTC</time> by <b>Terrence Martin</b><a class="anchor" name="1474313923">&nbsp;</a></div><pre>For Me? I still have no access to that Hyperlink area and the original logs. However that might not be necessary. The issues seems to be that the jobs were clearly exceeding the memory restrictions (20GB/8 core slot) and triggering a kernel level kill. It seems to have left my area and moved onto getting the pilots/crab to be a bit more to strict and as for why those jobs were asking for too much memory.

First it was jobs killed because they wanted 8.1Gb of RAM/4 core job, then it was because they apparently could not fit into 20GB 8 core slot. Seems that kernel side killing of misbehaving jobs is new, though I think at least one other site employs something like this.</pre></div><div class='update_description'><i onclick="document.location='31053#1474312046'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-09-19T19:07:26+00:00">Sep 19, 2016 07:07 PM UTC</time> by <b>Christopher Pipes</b><a class="anchor" name="1474312046">&nbsp;</a></div><pre>Hi Terrence,

Have you managed to get the information you needed for this?

Regards,
Chris</pre></div><div class='update_description'><i onclick="document.location='31053#1474056528'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-09-16T20:08:48+00:00">Sep 16, 2016 08:08 PM UTC</time> by <b>Christopher Pipes</b><a class="anchor" name="1474056528">&nbsp;</a></div><pre>Hello,

Can anyone assist Terrence with his CERN access?

Thanks,
Chris</pre></div><div class='update_description'><i onclick="document.location='31053#1473957372'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-09-15T16:36:12+00:00">Sep 15, 2016 04:36 PM UTC</time> by <b>Terrence Martin</b><a class="anchor" name="1473957372">&nbsp;</a></div><pre>Can I get access to the information through a method other than
Hypernews? My CERN account access is spotty.

Terrence

On 9/15/2016 1&#58;15 AM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='31053#1473927321'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-09-15T08:15:21+00:00">Sep 15, 2016 08:15 AM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1473927321">&nbsp;</a></div><pre>-- by Rokas maciulaitis at Thu Sep 15 08&#58;14&#58;35 UTC 2016

<a href='https&#58;//hypernews.cern.ch/HyperNews/CMS/get/comp-ops/3199.html' target='_blank' rel='nofollow'>https&#58;//hypernews.cern.ch/HyperNews/CMS/get/comp-ops/3199.html</a> this might be a mis-match between limits.
What is your current limit localy ?

-- by jean-roch vlimant at Wed Sep 14 22&#58;54&#58;18 UTC 2016

Priority has been changed from urgent to top priority.
Hi, some workflow are further experiencing further such killing at UCSD, preventing proper operation.
We&#39;ll have no other option but preventing central production at UCSD if we cannot run jobs.
Please help us getting this straighten out

-- by jean-roch vlimant at Wed Sep 14 22&#58;29&#58;32 UTC 2016

This is happening again

<a href='http&#58;//dashb-cms-job.cern.ch/dashboard/templates/web-job2/#user=&refresh=0&table=Jobs&p=1&records=25&activemenu=0&usr=&site=T2_US_UCSD&submissiontool=&application=&activity=&status=&check=submitted&tier=&date1=2016-08-24+09%3A22&date2=2016-09-08+10%3A22&sortby=appexitcode&scale=linear&bars=20&ce=&rb=&grid=&jobtype=&submissionui=&dataset=&submissiontype=&task=wmagent_pdmvserv_SMP-RunIISpring16DR80-00083_00625_v0__160826_122650_96&subtoolver=&genactivity=&outputse=&appexitcode=&accesstype=&inputse=&cores=' target='_blank' rel='nofollow'>http&#58;//dashb-cms-job.cern.ch/dashboard/templates/web-job2/#user=&refresh=0&table=Jobs&p=1&records=25&activemenu=0&usr=&site=T2_US_UCSD&submissiontool=&application=&activity=&status=&check=submitted&tier=&date1=2016-08-24+09%3A22&date2=2016-09-08+10%3A22&sortby=appexitcode&scale=linear&bars=20&ce=&rb=&grid=&jobtype=&submissionui=&dataset=&submissiontype=&task=wmagent_pdmvserv_SMP-RunIISpring16DR80-00083_00625_v0__160826_122650_96&subtoolver=&genactivity=&outputse=&appexitcode=&accesstype=&inputse=&cores=</a>

-- by jean-roch vlimant at Thu Sep 08 10&#58;33&#58;13 UTC 2016

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=123602' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=123602</a></pre></div><div class='update_description'><i onclick="document.location='31053#1473252191'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-09-07T12:43:11+00:00">Sep 7, 2016 12:43 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1473252191">&nbsp;</a></div><pre>memory restriction set looser

-- by Stephan Lammel at Tue Sep 06 13&#58;42&#58;10 UTC 2016

please close. I would if I could. thanks.

-- by jean-roch vlimant at Fri Sep 02 21&#58;13&#58;30 UTC 2016

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=123602' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=123602</a></pre></div><div class='update_description'><i onclick="document.location='31053#1473252154'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-09-07T12:42:34+00:00">Sep 7, 2016 12:42 PM UTC</time> by <b>Christopher Pipes</b><a class="anchor" name="1473252154">&nbsp;</a></div><pre>Hello All,

Has everything cleared up? Is this ok to close?

Thanks,
Chris</pre></div><div class='update_description'><i onclick="document.location='31053#1472848205'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-09-02T20:30:05+00:00">Sep 2, 2016 08:30 PM UTC</time> by <b>Christopher Pipes</b><a class="anchor" name="1472848205">&nbsp;</a></div><pre>Hello Jean,

Is this ok to close or do we need to leave it open to monitor?

Thanks,
Chris</pre></div><div class='update_description'><i onclick="document.location='31053#1472751108'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-09-01T17:31:48+00:00">Sep 1, 2016 05:31 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1472751108">&nbsp;</a></div><pre>thanks.
Things are looking better already in dashboard

-- by jean-roch vlimant at Wed Aug 31 20&#58;36&#58;45 UTC 2016

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=123602' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=123602</a></pre></div><div class='update_description'><i onclick="document.location='31053#1472675351'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-08-31T20:29:11+00:00">Aug 31, 2016 08:29 PM UTC</time> by <b>Terrence Martin</b><a class="anchor" name="1472675351">&nbsp;</a></div><pre>The control is based a slot, which can have 8 cores used.

8 cores x 2GB = 16GB.

If you use 4 cores, yes that is 8.1, but there will be another 4 core
job in that slot that can use 8.1 too. 8.1+8.1 = 16.2 &#62; 16.

The fix was to increase the limit above 16GB.

Terrence

On 08/31/2016 01&#58;00 PM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='31053#1472673620'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-08-31T20:00:20+00:00">Aug 31, 2016 08:00 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1472673620">&nbsp;</a></div><pre>Hi,

sorry, I am not understanding &#34;4 x 2 x 8.1 &#62; 16GB&#34;. the job requires 4 cores, and 8.1G total &#58; so it should stay &#60; 16.
thanks for adjusting the policy already.

-- by jean-roch vlimant at Wed Aug 31 01&#58;42&#58;55 UTC 2016

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=123602' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=123602</a></pre></div><div class='update_description'><i onclick="document.location='31053#1472673558'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-08-31T19:59:18+00:00">Aug 31, 2016 07:59 PM UTC</time> by <b>Christopher Pipes</b><a class="anchor" name="1472673558">&nbsp;</a></div><pre>Hello Jean,

Have you been able to retry this?

Thanks,
Chris</pre></div><div class='update_description'><i onclick="document.location='31053#1472583190'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-08-30T18:53:10+00:00">Aug 30, 2016 06:53 PM UTC</time> by <b>terrence.martin@....</b><a class="anchor" name="1472583190">&nbsp;</a></div><pre>Yup 4 x 2 x 8.1 &#62; 16GB.

I have already loosened that restriction so they will not be killed for
that overage. This was a change to policy here that we can tune and
have. They should work fine now.

Terrence

On 8/30/2016 10&#58;34 AM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='31053#1472578497'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-08-30T17:34:57+00:00">Aug 30, 2016 05:34 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1472578497">&nbsp;</a></div><pre>Hi,
some of these workflows require 4 core and 8.1G. the watchdog is set to 8.4G, and are well behave otherwise.
another one have had millions of succeeding jobs in all T1 and T2 and got a couple of thousands killed at UCSD.

-- by jean-roch vlimant at Mon Aug 29 20&#58;30&#58;41 UTC 2016

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=123602' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=123602</a></pre></div><div class='update_description'><i onclick="document.location='31053#1472492651'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-08-29T17:44:11+00:00">Aug 29, 2016 05:44 PM UTC</time> by <b>Terrence Martin</b><a class="anchor" name="1472492651">&nbsp;</a></div><pre>Likely because they are using more memory than they are allowed to at
2GB/process(thread) so they are killed by cgroups.

What is this jobs estimate of required memory / thread?

Terrence

On 08/29/2016 08&#58;32 AM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='31053#1472484743'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-08-29T15:32:23+00:00">Aug 29, 2016 03:32 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1472484743">&nbsp;</a></div><pre>Notified CMS Site Support team of this ticket.
Flushed field &#39;Notify Site&#39;

-- by jean-roch vlimant at Mon Aug 29 15&#58;32&#58;00 UTC 2016

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=123602' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=123602</a></pre></div><div class='update_description'><i onclick="document.location='31053#1472215968'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-08-26T12:52:48+00:00">Aug 26, 2016 12:52 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1472215968">&nbsp;</a></div><pre>Dear Admin,

a couple of cms workflows have been killed from the batch system, mostly in two large cms premix digi-reco workflows. and there was no apparent reason for this to happen. would you have any insights ?
I rull out pilot or production watchdogs killing the jobs.

[Ticket Origin]
<a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=123602' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=123602</a>

[Ticket History]
Subject&#58; UCSD Many job killed &#58; Exitcode 137
Ticket Type&#58; USER
CC&#58; ;cms-comp-ops-site-support-team@....
-- by jean-roch vlimant at Fri Aug 26 12&#58;52&#58;09 UTC 2016</pre></div>
</div>
<script type="text/javascript">
function reset_anchor() {
    $("#updates .selected").removeClass("selected");
    var urls = document.location.toString().split('#'); 
    var anchor = urls[1];
    if(anchor) {
        $("a[name='"+anchor+"']").parents(".update_description").addClass("selected");
    }
}
function submitspam(ticket_id) {
    myret = confirm("Would you like to close this ticket as a security ticket, and submit the ticket content to akismet?");
    if(myret == true) {
        $.ajax("viewer/processspam?id="+ticket_id).done(function() {
            window.location.reload();
        });
    }
}

$(function() {
    reset_anchor();
    var ADDITIONAL_COOKIE_NAME = 'gocticket';
    var options = { path: '/', expires: 365};

    if(window.opener && window.opener.name == "gocticket_list") {
        v = $.cookie("closewindow");
        if(!v) {
            $("#closewindow").attr("checked", "checked"); //on by default
        } else {
            if(v == "checked") {
                $("#closewindow").attr("checked", "checked");
            }
        }
        $("#closewindow").click(function() {
            $.cookie("closewindow", $(this).attr('checked'), options);
        });
    } else {
        $("#closewindow_area").hide();
    }
    function updateTimeago() {
        $("time").timeago();
        setTimeout(updateTimeago, 30*1000);
    }
    updateTimeago();
    $(".description").focus(expand_description);
});
</script>
<hr/>
<footer>
<p>GOC Ticket Version 2.2 | <a href="https://ticket.opensciencegrid.org/goc/submit?app_issue_check=on&amp;app_issue_type=goc&amp;app_goc_url=https%3A%2F%2Fticket.opensciencegrid.org%3A443%2F31053">Report Bugs</a>
 | <a href="https://github.com/opensciencegrid/operations/blob/master/docs/privacy.md">Privacy Policy</a>
</p>

<p> <img align="top" src="images/tag_orange.png"/> Copyright 2018 The Trustees of Indiana University - Developed for Open Science Grid</p>
</footer>


</div><!--container-fluid-->
<script>
//used by searchbox
function parseValue(value) {
    var obj = new Object();
    var tokens = value.split("\t");
    obj.str = tokens[0];
    obj.count = tokens[1];
    return obj;
}

$(function() {
    //bootstrap-2.0.4 stuff
    $(".alert-message").alert();
    $(".dropdown-toggle").dropdown();
    $("span[rel='tooltip']").tooltip();
    $("a[rel=popover]").popover();

    //activate menu that user is currently on
    $("#menu_navigator").addClass("active"); 
    $("#submenu_").addClass("active"); 

    //translate zend validation error message to bootstrap
    $(".errors").addClass("alert").addClass("alert-error");

});
</script>


</body>
