<!DOCTYPE html>
<html lang="en">
  <head>
  <base href="">
    <title>[32862] T3_US_Baylor&#58; Submit SAM tests to HTCondorCE</title>    <meta charset="utf-8" />
    <meta name="verify-v1" content="na5IcAJsZVOfEkboRxuIiZ1zpZgnZiWra+nKcS7nA/o=" />
    <meta name="google-site-verification" content="DLrk3ft4s8b-S2TloLCL2LD_t6wcTjgSluf5pmiu2kA" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />
    <link href="https://ticket.opensciencegrid.org/rss" rel="alternate" type="application/rss+xml" title="GOC Ticket Update feed" />

    <style type="text/css">
      body {
        padding-top: 50px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
     #search {
            width: 300px;
     }

    </style>

<script src="https://code.jquery.com/jquery-3.0.0.js"></script>
<script src="https://code.jquery.com/jquery-migrate-3.0.1.js"></script>

   <link href="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet"/>
    <script src="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/js/bootstrap.min.js"></script>

    <link href="https://netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"/>
    <link href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/themes/smoothness/jquery-ui.min.css" rel="stylesheet"/>
 <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>


    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/js/select2.min.js"></script>

    <link href="css/ticket.css" rel="stylesheet" />
    <script src="lib/jquery.cookie.js"></script>

    <link href="images/tag_orange.png" rel="icon" type="image/png"/>
    <script src='https://www.google.com/recaptcha/api.js'></script>
  </head>

  <body>
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>

            <a class="brand" style="padding: 6px 0px 0px 6px;" href="http://opensciencegrid.org"><img src="images/osglogo.40x30.png"/></a>
            <ul class="nav">
                <li class="dropdown"><a href="https://ticket.opensciencegrid.org/#" class="dropdown-toggle" data-toggle="dropdown">GOC Ticket <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    <li><a href="https://my.opensciencegrid.org">MyOSG</a></li>
                    <li><a href="https://oim.opensciencegrid.org">OIM</a></li>
                    <li class="active"><a href="https://ticket.opensciencegrid.org/index">Ticket</a></li>
	<li class="divider"></li>
	<li><a href="http://repo.grid.iu.edu">Repo</a></li>
	<li class="divider"></li>
	<li><a href="http://blogs.grid.iu.edu">Blog</a></li>
                    <li><a href="http://display.grid.iu.edu">Display</a></li>
                    <li><a href="http://osggoc.blogspot.com/">News</a></li>
                    </ul>
                </li>
            </ul>
            <ul class="nav pull-right">
                <li><a href="https://ticket.opensciencegrid.org/sso/">Login</a></li>            </ul>

            <div class="nav-collapse">
                <ul class="nav">
			 <li id="menu_submit"><a href="https://ticket.opensciencegrid.org/submit">Submit</a></li><li id="menu_view" class="dropdown"><a href="https://ticket.opensciencegrid.org/\#" class="dropdown-toggle" data-toggle="dropdown">View <b class="caret"></b></a><ul class="dropdown-menu"><li id="submenu_listopen"><a href="https://ticket.opensciencegrid.org/list/open">Open Tickets</a></li><li id="submenu_listrecentclose"><a href="https://ticket.opensciencegrid.org/list/recentclose">Recently Closed Tickets</a></li><li class="divider"></li><li id="submenu_alltickets"><a href="https://ticket.opensciencegrid.org/search?q=&amp;sort=id">All Tickets</a></li></ul></li>                </ul>

                <form class="navbar-search pull-right" action="https://ticket.opensciencegrid.org/viewer">
                    <input id="search" type="text" name="id" class="search-query span2" placeholder="Search Ticket" value=""/>
                </form>
            </div>
        </div>
      </div>
    </div>

<script type='text/javascript' src='lib/jquery.timeago.js'></script>
<script type='text/javascript' src='lib/byte2size.js'></script>
<style>
#updates .toolbar {
position: relative;
margin-top: 0px;
top: -10px;
font-weight: normal;
}
#updates a.anchor {
position: relative;
top: -50px;
}
#updates .selected pre {
animation:selected 2s;
animation-iteration-count: 2;
animation-direction: alternate;
-webkit-animation:selected 2s; 
-webkit-animation-iteration-count: 2;
-webkit-animation-direction: alternate;
box-shadow: inset 1px 1px 20px #9ad;
border: 1px solid #9ab;
margin: 5px 0px;
padding-left: 10px;
}
@keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ab;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
@-webkit-keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ad;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
#updates pre {
background-color: inherit;
line-height: 15px;
padding: 5px;
}
#updates .header {
color: #999;
}
#updates .update_history pre {
background-color: #eee;
color: #666;
font-size: 85%;
}
#updates .clickable {
cursor: pointer;
}
#updates .clickable:hover {
color: #D98719;
}
#updates .meta_information pre {
background-color: #fed;
}
#similar_tickets {
max-height: 300px;
overflow-y: auto;
pointer-events: none;
padding: 5px;
background-color: #f4f4f4;
}
.btn-toolbar {
margin-bottom: 0;
height: 30px;
}
#peers {
position: fixed;
bottom: 0px;
right: 0px;
z-index: 100;
list-style: none;
padding: 5px 0px 0px 5px;
margin: 0px;
background-color: white;
box-shadow: 0px 0px 10px white;
}
#peers li {
background-color: #ccc;
color: #000;
display: inline-block;
padding: 5px 10px;
margin-right: 5px;
position: relative;
}
/*
#peers li:hover {
background-color: #999;
cursor: pointer;
}
*/
#peers span.ip {
padding-left: 5px;
color: #666;
}
#peers .new {
bottom: -30px;
}
/*
#peers .me {
background-color: red;
}
*/
</style>

<div class="container-fluid">
<ul id="peers"></ul>
<div class="alert alert-danger"><a class="close" href="https://ticket.opensciencegrid.org/#" data-dismiss="alert">&times;</a>By the end of May 2018, the ticketing system at https://ticket.opensciencegrid.org will be retired and support will be provided at https://support.opensciencegrid.org. Throughout this transition the support email (help@opensciencegrid.org) will be available as a point of contact.<br><br>                                                   
                                                                                                                                                                                   
Please see the service migration page for details: https://opensciencegrid.github.io/technology/policy/service-migrations-spring-2018/#ticket</div><div id="presence" class="pull-right"></div><div class="ticketgui"><script type="text/javascript" src="lib/checktab.js"></script>

<script>
var expanded = false;
function expand_description() {
    var desc = $(".description");
    if(!expanded) {
        expanded = true;
        //expand to minheight
        var min = 250;
        if(desc.height() < min) {
            desc.animate({height: min}, 200);
        }
    }
}

$(document).ready(function() {
    $("input[name='nad']").datepicker({
        dateFormat: 'yy-mm-dd'
    });
});

</script>



<style>
.form-horizontal .control-label {
padding-top: inherit;
font-size:90%;
color:#666;
}
label {
margin-bottom: 0px;
}
.controls {
line-height: 18px;
}
</style>
<form class="form-horizontal" action="https://ticket.opensciencegrid.org/viewer/updatebasic?id=32862" method="post">
<div class="page-header">
    <h3><span class="muted">32862</span> / T3_US_Baylor&#58; Submit SAM tests to HTCondorCE</h3>
</div>

<div class="row-fluid">
<div class="span5">
    <legend>Contact</legend>
    <div class="control-group">
        <label class="control-label">Full Name</label>
        <div class="controls">Douglas Johnson</div>
    </div>
    <div class="control-group">
        <label class="control-label">Email</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">Phone</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">CC</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>

    <legend>Details</legend>
    <div class="control-group"><label class="control-label">Associated VO</label><div class="controls">CMS</div></div><div class="control-group"><label class="control-label">Submitted Via</label><div class="controls">GGUS</div></div><div class="control-group"><label class="control-label">Submitter</label><div class="controls">Douglas Johnson</div></div><div class="control-group"><label class="control-label">Support Center</label><div class="controls">USCMS_Tier3</div></div><div class="control-group"><label class="control-label">Ticket Links</label><div class="controls"></div></div>
    <div class="control-group">
        <label class="control-label">Ticket Type</label>
        <div class="controls">Problem/Request</div>
    </div>
    <div class="control-group">
        <label class="control-label">Priority</label>
        <div class="controls">Elevated</div>
    </div>
    <div class="control-group">
        <label class="control-label">Status</label>
        <div class="controls">
Closed</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action</label>
        <div class="controls">Resolved</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action Deadline</label>
        <div class="controls flag_red">2017-04-07</div>
    </div>

</div><!--span-->
<div class="span7">
    <legend>Assignees</legend>
    <div class="assignee" style="width: 60%">USCMS_Tier3 <span class="muted"> / OSG Support Centers</span></div><div class="assignee" style="width: 60%">GGUS (Prod)&nbsp;<a target="_blank" href="https://ggus.eu/ws/ticket_info.php?ticket=126886">126886</a> <span class="muted"> / Ticket Exchange</span></div>    <br>

    <legend>Assignees</legend>
    TODO
    <br>

    <style>
legend.noborder {
border-bottom: none;
}
</style>

<div id="attachment-list"/>
<script>
$(function () {
    var first = true;
    $.getJSON("attachment/list/32862", function (files) {
        //console.dir(files);
        var html = "<table class=\"table table-condensed\">";
        $(files).each(function() {
            if(first) {
                first = false;
                html += "<legend class=\"noborder\">Attachmenets</legend>";
            }
            html += "<tr class=\"attachment\">";
            html += "<td><img src=\""+this.thumbnail_url+"\"/></td>";
            html += "<td><a href=\""+this.url+"\" target=\"_blank\">"+this.name+"</a></td>";
            html += "<td>"+bytesToSize(this.size, 1)+"</td>";
            html += "</tr>";
        });
        html += "</table>";
        $("#attachment-list").html(html);
    });
});

function download(url) {
    window.open(url, "_blank");
}
</script>


</div><!--span-->
</div><!--row-fluid-->


</form>

</div>
<div id="updates" style="clear: both;">
    <legend>Past Updates
    <div class="btn-toolbar pull-right toolbar">
        <div class="btn-group">
                <a class="btn btn-small" href="https://ticket.opensciencegrid.org/32862?sort=up&amp;"><i class="icon-arrow-up"></i> Sort</a>

        
        <a class="btn btn-small" href="https://ticket.opensciencegrid.org/32862?expandall=true&amp;">Expand Descriptions</a>        <a class="btn btn-small" target="_blank" href="mailto:osg@tick.globalnoc.iu.edu?subject=Open%20Science%20Grid%3A%20T3_US_Baylor%26%2358%3B%20Submit%20SAM%20tests%20to%20HTCondorCE%20ISSUE%3D32862%20PROJ%3D71"><i class="icon-envelope"></i> Update w/Email</a>
        </div>
    </div><!--btn-toolbar-->
    </legend>

    <div class='update_description'><i onclick="document.location='32862#1491848081'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-04-10T18:14:41+00:00">Apr 10, 2017 06:14 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1491848081">&nbsp;</a></div><pre>I think we are good now. Thank you for all the help.

-- by Kenichi Hatakeyama at Mon Apr 10 16&#58;54&#58;58 UTC 2017

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=126886' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=126886</a></pre></div><div class='update_description'><i onclick="document.location='32862#1491840022'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-04-10T16:00:22+00:00">Apr 10, 2017 04:00 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1491840022">&nbsp;</a></div><pre>I think I started to see some jobs landing in the dellblades queue. Thanks a lot!

-- by Kenichi Hatakeyama at Fri Apr 07 23&#58;13&#58;51 UTC 2017

I think the problem was my end.  Our factory config is an added layer of xml, so to properly put the quotes in I just tried changing it to this&#58;
&#60;submit_attr name=&#34;+queue&#34; value=&#34;&quot;dellblades&quot;&#34;/&#62;

I just reconfigured one more time, let me know if this does the trick for new pilots.

Thanks,
Jeff

-- by Jeffrey Dost at Fri Apr 07 23&#58;11&#58;15 UTC 2017

I meant to write&#58; I still see that glidein jobs with 16bg memory request land in moonshot queue, and not in dellblades queue.

-- by Kenichi Hatakeyama at Fri Apr 07 23&#58;06&#58;02 UTC 2017

Hi Jeff,

Thank you. Regarding keeping GLIDEIN_MaxMemMBs as-is, no problem. What you wrote makes sense.

Hmm. I still see that glidein jobs with 16bg memory request land in moonshot queue, and dellblades queue.

I re-did my condor test with
+queue = &#34;dellblades&#34;
(rest is the same as above) and jobs still land in the &#34;dellblades&#34; queue. So, I am not sure what&#39;s going on. Any suggestions will be quite welcome...

Ken

-- by Kenichi Hatakeyama at Fri Apr 07 23&#58;02&#58;18 UTC 2017

I&#39;ve made the change, but it just occurred to me remote_queue vs queue shouldn&#39;t matter, I think the condor ce strips off the remote_ part anyway.  It could instead be because we&#39;re missing double quotes around dellblades.

Let me know if you still see the same issue, and I&#39;ll try adding them.
<div id='show_368158893' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_368158893'>
Thanks,
Jeff

p.s. here are a few job id&#39;s from your end to try tracking down from after the reconfig&#58;
027 (4178252.000.000) 04/07 15&#58;31&#58;53 Job submitted to grid resource
GridResource&#58; condor kodiak-ce.baylor.edu kodiak-ce.baylor.edu&#58;9619
GridJobId&#58; condor kodiak-ce.baylor.edu kodiak-ce.baylor.edu&#58;9619 39000.0
...
027 (4178252.001.000) 04/07 15&#58;31&#58;53 Job submitted to grid resource
GridResource&#58; condor kodiak-ce.baylor.edu kodiak-ce.baylor.edu&#58;9619
GridJobId&#58; condor kodiak-ce.baylor.edu kodiak-ce.baylor.edu&#58;9619 39001.0
...
027 (4178252.002.000) 04/07 15&#58;31&#58;53 Job submitted to grid resource
GridResource&#58; condor kodiak-ce.baylor.edu kodiak-ce.baylor.edu&#58;9619
GridJobId&#58; condor kodiak-ce.baylor.edu kodiak-ce.baylor.edu&#58;9619 39002.0
...
027 (4178252.003.000) 04/07 15&#58;31&#58;53 Job submitted to grid resource
GridResource&#58; condor kodiak-ce.baylor.edu kodiak-ce.baylor.edu&#58;9619
GridJobId&#58; condor kodiak-ce.baylor.edu kodiak-ce.baylor.edu&#58;9619 39003.0
...

-- by Jeffrey Dost at Fri Apr 07 22&#58;42&#58;20 UTC 2017

Hi Ken,

For the first question as to why the dellblades pilots are getting to moonshot, we were just using +queue not +remote_queue&#58;
&#60;submit_attr name=&#34;+queue&#34; value=&#34;dellblades&#34;/&#62;

I&#39;ll try changing this now to see if it directs them to the right place.  Should we be using remote_queue instead for moonshot as well?

We intentionally left GLIDEIN_MaxMemMBs  as-is.  This is the setting the pilot gets configure with, and in general we keep that the full physical amount available for the 8 core pilot for matchmaking reasons.  In practice we can get away with this because it isn&#39;t likely that jobs running on multicore pilots  will all use the full MaxMemMBs  amount combined.  If you strongly prefer I can reduce it to 30GB.

I&#39;ll reply when I finish fixing the queue attribute for dellblade, sorry about that.

Jeff

-- by Jeffrey Dost at Fri Apr 07 22&#58;25&#58;24 UTC 2017

Hi Jeff,

Thank you. I used 2GB*8, because I thought that&#39;s the minimum requirement (i.e. 2GB/core) for ncpus=8 glidein jobs. This may not be optimal for dellblades nodes with 16 cores with 32GB RAM (pbs won&#39;t allow 2 jobs with 16GB each per node), but this is fine for single ncpus=8 jobs per node. I am ok to keep it this way at least for now, but I will be happy to get suggestions.

I see new glidein jobs with 16GB memory request (instead of 30GB) are coming in, but they are still landing on the moonshot queue, and not dellblades queue. If I manually re-assign those jobs from moonshot to dellblades, via pbs they run fine, but I don&#39;t know why they are not landing on the dellblades queue from the beginning.

If I run some test condor jobs with the following setting, the submitted jobs land in the dellblades queue correctly.
+++++
universe = grid
#universe = 9
grid_resource = condor kodiak-ce.baylor.edu kodiak-ce.baylor.edu&#58;9619

executable = test.sh

ShouldTransferFiles = YES
WhenToTransferOutput = ON_EXIT

arguments     = $(Cluster).$(Process)

# Set the job&#39;s batch system queue to &#39;analysis&#39;
+remote_queue = &#34;dellblades&#34;
output = test_dellblades.$(Cluster).$(Process).out
error = test_dellblades.$(Cluster).$(Process).err
log = test_dellblades.$(Cluster).$(Process).log

use_x509userproxy = true
queue 50
+++++
Would you mind double-checking your entry setting?

For your information,
our /etc/condor-ce/config.d/99-local.conf can be found at&#58;
<a href='http&#58;//hep.baylor.edu/hatake/tmp/99-local.conf.20170407.v7' target='_blank' rel='nofollow'>http&#58;//hep.baylor.edu/hatake/tmp/99-local.conf.20170407.v7</a>
and the output of condor_ce_job_router_info -config can be found in&#58;
<a href='http&#58;//hep.baylor.edu/hatake/tmp/condor_ce_job_router_info_config.txt' target='_blank' rel='nofollow'>http&#58;//hep.baylor.edu/hatake/tmp/condor_ce_job_router_info_config.txt</a>

By the way, although many incoming glidein jobs came with the memory request of Resource_List.mem = 30720mb (as intended for the moonshot queue), but all these pages&#58;
1. <a href='http&#58;//glidein.grid.iu.edu/factory/monitor/factoryEntryStatusNow.html?entry=CMS_T3_US_Baylor_moonshot' target='_blank' rel='nofollow'>http&#58;//glidein.grid.iu.edu/factory/monitor/factoryEntryStatusNow.html?entry=CMS_T3_US_Baylor_moonshot</a>
2. <a href='http&#58;//gfactory-1.t2.ucsd.edu/factory/monitor/factoryEntryStatusNow.html?entry=CMS_T3_US_Baylor_moonshot' target='_blank' rel='nofollow'>http&#58;//gfactory-1.t2.ucsd.edu/factory/monitor/factoryEntryStatusNow.html?entry=CMS_T3_US_Baylor_moonshot</a>
3. <a href='http&#58;//vocms0805.cern.ch/monitor/factoryEntryStatusNow.html?entry=CMS_T3_US_Baylor_moonshot' target='_blank' rel='nofollow'>http&#58;//vocms0805.cern.ch/monitor/factoryEntryStatusNow.html?entry=CMS_T3_US_Baylor_moonshot</a>
still show
GLIDEIN_MaxMemMBs    32768
Do you know why? It just takes time for the changes to get propagated to these pages?

Ken

-- by Kenichi Hatakeyama at Fri Apr 07 22&#58;10&#58;41 UTC 2017

Hi Ken,

I just created this queue with the settings you described. However it just occurred to me, should we be asking for slightly less than 16384 for memory like we did for moonshot?  Let me know if you see any issues with incoming pilots not matching like before and we&#39;ll lower it.

Thanks,
Jeff Dost
OSG Glidein Factory Operations

-- by Jeffrey Dost at Fri Apr 07 18&#58;10&#58;16 UTC 2017

Maybe I should have said &#34;an additional entry&#34; instead of &#34;a new entry&#34;.

-- by Kenichi Hatakeyama at Fri Apr 07 16&#58;29&#58;08 UTC 2017

Maybe I should have said &#34;an additional entry&#34; instead of &#34;a new entry&#34;.

-- by Kenichi Hatakeyama at Thu Apr 06 20&#58;58&#58;56 UTC 2017

Maybe I should have said &#34;an additional entry&#34; instead of &#34;a new entry&#34;.

-- by Kenichi Hatakeyama at Thu Apr 06 20&#58;19&#58;30 UTC 2017

Hi Jeff,

Thank you. Now, in-coming glidein jobs seem to be running happily.

Can we move on to creating a new entry for another batch &#34;dellblades&#34;? This is also for CentOS6 nodes.
# Max Mem 2GB*8 = &#92;
set_default_maxMemory=16384; &#92;
# Max WallTime 48 hours &#92;
set_default_maxWallTime=172800; &#92;
# Core count = 16 core nodes, but set this to 8 i.e. glidin factory default
set_default_xcount=8;&#92;
.....
I think we want to use these parameters for this new entry point.

After that, I think we can close this ticket. Thank you for your help.

Ken

-- by Kenichi Hatakeyama at Thu Apr 06 20&#58;15&#58;24 UTC 2017

Hello Kenichi,

I just made the change to 30720 in the factory configs.

Jeff Dost
OSG Glidein Factory Operations

-- by Jeffrey Dost at Thu Apr 06 18&#58;45&#58;08 UTC 2017

Hi Doug, Stephan, all,

It looks like now SUM/SAM tests look all good [1].

Doug, I think Marty Kandes, Marian Zvada, et al are from the glidein factory team, and they are observing this thread. It looks like the gliden factory setting for the moonshot entry point can be found at [2], and indeed I see&#58;
GLIDEIN_CPUS	8
GLIDEIN_MaxMemMBs	32768   # 4096MB*8 = 32 GB

It looks to me a memory value slightly smaller than this should work, so glidein operation, can we change 32768 to 30720 (30 GB)?

qsub -q moonshot -I -l select=1&#58;mem=32768mb&#58;ncpus=8
gets stuck, but
qsub -q moonshot -I -l select=1&#58;mem=30720mb&#58;ncpus=8
runs right away.

Thank you in advance.

Ken

[1] <a href='http&#58;//wlcg-sam-cms.cern.ch/templates/ember/#/plot?group=AllGroups&profile=CMS_CRITICAL_FULL&sites=T3_US_Baylor' target='_blank' rel='nofollow'>http&#58;//wlcg-sam-cms.cern.ch/templates/ember/#/plot?group=AllGroups&profile=CMS_CRITICAL_FULL&sites=T3_US_Baylor</a>
[2] <a href='http&#58;//gfactory-1.t2.ucsd.edu/factory/monitor/factoryEntryStatusNow.html?entry=CMS_T3_US_Baylor_moonshot' target='_blank' rel='nofollow'>http&#58;//gfactory-1.t2.ucsd.edu/factory/monitor/factoryEntryStatusNow.html?entry=CMS_T3_US_Baylor_moonshot</a>

-- by Kenichi Hatakeyama at Wed Apr 05 05&#58;31&#58;27 UTC 2017

SAM test come with a one core request.   - Stephan

-- by Stephan Lammel at Tue Apr 04 14&#58;19&#58;23 UTC 2017

Hi Ken

​I suspect that the factory is using 4GB * 8 cores, i.e., 4GB/core. I also
think they should be requesting a queue. If osg-factory is not on this
ticket, then please send them an email and ask them to set the resource
requests to&#58;

8 cores
2 or 3 GB/core
queue = moonshot

I assume that SUM/SAM jobs do not request 8 cores.

Thank you,
doug

​

-- by Douglas Johnson at Tue Apr 04 13&#58;31&#58;13 UTC 2017

Hi Doug,

Thank you very much for your help. It looks like jobs are coming in requesting 32GB of memory, but 32GB is the limit of our moonshot node. Locally, I see&#58;

qsub -q moonshot -I -l select=1&#58;ncpus=8&#58;mem=31GB
[it runs right away]

qsub -q moonshot -I -l select=1&#58;ncpus=8&#58;mem=32GB
[stuck]

Based on the Marty&#39;s message, I thought we are expecting jobs coming with requesting 4GB memory and 8 cores, then I thought we should be fine. Do we need to satisfy this 32GB requirement somehow? or can be this reconfigured somewhere upstream of glidein?

-- by Kenichi Hatakeyama at Tue Apr 04 10&#58;46&#58;01 UTC 2017

G
​reetings,
​
​I logged into kodiak-ce and made the following changes&#58;

1) Commented out the following from
​/etc/blahp/pbs_local_submit_attributes.sh&#58;

echo &#39;#PBS -q moonshot&#39;

This was added as a kludge to get the CE working at some level.

2) Commented out the additions that I had added
to&#58; /etc/condor-ce/config.d/99-local.conf

3) Added a default queue to route jobs to if no queue is specified

/etc/condor-ce/config.d/99-local.conf&#58;

[ &#92;
GridResource = &#34;batch pbs&#34;; &#92;
TargetUniverse = 9; &#92;
name = &#34;Setting batch system queues&#34;; &#92;
set_default_queue = &#34;moonshot&#34;; &#92;
]

I put this at the end of the route chain under the assumption that is only
used if the first two routes fail?

I am not a Condor expert and am not sure this is the correct way to handle
routes?

I can now submit jobs from Colorado either with or without requesting a
queue and they run. I also see that the SAM/SUM jobs appear to be working.
I do not see any glidein jobs starting. Perhaps that the above
default_queue route is not correct? It appears that the jobs might be
getting submitted to PBS, but not running due to an insufficient resource&#58;

[johnsond@kodiak-ce config.d]$ qstat -f 24968.batch
Job Id&#58; 24968.batch
Job_Name = bl_c9985d77de94
Job_Owner = uscms01@....
job_state = Q
queue = moonshot
server = batch
Checkpoint = u
ctime = Mon Apr  3 15&#58;41&#58;02 2017
Error_Path = kodiak-ce.baylor.edu&#58;/dev/null
Hold_Types = n
Join_Path = n
Keep_Files = n
Mail_Points = n
mtime = Mon Apr  3 15&#58;41&#58;02 2017
Output_Path = kodiak-ce.baylor.edu&#58;/dev/null
Priority = 0
qtime = Mon Apr  3 15&#58;41&#58;02 2017
Rerunable = True
Resource_List.mem = 32768mb
Resource_List.ncpus = 8
Resource_List.nodect = 1
Resource_List.place = free
Resource_List.select = 1&#58;mem=32768mb&#58;ncpus=8
Resource_List.walltime = 48&#58;00&#58;00
Shell_Path_List = /bin/bash
substate = 10
Variable_List = PBS_O_HOME=/data/uscms01,PBS_O_LANG=en_US.UTF-8,
PBS_O_PATH=/usr/local/sbin&#58;/usr/local/bin&#58;/usr/sbin&#58;/usr/bin,
PBS_O_WORKDIR=/data3/htcondor-ce/spool/3073/0/cluster33073.proc0.subpr
oc0,PBS_O_SYSTEM=Linux,PBS_O_QUEUE=moonshot,
PBS_O_HOST=kodiak-ce.baylor.edu
comment = Not Running&#58; Insufficient amount of resource&#58; mem
etime = Mon Apr  3 15&#58;41&#58;02 2017
Submit_arguments =
/tmp/condor_g_scratch.0x555555a72290.2225823/bl_c9985d77
de94
project = _pbs_project_default

In summary, I believe that the issues were that the &#34;kludge&#34; code was not
removed from the system and that there was no default_queue. Now the
insufficient resource issue needs to be addressed.

Thank you,
doug

-- by Douglas Johnson at Mon Apr 03 21&#58;07&#58;18 UTC 2017

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=126886' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=126886</a>
</div><script type='text/javascript'>
        $('#show_368158893').click(function() {
            $('#detail_368158893').slideDown("normal");
            $('#show_368158893').hide();
            $('#hide_368158893').show();
        });
        $('#hide_368158893').click(function() {
            $('#detail_368158893').slideUp();
            $('#hide_368158893').hide();
            $('#show_368158893').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='32862#1491839970'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-04-10T15:59:30+00:00">Apr 10, 2017 03:59 PM UTC</time> by <b>Vince Neal</b><a class="anchor" name="1491839970">&nbsp;</a></div><pre>Hi all,

Looks like from the GGUS ticket this has been resolved.  Please let us know if there are any outstanding issues.</pre></div><div class='update_description'><i onclick="document.location='32862#1491239231'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-04-03T17:07:11+00:00">Apr 3, 2017 05:07 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1491239231">&nbsp;</a></div><pre>It looks like any incoming jobs stay in &#34;HELD&#34; state, and probably it&#39;s because of the routing problem. We are not sure how to solve this problem at a moment even after looking at&#58;
<a href='https&#58;//twiki.grid.iu.edu/bin/view/Documentation/Release3/TroubleshootingHTCondorCE#Jobs_stay_idle_on_the_CE' target='_blank' rel='nofollow'>https&#58;//twiki.grid.iu.edu/bin/view/Documentation/Release3/TroubleshootingHTCondorCE#Jobs_stay_idle_on_the_CE</a>
Any suggestions will be much appreciated.

-- by Kenichi Hatakeyama at Sat Apr 01 04&#58;45&#58;30 UTC 2017

That will work.

On 3/28/17, 5&#58;36 PM, &#34;helpdesk@....&#34; &#60;helpdesk@....&#62; wrote&#58;

Hello,

GGUS Ticket #126886 was updated.
You receive this mail in CC for your information.

REFERENCE LINK&#58; <a href='https&#58;//ggus.eu/index.php?mode=ticket_info&ticket_id=126886' target='_blank' rel='nofollow'>https&#58;//ggus.eu/index.php?mode=ticket_info&ticket_id=126886</a>
SUBJECT&#58; T3_US_Baylor&#58; Submit SAM tests to HTCondorCE

=====================
LATEST MODIFICATIONS&#58;

LAST MODIFIER -&#62; Marty Kandes

PUBLIC DIARY -&#62;
P.S. We will always be requesting 8-core glideins like your default.

Marty Kandes
UCSD Glidein Factory Operations

*********************************************************************************
This is an automated mail. When replying don&#39;t change the subject line!
S T R I P  P R E V I O U S  M A I L S please!!
*********************************************************************************

-- by Hutcheson, Mike at Tue Mar 28 22&#58;38&#58;01 UTC 2017
<div id='show_1863402613' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_1863402613'>
The qstat –f will show that.  Thanks for the suggestion to use condor_ce_q -l command.

Thanks,

Mike

On 3/28/17, 5&#58;35 PM, &#34;helpdesk@....&#34; &#60;helpdesk@....&#62; wrote&#58;

Hello,

GGUS Ticket #126886 was updated.
You receive this mail in CC for your information.

REFERENCE LINK&#58; <a href='https&#58;//ggus.eu/index.php?mode=ticket_info&ticket_id=126886' target='_blank' rel='nofollow'>https&#58;//ggus.eu/index.php?mode=ticket_info&ticket_id=126886</a>
SUBJECT&#58; T3_US_Baylor&#58; Submit SAM tests to HTCondorCE

=====================
LATEST MODIFICATIONS&#58;

LAST MODIFIER -&#62; Marty Kandes

PUBLIC DIARY -&#62;
Hi Mike,

I think if you see a glidein in the PBS queue, can you do something like a qstat -f &#60;jobid&#62;? I believe that will show you the requested memory in one of the attributes. It&#39;s been awhile since I worked with PBS though. We just want to make sure that memory settings either submitted to the CE from the factories (or set by your default at the CEs) are passed to PBS properly.

On the CE side, you can see the HTCondor attributes of the glideins themselves by running condor_ce_q -l &#60;jobid&#62;. Look for RequestMemory or maxMemory.

Marty Kandes
UCSD Glidein Factory Operations

*********************************************************************************
This is an automated mail. When replying don&#39;t change the subject line!
S T R I P  P R E V I O U S  M A I L S please!!
*********************************************************************************

-- by Hutcheson, Mike at Tue Mar 28 22&#58;38&#58;00 UTC 2017

P.S. We will always be requesting 8-core glideins like your default.

Marty Kandes
UCSD Glidein Factory Operations

-- by Marty Kandes at Tue Mar 28 22&#58;35&#58;22 UTC 2017

Hi Mike,

I think if you see a glidein in the PBS queue, can you do something like a qstat -f &#60;jobid&#62;? I believe that will show you the requested memory in one of the attributes. It&#39;s been awhile since I worked with PBS though. We just want to make sure that memory settings either submitted to the CE from the factories (or set by your default at the CEs) are passed to PBS properly.

On the CE side, you can see the HTCondor attributes of the glideins themselves by running condor_ce_q -l &#60;jobid&#62;. Look for RequestMemory or maxMemory.

Marty Kandes
UCSD Glidein Factory Operations

-- by Marty Kandes at Tue Mar 28 22&#58;34&#58;26 UTC 2017

Thanks, Marty, for pointing out the memory issue.  I was thinking in terms of  1 job per core.  The moonshot nodes have 32GB of memory, 4GB/core.  The Dell Blades have 32GB of memory but only 2GB per core.

What’s the best way to tell how much memory GlideIn jobs are asking for?

Cheers,

Mike

On 3/28/17, 3&#58;03 PM, &#34;helpdesk@....&#34; &#60;helpdesk@....&#62; wrote&#58;

Hello,

GGUS Ticket #126886 was updated.
You receive this mail in CC for your information.

REFERENCE LINK&#58; <a href='https&#58;//ggus.eu/index.php?mode=ticket_info&ticket_id=126886' target='_blank' rel='nofollow'>https&#58;//ggus.eu/index.php?mode=ticket_info&ticket_id=126886</a>
SUBJECT&#58; T3_US_Baylor&#58; Submit SAM tests to HTCondorCE

=====================
LATEST MODIFICATIONS&#58;

LAST MODIFIER -&#62; Marty Kandes

PUBLIC DIARY -&#62;
Hi Mike,

I&#39;ve updated our entry in the factories pointed at moonshot to correspond to what you&#39;ve setup. Note, however, I believe the set_default_maxMemory knob is typically the max available memory per job (i.e., not per core). Leave the setting as-is for now and first confirm what you see submitted to PBS for all NEW glideins from here on out. If you see NEW glideins coming in with requests for a total of 4 GB and 8 cores, then go ahead and make the change of set_default_maxMemory = 32 GB (I&#39;m assuming that you have 4 GB per core). Once we have this memory issue sorted out, we&#39;ll create an entry for the dellblades.

Marty Kandes
UCSD Glidein Factory Operations

*********************************************************************************
This is an automated mail. When replying don&#39;t change the subject line!
S T R I P  P R E V I O U S  M A I L S please!!
*********************************************************************************

-- by Hutcheson, Mike at Tue Mar 28 20&#58;08&#58;26 UTC 2017

Hi Mike,

I&#39;ve updated our entry in the factories pointed at moonshot to correspond to what you&#39;ve setup. Note, however, I believe the set_default_maxMemory knob is typically the max available memory per job (i.e., not per core). Leave the setting as-is for now and first confirm what you see submitted to PBS for all NEW glideins from here on out. If you see NEW glideins coming in with requests for a total of 4 GB and 8 cores, then go ahead and make the change of set_default_maxMemory = 32 GB (I&#39;m assuming that you have 4 GB per core). Once we have this memory issue sorted out, we&#39;ll create an entry for the dellblades.

Marty Kandes
UCSD Glidein Factory Operations

-- by Marty Kandes at Tue Mar 28 20&#58;02&#58;02 UTC 2017

Added attachment mailbody.2017-03-27_21.02.20.txt
<a href='https&#58;//ggus.eu/index.php?mode=download&attid=ATT107311' target='_blank' rel='nofollow'>https&#58;//ggus.eu/index.php?mode=download&attid=ATT107311</a>

-- by Hutcheson, Mike at Mon Mar 27 21&#58;02&#58;43 UTC 2017

----------- e-mail with large body ------

added in total as mailbody.2017-03-27_21.02.20.txt

------------ e-mail with large body ------Here’s what I ended up going with for the job router entries on the CE.  You can see the values for memory and wall time&#58;

JOB_ROUTER_ENTRIES = &#92;
[ &#92;
# Route to queue called moonshot &#92;
GridResource = &#34;batch pbs&#34;; &#92;
TargetUniverse = 9; &#92;
name = &#34;Local_PBS_moonshot&#34;; &#92;
# Max Mem 4GB &#92;
set_default_maxMemory=4096; &#92;
# Max WallTime 48 hours &#92;
set_default_maxWallTime=172800; &#92;
set_default_queue=moonshot; &#92;
# Core count = 8 &#92;
set_default_xcount=8;&#92;
Requirements = (TARGET.queue =?= &#34;moonshot&#34;); &#92;
] &#92;
[ &#92;
# Route to queue called dellblades &#92;
GridResource = &#34;batch pbs&#34;; &#92;
TargetUniverse = 9; &#92;
name = &#34;Local_PBS_dellblades&#34;; &#92;
# Max Mem 2GB &#92;
set_default_maxMemory=2048; &#92;
# Max WallTime 48 hours &#92;
set_default_maxWallTime=172800; &#92;
set_default_queue=dellblades; &#92;
# Core count = 16 &#92;
set_default_xcount=16;&#92;
Requirements = (TARGET.queue =?= &#34;dellblades&#34;); &#92;
]

I ran the condor_ce_reconfig after making the changes to 99-local.conf.  Is there anything else I need to do?

Cheers,

Mike

On 3/22/17, 6&#58;36 PM, &#34;helpdesk@....&#34; &#60;helpdesk@....&#62; wrote&#58;

Hello,

GGUS Ticket #126886 was updated.
You receive this mail in CC for your information.

REFERENCE LINK&#58; <a href='https&#58;//ggus.eu/index.php?mode=ticket_info&ticket_id=126886' target='_blank' rel='nofollow'>https&#58;//ggus.eu/index.php?mode=ticket_info&ticket_id=126886</a>
SUBJECT&#58; T3_US_Baylor&#58; Submit SAM tests to HTCondorCE

=====================
LATEST MODIFICATIONS&#58;

LAST MODIFIER -&#62; Marty Kandes

PUBLIC DIARY -&#62;
Hi Mike,

It sounds like there is some confusion here. Let me try to clarify ....

First, your job router recipes in update#34 look correct for specifying the difference queues we may target when submitting glideins from the factories. Second, as indicated in the Job Router Recipes documentation [1], you may also set a default/maximum number of cores, memory, and/or wall clock time for each route using the set_default_* options you mentioned in update#36.

In addition to these set_default_* options in your job router entries, we will also set on the factory-side the requested number of cores, memory, and wall clock time per glidein when we submit them to your HTCondor-CE. On our side, these requested values should be equal to or less than your any maximum limits you set either in your job route entries and/or local PBS batch/queue limits. These &#34;submit attributes&#34; set at the factory are the slightly different syntax Marian was referring to in update#35. i.e., we set +maxMemory, +maxWallTime, and +xcount in the factory.

So I think all we need from you to correctly configure the moonshot entry in the factory is&#58;

1. What is the number of cores we should use in the glideins submitted to the moonshot queue? e.g., CMS standard multicore glidein is 8-cores.
2. What is the amount of available memory per core for jobs in the moonshot queue? e.g., minimum is 2 GB per core.
3. What is the maximum wall clock limit for a job in the moonshot queue? e.g., typical CMS site is 48 hours.

Marty Kandes
UCSD Glidein Factory Operations

Marty Kandes
UCSD Glidein Factory Operations

[1]

<a href='https&#58;//twiki.grid.iu.edu/bin/view/Documentation/Release3/JobRouterRecipes' target='_blank' rel='nofollow'>https&#58;//twiki.grid.iu.edu/bin/view/Documentation/Release3/JobRouterRecipes</a>

******************************************...
...
--- body truncated, see attachment mailbody.2017-03-27_21.02.20.txt for full text ---

-- by Hutcheson, Mike at Mon Mar 27 21&#58;02&#58;43 UTC 2017

Hi Mike,

It sounds like there is some confusion here. Let me try to clarify ....

First, your job router recipes in update#34 look correct for specifying the difference queues we may target when submitting glideins from the factories. Second, as indicated in the Job Router Recipes documentation [1], you may also set a default/maximum number of cores, memory, and/or wall clock time for each route using the set_default_* options you mentioned in update#36.

In addition to these set_default_* options in your job router entries, we will also set on the factory-side the requested number of cores, memory, and wall clock time per glidein when we submit them to your HTCondor-CE. On our side, these requested values should be equal to or less than your any maximum limits you set either in your job route entries and/or local PBS batch/queue limits. These &#34;submit attributes&#34; set at the factory are the slightly different syntax Marian was referring to in update#35. i.e., we set +maxMemory, +maxWallTime, and +xcount in the factory.

So I think all we need from you to correctly configure the moonshot entry in the factory is&#58;

1. What is the number of cores we should use in the glideins submitted to the moonshot queue? e.g., CMS standard multicore glidein is 8-cores.
2. What is the amount of available memory per core for jobs in the moonshot queue? e.g., minimum is 2 GB per core.
3. What is the maximum wall clock limit for a job in the moonshot queue? e.g., typical CMS site is 48 hours.

Marty Kandes
UCSD Glidein Factory Operations

Marty Kandes
UCSD Glidein Factory Operations

[1]

<a href='https&#58;//twiki.grid.iu.edu/bin/view/Documentation/Release3/JobRouterRecipes' target='_blank' rel='nofollow'>https&#58;//twiki.grid.iu.edu/bin/view/Documentation/Release3/JobRouterRecipes</a>

-- by Marty Kandes at Wed Mar 22 23&#58;36&#58;07 UTC 2017

Hi Mike,

I was trying to say we could set this limitation on pilot level when Factory is creating glideins to be sent to particular ENTRY_ROUTE on your end. Although, you would know better what are limits of your cluster/queues depending what hardware resources you have attached to your local batch system. These settings basically help to avoid issues like running jobs infinitely until it reaches memory or CPU usage of the worker node - one never know what job you get doing any havoc at the site so you don&#39;t want to risk your system get on knees due one silly job so reasonable limits is always good to have.
However, you can always define limit per ENTRY_ROUTE, of course! Best example how to configure is is here&#58; <a href='https&#58;//twiki.opensciencegrid.org/bin/view/Documentation/Release3/JobRouterRecipes#Setting_a_default' target='_blank' rel='nofollow'>https&#58;//twiki.opensciencegrid.org/bin/view/Documentation/Release3/JobRouterRecipes#Setting_a_default</a> ... I guess that is documentation you followed, so please consider what limits you want to give per job and set accordingly. For the glidein/Factory side we can set it, too.

-Marian

-- by Marian Zvada at Wed Mar 22 19&#58;00&#58;06 UTC 2017

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=126886' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=126886</a>
</div><script type='text/javascript'>
        $('#show_1863402613').click(function() {
            $('#detail_1863402613').slideDown("normal");
            $('#show_1863402613').hide();
            $('#hide_1863402613').show();
        });
        $('#hide_1863402613').click(function() {
            $('#detail_1863402613').slideUp();
            $('#hide_1863402613').hide();
            $('#show_1863402613').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='32862#1491239211'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-04-03T17:06:51+00:00">Apr 3, 2017 05:06 PM UTC</time> by <b>Vince Neal</b><a class="anchor" name="1491239211">&nbsp;</a></div><pre>Hi Mike,

The below document should assist with the syntax for the requested changes.

<a href='https&#58;//twiki.grid.iu.edu/bin/view/Documentation/Release3/JobRouterRecipes' target='_blank' rel='nofollow'>https&#58;//twiki.grid.iu.edu/bin/view/Documentation/Release3/JobRouterRecipes</a>

Please let me know if you have any questions.

Thank you,</pre></div><div class='update_description'><i onclick="document.location='32862#1490167389'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-03-22T07:23:09+00:00">Mar 22, 2017 07:23 AM UTC</time> by <b>mike_hutcheson@....</b><a class="anchor" name="1490167389">&nbsp;</a></div><pre>You’ll have to forgive me for being a bit slow on the uptake here.  In your message below, you refer to +maxMemory, +maxWallTime, +queue, and +xcount.  What is the syntax I would use in the JOB_ROUTER_ENTRIES ClassAds that I have specified in 99-local.conf?

Would I put, for example,

set_default_maxMemory = 14000;
set_default_maxWallTime =1440;
set_default_queue = moonshot; &#92; # For the moonshot ClassAd
set_default_xcount = 8;
…

Thanks for your help,

Mike</pre></div><div class='update_description'><i onclick="document.location='32862#1490124028'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-03-21T19:20:28+00:00">Mar 21, 2017 07:20 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1490124028">&nbsp;</a></div><pre>Hi,

as follow up on this ticket - it seems like the routes are pretty much very simple - Mike, are you sure you don&#39;t want to specify more details for them? If we have to add queue for matching on Factory entry we usually also specify few more attributes for pilot jobs, here an example&#58;
+maxMemory=14000
+maxWallTime=1440
+queue=xyz
+xcount=8

Reviewing Factory side there are at the moment two entries&#58;
1) CMS_T3_US_Baylor&#58; kodiak-ce.baylor.edu&#58;2119/jobmanager-pbs with (queue=batch)
2) CMS_T3_US_Baylor_moonshot&#58; kodiak-ce.baylor.edu kodiak-ce.baylor.edu&#58;961 (no queue defined, it may have vanished when changing from GRAM-CE configuration as Jeff poited out earlier - anyway, I just added +queue=moonshot in the Factory to match HTCondor-CE entry specification, currently without additional attributes mentioned as an example above, to be considered by Baylor folks if they want other limits per queue!)

I&#39;d suggest we try to sort out Condor-CE entry point (CMS_T3_US_Baylor_moonshot) as the GRAM-CE should be decommissioned already. Once we get that working we can migrate 1) into Condor-CE entry on the Factory side, too. We need to make sure jobs land on your end to requested queues.

As we&#39;re at it, Mike or Baylor Admins, I believe you have you gone trough initial recommended testing of you Condor-CE setup? Useful tools like  condor_ce_run, condor_ce_trace, condor_submit might significantly help to move forward&#58;
<a href='https&#58;//twiki.opensciencegrid.org/bin/view/Documentation/Release3/TroubleshootingHTCondorCE#HTCondor_CE_Troubleshooting_Tool' target='_blank' rel='nofollow'>https&#58;//twiki.opensciencegrid.org/bin/view/Documentation/Release3/TroubleshootingHTCondorCE#HTCondor_CE_Troubleshooting_Tool</a>

Also, besides JobRouter config could you send output of &#96;condor_ce_job_router_info -config&#96;.

Hope this helps.

Thanks,
Marian

-- by Marian Zvada at Tue Mar 21 17&#58;01&#58;08 UTC 2017

This is what I have in /etc/condor-ce/config.d/99-local.conf.  Does it look correct?  How does the router know which queue to actually send the job to?

# Route glidein jobs to their respective queues
JOB_ROUTER_ENTRIES = &#92;
[ &#92;
# Route to queue called moonshot &#92;
GridResource = &#34;batch pbs&#34;; &#92;
TargetUniverse = 9; &#92;
name = &#34;Local_PBS_moonshot&#34;; &#92;
<div id='show_1615080224' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_1615080224'>Requirements = (TARGET.queue =?= &#34;moonshot&#34;); &#92;
] &#92;
[ &#92;
# Route to queue called dellblades &#92;
GridResource = &#34;batch pbs&#34;; &#92;
TargetUniverse = 9; &#92;
name = &#34;Local_PBS_dellblades&#34;; &#92;
Requirements = (TARGET.queue =?= &#34;dellblades&#34;); &#92;
] &#92;
[ &#92;
# Route to queue called batch &#92;
GridResource = &#34;batch pbs&#34;; &#92;
TargetUniverse = 9; &#92;
name = &#34;Local_PBS_batch&#34;; &#92;
Requirements = (TARGET.queue =?= &#34;batch&#34;); &#92;
]

On 3/16/17, 3&#58;33 PM, &#34;helpdesk@....&#34; &#60;helpdesk@....&#62; wrote&#58;

Hello,

GGUS Ticket #126886 was updated.
You receive this mail in CC for your information.

REFERENCE LINK&#58; <a href='https&#58;//ggus.eu/index.php?mode=ticket_info&ticket_id=126886' target='_blank' rel='nofollow'>https&#58;//ggus.eu/index.php?mode=ticket_info&ticket_id=126886</a>
SUBJECT&#58; T3_US_Baylor&#58; Submit SAM tests to HTCondorCE

=====================
LATEST MODIFICATIONS&#58;

LAST MODIFIER -&#62; Marty Kandes

PUBLIC DIARY -&#62;
Mike,

Thanks. Let us know when you have the job route / queues setup. We&#39;ll have to add them into the factory configuration too.

Marty Kandes
UCSD Glidein Factory Operations

*********************************************************************************
This is an automated mail. When replying don&#39;t change the subject line!
S T R I P  P R E V I O U S  M A I L S please!!
*********************************************************************************

-- by Hutcheson, Mike at Fri Mar 17 20&#58;39&#58;45 UTC 2017

Mike,

Thanks. Let us know when you have the job route / queues setup. We&#39;ll have to add them into the factory configuration too.

Marty Kandes
UCSD Glidein Factory Operations

-- by Marty Kandes at Thu Mar 16 20&#58;32&#58;51 UTC 2017

I’ll get them set up.

Thanks!

Mike

On 3/15/17, 5&#58;18 PM, &#34;helpdesk@....&#34; &#60;helpdesk@....&#62; wrote&#58;

Hello,

GGUS Ticket #126886 was updated.
You receive this mail in CC for your information.

REFERENCE LINK&#58; <a href='https&#58;//ggus.eu/index.php?mode=ticket_info&ticket_id=126886' target='_blank' rel='nofollow'>https&#58;//ggus.eu/index.php?mode=ticket_info&ticket_id=126886</a>
SUBJECT&#58; T3_US_Baylor&#58; Submit SAM tests to HTCondorCE

=====================
LATEST MODIFICATIONS&#58;

LAST MODIFIER -&#62; Marty Kandes

PUBLIC DIARY -&#62;
Hi Baylor admins,

Here [1] is the documentation for configuring your HTCondor-CE job router with the different &#34;queues&#34; we may need to target from the factory side. Once these are in place in CE, we can proceed with testing new entries.

Marty Kandes
UCSD Glidein Factory Operations

[1]

<a href='https&#58;//twiki.opensciencegrid.org/bin/view/Documentation/Release3/JobRouterRecipes#Glidein_queue' target='_blank' rel='nofollow'>https&#58;//twiki.opensciencegrid.org/bin/view/Documentation/Release3/JobRouterRecipes#Glidein_queue</a>

*********************************************************************************
This is an automated mail. When replying don&#39;t change the subject line!
S T R I P  P R E V I O U S  M A I L S please!!
*********************************************************************************

-- by Hutcheson, Mike at Wed Mar 15 22&#58;22&#58;40 UTC 2017

Hi Baylor admins,

Here [1] is the documentation for configuring your HTCondor-CE job router with the different &#34;queues&#34; we may need to target from the factory side. Once these are in place in CE, we can proceed with testing new entries.

Marty Kandes
UCSD Glidein Factory Operations

[1]

<a href='https&#58;//twiki.opensciencegrid.org/bin/view/Documentation/Release3/JobRouterRecipes#Glidein_queue' target='_blank' rel='nofollow'>https&#58;//twiki.opensciencegrid.org/bin/view/Documentation/Release3/JobRouterRecipes#Glidein_queue</a>

-- by Marty Kandes at Wed Mar 15 22&#58;17&#58;49 UTC 2017

Hi,

I&#39;d like to back up because I think we need some clarification.  First, yes, we originally had 2 entries pointing to the same CE, but they were directed to 2 different queues&#58;
CMS_T3_US_Baylor (queue=batch)
CMS_T3_US_Baylor_moonshot (queue=moonshot)

From what I can tell, Amjad updated the moonshot entry to condor ce, but we lost the queue=moonshot specification. Baylor admins, do you have your job router correctly set up to submit to different queues?  That would imply we need to add a condor submit attribute, something like
+queue &#34;moonshot&#34;

in our entry.  But we don&#39;t currently have that set.

Also, it looks like CMS_T3_US_Baylor  hasn&#39;t been touched and is still submitting to gram5.

Please let us know how we should select moonshot vs the &#34;batch&#34; queue in our attributes, and we will correct this accordingly.  Also it sounds like if I understood update#6 correctly, we should disable cms submission to the &#34;batch&#34; queue since it is now rhel7.

Do I have all this correct?

Thanks,
Jeff Dost
OSG Glidein Factory Operations

-- by Jeffrey Dost at Mon Mar 13 22&#58;19&#58;33 UTC 2017

Thanks Amjad!

Ahh, now i see&#58; moonshot uses the same host as CMS_T3_US_Baylor.
We are not setup for multiple CEs (and of different types) on the
same host. I have to think what to do here.
The CMS_T3_US_Baylor entry is now CentOS 7, if i understood Ken
correctly. Could we disable it for the time being?

Thanks,
cheers,  Stephan

-- by Stephan Lammel at Mon Mar 13 21&#58;26&#58;11 UTC 2017

Hi,

I checked three factories and entry is updated

1. <a href='http&#58;//glidein.grid.iu.edu/factory/monitor/factoryEntryStatusNow.html?entry=CMS_T3_US_Baylor_moonshot' target='_blank' rel='nofollow'>http&#58;//glidein.grid.iu.edu/factory/monitor/factoryEntryStatusNow.html?entry=CMS_T3_US_Baylor_moonshot</a>
2. <a href='http&#58;//gfactory-1.t2.ucsd.edu/factory/monitor/factoryEntryStatusNow.html?entry=CMS_T3_US_Baylor_moonshot' target='_blank' rel='nofollow'>http&#58;//gfactory-1.t2.ucsd.edu/factory/monitor/factoryEntryStatusNow.html?entry=CMS_T3_US_Baylor_moonshot</a>
3. <a href='http&#58;//vocms0805.cern.ch/monitor/factoryEntryStatusNow.html?entry=CMS_T3_US_Baylor_moonshot' target='_blank' rel='nofollow'>http&#58;//vocms0805.cern.ch/monitor/factoryEntryStatusNow.html?entry=CMS_T3_US_Baylor_moonshot</a>

Cheers
Amjad

-- by Amjad kotobi at Mon Mar 13 21&#58;06&#58;55 UTC 2017

Hi Stephan,
Thank you. I see. Is there anything we have to do from the Baylor side? Or, we just need to wait?
Ken

-- by Kenichi Hatakeyama at Mon Mar 13 20&#58;53&#58;38 UTC 2017

Hallo Ken,
this is probably because the CERN and OSG factories still have
GT5 entries. So there are double VO-feed entries for kodiak-ce
right now, with both GLOBUS and HTCONDOR-CE.
Thanks,
cheers,  Stephan

-- by Stephan Lammel at Mon Mar 13 20&#58;47&#58;20 UTC 2017

I created a /data3/cms_workdir that could be used by all of the jobs.

On 3/13/17, 2&#58;10 PM, &#34;helpdesk@....&#34; &#60;helpdesk@....&#62; wrote&#58;

Hello,

GGUS Ticket #126886 was updated.
You receive this mail in CC for your information.

REFERENCE LINK&#58; <a href='https&#58;//ggus.eu/index.php?mode=ticket_info&ticket_id=126886' target='_blank' rel='nofollow'>https&#58;//ggus.eu/index.php?mode=ticket_info&ticket_id=126886</a>
SUBJECT&#58; T3_US_Baylor&#58; Submit SAM tests to HTCondorCE

=====================
LATEST MODIFICATIONS&#58;

LAST MODIFIER -&#62; Kenichi Hatakeyama

PUBLIC DIARY -&#62;
Thank you. All sound good.

Now, I see kodiak-ce.baylor.edu line with HTCondorCE on&#58;
<a href='http&#58;//wlcg-sam-cms.cern.ch/templates/ember/#/plot?group=AllGroups&profile=CMS_CRITICAL_FULL&sites=T3_US_Baylor' target='_blank' rel='nofollow'>http&#58;//wlcg-sam-cms.cern.ch/templates/ember/#/plot?group=AllGroups&profile=CMS_CRITICAL_FULL&sites=T3_US_Baylor</a>
but it says &#34;MISSING&#34;. We will keep eyes on it.

We also want to add one more entry point for queue &#34;dellblades&#34; running centos6, but it seems that we have to sort out the tmp quota issues.

*********************************************************************************
This is an automated mail. When replying don&#39;t change the subject line!
S T R I P  P R E V I O U S  M A I L S please!!
*********************************************************************************

-- by Hutcheson, Mike at Mon Mar 13 19&#58;38&#58;38 UTC 2017

Thank you. All sound good.

Now, I see kodiak-ce.baylor.edu line with HTCondorCE on&#58;
<a href='http&#58;//wlcg-sam-cms.cern.ch/templates/ember/#/plot?group=AllGroups&profile=CMS_CRITICAL_FULL&sites=T3_US_Baylor' target='_blank' rel='nofollow'>http&#58;//wlcg-sam-cms.cern.ch/templates/ember/#/plot?group=AllGroups&profile=CMS_CRITICAL_FULL&sites=T3_US_Baylor</a>
but it says &#34;MISSING&#34;. We will keep eyes on it.

We also want to add one more entry point for queue &#34;dellblades&#34; running centos6, but it seems that we have to sort out the tmp quota issues.

-- by Kenichi Hatakeyama at Mon Mar 13 19&#58;10&#58;56 UTC 2017

Hi,

Entry&#39;s gate keeper for T3_US_Baylor_moonshot changed to HTCondor CE, just a summery from previous diaries, There are two entries 1) T3_US_Baylor 2) T3_US_Baylor_moonshot, at the moment &#34;*_moonshot&#34; queue is on CentOS 6 WNs and another CentOS 7, also &#34;*_moonshot&#34; has enough space per core. On April an entry with CentOS 7 queue will be updated.

All the changes applied on T3_US_Baylor_moonshot over factories.

Cheers
Amjad

-- by Amjad kotobi at Mon Mar 13 17&#58;59&#58;52 UTC 2017

Each Moonshot node has 8 cores, so 8 * 20GB will easily fit in /tmp.  The dellblades nodes, however, have 16 cores (32 with HT enabled), 16 * 20 &#62; 170GB, so /tmp on those is not enough space.

On 3/13/17, 10&#58;46 AM, &#34;helpdesk@....&#34; &#60;helpdesk@....&#62; wrote&#58;

Hello,

GGUS Ticket #126886 was updated.
You receive this mail in CC for your information.

REFERENCE LINK&#58; <a href='https&#58;//ggus.eu/index.php?mode=ticket_info&ticket_id=126886' target='_blank' rel='nofollow'>https&#58;//ggus.eu/index.php?mode=ticket_info&ticket_id=126886</a>
SUBJECT&#58; T3_US_Baylor&#58; Submit SAM tests to HTCondorCE

=====================
LATEST MODIFICATIONS&#58;

LAST MODIFIER -&#62; Kenichi Hatakeyama

PUBLIC DIARY -&#62;
Hi Mike,

As far as I can tell, /tmp of our worker node is a part of the root file system and we have &#62;150 GB after checking a few worker nodes.

HP moonshot&#58;
[hatake@m002 ~]$ df -h
Filesystem          Size  Used Avail Use% Mounted on
/dev/sda3           454G  9.1G  422G   3% /              ===&#62; this one counts, right?
tmpfs                16G     0   16G   0% /dev/shm
(truncated...)

Dell blades&#58;
[hatake@n137 ~]$ df -h
Filesystem            Size  Used Avail Use% Mounted on
/dev/mapper/VolGroup-root_lv
198G   18G  170G  10% /            ===&#62; this one counts, right?
tmpfs                  16G     0   16G   0% /dev/shm
(truncated...)

So, /tmp seems fine to me. What do you think?

*********************************************************************************
This is an automated mail. When replying don&#39;t change the subject line!
S T R I P  P R E V I O U S  M A I L S please!!
*********************************************************************************

-- by Hutcheson, Mike at Mon Mar 13 16&#58;56&#58;51 UTC 2017

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=126886' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=126886</a>
</div><script type='text/javascript'>
        $('#show_1615080224').click(function() {
            $('#detail_1615080224').slideDown("normal");
            $('#show_1615080224').hide();
            $('#hide_1615080224').show();
        });
        $('#hide_1615080224').click(function() {
            $('#detail_1615080224').slideUp();
            $('#hide_1615080224').hide();
            $('#show_1615080224').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='32862#1489423225'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-03-13T16:40:25+00:00">Mar 13, 2017 04:40 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1489423225">&nbsp;</a></div><pre>Hi Amjad,

If Baylor has an HTCondor batch system behind the HTCondor-CE, then you can set work_dir=&#34;Condor&#34;. For example, see the UCSD entries. However, if they are using a non-HTCondor batch system (such as PBS, SLURM, etc), then we typically set work_dir=&#34;OSG&#34; here. For example, see Vanderbilt entries.

Since it sounds like they&#39;ve properly worker_node_temp variable in 10-storage.ini, setting work_dir=&#34;OSG&#34; should translate this to /tmp correctly when the glideins see the OSG_WN_TMP environment variable at the site.

Hope that explanation helps.

Marty Kandes
UCSD Glidein Factory Operations

P.S. You can remove the GlueCEUniqueID lines for HTCondor-CE entries.

-- by Marty Kandes at Mon Mar 13 16&#58;14&#58;01 UTC 2017

Hi Mike,

As far as I can tell, /tmp of our worker node is a part of the root file system and we have &#62;150 GB after checking a few worker nodes.

HP moonshot&#58;
[hatake@m002 ~]$ df -h
Filesystem          Size  Used Avail Use% Mounted on
/dev/sda3           454G  9.1G  422G   3% /              ===&#62; this one counts, right?
tmpfs                16G     0   16G   0% /dev/shm
(truncated...)

Dell blades&#58;
[hatake@n137 ~]$ df -h
Filesystem            Size  Used Avail Use% Mounted on
/dev/mapper/VolGroup-root_lv
198G   18G  170G  10% /            ===&#62; this one counts, right?
tmpfs                  16G     0   16G   0% /dev/shm
(truncated...)

So, /tmp seems fine to me. What do you think?
<div id='show_1940459904' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_1940459904'>
-- by Kenichi Hatakeyama at Mon Mar 13 15&#58;46&#58;42 UTC 2017

On the Moonshot worker nodes, yes.  On the dellblade nodes, no.

Sent from my iPhone

<font color='#7F7E6F'>&#62; On Mar 13, 2017, at 10&#58;17 AM, &#34;helpdesk@....&#34; &#60;helpdesk@....&#62; wrote&#58;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; Hello,</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; GGUS Ticket #126886 was updated.</font>
<font color='#7F7E6F'>&#62; You receive this mail in CC for your information.</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; REFERENCE LINK&#58; <a href='https&#58;//ggus.eu/index.php?mode=ticket_info&ticket_id=126886' target='_blank' rel='nofollow'>https&#58;//ggus.eu/index.php?mode=ticket_info&ticket_id=126886</a></font>
<font color='#7F7E6F'>&#62; SUBJECT&#58; T3_US_Baylor&#58; Submit SAM tests to HTCondorCE</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; =====================</font>
<font color='#7F7E6F'>&#62; LATEST MODIFICATIONS&#58;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; LAST MODIFIER -&#62; Stephan Lammel</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; PUBLIC DIARY -&#62;</font>
<font color='#7F7E6F'>&#62; Do you have 20 GBytes per core available in /tmp?   - Stephan</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; *********************************************************************************</font>
<font color='#7F7E6F'>&#62; This is an automated mail. When replying don&#39;t change the subject line!</font>
<font color='#7F7E6F'>&#62; S T R I P  P R E V I O U S  M A I L S please!!</font>
<font color='#7F7E6F'>&#62; *********************************************************************************</font>

-- by Hutcheson, Mike at Mon Mar 13 15&#58;34&#58;03 UTC 2017

/tmp is good too. &#58;-)

Sent from my iPhone

On Mar 13, 2017, at 9&#58;26 AM, Douglas Johnson &#60;Douglas.Johnson@....&#60;mailto&#58;Douglas.Johnson@....&#62;&#62; wrote&#58;

Greetings,

It looks to me like it is defined to be /tmp&#58;

[johnsond@kodiak-ce config.d]$ grep worker_node_temp 10-storage.ini
; The worker_node_temp directory should point to a directory that can be used
worker_node_temp = /tmp
[johnsond@kodiak-ce config.d]$ ls -al 10-storage.ini
-rw-r--r-- 1 root root 2925 Feb  8 21&#58;33 10-storage.ini

And from&#58;

<a href='http&#58;//is.grid.iu.edu/data/cemon_raw_incoming/kodiak-ce.baylor.edu' target='_blank' rel='nofollow'>http&#58;//is.grid.iu.edu/data/cemon_raw_incoming/kodiak-ce.baylor.edu</a>

GlueClusterWNTmpDir&#58; /tmp

I hope this helps,
doug

On Mon, Mar 13, 2017 at 6&#58;52 AM, &#60;helpdesk@....&#60;mailto&#58;helpdesk@....&#62;&#62; wrote&#58;
Hello,

GGUS Ticket #126886 was updated.
You receive this mail in CC for your information.

REFERENCE LINK&#58; <a href='https&#58;//ggus.eu/index.php?mode=ticket_info&ticket_id=126886' target='_blank' rel='nofollow'>https&#58;//ggus.eu/index.php?mode=ticket_info&ticket_id=126886</a>
SUBJECT&#58; T3_US_Baylor&#58; Submit SAM tests to HTCondorCE

=====================
LATEST MODIFICATIONS&#58;

LAST MODIFIER -&#62; Kenichi Hatakeyama

PUBLIC DIARY -&#62;
Hi Amjad,

I think the work_dir hasn&#39;t changed, but probably it&#39;s good to get confirmation from Mike_Hutcheson@....&#60;mailto&#58;Mike_Hutcheson@....&#62; or uscms-tier3-team@....&#60;mailto&#58;uscms-tier3-team@....&#62; members who helped setting up HTCondorCE...

Ken

*********************************************************************************
This is an automated mail. When replying don&#39;t change the subject line!
S T R I P  P R E V I O U S  M A I L S please!!
*********************************************************************************

--
---------------------------------------------------------------------------------
Doug Johnson                    email&#58; drjohn@....&#60;mailto&#58;drjohn@....&#62;
B390, Duane Physics             (303)-492-4506 Office
Boulder, CO 80309               (303)-492-5119 FAX
<a href='http&#58;//www.aaccchildren.org' target='_blank' rel='nofollow'>http&#58;//www.aaccchildren.org</a>
<a href='http&#58;//www.bouldernablus.com' target='_blank' rel='nofollow'>http&#58;//www.bouldernablus.com</a>
<a href='http&#58;//advance.colorado.edu/support/fulbright&#60' target='_blank' rel='nofollow'>http&#58;//advance.colorado.edu/support/fulbright&#60</a>;<a href='http&#58;//www-hep.colorado.edu/support/fulbright&#62' target='_blank' rel='nofollow'>http&#58;//www-hep.colorado.edu/support/fulbright&#62</a>;

No one can everything, but everyone can do something
----------------------------------------------------------------------------

-- by Hutcheson, Mike at Mon Mar 13 15&#58;27&#58;19 UTC 2017

Do you have 20 GBytes per core available in /tmp?   - Stephan

-- by Stephan Lammel at Mon Mar 13 15&#58;15&#58;25 UTC 2017

Thank you Doug. Amjad, can you go ahead with this info?

Ken

-- by Kenichi Hatakeyama at Mon Mar 13 14&#58;33&#58;57 UTC 2017

Greetings,

It looks to me like it is defined to be /tmp&#58;

[johnsond@kodiak-ce config.d]$ grep worker_node_temp 10-storage.ini
; The worker_node_temp directory should point to a directory that can be
used
worker_node_temp = /tmp
[johnsond@kodiak-ce config.d]$ ls -al 10-storage.ini
-rw-r--r-- 1 root root 2925 Feb  8 21&#58;33 10-storage.ini

And from&#58;

<a href='http&#58;//is.grid.iu.edu/data/cemon_raw_incoming/kodiak-ce.baylor.edu' target='_blank' rel='nofollow'>http&#58;//is.grid.iu.edu/data/cemon_raw_incoming/kodiak-ce.baylor.edu</a>

GlueClusterWNTmpDir&#58; /tmp

I hope this helps,
doug

On Mon, Mar 13, 2017 at 6&#58;52 AM, &#60;helpdesk@....&#62; wrote&#58;

<font color='#7F7E6F'>&#62; Hello,</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; GGUS Ticket #126886 was updated.</font>
<font color='#7F7E6F'>&#62; You receive this mail in CC for your information.</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; REFERENCE LINK&#58; <a href='https&#58;//ggus.eu/index.php?mode=ticket_info&ticket_id=' target='_blank' rel='nofollow'>https&#58;//ggus.eu/index.php?mode=ticket_info&ticket_id=</a></font>
<font color='#7F7E6F'>&#62; 126886</font>
<font color='#7F7E6F'>&#62; SUBJECT&#58; T3_US_Baylor&#58; Submit SAM tests to HTCondorCE</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; =====================</font>
<font color='#7F7E6F'>&#62; LATEST MODIFICATIONS&#58;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; LAST MODIFIER -&#62; Kenichi Hatakeyama</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; PUBLIC DIARY -&#62;</font>
<font color='#7F7E6F'>&#62; Hi Amjad,</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; I think the work_dir hasn&#39;t changed, but probably it&#39;s good to get</font>
<font color='#7F7E6F'>&#62; confirmation from Mike_Hutcheson@.... or uscms-tier3-team@....</font>
<font color='#7F7E6F'>&#62; members who helped setting up HTCondorCE...</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; Ken</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; ************************************************************</font>
<font color='#7F7E6F'>&#62; *********************</font>
<font color='#7F7E6F'>&#62;  This is an automated mail. When replying don&#39;t change the subject line!</font>
<font color='#7F7E6F'>&#62;  S T R I P  P R E V I O U S  M A I L S please!!</font>
<font color='#7F7E6F'>&#62; ************************************************************</font>
<font color='#7F7E6F'>&#62; *********************</font>
<font color='#7F7E6F'>&#62;</font>

--
---------------------------------------------------------------------------------
Doug Johnson                    email&#58; drjohn@....

B390, Duane Physics             (303)-492-4506 Office

Boulder, CO 80309               (303)-492-5119 FAX

<a href='http&#58;//www.aaccchildren.org' target='_blank' rel='nofollow'>http&#58;//www.aaccchildren.org</a>

<a href='http&#58;//www.bouldernablus.com' target='_blank' rel='nofollow'>http&#58;//www.bouldernablus.com</a>

<a href='http&#58;//advance.colorado.edu/support/fulbright' target='_blank' rel='nofollow'>http&#58;//advance.colorado.edu/support/fulbright</a>
&#60;<a href='http&#58;//www-hep.colorado.edu/support/fulbright&#62' target='_blank' rel='nofollow'>http&#58;//www-hep.colorado.edu/support/fulbright&#62</a>;

No one can everything, but everyone can do something
----------------------------------------------------------------------------

-- by Douglas Johnson at Mon Mar 13 14&#58;26&#58;42 UTC 2017

Okay. We will try to get back to you as soon as we can.

-- by Kenichi Hatakeyama at Mon Mar 13 13&#58;15&#58;04 UTC 2017

Hi Ken,

So I will wait for their confirmation before apply changes.

Cheers
Amjad

-- by Amjad kotobi at Mon Mar 13 12&#58;57&#58;21 UTC 2017

Hi Amjad,

I think the work_dir hasn&#39;t changed, but probably it&#39;s good to get confirmation from Mike_Hutcheson@.... or uscms-tier3-team@.... members who helped setting up HTCondorCE...

Ken

-- by Kenichi Hatakeyama at Mon Mar 13 12&#58;51&#58;42 UTC 2017

Hello Ken,

I checked entry for T3_US_Baylor, Just for double checking,  for your HTCondor CE are you still using   &#60;work_dir=&#34;.&#34;&#62; on this path or changed, because some sites using work_dir=&#34;condor&#34; with HTCondor CE. If it has not changed so I will proceed to make changes on this entry.

Cheers
Amjad

CERN GlideinWMS Factory Operation

-- by Amjad kotobi at Mon Mar 13 11&#58;12&#58;41 UTC 2017

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=126886' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=126886</a>
</div><script type='text/javascript'>
        $('#show_1940459904').click(function() {
            $('#detail_1940459904').slideDown("normal");
            $('#show_1940459904').hide();
            $('#hide_1940459904').show();
        });
        $('#hide_1940459904').click(function() {
            $('#detail_1940459904').slideUp();
            $('#hide_1940459904').hide();
            $('#show_1940459904').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='32862#1489259349'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-03-11T19:09:09+00:00">Mar 11, 2017 07:09 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1489259349">&nbsp;</a></div><pre>Hallo Ken,
the frontends will request pilots for all the enabled factory
entries. The maximum number of runing/queuing glidein are set per
factory entry. So, i think it should do what you want. (There is
no default queue/entry, on factory side entries are comparable.)
Factory and/or SI teams are the experts and will help you set
things properly.
Thanks,
cheers,  Stephan

-- by Stephan Lammel at Sat Mar 11 18&#58;34&#58;21 UTC 2017

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=126886' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=126886</a></pre></div><div class='update_description'><i onclick="document.location='32862#1489259297'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-03-11T19:08:17+00:00">Mar 11, 2017 07:08 PM UTC</time><a class="anchor" name="1489259297">&nbsp;</a></div><pre>Hello, Stephan,

Sounds good. Thank you. I will wait to hear from the glidein factory team.

Best,
Ken

Hallo Ken,
the frontends will request pilots for all the enabled factory
entries. The maximum number of runing/queuing glidein are set per
factory entry. So, i think it should do what you want. (There is
no default queue/entry, on factory side entries are comparable.)
Factory and/or SI teams are the experts and will help you set
things properly.
Thanks,
cheers,  Stephan

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=hatake/CN=661802/CN=Kenichi Hatakeyama</pre></div><div class='update_description'><i onclick="document.location='32862#1489252929'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-03-11T17:22:09+00:00">Mar 11, 2017 05:22 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1489252929">&nbsp;</a></div><pre>Hallo Ken,
yes. CMS does not yet use CentOS7 but requires all worker nodes
to be SL6 (or CentOS7 with SL6 container/VM/etc.) We expect this
to change in April (then CMS pilots will run containers to provide
the OS flavour needed).
May be we should disable the CentOS7 queue until then, update
&#34;moonshot&#34; and add entries for the two additional queues.
Thanks,
cheers,  Stephan

-- by Stephan Lammel at Fri Mar 10 23&#58;19&#58;57 UTC 2017

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=126886' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=126886</a></pre></div><div class='update_description'><i onclick="document.location='32862#1489252915'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-03-11T17:21:55+00:00">Mar 11, 2017 05:21 PM UTC</time><a class="anchor" name="1489252915">&nbsp;</a></div><pre>Dear Stephan,

I still cannot write directly to GGUS ticket directly (I think I requested a right to be able to write and waiting for the response), so i am writing via <a href='https&#58;//ticket.opensciencegrid.org/32862.' target='_blank' rel='nofollow'>https&#58;//ticket.opensciencegrid.org/32862.</a> I think what you says makes sense, i.e. disabling the default queue for centos7, and only utilize centos6 queues for now. Can I assume that the glidein factory will distribute jobs coming to &#34;T3_US_Baylor&#34; to different centos6 queues, and it&#39;s not a problem even if the default queue (which is for centos7) is disabled until April or so (when CMS pilots will start running containers to provide the necessary OS flavor).

Ken

+++++

Hallo Ken,
yes. CMS does not yet use CentOS7 but requires all worker nodes
to be SL6 (or CentOS7 with SL6 container/VM/etc.) We expect this
to change in April (then CMS pilots will run containers to provide
the OS flavour needed).
May be we should disable the CentOS7 queue until then, update
&#34;moonshot&#34; and add entries for the two additional queues.
Thanks,
cheers, Stephan

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=hatake/CN=661802/CN=Kenichi Hatakeyama</pre></div><div class='update_description'><i onclick="document.location='32862#1489186869'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-03-10T23:01:09+00:00">Mar 10, 2017 11:01 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1489186869">&nbsp;</a></div><pre>Changed CC to uscms-tier3-team@....; Mike_Hutcheson@....; lammel@....;

-- by Stephan Lammel at Thu Mar 09 17&#58;14&#58;29 UTC 2017

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=126886' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=126886</a></pre></div><div class='update_description'><i onclick="document.location='32862#1489186826'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-03-10T23:00:26+00:00">Mar 10, 2017 11:00 PM UTC</time><a class="anchor" name="1489186826">&nbsp;</a></div><pre>Thank you. So, it seems that we are waiting for the CMS Glidein factory team to make the switch.

If they make a switch, is the change going to show up at&#58;
[1] <a href='http&#58;//gfactory-1.t2.ucsd.edu/factory/monitor/factoryEntryStatusNow.html?entry=CMS_T3_US_Baylor' target='_blank' rel='nofollow'>http&#58;//gfactory-1.t2.ucsd.edu/factory/monitor/factoryEntryStatusNow.html?entry=CMS_T3_US_Baylor</a>
[2] <a href='http&#58;//gfactory-1.t2.ucsd.edu/factory/monitor/factoryEntryStatusNow.html?entry=CMS_T3_US_Baylor_moonshot' target='_blank' rel='nofollow'>http&#58;//gfactory-1.t2.ucsd.edu/factory/monitor/factoryEntryStatusNow.html?entry=CMS_T3_US_Baylor_moonshot</a>

Right now both say&#58;
GridType&#58; gt5
GLIDEIN_GridType&#58; gt5
but they should say&#58; condor

and (GLIDEIN_)Gatekeeper also needs to change, is that right?

By the way, both [1] and [2] right now say GLIDEIN_REQUIRED_OS rhel6. This used to be true, but now [1] should probably switch to rhel7, as the worker nodes of the default batch switched from centos6 to centos7. The worker nodes of [2] remains rhel6 (actually centos6).

By the way, we have two other batch queues which use rhel6 (centos6) and we can get the CMS jobs run. The batch name is &#34;dellblades&#34; (13 nodes, 16 or 20 cores each) and &#34;hep&#34; (1 dell blade, 20 cores).

The plan is that, after we set up [1] to work with singularity or something similar, we will upgrade all worker nodes and queues to centos7. We are keeping a few batch system worker nodes to centos6 for CMS jobs.

Thank you for all your help.

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=hatake/CN=661802/CN=Kenichi Hatakeyama</pre></div><div class='update_description'><i onclick="document.location='32862#1489079457'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-03-09T17:10:57+00:00">Mar 9, 2017 05:10 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1489079457">&nbsp;</a></div><pre>Notified CMS Glidein Factory team of this ticket.Baylor changed the CE, kodiak-ce.baylor.edu, from Globus to HTCondor-CE.
Could the factory entry please be changed? Thanks,
- Stephan
Flushed field &#39;Notify Site&#39;
Changed problem type to&#58; Configuration

-- by Stephan Lammel at Thu Mar 09 17&#58;10&#58;33 UTC 2017

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=126886' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=126886</a></pre></div><div class='update_description'><i onclick="document.location='32862#1488974649'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-03-08T12:04:09+00:00">Mar 8, 2017 12:04 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1488974649">&nbsp;</a></div><pre>Kenichi Hatakeyama has subscribed to this ticket.

-- by Kenichi Hatakeyama at Wed Mar 08 11&#58;45&#58;15 UTC 2017

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=126886' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=126886</a></pre></div><div class='update_description'><i onclick="document.location='32862#1488974640'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-03-08T12:04:00+00:00">Mar 8, 2017 12:04 PM UTC</time><a class="anchor" name="1488974640">&nbsp;</a></div><pre>Greetings,

I was wondering if anybody is looking at this ticket.

The issue is, although we think T3_US_Baylor has moved toHTCondorCE, the SAM test still considers the flavor of our CE as GLOBUS.
<a href='http&#58;//wlcg-sam-cms.cern.ch/templates/ember/#/plot?group=AllGroups&profile=CMS_CRITICAL_FULL&sites=T3_US_Baylor' target='_blank' rel='nofollow'>http&#58;//wlcg-sam-cms.cern.ch/templates/ember/#/plot?group=AllGroups&profile=CMS_CRITICAL_FULL&sites=T3_US_Baylor</a>

Is there a step we are missing on our side? Or, the SAM test admin has to do manually adjust this?

Thank you.
Ken

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=hatake/CN=661802/CN=Kenichi Hatakeyama</pre></div><div class='update_description'><i onclick="document.location='32862#1488382366'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-03-01T15:32:46+00:00">Mar 1, 2017 03:32 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1488382366">&nbsp;</a></div><pre>Greetings,

The site T3_US_Baylor has upgraded their CE to HTCondorCE. Please switch the CMS SAM tests submission from Globus to HTCondorCE.

Thank you,
doug
Affected Site&#58; Baylor-Tier3

[Ticket Origin]
<a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=126886' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=126886</a>

[Ticket History]
Subject&#58; T3_US_Baylor&#58; Submit SAM tests to HTCondorCE
Ticket Type&#58; USER
CC&#58; uscms-tier3-team@....; Mike_Hutcheson@....;
-- by Douglas Johnson at Wed Mar 01 15&#58;22&#58;49 UTC 2017

-- by Miroslav Mares at Wed Mar 01 15&#58;32&#58;19 UTC 2017</pre></div><legend>Similar Recent Tickets <small>modified within the last 30 days</small></legend><div id="similar_tickets"><p class="muted">No similar tickets found.</p></div>
</div>
<script type="text/javascript">
function reset_anchor() {
    $("#updates .selected").removeClass("selected");
    var urls = document.location.toString().split('#'); 
    var anchor = urls[1];
    if(anchor) {
        $("a[name='"+anchor+"']").parents(".update_description").addClass("selected");
    }
}
function submitspam(ticket_id) {
    myret = confirm("Would you like to close this ticket as a security ticket, and submit the ticket content to akismet?");
    if(myret == true) {
        $.ajax("viewer/processspam?id="+ticket_id).done(function() {
            window.location.reload();
        });
    }
}

$(function() {
    reset_anchor();
    var ADDITIONAL_COOKIE_NAME = 'gocticket';
    var options = { path: '/', expires: 365};

    if(window.opener && window.opener.name == "gocticket_list") {
        v = $.cookie("closewindow");
        if(!v) {
            $("#closewindow").attr("checked", "checked"); //on by default
        } else {
            if(v == "checked") {
                $("#closewindow").attr("checked", "checked");
            }
        }
        $("#closewindow").click(function() {
            $.cookie("closewindow", $(this).attr('checked'), options);
        });
    } else {
        $("#closewindow_area").hide();
    }
    function updateTimeago() {
        $("time").timeago();
        setTimeout(updateTimeago, 30*1000);
    }
    updateTimeago();
    $(".description").focus(expand_description);
});
</script>
<hr/>
<footer>
<p>GOC Ticket Version 2.2 | <a href="https://ticket.opensciencegrid.org/goc/submit?app_issue_check=on&amp;app_issue_type=goc&amp;app_goc_url=https%3A%2F%2Fticket.opensciencegrid.org%3A443%2F32862">Report Bugs</a>
 | <a href="https://github.com/opensciencegrid/operations/blob/master/docs/privacy.md">Privacy Policy</a>
</p>

<p> <img align="top" src="images/tag_orange.png"/> Copyright 2018 The Trustees of Indiana University - Developed for Open Science Grid</p>
</footer>


</div><!--container-fluid-->
<script src="https://ticket1.grid.iu.edu:8443/socket.io/socket.io.js"></script>
<script>
var chat = io.connect('https://ticket1.grid.iu.edu:8443');
chat.on('connect', function() {
    chat.emit('authenticate', {nodekey:'', ticketid: 32862});
});
chat.on('peers', function(peers) {
    $("#peers").html("");
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('peer_disconnect', function(pid) {
    $("#peer_"+pid).hide("slow");
});
chat.on('peer_connected', function(peers) {
    //expect only 1 peer connecting, but..
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('submit', function() {
    if(confirm("This ticket was updated. Do you want to refresh?")) {
        history.go(0);
    }
});

function addPeer(pid, peer) {
    var ipinfo = "";
    if(peer.ip != undefined) {
        ipinfo = "<span class=\"ip\">"+peer.ip+"</span>";
    }
    if(chat.io.engine.id == pid) {
        //don't display myself
        return;
    }
    var html = "<li class=\"new\" id=\"peer_"+pid+"\" class=\"peer\">"+peer.name+ipinfo+"</li>";
    $("#peers").prepend(html);
    $("#peers .new").animate({bottom: 0}, 1000, function() {$(this).removeClass("new")});
}

$(function() {
    $("#ticket_form").submit(function() {
        chat.emit('submit');
        return true;
    });
});
</script>
<script>
//used by searchbox
function parseValue(value) {
    var obj = new Object();
    var tokens = value.split("\t");
    obj.str = tokens[0];
    obj.count = tokens[1];
    return obj;
}

$(function() {
    //bootstrap-2.0.4 stuff
    $(".alert-message").alert();
    $(".dropdown-toggle").dropdown();
    $("span[rel='tooltip']").tooltip();
    $("a[rel=popover]").popover();

    //activate menu that user is currently on
    $("#menu_navigator").addClass("active"); 
    $("#submenu_").addClass("active"); 

    //translate zend validation error message to bootstrap
    $(".errors").addClass("alert").addClass("alert-error");

    //enable autocomplete for search box
    $("#search").autocomplete({
        source: function( request, response ) {
            $.ajax({
                url: "search/autocomplete",
                dataType: "text",
                data: {
                    //featureClass: "P",
                    //style: "full",
                    //maxRows: 12,
                    //name_startsWith: request.term
                    q: request.term
                },
                success: function( data ) {
                    response( $.map( data.split("\n"), function( item ) {
                        if(item == "") return null;
                        return {
                            value: item
                        }
                    }));
                }
            });
        },
        select: function(event, ui) {
            document.location = "search?q="+ui.item.value;
        }
    });
    
});
</script>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-69012-13");
pageTracker._trackPageview();
} catch(err) {}
</script>

</body>
