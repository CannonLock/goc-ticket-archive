<!DOCTYPE html>
<html lang="en">
  <head>
  <base href="">
    <title>[35146] Event RabbitMQ records missing</title>    <meta charset="utf-8" />
    <meta name="verify-v1" content="na5IcAJsZVOfEkboRxuIiZ1zpZgnZiWra+nKcS7nA/o=" />
    <meta name="google-site-verification" content="DLrk3ft4s8b-S2TloLCL2LD_t6wcTjgSluf5pmiu2kA" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />
    <link href="https://ticket.opensciencegrid.org/rss" rel="alternate" type="application/rss+xml" title="GOC Ticket Update feed" />

    <style type="text/css">
      body {
        padding-top: 50px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
     #search {
            width: 300px;
     }

    </style>

<script src="https://code.jquery.com/jquery-3.0.0.js"></script>
<script src="https://code.jquery.com/jquery-migrate-3.0.1.js"></script>

   <link href="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet"/>
    <script src="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/js/bootstrap.min.js"></script>

    <link href="https://netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"/>
    <link href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/themes/smoothness/jquery-ui.min.css" rel="stylesheet"/>
 <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>


    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/js/select2.min.js"></script>

    <link href="css/ticket.css" rel="stylesheet" />
    <script src="lib/jquery.cookie.js"></script>

    <link href="images/tag_orange.png" rel="icon" type="image/png"/>
  </head>

  <body>
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>

            <a class="brand" style="padding: 6px 0px 0px 6px;" href="http://opensciencegrid.org"><img src="images/osglogo.40x30.png"/></a>
            <ul class="nav">
                <li class="dropdown"><a href="https://ticket.opensciencegrid.org/#" class="dropdown-toggle" data-toggle="dropdown">GOC Ticket <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    <li><a href="https://my.opensciencegrid.org">MyOSG</a></li>
                    <li><a href="https://oim.opensciencegrid.org">OIM</a></li>
                    <li class="active"><a href="https://ticket.opensciencegrid.org/index">Ticket</a></li>
	<li class="divider"></li>
	<li><a href="http://repo.grid.iu.edu">Repo</a></li>
	<li class="divider"></li>
	<li><a href="http://blogs.grid.iu.edu">Blog</a></li>
                    <li><a href="http://display.grid.iu.edu">Display</a></li>
                    <li><a href="http://osggoc.blogspot.com/">News</a></li>
                    </ul>
                </li>
            </ul>
            <ul class="nav pull-right">
                <li><a href="https://ticket.opensciencegrid.org/sso/">Login</a></li>            </ul>

            <div class="nav-collapse">
                <ul class="nav">
			 <li id="menu_submit"><a href="https://ticket.opensciencegrid.org/submit">Submit</a></li><li id="menu_view" class="dropdown"><a href="https://ticket.opensciencegrid.org/\#" class="dropdown-toggle" data-toggle="dropdown">View <b class="caret"></b></a><ul class="dropdown-menu"><li id="submenu_listopen"><a href="https://ticket.opensciencegrid.org/list/open">Open Tickets</a></li><li id="submenu_listrecentclose"><a href="https://ticket.opensciencegrid.org/list/recentclose">Recently Closed Tickets</a></li><li class="divider"></li><li id="submenu_alltickets"><a href="https://ticket.opensciencegrid.org/search?q=&amp;sort=id">All Tickets</a></li></ul></li>                </ul>

                <form class="navbar-search pull-right" action="https://ticket.opensciencegrid.org/viewer">
                    <input id="search" type="text" name="id" class="search-query span2" placeholder="Search Ticket" value=""/>
                </form>
            </div>
        </div>
      </div>
    </div>

<script type='text/javascript' src='lib/jquery.timeago.js'></script>
<script type='text/javascript' src='lib/byte2size.js'></script>
<style>
#updates .toolbar {
position: relative;
margin-top: 0px;
top: -10px;
font-weight: normal;
}
#updates a.anchor {
position: relative;
top: -50px;
}
#updates .selected pre {
animation:selected 2s;
animation-iteration-count: 2;
animation-direction: alternate;
-webkit-animation:selected 2s; 
-webkit-animation-iteration-count: 2;
-webkit-animation-direction: alternate;
box-shadow: inset 1px 1px 20px #9ad;
border: 1px solid #9ab;
margin: 5px 0px;
padding-left: 10px;
}
@keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ab;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
@-webkit-keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ad;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
#updates pre {
background-color: inherit;
line-height: 15px;
padding: 5px;
}
#updates .header {
color: #999;
}
#updates .update_history pre {
background-color: #eee;
color: #666;
font-size: 85%;
}
#updates .clickable {
cursor: pointer;
}
#updates .clickable:hover {
color: #D98719;
}
#updates .meta_information pre {
background-color: #fed;
}
#similar_tickets {
max-height: 300px;
overflow-y: auto;
pointer-events: none;
padding: 5px;
background-color: #f4f4f4;
}
.btn-toolbar {
margin-bottom: 0;
height: 30px;
}
#peers {
position: fixed;
bottom: 0px;
right: 0px;
z-index: 100;
list-style: none;
padding: 5px 0px 0px 5px;
margin: 0px;
background-color: white;
box-shadow: 0px 0px 10px white;
}
#peers li {
background-color: #ccc;
color: #000;
display: inline-block;
padding: 5px 10px;
margin-right: 5px;
position: relative;
}
/*
#peers li:hover {
background-color: #999;
cursor: pointer;
}
*/
#peers span.ip {
padding-left: 5px;
color: #666;
}
#peers .new {
bottom: -30px;
}
/*
#peers .me {
background-color: red;
}
*/
</style>

<div class="container-fluid">
<ul id="peers"></ul>
<div class="alert alert-danger"><a class="close" href="https://ticket.opensciencegrid.org/#" data-dismiss="alert">&times;</a>By the end of May 2018, the ticketing system at https://ticket.opensciencegrid.org will be retired and support will be provided at https://support.opensciencegrid.org. Throughout this transition the support email (help@opensciencegrid.org) will be available as a point of contact.<br><br>                                                   
                                                                                                                                                                                   
Please see the service migration page for details: https://opensciencegrid.github.io/technology/policy/service-migrations-spring-2018/#ticket</div><div id="presence" class="pull-right"></div><div class="ticketgui"><script type="text/javascript" src="lib/checktab.js"></script>

<script>
var expanded = false;
function expand_description() {
    var desc = $(".description");
    if(!expanded) {
        expanded = true;
        //expand to minheight
        var min = 250;
        if(desc.height() < min) {
            desc.animate({height: min}, 200);
        }
    }
}

$(document).ready(function() {
    $("input[name='nad']").datepicker({
        dateFormat: 'yy-mm-dd'
    });
});

</script>



<style>
.form-horizontal .control-label {
padding-top: inherit;
font-size:90%;
color:#666;
}
label {
margin-bottom: 0px;
}
.controls {
line-height: 18px;
}
</style>
<form class="form-horizontal" action="https://ticket.opensciencegrid.org/viewer/updatebasic?id=35146" method="post">
<div class="page-header">
    <h3><span class="muted">35146</span> / Event RabbitMQ records missing</h3>
</div>

<div class="row-fluid">
<div class="span5">
    <legend>Contact</legend>
    <div class="control-group">
        <label class="control-label">Full Name</label>
        <div class="controls">Derek Weitzel</div>
    </div>
    <div class="control-group">
        <label class="control-label">Email</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">Phone</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">CC</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>

    <legend>Details</legend>
    <div class="control-group"><label class="control-label">Submitted Via</label><div class="controls">GOC Ticket/submit</div></div><div class="control-group"><label class="control-label">Submitter</label><div class="controls">Derek Weitzel</div></div><div class="control-group"><label class="control-label">Ticket Links</label><div class="controls"></div></div>
    <div class="control-group">
        <label class="control-label">Ticket Type</label>
        <div class="controls">Problem/Request</div>
    </div>
    <div class="control-group">
        <label class="control-label">Priority</label>
        <div class="controls">Normal</div>
    </div>
    <div class="control-group">
        <label class="control-label">Status</label>
        <div class="controls">
Closed</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action</label>
        <div class="controls">ENG Action</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action Deadline</label>
        <div class="controls flag_red">2017-10-20</div>
    </div>

</div><!--span-->
<div class="span7">
    <legend>Assignees</legend>
    <div class="assignee" style="width: 60%">Kyle Gross <span class="muted"> / OSG GOC Support Team</span></div><div class="assignee" style="width: 60%">Scott Teige <span class="muted"> / OSG Operations Infrastructure</span></div>    <br>

    <legend>Assignees</legend>
    TODO
    <br>

    <style>
legend.noborder {
border-bottom: none;
}
</style>

<div id="attachment-list"/>
<script>
$(function () {
    var first = true;
    $.getJSON("attachment/list/35146", function (files) {
        //console.dir(files);
        var html = "<table class=\"table table-condensed\">";
        $(files).each(function() {
            if(first) {
                first = false;
                html += "<legend class=\"noborder\">Attachmenets</legend>";
            }
            html += "<tr class=\"attachment\">";
            html += "<td><img src=\""+this.thumbnail_url+"\"/></td>";
            html += "<td><a href=\""+this.url+"\" target=\"_blank\">"+this.name+"</a></td>";
            html += "<td>"+bytesToSize(this.size, 1)+"</td>";
            html += "</tr>";
        });
        html += "</table>";
        $("#attachment-list").html(html);
    });
});

function download(url) {
    window.open(url, "_blank");
}
</script>


</div><!--span-->
</div><!--row-fluid-->


</form>

</div>
<div id="updates" style="clear: both;">
    <legend>Past Updates
    <div class="btn-toolbar pull-right toolbar">
        <div class="btn-group">
                <a class="btn btn-small" href="https://ticket.opensciencegrid.org/35146?sort=up&amp;"><i class="icon-arrow-up"></i> Sort</a>

        
        <a class="btn btn-small" href="https://ticket.opensciencegrid.org/35146?expandall=true&amp;">Expand Descriptions</a>        <a class="btn btn-small" target="_blank" href="mailto:osg@tick.globalnoc.iu.edu?subject=Open%20Science%20Grid%3A%20Event%20RabbitMQ%20records%20missing%20ISSUE%3D35146%20PROJ%3D71"><i class="icon-envelope"></i> Update w/Email</a>
        </div>
    </div><!--btn-toolbar-->
    </legend>

    <div class='update_description'><i onclick="document.location='35146#1509744251'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-11-03T21:24:11+00:00">Nov 3, 2017 09:24 PM UTC</time> by <b>Scott Teige</b><a class="anchor" name="1509744251">&nbsp;</a></div><pre>The resources that filled were /var/ and memory. /var was changed from 8 to 20 GB, memory from 4 to 12 GB.
The files were deleted by me by hand to get the machine to be responsive.
If there were alarms on this they were either ignored or operations was not informed.
The problem was corrected after I informed GRACC support there was an issue.
We are working to free up resources on our development hosts to allow an event-itb
to be built that can be provisioned in excess of the current production instance
and allow testing of any imposed limits. Modifications to monitoring on this end
have been made to detect queues that have messages without consumers but there
is no way to tell if those consumers are doing anything useful from here. Someone
would also need to respond to any alarms generated. Tools to access this information
can be trivially developed. Finally, an SLA is in the works that defines expectations
in an achievable way.

While the initial content of this ticket was informative, that is, had no questions
to be addressed, it has since diverged into a discussion more suited to a JIRA
ticket. Brian B, please open a JIRA ticket if you&#39;d like to continue with this discussion.
I&#39;m resolving this one.</pre></div><div class='update_description'><i onclick="document.location='35146#1509157210'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-10-28T02:20:10+00:00">Oct 28, 2017 02:20 AM UTC</time><a class="anchor" name="1509157210">&nbsp;</a></div><pre><font color='#7F7E6F'>&#62; Small self monitoring modifications to the producers and consumers would fix this outright.</font>

I don&#39;t think so, that&#39;s not how the system is supposed to work.  If the queue is beginning to run out of space, it should first enable flow control to slow down remote producers then reject new additions to the queue.

GRACC is designed to be able to handle outages, but it&#39;s not designed to handle the case where the message queue accepts the data as persistent, safely persists it to disk, acknowledges the receipt, and then subsequently deletes the data.

<font color='#7F7E6F'>&#62; When a consumer failed those resource limits were hit after a few hours, the system became unresponsive and had to be rebooted.  (A linux system won&#39;t run well with /var filled)</font>

Which resource limits limits were hit?  Eight months ago after the same issue occurred, the GRACC development team suggested applying RabbitMQ settings to prevent more messages being persisted by the host than available free space.

What are the existing configured watermark levels for disk and memory?

What precisely deleted the persisted files in /var?  Was it a person running &#34;rm -rf&#34; on a data directory or an automated process?

<font color='#7F7E6F'>&#62; The system was reconfigured to allow it to survive a longer duration event of this type.</font>

What precisely was done?

<font color='#7F7E6F'>&#62; Please be advised a fix like that does not solve the problem, it just delays it.</font>

Precisely.  It&#39;s going in the wrong direction.  We don&#39;t want larger buffers, we want the correct behavior when the buffers fill.

<font color='#7F7E6F'>&#62; Additional safeguards (cleverly avoiding the M-word) can be added to the producers to cause them to back off and inform when the queue reaches some threshold.</font>

Yes, let&#39;s do this as Kevin suggested in April.  There are built-in mechanisms to the broker that we should utilize.

<font color='#7F7E6F'>&#62; The sites operating consumers should have an automated means to be informed (another dodge) that their consumer(s) have failed.</font>

They do and the failures were discussed during the outage.  As service failures have been occurring frequently lately, it was assumed that this was a typical outage.

<font color='#7F7E6F'>&#62; Finally per queue limits can be installed by IU-OPS.</font>

Which mechanism are you looking at?  There are several within the broker and I can&#39;t provide technical input without more information.

<font color='#7F7E6F'>&#62; Durable records, as I understand things now, refers to records that make it to disk (by being in RAM too long) or are written during a shutdown.</font>
<div id='show_1076198828' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_1076198828'>
No.  There&#39;s a nice writeup about this&#58;

<a href='https&#58;//www.rabbitmq.com/persistence-conf.html' target='_blank' rel='nofollow'>https&#58;//www.rabbitmq.com/persistence-conf.html</a>

Persistent records aren&#39;t indicated as accepted to the producer until they have made it to disk.  They survive reboots.

Transient records are spilled to disk under memory pressure, but they are simply removed on shutdown.

<font color='#7F7E6F'>&#62; It was also assumed the system had infinite resources.</font>

No.  RabbitMQ implements a standardized protocol and it was assumed the service behaved according to the standard.

If you&#39;d like to post the configuration for the service, we can provide input on how the configuration could be improved.

I do not consider this resolved as I don&#39;t know what changes have been applied.  Seems there&#39;s significant work remaining to recreate the issue in ITB, verify we have diagnosed it right, and that configuration changes are doing the correct thing.

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=bbockelm/CN=659869/CN=Brian Paul Bockelman
</div><script type='text/javascript'>
        $('#show_1076198828').click(function() {
            $('#detail_1076198828').slideDown("normal");
            $('#show_1076198828').hide();
            $('#hide_1076198828').show();
        });
        $('#hide_1076198828').click(function() {
            $('#detail_1076198828').slideUp();
            $('#hide_1076198828').hide();
            $('#show_1076198828').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='35146#1509121120'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-10-27T16:18:40+00:00">Oct 27, 2017 04:18 PM UTC</time> by <b>Scott Teige</b><a class="anchor" name="1509121120">&nbsp;</a></div><pre>The answer to all of those questions is yes.

Can we separate out the monitoring discussion?
We can separate it but I think that is a bad idea. Monitoring is an essential part of solving this problem. The most recent occurrence was diagnosed by IU-OPS
end monitors and I was able to alert other folks that they needed to do something. Small self monitoring modifications to the producers and consumers would fix this outright.

Do we understand why records are lost?
I believe so. The system is configured to know about available resources, RAM and Disk in particular. When a consumer failed those resource limits
were hit after a few hours, the system became unresponsive and had to be rebooted. (A linux system won&#39;t run well with /var filled) The reboot
destroyed the records in question.

Do we understand whether the safeguards...?
The system was reconfigured to allow it to survive a longer duration event of this type. Please be advised a fix like that does not solve the problem,
it just delays it. In the new case it took 14 hours to approach failure, I estimate it would have failed in about another 3 hours. The resources  consumed
just before failure were a factor of 10,000 larger than what is used during typical operation. If a system absolutely depends on having a surge tank this
large the problem is with the design of the system. Additional safeguards (cleverly avoiding the M-word) can be added to the producers to cause
them to back off and inform when the queue reaches some threshold. The sites operating consumers should have an automated means to be
informed (another dodge) that their consumer(s) have failed. Finally per queue limits can be installed by IU-OPS. We are testing this now but would
strongly prefer not to unilaterally impose these.

... working theory ...?
See above.

I also believe there may be some incorrect assumptions being made. Durable records, as I understand things now, refers to records that make it
to disk (by being in RAM too long) or are written during a shutdown. It does not apply to anything in the pipe during a hard crash. It was also
assumed the system had infinite resources. Continuing to add data to a pipe without checking something was coming out the other end
or having a backup would probably not be considered best practice.

I think the questions have been answered and the problem initially raised addressed. Please resolve if you agree.</pre></div><div class='update_description'><i onclick="document.location='35146#1508427822'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-10-19T15:43:42+00:00">Oct 19, 2017 03:43 PM UTC</time><a class="anchor" name="1508427822">&nbsp;</a></div><pre>Hi all - can we separate out the monitoring discussion?

Do we understand why records are lost?  Do we understand whether the safeguards were added are insufficient or inactive or ... ?  Do we have a working theory as to what happened internal to RabbitMQ?

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=bbockelm/CN=659869/CN=Brian Paul Bockelman</pre></div><div class='update_description'><i onclick="document.location='35146#1508427671'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-10-19T15:41:11+00:00">Oct 19, 2017 03:41 PM UTC</time> by <b>Derek Weitzel</b><a class="anchor" name="1508427671">&nbsp;</a></div><pre>I’m sure there is an API to get this information, that’s how the link above is grabbing it.  But I’m unfamiliar with the API to get this type of monitoring information.

-Derek

<font color='#7F7E6F'>&#62; On Oct 19, 2017, at 7&#58;21 AM, Open Science Grid FootPrints &#60;osg@....&#62; wrote&#58;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='35146#1508415665'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-10-19T12:21:05+00:00">Oct 19, 2017 12:21 PM UTC</time> by <b>Scott Teige</b><a class="anchor" name="1508415665">&nbsp;</a></div><pre>Thanks, but I&#39;d rather not be added to another mail list. There is alarm infrastructure here I prefer to use and it is trivial for me to implement and configure once I have access to the numbers. So, what I&#39;d like is a way to access them, preferably directly from event1, and I can take it from there. If this turns out to be a big deal, I&#39;ll dig them up here. Just trying to save myself a step or two.

S</pre></div><div class='update_description'><i onclick="document.location='35146#1508350810'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-10-18T18:20:10+00:00">Oct 18, 2017 06:20 PM UTC</time> by <b>marian.zvada@....</b><a class="anchor" name="1508350810">&nbsp;</a></div><pre>Scott, we have graffana dashboard set for many alerts, this particular
one about RabbitMQ comes from this URL&#58;

<a href='https&#58;//gracc.opensciencegrid.org/dashboard/db/rabbitmq-queues?panelId=1&fullscreen&edit&tab=alert&refresh=1m&orgId=1' target='_blank' rel='nofollow'>https&#58;//gracc.opensciencegrid.org/dashboard/db/rabbitmq-queues?panelId=1&fullscreen&edit&tab=alert&refresh=1m&orgId=1</a>

So, we&#39;re (GRACC Ops) alarmed when queues exceeds 100k and if it stays
like that for too long we bug you. Over a million accumulated not-served
requests now was extremely a lot this time. We can also add you for some
particular alarms if you want?

-Marian

On 10/18/17 12&#58;12 PM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='35146#1508350273'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-10-18T18:11:13+00:00">Oct 18, 2017 06:11 PM UTC</time> by <b>Derek Weitzel</b><a class="anchor" name="1508350273">&nbsp;</a></div><pre>Here’s the page with those graphs&#58;
<a href='https&#58;//gracc.opensciencegrid.org/dashboard/db/rabbitmq-queues?refresh=1m&orgId=1' target='_blank' rel='nofollow'>https&#58;//gracc.opensciencegrid.org/dashboard/db/rabbitmq-queues?refresh=1m&orgId=1</a>

We do have alerts when any of the queues get above the red line, set to 100k right now.  It’s sent to the gracc support team though.  We could add more emails if you would like.

-Derek

<font color='#7F7E6F'>&#62; On Oct 18, 2017, at 12&#58;12 PM, Open Science Grid FootPrints &#60;osg@....&#62; wrote&#58;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='35146#1508346769'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-10-18T17:12:49+00:00">Oct 18, 2017 05:12 PM UTC</time> by <b>Scott Teige</b><a class="anchor" name="1508346769">&nbsp;</a></div><pre>Derek, the plot you shared had some really useful numbers in it. Was it script generated or done via the web interface.
I&#39;m thinking something like that should have tripped an alarm, if we can script it up we can do that.</pre></div><div class='update_description'><i onclick="document.location='35146#1508346231'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-10-18T17:03:51+00:00">Oct 18, 2017 05:03 PM UTC</time> by <b>Scott Teige</b><a class="anchor" name="1508346231">&nbsp;</a></div><pre>Sorry, I meant an SLA for event.grid... I have one in the works and I&#39;m more than happy to help in any way I can.
I suggest event.md as a starting point, it is most recent and addresses some relevant points.

S</pre></div><div class='update_description'><i onclick="document.location='35146#1508342349'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-10-18T15:59:09+00:00">Oct 18, 2017 03:59 PM UTC</time> by <b>marian.zvada@....</b><a class="anchor" name="1508342349">&nbsp;</a></div><pre>Sorry, ignore my comment about GRACC SLA, it&#39;s unrelated to the topic in
the subject. I follow up on SLA in separate JIRA ticket I have opened on it.

Thanks,
Marian

On 10/18/17 10&#58;46 AM, Marian Zvada wrote&#58;
<font color='#7F7E6F'>&#62; Scott, I&#39;d like to draft GRACC SLA if that helps and we can start from</font>
<font color='#7F7E6F'>&#62; there. I&#39;ll do PR in the area of other SLAs if that&#39;s ok here&#58;</font>
<font color='#7F7E6F'>&#62; <a href='https&#58;//github.com/opensciencegrid/operations/tree/master/docs/SLA' target='_blank' rel='nofollow'>https&#58;//github.com/opensciencegrid/operations/tree/master/docs/SLA</a></font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; Or do you have some draft ready for that where should we follow?</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; Thanks,</font>
<font color='#7F7E6F'>&#62; Marian</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; On 10/18/17 10&#58;41 AM, Open Science Grid FootPrints wrote&#58;</font>
<font color='#7F7E6F'>&#62;&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='35146#1508341630'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-10-18T15:47:10+00:00">Oct 18, 2017 03:47 PM UTC</time> by <b>marian.zvada@....</b><a class="anchor" name="1508341630">&nbsp;</a></div><pre>Scott, I&#39;d like to draft GRACC SLA if that helps and we can start from
there. I&#39;ll do PR in the area of other SLAs if that&#39;s ok here&#58;
<a href='https&#58;//github.com/opensciencegrid/operations/tree/master/docs/SLA' target='_blank' rel='nofollow'>https&#58;//github.com/opensciencegrid/operations/tree/master/docs/SLA</a>

Or do you have some draft ready for that where should we follow?

Thanks,
Marian

On 10/18/17 10&#58;41 AM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='35146#1508341278'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-10-18T15:41:18+00:00">Oct 18, 2017 03:41 PM UTC</time> by <b>Scott Teige</b><a class="anchor" name="1508341278">&nbsp;</a></div><pre>I&#39;m working on an SLA and AUP to address these issues. We will look into finding the records but I&#39;m not optimistic.</pre></div><div class='update_description'><i onclick="document.location='35146#1508340804'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-10-18T15:33:24+00:00">Oct 18, 2017 03:33 PM UTC</time> by <b>Derek Weitzel</b><a class="anchor" name="1508340804">&nbsp;</a></div><pre>Hi,

According to our monitoring, the RabbitMQ instance at the goc was building up records up to 1.5 million message.  Then suddenly, they were all gone.  We know they were not ingested by the GRACC, since GRACC services where not back up yet from the downtime.

This is data loss.  These are records that we do not have copies elsewhere.  They are marked as &#34;durable&#34; when sent to event.grid.iu.edu, under the assumption that it would handle the messages appropriately.

Here is a graph of the records growing, then the sudden missing records&#58;
<a href='https&#58;//unl.box.com/s/8gdfkostkyxe10216akj6awudanafsxc' target='_blank' rel='nofollow'>https&#58;//unl.box.com/s/8gdfkostkyxe10216akj6awudanafsxc</a></pre></div><legend>Similar Recent Tickets <small>modified within the last 30 days</small></legend><div id="similar_tickets"><p class="muted">No similar tickets found.</p></div>
</div>
<script type="text/javascript">
function reset_anchor() {
    $("#updates .selected").removeClass("selected");
    var urls = document.location.toString().split('#'); 
    var anchor = urls[1];
    if(anchor) {
        $("a[name='"+anchor+"']").parents(".update_description").addClass("selected");
    }
}
function submitspam(ticket_id) {
    myret = confirm("Would you like to close this ticket as a security ticket, and submit the ticket content to akismet?");
    if(myret == true) {
        $.ajax("viewer/processspam?id="+ticket_id).done(function() {
            window.location.reload();
        });
    }
}

$(function() {
    reset_anchor();
    var ADDITIONAL_COOKIE_NAME = 'gocticket';
    var options = { path: '/', expires: 365};

    if(window.opener && window.opener.name == "gocticket_list") {
        v = $.cookie("closewindow");
        if(!v) {
            $("#closewindow").attr("checked", "checked"); //on by default
        } else {
            if(v == "checked") {
                $("#closewindow").attr("checked", "checked");
            }
        }
        $("#closewindow").click(function() {
            $.cookie("closewindow", $(this).attr('checked'), options);
        });
    } else {
        $("#closewindow_area").hide();
    }
    function updateTimeago() {
        $("time").timeago();
        setTimeout(updateTimeago, 30*1000);
    }
    updateTimeago();
    $(".description").focus(expand_description);
});
</script>
<hr/>
<footer>
<p>GOC Ticket Version 2.2 | <a href="https://ticket.opensciencegrid.org/goc/submit?app_issue_check=on&amp;app_issue_type=goc&amp;app_goc_url=https%3A%2F%2Fticket.opensciencegrid.org%3A443%2F35146">Report Bugs</a>
 | <a href="https://github.com/opensciencegrid/operations/blob/master/docs/privacy.md">Privacy Policy</a>
</p>

<p> <img align="top" src="images/tag_orange.png"/> Copyright 2018 The Trustees of Indiana University - Developed for Open Science Grid</p>
</footer>


</div><!--container-fluid-->
<script>
//used by searchbox
function parseValue(value) {
    var obj = new Object();
    var tokens = value.split("\t");
    obj.str = tokens[0];
    obj.count = tokens[1];
    return obj;
}

$(function() {
    //bootstrap-2.0.4 stuff
    $(".alert-message").alert();
    $(".dropdown-toggle").dropdown();
    $("span[rel='tooltip']").tooltip();
    $("a[rel=popover]").popover();

    //activate menu that user is currently on
    $("#menu_navigator").addClass("active"); 
    $("#submenu_").addClass("active"); 

    //translate zend validation error message to bootstrap
    $(".errors").addClass("alert").addClass("alert-error");

    //enable autocomplete for search box
    $("#search").autocomplete({
        source: function( request, response ) {
            $.ajax({
                url: "search/autocomplete",
                dataType: "text",
                data: {
                    //featureClass: "P",
                    //style: "full",
                    //maxRows: 12,
                    //name_startsWith: request.term
                    q: request.term
                },
                success: function( data ) {
                    response( $.map( data.split("\n"), function( item ) {
                        if(item == "") return null;
                        return {
                            value: item
                        }
                    }));
                }
            });
        },
        select: function(event, ui) {
            document.location = "search?q="+ui.item.value;
        }
    });
    
});
</script>


</body>
