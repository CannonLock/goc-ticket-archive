<!DOCTYPE html>
<html lang="en">
  <head>
  <base href="/">
    <title>[12064] Problems with Globus GRAM job manager from OSG 3.1.0</title>    <meta charset="utf-8" />
    <meta name="verify-v1" content="na5IcAJsZVOfEkboRxuIiZ1zpZgnZiWra+nKcS7nA/o=" />
    <meta name="google-site-verification" content="DLrk3ft4s8b-S2TloLCL2LD_t6wcTjgSluf5pmiu2kA" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />
    <link href="https://ticket.opensciencegrid.org/rss" rel="alternate" type="application/rss+xml" title="GOC Ticket Update feed" />

    <style type="text/css">
      body {
        padding-top: 50px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
     #search {
            width: 300px;
     }

    </style>

<script src="https://code.jquery.com/jquery-3.0.0.js"></script>
<script src="https://code.jquery.com/jquery-migrate-3.0.1.js"></script>

   <link href="//netdna.bootstrapcdn.com/bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet"/>
    <script src="//netdna.bootstrapcdn.com/bootstrap/2.3.2/js/bootstrap.min.js"></script>

    <link href="//netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"/>
    <link href="//ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/themes/smoothness/jquery-ui.min.css" rel="stylesheet"/>
 <script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>


    <link href="//cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/css/select2.min.css" rel="stylesheet" />
    <script src="//cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/js/select2.min.js"></script>

    <link href="css/ticket.css" rel="stylesheet" />
    <script src="lib/jquery.cookie.js"></script>

    <link href="images/tag_orange.png" rel="icon" type="image/png"/>
    <script src='https://www.google.com/recaptcha/api.js'></script>
  </head>

  <body>
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>

            <a class="brand" style="padding: 6px 0px 0px 6px;" href="http://opensciencegrid.org"><img src="https://ticket.opensciencegrid.org/images/osglogo.40x30.png"/></a>
            <ul class="nav">
                <li class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown">GOC Ticket <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    <li><a href="https://my.opensciencegrid.org">MyOSG</a></li>
                    <li><a href="https://oim.opensciencegrid.org">OIM</a></li>
                    <li class="active"><a href="index">Ticket</a></li>
	<li class="divider"></li>
	<li><a href="http://repo.grid.iu.edu">Repo</a></li>
	<li class="divider"></li>
	<li><a href="http://blogs.grid.iu.edu">Blog</a></li>
                    <li><a href="http://display.grid.iu.edu">Display</a></li>
                    <li><a href="http://osggoc.blogspot.com/">News</a></li>
                    </ul>
                </li>
            </ul>
            <ul class="nav pull-right">
                <li><a href="https://ticket.opensciencegrid.org/sso/">Login</a></li>            </ul>

            <div class="nav-collapse">
                <ul class="nav">
			 <li id="menu_submit"><a href="https://ticket.opensciencegrid.org/submit">Submit</a></li><li id="menu_view" class="dropdown"><a href="\#" class="dropdown-toggle" data-toggle="dropdown">View <b class="caret"></b></a><ul class="dropdown-menu"><li id="submenu_listopen"><a href="https://ticket.opensciencegrid.org/list/open">Open Tickets</a></li><li id="submenu_listrecentclose"><a href="https://ticket.opensciencegrid.org/list/recentclose">Recently Closed Tickets</a></li><li class="divider"></li><li id="submenu_alltickets"><a href="https://ticket.opensciencegrid.org/search?q=&amp;sort=id">All Tickets</a></li></ul></li>                </ul>

                <form class="navbar-search pull-right" action="viewer">
                    <input id="search" type="text" name="id" class="search-query span2" placeholder="Search Ticket" value=""/>
                </form>
            </div>
        </div>
      </div>
    </div>

<script type='text/javascript' src='lib/jquery.timeago.js'></script>
<script type='text/javascript' src='lib/byte2size.js'></script>
<style>
#updates .toolbar {
position: relative;
margin-top: 0px;
top: -10px;
font-weight: normal;
}
#updates a.anchor {
position: relative;
top: -50px;
}
#updates .selected pre {
animation:selected 2s;
animation-iteration-count: 2;
animation-direction: alternate;
-webkit-animation:selected 2s; 
-webkit-animation-iteration-count: 2;
-webkit-animation-direction: alternate;
box-shadow: inset 1px 1px 20px #9ad;
border: 1px solid #9ab;
margin: 5px 0px;
padding-left: 10px;
}
@keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ab;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
@-webkit-keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ad;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
#updates pre {
background-color: inherit;
line-height: 15px;
padding: 5px;
}
#updates .header {
color: #999;
}
#updates .update_history pre {
background-color: #eee;
color: #666;
font-size: 85%;
}
#updates .clickable {
cursor: pointer;
}
#updates .clickable:hover {
color: #D98719;
}
#updates .meta_information pre {
background-color: #fed;
}
#similar_tickets {
max-height: 300px;
overflow-y: auto;
pointer-events: none;
padding: 5px;
background-color: #f4f4f4;
}
.btn-toolbar {
margin-bottom: 0;
height: 30px;
}
#peers {
position: fixed;
bottom: 0px;
right: 0px;
z-index: 100;
list-style: none;
padding: 5px 0px 0px 5px;
margin: 0px;
background-color: white;
box-shadow: 0px 0px 10px white;
}
#peers li {
background-color: #ccc;
color: #000;
display: inline-block;
padding: 5px 10px;
margin-right: 5px;
position: relative;
}
/*
#peers li:hover {
background-color: #999;
cursor: pointer;
}
*/
#peers span.ip {
padding-left: 5px;
color: #666;
}
#peers .new {
bottom: -30px;
}
/*
#peers .me {
background-color: red;
}
*/
</style>

<div class="container-fluid">
<ul id="peers"></ul>
<div class="alert alert-danger"><a class="close" href="#" data-dismiss="alert">&times;</a>By the end of May 2018, the ticketing system at https://ticket.opensciencegrid.org will be retired and support will be provided at https://support.opensciencegrid.org. Throughout this transition the support email (help@opensciencegrid.org) will be available as a point of contact.<br><br>                                                   
                                                                                                                                                                                   
Please see the service migration page for details: https://opensciencegrid.github.io/technology/policy/service-migrations-spring-2018/#ticket</div><div id="presence" class="pull-right"></div><div class="ticketgui"><script type="text/javascript" src="https://ticket.opensciencegrid.org/lib/checktab.js"></script>

<script>
var expanded = false;
function expand_description() {
    var desc = $(".description");
    if(!expanded) {
        expanded = true;
        //expand to minheight
        var min = 250;
        if(desc.height() < min) {
            desc.animate({height: min}, 200);
        }
    }
}

$(document).ready(function() {
    $("input[name='nad']").datepicker({
        dateFormat: 'yy-mm-dd'
    });
});

</script>



<style>
.form-horizontal .control-label {
padding-top: inherit;
font-size:90%;
color:#666;
}
label {
margin-bottom: 0px;
}
.controls {
line-height: 18px;
}
</style>
<form class="form-horizontal" action="https://ticket.opensciencegrid.org/viewer/updatebasic?id=12064" method="post">
<div class="page-header">
    <h3><span class="muted">12064</span> / Problems with Globus GRAM job manager from OSG 3.1.0</h3>
</div>

<div class="row-fluid">
<div class="span5">
    <legend>Contact</legend>
    <div class="control-group">
        <label class="control-label">Full Name</label>
        <div class="controls">Horst Severini</div>
    </div>
    <div class="control-group">
        <label class="control-label">Email</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">Phone</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">CC</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>

    <legend>Details</legend>
    <div class="control-group"><label class="control-label">Submitted Via</label><div class="controls">GOC Ticket/submit</div></div><div class="control-group"><label class="control-label">Submitter</label><div class="controls">Horst Severini</div></div>
    <div class="control-group">
        <label class="control-label">Ticket Type</label>
        <div class="controls">Problem/Request</div>
    </div>
    <div class="control-group">
        <label class="control-label">Priority</label>
        <div class="controls">Normal</div>
    </div>
    <div class="control-group">
        <label class="control-label">Status</label>
        <div class="controls">
Closed</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action</label>
        <div class="controls">Check for updates</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action Deadline</label>
        <div class="controls flag_red">2012-05-25</div>
    </div>

</div><!--span-->
<div class="span7">
    <legend>Assignees</legend>
    <div class="assignee" style="width: 60%">OSG RA <span class="muted"> / OSG GOC Support Team</span></div><div class="assignee" style="width: 60%">Software Support (Triage) <span class="muted"> / OSG Software Team</span></div><div class="assignee" style="width: 60%">Matyas Selmeci <span class="muted"> / OSG Software Team</span></div>    <br>

    <legend>Assignees</legend>
    TODO
    <br>

    <style>
legend.noborder {
border-bottom: none;
}
</style>

<div id="attachment-list"/>
<script>
$(function () {
    var first = true;
    $.getJSON("https://ticket.opensciencegrid.org/attachment/list?id=12064", function (files) {
        //console.dir(files);
        var html = "<table class=\"table table-condensed\">";
        $(files).each(function() {
            if(first) {
                first = false;
                html += "<legend class=\"noborder\">Attachmenets</legend>";
            }
            html += "<tr class=\"attachment\">";
            html += "<td><img src=\""+this.thumbnail_url+"\"/></td>";
            html += "<td><a href=\""+this.url+"\" target=\"_blank\">"+this.name+"</a></td>";
            html += "<td>"+bytesToSize(this.size, 1)+"</td>";
            html += "</tr>";
        });
        html += "</table>";
        $("#attachment-list").html(html);
    });
});

function download(url) {
    window.open(url, "_blank");
}
</script>


</div><!--span-->
</div><!--row-fluid-->


</form>

</div>
<div id="updates" style="clear: both;">
    <legend>Past Updates
    <div class="btn-toolbar pull-right toolbar">
        <div class="btn-group">
                <a class="btn btn-small" href="/12064?sort=up&"><i class="icon-arrow-up"></i> Sort</a>

        
        <a class="btn btn-small" href="/12064?expandall=true&">Expand Descriptions</a>        <a class="btn btn-small" target="_blank" href="mailto:osg@tick.globalnoc.iu.edu?subject=Open%20Science%20Grid%3A%20Problems%20with%20Globus%20GRAM%20job%20manager%20from%20OSG%203.1.0%20ISSUE%3D12064%20PROJ%3D71"><i class="icon-envelope"></i> Update w/Email</a>
        </div>
    </div><!--btn-toolbar-->
    </legend>

    <div class='update_description'><i onclick="document.location='12064#1337373137'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-05-18T20:32:17+00:00">May 18, 2012 08:32 PM UTC</time> by <b>Alain Roy</b><a class="anchor" name="1337373137">&nbsp;</a></div><pre>Closing ticket -alain</pre></div><div class='update_description'><i onclick="document.location='12064#1337369349'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-05-18T19:29:09+00:00">May 18, 2012 07:29 PM UTC</time> by <b>Horst Severini</b><a class="anchor" name="1337369349">&nbsp;</a></div><pre>Hi Alain,

I think we can close this one, thanks!

Horst</pre></div><div class='update_description'><i onclick="document.location='12064#1337367941'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-05-18T19:05:41+00:00">May 18, 2012 07:05 PM UTC</time> by <b>OSG RA</b><a class="anchor" name="1337367941">&nbsp;</a></div><pre>Horst,

Can we close out this ticket or are you still waiting for someone to address
some of your concerns in the previous entry?

Thanks,

-Alain D</pre></div><div class='update_description'><i onclick="document.location='12064#1336401131'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-05-07T14:32:11+00:00">May 7, 2012 02:32 PM UTC</time> by <b>Horst Severini</b><a class="anchor" name="1336401131">&nbsp;</a></div><pre>Hi all,

well, we haven&#39;t seen any more Held jobs since the up/downgrad, but we&#39;re
still seeing these evicted jobs which seem to lose track of their history,
since the Condor UserLog has no information that the job has already run.

And I&#39;m still not convinced that this is a local Condor mis-configuration,
as Brian suggested, since we&#39;ve never seen this problem before we installed
osg-3.

I still don&#39;t fully understand what the problem was with these Held jobs,
but if I understood it correctly, the job manager somehow deleted the
stdout/stderr files from the Condor run directory, which then causes
the job to be Held, right?

If so, would it not equally be possible that that same (or a similar) bug
causes the Condor UserLog to be deleted from a running job, which could
then confuse Condor sufficiently that it evicts that job and loses track
of it ever having run before?

Gee, I sound like a defense attorney, don&#39;t I? Well, I guess I am trying
to defend Condor. =)

Cheers,

Horst</pre></div><div class='update_description'><i onclick="document.location='12064#1336399449'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-05-07T14:04:09+00:00">May 7, 2012 02:04 PM UTC</time> by <b>Matyas Selmeci</b><a class="anchor" name="1336399449">&nbsp;</a></div><pre>We&#39;ve released OSG 3.1.1 with the downgrade. Let us know if the problem persists.</pre></div><div class='update_description'><i onclick="document.location='12064#1336061467'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-05-03T16:11:07+00:00">May 3, 2012 04:11 PM UTC</time> by <b>Bockjoo Kim</b><a class="anchor" name="1336061467">&nbsp;</a></div><pre>I am also seeing the core dump on OSG 3.0.9, the previous version of GRAM.
I am not sure if this core dump should be filed for a ticket separately.
(signal 11 and signal 6 and signal 7).
Bockjoo
On 5/2/12 5&#58;41 PM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='12064#1335994889'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-05-02T21:41:29+00:00">May 2, 2012 09:41 PM UTC</time> by <b>Alain Roy</b><a class="anchor" name="1335994889">&nbsp;</a></div><pre>Thanks Marco. For now, they should do the same downgrade. We&#39;ll release OSG 3.1.1 shortly with the previous version of GRAM to avoid more problems.

I believe that Joe Bester from the Globus team will soon have access to Horst&#39;s ITB site and will be able to debug live failures.</pre></div><div class='update_description'><i onclick="document.location='12064#1335989302'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-05-02T20:08:22+00:00">May 2, 2012 08:08 PM UTC</time> by <b>Marco Mambelli</b><a class="anchor" name="1335989302">&nbsp;</a></div><pre>UTD has the same problem</pre></div><div class='update_description'><i onclick="document.location='12064#1335972907'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-05-02T15:35:07+00:00">May 2, 2012 03:35 PM UTC</time> by <b>Horst Severini</b><a class="anchor" name="1335972907">&nbsp;</a></div><pre>Hi all,

we got 4 more Held jobs at OUHEP_ITB last night as well, still with the
downgraded globus-gram-job-manager-13.23-0.10.osg.el5 .

In all 4 cases, the error was

Failed to open &#39;/home/usatlas1/.globus/usatlas1/.globus/job/osgitb1/16218011546835306056.933117525531602842/stdout&#39; as standard output&#58; No such file or directory (errno 2)

and while the directories were there, the file stdout was not&#58;

/home/usatlas1/.globus/usatlas1/.globus/job/osgitb1/16218011546835306056.933117525531602842&#58;
total 68
drwx------  2 usatlas1  4096 May  1 20&#58;10 ./
drwx------ 96 usatlas1 57344 May  2 10&#58;27 ../
-rw-r--r--  1 usatlas1    39 May  1 20&#58;10 remote_io_file

Cheers,

Horst</pre></div><div class='update_description'><i onclick="document.location='12064#1335884167'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-05-01T14:56:07+00:00">May 1, 2012 02:56 PM UTC</time> by <b>Bockjoo Kim</b><a class="anchor" name="1335884167">&nbsp;</a></div><pre>I have uploaded the gram log for the Globus error 3 ( status=-3 inside
the gram log )&#58;
<a href='http&#58;//oo.ihepa.ufl.edu&#58;8080/t2/operations/gram_cms33877.log' target='_blank' rel='nofollow'>http&#58;//oo.ihepa.ufl.edu&#58;8080/t2/operations/gram_cms33877.log</a>

On 5/1/12 10&#58;50 AM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='12064#1335883807'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-05-01T14:50:07+00:00">May 1, 2012 02:50 PM UTC</time> by <b>Bockjoo Kim</b><a class="anchor" name="1335883807">&nbsp;</a></div><pre>I got another held jobs with the user cms33877&#58;
[root@pg osg3]# condor_q | grep &#34; H &#34; | grep cms33877 | tail -1
9204.0   cms33877        5/1  00&#58;38   0+04&#58;37&#58;06 H  0   1953.1 data
[root@pg osg3]# condor_q -l 9204 | grep x509userproxy
x509userproxysubject = &#34;/C=PT/O=LIPCA/O=LIP/OU=Lisboa/CN=Pietro Vischia&#34;
x509userproxy =
&#34;/share/home/cms33877/.globus/cms33877/.globus/job/pg/16217776253024172696.15353058390121157012/x509_user_proxy&#34;

However, I can not find the gram id
16217776253024172696.15353058390121157012 &#58;
[root@pg pg]# grep 16217776253024172696
/share/pg/t2/operations/osg3/gram_$user.log
[root@pg pg]# echo $?
1

[root@pg pg]# grep -q 15353058390121157012
/share/pg/t2/operations/osg3/gram_$user.log
[root@pg pg]# echo $?
0

On 5/1/12 10&#58;32 AM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='12064#1335882726'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-05-01T14:32:06+00:00">May 1, 2012 02:32 PM UTC</time> by <b>Bockjoo Kim</b><a class="anchor" name="1335882726">&nbsp;</a></div><pre>In the meantime, I got a segfault and core dumps that I turned on yesterday.

[root@pg cmssoft]# gdb /usr/sbin/globus-job-manager
/tmp/core-globus-gram-str-11-727-721-32127-1335882143
GNU gdb (GDB) Red Hat Enterprise Linux (7.0.1-42.el5)
Copyright (C) 2009 Free Software Foundation, Inc.
License GPLv3+&#58; GNU GPL version 3 or later
&#60;<a href='http&#58;//gnu.org/licenses/gpl.html&#62' target='_blank' rel='nofollow'>http&#58;//gnu.org/licenses/gpl.html&#62</a>;
This is free software&#58; you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.  Type &#34;show copying&#34;
and &#34;show warranty&#34; for details.
This GDB was configured as &#34;x86_64-redhat-linux-gnu&#34;.
For bug reporting instructions, please see&#58;
&#60;<a href='http&#58;//www.gnu.org/software/gdb/bugs/&#62' target='_blank' rel='nofollow'>http&#58;//www.gnu.org/software/gdb/bugs/&#62</a>;...
Reading symbols from /usr/sbin/globus-job-manager...
warning&#58; the debug information found in
&#34;/usr/lib/debug//usr/sbin/globus-job-manager.debug&#34; does not match
&#34;/usr/sbin/globus-job-manager&#34; (CRC mismatch).

warning&#58; the debug information found in
&#34;/usr/lib/debug/usr/sbin/globus-job-manager.debug&#34; does not match
&#34;/usr/sbin/globus-job-manager&#34; (CRC mismatch).

(no debugging symbols found)...done.

warning&#58; core file may not match specified executable file.
[New Thread 32127]
Reading symbols from /lib64/ld-linux-x86-64.so.2...(no debugging symbols
found)...done.
Loaded symbols for /lib64/ld-linux-x86-64.so.2

warning&#58; no loadable sections found in added symbol-file system-supplied
DSO at 0x7fff7c5fd000
Core was generated by &#96;/usr/sbin/globus-gram-streamer -s
/var/lib/globus/gram_job_state/job.pg.ihepa.u&#39;.
<div id='show_1021367692' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_1021367692'>Program terminated with signal 11, Segmentation fault.
#0  0x0000000000409349 in globus_priority_q_enqueue ()

[root@pg osg3]# rpm -qf /usr/lib/debug/usr/sbin/globus-job-manager.debug
globus-gram-job-manager-debuginfo-13.23-0.10.osg.el5.x86_64
You have mail in /var/spool/mail/root
[root@pg osg3]# rpm -qf /usr/sbin/globus-job-manager
globus-gram-job-manager-13.23-0.10.osg.el5.x86_64

On 5/1/12 10&#58;14 AM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font>
</div><script type='text/javascript'>
        $('#show_1021367692').click(function() {
            $('#detail_1021367692').slideDown("normal");
            $('#show_1021367692').hide();
            $('#hide_1021367692').show();
        });
        $('#hide_1021367692').click(function() {
            $('#detail_1021367692').slideUp();
            $('#hide_1021367692').hide();
            $('#show_1021367692').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='12064#1335881649'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-05-01T14:14:09+00:00">May 1, 2012 02:14 PM UTC</time> by <b>Bockjoo Kim</b><a class="anchor" name="1335881649">&nbsp;</a></div><pre>Trying to analyze the held jobs using the gram logs, I think the error
is status=-3&#58;
[root@pg cmssoft]# condor_q | grep &#34; H &#34; | grep 5/1 | grep cms33877 | wc -l
5
[root@pg pg]# thedate=$(date +%Y-%m-%d)
[root@pg pg]# error_type=ERROR
[root@pg pg]# errors=$(grep level=${error_type}
/var/log/globus/gram_*.log | grep $thedate | sed &#34;s#status=#|status=#g&#34;
| cut -d&#92;| -f2 | awk &#39;{print $1}&#39; | grep ^status=- | sed &#34;s#ts=# ts=#g&#34;
| awk &#39;{print $1}&#39; | sort -u)
[root@pg pg]# user=&#39;cms33877&#39;
[root@pg pg]# for e in $errors ; do    echo $(grep &#34; $e &#34;
/var/log/globus/gram_$user.log | grep $thedate | grep &#34;$error_type&#34; | wc
-l)_$e; done | sort -n -r
10097_status=-94
864_status=-48
33_status=-121
7_status=-3
0_status=-4
0_status=-156

[root@pg pg]# grep status=-3 /var/log/globus/gram_$user.log | grep
$thedate | grep ERROR  | grep -v status=-94 | wc -l
5

N_heldjobs_cms33877 == N_globus_error_3_cms33877 !!!

So, I am assuming they are two manifestations of the same problem.
Following
<a href='http&#58;//www.globus.org/toolkit/docs/5.2/5.2.0/gram5/user/#gram5-error-codes' target='_blank' rel='nofollow'>http&#58;//www.globus.org/toolkit/docs/5.2/5.2.0/gram5/user/#gram5-error-codes</a>
,
I am turning on TRACE in
/etc/globus/globus-gram-job-manager.conf
to see if there is anything obvious.

<div id='show_381633187' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_381633187'>Bockjoo

On 5/1/12 9&#58;59 AM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font>
</div><script type='text/javascript'>
        $('#show_381633187').click(function() {
            $('#detail_381633187').slideDown("normal");
            $('#show_381633187').hide();
            $('#hide_381633187').show();
        });
        $('#hide_381633187').click(function() {
            $('#detail_381633187').slideUp();
            $('#hide_381633187').hide();
            $('#show_381633187').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='12064#1335880747'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-05-01T13:59:07+00:00">May 1, 2012 01:59 PM UTC</time> by <b>Horst Severini</b><a class="anchor" name="1335880747">&nbsp;</a></div><pre>Hi Bockjoo and Alain,

I saw some more held jobs last night, too, which judging from the submit time
must&#39;ve come in after I had downgraded our jobmanager again, too.
I saw 28 held jobs, which is better than the 200 or so which I saw with
the new jobmanager, but that&#39;s still 28 too many,

Cheers,

Horst</pre></div><div class='update_description'><i onclick="document.location='12064#1335879488'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-05-01T13:38:08+00:00">May 1, 2012 01:38 PM UTC</time> by <b>Bockjoo Kim</b><a class="anchor" name="1335879488">&nbsp;</a></div><pre>Even after the downgrade, I still see these hold reasons for some of the
jobs&#58;
HoldReason = &#34;Error from slot1@....&#58; STARTER at
128.227.221.194 f
ailed to send file(s) to &#60;128.227.221.11&#58;60015&#62;; SHADOW at
128.227.221.11 failed
to write to file
/share/home/cms32781/.globus/cms32781/.globus/job/pg/162178180
35348677161.15353058390121136283/stdout&#58; (errno 2) No such file or
directory&#34;
LastRejMatchReason = &#34;no match found&#34;
HoldReasonCode = 12
ExitReason = &#34;Exited normally&#34;
HoldReasonSubCode = 2

Bockjoo
On 4/30/12 7&#58;29 PM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='12064#1335828547'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-04-30T23:29:07+00:00">Apr 30, 2012 11:29 PM UTC</time> by <b>Horst Severini</b><a class="anchor" name="1335828547">&nbsp;</a></div><pre>Hi Alain,

thanks for updating the subject line, this is more useful. &#58;)

By the way, I just had to re-downgrade OUHEP_ITB&#39;s jobmanager again,
since the yum auto-updater had updated it again. So for now I&#39;ve
disabled the updating of the jobmanager, so we can look at this
and only update again once it becomes useful to do so.

So there were some more Held jobs after the auto-update, but now
having down-graded it again, everything looks good again, now Held jobs.

Cheers,

Horst</pre></div><div class='update_description'><i onclick="document.location='12064#1335827326'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-04-30T23:08:46+00:00">Apr 30, 2012 11:08 PM UTC</time> by <b>Alain Roy</b><a class="anchor" name="1335827326">&nbsp;</a></div><pre>I&#39;m updating the subject on this ticket to reflect the problem.</pre></div><div class='update_description'><i onclick="document.location='12064#1335827134'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-04-30T23:05:34+00:00">Apr 30, 2012 11:05 PM UTC</time> by <b>Alain Roy</b><a class="anchor" name="1335827134">&nbsp;</a></div><pre>This ticket was created after some discussion occurred. Here is Horst&#39;s original email on it. I&#39;ll also attach his osg-profile.txt.

-alain

----------------------------------

I just looked at OUHEP_ITB&#39;s OSG 3.1.0 installation, which was
auto-upgraded yesterday, and I noticed that all ATLAS pilots are now
immediately going into Held status, so something&#39;s wrong.

I&#39;m not positive it has something to do with the upgrade, but since
this just started happening, it stands to reason that it&#39;s somehow
related.

They&#39;re all held like this&#58;

----
[hs@osgitb1 ~]$ condor_q -ana 110628.0

-- Submitter&#58; osgitb1.nhn.ou.edu &#58; &#60;129.15.31.41&#58;64662&#62; &#58; osgitb1.nhn.ou.edu
---
110628.000&#58;  Request is held.

Hold reason&#58; Error from slot2@....&#58; Failed to open &#39;/home/usatlas1/.globus/usatlas1/.globus/job/osgitb1/16217781733807197666.933117525531569296/stdout&#39; as standard output&#58; No such file or directory (errno 2)
----

So somehow the gass/gram cache directory is either never created,
or immediately deleted again. Any ideas why this would be happening?

See below for the complete output of condor_q -l.
Maybe that&#39;ll help figure out what&#39;s happening.
I&#39;m not sure exactly where these pilots are coming from, but hopefully
an expert can figure this out by looking at the output below.

Local condor submissions work fine, as do my own quick
<div id='show_651389629' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_651389629'>
globus-job-run osgitb1/jobmanager-condor /bin/hostname

tests, and there are no NFS issues with the home area, so I&#39;m not sure
what&#39;s going on.

Hmm -- I just deleted the entire .globus and gram_* areas, just for
good measure -- and then the new pilots started running again for
a little while, but now (after a few minutes) most of them are held
again with the same error.

Seems like something is deleting the cache directories out from
underneath them?

The other things I noticed were that the gratia metric still shows this warning&#58;

<a href='https&#58;//osgitb1.nhn.ou.edu&#58;8443/rsv/osgitb1.nhn.ou.edu.html#org.osg.gratia.metric' target='_blank' rel='nofollow'>https&#58;//osgitb1.nhn.ou.edu&#58;8443/rsv/osgitb1.nhn.ou.edu.html#org.osg.gratia.metric</a>

----
WARNING&#58; The expected directory containing records waiting to be re-sent does not exist (/var/lib/gratia/tmp/gratiafiles/subdir.metric_osgitb1.nhn.ou.edu_rsv.grid.iu.edu_8880).  This might be a problem in the gratia-config-probe itself.  Please report this error to OSG for assistance.
----

I guess the fix for this hasn&#39;t made it into this version just yet?

Also, I can&#39;t find any BDII info on OUHEP_ITB here now&#58;

<a href='http&#58;//myosg.grid.iu.edu/rgbdii/index?datasource=bdii&summary_attrs_showservice=on&summary_attrs_showrsvstatus=on&summary_attrs_showfqdn=on&gip_status_attrs_showtestresults=on&downtime_attrs_showpast=&account_type=cumulative_hours&ce_account_type=gip_vo&se_account_type=vo_transfer_volume&bdiitree_type=total_jobs&bdii_object=cluster&bdii_server=is-osg&start_type=7daysago&start_date=04%2F25%2F2012&end_type=now&end_date=04%2F25%2F2012&rg=on&rg_86=on&gridtype=on&gridtype_1=on&gridtype_2=on&active_value=1&disable_value=1' target='_blank' rel='nofollow'>http&#58;//myosg.grid.iu.edu/rgbdii/index?datasource=bdii&summary_attrs_showservice=on&summary_attrs_showrsvstatus=on&summary_attrs_showfqdn=on&gip_status_attrs_showtestresults=on&downtime_attrs_showpast=&account_type=cumulative_hours&ce_account_type=gip_vo&se_account_type=vo_transfer_volume&bdiitree_type=total_jobs&bdii_object=cluster&bdii_server=is-osg&start_type=7daysago&start_date=04%2F25%2F2012&end_type=now&end_date=04%2F25%2F2012&rg=on&rg_86=on&gridtype=on&gridtype_1=on&gridtype_2=on&active_value=1&disable_value=1</a>

Is that to be expected? Maybe ITB resources don&#39;t report to there,
even though I did check OSG-ITB?

Thanks,

Horst

----
[hs@osgitb1 ~]$ condor_q -l 110628.0

-- Submitter&#58; osgitb1.nhn.ou.edu &#58; &#60;129.15.31.41&#58;64662&#62; &#58; osgitb1.nhn.ou.edu
Out = &#34;/home/usatlas1/.globus/usatlas1/.globus/job/osgitb1/16217781733807197666.933117525531569296/stdout&#34;
GratiaJobOrigin = &#34;GRAM&#34;
LastPublicClaimId = &#34;&#60;129.15.31.45&#58;63676&#62;#1335391309#2#...&#34;
LastRemoteHost = &#34;slot2@....&#34;
LastJobStatus = 2
JobCurrentStartDate = 1335391672
BufferBlockSize = 32768
JobNotification = 0
JobLeaseDuration = 1200
TransferFiles = &#34;NEVER&#34;
HoldReasonCode = 7
ImageSize_RAW = 8
FileSystemDomain = &#34;nhn.ou.edu&#34;
StreamOut = false
NumRestarts = 0
ImageSize = 10
Cmd = &#34;/home/usatlas1/.globus/.gass_cache/local/md5/7b/b1eaa843255c2acbe8df5e190c60b0/md5/e9/f5f0149b21e9d4da65cf037f654be3/data&#34;
LeaveJobInQueue = false
x509UserProxyExpiration = 1335736862
PeriodicRemove = false
Iwd = &#34;/home/usatlas1/gram_scratch_ZjKzJG&#34;
PeriodicHold = false
CondorPlatform = &#34;$CondorPlatform&#58; x86_rhap_5 $&#34;
NumJobMatches = 1
x509UserProxyFirstFQAN = &#34;/atlas/usatlas/Role=production/Capability=NULL&#34;
NumCkpts = 0
RequiresWholeMachine = true
JobStatus = 5
Arguments = &#34;--site=OUHEP_ITB --tpid=tp_gridui12_7761_20120425-220613_2189 --schedid=gridui12 --queue=OUHEP_ITB_MPI-condor&#34;
ExitBySignal = false
EnteredCurrentStatus = 1335391672
ClusterId = 110628
In = &#34;/dev/null&#34;
CondorVersion = &#34;$CondorVersion&#58; 7.6.0 Apr 18 2011 BuildID&#58; 327697 $&#34;
RemoteUserCpu = 0.0
WantRemoteSyscalls = false
MinHosts = 1
NumSystemHolds = 0
JobUniverse = 5
StartdPrincipal = &#34;unauthenticated@unmapped/129.15.31.45&#34;
x509UserProxyFQAN = &#34;/DC=org/DC=doegrids/OU=People/CN=Nurcan Ozturk 18551,/atlas/usatlas/Role=production/Capability=NULL,/atlas/Role=production/Capability=NULL,/atlas/lcg1/Role=NULL/Capability=NULL,/atlas/team/Role=NULL/Capability=NULL,/atlas/usatlas/Role=NULL/Capability=NULL,/atlas/Role=NULL/Capability=NULL&#34;
BytesSent = 0.0
PeriodicRelease = false
RequestDisk = DiskUsage
CumulativeSuspensionTime = 0
ExecutableSize = 10
MachineAttrSlotWeight0 = 1
Requirements = ( CAN_RUN_WHOLE_MACHINE =?= true ) && ( TARGET.Arch == &#34;INTEL&#34; ) && ( TARGET.OpSys == &#34;LINUX&#34; ) && ( TARGET.Disk &#62;= DiskUsage ) && ( ( TARGET.Memory * 1024 ) &#62;= ImageSize ) && ( ( RequestMemory * 1024 ) &#62;= ImageSize ) && ( TARGET.FileSystemDomain == MY.FileSystemDomain )
RootDir = &#34;/&#34;
ShouldTransferFiles = &#34;NO&#34;
CommittedSlotTime = 0
GlobalJobId = &#34;osgitb1.nhn.ou.edu#110628.0#1335391584&#34;
LocalSysCpu = 0.0
DiskUsage = 10
UserLog = &#34;/var/lib/globus/gram_job_state/condor.16217781733807197666.933117525531569296&#34;
x509UserProxyVOName = &#34;atlas&#34;
RequestMemory = ceiling(ifThenElse(JobVMMemory =!= undefined,JobVMMemory,ImageSize / 1024.000000))
HoldReasonSubCode = 2
NumCkpts_RAW = 0
Env = &#34;PATH=/sbin&#58;/usr/sbin&#58;/bin&#58;/usr/bin;LD_LIBRARY_PATH=/usr/lib;GLOBUS_REMOTE_IO_URL=/home/usatlas1/.globus/usatlas1/.globus/job/osgitb1/16217781733807197666.933117525531569296/remote_io_file;OSG_JOB_CONTACT=osgitb1.nhn.ou.edu/jobmanager-condor;OSG_SQUID_LOCATION=UNAVAILABLE;OSG_DEFAULT_SE=osgitb1.nhn.ou.edu;OSG_GRID=/opt/osgwn;GLOBUS_TCP_SOURCE_RANGE=63001,65000;GLOBUS_LOCATION=/usr;OSG_HOSTNAME=osgitb1.nhn.ou.edu;GLOBUS_TCP_PORT_RANGE=63001,65000;OSG_STORAGE_ELEMENT=True;GLOBUS_GRAM_JOB_CONTACT=<a href='https&#58;//osgitb1.nhn.ou.edu&#58;64979/16217781733807197666/933117525531569296/' target='_blank' rel='nofollow'>https&#58;//osgitb1.nhn.ou.edu&#58;64979/16217781733807197666/933117525531569296/</a>;OSG_SITE_NAME=OUHEP_ITB;GLOBUS_GASS_CACHE_DEFAULT=/home/usatlas1/.globus/.gass_cache;OSG_APP=/usr/local/osg_app;OSG_WN_TMP=/myhome1/atlas/osg/tmp;ATLAS_LOCAL_AREA=/usr/local/osg_app/atlas_app/local;SCRATCH_DIRECTORY=/home/usatlas1//gram_scratch_ZjKzJG;X509_USER_PROXY=/home/usatlas1/.globus/usatlas1/.globus/job/osgitb1/16217781733807197666.933117525531569296/x509_user_proxy;VO_ATLAS_SW_DIR=/cvmfs/atlas.cern.ch/rep!
o/sw;OSG_S
ITE_WRITE=/home/osg_data;OSG_GLEXEC_LOCATION=None;OSG_DATA=/home/osg_data;HOME=/home/usatlas1;LOGNAME=usatlas1;OSG_SITE_READ=/home/osg_data&#34;
ExecutableSize_RAW = 8
MaxHosts = 1
ServerTime = 1335392895
CoreSize = 0
JobStartDate = 1335391672
LastJobLeaseRenewal = 1335391672
WantCheckpoint = false
ProcId = 0
x509userproxysubject = &#34;/DC=org/DC=doegrids/OU=People/CN=Nurcan Ozturk 18551&#34;
OrigMaxHosts = 1
Err = &#34;/home/usatlas1/.globus/usatlas1/.globus/job/osgitb1/16217781733807197666.933117525531569296/stderr&#34;
CurrentHosts = 0
BytesRecvd = 0.0
EnvDelim = &#34;;&#34;
DiskUsage_RAW = 8
HoldReason = &#34;Error from slot2@....&#58; Failed to open &#39;/home/usatlas1/.globus/usatlas1/.globus/job/osgitb1/16217781733807197666.933117525531569296/stdout&#39; as standard output&#58; No such file or directory (errno 2)&#34;
UserLogUseXML = true
CommittedTime = 0
RemoteSysCpu = 0.0
OnExitRemove = true
AutoClusterAttrs = &#34;JobUniverse,LastCheckpointPlatform,NumCkpts,RequiresWholeMachine,SubmittorUserPrio,FileSystemDomain,DiskUsage,ImageSize,RequestMemory,Requirements,NiceUser,ConcurrencyLimits&#34;
TotalSuspensions = 0
RequestCpus = 1
LocalUserCpu = 0.0
StreamErr = false
NiceUser = false
AutoClusterId = 2
TargetType = &#34;Machine&#34;
QDate = 1335391584
LastMatchTime = 1335391672
CompletionDate = 0
OnExitHold = false
Rank = 0.0
JobPrio = 0
RemoteWallClockTime = 0.0
NumJobStarts = 0
NumShadowStarts = 1
WantRemoteIO = true
CumulativeSlotTime = 0.0
CurrentTime = time()
User = &#34;usatlas1@....&#34;
MachineAttrCpus0 = 1
JobRunCount = 1
BufferSize = 524288
ExitStatus = 0
MyType = &#34;Job&#34;
x509userproxy = &#34;/home/usatlas1/.globus/usatlas1/.globus/job/osgitb1/16217781733807197666.933117525531569296/x509_user_proxy&#34;
CommittedSuspensionTime = 0
LastSuspensionTime = 0
Owner = &#34;usatlas1&#34;
TransferIn = false
</div><script type='text/javascript'>
        $('#show_651389629').click(function() {
            $('#detail_651389629').slideDown("normal");
            $('#show_651389629').hide();
            $('#hide_651389629').show();
        });
        $('#hide_651389629').click(function() {
            $('#detail_651389629').slideUp();
            $('#hide_651389629').hide();
            $('#show_651389629').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='12064#1335815112'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-04-30T19:45:12+00:00">Apr 30, 2012 07:45 PM UTC</time> by <b>Alain Roy</b><a class="anchor" name="1335815112">&nbsp;</a></div><pre>Adding Sarah Williams, suggested by Horst.</pre></div><div class='update_description'><i onclick="document.location='12064#1335815104'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-04-30T19:45:04+00:00">Apr 30, 2012 07:45 PM UTC</time><a class="anchor" name="1335815104">&nbsp;</a></div><pre>Adding myself as CC.

-- by Brian Bockelman</pre></div><div class='update_description'><i onclick="document.location='12064#1335813608'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-04-30T19:20:08+00:00">Apr 30, 2012 07:20 PM UTC</time> by <b>Horst Severini</b><a class="anchor" name="1335813608">&nbsp;</a></div><pre>Hi all,

okay, I can confirm that after downgrading the globus-gram-job-manager
and condor_release&#39;ing all the Held jobs, they are now running fine,
just like Bockjoo saw on his site.

What I don&#39;t understand is how these jobs could restart properly,
since when I looked at some of the errors, these gass cache directories
did in fact not exist, so how can releasing these jobs even work in principle?
Shouldn&#39;t they get immediately held again with the same error?
Or does the downgraded jobmanager re-create these directories?

Thanks,

Horst</pre></div><div class='update_description'><i onclick="document.location='12064#1335811267'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-04-30T18:41:07+00:00">Apr 30, 2012 06:41 PM UTC</time> by <b>Horst Severini</b><a class="anchor" name="1335811267">&nbsp;</a></div><pre>Hi Rob,

thanks -- actually, the ticket should be for a faulty globus-jobmanager
in release 3.1.0, though, not about how to downgrade it. Well, I suppose
either way is fine, since until it&#39;s fixed, people will have to downgrade,
anyway. &#58;)

Thanks,

HOrst</pre></div><div class='update_description'><i onclick="document.location='12064#1335810513'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-04-30T18:28:33+00:00">Apr 30, 2012 06:28 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1335810513">&nbsp;</a></div><pre>[by Horst Severini]

-------- Original Message --------
Subject&#58; Re&#58; How to downgrade OSG 3.1.0 to a specific lower version?
Date&#58; Mon, 30 Apr 2012 11&#58;17&#58;19 -0500
From&#58; Horst Severini &#60;hs@....&#62;
Reply-To&#58; hs@....
To&#58; roy@...., bockjoo@....
CC&#58; osg-int@....

Hi Alain,

I asked for a GOC ticket to be created on Sat or Sun, but haven&#39;t seen it
yet. We should only create one, since it&#39;s most likely the same bug we&#39;re
seeing.

And yes, I can downgrade. What&#39;s the simplest way to do that?
Just the globus jobmanager?

Thanks,

Horst

Alain Roy &#60;roy@....&#62; wrote&#58;

Interesting. That&#39;s the same errors that Horst had! That&#39;s a bad sign.

Horst, can you try the downgrade on your integration testbed CE and see if it helps? Since it&#39;s on the ITB, I might ask you to restore it back to the bad version so that we can debug, but that will narrow down the problem more precisely.

Thanks,
-alain

On Apr 30, 2012, at 10&#58;05 AM, Bockjoo Kim wrote&#58;
After downgrading it using the command
yum downgrade globus-gram-job-manager
<div id='show_1739732523' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_1739732523'>, I am seeing
[root@pg cmssoft]# rpm -qa | grep globus-gram-job-manager-13
globus-gram-job-manager-13.23-0.10.osg.el5.x86_64

condor_q shows no held jobs so far&#58;
[root@pg cmssoft]# condor_q | tail -1
388 jobs; 3 idle, 385 running, 0 held

Otherwise, I would see something like this in the /var/log/condor/ShadowLog by now&#58;
04/30/12 10&#58;39&#58;02 (3336.0) (15527)&#58; Job 3336.0 going into Hold state (code 12,2)&#58; Error from slot3@....&#58; STARTER at 128.227.221.166 failed to send file(s) to &#60;128.227.221.11&#58;39362&#62;; SHADOW at 128.227.221.11 failed to write to file /share/home/cms33877/.globus/cms33877/.globus/job/pg/16217900490863636176.15353058390121119907/stdout&#58; (errno 2) No such file or directory

By the way, ShadowLog ownership is correct ( had been correct in 3.1.0 too)&#58;
[root@pg cmssoft]# ls -al  /var/log/condor/ShadowLog
-rw-r--r-- 1 condor condor 483070 Apr 30 11&#58;04 /var/log/condor/ShadowLog

So, yes, downgrading it fixed the held jobs immediately.
Bockjoo

On 4/30/12 10&#58;53 AM, Alain Roy wrote&#58;
On Apr 30, 2012, at 9&#58;45 AM, Bockjoo Kim wrote&#58;
Per Brian&#39;s instruction, I have downgraded only globus-gram-jobmanager.
Did it help?

-alain

</div><script type='text/javascript'>
        $('#show_1739732523').click(function() {
            $('#detail_1739732523').slideDown("normal");
            $('#show_1739732523').hide();
            $('#hide_1739732523').show();
        });
        $('#hide_1739732523').click(function() {
            $('#detail_1739732523').slideUp();
            $('#hide_1739732523').hide();
            $('#show_1739732523').show();
        });
        </script></pre></div><legend>Similar Recent Tickets <small>modified within the last 30 days</small></legend><div id="similar_tickets"><p class="muted">No similar tickets found.</p></div>
</div>
<script type="text/javascript">
function reset_anchor() {
    $("#updates .selected").removeClass("selected");
    var urls = document.location.toString().split('#'); 
    var anchor = urls[1];
    if(anchor) {
        $("a[name='"+anchor+"']").parents(".update_description").addClass("selected");
    }
}
function submitspam(ticket_id) {
    myret = confirm("Would you like to close this ticket as a security ticket, and submit the ticket content to akismet?");
    if(myret == true) {
        $.ajax("viewer/processspam?id="+ticket_id).done(function() {
            window.location.reload();
        });
    }
}

$(function() {
    reset_anchor();
    var ADDITIONAL_COOKIE_NAME = 'gocticket';
    var options = { path: '/', expires: 365};

    if(window.opener && window.opener.name == "gocticket_list") {
        v = $.cookie("closewindow");
        if(!v) {
            $("#closewindow").attr("checked", "checked"); //on by default
        } else {
            if(v == "checked") {
                $("#closewindow").attr("checked", "checked");
            }
        }
        $("#closewindow").click(function() {
            $.cookie("closewindow", $(this).attr('checked'), options);
        });
    } else {
        $("#closewindow_area").hide();
    }
    function updateTimeago() {
        $("time").timeago();
        setTimeout(updateTimeago, 30*1000);
    }
    updateTimeago();
    $(".description").focus(expand_description);
});
</script>
<hr/>
<footer>
<p>GOC Ticket Version 2.2 | <a href="https://ticket.opensciencegrid.org/goc/submit?app_issue_check=on&amp;app_issue_type=goc&amp;app_goc_url=https%3A%2F%2Fticket.opensciencegrid.org%3A443%2F12064">Report Bugs</a>
 | <a href="https://github.com/opensciencegrid/operations/blob/master/docs/privacy.md">Privacy Policy</a>
</p>

<p> <img align="top" src="/images/tag_orange.png"/> Copyright 2018 The Trustees of Indiana University - Developed for Open Science Grid</p>
</footer>


</div><!--container-fluid-->
<script src="https://ticket1.grid.iu.edu:8443/socket.io/socket.io.js"></script>
<script>
var chat = io.connect('https://ticket1.grid.iu.edu:8443');
chat.on('connect', function() {
    chat.emit('authenticate', {nodekey:'', ticketid: 12064});
});
chat.on('peers', function(peers) {
    $("#peers").html("");
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('peer_disconnect', function(pid) {
    $("#peer_"+pid).hide("slow");
});
chat.on('peer_connected', function(peers) {
    //expect only 1 peer connecting, but..
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('submit', function() {
    if(confirm("This ticket was updated. Do you want to refresh?")) {
        history.go(0);
    }
});

function addPeer(pid, peer) {
    var ipinfo = "";
    if(peer.ip != undefined) {
        ipinfo = "<span class=\"ip\">"+peer.ip+"</span>";
    }
    if(chat.io.engine.id == pid) {
        //don't display myself
        return;
    }
    var html = "<li class=\"new\" id=\"peer_"+pid+"\" class=\"peer\">"+peer.name+ipinfo+"</li>";
    $("#peers").prepend(html);
    $("#peers .new").animate({bottom: 0}, 1000, function() {$(this).removeClass("new")});
}

$(function() {
    $("#ticket_form").submit(function() {
        chat.emit('submit');
        return true;
    });
});
</script>
<script>
//used by searchbox
function parseValue(value) {
    var obj = new Object();
    var tokens = value.split("\t");
    obj.str = tokens[0];
    obj.count = tokens[1];
    return obj;
}

$(function() {
    //bootstrap-2.0.4 stuff
    $(".alert-message").alert();
    $(".dropdown-toggle").dropdown();
    $("span[rel='tooltip']").tooltip();
    $("a[rel=popover]").popover();

    //activate menu that user is currently on
    $("#menu_navigator").addClass("active"); 
    $("#submenu_").addClass("active"); 

    //translate zend validation error message to bootstrap
    $(".errors").addClass("alert").addClass("alert-error");

    //enable autocomplete for search box
    $("#search").autocomplete({
        source: function( request, response ) {
            $.ajax({
                url: "search/autocomplete",
                dataType: "text",
                data: {
                    //featureClass: "P",
                    //style: "full",
                    //maxRows: 12,
                    //name_startsWith: request.term
                    q: request.term
                },
                success: function( data ) {
                    response( $.map( data.split("\n"), function( item ) {
                        if(item == "") return null;
                        return {
                            value: item
                        }
                    }));
                }
            });
        },
        select: function(event, ui) {
            document.location = "search?q="+ui.item.value;
        }
    });
    
});
</script>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-69012-13");
pageTracker._trackPageview();
} catch(err) {}
</script>

</body>
