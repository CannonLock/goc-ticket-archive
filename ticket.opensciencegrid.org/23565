<!DOCTYPE html>
<html lang="en">
  <head>
  <base href="/">
    <title>[23565] Site pre-emption times</title>    <meta charset="utf-8" />
    <meta name="verify-v1" content="na5IcAJsZVOfEkboRxuIiZ1zpZgnZiWra+nKcS7nA/o=" />
    <meta name="google-site-verification" content="DLrk3ft4s8b-S2TloLCL2LD_t6wcTjgSluf5pmiu2kA" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />
    <link href="https://ticket.opensciencegrid.org/rss" rel="alternate" type="application/rss+xml" title="GOC Ticket Update feed" />

    <style type="text/css">
      body {
        padding-top: 50px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
     #search {
            width: 300px;
     }

    </style>

<script src="https://code.jquery.com/jquery-3.0.0.js"></script>
<script src="https://code.jquery.com/jquery-migrate-3.0.1.js"></script>

   <link href="//netdna.bootstrapcdn.com/bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet"/>
    <script src="//netdna.bootstrapcdn.com/bootstrap/2.3.2/js/bootstrap.min.js"></script>

    <link href="//netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"/>
    <link href="//ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/themes/smoothness/jquery-ui.min.css" rel="stylesheet"/>
 <script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>


    <link href="//cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/css/select2.min.css" rel="stylesheet" />
    <script src="//cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/js/select2.min.js"></script>

    <link href="css/ticket.css" rel="stylesheet" />
    <script src="lib/jquery.cookie.js"></script>

    <link href="images/tag_orange.png" rel="icon" type="image/png"/>
    <script src='https://www.google.com/recaptcha/api.js'></script>
  </head>

  <body>
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>

            <a class="brand" style="padding: 6px 0px 0px 6px;" href="http://opensciencegrid.org"><img src="https://ticket.opensciencegrid.org/images/osglogo.40x30.png"/></a>
            <ul class="nav">
                <li class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown">GOC Ticket <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    <li><a href="https://my.opensciencegrid.org">MyOSG</a></li>
                    <li><a href="https://oim.opensciencegrid.org">OIM</a></li>
                    <li class="active"><a href="index">Ticket</a></li>
	<li class="divider"></li>
	<li><a href="http://repo.grid.iu.edu">Repo</a></li>
	<li class="divider"></li>
	<li><a href="http://blogs.grid.iu.edu">Blog</a></li>
                    <li><a href="http://display.grid.iu.edu">Display</a></li>
                    <li><a href="http://osggoc.blogspot.com/">News</a></li>
                    </ul>
                </li>
            </ul>
            <ul class="nav pull-right">
                <li><a href="https://ticket.opensciencegrid.org/sso/">Login</a></li>            </ul>

            <div class="nav-collapse">
                <ul class="nav">
			 <li id="menu_submit"><a href="https://ticket.opensciencegrid.org/submit">Submit</a></li><li id="menu_view" class="dropdown"><a href="\#" class="dropdown-toggle" data-toggle="dropdown">View <b class="caret"></b></a><ul class="dropdown-menu"><li id="submenu_listopen"><a href="https://ticket.opensciencegrid.org/list/open">Open Tickets</a></li><li id="submenu_listrecentclose"><a href="https://ticket.opensciencegrid.org/list/recentclose">Recently Closed Tickets</a></li><li class="divider"></li><li id="submenu_alltickets"><a href="https://ticket.opensciencegrid.org/search?q=&amp;sort=id">All Tickets</a></li></ul></li>                </ul>

                <form class="navbar-search pull-right" action="viewer">
                    <input id="search" type="text" name="id" class="search-query span2" placeholder="Search Ticket" value=""/>
                </form>
            </div>
        </div>
      </div>
    </div>

<script type='text/javascript' src='lib/jquery.timeago.js'></script>
<script type='text/javascript' src='lib/byte2size.js'></script>
<style>
#updates .toolbar {
position: relative;
margin-top: 0px;
top: -10px;
font-weight: normal;
}
#updates a.anchor {
position: relative;
top: -50px;
}
#updates .selected pre {
animation:selected 2s;
animation-iteration-count: 2;
animation-direction: alternate;
-webkit-animation:selected 2s; 
-webkit-animation-iteration-count: 2;
-webkit-animation-direction: alternate;
box-shadow: inset 1px 1px 20px #9ad;
border: 1px solid #9ab;
margin: 5px 0px;
padding-left: 10px;
}
@keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ab;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
@-webkit-keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ad;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
#updates pre {
background-color: inherit;
line-height: 15px;
padding: 5px;
}
#updates .header {
color: #999;
}
#updates .update_history pre {
background-color: #eee;
color: #666;
font-size: 85%;
}
#updates .clickable {
cursor: pointer;
}
#updates .clickable:hover {
color: #D98719;
}
#updates .meta_information pre {
background-color: #fed;
}
#similar_tickets {
max-height: 300px;
overflow-y: auto;
pointer-events: none;
padding: 5px;
background-color: #f4f4f4;
}
.btn-toolbar {
margin-bottom: 0;
height: 30px;
}
#peers {
position: fixed;
bottom: 0px;
right: 0px;
z-index: 100;
list-style: none;
padding: 5px 0px 0px 5px;
margin: 0px;
background-color: white;
box-shadow: 0px 0px 10px white;
}
#peers li {
background-color: #ccc;
color: #000;
display: inline-block;
padding: 5px 10px;
margin-right: 5px;
position: relative;
}
/*
#peers li:hover {
background-color: #999;
cursor: pointer;
}
*/
#peers span.ip {
padding-left: 5px;
color: #666;
}
#peers .new {
bottom: -30px;
}
/*
#peers .me {
background-color: red;
}
*/
</style>

<div class="container-fluid">
<ul id="peers"></ul>
<div class="alert alert-danger"><a class="close" href="#" data-dismiss="alert">&times;</a>By the end of May 2018, the ticketing system at https://ticket.opensciencegrid.org will be retired and support will be provided at https://support.opensciencegrid.org. Throughout this transition the support email (help@opensciencegrid.org) will be available as a point of contact.<br><br>                                                   
                                                                                                                                                                                   
Please see the service migration page for details: https://opensciencegrid.github.io/technology/policy/service-migrations-spring-2018/#ticket</div><div id="presence" class="pull-right"></div><div class="ticketgui"><script type="text/javascript" src="https://ticket.opensciencegrid.org/lib/checktab.js"></script>

<script>
var expanded = false;
function expand_description() {
    var desc = $(".description");
    if(!expanded) {
        expanded = true;
        //expand to minheight
        var min = 250;
        if(desc.height() < min) {
            desc.animate({height: min}, 200);
        }
    }
}

$(document).ready(function() {
    $("input[name='nad']").datepicker({
        dateFormat: 'yy-mm-dd'
    });
});

</script>



<style>
.form-horizontal .control-label {
padding-top: inherit;
font-size:90%;
color:#666;
}
label {
margin-bottom: 0px;
}
.controls {
line-height: 18px;
}
</style>
<form class="form-horizontal" action="https://ticket.opensciencegrid.org/viewer/updatebasic?id=23565" method="post">
<div class="page-header">
    <h3><span class="muted">23565</span> / Site pre-emption times</h3>
</div>

<div class="row-fluid">
<div class="span5">
    <legend>Contact</legend>
    <div class="control-group">
        <label class="control-label">Full Name</label>
        <div class="controls">Raymond Lloyd Culbertson</div>
    </div>
    <div class="control-group">
        <label class="control-label">Email</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">Phone</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">CC</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>

    <legend>Details</legend>
    <div class="control-group"><label class="control-label">Submitted Via</label><div class="controls">GOC Ticket/submit</div></div><div class="control-group"><label class="control-label">Submitter</label><div class="controls">Raymond Lloyd Culbertson</div></div>
    <div class="control-group">
        <label class="control-label">Ticket Type</label>
        <div class="controls">Problem/Request</div>
    </div>
    <div class="control-group">
        <label class="control-label">Priority</label>
        <div class="controls">Normal</div>
    </div>
    <div class="control-group">
        <label class="control-label">Status</label>
        <div class="controls">
Closed</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action</label>
        <div class="controls">ENG Action</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action Deadline</label>
        <div class="controls flag_red">2015-01-12</div>
    </div>

</div><!--span-->
<div class="span7">
    <legend>Assignees</legend>
    <div class="assignee" style="width: 60%">OSG Glidein Factory Support <span class="muted"> / OSG Support Centers</span></div><div class="assignee" style="width: 60%">USATLAS (BNL Prod)&nbsp;<a target="_blank" href="https://rt.racf.bnl.gov/rt/Ticket/Display.html?id=25046">25046</a> <span class="muted"> / Ticket Exchange</span></div>    <br>

    <legend>Assignees</legend>
    TODO
    <br>

    <style>
legend.noborder {
border-bottom: none;
}
</style>

<div id="attachment-list"/>
<script>
$(function () {
    var first = true;
    $.getJSON("https://ticket.opensciencegrid.org/attachment/list?id=23565", function (files) {
        //console.dir(files);
        var html = "<table class=\"table table-condensed\">";
        $(files).each(function() {
            if(first) {
                first = false;
                html += "<legend class=\"noborder\">Attachmenets</legend>";
            }
            html += "<tr class=\"attachment\">";
            html += "<td><img src=\""+this.thumbnail_url+"\"/></td>";
            html += "<td><a href=\""+this.url+"\" target=\"_blank\">"+this.name+"</a></td>";
            html += "<td>"+bytesToSize(this.size, 1)+"</td>";
            html += "</tr>";
        });
        html += "</table>";
        $("#attachment-list").html(html);
    });
});

function download(url) {
    window.open(url, "_blank");
}
</script>


</div><!--span-->
</div><!--row-fluid-->


</form>

</div>
<div id="updates" style="clear: both;">
    <legend>Past Updates
    <div class="btn-toolbar pull-right toolbar">
        <div class="btn-group">
                <a class="btn btn-small" href="/23565?sort=up&"><i class="icon-arrow-up"></i> Sort</a>

        
        <a class="btn btn-small" href="/23565?expandall=true&">Expand Descriptions</a>        <a class="btn btn-small" target="_blank" href="mailto:osg@tick.globalnoc.iu.edu?subject=Open%20Science%20Grid%3A%20Site%20pre-emption%20times%20ISSUE%3D23565%20PROJ%3D71"><i class="icon-envelope"></i> Update w/Email</a>
        </div>
    </div><!--btn-toolbar-->
    </legend>

    <div class='update_description'><i onclick="document.location='23565#1452284906'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-01-08T20:28:26+00:00">Jan 8, 2016 08:28 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1452284906">&nbsp;</a></div><pre>closing old ticket
-- by hiroito at Fri Jan 08 20&#58;28&#58;17 UTC 2016

GOCTX Source&#58; BNL Ticket&#58; Queue=StorageManagement ID=25046</pre></div><div class='update_description'><i onclick="document.location='23565#1421093062'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-01-12T20:04:22+00:00">Jan 12, 2015 08:04 PM UTC</time> by <b>echism</b><a class="anchor" name="1421093062">&nbsp;</a></div><pre>Thanks Ray!

We will reference that information if you run into bottlenecks. Feel free to contact us again if anything comes up.</pre></div><div class='update_description'><i onclick="document.location='23565#1420832237'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-01-09T19:37:17+00:00">Jan 9, 2015 07:37 PM UTC</time> by <b>rlc@....</b><a class="anchor" name="1420832237">&nbsp;</a></div><pre>Thank you for your careful attention to this question.  I understand now
that for all sites other than than Fermilab itself,
- we are subject to preemption everywhere
- premption will probably not be routine but
will probably be only in response to some particular
urgent job that site is addressing.
- is not very common, by informal observation
- our jobs will restart automatically somewhere else
- I have instructions to find the normal time limits on sites

I am satisfied with this answer so you can close the ticket.
We do not have a problem right now, but will face this issue
in the coming months.
Just so that you know, I&#39;ll describe the problems
behind my question.  We have two main workflows.
1) MC workflow.  These jobs can be restarted and the only problems are
a) there can be messy conflicts in the output directories
if premptions (or any other restart) occurs near the end of the job.
We have scripted around this for now, but this is a layer of
complexity it would be nice to get rid of.
b) restarted jobs take longer to finish, so it throws off
simple scheduling.  Jobs not restarted take 8h, restarted take
up to 16h, or possibly more.
2) SAM workflow.  These jobs are driven by an input dataset in a
Fermilab catalog called SAM.  Restarts in these jobs
will fail since the system is not designed to handle
the interupt in data delivery. Restarted sections
have to be cleaned up and a second submission
prepared and started.  This can also be scripted but is  a
layer of complexity it would be nice to avoid.
I wonder about the possibility of having a policy
of blocking preemption for the first N hours of a job (N ~8).
This way, a user can make sure his jobs will complete if he
designs them correctly, while not keeping the high-priority
jobs waiting too long (they would probably take slots from
<div id='show_1480222512' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_1480222512'>older jobs too).  I&#39;m sure this has been discussed many times
in the past and current policies are well motivated, so I guess
I&#39;m just adding my vote at this point.
Thanks,
Ray

Ray Culbertson  CDF/FNAL  rlc@....  630-840-6744  Trailers 170F (MS318)
</div><script type='text/javascript'>
        $('#show_1480222512').click(function() {
            $('#detail_1480222512').slideDown("normal");
            $('#show_1480222512').hide();
            $('#hide_1480222512').show();
        });
        $('#hide_1480222512').click(function() {
            $('#detail_1480222512').slideUp();
            $('#hide_1480222512').hide();
            $('#show_1480222512').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='23565#1420825455'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-01-09T17:44:15+00:00">Jan 9, 2015 05:44 PM UTC</time> by <b>echism</b><a class="anchor" name="1420825455">&nbsp;</a></div><pre>Hey Ray,

I know this was a lot of information! I hope any/all of this will be useful as you proceed. I think overall, we should work closely together, using the methods we have covered and do a little bit of trial and error and try to address your bottlenecks. Does that seem satisfactory to you?

Thanks</pre></div><div class='update_description'><i onclick="document.location='23565#1420654376'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-01-07T18:12:56+00:00">Jan 7, 2015 06:12 PM UTC</time><a class="anchor" name="1420654376">&nbsp;</a></div><pre>Hi All,

Since this is more a policy/site issue. I am removing Software from this ticket.

Cheers,

Edgar
OSG Software Support

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=Edgar Mauricio Fajardo Hernandez 2020</pre></div><div class='update_description'><i onclick="document.location='23565#1420591458'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-01-07T00:44:18+00:00">Jan 7, 2015 12:44 AM UTC</time><a class="anchor" name="1420591458">&nbsp;</a></div><pre>Unfortunately, Factory ops is actually pretty isolated from preemption.

Preemption policies are largely decided on a site by site basis, and as far as I know they don&#39;t typically advertise these anywhere.  We also don&#39;t have good monitoring in the factory side to obviously show preemption, we can only infer it if the glideins have unusually short runtimes and aren&#39;t returning logs back.

To try and answer your original questions though,
1. I don&#39;t believe in general you are ever guaranteed even at least a minimum runtime, but some sites may be nicer than others in their policies.
2. You can look up the max walltimes here&#58;
<a href='http&#58;//gfactory-1.t2.ucsd.edu/factory/monitor/factoryStatusNow.html?view=Fermilab_frontend&sort=requestIdle' target='_blank' rel='nofollow'>http&#58;//gfactory-1.t2.ucsd.edu/factory/monitor/factoryStatusNow.html?view=Fermilab_frontend&sort=requestIdle</a>

click on any of the sites in the list, from there you will see an attribute published,
GLIDEIN_Max_Walltime (in seconds)

Note there&#39;s another frontend link, Fermilab-fifebatch_frontend.  You&#39;ll have to check with the fermilab admins to see what one mu2e jobs are submitted through.

Hope this helps,
Jeff Dost
OSG Glidein Factory Operations

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=jdost/CN=732648/CN=Jeffrey Michael Dost</pre></div><div class='update_description'><i onclick="document.location='23565#1420501919'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-01-05T23:51:59+00:00">Jan 5, 2015 11:51 PM UTC</time><a class="anchor" name="1420501919">&nbsp;</a></div><pre>Hi Elizabeth,

I think  GOC Operation and maybe Gfactory operations are better suited to answer this question than software. They have a much better experience take on how OSG VO&#39;s are doing nowadays dealing with preemtiion pre run2  at each site (notice this is really important since each site has it is own policies).

Ray,

That being said, bear in mind if you are using glideins and then you can administer the maxJobRetries on the Glidein Frontend (HTCondor Schedd). If your job is preempted HTCondor automatically will find a new glidein (that matches the job requirement) where to run the preempted job. So you definitely don&#39;t have to change anything on your job submission procedure.

I think sites usually allow jobs to run for 48 hours max, but I might be wrong and each site has their policies so again gfactory operations can answer this better to you than software. Elizabeth, Vince if you agree I am removing software from this ticket.

Cheeers,

Edgar
OSG Software Team

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=Edgar Mauricio Fajardo Hernandez 2020</pre></div><div class='update_description'><i onclick="document.location='23565#1420495082'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-01-05T21:58:02+00:00">Jan 5, 2015 09:58 PM UTC</time> by <b>echism</b><a class="anchor" name="1420495082">&nbsp;</a></div><pre>Hey Software team,

Do you have any thoughts on this?

I have seen the estimated run time parameter in here, but I don&#39;t know if it helps pre emption
<a href='http&#58;//www.hep.wisc.edu/computing/condor.html#osg' target='_blank' rel='nofollow'>http&#58;//www.hep.wisc.edu/computing/condor.html#osg</a>

Thanks!</pre></div><div class='update_description'><i onclick="document.location='23565#1419270574'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-12-22T17:49:34+00:00">Dec 22, 2014 05:49 PM UTC</time> by <b>echism</b><a class="anchor" name="1419270574">&nbsp;</a></div><pre>Hi Ray,

I&#39;ve been researching this, but my answers so far have been unsatisfactory. The last study of pre-emption that I am aware of was done a very long time ago in an era before glideins, so I think it is no longer representative. I have my feelers out for some newer work.

Thank you for your patience.</pre></div><div class='update_description'><i onclick="document.location='23565#1418944031'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-12-18T23:07:11+00:00">Dec 18, 2014 11:07 PM UTC</time> by <b>rlc@....</b><a class="anchor" name="1418944031">&nbsp;</a></div><pre>OK, I understand we have to plan that we could get pre-empted
at any time, and can only increase our chances of avoiding it.
Is there any way you can give me a sense of the rate of pre-emption?
If it is noticable at all, then we have to design retries into
the job submission procedure for some workflows or don&#39;t
use these resources.
I believe we use glide-ins, but as users we are not exposed to them
directly, we use the Fermilab jobsub_client product.  There doesn&#39;t
seem to be an option to request a minimum job time, but I will
take it up with those developers, if needed.  Thanks,
Ray

Ray Culbertson  CDF/FNAL  rlc@....  630-840-6744  Trailers 170F (MS318)</pre></div><div class='update_description'><i onclick="document.location='23565#1418941724'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-12-18T22:28:44+00:00">Dec 18, 2014 10:28 PM UTC</time> by <b>echism</b><a class="anchor" name="1418941724">&nbsp;</a></div><pre>Hi Ray,

Pre-emption is generally done by manual intervention, rather than by automation, so if you want to avoid it, I would suggest looking for a resource that has a lot of open job slots and run at an unpopular time period. I think using glideins might help you find good matches as far as CPU time. Have you used glideins before?

Thank you</pre></div><div class='update_description'><i onclick="document.location='23565#1418940225'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-12-18T22:03:45+00:00">Dec 18, 2014 10:03 PM UTC</time> by <b>Vince Neal</b><a class="anchor" name="1418940225">&nbsp;</a></div><pre>Hi,
The mu2e VO will soon start submitting jobs to OSG outside of Fermilab.
I&#39;ve been told that the various sites we might land on will have various
pe-emption policies.  How can I understand these policies in some more detail?
In particular, if I land on a particular site as an opportunistic user, will
my job be guarenteed a minimum amount of time to run, such as 8h,
before it can be pre-empted?  I would also like to know the maximum
time allowed on sites.  Thanks,
Ray

Ray Culbertson  CDF/FNAL  rlc@....  630-840-6744  Trailers 170F (MS318)</pre></div><legend>Similar Recent Tickets <small>modified within the last 30 days</small></legend><div id="similar_tickets"><p class="muted">No similar tickets found.</p></div>
</div>
<script type="text/javascript">
function reset_anchor() {
    $("#updates .selected").removeClass("selected");
    var urls = document.location.toString().split('#'); 
    var anchor = urls[1];
    if(anchor) {
        $("a[name='"+anchor+"']").parents(".update_description").addClass("selected");
    }
}
function submitspam(ticket_id) {
    myret = confirm("Would you like to close this ticket as a security ticket, and submit the ticket content to akismet?");
    if(myret == true) {
        $.ajax("viewer/processspam?id="+ticket_id).done(function() {
            window.location.reload();
        });
    }
}

$(function() {
    reset_anchor();
    var ADDITIONAL_COOKIE_NAME = 'gocticket';
    var options = { path: '/', expires: 365};

    if(window.opener && window.opener.name == "gocticket_list") {
        v = $.cookie("closewindow");
        if(!v) {
            $("#closewindow").attr("checked", "checked"); //on by default
        } else {
            if(v == "checked") {
                $("#closewindow").attr("checked", "checked");
            }
        }
        $("#closewindow").click(function() {
            $.cookie("closewindow", $(this).attr('checked'), options);
        });
    } else {
        $("#closewindow_area").hide();
    }
    function updateTimeago() {
        $("time").timeago();
        setTimeout(updateTimeago, 30*1000);
    }
    updateTimeago();
    $(".description").focus(expand_description);
});
</script>
<hr/>
<footer>
<p>GOC Ticket Version 2.2 | <a href="https://ticket.opensciencegrid.org/goc/submit?app_issue_check=on&amp;app_issue_type=goc&amp;app_goc_url=https%3A%2F%2Fticket.opensciencegrid.org%3A443%2F23565">Report Bugs</a>
 | <a href="https://github.com/opensciencegrid/operations/blob/master/docs/privacy.md">Privacy Policy</a>
</p>

<p> <img align="top" src="/images/tag_orange.png"/> Copyright 2018 The Trustees of Indiana University - Developed for Open Science Grid</p>
</footer>


</div><!--container-fluid-->
<script src="https://ticket1.grid.iu.edu:8443/socket.io/socket.io.js"></script>
<script>
var chat = io.connect('https://ticket1.grid.iu.edu:8443');
chat.on('connect', function() {
    chat.emit('authenticate', {nodekey:'', ticketid: 23565});
});
chat.on('peers', function(peers) {
    $("#peers").html("");
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('peer_disconnect', function(pid) {
    $("#peer_"+pid).hide("slow");
});
chat.on('peer_connected', function(peers) {
    //expect only 1 peer connecting, but..
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('submit', function() {
    if(confirm("This ticket was updated. Do you want to refresh?")) {
        history.go(0);
    }
});

function addPeer(pid, peer) {
    var ipinfo = "";
    if(peer.ip != undefined) {
        ipinfo = "<span class=\"ip\">"+peer.ip+"</span>";
    }
    if(chat.io.engine.id == pid) {
        //don't display myself
        return;
    }
    var html = "<li class=\"new\" id=\"peer_"+pid+"\" class=\"peer\">"+peer.name+ipinfo+"</li>";
    $("#peers").prepend(html);
    $("#peers .new").animate({bottom: 0}, 1000, function() {$(this).removeClass("new")});
}

$(function() {
    $("#ticket_form").submit(function() {
        chat.emit('submit');
        return true;
    });
});
</script>
<script>
//used by searchbox
function parseValue(value) {
    var obj = new Object();
    var tokens = value.split("\t");
    obj.str = tokens[0];
    obj.count = tokens[1];
    return obj;
}

$(function() {
    //bootstrap-2.0.4 stuff
    $(".alert-message").alert();
    $(".dropdown-toggle").dropdown();
    $("span[rel='tooltip']").tooltip();
    $("a[rel=popover]").popover();

    //activate menu that user is currently on
    $("#menu_navigator").addClass("active"); 
    $("#submenu_").addClass("active"); 

    //translate zend validation error message to bootstrap
    $(".errors").addClass("alert").addClass("alert-error");

    //enable autocomplete for search box
    $("#search").autocomplete({
        source: function( request, response ) {
            $.ajax({
                url: "search/autocomplete",
                dataType: "text",
                data: {
                    //featureClass: "P",
                    //style: "full",
                    //maxRows: 12,
                    //name_startsWith: request.term
                    q: request.term
                },
                success: function( data ) {
                    response( $.map( data.split("\n"), function( item ) {
                        if(item == "") return null;
                        return {
                            value: item
                        }
                    }));
                }
            });
        },
        select: function(event, ui) {
            document.location = "search?q="+ui.item.value;
        }
    });
    
});
</script>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-69012-13");
pageTracker._trackPageview();
} catch(err) {}
</script>

</body>
