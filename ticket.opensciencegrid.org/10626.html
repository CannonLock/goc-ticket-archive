<!DOCTYPE html>
<html lang="en">
  <head>
  <base href="">
    <title>[10626] Gluex VO Specific Issue</title>    <meta charset="utf-8" />
    <meta name="verify-v1" content="na5IcAJsZVOfEkboRxuIiZ1zpZgnZiWra+nKcS7nA/o=" />
    <meta name="google-site-verification" content="DLrk3ft4s8b-S2TloLCL2LD_t6wcTjgSluf5pmiu2kA" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />
    <meta name="robots" content="noindex, nofollow" />

    <style type="text/css">
      body {
        padding-top: 50px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
     #search {
            width: 300px;
     }

    </style>

<script src="https://code.jquery.com/jquery-3.0.0.js"></script>
<script src="https://code.jquery.com/jquery-migrate-3.0.1.js"></script>

   <link href="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet"/>
    <script src="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/js/bootstrap.min.js"></script>

    <link href="https://netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"/>
    <link href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/themes/smoothness/jquery-ui.min.css" rel="stylesheet"/>
 <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>


    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/js/select2.min.js"></script>

    <link href="css/ticket.css" rel="stylesheet" />
    <script src="lib/jquery.cookie.js"></script>

    <link href="images/tag_orange.png" rel="icon" type="image/png"/>
  </head>

  <body>
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>

            <a class="brand" style="padding: 6px 0px 0px 6px;" href="http://opensciencegrid.org"><img src="images/osglogo.40x30.png"/></a>
            <ul class="nav">
                <li class="dropdown"><a href="https://ticket.opensciencegrid.org/#" class="dropdown-toggle" data-toggle="dropdown">GOC Ticket <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    <li><a href="https://my.opensciencegrid.org">MyOSG</a></li>
                    <li><a href="https://oim.opensciencegrid.org">OIM</a></li>
                    <li class="active"><a href="https://ticket.opensciencegrid.org/index">Ticket</a></li>
	<li class="divider"></li>
	<li><a href="http://repo.grid.iu.edu">Repo</a></li>
	<li class="divider"></li>
	<li><a href="http://blogs.grid.iu.edu">Blog</a></li>
                    <li><a href="http://display.grid.iu.edu">Display</a></li>
                    <li><a href="http://osggoc.blogspot.com/">News</a></li>
                    </ul>
                </li>
            </ul>
            <ul class="nav pull-right">
                <li><a href="https://ticket.opensciencegrid.org/sso/">Login</a></li>            </ul>

            <div class="nav-collapse">
                <ul class="nav">
			 <li id="menu_submit"><a href="https://ticket.opensciencegrid.org/submit">Submit</a></li><li id="menu_view" class="dropdown"><a href="https://ticket.opensciencegrid.org/\#" class="dropdown-toggle" data-toggle="dropdown">View <b class="caret"></b></a><ul class="dropdown-menu"><li id="submenu_listopen"><a href="https://ticket.opensciencegrid.org/list/open">Open Tickets</a></li><li id="submenu_listrecentclose"><a href="https://ticket.opensciencegrid.org/list/recentclose">Recently Closed Tickets</a></li><li class="divider"></li><li id="submenu_alltickets"><a href="https://ticket.opensciencegrid.org/search?q=&amp;sort=id">All Tickets</a></li></ul></li>                </ul>

                <form class="navbar-search pull-right" action="https://ticket.opensciencegrid.org/viewer">
                    <input id="search" type="text" name="id" class="search-query span2" placeholder="Search Ticket" value=""/>
                </form>
            </div>
        </div>
      </div>
    </div>

<script type='text/javascript' src='lib/jquery.timeago.js'></script>
<script type='text/javascript' src='lib/byte2size.js'></script>
<style>
#updates .toolbar {
position: relative;
margin-top: 0px;
top: -10px;
font-weight: normal;
}
#updates a.anchor {
position: relative;
top: -50px;
}
#updates .selected pre {
animation:selected 2s;
animation-iteration-count: 2;
animation-direction: alternate;
-webkit-animation:selected 2s; 
-webkit-animation-iteration-count: 2;
-webkit-animation-direction: alternate;
box-shadow: inset 1px 1px 20px #9ad;
border: 1px solid #9ab;
margin: 5px 0px;
padding-left: 10px;
}
@keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ab;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
@-webkit-keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ad;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
#updates pre {
background-color: inherit;
line-height: 15px;
padding: 5px;
}
#updates .header {
color: #999;
}
#updates .update_history pre {
background-color: #eee;
color: #666;
font-size: 85%;
}
#updates .clickable {
cursor: pointer;
}
#updates .clickable:hover {
color: #D98719;
}
#updates .meta_information pre {
background-color: #fed;
}
#similar_tickets {
max-height: 300px;
overflow-y: auto;
pointer-events: none;
padding: 5px;
background-color: #f4f4f4;
}
.btn-toolbar {
margin-bottom: 0;
height: 30px;
}
#peers {
position: fixed;
bottom: 0px;
right: 0px;
z-index: 100;
list-style: none;
padding: 5px 0px 0px 5px;
margin: 0px;
background-color: white;
box-shadow: 0px 0px 10px white;
}
#peers li {
background-color: #ccc;
color: #000;
display: inline-block;
padding: 5px 10px;
margin-right: 5px;
position: relative;
}
/*
#peers li:hover {
background-color: #999;
cursor: pointer;
}
*/
#peers span.ip {
padding-left: 5px;
color: #666;
}
#peers .new {
bottom: -30px;
}
/*
#peers .me {
background-color: red;
}
*/
</style>

<div class="container-fluid">
<ul id="peers"></ul>
<div class="alert alert-danger"><a class="close" href="https://ticket.opensciencegrid.org/#" data-dismiss="alert">&times;</a>By the end of May 2018, the ticketing system at https://ticket.opensciencegrid.org will be retired and support will be provided at https://support.opensciencegrid.org. Throughout this transition the support email (help@opensciencegrid.org) will be available as a point of contact.<br><br>                                                   
                                                                                                                                                                                   
Please see the service migration page for details: https://opensciencegrid.github.io/technology/policy/service-migrations-spring-2018/#ticket</div><div id="presence" class="pull-right"></div><div class="ticketgui"><script type="text/javascript" src="lib/checktab.js"></script>

<script>
var expanded = false;
function expand_description() {
    var desc = $(".description");
    if(!expanded) {
        expanded = true;
        //expand to minheight
        var min = 250;
        if(desc.height() < min) {
            desc.animate({height: min}, 200);
        }
    }
}

$(document).ready(function() {
    $("input[name='nad']").datepicker({
        dateFormat: 'yy-mm-dd'
    });
});

</script>



<style>
.form-horizontal .control-label {
padding-top: inherit;
font-size:90%;
color:#666;
}
label {
margin-bottom: 0px;
}
.controls {
line-height: 18px;
}
</style>
<form class="form-horizontal" action="https://ticket.opensciencegrid.org/viewer/updatebasic?id=10626" method="post">
<div class="page-header">
    <h3><span class="muted">10626</span> / Gluex VO Specific Issue</h3>
</div>

<div class="row-fluid">
<div class="span5">
    <legend>Contact</legend>
    <div class="control-group">
        <label class="control-label">Full Name</label>
        <div class="controls">Steve Timm</div>
    </div>
    <div class="control-group">
        <label class="control-label">Email</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">Phone</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">CC</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>

    <legend>Details</legend>
    <div class="control-group"><label class="control-label">Submitted Via</label><div class="controls">GOC Ticket/vo</div></div><div class="control-group"><label class="control-label">Submitter</label><div class="controls">Steve Timm</div></div>
    <div class="control-group">
        <label class="control-label">Ticket Type</label>
        <div class="controls">Problem/Request</div>
    </div>
    <div class="control-group">
        <label class="control-label">Priority</label>
        <div class="controls">Normal</div>
    </div>
    <div class="control-group">
        <label class="control-label">Status</label>
        <div class="controls">
Closed</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action</label>
        <div class="controls">Check for updates</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action Deadline</label>
        <div class="controls flag_red">2011-07-11</div>
    </div>

</div><!--span-->
<div class="span7">
    <legend>Assignees</legend>
    <div class="assignee" style="width: 60%">OSG RA <span class="muted"> / OSG GOC Support Team</span></div><div class="assignee" style="width: 60%">GLUEX <span class="muted"> / OSG Support Centers</span></div>    <br>

    <legend>Assignees</legend>
    TODO
    <br>

    <style>
legend.noborder {
border-bottom: none;
}
</style>

<div id="attachment-list"/>
<script>
$(function () {
    var first = true;
    $.getJSON("attachment/list/10626", function (files) {
        //console.dir(files);
        var html = "<table class=\"table table-condensed\">";
        $(files).each(function() {
            if(first) {
                first = false;
                html += "<legend class=\"noborder\">Attachmenets</legend>";
            }
            html += "<tr class=\"attachment\">";
            html += "<td><img src=\""+this.thumbnail_url+"\"/></td>";
            html += "<td><a href=\""+this.url+"\" target=\"_blank\">"+this.name+"</a></td>";
            html += "<td>"+bytesToSize(this.size, 1)+"</td>";
            html += "</tr>";
        });
        html += "</table>";
        $("#attachment-list").html(html);
    });
});

function download(url) {
    window.open(url, "_blank");
}
</script>


</div><!--span-->
</div><!--row-fluid-->


</form>

</div>
<div id="updates" style="clear: both;">
    <legend>Past Updates
    <div class="btn-toolbar pull-right toolbar">
    </div><!--btn-toolbar-->
    </legend>

    <div class='update_description'><i onclick="document.location='10626#1310062627'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-07-07T18:17:07+00:00">Jul 7, 2011 06:17 PM UTC</time> by <b>Steven Timm</b><a class="anchor" name="1310062627">&nbsp;</a></div><pre>yes, it&#39;s fine.. we are not seeing any further problems with Richard&#39;s
jobs.  go ahead and close it out.

Steve Timm

On Thu, 7 Jul 2011, Open Science Grid FootPrints wrote&#58;

<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='10626#1310062063'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-07-07T18:07:43+00:00">Jul 7, 2011 06:07 PM UTC</time> by <b>OSG RA</b><a class="anchor" name="1310062063">&nbsp;</a></div><pre>Is it safe to assume that this ticket can be closed out?</pre></div><div class='update_description'><i onclick="document.location='10626#1309474027'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-06-30T22:47:07+00:00">Jun 30, 2011 10:47 PM UTC</time> by <b>Steven Timm</b><a class="anchor" name="1309474027">&nbsp;</a></div><pre>This is an automatic reply.

I will be on vacation and away from the laboratory from June 30 through July 3, 2011. I will not be seeing any E-mail during
this time.  I will return to the lab following the Independence Day holiday.  If you have any issues that require the attention of the FermiGrid Services Group, please contact the Service Desk at 630 840 2345 or <a href='http&#58;//servicedesk.fnal.gov.' target='_blank' rel='nofollow'>http&#58;//servicedesk.fnal.gov.</a>

Steve Timm</pre></div><div class='update_description'><i onclick="document.location='10626#1309473848'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-06-30T22:44:08+00:00">Jun 30, 2011 10:44 PM UTC</time> by <b>GLUEX</b><a class="anchor" name="1309473848">&nbsp;</a></div><pre>Steve,

In my job startup script, I am now checking the srm-client-fermi package installed on the worker node, and if it is lacking the SRM_JAVA_OPTIONS setting, I am uploading my own complete srm-client-fermi suite into the job context and using the local copy.  My jobs are now running to completion on the fnal workers without the memory exhaustion problems observed earlier.  A snapshot sequence for a recent glidein job follows below.  I highlighted the &#34;busy&#34; process.  Momory footprints are now reasonable across the full job lifetime.  Thanks for your patience as I worked out this scheme.

-Richard J.

gluex&#62; while [ $? = 0 ]; do echo ====================;glidein_interactive.py 617.706 ps -eo user,pid,ppid,vsz,rss,comm | grep gluex;done
====================
gluex      457 23522   9176  5220 condor_starter
gluex      572   457   8948  1080 condor_exec.exe
gluex      649 31423   8956  1148 srmls
gluex      653   649   9064  1208 srm
*gluex      655   653 331184 31556 java*
gluex      696   572   8948   580 condor_exec.exe
gluex      697   696   8616   796 ps
gluex    21313 21312   9208  1404 data
gluex    23211 21313   9068  1224 condor_startup.
gluex    23515 23211   8788  5048 condor_master
gluex    23519 23211   8612  4976 condor_master
gluex    23521 23515   4708  2616 condor_procd
gluex    23522 23515   9212  5552 condor_startd
gluex    23523 23519   4672  2604 condor_procd
gluex    23524 23519   9204  5552 condor_startd
gluex    31247 23524   9124  5216 condor_starter
gluex    31342 31247   8948  1088 condor_exec.exe
gluex    31423 31342  64148 19076 gridmake
====================
gluex      897 31423   8956  1192 srmcp
gluex      901   897   9064  1208 srm
*gluex      903   901 422328 111084 java*
gluex      921 23522   9176  5216 condor_starter
gluex     1009   921   8948  1080 condor_exec.exe
gluex     1092  1009   8948   580 condor_exec.exe
gluex     1093  1092   8616   796 ps
gluex    21313 21312   9208  1404 data
<div id='show_941778991' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_941778991'>gluex    23211 21313   9068  1224 condor_startup.
gluex    23515 23211   8788  5048 condor_master
gluex    23519 23211   8612  4976 condor_master
gluex    23521 23515   4708  2616 condor_procd
gluex    23522 23515   9216  5552 condor_startd
gluex    23523 23519   4672  2604 condor_procd
gluex    23524 23519   9204  5552 condor_startd
gluex    31247 23524   9124  5216 condor_starter
gluex    31342 31247   8948  1088 condor_exec.exe
gluex    31423 31342  64148 19076 gridmake
====================
gluex     1199 31423   8952  1108 run_hdgeant
*gluex     1201  1199 323376 154148 hdgeant*
gluex     1213 23522   9176  5220 condor_starter
gluex     1301  1213   8948  1076 condor_exec.exe
gluex     1384  1301   8948   576 condor_exec.exe
gluex     1385  1384   8616   796 ps
gluex    21313 21312   9208  1404 data
gluex    23211 21313   9068  1224 condor_startup.
gluex    23515 23211   8788  5048 condor_master
gluex    23519 23211   8612  4976 condor_master
gluex    23521 23515   4708  2616 condor_procd
gluex    23522 23515   9216  5552 condor_startd
gluex    23523 23519   4672  2604 condor_procd
gluex    23524 23519   9204  5552 condor_startd
gluex    31247 23524   9124  5216 condor_starter
gluex    31342 31247   8948  1088 condor_exec.exe
gluex    31423 31342  64148 19076 gridmake
====================
gluex     1484 31423   8956  1196 srmcp
gluex     1488  1484   9064  1208 srm
*gluex     1490  1488 356092 111256 java*
gluex     1531 23522   9176  5220 condor_starter
gluex     1623  1531   8948  1080 condor_exec.exe
gluex     1706  1623   8948   580 condor_exec.exe
gluex     1707  1706   8616   796 ps
gluex    21313 21312   9208  1404 data
gluex    23211 21313   9068  1224 condor_startup.
gluex    23515 23211   8788  5048 condor_master
gluex    23519 23211   8612  4976 condor_master
gluex    23521 23515   4708  2616 condor_procd
gluex    23522 23515   9220  5556 condor_startd
gluex    23523 23519   4672  2604 condor_procd
gluex    23524 23519   9204  5552 condor_startd
gluex    31247 23524   9124  5216 condor_starter
gluex    31342 31247   8948  1088 condor_exec.exe
gluex    31423 31342  64148 19076 gridmake
====================
gluex     3608 31423   8952  1088 run_threepi
*gluex     3609  3608 534616 407140 threePi*
gluex     3631 23522   9176  5220 condor_starter
gluex     3727  3631   8948  1076 condor_exec.exe
gluex     3814  3727   8948   576 condor_exec.exe
gluex     3815  3814   8616   796 ps
gluex    21313 21312   9208  1404 data
gluex    23211 21313   9068  1224 condor_startup.
gluex    23515 23211   8788  5048 condor_master
gluex    23519 23211   8612  4976 condor_master
gluex    23521 23515   4688  2616 condor_procd
gluex    23522 23515   9220  5556 condor_startd
gluex    23523 23519   4672  2608 condor_procd
gluex    23524 23519   9204  5552 condor_startd
gluex    31247 23524   9124  5216 condor_starter
gluex    31342 31247   8948  1088 condor_exec.exe
gluex    31423 31342  64148 19076 gridmake
====================
gluex     4309 23524   9104  5208 condor_starter
gluex     4405  4309   8948  1088 condor_exec.exe
gluex     4486  4405  63908 18924 gridmake
gluex     5267 23522   9172  5216 condor_starter
gluex     5387  5267   8948  1076 condor_exec.exe
gluex     5442  4486   8956  1144 srmls
gluex     5446  5442   9064  1204 srm
*gluex     5448  5446      0     0 java &#60;defunct&#62;*
gluex     5500  5387   8948   576 condor_exec.exe
gluex     5501  5500   8616   796 ps
gluex    21313 21312   9208  1404 data
gluex    23211 21313   9068  1224 condor_startup.
gluex    23515 23211   8788  5048 condor_master
gluex    23519 23211   8612  4976 condor_master
gluex    23521 23515   4672  2616 condor_procd
gluex    23522 23515   9228  5564 condor_startd
gluex    23523 23519   4672  2632 condor_procd
gluex    23524 23519   9204  5552 condor_startd
====================
</div><script type='text/javascript'>
        $('#show_941778991').click(function() {
            $('#detail_941778991').slideDown("normal");
            $('#show_941778991').hide();
            $('#hide_941778991').show();
        });
        $('#hide_941778991').click(function() {
            $('#detail_941778991').slideUp();
            $('#hide_941778991').hide();
            $('#show_941778991').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='10626#1309401126'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-06-30T02:32:06+00:00">Jun 30, 2011 02:32 AM UTC</time> by <b>GLUEX</b><a class="anchor" name="1309401126">&nbsp;</a></div><pre>Steve,

I looked through the /osg/srm-fermi-client/sbin/srm script on your workers, and it seems to have no hooks that work from the outside for passing options to the java command.  Let me try to insert my own &#34;srm&#34; script ahead of /osg/srm-fermi-client/sbin in the PATH.

-Richard J.</pre></div><div class='update_description'><i onclick="document.location='10626#1309400047'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-06-30T02:14:07+00:00">Jun 30, 2011 02:14 AM UTC</time> by <b>Steven Timm</b><a class="anchor" name="1309400047">&nbsp;</a></div><pre>Thanks Richard.. we will eventually get this option in there.  Is
there any way you can set this variable manually in your jobs here
until we do?

Steve

On Thu, 30 Jun 2011, Open Science Grid FootPrints wrote&#58;

<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='10626#1309393567'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-06-30T00:26:07+00:00">Jun 30, 2011 12:26 AM UTC</time> by <b>GLUEX</b><a class="anchor" name="1309393567">&nbsp;</a></div><pre>Steve,

I just did a compare between the srmcp script on the fnal worker nodes and the one installed on my cluster, and they are identical.  They delegate the actual work of the copy to the srm script in the srm-client-fermi/sbin directory.  I also compared this script on the fnal workers with the one on my cluster, and they are identical -- except for one difference -- the fnal worker version is missing the SRM_JAVA_OPTIONS clause.  Maybe removed in an update you have applied, but not me?

Note -- you can set this variable explicitly in your environment, but you do not have to.  If it is not set, the following clause from the srm script (mine, not yours) will set it to a default that I think works fine.

if [ &#34;${SRM_JAVA_OPTIONS}&#34; = &#34;&#34; ]
then
SRM_JAVA_OPTIONS=&#34;-Xms64m -Xmx64m&#34;
fi

-Richard J.</pre></div><div class='update_description'><i onclick="document.location='10626#1309366387'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-06-29T16:53:07+00:00">Jun 29, 2011 04:53 PM UTC</time> by <b>Steven Timm</b><a class="anchor" name="1309366387">&nbsp;</a></div><pre>Hi Richard--this is helpful information.   SRM_JAVA_OPTIONS
is currently not set on our cluster.  We will try this in integration
and then if successful try on our production cluster, and
then feed the information back to the installers. I did
not see any information in the OSG Worker node client install
that this variable should be set.. in fact I didn&#39;t even know about it
before now.

Steve Timm

On Wed, 29 Jun 2011, Open Science Grid FootPrints wrote&#58;

<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='10626#1309363147'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-06-29T15:59:07+00:00">Jun 29, 2011 03:59 PM UTC</time> by <b>GLUEX</b><a class="anchor" name="1309363147">&nbsp;</a></div><pre>Steve,

One more followup, when I try the same &#34;srmcp&#34; command on my local cluster, the vsize of the virtual machine saturates around 200MB.  A detailed look at the &#34;srm&#34; script in the fermi-client tree that launches the java vm reveals the section,

if [ &#34;${SRM_JAVA_OPTIONS}&#34; = &#34;&#34; ]
then
SRM_JAVA_OPTIONS=&#34;-Xms64m -Xmx64m&#34;
fi

This effectively limits the size of the java vm used for srm commands.  I seem to remember that the defaults used by the latest java releases is ridiculously large (like 2GB on 32-bit platform, 4GB on 64-bit platform).  Can you check what the value of SRM_JAVA_OPTIONS is in your osg environment?

-Richard J.</pre></div><div class='update_description'><i onclick="document.location='10626#1309362069'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-06-29T15:41:09+00:00">Jun 29, 2011 03:41 PM UTC</time> by <b>GLUEX</b><a class="anchor" name="1309362069">&nbsp;</a></div><pre>Steve,

Here are the results of a profiling session that I ran on a recent job that ran on node fnpc344.  I print out the state of all commands running under the &#34;gluex&#34; user on that node.  You can also see the monitoring command pipe &#34;ps | grep&#34; jobs in the list.  This report is generated about every 20 seconds or so, as fast as the glidein_interactive.py script will return results.  I highlighted in each snapshot the process that I think is the main worker process, although probably the aggregate resources of all processes listed get charged against the job.  All of these resource sizes look consistent with my benchmarks on the local cluster.

The problem is confined to the size of the java virtual machine that gets launched by the srmcp command.  Isn&#39;t that a site configuration issue?  I am not trying to shift the blame by saying this!  If I am supposed to give some options to the srmcp command that I am missing, please let me know.

-Richard J.

gluex&#62; while [ $? = 0 ]; do glidein_interactive.py 529.853 ps -eo user,pid,ppid,vsz,rss,comm &#92;| grep gluex; done
gluex     2397 21264   8968  5392 condor_starter
gluex     2492  2397  15064  1300 condor_exec.exe
gluex     2574  2492  65764 19000 gridmake
gluex     3606 21262   8964  5392 condor_starter
gluex     3688  2574  15068  1320 run_hdgeant
*gluex     3690  3688 327112 156568 hdgeant*
gluex     3707  3606  15064  1288 condor_exec.exe
gluex     3801  3707  15064   612 condor_exec.exe
gluex     3802  3801  14732  1008 ps
gluex     3803  3801   6060   592 grep
gluex    19028 19027  15324  1616 data
gluex    20944 19028  15188  1432 condor_startup.
gluex    21251 20944   8428  5064 condor_master
gluex    21255 20944   8424  5068 condor_master
gluex    21261 21251   4700  2660 condor_procd
gluex    21262 21251   8920  5632 condor_startd
gluex    21263 21255   4704  2664 condor_procd
gluex    21264 21255   8968  5644 condor_startd
***********************************************
gluex     2397 21264   8968  5392 condor_starter
gluex     2492  2397  15064  1300 condor_exec.exe
gluex     2574  2492  65764 19000 gridmake
gluex     3994 21262   8964  5388 condor_starter
gluex     4012  2574  15200  1400 srmcp
gluex     4018  4012  15184  1396 srm
*gluex     4020  4018 4494432 165332 java*
<div id='show_1791210142' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_1791210142'>gluex     4121  3994  15064  1288 condor_exec.exe
gluex     4206  4121  15064   612 condor_exec.exe
gluex     4207  4206  14732  1008 ps
gluex     4208  4206   5928   352 grep
gluex    19028 19027  15324  1616 data
gluex    20944 19028  15188  1432 condor_startup.
gluex    21251 20944   8428  5064 condor_master
gluex    21255 20944   8424  5068 condor_master
gluex    21261 21251   4700  2660 condor_procd
gluex    21262 21251   8992  5640 condor_startd
gluex    21263 21255   4704  2664 condor_procd
gluex    21264 21255   8968  5644 condor_startd
***********************************************
gluex     2397 21264   8968  5392 condor_starter
gluex     2492  2397  15064  1300 condor_exec.exe
gluex     2574  2492  65764 19000 gridmake
gluex     4342  2574  15068  1304 run_dana
*gluex     4343  4342 467064 360968 hd_ana*
gluex     4355 21262   8900  5376 condor_starter
gluex     4609  4355  15064  1288 condor_exec.exe
gluex     4860  4609  15064   612 condor_exec.exe
gluex     4861  4860  14732  1004 ps
gluex     4862  4860   6060   600 grep
gluex    19028 19027  15324  1616 data
gluex    20944 19028  15188  1432 condor_startup.
gluex    21251 20944   8428  5064 condor_master
gluex    21255 20944   8424  5068 condor_master
gluex    21261 21251   4700  2668 condor_procd
gluex    21262 21251   8920  5632 condor_startd
gluex    21263 21255   4704  2664 condor_procd
gluex    21264 21255   8968  5644 condor_startd
***********************************************
gluex     2397 21264   8968  5392 condor_starter
gluex     2492  2397  15064  1300 condor_exec.exe
gluex     2574  2492  65764 19000 gridmake
gluex     4964 21262   8960  5392 condor_starter
gluex     5052  4964  15064  1284 condor_exec.exe
gluex     5136  2574  15200  1400 srmcp
gluex     5140  5136  15184  1396 srm
*gluex     5142  5140 4333572 70356 java*
gluex     5177  5052  15064   608 condor_exec.exe
gluex     5178  5177  14732  1004 ps
gluex     5179  5177   6060   600 grep
gluex    19028 19027  15324  1616 data
gluex    20944 19028  15188  1432 condor_startup.
gluex    21251 20944   8428  5064 condor_master
gluex    21255 20944   8424  5068 condor_master
gluex    21261 21251   4700  2668 condor_procd
gluex    21262 21251   9000  5644 condor_startd
gluex    21263 21255   4704  2664 condor_procd
gluex    21264 21255   8968  5644 condor_startd
***********************************************
gluex     2397 21264   8968  5392 condor_starter
gluex     2492  2397  15064  1300 condor_exec.exe
gluex     2574  2492  65764 19000 gridmake
gluex     5339 21262   8960  5396 condor_starter
gluex     5427  5339  15064  1284 condor_exec.exe
gluex     5471  2574  15200  1396 srmcp
gluex     5475  5471  15184  1396 srm
*gluex     5477  5475 4469740 145200 java*
gluex     5543  5427  15064   608 condor_exec.exe
gluex     5544  5543  14732  1008 ps
gluex     5545  5543   6060   596 grep
gluex    19028 19027  15324  1616 data
gluex    20944 19028  15188  1432 condor_startup.
gluex    21251 20944   8428  5064 condor_master
gluex    21255 20944   8424  5068 condor_master
gluex    21261 21251   4700  2668 condor_procd
gluex    21262 21251   8936  5636 condor_startd
gluex    21263 21255   4704  2664 condor_procd
gluex    21264 21255   8968  5644 condor_startd
***********************************************
gluex     5740 21264   8968  5392 condor_starter
gluex     5745 21262   8960  5396 condor_starter
gluex     5907  5740  15064  1300 condor_exec.exe
gluex     5960  5745  15064  1288 condor_exec.exe
gluex     6072  5907  25520  2504 gridmake
gluex     6088  6072  15064  1284 sh
gluex     6092  6088  15200  1376 setup
gluex     6113  5960  15064   612 condor_exec.exe
gluex     6114  6113  14732  1000 ps
gluex     6115  6113   6060   596 grep
gluex    19028 19027  15324  1616 data
gluex    20944 19028  15188  1432 condor_startup.
gluex    21251 20944   8428  5064 condor_master
gluex    21255 20944   8424  5068 condor_master
gluex    21261 21251   4700  2668 condor_procd
gluex    21262 21251   9016  5644 condor_startd
gluex    21263 21255   4704  2664 condor_procd
gluex    21264 21255   8972  5644 condor_startd
***********************************************
[job finished]
</div><script type='text/javascript'>
        $('#show_1791210142').click(function() {
            $('#detail_1791210142').slideDown("normal");
            $('#show_1791210142').hide();
            $('#hide_1791210142').show();
        });
        $('#hide_1791210142').click(function() {
            $('#detail_1791210142').slideUp();
            $('#hide_1791210142').hide();
            $('#show_1791210142').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='10626#1309355047'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-06-29T13:44:07+00:00">Jun 29, 2011 01:44 PM UTC</time> by <b>GLUEX</b><a class="anchor" name="1309355047">&nbsp;</a></div><pre>Steve,

Ok about the cms_t1 CE, I just see that it is configured to receive Gluex glideins.  My accounting tools report successful processing on a variety of types of hostnames, including the following lifted from my reports web page.

1. fcdfcaf1550.fnal.gov - installationsucceeded(Sat Jun 18 15&#58;08&#58;40 2011 &#60;<a href='http&#58;//zeus.phys.uconn.edu/prod/scripts/package/amptools/0.3/fnal.gov/fcdfcaf1550.fnal.gov_log&#62' target='_blank' rel='nofollow'>http&#58;//zeus.phys.uconn.edu/prod/scripts/package/amptools/0.3/fnal.gov/fcdfcaf1550.fnal.gov_log&#62</a>;)
2. d0cs2029.fnal.gov - installationsucceeded(Fri Jun 24 06&#58;24&#58;15 2011 &#60;<a href='http&#58;//zeus.phys.uconn.edu/prod/scripts/package/amptools/0.3/fnal.gov/d0cs2029.fnal.gov_log&#62' target='_blank' rel='nofollow'>http&#58;//zeus.phys.uconn.edu/prod/scripts/package/amptools/0.3/fnal.gov/d0cs2029.fnal.gov_log&#62</a>;)
3. fnpc3054.fnal.gov - installationsucceeded(Fri Jun 24 15&#58;57&#58;48 2011 &#60;<a href='http&#58;//zeus.phys.uconn.edu/prod/scripts/package/amptools/0.3/fnal.gov/fnpc3054.fnal.gov_log&#62' target='_blank' rel='nofollow'>http&#58;//zeus.phys.uconn.edu/prod/scripts/package/amptools/0.3/fnal.gov/fnpc3054.fnal.gov_log&#62</a>;)
4. fcdfcaf3026.fnal.gov - installationsucceeded(Tue Jun 28 09&#58;26&#58;55 2011 &#60;<a href='http&#58;//zeus.phys.uconn.edu/prod/scripts/package/amptools/0.3/fnal.gov/fcdfcaf3026.fnal.gov_log&#62' target='_blank' rel='nofollow'>http&#58;//zeus.phys.uconn.edu/prod/scripts/package/amptools/0.3/fnal.gov/fcdfcaf3026.fnal.gov_log&#62</a>;)

I was assuming since these hosts have different-sounding names that they were located behind different CE&#39;s.  As you say, not necessarily the case.

The maximum memory footprint of any application in our job workflow comes from the hd_ana executable.  After running for an hour or so, it reaches a plateau of the following approximate levels.

vmem total&#58; 700 MB
resident set (vmem active) 450 MB

The other applications in our production chain have substantially less memory footprint.

It sounds like it could be a problem with the srm tools (srmcp) and java vm that are installed there.  I have very little control over what that process does, except to give it the file and wait for the result.  Later on today I will do a controlled run and report to you what I see.

-Richard Jones

On 6/28/2011 9&#58;59 PM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='10626#1309312746'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-06-29T01:59:06+00:00">Jun 29, 2011 01:59 AM UTC</time> by <b>Steven Timm</b><a class="anchor" name="1309312746">&nbsp;</a></div><pre>On further investigation, it appears that up to 1/2 of your jobs
on FNAL_FERMIGRID are failing for this reason.  Most of the others
I hadn&#39;t seen previously were getting automatically removed from our
queue after failing.

You couldn&#39;t possibly have had any success on CMS_T1_US_FNAL
within the last week as it hasn&#39;t taken any jobs for more than
three weeks.  But that has nothing to do with the failures on
FNAL_FERMIGRID.  FNAL_FERMIGRID is a frontend for several different
clusters.  When your jobs get forwarded to  the CDF clusters
they end up with a 2.5GB memory limit imposed.  Available space
on those clusters is rare but it has been happening a lot in the last
few days.

I caught one job while it was still running..it appears that much
of the memory usage was in the srmcp at the beginning of the job,
it was showing 4GB of RAM used just for that.  That alone would be
enough to do the kill.  But condor has the extra property of doing
the sum of various processes and putting it all togehter so that makes it
worse.

IF you look at your user jobs in the condor queue you will probably
see on these that NumJobStarts is greater than 1 and many of them
have restarted a number of times.

Does the job really take 10GB to run?

Steve Timm

On Tue, 28 Jun 2011, Open Science Grid FootPrints wrote&#58;

<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='10626#1309299011'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-06-28T22:10:11+00:00">Jun 28, 2011 10:10 PM UTC</time> by <b>GLUEX</b><a class="anchor" name="1309299011">&nbsp;</a></div><pre>Steve,

Thanks for letting me know about this.  I am the production manager for Gluex, so those are my jobs.

I am surprised at this because I have had hundreds of jobs execute successfully on HCC_US_Fermigridosg and CMS_T1_US_FNAL over the last week and a half.  Right now these jobs are very short, only 5-10 minutes or so each to complete.  I am keeping them short until I shake down the framework and make sure they are able to reliably stage in/out the data from my SE and job dependency distribution center to sites across the osg.

Can you tell me the specific hosts / cluster segment that have seen this issue you describe?

-Richard J.

On 6/28/2011 10&#58;30 AM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='10626#1309271450'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-06-28T14:30:50+00:00">Jun 28, 2011 02:30 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1309271450">&nbsp;</a></div><pre>[by Steve Timm]

We have seen 40-50 jobs from the gluex VO within the past week
come into FNAL_FERMIGRID site and get killed within five minutes
because they rapidly expand to use 10GB of RAM.
(Our limit is 2.5GB of RAM, so the fact that they get that
much over the limit so quickly shows that the memory is growing almost
without bounds.)

Unfortunately we cannot tell which gluex user is generating the
failure because the jobs die too fast and all the user job information is
immediately deleted at exit, all we have record of in
our batch system is the pilot job getting killed.

Steve Timm</pre></div>
</div>
<script type="text/javascript">
function reset_anchor() {
    $("#updates .selected").removeClass("selected");
    var urls = document.location.toString().split('#'); 
    var anchor = urls[1];
    if(anchor) {
        $("a[name='"+anchor+"']").parents(".update_description").addClass("selected");
    }
}
function submitspam(ticket_id) {
    myret = confirm("Would you like to close this ticket as a security ticket, and submit the ticket content to akismet?");
    if(myret == true) {
        $.ajax("viewer/processspam?id="+ticket_id).done(function() {
            window.location.reload();
        });
    }
}

$(function() {
    reset_anchor();
    var ADDITIONAL_COOKIE_NAME = 'gocticket';
    var options = { path: '/', expires: 365};

    if(window.opener && window.opener.name == "gocticket_list") {
        v = $.cookie("closewindow");
        if(!v) {
            $("#closewindow").attr("checked", "checked"); //on by default
        } else {
            if(v == "checked") {
                $("#closewindow").attr("checked", "checked");
            }
        }
        $("#closewindow").click(function() {
            $.cookie("closewindow", $(this).attr('checked'), options);
        });
    } else {
        $("#closewindow_area").hide();
    }
    function updateTimeago() {
        $("time").timeago();
        setTimeout(updateTimeago, 30*1000);
    }
    updateTimeago();
    $(".description").focus(expand_description);
});
</script>
<hr/>
<footer>
<p>GOC Ticket Version 2.2 | <a href="https://ticket.opensciencegrid.org/goc/submit?app_issue_check=on&amp;app_issue_type=goc&amp;app_goc_url=https%3A%2F%2Fticket.opensciencegrid.org%3A443%2F10626">Report Bugs</a>
 | <a href="https://github.com/opensciencegrid/operations/blob/master/docs/privacy.md">Privacy Policy</a>
</p>

<p> <img align="top" src="images/tag_orange.png"/> Copyright 2018 The Trustees of Indiana University - Developed for Open Science Grid</p>
</footer>


</div><!--container-fluid-->
<script>
//used by searchbox
function parseValue(value) {
    var obj = new Object();
    var tokens = value.split("\t");
    obj.str = tokens[0];
    obj.count = tokens[1];
    return obj;
}

$(function() {
    //bootstrap-2.0.4 stuff
    $(".alert-message").alert();
    $(".dropdown-toggle").dropdown();
    $("span[rel='tooltip']").tooltip();
    $("a[rel=popover]").popover();

    //activate menu that user is currently on
    $("#menu_navigator").addClass("active"); 
    $("#submenu_").addClass("active"); 

    //translate zend validation error message to bootstrap
    $(".errors").addClass("alert").addClass("alert-error");

});
</script>


</body>
