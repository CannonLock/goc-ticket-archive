<!DOCTYPE html>
<html lang="en">
  <head>
  <base href="">
    <title>[12298] We need login access to the osg production database so that gratia-gold can query it</title>    <meta charset="utf-8" />
    <meta name="verify-v1" content="na5IcAJsZVOfEkboRxuIiZ1zpZgnZiWra+nKcS7nA/o=" />
    <meta name="google-site-verification" content="DLrk3ft4s8b-S2TloLCL2LD_t6wcTjgSluf5pmiu2kA" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />

    <style type="text/css">
      body {
        padding-top: 50px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
     #search {
            width: 300px;
     }

    </style>

<script src="https://code.jquery.com/jquery-3.0.0.js"></script>
<script src="https://code.jquery.com/jquery-migrate-3.0.1.js"></script>

   <link href="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet"/>
    <script src="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/js/bootstrap.min.js"></script>

    <link href="https://netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"/>
    <link href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/themes/smoothness/jquery-ui.min.css" rel="stylesheet"/>
 <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>


    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/js/select2.min.js"></script>

    <link href="css/ticket.css" rel="stylesheet" />
    <script src="lib/jquery.cookie.js"></script>

    <link href="images/tag_orange.png" rel="icon" type="image/png"/>
  </head>

  <body>
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>

            <a class="brand" style="padding: 6px 0px 0px 6px;" href="http://opensciencegrid.org"><img src="images/osglogo.40x30.png"/></a>
            <ul class="nav">
                <li class="dropdown"><a href="https://ticket.opensciencegrid.org/#" class="dropdown-toggle" data-toggle="dropdown">GOC Ticket <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    <li><a href="https://my.opensciencegrid.org">MyOSG</a></li>
                    <li><a href="https://oim.opensciencegrid.org">OIM</a></li>
                    <li class="active"><a href="https://ticket.opensciencegrid.org/index">Ticket</a></li>
	<li class="divider"></li>
	<li><a href="http://repo.grid.iu.edu">Repo</a></li>
	<li class="divider"></li>
	<li><a href="http://blogs.grid.iu.edu">Blog</a></li>
                    <li><a href="http://display.grid.iu.edu">Display</a></li>
                    <li><a href="http://osggoc.blogspot.com/">News</a></li>
                    </ul>
                </li>
            </ul>
            <ul class="nav pull-right">
                <li><a href="https://ticket.opensciencegrid.org/sso/">Login</a></li>            </ul>

            <div class="nav-collapse">
                <ul class="nav">
			 <li id="menu_submit"><a href="https://ticket.opensciencegrid.org/submit">Submit</a></li><li id="menu_view" class="dropdown"><a href="https://ticket.opensciencegrid.org/\#" class="dropdown-toggle" data-toggle="dropdown">View <b class="caret"></b></a><ul class="dropdown-menu"><li id="submenu_listopen"><a href="https://ticket.opensciencegrid.org/list/open">Open Tickets</a></li><li id="submenu_listrecentclose"><a href="https://ticket.opensciencegrid.org/list/recentclose">Recently Closed Tickets</a></li><li class="divider"></li><li id="submenu_alltickets"><a href="https://ticket.opensciencegrid.org/search?q=&amp;sort=id">All Tickets</a></li></ul></li>                </ul>

                <form class="navbar-search pull-right" action="https://ticket.opensciencegrid.org/viewer">
                    <input id="search" type="text" name="id" class="search-query span2" placeholder="Search Ticket" value=""/>
                </form>
            </div>
        </div>
      </div>
    </div>

<script type='text/javascript' src='lib/jquery.timeago.js'></script>
<script type='text/javascript' src='lib/byte2size.js'></script>
<style>
#updates .toolbar {
position: relative;
margin-top: 0px;
top: -10px;
font-weight: normal;
}
#updates a.anchor {
position: relative;
top: -50px;
}
#updates .selected pre {
animation:selected 2s;
animation-iteration-count: 2;
animation-direction: alternate;
-webkit-animation:selected 2s; 
-webkit-animation-iteration-count: 2;
-webkit-animation-direction: alternate;
box-shadow: inset 1px 1px 20px #9ad;
border: 1px solid #9ab;
margin: 5px 0px;
padding-left: 10px;
}
@keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ab;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
@-webkit-keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ad;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
#updates pre {
background-color: inherit;
line-height: 15px;
padding: 5px;
}
#updates .header {
color: #999;
}
#updates .update_history pre {
background-color: #eee;
color: #666;
font-size: 85%;
}
#updates .clickable {
cursor: pointer;
}
#updates .clickable:hover {
color: #D98719;
}
#updates .meta_information pre {
background-color: #fed;
}
#similar_tickets {
max-height: 300px;
overflow-y: auto;
pointer-events: none;
padding: 5px;
background-color: #f4f4f4;
}
.btn-toolbar {
margin-bottom: 0;
height: 30px;
}
#peers {
position: fixed;
bottom: 0px;
right: 0px;
z-index: 100;
list-style: none;
padding: 5px 0px 0px 5px;
margin: 0px;
background-color: white;
box-shadow: 0px 0px 10px white;
}
#peers li {
background-color: #ccc;
color: #000;
display: inline-block;
padding: 5px 10px;
margin-right: 5px;
position: relative;
}
/*
#peers li:hover {
background-color: #999;
cursor: pointer;
}
*/
#peers span.ip {
padding-left: 5px;
color: #666;
}
#peers .new {
bottom: -30px;
}
/*
#peers .me {
background-color: red;
}
*/
</style>

<div class="container-fluid">
<ul id="peers"></ul>
<div class="alert alert-danger"><a class="close" href="https://ticket.opensciencegrid.org/#" data-dismiss="alert">&times;</a>By the end of May 2018, the ticketing system at https://ticket.opensciencegrid.org will be retired and support will be provided at https://support.opensciencegrid.org. Throughout this transition the support email (help@opensciencegrid.org) will be available as a point of contact.<br><br>                                                   
                                                                                                                                                                                   
Please see the service migration page for details: https://opensciencegrid.github.io/technology/policy/service-migrations-spring-2018/#ticket</div><div id="presence" class="pull-right"></div><div class="ticketgui"><script type="text/javascript" src="lib/checktab.js"></script>

<script>
var expanded = false;
function expand_description() {
    var desc = $(".description");
    if(!expanded) {
        expanded = true;
        //expand to minheight
        var min = 250;
        if(desc.height() < min) {
            desc.animate({height: min}, 200);
        }
    }
}

$(document).ready(function() {
    $("input[name='nad']").datepicker({
        dateFormat: 'yy-mm-dd'
    });
});

</script>



<style>
.form-horizontal .control-label {
padding-top: inherit;
font-size:90%;
color:#666;
}
label {
margin-bottom: 0px;
}
.controls {
line-height: 18px;
}
</style>
<form class="form-horizontal" action="https://ticket.opensciencegrid.org/viewer/updatebasic?id=12298" method="post">
<div class="page-header">
    <h3><span class="muted">12298</span> / We need login access to the osg production database so that gratia-gold can query it</h3>
</div>

<div class="row-fluid">
<div class="span5">
    <legend>Contact</legend>
    <div class="control-group">
        <label class="control-label">Full Name</label>
        <div class="controls">Yaling Zheng</div>
    </div>
    <div class="control-group">
        <label class="control-label">Email</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">Phone</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">CC</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>

    <legend>Details</legend>
    <div class="control-group"><label class="control-label">Submitted Via</label><div class="controls">GOC Ticket/submit</div></div><div class="control-group"><label class="control-label">Submitter</label><div class="controls">Yaling Zheng</div></div>
    <div class="control-group">
        <label class="control-label">Ticket Type</label>
        <div class="controls"></div>
    </div>
    <div class="control-group">
        <label class="control-label">Priority</label>
        <div class="controls">Normal</div>
    </div>
    <div class="control-group">
        <label class="control-label">Status</label>
        <div class="controls">
Closed</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action</label>
        <div class="controls">ENG Action</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action Deadline</label>
        <div class="controls flag_red">2012-06-22</div>
    </div>

</div><!--span-->
<div class="span7">
    <legend>Assignees</legend>
    <div class="assignee" style="width: 60%">Scott Teige <span class="muted"> / OSG Operations Infrastructure</span></div><div class="assignee" style="width: 60%">FNAL (Prod)&nbsp;<a target="_blank" href="https://fermi.service-now.com/nav_to.do?uri=incident.do?sys_id=INC000000270091">INC000000270091</a> <span class="muted"> / Ticket Exchange</span></div>    <br>

    <legend>Assignees</legend>
    TODO
    <br>

    <style>
legend.noborder {
border-bottom: none;
}
</style>

<div id="attachment-list"/>
<script>
$(function () {
    var first = true;
    $.getJSON("attachment/list/12298", function (files) {
        //console.dir(files);
        var html = "<table class=\"table table-condensed\">";
        $(files).each(function() {
            if(first) {
                first = false;
                html += "<legend class=\"noborder\">Attachmenets</legend>";
            }
            html += "<tr class=\"attachment\">";
            html += "<td><img src=\""+this.thumbnail_url+"\"/></td>";
            html += "<td><a href=\""+this.url+"\" target=\"_blank\">"+this.name+"</a></td>";
            html += "<td>"+bytesToSize(this.size, 1)+"</td>";
            html += "</tr>";
        });
        html += "</table>";
        $("#attachment-list").html(html);
    });
});

function download(url) {
    window.open(url, "_blank");
}
</script>


</div><!--span-->
</div><!--row-fluid-->


</form>

</div>
<div id="updates" style="clear: both;">
    <legend>Past Updates
    <div class="btn-toolbar pull-right toolbar">
    </div><!--btn-toolbar-->
    </legend>

    <div class='update_description'><i onclick="document.location='12298#1343333980'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-07-26T20:19:40+00:00">Jul 26, 2012 08:19 PM UTC</time><a class="anchor" name="1343333980">&nbsp;</a></div><pre>Hi Steve,

Appreciate your help. I have tried to log on the database and it works.
I am now in the progress of updating our gratia-gold scripts.

Thanks,
- Yaling

-- by Yaling Zheng</pre></div><div class='update_description'><i onclick="document.location='12298#1343180188'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-07-25T01:36:28+00:00">Jul 25, 2012 01:36 AM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1343180188">&nbsp;</a></div><pre>password and port were given to Yaling over the phone.  Yaling please let me know if the
reads are working, also when you have the probe reporting to the main database either
via replication from Nebraska or sending it directly to us.

Steve Timm

-- by timm at Wed Jul 25 01&#58;35&#58;06 UTC 2012

GOCTX Source&#58; <a href='https&#58;//fermi.service-now.com/nav_to.do?uri=incident.do?sys_id=INC000000270091' target='_blank' rel='nofollow'>https&#58;//fermi.service-now.com/nav_to.do?uri=incident.do?sys_id=INC000000270091</a></pre></div><div class='update_description'><i onclick="document.location='12298#1343156246'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-07-24T18:57:26+00:00">Jul 24, 2012 06:57 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1343156246">&nbsp;</a></div><pre>Dear Yaling
Please call me at 630-840-8525 and I will tell you the username//password you need to log into the mysql.

Steve Timm

-- by timm at Tue Jul 24 18&#58;56&#58;43 UTC 2012

GOCTX Source&#58; <a href='https&#58;//fermi.service-now.com/nav_to.do?uri=incident.do?sys_id=INC000000270091' target='_blank' rel='nofollow'>https&#58;//fermi.service-now.com/nav_to.do?uri=incident.do?sys_id=INC000000270091</a></pre></div><div class='update_description'><i onclick="document.location='12298#1343069881'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-07-23T18:58:01+00:00">Jul 23, 2012 06:58 PM UTC</time><a class="anchor" name="1343069881">&nbsp;</a></div><pre>Timm,

Do we need a user name and password to access the database?

Thanks,
- Yaling

-- by Yaling Zheng</pre></div><div class='update_description'><i onclick="document.location='12298#1342810388'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-07-20T18:53:08+00:00">Jul 20, 2012 06:53 PM UTC</time> by <b>Steven Timm</b><a class="anchor" name="1342810388">&nbsp;</a></div><pre>There is already a blanket firewall rule in place
so that anything in the 129.79.xxx.xxx class B network
can access the reporting database, which is
gr-osg-mysql-reports.opensciencegrid.org

Of course you will also have to have your gratia probe send the
records to the main Gratia collector
(gratia-osg-prod.opensciencegrid.org&#58;80)
, which it is not currently doing.

Steve Timm

On Fri, 20 Jul 2012, Open Science Grid FootPrints wrote&#58;

<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='12298#1342810026'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-07-20T18:47:06+00:00">Jul 20, 2012 06:47 PM UTC</time> by <b>rynge@....</b><a class="anchor" name="1342810026">&nbsp;</a></div><pre>The machine is hosted at goc, and the hostname is osg-xsede.grid.iu.edu

Thanks!

/Mats

On 07/19/2012 01&#58;21 PM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='12298#1342729293'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-07-19T20:21:33+00:00">Jul 19, 2012 08:21 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1342729293">&nbsp;</a></div><pre>Yaling, we have looked over the query and decided it will be OK for you to run the query against the main database.
What machine (IP Address) is the query going to run from? If it is hosted at the GOC, any GOC machine should already
have access to the database.
-- by timm at Thu Jul 19 20&#58;20&#58;08 UTC 2012

GOCTX Source&#58; <a href='https&#58;//fermi.service-now.com/nav_to.do?uri=incident.do?sys_id=INC000000270091' target='_blank' rel='nofollow'>https&#58;//fermi.service-now.com/nav_to.do?uri=incident.do?sys_id=INC000000270091</a></pre></div><div class='update_description'><i onclick="document.location='12298#1342459505'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-07-16T17:25:05+00:00">Jul 16, 2012 05:25 PM UTC</time><a class="anchor" name="1342459505">&nbsp;</a></div><pre>Steve,

What&#39;s the verdict on this one?
Are we satisfied with the query?
I assume they will be accessing the reporting mysql database at
--host=gr-osg-mysql-reports.opensciencegrid.org --port=3306

John Weigand

-- by John Weigand</pre></div><div class='update_description'><i onclick="document.location='12298#1341845790'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-07-09T14:56:30+00:00">Jul 9, 2012 02:56 PM UTC</time><a class="anchor" name="1341845790">&nbsp;</a></div><pre>Timm, you are right about the query.
I&#39;ve add ProjectName is not NULL to the query.

Thanks,
-Yaling

-- by Yaling Zheng</pre></div><div class='update_description'><i onclick="document.location='12298#1341618943'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-07-06T23:55:43+00:00">Jul 6, 2012 11:55 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1341618943">&nbsp;</a></div><pre>reply from&#58; timm@....

You are missing the point with respect to ProjectName.
Yes, all the jobs that you generate have a ProjectName but most of the other jobs in JobUsageRecord do not.
Whenever you are doing a join on JobUsageRecord_Meta and JobUsageRecord, it is important to use as many
Qualifiers as you can to cut down the size of the join.
Also, there are maybe 1-2% of non-xsede jobs that have some garbage in the ProjectName.

From&#58; Fermilab Service Desk [mailto&#58;fermi@....]
Sent&#58; Friday, July 06, 2012 5&#58;05 PM
To&#58; Steven C Timm
Subject&#58; Incident INC000000270091 updated -- We need login access to the osg production database so that gratia-gold can query it

Incident INC000000270091&#60;<a href='https&#58;//fermi.service-now.com/nav_to.do?uri=incident.do%3Fsys_id=f929cad981b6a8003f839f526639121e%26sysparm_stack=incident_list.do%3Fsysparm_query=active=true&#62' target='_blank' rel='nofollow'>https&#58;//fermi.service-now.com/nav_to.do?uri=incident.do%3Fsys_id=f929cad981b6a8003f839f526639121e%26sysparm_stack=incident_list.do%3Fsysparm_query=active=true&#62</a>; comments have been updated.

Last update&#58;
2012-07-06 22&#58;03&#58;10 - cd-srv-goc-ops (Additional comments)
Thanks for Steve Tim&#39;s comments. Below are our responses to his comments.

<font color='#7F7E6F'>&#62; 1) you should probably add a ProjectName is not NULL to the WHERE</font>
<font color='#7F7E6F'>&#62; clause</font>

We check all jobs at submit time and reject them if PorjectName is not
set. And if ProjectName happens to be null, gratia-gold will not be
able to gcharge them anyway.

<font color='#7F7E6F'>&#62; 2) similar tactics are used by the OSG display but in that case they</font>
<font color='#7F7E6F'>&#62; group by the date of arrival and not by DBID.</font>

We did group them by (DATE(EndTime) instead of DBID.

<font color='#7F7E6F'>&#62; 3) so far I haven&#39;t been able to bring up anything but the empty set</font>
<font color='#7F7E6F'>&#62; in using the query.</font>

There&#39;s likely no matching data because we don&#39;t send the data to the
<div id='show_1200584216' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_1200584216'>OSG production collector yet.

<font color='#7F7E6F'>&#62; 4) how fast is this needed? do we have time to get the projectname</font>
<font color='#7F7E6F'>&#62; field into the summary table?</font>

We can&#39;t replicate using the summary table because Gratia can change
arbitrary historical records from late updates.

<font color='#7F7E6F'>&#62; 5) how many osg-xsede gratia records are there total thus far?</font>

As I checked just now there are 15401943 jobs thus far in
rcf-gratia.unl.edu.

-- by Yaling Zheng

</div><script type='text/javascript'>
        $('#show_1200584216').click(function() {
            $('#detail_1200584216').slideDown("normal");
            $('#show_1200584216').hide();
            $('#hide_1200584216').show();
        });
        $('#hide_1200584216').click(function() {
            $('#detail_1200584216').slideUp();
            $('#hide_1200584216').hide();
            $('#show_1200584216').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='12298#1341612167'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-07-06T22:02:47+00:00">Jul 6, 2012 10:02 PM UTC</time><a class="anchor" name="1341612167">&nbsp;</a></div><pre>Thanks for Steve Tim&#39;s comments. Below are our responses to his comments.

<font color='#7F7E6F'>&#62; 1) you should probably add a ProjectName is not NULL to the WHERE</font>
<font color='#7F7E6F'>&#62; clause</font>

We check all jobs at submit time and reject them if PorjectName is not
set. And if ProjectName happens to be null, gratia-gold will not be
able to gcharge them anyway.

<font color='#7F7E6F'>&#62; 2) similar tactics are used by the OSG display but in that case they</font>
<font color='#7F7E6F'>&#62; group by the date of arrival and not by DBID.</font>

We did group them by (DATE(EndTime) instead of DBID.

<font color='#7F7E6F'>&#62; 3) so far I haven&#39;t been able to bring up anything but the empty set</font>
<font color='#7F7E6F'>&#62; in using the query.</font>

There&#39;s likely no matching data because we don&#39;t send the data to the
OSG production collector yet.

<font color='#7F7E6F'>&#62; 4) how fast is this needed?  do we have time to get the projectname</font>
<font color='#7F7E6F'>&#62; field into the summary table?</font>

We can&#39;t replicate using the summary table because Gratia can change
arbitrary historical records from late updates.

<font color='#7F7E6F'>&#62; 5) how many osg-xsede gratia records are there total thus far?</font>

As I checked just now there are 15401943 jobs thus far in
rcf-gratia.unl.edu.

-- by Yaling Zheng</pre></div><div class='update_description'><i onclick="document.location='12298#1341602716'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-07-06T19:25:16+00:00">Jul 6, 2012 07:25 PM UTC</time><a class="anchor" name="1341602716">&nbsp;</a></div><pre>Thanks for the comments from John Weigand. Below are the responses to his comments.

<font color='#7F7E6F'>&#62; 1, It appears that the main selection criteria is the probe name which implies</font>
<font color='#7F7E6F'>&#62; that these are very specifically known probes.  Why not have your own Gratia</font>
<font color='#7F7E6F'>&#62; collector for these &#39;known&#39; submit nodes.  Then just replicate the data to the</font>
<font color='#7F7E6F'>&#62; Production Gratia collector.  That way your queries can do whatever they want</font>
<font color='#7F7E6F'>&#62; and not affect the BIG collector.</font>

well, we can forward all the records from one collector to another to
avoid querying the BIG collector, but it&#39;s just extra work.

<font color='#7F7E6F'>&#62; It sounds like you already have these reporting to the collector at</font>
<font color='#7F7E6F'>&#62; rcf-gratia.unl.edu.  Why can this not continue?  Maybe you can clarify</font>
<font color='#7F7E6F'>&#62; that in the twiki.</font>

rcf-graita.unl.edu is a HCC owned collector, it is just one sub branch
of OSG, not an OSG-owned collector. Although they have same data
software and database schema, but they have different data.

<font color='#7F7E6F'>&#62; 2. Can you explain the purpose of the following data points in terms</font>
<font color='#7F7E6F'>&#62; of what they are used for?</font>

<font color='#7F7E6F'>&#62; - ResourceType</font>
<font color='#7F7E6F'>&#62; - ReportableVOName (you realize this is NOT the OSG VO necessarily)</font>
<font color='#7F7E6F'>&#62; - LocalUserId (if this runs on multiple submit nodes at different</font>
<font color='#7F7E6F'>&#62; sites, this will likely not be the same.  Doesn&#39;t DN define a user</font>
<font color='#7F7E6F'>&#62; more accurately)</font>
<font color='#7F7E6F'>&#62; - Charge (we don&#39;t use this for anything that I know of)</font>
<font color='#7F7E6F'>&#62; - NodeCount</font>
<font color='#7F7E6F'>&#62; - Processors</font>
<font color='#7F7E6F'>&#62; - MachineName</font>
<font color='#7F7E6F'>&#62; - ProjectName (this is like ReportableVOName.. not necessarily the one</font>
<font color='#7F7E6F'>&#62; OSG reports on)</font>

We need LocalUserId (such as rynge, tanya) and ProjectName (such as
<div id='show_1625317445' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_1625317445'>OlinBabsonGraphResarch, OSG-Staff, TG-STA120004) for &#34;gcharge&#34; command
in project gratia-gold. For &#34;charge&#34;, we may want to change to
&#34;WallDuration&#34;. For &#34;ReportableVOName&#34;, we can ignore it because it is
not used in gratia-gold.

<font color='#7F7E6F'>&#62; The reason I ask on this is to determine if it is possible to go off</font>
<font color='#7F7E6F'>&#62; the summary tables/views that are available.  Is there actually a</font>
<font color='#7F7E6F'>&#62; different cost for each processor type etc, aka, all these fields you</font>
<font color='#7F7E6F'>&#62; are summarizing on?</font>

<font color='#7F7E6F'>&#62; 3. What is the need for the &#34;timely&#34; nature of the &#34;charge&#34; for the</font>
<font color='#7F7E6F'>&#62; these jobs?  DO they really have to be done within an hour or so of</font>
<font color='#7F7E6F'>&#62; being complete.  My bank only does things on a daily basis.</font>

If we do it hourly, we have a pretty good chance the records are still
in the page cache. If we do it daily, we could have more than 100000
jobs and we will have to handle several page caches.

-- by Yaling Zheng

</div><script type='text/javascript'>
        $('#show_1625317445').click(function() {
            $('#detail_1625317445').slideDown("normal");
            $('#show_1625317445').hide();
            $('#hide_1625317445').show();
        });
        $('#hide_1625317445').click(function() {
            $('#detail_1625317445').slideUp();
            $('#hide_1625317445').hide();
            $('#show_1625317445').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='12298#1341582711'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-07-06T13:51:51+00:00">Jul 6, 2012 01:51 PM UTC</time> by <b>Tanya Levshina</b><a class="anchor" name="1341582711">&nbsp;</a></div><pre>I have added several people to cced list. Please comment.
Thanks,
Tanya</pre></div><div class='update_description'><i onclick="document.location='12298#1341530145'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-07-05T23:15:45+00:00">Jul 5, 2012 11:15 PM UTC</time><a class="anchor" name="1341530145">&nbsp;</a></div><pre>Will comment on the query later.  I want to understand the process better yet.

1, It appears that the main selection criteria is the probe name which implies
that these are very specifically known probes.  Why not have your own Gratia
collector for these &#39;known&#39; submit nodes.  Then just replicate the data to the
Production Gratia collector.  That way your queries can do whatever they want
and not affect the BIG collector.

It sounds like you already have these reporting to the collector at
rcf-gratia.unl.edu.  Why can this not continue?  Maybe you can clarify that
in the twiki.

2. Can you explain the purpose of the following data points in terms of
what they are used for?
- ResourceType
- ReportableVOName (you realize this is NOT the OSG VO necessarily)
- LocalUserId (if this runs on multiple submit nodes at different sites,
this will likely not be the same.  Doesn&#39;t DN define a user
more accurately)
- Charge       (we don&#39;t use this for anything that I know of)
- NodeCount
- Processors
- MachineName
- ProjectName (this is like ReportableVOName.. not necessarily the one OSG reports on)

The reason I ask on this is to determine if it is possible to go off the summary tables/views
that are available.  Is there actually a different cost for each processor type etc, aka, all
these fields you are summarizing on?

3. What is the need for the &#34;timely&#34; nature of the &#34;charge&#34; for the these jobs?  DO they really
have to be done within an hour or so of being complete.  My bank only does things on a daily basis.

Don&#39;t take this a being critical or anything.  Just trying to understand the real requirements as I am
totally ignorant of this GOLD system.  The twiki only describes what you want.

<div id='show_1633299258' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_1633299258'>John Weigand

-- by John Weigand

</div><script type='text/javascript'>
        $('#show_1633299258').click(function() {
            $('#detail_1633299258').slideDown("normal");
            $('#show_1633299258').hide();
            $('#hide_1633299258').show();
        });
        $('#hide_1633299258').click(function() {
            $('#detail_1633299258').slideUp();
            $('#hide_1633299258').hide();
            $('#show_1633299258').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='12298#1341523898'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-07-05T21:31:38+00:00">Jul 5, 2012 09:31 PM UTC</time><a class="anchor" name="1341523898">&nbsp;</a></div><pre>My comments&#58;
1) you should probably add a ProjectName is not NULL to the WHERE clause
2) similar tactics are used by the OSG display but in that case they group by the date of arrival and not by DBID.
3) so far I haven&#39;t been able to bring up anything but the empty set in using the query.
4) how fast is this needed?  do we have time to get the projectname field into the summary table?
5) how many osg-xsede gratia records are there total thus far?

-- by Steve Timm</pre></div><div class='update_description'><i onclick="document.location='12298#1341519913'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-07-05T20:25:13+00:00">Jul 5, 2012 08:25 PM UTC</time> by <b>Tanya Levshina</b><a class="anchor" name="1341519913">&nbsp;</a></div><pre>Steve and John Weigand,
Could you please review this query?
Thanks,
Tanya</pre></div><div class='update_description'><i onclick="document.location='12298#1341237370'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-07-02T13:56:10+00:00">Jul 2, 2012 01:56 PM UTC</time> by <b>yaling.zheng@....</b><a class="anchor" name="1341237370">&nbsp;</a></div><pre>Hi Steve,

Mats and I wrote a twiki page about gratia-gold. Please let us know if you
have more questions.

<a href='https&#58;//www.opensciencegrid.org/bin/view/VirtualOrganizations/GratiaGold' target='_blank' rel='nofollow'>https&#58;//www.opensciencegrid.org/bin/view/VirtualOrganizations/GratiaGold</a>

-Yaling</pre></div><div class='update_description'><i onclick="document.location='12298#1340829063'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-06-27T20:31:03+00:00">Jun 27, 2012 08:31 PM UTC</time><a class="anchor" name="1340829063">&nbsp;</a></div><pre>From discussion in the Gratia meeting today&#58;
1) Yaling agrees to make a twiki page to show the actual query she is doing
2) The query is using the JobUsageRecord table
3) the query is currently using the collector at Nebraska
4) They would like to propagate this data to the main gratia-osg-prod.opensciencegrid.org collector at FNAL and
read the data from here instead.
5) John wants to know in addition what fields they need so we can make sure MasterSummaryData contains the right stuff.

6) by the &#34;osg production database&#34; we really mean the gratia production database.

-- by Steve Timm</pre></div><div class='update_description'><i onclick="document.location='12298#1340395083'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-06-22T19:58:03+00:00">Jun 22, 2012 07:58 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1340395083">&nbsp;</a></div><pre>We need some more information before we can process this request, or even know if it is something that we should be processing.

1) First of all, Brian has already asked in the ticket that the requester should please make a Twiki page about what
queries would be made.  this is critical.  The more queries against the JobUsageRecord table, the more problems there will be.
We need to know what the queries are and how often they will go before there is any chance of approving this.  We are trying
to shrink, not grow, the number of off-site entities that access the database over the WAN.

2) You were not really clear exactly what database you mean by the &#34;osg production database&#34; and &#34;login access&#34;
I presume you mean the OSG production gratia accounting database but you didn&#39;t actually say so.  Also nobody
gets login access, what we do is to give remote mysql read as necessary.

3) you didn&#39;t say what machine you would be running from.  If it is from the GOC already most machines at the GOC
are already authorized to read the database.&#39;

4) You should be prepared for lots of garbage in the ProjectName field, it is not only XSEDE jobs that populate
that field, it turns out.

I know there was a request for a schema upgrade of the summary table recently to reflect the Project Name field, and
we said that it was unlikely that Gratia Operations would be able to do this upgrade any time soon.  But if the
alternative is to have a malformed query chewing at the database remotely we might have to reconsider that.

Steve Timm

-- by timm at Fri Jun 22 19&#58;56&#58;45 UTC 2012

GOCTX Source&#58; <a href='https&#58;//fermi.service-now.com/nav_to.do?uri=incident.do?sys_id=INC000000270091' target='_blank' rel='nofollow'>https&#58;//fermi.service-now.com/nav_to.do?uri=incident.do?sys_id=INC000000270091</a></pre></div><div class='update_description'><i onclick="document.location='12298#1340382713'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-06-22T16:31:53+00:00">Jun 22, 2012 04:31 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1340382713">&nbsp;</a></div><pre>Incident was auto-assigned to the Service-Now Support group, but needs to be appropriately reassigned.
-- by mjbaker at Fri Jun 22 16&#58;30&#58;38 UTC 2012

GOCTX Source&#58; <a href='https&#58;//fermi.service-now.com/nav_to.do?uri=incident.do?sys_id=INC000000270091' target='_blank' rel='nofollow'>https&#58;//fermi.service-now.com/nav_to.do?uri=incident.do?sys_id=INC000000270091</a></pre></div><div class='update_description'><i onclick="document.location='12298#1340382381'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-06-22T16:26:21+00:00">Jun 22, 2012 04:26 PM UTC</time> by <b>echism</b><a class="anchor" name="1340382381">&nbsp;</a></div><pre>FNAL,

Please route this to Gratia.

Thank you,
Elizabeth</pre></div><div class='update_description'><i onclick="document.location='12298#1340382110'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-06-22T16:21:50+00:00">Jun 22, 2012 04:21 PM UTC</time><a class="anchor" name="1340382110">&nbsp;</a></div><pre>Hi Yaling,

Can you please write-up a twiki page describing the use case, the queries used, and the query pattern.

Thanks,

Brian

-- by Brian Bockelman</pre></div><div class='update_description'><i onclick="document.location='12298#1340382007'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-06-22T16:20:07+00:00">Jun 22, 2012 04:20 PM UTC</time> by <b>yaling.zheng@....</b><a class="anchor" name="1340382007">&nbsp;</a></div><pre>We need read-only access on the gratia database. Thanks.</pre></div><div class='update_description'><i onclick="document.location='12298#1340381614'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-06-22T16:13:34+00:00">Jun 22, 2012 04:13 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1340381614">&nbsp;</a></div><pre>[by Yaling Zheng]

We (Brian Bockelman and Yaling Zheng from UNL, and Mats Rynge from USC-ISI) are writing a software package to charge the jobs from the osg production database at OSG-XSEDE.grid.iu.edu.  So we will need login access to the osg production database so that the software gratia-gold can query it.</pre></div>
</div>
<script type="text/javascript">
function reset_anchor() {
    $("#updates .selected").removeClass("selected");
    var urls = document.location.toString().split('#'); 
    var anchor = urls[1];
    if(anchor) {
        $("a[name='"+anchor+"']").parents(".update_description").addClass("selected");
    }
}
function submitspam(ticket_id) {
    myret = confirm("Would you like to close this ticket as a security ticket, and submit the ticket content to akismet?");
    if(myret == true) {
        $.ajax("viewer/processspam?id="+ticket_id).done(function() {
            window.location.reload();
        });
    }
}

$(function() {
    reset_anchor();
    var ADDITIONAL_COOKIE_NAME = 'gocticket';
    var options = { path: '/', expires: 365};

    if(window.opener && window.opener.name == "gocticket_list") {
        v = $.cookie("closewindow");
        if(!v) {
            $("#closewindow").attr("checked", "checked"); //on by default
        } else {
            if(v == "checked") {
                $("#closewindow").attr("checked", "checked");
            }
        }
        $("#closewindow").click(function() {
            $.cookie("closewindow", $(this).attr('checked'), options);
        });
    } else {
        $("#closewindow_area").hide();
    }
    function updateTimeago() {
        $("time").timeago();
        setTimeout(updateTimeago, 30*1000);
    }
    updateTimeago();
    $(".description").focus(expand_description);
});
</script>
<hr/>
<footer>
<p>GOC Ticket Version 2.2 | <a href="https://ticket.opensciencegrid.org/goc/submit?app_issue_check=on&amp;app_issue_type=goc&amp;app_goc_url=https%3A%2F%2Fticket.opensciencegrid.org%3A443%2F12298">Report Bugs</a>
 | <a href="https://github.com/opensciencegrid/operations/blob/master/docs/privacy.md">Privacy Policy</a>
</p>

<p> <img align="top" src="images/tag_orange.png"/> Copyright 2018 The Trustees of Indiana University - Developed for Open Science Grid</p>
</footer>


</div><!--container-fluid-->
<script>
//used by searchbox
function parseValue(value) {
    var obj = new Object();
    var tokens = value.split("\t");
    obj.str = tokens[0];
    obj.count = tokens[1];
    return obj;
}

$(function() {
    //bootstrap-2.0.4 stuff
    $(".alert-message").alert();
    $(".dropdown-toggle").dropdown();
    $("span[rel='tooltip']").tooltip();
    $("a[rel=popover]").popover();

    //activate menu that user is currently on
    $("#menu_navigator").addClass("active"); 
    $("#submenu_").addClass("active"); 

    //translate zend validation error message to bootstrap
    $(".errors").addClass("alert").addClass("alert-error");

});
</script>


</body>
