<!DOCTYPE html>
<html lang="en">
  <head>
  <base href="">
    <title>[35982] Transfer failures at US BNL-OSG2 as destination</title>    <meta charset="utf-8" />
    <meta name="verify-v1" content="na5IcAJsZVOfEkboRxuIiZ1zpZgnZiWra+nKcS7nA/o=" />
    <meta name="google-site-verification" content="DLrk3ft4s8b-S2TloLCL2LD_t6wcTjgSluf5pmiu2kA" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />
    <link href="https://ticket.opensciencegrid.org/rss" rel="alternate" type="application/rss+xml" title="GOC Ticket Update feed" />

    <style type="text/css">
      body {
        padding-top: 50px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
     #search {
            width: 300px;
     }

    </style>

<script src="https://code.jquery.com/jquery-3.0.0.js"></script>
<script src="https://code.jquery.com/jquery-migrate-3.0.1.js"></script>

   <link href="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet"/>
    <script src="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/js/bootstrap.min.js"></script>

    <link href="https://netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"/>
    <link href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/themes/smoothness/jquery-ui.min.css" rel="stylesheet"/>
 <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>


    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/js/select2.min.js"></script>

    <link href="css/ticket.css" rel="stylesheet" />
    <script src="lib/jquery.cookie.js"></script>

    <link href="images/tag_orange.png" rel="icon" type="image/png"/>
    <script src='https://www.google.com/recaptcha/api.js'></script>
  </head>

  <body>
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>

            <a class="brand" style="padding: 6px 0px 0px 6px;" href="http://opensciencegrid.org"><img src="images/osglogo.40x30.png"/></a>
            <ul class="nav">
                <li class="dropdown"><a href="https://ticket.opensciencegrid.org/#" class="dropdown-toggle" data-toggle="dropdown">GOC Ticket <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    <li><a href="https://my.opensciencegrid.org">MyOSG</a></li>
                    <li><a href="https://oim.opensciencegrid.org">OIM</a></li>
                    <li class="active"><a href="https://ticket.opensciencegrid.org/index">Ticket</a></li>
	<li class="divider"></li>
	<li><a href="http://repo.grid.iu.edu">Repo</a></li>
	<li class="divider"></li>
	<li><a href="http://blogs.grid.iu.edu">Blog</a></li>
                    <li><a href="http://display.grid.iu.edu">Display</a></li>
                    <li><a href="http://osggoc.blogspot.com/">News</a></li>
                    </ul>
                </li>
            </ul>
            <ul class="nav pull-right">
                <li><a href="https://ticket.opensciencegrid.org/sso/">Login</a></li>            </ul>

            <div class="nav-collapse">
                <ul class="nav">
			 <li id="menu_submit"><a href="https://ticket.opensciencegrid.org/submit">Submit</a></li><li id="menu_view" class="dropdown"><a href="https://ticket.opensciencegrid.org/\#" class="dropdown-toggle" data-toggle="dropdown">View <b class="caret"></b></a><ul class="dropdown-menu"><li id="submenu_listopen"><a href="https://ticket.opensciencegrid.org/list/open">Open Tickets</a></li><li id="submenu_listrecentclose"><a href="https://ticket.opensciencegrid.org/list/recentclose">Recently Closed Tickets</a></li><li class="divider"></li><li id="submenu_alltickets"><a href="https://ticket.opensciencegrid.org/search?q=&amp;sort=id">All Tickets</a></li></ul></li>                </ul>

                <form class="navbar-search pull-right" action="https://ticket.opensciencegrid.org/viewer">
                    <input id="search" type="text" name="id" class="search-query span2" placeholder="Search Ticket" value=""/>
                </form>
            </div>
        </div>
      </div>
    </div>

<script type='text/javascript' src='lib/jquery.timeago.js'></script>
<script type='text/javascript' src='lib/byte2size.js'></script>
<style>
#updates .toolbar {
position: relative;
margin-top: 0px;
top: -10px;
font-weight: normal;
}
#updates a.anchor {
position: relative;
top: -50px;
}
#updates .selected pre {
animation:selected 2s;
animation-iteration-count: 2;
animation-direction: alternate;
-webkit-animation:selected 2s; 
-webkit-animation-iteration-count: 2;
-webkit-animation-direction: alternate;
box-shadow: inset 1px 1px 20px #9ad;
border: 1px solid #9ab;
margin: 5px 0px;
padding-left: 10px;
}
@keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ab;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
@-webkit-keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ad;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
#updates pre {
background-color: inherit;
line-height: 15px;
padding: 5px;
}
#updates .header {
color: #999;
}
#updates .update_history pre {
background-color: #eee;
color: #666;
font-size: 85%;
}
#updates .clickable {
cursor: pointer;
}
#updates .clickable:hover {
color: #D98719;
}
#updates .meta_information pre {
background-color: #fed;
}
#similar_tickets {
max-height: 300px;
overflow-y: auto;
pointer-events: none;
padding: 5px;
background-color: #f4f4f4;
}
.btn-toolbar {
margin-bottom: 0;
height: 30px;
}
#peers {
position: fixed;
bottom: 0px;
right: 0px;
z-index: 100;
list-style: none;
padding: 5px 0px 0px 5px;
margin: 0px;
background-color: white;
box-shadow: 0px 0px 10px white;
}
#peers li {
background-color: #ccc;
color: #000;
display: inline-block;
padding: 5px 10px;
margin-right: 5px;
position: relative;
}
/*
#peers li:hover {
background-color: #999;
cursor: pointer;
}
*/
#peers span.ip {
padding-left: 5px;
color: #666;
}
#peers .new {
bottom: -30px;
}
/*
#peers .me {
background-color: red;
}
*/
</style>

<div class="container-fluid">
<ul id="peers"></ul>
<div class="alert alert-danger"><a class="close" href="https://ticket.opensciencegrid.org/#" data-dismiss="alert">&times;</a>By the end of May 2018, the ticketing system at https://ticket.opensciencegrid.org will be retired and support will be provided at https://support.opensciencegrid.org. Throughout this transition the support email (help@opensciencegrid.org) will be available as a point of contact.<br><br>                                                   
                                                                                                                                                                                   
Please see the service migration page for details: https://opensciencegrid.github.io/technology/policy/service-migrations-spring-2018/#ticket</div><div id="presence" class="pull-right"></div><div class="ticketgui"><script type="text/javascript" src="lib/checktab.js"></script>

<script>
var expanded = false;
function expand_description() {
    var desc = $(".description");
    if(!expanded) {
        expanded = true;
        //expand to minheight
        var min = 250;
        if(desc.height() < min) {
            desc.animate({height: min}, 200);
        }
    }
}

$(document).ready(function() {
    $("input[name='nad']").datepicker({
        dateFormat: 'yy-mm-dd'
    });
});

</script>



<style>
.form-horizontal .control-label {
padding-top: inherit;
font-size:90%;
color:#666;
}
label {
margin-bottom: 0px;
}
.controls {
line-height: 18px;
}
</style>
<form class="form-horizontal" action="https://ticket.opensciencegrid.org/viewer/updatebasic?id=35982" method="post">
<div class="page-header">
    <h3><span class="muted">35982</span> / Transfer failures at US BNL-OSG2 as destination</h3>
</div>

<div class="row-fluid">
<div class="span5">
    <legend>Contact</legend>
    <div class="control-group">
        <label class="control-label">Full Name</label>
        <div class="controls">Smita Darmora</div>
    </div>
    <div class="control-group">
        <label class="control-label">Email</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">Phone</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">CC</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>

    <legend>Details</legend>
    <div class="control-group"><label class="control-label">Associated VO</label><div class="controls">ATLAS</div></div><div class="control-group"><label class="control-label">Submitted Via</label><div class="controls">GGUS</div></div><div class="control-group"><label class="control-label">Submitter</label><div class="controls">Smita Darmora</div></div><div class="control-group"><label class="control-label">Support Center</label><div class="controls">USATLAS</div></div><div class="control-group"><label class="control-label">Ticket Links</label><div class="controls"></div></div>
    <div class="control-group">
        <label class="control-label">Ticket Type</label>
        <div class="controls">Problem/Request</div>
    </div>
    <div class="control-group">
        <label class="control-label">Priority</label>
        <div class="controls">Elevated</div>
    </div>
    <div class="control-group">
        <label class="control-label">Status</label>
        <div class="controls">
Closed</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action</label>
        <div class="controls">TX Incoming</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action Deadline</label>
        <div class="controls flag_red">2018-02-12</div>
    </div>

</div><!--span-->
<div class="span7">
    <legend>Assignees</legend>
    <div class="assignee" style="width: 60%">Sarah Schmiechen <span class="muted"> / OSG GOC Support Team</span></div><div class="assignee" style="width: 60%">Sarah Schmiechen <span class="muted"> / OSG Operations Infrastructure</span></div><div class="assignee" style="width: 60%">GGUS (Prod)&nbsp;<a target="_blank" href="https://ggus.eu/ws/ticket_info.php?ticket=133295">133295</a> <span class="muted"> / Ticket Exchange</span></div><div class="assignee" style="width: 60%">USATLAS (BNL Prod)&nbsp;<a target="_blank" href="https://rt.racf.bnl.gov/rt/Ticket/Display.html?id=28195">28195</a> <span class="muted"> / Ticket Exchange</span></div>    <br>

    <legend>Assignees</legend>
    TODO
    <br>

    <style>
legend.noborder {
border-bottom: none;
}
</style>

<div id="attachment-list"/>
<script>
$(function () {
    var first = true;
    $.getJSON("https://ticket.opensciencegrid.org/attachment/list?id=35982", function (files) {
        //console.dir(files);
        var html = "<table class=\"table table-condensed\">";
        $(files).each(function() {
            if(first) {
                first = false;
                html += "<legend class=\"noborder\">Attachmenets</legend>";
            }
            html += "<tr class=\"attachment\">";
            html += "<td><img src="https://ticket.opensciencegrid.org/\&quot;&quot;+this.thumbnail_url+&quot;\&quot;/"></td>";
            html += "<td><a href="https://ticket.opensciencegrid.org/\&quot;&quot;+this.url+&quot;\&quot;" target=\"_blank\">"+this.name+"</a></td>";
            html += "<td>"+bytesToSize(this.size, 1)+"</td>";
            html += "</tr>";
        });
        html += "</table>";
        $("#attachment-list").html(html);
    });
});

function download(url) {
    window.open(url, "_blank");
}
</script>


</div><!--span-->
</div><!--row-fluid-->


</form>

</div>
<div id="updates" style="clear: both;">
    <legend>Past Updates
    <div class="btn-toolbar pull-right toolbar">
        <div class="btn-group">
                <a class="btn btn-small" href="https://ticket.opensciencegrid.org/35982?sort=up&amp;"><i class="icon-arrow-up"></i> Sort</a>

        
        <a class="btn btn-small" href="https://ticket.opensciencegrid.org/35982?expandall=true&amp;">Expand Descriptions</a>        <a class="btn btn-small" target="_blank" href="mailto:osg@tick.globalnoc.iu.edu?subject=Open%20Science%20Grid%3A%20Transfer%20failures%20at%20US%20BNL-OSG2%20as%20destination%20ISSUE%3D35982%20PROJ%3D71"><i class="icon-envelope"></i> Update w/Email</a>
        </div>
    </div><!--btn-toolbar-->
    </legend>

    <div class='update_description'><i onclick="document.location='35982#1519344012'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2018-02-23T00:00:12+00:00">Feb 23, 2018 12:00 AM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1519344012">&nbsp;</a></div><pre>This ticket was closed automatically. If this issue has not been resolved according to your expectations or if you need further information, please submit a new ticket referencing this one.&#13;

-- by GGUS SYSTEM at Thu Feb 22 23&#58;59&#58;00 UTC 2018

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=133295' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=133295</a></pre></div><div class='update_description'><i onclick="document.location='35982#1518092958'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2018-02-08T12:29:18+00:00">Feb 8, 2018 12:29 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1518092958">&nbsp;</a></div><pre>The problem was mitigated. The dCache ticket was submitted - <a href='http&#58;//rt.dcache.org/Ticket/Display.html?id=9341.' target='_blank' rel='nofollow'>http&#58;//rt.dcache.org/Ticket/Display.html?id=9341.</a> The issue will be followed there.&#13;

-- by Michal.Svatos at Thu Feb 08 12&#58;28&#58;43 UTC 2018

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=133295' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=133295</a></pre></div><div class='update_description'><i onclick="document.location='35982#1518022721'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2018-02-07T16:58:41+00:00">Feb 7, 2018 04:58 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1518022721">&nbsp;</a></div><pre>Hi,

We have seen this problem since years ago.  From what we googled and
understood, it is a bug in the application, i.e., dCache software.
Here&#39;s some info from Internet.
-------------------

CLOSE_WAIT means that the local end of the connection has received a
FIN
from the other end, but the OS is waiting for the program at the local
end to actually close its connection.

The problem is the program running on the local machine is not closing
the socket.  A connection can (and quite correctly) stay in CLOSE_WAIT
forever while the program holds the connection open.

Once the local program closes the socket, the OS can send the FIN to
the
remote end which transitions you to LAST_ACK while you wait for the
ACK
of the FIN. Once that is received, the connection is finished and
drops
from the connection table (if your end is in CLOSE_WAIT you do /not/
end
up in the TIME_WAIT state).

------------------

We have reported this several times to dCache developers before, but
still observed this in later releases.

What we could do on our side in the past is that we wrote a script to
retrieve billing of transfers and do hourly statistics on all GFTP
doors
to detect abnormality.  The one or ones which showed abnormally high
<div id='show_1808280472' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_1808280472'>number of failures usually had this problem.  When we got alerts, we
drained the door in a graceful way to clear up things.  This time, so
many doors had problems at the same time, we couldn&#39;t drain all doors
at
the same time.  It took time to drain them one by one in a graceful
way.  Then on Monday, when we had to speed up the draining and use
abrupt way (which is not recommended usually ) to do drain on
problematic doors, it caused much higher failures in short period
(like
an or two hour on each door).  So very high failures on Monday was
actually caused by abrupt draining.

No matter what, the root of the problem should be a bug in dCache.
The
application software just need to close the connection on its own side
no matter what happens.  Before dCache software fixes this problem,
what
we can do is only to detect problem and take action at alerts as
gracefully as we can. Abruptly draining GFTP doors should definitely
be
used only in very urgent situation since it would cause obviously much
higher transfer failure.

We will write to dCache team again about the issue and CC to you and
your team.

Regards,

Jane

-- by zhliu at Wed Feb 07 16&#58;58&#58;33 UTC 2018

GOCTX Source&#58; BNL Ticket&#58; Queue=StorageManagement ID=28195
</div><script type='text/javascript'>
        $('#show_1808280472').click(function() {
            $('#detail_1808280472').slideDown("normal");
            $('#show_1808280472').hide();
            $('#hide_1808280472').show();
        });
        $('#hide_1808280472').click(function() {
            $('#detail_1808280472').slideUp();
            $('#hide_1808280472').hide();
            $('#show_1808280472').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='35982#1518018878'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2018-02-07T15:54:38+00:00">Feb 7, 2018 03:54 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1518018878">&nbsp;</a></div><pre>Hi,

Thank you for the update. It is indeed very meaningful to understand the
problem and prevent the similar situation in the future. We use ganglia to
monitor dcache servers including core, door and storage. Nagios and other
scripts to check the status of dcache cells and transfer problems. The first
action will be taken is to increase the performance of our gridftp doors, for
example, increase memory, etc . We will also increase log level in gridftp
doors and try to catch as much information as possible and report to dCache
dvelopers to see whether there is filedescriptor leak in the code. We will
include crc.shifter@.... in our discussion about this incident.

Regards,
Iris

On Wed Feb 07 10&#58;32&#58;19 2018, osg-goc-rest wrote&#58;
<font color='#7F7E6F'>&#62; Hi,</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; ATLAS ADC team would like to better understand what was the root cause</font>
<font color='#7F7E6F'>&#62; of these slow transfers at BNL, if it can happen again in the future,</font>
<font color='#7F7E6F'>&#62; how to improve our monitoring (do you have your own internal storage</font>
<font color='#7F7E6F'>&#62; monitoring that could be useful even for us to be able to tell that</font>
<font color='#7F7E6F'>&#62; BNL</font>
<font color='#7F7E6F'>&#62; storage is in trouble or if it is fine and we should focus our</font>
<font color='#7F7E6F'>&#62; investigation on different party involved in problematic transfers),</font>
<font color='#7F7E6F'>&#62; can we somehow reliably detect that similar situation is coming and to</font>
<font color='#7F7E6F'>&#62; evaluate if we have some options to prevent it.</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; Could you please include crc.shifter@.... in your discussion about</font>
<font color='#7F7E6F'>&#62; this incident?</font>
<font color='#7F7E6F'>&#62; We would be happy to provide you information from monitoring at our</font>
<font color='#7F7E6F'>&#62; side and assist you with analysis of our transfer data if you need</font>
<font color='#7F7E6F'>&#62; more</font>
<font color='#7F7E6F'>&#62; details.</font>
<font color='#7F7E6F'>&#62;</font>
<div id='show_593289626' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_593289626'><font color='#7F7E6F'>&#62; thanks,</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; Petr Vokac</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; by /DC=org/DC=opensciencegrid/O=Open Science Grid/OU=People/CN=Petr</font>
<font color='#7F7E6F'>&#62; Vokac 975</font>
<font color='#7F7E6F'>&#62; -- by goc at Wed Feb 07 15&#58;31&#58;49 UTC 2018</font>
-- by iriswu at Wed Feb 07 15&#58;54&#58;12 UTC 2018

GOCTX Source&#58; BNL Ticket&#58; Queue=StorageManagement ID=28195
</div><script type='text/javascript'>
        $('#show_593289626').click(function() {
            $('#detail_593289626').slideDown("normal");
            $('#show_593289626').hide();
            $('#hide_593289626').show();
        });
        $('#hide_593289626').click(function() {
            $('#detail_593289626').slideUp();
            $('#hide_593289626').hide();
            $('#show_593289626').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='35982#1518017509'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2018-02-07T15:31:49+00:00">Feb 7, 2018 03:31 PM UTC</time><a class="anchor" name="1518017509">&nbsp;</a></div><pre>Hi,

ATLAS ADC team would like to better understand what was the root cause of these slow transfers at BNL, if it can happen again in the future, how to improve our monitoring (do you have your own internal storage monitoring that could be useful even for us to be able to tell that BNL storage is in trouble or if it is fine and we should focus our investigation on different party involved in problematic transfers), can we somehow reliably detect that similar situation is coming and to evaluate if we have some options to prevent it.

Could you please include crc.shifter@.... in your discussion about this incident?
We would be happy to provide you information from monitoring at our side and assist you with analysis of our transfer data if you need more details.

thanks,

Petr Vokac

by /DC=org/DC=opensciencegrid/O=Open Science Grid/OU=People/CN=Petr Vokac 975</pre></div><div class='update_description'><i onclick="document.location='35982#1518015199'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2018-02-07T14:53:19+00:00">Feb 7, 2018 02:53 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1518015199">&nbsp;</a></div><pre>Hi,

Since the problem is fixed, the ticket will be closed. We will continue the
investigation in our side.

Regards,
Iris

On Wed Feb 07 03&#58;50&#58;15 2018, osg-goc-rest wrote&#58;
<font color='#7F7E6F'>&#62; Hi,</font>
<font color='#7F7E6F'>&#62; there was no change on the submission side. But load could increase</font>
<font color='#7F7E6F'>&#62; because of recent rebalancing campaign (if that could be the problem).</font>
<font color='#7F7E6F'>&#62; -- by Michal.Svatos at Wed Feb 07 08&#58;48&#58;45 UTC 2018</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=133295' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=133295</a></font>
<font color='#7F7E6F'>&#62; -- by OSG-GOC at Wed Feb 07 08&#58;49&#58;39 UTC 2018</font>
-- by iriswu at Wed Feb 07 14&#58;53&#58;09 UTC 2018

GOCTX Source&#58; BNL Ticket&#58; Queue=StorageManagement ID=28195</pre></div><div class='update_description'><i onclick="document.location='35982#1517993379'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2018-02-07T08:49:39+00:00">Feb 7, 2018 08:49 AM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1517993379">&nbsp;</a></div><pre>Hi,
there was no change on the submission side. But load could increase because of recent rebalancing campaign (if that could be the problem).&#13;

-- by Michal.Svatos at Wed Feb 07 08&#58;48&#58;45 UTC 2018

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=133295' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=133295</a></pre></div><div class='update_description'><i onclick="document.location='35982#1517935174'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2018-02-06T16:39:34+00:00">Feb 6, 2018 04:39 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1517935174">&nbsp;</a></div><pre>From the ganglia plot, the volume of transfer increased in past few hours. And
the &#34;time out&#34; problem is gone after all grid ftp doors were restarted. Number
of transfer may decreased because two doors were in draining process and not
accepting new transfers. We restart grid door to clear the &#34;CLOSE_WAIT&#34; status
which caused by FTS killing the on-going slow transfer and not properly end the
transfer. Although the problem is fixed, we would like to find the reason.
There is no change in dCache storage, door and network , is anything changed in
job submission side? For example, the configuration, number of files? or size
of files.

Thanks,
Iris

On Tue Feb 06 10&#58;24&#58;15 2018, osg-goc-rest wrote&#58;
<font color='#7F7E6F'>&#62; Hi,</font>
<font color='#7F7E6F'>&#62; The number of transfers to bnl is very low now</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;</font>
<a href='https&#58;//fts.usatlas.bnl.gov&#58;8449/fts3/ftsmon/#/?vo=&source_se=srm&#58' target='_blank' rel='nofollow'>https&#58;//fts.usatlas.bnl.gov&#58;8449/fts3/ftsmon/#/?vo=&source_se=srm&#58</a>;%2F%2Fdcsrm.usatlas.bnl.gov&dest_se=&time_window=1
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; Also it would be good to know what went wring with all doors at the</font>
<font color='#7F7E6F'>&#62; same time.</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; Cheers,</font>
<font color='#7F7E6F'>&#62; Rod.</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; -- by rodney.walker at Tue Feb 06 15&#58;22&#58;42 UTC 2018</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=133295' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=133295</a></font>
<font color='#7F7E6F'>&#62; -- by OSG-GOC at Tue Feb 06 15&#58;23&#58;36 UTC 2018</font>
-- by iriswu at Tue Feb 06 16&#58;39&#58;23 UTC 2018

GOCTX Source&#58; BNL Ticket&#58; Queue=StorageManagement ID=28195</pre></div><div class='update_description'><i onclick="document.location='35982#1517930616'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2018-02-06T15:23:36+00:00">Feb 6, 2018 03:23 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1517930616">&nbsp;</a></div><pre>Hi,
The number of transfers to bnl is very low now

<a href='https&#58;//fts.usatlas.bnl.gov&#58;8449/fts3/ftsmon/#/?vo=&source_se=srm&#58' target='_blank' rel='nofollow'>https&#58;//fts.usatlas.bnl.gov&#58;8449/fts3/ftsmon/#/?vo=&source_se=srm&#58</a>;%2F%2Fdcsrm.usatlas.bnl.gov&dest_se=&time_window=1

Also it would be good to know what went wring with all doors at the same time.

Cheers,
Rod.&#13;

-- by rodney.walker at Tue Feb 06 15&#58;22&#58;42 UTC 2018

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=133295' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=133295</a></pre></div><div class='update_description'><i onclick="document.location='35982#1517923296'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2018-02-06T13:21:36+00:00">Feb 6, 2018 01:21 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1517923296">&nbsp;</a></div><pre>These two doors had less number of errors comparing with other doors based on
our yesterday&#39;s statistics so we put them the last in the process of draining
and restart. As checked, errors in doors already restarted sharply decreased .
These two doors has started to drain. Slow transfer problem should be gone
soon. We will keep monitoring.

Regards,
Iris

On Tue Feb 06 04&#58;58&#58;14 2018, osg-goc-rest wrote&#58;
<font color='#7F7E6F'>&#62; Is it just a coincidence that most of slow transfers seems to go</font>
<font color='#7F7E6F'>&#62; through dcdoor14.usatlas.bnl.gov (and may be also</font>
<font color='#7F7E6F'>&#62; dcdoor08.usatlas.bnl.gov)?</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; -- by Petr Vokac at Tue Feb 06 09&#58;56&#58;06</font>
<font color='#7F7E6F'>&#62; UTC 2018</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; Eric Lancon has subscribed to this ticket.</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; -- by Eric Lancon at Tue Feb 06 02&#58;08&#58;58 UTC 2018</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=133295' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=133295</a></font>
<font color='#7F7E6F'>&#62; -- by OSG-GOC at Tue Feb 06 09&#58;57&#58;05 UTC 2018</font>
-- by iriswu at Tue Feb 06 13&#58;21&#58;20 UTC 2018

GOCTX Source&#58; BNL Ticket&#58; Queue=StorageManagement ID=28195</pre></div><div class='update_description'><i onclick="document.location='35982#1517911025'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2018-02-06T09:57:05+00:00">Feb 6, 2018 09:57 AM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1517911025">&nbsp;</a></div><pre>Is it just a coincidence that most of slow transfers seems to go through dcdoor14.usatlas.bnl.gov (and may be also dcdoor08.usatlas.bnl.gov)?&#13;

-- by Petr Vokac at Tue Feb 06 09&#58;56&#58;06 UTC 2018

Eric Lancon has subscribed to this ticket.

&#13;

-- by Eric Lancon at Tue Feb 06 02&#58;08&#58;58 UTC 2018

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=133295' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=133295</a></pre></div><div class='update_description'><i onclick="document.location='35982#1517878198'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2018-02-06T00:49:58+00:00">Feb 6, 2018 12:49 AM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1517878198">&nbsp;</a></div><pre>We are aware of this problem and in the process of draining and restarting
gridftp doors. Let&#39;s see whether transfer rate will improve.

Regards,
Iris

On Mon Feb 05 17&#58;21&#58;13 2018, osg-goc-rest wrote&#58;
<font color='#7F7E6F'>&#62; ~2k transfer errors in the past 4 hours.</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; Example&#58;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; 2018-02-05</font>
<font color='#7F7E6F'>&#62; 21&#58;58&#58;55 mc16_13TeV&#58;HITS.13062893._055312.pool.root.1 #87</font>
<font color='#7F7E6F'>&#62; TRANSFER_FAILED</font>
<font color='#7F7E6F'>&#62; TOOL ID rucio-conveyor</font>
<font color='#7F7E6F'>&#62; SRC SITE DESY-HH_DATADISK</font>
<font color='#7F7E6F'>&#62; SRC</font>
<font color='#7F7E6F'>&#62; URL srm&#58;//dcache-se-</font>
<font color='#7F7E6F'>&#62;</font>
atlas.desy.de&#58;8443/srm/managerv2?SFN=/pnfs/desy.de/atlas/dq2/atlasdatadisk/rucio/mc16_13TeV/c4/fc/HITS.13062893._055312.pool.root.1
<font color='#7F7E6F'>&#62; DST SITE BNL-OSG2_DATADISK</font>
<font color='#7F7E6F'>&#62; DST</font>
<font color='#7F7E6F'>&#62; URL</font>
<font color='#7F7E6F'>&#62;</font>
<a href='srm&#58;//dcsrm.usatlas.bnl.gov&#58;8443/srm/managerv2?SFN=/pnfs/usatlas.bnl.gov/BNLT0D1/rucio/mc16_13TeV/c4/fc/HITS.13062893._055312.pool.root.1' target='_blank' rel='nofollow'>srm&#58;//dcsrm.usatlas.bnl.gov&#58;8443/srm/managerv2?SFN=/pnfs/usatlas.bnl.gov/BNLT0D1/rucio/mc16_13TeV/c4/fc/HITS.13062893._055312.pool.root.1</a>
<font color='#7F7E6F'>&#62; TRANSFER ID 47469d52-10f8-5366-a4fe-b4c4e0d0a17d</font>
<font color='#7F7E6F'>&#62; TRANSFER ENDPOINT <a href='https&#58;//fts.usatlas.bnl.gov&#58;8446' target='_blank' rel='nofollow'>https&#58;//fts.usatlas.bnl.gov&#58;8446</a></font>
<font color='#7F7E6F'>&#62; ERROR MSG TRANSFER [70] TRANSFER an end-of-file was reached</font>
<font color='#7F7E6F'>&#62; globus_xio&#58;</font>
<font color='#7F7E6F'>&#62; An end of file occurred</font>
<font color='#7F7E6F'>&#62; ACTIVITY Production Output</font>
<font color='#7F7E6F'>&#62; FILE SIZE 1118336841 bytes</font>
<font color='#7F7E6F'>&#62; DURATION 2 s</font>
<font color='#7F7E6F'>&#62; DATASET MONITORING Details on Rucio UI&#58; file</font>
<font color='#7F7E6F'>&#62;</font>
<div id='show_631812770' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_631812770'><font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; http&#58;//dashb-atlas-</font>
<font color='#7F7E6F'>&#62;</font>
ddm.cern.ch/ddm2/#activity=(Data+Brokering,Data+Consolidation,Deletion,Express,Functional+Test,Group+Subscriptions,Production,Production+Input,Production+Output,Recovery,Staging,T0+Export,T0+Tape,User+Subscriptions,default,on)&d.error_code=87&d.state=(TRANSFER_FAILED)&date.from=201802051800&date.interval=0&date.to=201802052200&dst.cloud=(%22US%22)&dst.site=(%22BNL-
<font color='#7F7E6F'>&#62; OSG2%22)&dst.tier=(0,1,2)&dst.token=(-IPV6TEST,-DDMTEST,-CEPH,-</font>
<font color='#7F7E6F'>&#62;</font>
PPSSCRATCHDISK)&grouping.dst=(cloud,site,token)&m.content=(d_dof,d_eff,d_faf,s_eff,s_err,s_suc,t_eff,t_err,t_suc)&samples=true&src.site=(-
<font color='#7F7E6F'>&#62; RUCIOTEST,-MWTEST,-RDF)&src.tier=(0,1,2)&src.token=(-IPV6TEST,-</font>
<font color='#7F7E6F'>&#62; DDMTEST,-CEPH,-PPSSCRATCHDISK)&tab=details</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; [Ticket Origin]</font>
<font color='#7F7E6F'>&#62; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=133295' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=133295</a></font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; [Ticket History]</font>
<font color='#7F7E6F'>&#62; Subject&#58; Transfer failures at US BNL-OSG2 as destination</font>
<font color='#7F7E6F'>&#62; Ticket Type&#58; TEAM</font>
<font color='#7F7E6F'>&#62; CC&#58; atlas-adc-cloud-us@....;</font>
<font color='#7F7E6F'>&#62; -- by Smita Darmora at Mon Feb 05 22&#58;19&#58;22 UTC 2018</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; [Ticket Origin]</font>
<font color='#7F7E6F'>&#62; <a href='https&#58;//ticket.grid.iu.edu/viewer?id=35982#1517869220' target='_blank' rel='nofollow'>https&#58;//ticket.grid.iu.edu/viewer?id=35982#1517869220</a></font>
-- by iriswu at Tue Feb 06 00&#58;49&#58;49 UTC 2018

GOCTX Source&#58; BNL Ticket&#58; Queue=StorageManagement ID=28195
</div><script type='text/javascript'>
        $('#show_631812770').click(function() {
            $('#detail_631812770').slideDown("normal");
            $('#show_631812770').hide();
            $('#hide_631812770').show();
        });
        $('#hide_631812770').click(function() {
            $('#detail_631812770').slideUp();
            $('#hide_631812770').hide();
            $('#show_631812770').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='35982#1517869220'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2018-02-05T22:20:20+00:00">Feb 5, 2018 10:20 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1517869220">&nbsp;</a></div><pre>~2k transfer errors in the past 4 hours.

Example&#58;

2018-02-05 21&#58;58&#58;55	mc16_13TeV&#58;HITS.13062893._055312.pool.root.1	#87	TRANSFER_FAILED
TOOL ID	rucio-conveyor
SRC SITE	DESY-HH_DATADISK
SRC URL	<a href='srm&#58;//dcache-se-atlas.desy.de&#58;8443/srm/managerv2?SFN=/pnfs/desy.de/atlas/dq2/atlasdatadisk/rucio/mc16_13TeV/c4/fc/HITS.13062893._055312.pool.root.1' target='_blank' rel='nofollow'>srm&#58;//dcache-se-atlas.desy.de&#58;8443/srm/managerv2?SFN=/pnfs/desy.de/atlas/dq2/atlasdatadisk/rucio/mc16_13TeV/c4/fc/HITS.13062893._055312.pool.root.1</a>
DST SITE	BNL-OSG2_DATADISK
DST URL	<a href='srm&#58;//dcsrm.usatlas.bnl.gov&#58;8443/srm/managerv2?SFN=/pnfs/usatlas.bnl.gov/BNLT0D1/rucio/mc16_13TeV/c4/fc/HITS.13062893._055312.pool.root.1' target='_blank' rel='nofollow'>srm&#58;//dcsrm.usatlas.bnl.gov&#58;8443/srm/managerv2?SFN=/pnfs/usatlas.bnl.gov/BNLT0D1/rucio/mc16_13TeV/c4/fc/HITS.13062893._055312.pool.root.1</a>
TRANSFER ID	47469d52-10f8-5366-a4fe-b4c4e0d0a17d
TRANSFER ENDPOINT	<a href='https&#58;//fts.usatlas.bnl.gov&#58;8446' target='_blank' rel='nofollow'>https&#58;//fts.usatlas.bnl.gov&#58;8446</a>
ERROR MSG	TRANSFER [70] TRANSFER an end-of-file was reached globus_xio&#58; An end of file occurred
ACTIVITY	Production Output
FILE SIZE	1118336841 bytes
DURATION	2 s
DATASET MONITORING	Details on Rucio UI&#58;  file

<a href='http&#58;//dashb-atlas-ddm.cern.ch/ddm2/#activity=' target='_blank' rel='nofollow'>http&#58;//dashb-atlas-ddm.cern.ch/ddm2/#activity=</a>(Data+Brokering,Data+Consolidation,Deletion,Express,Functional+Test,Group+Subscriptions,Production,Production+Input,Production+Output,Recovery,Staging,T0+Export,T0+Tape,User+Subscriptions,default,on)&d.error_code=87&d.state=(TRANSFER_FAILED)&date.from=201802051800&date.interval=0&date.to=201802052200&dst.cloud=(%22US%22)&dst.site=(%22BNL-OSG2%22)&dst.tier=(0,1,2)&dst.token=(-IPV6TEST,-DDMTEST,-CEPH,-PPSSCRATCHDISK)&grouping.dst=(cloud,site,token)&m.content=(d_dof,d_eff,d_faf,s_eff,s_err,s_suc,t_eff,t_err,t_suc)&samples=true&src.site=(-RUCIOTEST,-MWTEST,-RDF)&src.tier=(0,1,2)&src.token=(-IPV6TEST,-DDMTEST,-CEPH,-PPSSCRATCHDISK)&tab=details

[Ticket Origin]
<a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=133295' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=133295</a>

[Ticket History]
Subject&#58; Transfer failures at US BNL-OSG2 as destination
Ticket Type&#58; TEAM
CC&#58; atlas-adc-cloud-us@....;
-- by Smita Darmora at Mon Feb 05 22&#58;19&#58;22 UTC 2018</pre></div><legend>Similar Recent Tickets <small>modified within the last 30 days</small></legend><div id="similar_tickets"><p class="muted">No similar tickets found.</p></div>
</div>
<script type="text/javascript">
function reset_anchor() {
    $("#updates .selected").removeClass("selected");
    var urls = document.location.toString().split('#'); 
    var anchor = urls[1];
    if(anchor) {
        $("a[name='"+anchor+"']").parents(".update_description").addClass("selected");
    }
}
function submitspam(ticket_id) {
    myret = confirm("Would you like to close this ticket as a security ticket, and submit the ticket content to akismet?");
    if(myret == true) {
        $.ajax("viewer/processspam?id="+ticket_id).done(function() {
            window.location.reload();
        });
    }
}

$(function() {
    reset_anchor();
    var ADDITIONAL_COOKIE_NAME = 'gocticket';
    var options = { path: '/', expires: 365};

    if(window.opener && window.opener.name == "gocticket_list") {
        v = $.cookie("closewindow");
        if(!v) {
            $("#closewindow").attr("checked", "checked"); //on by default
        } else {
            if(v == "checked") {
                $("#closewindow").attr("checked", "checked");
            }
        }
        $("#closewindow").click(function() {
            $.cookie("closewindow", $(this).attr('checked'), options);
        });
    } else {
        $("#closewindow_area").hide();
    }
    function updateTimeago() {
        $("time").timeago();
        setTimeout(updateTimeago, 30*1000);
    }
    updateTimeago();
    $(".description").focus(expand_description);
});
</script>
<hr/>
<footer>
<p>GOC Ticket Version 2.2 | <a href="https://ticket.opensciencegrid.org/goc/submit?app_issue_check=on&amp;app_issue_type=goc&amp;app_goc_url=https%3A%2F%2Fticket.opensciencegrid.org%3A443%2F35982">Report Bugs</a>
 | <a href="https://github.com/opensciencegrid/operations/blob/master/docs/privacy.md">Privacy Policy</a>
</p>

<p> <img align="top" src="images/tag_orange.png"/> Copyright 2018 The Trustees of Indiana University - Developed for Open Science Grid</p>
</footer>


</div><!--container-fluid-->
<script src="https://ticket1.grid.iu.edu:8443/socket.io/socket.io.js"></script>
<script>
var chat = io.connect('https://ticket1.grid.iu.edu:8443');
chat.on('connect', function() {
    chat.emit('authenticate', {nodekey:'', ticketid: 35982});
});
chat.on('peers', function(peers) {
    $("#peers").html("");
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('peer_disconnect', function(pid) {
    $("#peer_"+pid).hide("slow");
});
chat.on('peer_connected', function(peers) {
    //expect only 1 peer connecting, but..
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('submit', function() {
    if(confirm("This ticket was updated. Do you want to refresh?")) {
        history.go(0);
    }
});

function addPeer(pid, peer) {
    var ipinfo = "";
    if(peer.ip != undefined) {
        ipinfo = "<span class=\"ip\">"+peer.ip+"</span>";
    }
    if(chat.io.engine.id == pid) {
        //don't display myself
        return;
    }
    var html = "<li class=\"new\" id=\"peer_"+pid+"\" class=\"peer\">"+peer.name+ipinfo+"</li>";
    $("#peers").prepend(html);
    $("#peers .new").animate({bottom: 0}, 1000, function() {$(this).removeClass("new")});
}

$(function() {
    $("#ticket_form").submit(function() {
        chat.emit('submit');
        return true;
    });
});
</script>
<script>
//used by searchbox
function parseValue(value) {
    var obj = new Object();
    var tokens = value.split("\t");
    obj.str = tokens[0];
    obj.count = tokens[1];
    return obj;
}

$(function() {
    //bootstrap-2.0.4 stuff
    $(".alert-message").alert();
    $(".dropdown-toggle").dropdown();
    $("span[rel='tooltip']").tooltip();
    $("a[rel=popover]").popover();

    //activate menu that user is currently on
    $("#menu_navigator").addClass("active"); 
    $("#submenu_").addClass("active"); 

    //translate zend validation error message to bootstrap
    $(".errors").addClass("alert").addClass("alert-error");

    //enable autocomplete for search box
    $("#search").autocomplete({
        source: function( request, response ) {
            $.ajax({
                url: "search/autocomplete",
                dataType: "text",
                data: {
                    //featureClass: "P",
                    //style: "full",
                    //maxRows: 12,
                    //name_startsWith: request.term
                    q: request.term
                },
                success: function( data ) {
                    response( $.map( data.split("\n"), function( item ) {
                        if(item == "") return null;
                        return {
                            value: item
                        }
                    }));
                }
            });
        },
        select: function(event, ui) {
            document.location = "search?q="+ui.item.value;
        }
    });
    
});
</script>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-69012-13");
pageTracker._trackPageview();
} catch(err) {}
</script>

</body>
