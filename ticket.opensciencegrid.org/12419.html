<!DOCTYPE html>
<html lang="en">
  <head>
  <base href="">
    <title>[12419] Consistent service startup states in OSG3</title>    <meta charset="utf-8" />
    <meta name="verify-v1" content="na5IcAJsZVOfEkboRxuIiZ1zpZgnZiWra+nKcS7nA/o=" />
    <meta name="google-site-verification" content="DLrk3ft4s8b-S2TloLCL2LD_t6wcTjgSluf5pmiu2kA" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />
    <link href="https://ticket.opensciencegrid.org/rss" rel="alternate" type="application/rss+xml" title="GOC Ticket Update feed" />

    <style type="text/css">
      body {
        padding-top: 50px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
     #search {
            width: 300px;
     }

    </style>

<script src="https://code.jquery.com/jquery-3.0.0.js"></script>
<script src="https://code.jquery.com/jquery-migrate-3.0.1.js"></script>

   <link href="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet"/>
    <script src="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/js/bootstrap.min.js"></script>

    <link href="https://netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"/>
    <link href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/themes/smoothness/jquery-ui.min.css" rel="stylesheet"/>
 <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>


    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/js/select2.min.js"></script>

    <link href="css/ticket.css" rel="stylesheet" />
    <script src="lib/jquery.cookie.js"></script>

    <link href="images/tag_orange.png" rel="icon" type="image/png"/>
  </head>

  <body>
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>

            <a class="brand" style="padding: 6px 0px 0px 6px;" href="http://opensciencegrid.org"><img src="images/osglogo.40x30.png"/></a>
            <ul class="nav">
                <li class="dropdown"><a href="https://ticket.opensciencegrid.org/#" class="dropdown-toggle" data-toggle="dropdown">GOC Ticket <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    <li><a href="https://my.opensciencegrid.org">MyOSG</a></li>
                    <li><a href="https://oim.opensciencegrid.org">OIM</a></li>
                    <li class="active"><a href="https://ticket.opensciencegrid.org/index">Ticket</a></li>
	<li class="divider"></li>
	<li><a href="http://repo.grid.iu.edu">Repo</a></li>
	<li class="divider"></li>
	<li><a href="http://blogs.grid.iu.edu">Blog</a></li>
                    <li><a href="http://display.grid.iu.edu">Display</a></li>
                    <li><a href="http://osggoc.blogspot.com/">News</a></li>
                    </ul>
                </li>
            </ul>
            <ul class="nav pull-right">
                <li><a href="https://ticket.opensciencegrid.org/sso/">Login</a></li>            </ul>

            <div class="nav-collapse">
                <ul class="nav">
			 <li id="menu_submit"><a href="https://ticket.opensciencegrid.org/submit">Submit</a></li><li id="menu_view" class="dropdown"><a href="https://ticket.opensciencegrid.org/\#" class="dropdown-toggle" data-toggle="dropdown">View <b class="caret"></b></a><ul class="dropdown-menu"><li id="submenu_listopen"><a href="https://ticket.opensciencegrid.org/list/open">Open Tickets</a></li><li id="submenu_listrecentclose"><a href="https://ticket.opensciencegrid.org/list/recentclose">Recently Closed Tickets</a></li><li class="divider"></li><li id="submenu_alltickets"><a href="https://ticket.opensciencegrid.org/search?q=&amp;sort=id">All Tickets</a></li></ul></li>                </ul>

                <form class="navbar-search pull-right" action="https://ticket.opensciencegrid.org/viewer">
                    <input id="search" type="text" name="id" class="search-query span2" placeholder="Search Ticket" value=""/>
                </form>
            </div>
        </div>
      </div>
    </div>

<script type='text/javascript' src='lib/jquery.timeago.js'></script>
<script type='text/javascript' src='lib/byte2size.js'></script>
<style>
#updates .toolbar {
position: relative;
margin-top: 0px;
top: -10px;
font-weight: normal;
}
#updates a.anchor {
position: relative;
top: -50px;
}
#updates .selected pre {
animation:selected 2s;
animation-iteration-count: 2;
animation-direction: alternate;
-webkit-animation:selected 2s; 
-webkit-animation-iteration-count: 2;
-webkit-animation-direction: alternate;
box-shadow: inset 1px 1px 20px #9ad;
border: 1px solid #9ab;
margin: 5px 0px;
padding-left: 10px;
}
@keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ab;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
@-webkit-keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ad;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
#updates pre {
background-color: inherit;
line-height: 15px;
padding: 5px;
}
#updates .header {
color: #999;
}
#updates .update_history pre {
background-color: #eee;
color: #666;
font-size: 85%;
}
#updates .clickable {
cursor: pointer;
}
#updates .clickable:hover {
color: #D98719;
}
#updates .meta_information pre {
background-color: #fed;
}
#similar_tickets {
max-height: 300px;
overflow-y: auto;
pointer-events: none;
padding: 5px;
background-color: #f4f4f4;
}
.btn-toolbar {
margin-bottom: 0;
height: 30px;
}
#peers {
position: fixed;
bottom: 0px;
right: 0px;
z-index: 100;
list-style: none;
padding: 5px 0px 0px 5px;
margin: 0px;
background-color: white;
box-shadow: 0px 0px 10px white;
}
#peers li {
background-color: #ccc;
color: #000;
display: inline-block;
padding: 5px 10px;
margin-right: 5px;
position: relative;
}
/*
#peers li:hover {
background-color: #999;
cursor: pointer;
}
*/
#peers span.ip {
padding-left: 5px;
color: #666;
}
#peers .new {
bottom: -30px;
}
/*
#peers .me {
background-color: red;
}
*/
</style>

<div class="container-fluid">
<ul id="peers"></ul>
<div class="alert alert-danger"><a class="close" href="https://ticket.opensciencegrid.org/#" data-dismiss="alert">&times;</a>By the end of May 2018, the ticketing system at https://ticket.opensciencegrid.org will be retired and support will be provided at https://support.opensciencegrid.org. Throughout this transition the support email (help@opensciencegrid.org) will be available as a point of contact.<br><br>                                                   
                                                                                                                                                                                   
Please see the service migration page for details: https://opensciencegrid.github.io/technology/policy/service-migrations-spring-2018/#ticket</div><div id="presence" class="pull-right"></div><div class="ticketgui"><script type="text/javascript" src="lib/checktab.js"></script>

<script>
var expanded = false;
function expand_description() {
    var desc = $(".description");
    if(!expanded) {
        expanded = true;
        //expand to minheight
        var min = 250;
        if(desc.height() < min) {
            desc.animate({height: min}, 200);
        }
    }
}

$(document).ready(function() {
    $("input[name='nad']").datepicker({
        dateFormat: 'yy-mm-dd'
    });
});

</script>



<style>
.form-horizontal .control-label {
padding-top: inherit;
font-size:90%;
color:#666;
}
label {
margin-bottom: 0px;
}
.controls {
line-height: 18px;
}
</style>
<form class="form-horizontal" action="https://ticket.opensciencegrid.org/viewer/updatebasic?id=12419" method="post">
<div class="page-header">
    <h3><span class="muted">12419</span> / Consistent service startup states in OSG3</h3>
</div>

<div class="row-fluid">
<div class="span5">
    <legend>Contact</legend>
    <div class="control-group">
        <label class="control-label">Full Name</label>
        <div class="controls">Patrick McGuigan</div>
    </div>
    <div class="control-group">
        <label class="control-label">Email</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">Phone</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">CC</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>

    <legend>Details</legend>
    <div class="control-group"><label class="control-label">Submitted Via</label><div class="controls">GOC Ticket/submit</div></div><div class="control-group"><label class="control-label">Submitter</label><div class="controls">Patrick McGuigan</div></div>
    <div class="control-group">
        <label class="control-label">Ticket Type</label>
        <div class="controls">Problem/Request</div>
    </div>
    <div class="control-group">
        <label class="control-label">Priority</label>
        <div class="controls">Normal</div>
    </div>
    <div class="control-group">
        <label class="control-label">Status</label>
        <div class="controls">
Closed</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action</label>
        <div class="controls">ping</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action Deadline</label>
        <div class="controls flag_red">2012-08-10</div>
    </div>

</div><!--span-->
<div class="span7">
    <legend>Assignees</legend>
    <div class="assignee" style="width: 60%">Software Support (Triage) <span class="muted"> / OSG Software Team</span></div>    <br>

    <legend>Assignees</legend>
    TODO
    <br>

    <style>
legend.noborder {
border-bottom: none;
}
</style>

<div id="attachment-list"/>
<script>
$(function () {
    var first = true;
    $.getJSON("attachment/list/12419", function (files) {
        //console.dir(files);
        var html = "<table class=\"table table-condensed\">";
        $(files).each(function() {
            if(first) {
                first = false;
                html += "<legend class=\"noborder\">Attachmenets</legend>";
            }
            html += "<tr class=\"attachment\">";
            html += "<td><img src=\""+this.thumbnail_url+"\"/></td>";
            html += "<td><a href=\""+this.url+"\" target=\"_blank\">"+this.name+"</a></td>";
            html += "<td>"+bytesToSize(this.size, 1)+"</td>";
            html += "</tr>";
        });
        html += "</table>";
        $("#attachment-list").html(html);
    });
});

function download(url) {
    window.open(url, "_blank");
}
</script>


</div><!--span-->
</div><!--row-fluid-->


</form>

</div>
<div id="updates" style="clear: both;">
    <legend>Past Updates
    <div class="btn-toolbar pull-right toolbar">
        <div class="btn-group">
                <a class="btn btn-small" href="https://ticket.opensciencegrid.org/12419?sort=up&amp;"><i class="icon-arrow-up"></i> Sort</a>

        
        <a class="btn btn-small" href="https://ticket.opensciencegrid.org/12419?expandall=true&amp;">Expand Descriptions</a>        <a class="btn btn-small" target="_blank" href="mailto:osg@tick.globalnoc.iu.edu?subject=Open%20Science%20Grid%3A%20Consistent%20service%20startup%20states%20in%20OSG3%20ISSUE%3D12419%20PROJ%3D71"><i class="icon-envelope"></i> Update w/Email</a>
        </div>
    </div><!--btn-toolbar-->
    </legend>

    <div class='update_description'><i onclick="document.location='12419#1344604846'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-08-10T13:20:46+00:00">Aug 10, 2012 01:20 PM UTC</time><a class="anchor" name="1344604846">&nbsp;</a></div><pre>Patrick,

I&#39;m going to close this ticket, but please let me know if you encounter any problems with the new release.

Thank you,
Elizabeth

-- by Elizabeth Prout</pre></div><div class='update_description'><i onclick="document.location='12419#1344019291'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-08-03T18:41:31+00:00">Aug 3, 2012 06:41 PM UTC</time> by <b>echism</b><a class="anchor" name="1344019291">&nbsp;</a></div><pre>Patrick,

Release 3.1.7 went out. Have you had a chance to try the new release?

Thank you,
Elizabeth</pre></div><div class='update_description'><i onclick="document.location='12419#1343258049'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-07-25T23:14:09+00:00">Jul 25, 2012 11:14 PM UTC</time> by <b>Alain Roy</b><a class="anchor" name="1343258049">&nbsp;</a></div><pre>On Jul 25, 2012, at 3&#58;44 PM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; Clarifying the glite-ce-blah-parser, This does not start during installation, but is</font>
<font color='#7F7E6F'>&#62; chkconfig&#39;ed on to automatically start on reboots.  This is my complaint.   Yes, I receive</font>
<font color='#7F7E6F'>&#62; condor from installing managed-fork.  For pure curiosity&#39;s sake&#58; Why would Condor have a</font>
<font color='#7F7E6F'>&#62; dependency on a service that you are not going to run?</font>

Good, got it. We&#39;ve fixed this and it will be in next week&#39;s release, OSG Software 3.1.7.

Condor depends on the &#34;blahp&#34; which allows it to submit jobs to other batch systems. While not frequently used (yet), this is Condor functionality, so Condor does depend on it. However, I don&#39;t believe it needs this blah-parser. At the very least, it&#39;s rarely needed so we should have it off by default.

<font color='#7F7E6F'>&#62; Clarifying the globus-scheduler-event-generator.  It is definitely be started as part of</font>
<font color='#7F7E6F'>&#62; the CE install, but maybe not where you might think&#58;</font>

<font color='#7F7E6F'>&#62;  Installing     &#58; globus-gram-job-manager-pbs                          108/207</font>
<font color='#7F7E6F'>&#62;   Installing     &#58; globus-gram-job-manager-pbs-setup-seg</font>
<font color='#7F7E6F'>&#62; 109/207globus-scheduler-event-generator (pbs) is running (pid=</font>
<font color='#7F7E6F'>&#62; 4347)</font>
<font color='#7F7E6F'>&#62; Stopped globus-scheduler-event-generator[  OK  ]</font>
<font color='#7F7E6F'>&#62; Started globus-scheduler-event-generator for (pbs)[  OK  ]</font>

Ah, I see! I&#39;ll investigate that shortly. It&#39;s the end of the day here and I&#39;m on vacation for the next two days, so it won&#39;t be immediately. But this is probably wrong. I agree that it shouldn&#39;t be started by default. Thanks for the details--that makes it much easier to track down.

-alain
------------------------------------
Alain Roy
OSG Software Support
vdt-support@....</pre></div><div class='update_description'><i onclick="document.location='12419#1343256256'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-07-25T22:44:16+00:00">Jul 25, 2012 10:44 PM UTC</time> by <b>Patrick McGuigan</b><a class="anchor" name="1343256256">&nbsp;</a></div><pre>Hi Alain,

Clarifying the glite-ce-blah-parser, This does not start during installation, but is
chkconfig&#39;ed on to automatically start on reboots.  This is my complaint.   Yes, I receive
condor from installing managed-fork.  For pure curiosity&#39;s sake&#58; Why would Condor have a
dependency on a service that you are not going to run?

Clarifying the globus-scheduler-event-generator.  It is definitely be started as part of
the CE install, but maybe not where you might think&#58;

This is a snippet from the installation log of the CE&#58;

Installing     &#58; globus-scheduler-event-generator                      26/207
...
Installing     &#58; globus-scheduler-event-generator-progs                60/207
...
Installing     &#58; globus-gram-job-manager-pbs                          108/207
Installing     &#58; globus-gram-job-manager-pbs-setup-seg
109/207globus-scheduler-event-generator (pbs) is running (pid=
4347)
Stopped globus-scheduler-event-generator[  OK  ]
Started globus-scheduler-event-generator for (pbs)[  OK  ]

Installing     &#58; cryptix-asn1                                         110/207

I have the full log available if you want.  Clearly the installation of
globus-gram-job-manager-pbs-setup-seg is starting the seg for pbs.  I have no idea what
was running with PID of 4347 when this package was installed.

I am not familiar with the packaging guidelines, but I find it odd that this will end up
being the only service started, by default, on a reboot. I&#39;m not saying you are wrong,
just that I find it odd.

On 07/25/2012 02&#58;38 PM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='12419#1343245121'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-07-25T19:38:41+00:00">Jul 25, 2012 07:38 PM UTC</time> by <b>Alain Roy</b><a class="anchor" name="1343245121">&nbsp;</a></div><pre>Hi Patrick,

Thanks for the report. I agree that we shouldn&#39;t be starting services during the installation, and these were overlooked.

===== bwctl =====
You&#39;re right, the server shouldn&#39;t be installed. I&#39;ve made a ticket for this and we&#39;ll fix it in the near future.
<a href='http&#58;//jira.opensciencegrid.org/browse/SOFTWARE-720' target='_blank' rel='nofollow'>http&#58;//jira.opensciencegrid.org/browse/SOFTWARE-720</a>

==== glite-ce-blah-parser =====
Can you clarify the situation? This is surprising and it shouldn&#39;t happen, but we can also fix it. As best I can tell, we install this as a dependency of Condor (which you got because of managed-fork? When it installs it calls &#34;chkconfig --add&#34; but does not start the service. However, due to the default runlevels, it will be started by init when you start your computer. Did you see the service start immediately?

My gut says that we should patch this so it has no default runlevels and doesn&#39;t run at startup. Let me know if you saw something else we should do.

I&#39;ve made a ticket for this too&#58;
<a href='http&#58;//jira.opensciencegrid.org/browse/SOFTWARE-721' target='_blank' rel='nofollow'>http&#58;//jira.opensciencegrid.org/browse/SOFTWARE-721</a>

===== globus-scheduler-event-generator =====
I looked pretty carefully, and the RPM seems to add it to chkconfig and set it to run on startup, but it does not start it. Are you sure you saw it start as part of the install process? If so, I&#39;ll look more carefully. In this case, I think it&#39;s appropriate&#58; we should set it to run on startup (according to the Fedora packaging guidelines).

Thanks!
-alain
------------------------------------
Alain Roy
OSG Software Support
vdt-support@....</pre></div><div class='update_description'><i onclick="document.location='12419#1343169879'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-07-24T22:44:39+00:00">Jul 24, 2012 10:44 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1343169879">&nbsp;</a></div><pre>[by Patrick McGuigan]

Hi,

I would have to rerun the installation on a test machine, to make double sure of the following list, but I would like to see that the software installed by OSG is in a consistent state.  I understand that OSG may not be packaging all of the software.

I noticed that most of the services installed in /etc/init.d/ after an osg-ce-pbs, osg-managedfork and osg-rsv installation are setup not to run at startup by default.  However these services are turned on by default&#58;

bwctld  (I know that this shouldn&#39;t be here)
glite-ce-blah-parser  (What does this do and do I need it on a pbs site?)
globus-scheduler-event-generator

Actually the globus-scheduler-event-generator starts running as part of the installation.

Should these services be repackaged so there default state is not run at startup to be consistent with the other services installed with a typical CE?</pre></div>
</div>
<script type="text/javascript">
function reset_anchor() {
    $("#updates .selected").removeClass("selected");
    var urls = document.location.toString().split('#'); 
    var anchor = urls[1];
    if(anchor) {
        $("a[name='"+anchor+"']").parents(".update_description").addClass("selected");
    }
}
function submitspam(ticket_id) {
    myret = confirm("Would you like to close this ticket as a security ticket, and submit the ticket content to akismet?");
    if(myret == true) {
        $.ajax("viewer/processspam?id="+ticket_id).done(function() {
            window.location.reload();
        });
    }
}

$(function() {
    reset_anchor();
    var ADDITIONAL_COOKIE_NAME = 'gocticket';
    var options = { path: '/', expires: 365};

    if(window.opener && window.opener.name == "gocticket_list") {
        v = $.cookie("closewindow");
        if(!v) {
            $("#closewindow").attr("checked", "checked"); //on by default
        } else {
            if(v == "checked") {
                $("#closewindow").attr("checked", "checked");
            }
        }
        $("#closewindow").click(function() {
            $.cookie("closewindow", $(this).attr('checked'), options);
        });
    } else {
        $("#closewindow_area").hide();
    }
    function updateTimeago() {
        $("time").timeago();
        setTimeout(updateTimeago, 30*1000);
    }
    updateTimeago();
    $(".description").focus(expand_description);
});
</script>
<hr/>
<footer>
<p>GOC Ticket Version 2.2 | <a href="https://ticket.opensciencegrid.org/goc/submit?app_issue_check=on&amp;app_issue_type=goc&amp;app_goc_url=https%3A%2F%2Fticket.opensciencegrid.org%3A443%2F12419">Report Bugs</a>
 | <a href="https://github.com/opensciencegrid/operations/blob/master/docs/privacy.md">Privacy Policy</a>
</p>

<p> <img align="top" src="images/tag_orange.png"/> Copyright 2018 The Trustees of Indiana University - Developed for Open Science Grid</p>
</footer>


</div><!--container-fluid-->
<script>
//used by searchbox
function parseValue(value) {
    var obj = new Object();
    var tokens = value.split("\t");
    obj.str = tokens[0];
    obj.count = tokens[1];
    return obj;
}

$(function() {
    //bootstrap-2.0.4 stuff
    $(".alert-message").alert();
    $(".dropdown-toggle").dropdown();
    $("span[rel='tooltip']").tooltip();
    $("a[rel=popover]").popover();

    //activate menu that user is currently on
    $("#menu_navigator").addClass("active"); 
    $("#submenu_").addClass("active"); 

    //translate zend validation error message to bootstrap
    $(".errors").addClass("alert").addClass("alert-error");

    //enable autocomplete for search box
    $("#search").autocomplete({
        source: function( request, response ) {
            $.ajax({
                url: "search/autocomplete",
                dataType: "text",
                data: {
                    //featureClass: "P",
                    //style: "full",
                    //maxRows: 12,
                    //name_startsWith: request.term
                    q: request.term
                },
                success: function( data ) {
                    response( $.map( data.split("\n"), function( item ) {
                        if(item == "") return null;
                        return {
                            value: item
                        }
                    }));
                }
            });
        },
        select: function(event, ui) {
            document.location = "search?q="+ui.item.value;
        }
    });
    
});
</script>


</body>
