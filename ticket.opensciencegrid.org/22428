<!DOCTYPE html>
<html lang="en">
  <head>
  <base href="">
    <title>[22428] Can not sign AUP VOMS 2.7.0</title>    <meta charset="utf-8" />
    <meta name="verify-v1" content="na5IcAJsZVOfEkboRxuIiZ1zpZgnZiWra+nKcS7nA/o=" />
    <meta name="google-site-verification" content="DLrk3ft4s8b-S2TloLCL2LD_t6wcTjgSluf5pmiu2kA" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />
    <link href="https://ticket.opensciencegrid.org/rss" rel="alternate" type="application/rss+xml" title="GOC Ticket Update feed" />

    <style type="text/css">
      body {
        padding-top: 50px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
     #search {
            width: 300px;
     }

    </style>

<script src="https://code.jquery.com/jquery-3.0.0.js"></script>
<script src="https://code.jquery.com/jquery-migrate-3.0.1.js"></script>

   <link href="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet"/>
    <script src="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/js/bootstrap.min.js"></script>

    <link href="https://netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"/>
    <link href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/themes/smoothness/jquery-ui.min.css" rel="stylesheet"/>
 <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>


    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/js/select2.min.js"></script>

    <link href="css/ticket.css" rel="stylesheet" />
    <script src="lib/jquery.cookie.js"></script>

    <link href="images/tag_orange.png" rel="icon" type="image/png"/>
    <script src='https://www.google.com/recaptcha/api.js'></script>
  </head>

  <body>
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>

            <a class="brand" style="padding: 6px 0px 0px 6px;" href="http://opensciencegrid.org"><img src="images/osglogo.40x30.png"/></a>
            <ul class="nav">
                <li class="dropdown"><a href="https://ticket.opensciencegrid.org/#" class="dropdown-toggle" data-toggle="dropdown">GOC Ticket <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    <li><a href="https://my.opensciencegrid.org">MyOSG</a></li>
                    <li><a href="https://oim.opensciencegrid.org">OIM</a></li>
                    <li class="active"><a href="https://ticket.opensciencegrid.org/index">Ticket</a></li>
	<li class="divider"></li>
	<li><a href="http://repo.grid.iu.edu">Repo</a></li>
	<li class="divider"></li>
	<li><a href="http://blogs.grid.iu.edu">Blog</a></li>
                    <li><a href="http://display.grid.iu.edu">Display</a></li>
                    <li><a href="http://osggoc.blogspot.com/">News</a></li>
                    </ul>
                </li>
            </ul>
            <ul class="nav pull-right">
                <li><a href="https://ticket.opensciencegrid.org/sso/">Login</a></li>            </ul>

            <div class="nav-collapse">
                <ul class="nav">
			 <li id="menu_submit"><a href="https://ticket.opensciencegrid.org/submit">Submit</a></li><li id="menu_view" class="dropdown"><a href="https://ticket.opensciencegrid.org/\#" class="dropdown-toggle" data-toggle="dropdown">View <b class="caret"></b></a><ul class="dropdown-menu"><li id="submenu_listopen"><a href="https://ticket.opensciencegrid.org/list/open">Open Tickets</a></li><li id="submenu_listrecentclose"><a href="https://ticket.opensciencegrid.org/list/recentclose">Recently Closed Tickets</a></li><li class="divider"></li><li id="submenu_alltickets"><a href="https://ticket.opensciencegrid.org/search?q=&amp;sort=id">All Tickets</a></li></ul></li>                </ul>

                <form class="navbar-search pull-right" action="https://ticket.opensciencegrid.org/viewer">
                    <input id="search" type="text" name="id" class="search-query span2" placeholder="Search Ticket" value=""/>
                </form>
            </div>
        </div>
      </div>
    </div>

<script type='text/javascript' src='lib/jquery.timeago.js'></script>
<script type='text/javascript' src='lib/byte2size.js'></script>
<style>
#updates .toolbar {
position: relative;
margin-top: 0px;
top: -10px;
font-weight: normal;
}
#updates a.anchor {
position: relative;
top: -50px;
}
#updates .selected pre {
animation:selected 2s;
animation-iteration-count: 2;
animation-direction: alternate;
-webkit-animation:selected 2s; 
-webkit-animation-iteration-count: 2;
-webkit-animation-direction: alternate;
box-shadow: inset 1px 1px 20px #9ad;
border: 1px solid #9ab;
margin: 5px 0px;
padding-left: 10px;
}
@keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ab;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
@-webkit-keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ad;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
#updates pre {
background-color: inherit;
line-height: 15px;
padding: 5px;
}
#updates .header {
color: #999;
}
#updates .update_history pre {
background-color: #eee;
color: #666;
font-size: 85%;
}
#updates .clickable {
cursor: pointer;
}
#updates .clickable:hover {
color: #D98719;
}
#updates .meta_information pre {
background-color: #fed;
}
#similar_tickets {
max-height: 300px;
overflow-y: auto;
pointer-events: none;
padding: 5px;
background-color: #f4f4f4;
}
.btn-toolbar {
margin-bottom: 0;
height: 30px;
}
#peers {
position: fixed;
bottom: 0px;
right: 0px;
z-index: 100;
list-style: none;
padding: 5px 0px 0px 5px;
margin: 0px;
background-color: white;
box-shadow: 0px 0px 10px white;
}
#peers li {
background-color: #ccc;
color: #000;
display: inline-block;
padding: 5px 10px;
margin-right: 5px;
position: relative;
}
/*
#peers li:hover {
background-color: #999;
cursor: pointer;
}
*/
#peers span.ip {
padding-left: 5px;
color: #666;
}
#peers .new {
bottom: -30px;
}
/*
#peers .me {
background-color: red;
}
*/
</style>

<div class="container-fluid">
<ul id="peers"></ul>
<div class="alert alert-danger"><a class="close" href="https://ticket.opensciencegrid.org/#" data-dismiss="alert">&times;</a>By the end of May 2018, the ticketing system at https://ticket.opensciencegrid.org will be retired and support will be provided at https://support.opensciencegrid.org. Throughout this transition the support email (help@opensciencegrid.org) will be available as a point of contact.<br><br>                                                   
                                                                                                                                                                                   
Please see the service migration page for details: https://opensciencegrid.github.io/technology/policy/service-migrations-spring-2018/#ticket</div><div id="presence" class="pull-right"></div><div class="ticketgui"><script type="text/javascript" src="lib/checktab.js"></script>

<script>
var expanded = false;
function expand_description() {
    var desc = $(".description");
    if(!expanded) {
        expanded = true;
        //expand to minheight
        var min = 250;
        if(desc.height() < min) {
            desc.animate({height: min}, 200);
        }
    }
}

$(document).ready(function() {
    $("input[name='nad']").datepicker({
        dateFormat: 'yy-mm-dd'
    });
});

</script>



<style>
.form-horizontal .control-label {
padding-top: inherit;
font-size:90%;
color:#666;
}
label {
margin-bottom: 0px;
}
.controls {
line-height: 18px;
}
</style>
<form class="form-horizontal" action="https://ticket.opensciencegrid.org/viewer/updatebasic?id=22428" method="post">
<div class="page-header">
    <h3><span class="muted">22428</span> / Can not sign AUP VOMS 2.7.0</h3>
</div>

<div class="row-fluid">
<div class="span5">
    <legend>Contact</legend>
    <div class="control-group">
        <label class="control-label">Full Name</label>
        <div class="controls">Tanya Levshina</div>
    </div>
    <div class="control-group">
        <label class="control-label">Email</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">Phone</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">CC</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>

    <legend>Details</legend>
    <div class="control-group"><label class="control-label">Submitted Via</label><div class="controls">GOC Ticket/submit</div></div><div class="control-group"><label class="control-label">Submitter</label><div class="controls">Tanya Levshina</div></div><div class="control-group"><label class="control-label">Ticket Links</label><div class="controls"><p><a target='_blank' href='25144'><b>25144</b> VOMS AUP renewal</a></p></div></div>
    <div class="control-group">
        <label class="control-label">Ticket Type</label>
        <div class="controls"></div>
    </div>
    <div class="control-group">
        <label class="control-label">Priority</label>
        <div class="controls">Elevated</div>
    </div>
    <div class="control-group">
        <label class="control-label">Status</label>
        <div class="controls">
Closed</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action</label>
        <div class="controls">Wait for FNAL email support team answer</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action Deadline</label>
        <div class="controls flag_red">2014-11-18</div>
    </div>

</div><!--span-->
<div class="span7">
    <legend>Assignees</legend>
    <div class="assignee" style="width: 60%">Scott Teige <span class="muted"> / OSG Operations Infrastructure</span></div><div class="assignee" style="width: 60%">FNAL (Prod)&nbsp;<a target="_blank" href="https://fermi.service-now.com/nav_to.do?uri=incident.do?sys_id=INC000000447001">INC000000447001</a> <span class="muted"> / Ticket Exchange</span></div><div class="assignee" style="width: 60%">Tim Cartwright <span class="muted"> / OSG Software Team</span></div>    <br>

    <legend>Assignees</legend>
    TODO
    <br>

    <style>
legend.noborder {
border-bottom: none;
}
</style>

<div id="attachment-list"/>
<script>
$(function () {
    var first = true;
    $.getJSON("https://ticket.opensciencegrid.org/attachment/list?id=22428", function (files) {
        //console.dir(files);
        var html = "<table class=\"table table-condensed\">";
        $(files).each(function() {
            if(first) {
                first = false;
                html += "<legend class=\"noborder\">Attachmenets</legend>";
            }
            html += "<tr class=\"attachment\">";
            html += "<td><img src="https://ticket.opensciencegrid.org/\&quot;&quot;+this.thumbnail_url+&quot;\&quot;/"></td>";
            html += "<td><a href="https://ticket.opensciencegrid.org/\&quot;&quot;+this.url+&quot;\&quot;" target=\"_blank\">"+this.name+"</a></td>";
            html += "<td>"+bytesToSize(this.size, 1)+"</td>";
            html += "</tr>";
        });
        html += "</table>";
        $("#attachment-list").html(html);
    });
});

function download(url) {
    window.open(url, "_blank");
}
</script>


</div><!--span-->
</div><!--row-fluid-->


</form>

</div>
<div id="updates" style="clear: both;">
    <legend>Past Updates
    <div class="btn-toolbar pull-right toolbar">
        <div class="btn-group">
                <a class="btn btn-small" href="https://ticket.opensciencegrid.org/22428?sort=up&amp;"><i class="icon-arrow-up"></i> Sort</a>

        
        <a class="btn btn-small" href="https://ticket.opensciencegrid.org/22428?expandall=true&amp;">Expand Descriptions</a>        <a class="btn btn-small" target="_blank" href="mailto:osg@tick.globalnoc.iu.edu?subject=Open%20Science%20Grid%3A%20Can%20not%20sign%20AUP%20VOMS%202.7.0%20ISSUE%3D22428%20PROJ%3D71"><i class="icon-envelope"></i> Update w/Email</a>
        </div>
    </div><!--btn-toolbar-->
    </legend>

    <div class='update_description'><i onclick="document.location='22428#1416243130'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-11-17T16:52:10+00:00">Nov 17, 2014 04:52 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1416243130">&nbsp;</a></div><pre>Hi,

the incident is resolved, therefore I&#39;ll proceed to close it.

Since the root cause of the incident is not fully understood the investigation will continue at FNAL.

Gerard
-- by gerard1 at Mon Nov 17 16&#58;50&#58;38 UTC 2014

GOCTX Source&#58; <a href='https&#58;//fermi.service-now.com/nav_to.do?uri=incident.do?sys_id=INC000000447001' target='_blank' rel='nofollow'>https&#58;//fermi.service-now.com/nav_to.do?uri=incident.do?sys_id=INC000000447001</a></pre></div><div class='update_description'><i onclick="document.location='22428#1415998209'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-11-14T20:50:09+00:00">Nov 14, 2014 08:50 PM UTC</time> by <b>Christopher Pipes</b><a class="anchor" name="1415998209">&nbsp;</a></div><pre>i Gerard,

Do you have an update on the cause of this issue?

Thanks,
Chris</pre></div><div class='update_description'><i onclick="document.location='22428#1414772132'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-10-31T16:15:32+00:00">Oct 31, 2014 04:15 PM UTC</time> by <b>Christopher Pipes</b><a class="anchor" name="1414772132">&nbsp;</a></div><pre>Hi Gerard,

Do you have an update on the cause of this issue?

Thanks,
Chris</pre></div><div class='update_description'><i onclick="document.location='22428#1414181568'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-10-24T20:12:48+00:00">Oct 24, 2014 08:12 PM UTC</time><a class="anchor" name="1414181568">&nbsp;</a></div><pre>Hi,

the issue was resolved on 2014-10-08 but it&#39;s root cause is not fully understood, under investigation.

Gerard

by /DC=gov/DC=fnal/O=Fermilab/OU=People/CN=Gerard Bernabeu Altayo/CN=UID&#58;gerard1</pre></div><div class='update_description'><i onclick="document.location='22428#1412192813'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-10-01T19:46:53+00:00">Oct 1, 2014 07:46 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1412192813">&nbsp;</a></div><pre>Hi Edgar,

this particular issue has to do with SMTP, but it would be great if VOMS-admin Software could be improved to log when it sends emails, specially when it fails at doing it. Probably this should be tracked in a different ticket (JIRA?) I guess. Maybe modern VOMS-admin versions already do that, I don&#39;t know but I&#39;d like the SW team to help us with this if possible. Thanks!

The specific SMTP issues we have with the current setup at FNAL are&#58;

1. Sometimes the SMTP server does not recognize opensicencegrid.org DNS as authorized, for example&#58;
HELO voms1.opensciencegrid.org
501 5.5.4 Invalid domain name

Note that if one keeps trying it eventually succeeds.

2. Sending emails to non fnal.gov addresses when source is *.opensicencegrid.org is not authorized&#58;
...
RCPT TO&#58; Greg.Nammari@....
550 5.7.1 Unable to relay

All details at FNAL ServiceNow INC000000452086.

Sorry for the inconvenience,
Gerard
-- by gerard1 at Wed Oct 01 19&#58;45&#58;08 UTC 2014

GOCTX Source&#58; <a href='https&#58;//fermi.service-now.com/nav_to.do?uri=incident.do?sys_id=INC000000447001' target='_blank' rel='nofollow'>https&#58;//fermi.service-now.com/nav_to.do?uri=incident.do?sys_id=INC000000447001</a></pre></div><div class='update_description'><i onclick="document.location='22428#1412183791'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-10-01T17:16:31+00:00">Oct 1, 2014 05:16 PM UTC</time><a class="anchor" name="1412183791">&nbsp;</a></div><pre>Hi Gerard,

This looks like a problem with fnal email rather than a software problem. Thus I am removing the software team.

Edgar
OSG Software

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=Edgar Mauricio Fajardo Hernandez 2020</pre></div><div class='update_description'><i onclick="document.location='22428#1412006513'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-09-29T16:01:53+00:00">Sep 29, 2014 04:01 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1412006513">&nbsp;</a></div><pre>Hi,

we&#39;re still debugging this with the email support team; the [ex-]smtp.fnal.gov server is not delivering emails to non fnal.gov email addresses.

We&#39;re working on this, I&#39;ll keep you posted.

sorry for the inconvenience,
Gerard
-- by gerard1 at Mon Sep 29 16&#58;00&#58;57 UTC 2014

GOCTX Source&#58; <a href='https&#58;//fermi.service-now.com/nav_to.do?uri=incident.do?sys_id=INC000000447001' target='_blank' rel='nofollow'>https&#58;//fermi.service-now.com/nav_to.do?uri=incident.do?sys_id=INC000000447001</a></pre></div><div class='update_description'><i onclick="document.location='22428#1411687810'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-09-25T23:30:10+00:00">Sep 25, 2014 11:30 PM UTC</time> by <b>Chander Sehgal</b><a class="anchor" name="1411687810">&nbsp;</a></div><pre>﻿
﻿﻿I am away from the office and your message to me has been saved for review upon my return on October 1

·          If your email pertains to OSG Project Management and requires quick action, please contact Gabriele Garzoglio at garzogli@....
·          If your email pertains to OSG User Support and requires attention now, please email user-support@....

Thanks,
Chander Sehgal
﻿</pre></div><div class='update_description'><i onclick="document.location='22428#1411687707'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-09-25T23:28:27+00:00">Sep 25, 2014 11:28 PM UTC</time> by <b>Carl Edquist</b><a class="anchor" name="1411687707">&nbsp;</a></div><pre>Hi Gerard,

Have you heard anything back from the FNAL email maintainers about emails sent by the VOMS servers?

Thanks,
Carl</pre></div><div class='update_description'><i onclick="document.location='22428#1410907343'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-09-16T22:42:23+00:00">Sep 16, 2014 10:42 PM UTC</time><a class="anchor" name="1410907343">&nbsp;</a></div><pre>Hi,

this should have not happened in the first place as users should have received their AUP expiration emails and renewed the AUP.

As I understand it there are 3 options to mitigate this problem in the future&#58;

1. Setup automated AUP renewal (without user interaction) . I am not sure about the policy implications of this option.
2. Don&#39;t do any change on the VOMS server setup, test the AUP emails* and rely on users renewing their AUPs. This is in my opinion not entirely conclusive because (1) VOMS does not seem to log when it send an email and (2) we don&#39;t have warranties that an email being sent properly today means it will not fail tomorrow.
3. Extend the AUP renewal period to a greater number than 365 days. This may just potentially delay the this issue and needs of solution 2 as well.  I am not sure about the policy implications of this option.

We are testing the AUP expiration emails with 2 non FNAL email addresses and 1 FNAL email address to verify all emails are properly sent&#58;

<a href='https&#58;//voms1.fnal.gov&#58;8443/voms/osg/user/load.action?userId=521' target='_blank' rel='nofollow'>https&#58;//voms1.fnal.gov&#58;8443/voms/osg/user/load.action?userId=521</a>
<a href='https&#58;//voms1.fnal.gov&#58;8443/voms/osg/user/load.action?userId=661' target='_blank' rel='nofollow'>https&#58;//voms1.fnal.gov&#58;8443/voms/osg/user/load.action?userId=661</a>
<a href='https&#58;//voms1.fnal.gov&#58;8443/voms/osg/user/load.action?userId=712' target='_blank' rel='nofollow'>https&#58;//voms1.fnal.gov&#58;8443/voms/osg/user/load.action?userId=712</a>

I am in contact with FNAL email group (maintainers of smtp.fnal.gov) to see if they can give us a list of all emails sent by the VOMS servers (INCT12242).

Gerard

by /DC=gov/DC=fnal/O=Fermilab/OU=People/CN=Gerard Bernabeu Altayo/CN=UID&#58;gerard1</pre></div><div class='update_description'><i onclick="document.location='22428#1410891251'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-09-16T18:14:11+00:00">Sep 16, 2014 06:14 PM UTC</time> by <b>Chander Sehgal</b><a class="anchor" name="1410891251">&nbsp;</a></div><pre>What will prevent this problem from happening again in the future?

Chander</pre></div><div class='update_description'><i onclick="document.location='22428#1410887460'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-09-16T17:11:00+00:00">Sep 16, 2014 05:11 PM UTC</time><a class="anchor" name="1410887460">&nbsp;</a></div><pre>At per Tanya&#39;s request administratively signing AUPs for all OSG VO users with expired AUPs, there are 40 users with expired AUPs as of today&#58;

mysql&#62; select surname,institution from usr where userid in (select usr_id from task where task_type_id=2 and status=&#34;EXPIRED&#34;);
+--------------+-----------------------------------------------+
| surname      | institution                                   |
+--------------+-----------------------------------------------+
| Cholia       | Lawrence Berkeley National Laboratory         |
| Sim          | LBNL                                          |
| Padmanabhan  | University of Illinois                        |
| Pordes       | FNAL                                          |
| Hover        | Brookhaven National Laboratory                |
| Caballero    | Brookhaven National Laboratory                |
| Shao         | Institute for Genome Sciences                 |
| Service      | Fermilab                                      |
| Zaytsev      | Brookhaven National Laboratory (BNL)          |
| Purschke     | Brookhaven National Laboratory                |
| Thapa        | Computation Institute / University of Chicago |
| Toll         | BNL                                           |
| Vaska        | BNL                                           |
| Zebrowski    | Rutgers, the State University of New Jersey   |
| Rynge        | USC / ISI                                     |
| Whiteson     | UC Irvine                                     |
| Narain       | Brown University                              |
| Sharma       | Fermilab                                      |
| Black        | Boston University                             |
| Hu           | Purdue University                             |
| Pipes        | MIS/GOC                                       |
| Hirschauer   | Fermilab                                      |
| Strologas    | University of New Mexico                      |
| Stupak       | Purdue University Calumet                     |
| Malik        | Fermilab                                      |
| Factory      | Fermilab                                      |
| Onyisi       | University of Texas at Austin                 |
| Hill         | OSG Security Team                             |
| Ito          | Brookhaven National Laboratory                |
<div id='show_900294349' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_900294349'>| Stupak  (2a) | Purdue University Calumet                     |
| Alimena      | Brown University                              |
| Mao          | Brown University                              |
| Merino       | WIPAC                                         |
| Zheng        | Brookhaven Nation Lab                         |
| Dhingra      | Fermilab                                      |
| Boyd         | Fermilab                                      |
| Mastbaum     | University of Pennsylvania                    |
| Medina       | High Performance Computing Facility - UPR     |
| osg-flock    | Information Science Institute                 |
| Sharma       | Fermilab                                      |
+--------------+-----------------------------------------------+
40 rows in set (0.00 sec)

Doing the AUP signing from the DB with&#58;

update aup_acc_record set last_acceptance_date=NOW() where usr_id IN (select usr_id from task where task_type_id=2 and status=&#34;EXPIRED&#34;);
update task set completionDate=NOW() , status=&#34;COMPLETED&#34; where task_type_id=2 and status=&#34;EXPIRED&#34;;

Done&#58;

mysql&#62; update aup_acc_record set last_acceptance_date=NOW() where usr_id IN (select usr_id from task where task_type_id=2 and status=&#34;EXPIRED&#34;);
Query OK, 40 rows affected (0.14 sec)
Rows matched&#58; 40  Changed&#58; 40  Warnings&#58; 0

mysql&#62; update task set completionDate=NOW() , status=&#34;COMPLETED&#34; where task_type_id=2 and status=&#34;EXPIRED&#34;;
Query OK, 40 rows affected (0.03 sec)
Rows matched&#58; 40  Changed&#58; 40  Warnings&#58; 0

mysql&#62;

Gerard

by /DC=gov/DC=fnal/O=Fermilab/OU=People/CN=Gerard Bernabeu Altayo/CN=UID&#58;gerard1
</div><script type='text/javascript'>
        $('#show_900294349').click(function() {
            $('#detail_900294349').slideDown("normal");
            $('#show_900294349').hide();
            $('#hide_900294349').show();
        });
        $('#hide_900294349').click(function() {
            $('#detail_900294349').slideUp();
            $('#hide_900294349').hide();
            $('#show_900294349').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='22428#1410887302'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-09-16T17:08:22+00:00">Sep 16, 2014 05:08 PM UTC</time> by <b>Tanya Levshina</b><a class="anchor" name="1410887302">&nbsp;</a></div><pre>I see the following problems with voms 2.7&#58;

1. If a user missed email there is no way to re-sign aup using web ui neither by user nor by VO admin for user
2. A user with expired AUP is still can get voms-proxy  - don&#39;t know if it is good or bad

Tanya

On Sep 16, 2014, at 11&#58;59 AM, Open Science Grid FootPrints wrote&#58;

[Duplicate message snipped]</pre></div><div class='update_description'><i onclick="document.location='22428#1410886754'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-09-16T16:59:14+00:00">Sep 16, 2014 04:59 PM UTC</time> by <b>Tanya Levshina</b><a class="anchor" name="1410886754">&nbsp;</a></div><pre>Let me try again&#58;

It works ONLY if you click on the link of the email that nobody received. There is no way to do it via WEB UI if you don&#39;t get an email neither for a user not by vomsadmin.

I think i have figure out what modifications are needed to update database directly - we are testing it now
Thanks,
Tanya

On Sep 16, 2014, at 11&#58;47 AM, Open Science Grid FootPrints wrote&#58;

[Duplicate message snipped]</pre></div><div class='update_description'><i onclick="document.location='22428#1410886075'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-09-16T16:47:55+00:00">Sep 16, 2014 04:47 PM UTC</time> by <b>Tim Cartwright</b><a class="anchor" name="1410886075">&nbsp;</a></div><pre>So, the website says, “use the email to re-sign the AUP”, and Gerard claims that that option works, right?</pre></div><div class='update_description'><i onclick="document.location='22428#1410885920'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-09-16T16:45:20+00:00">Sep 16, 2014 04:45 PM UTC</time><a class="anchor" name="1410885920">&nbsp;</a></div><pre>Hi Tim,

this users are suspended because of not resigning the AUP; current setup is that AUP needs to be signed yearly.

If this is not the desired policy OSG VO admins can change it from <a href='https&#58;//voms2.fnal.gov&#58;8443/voms/osg/aup/load.action' target='_blank' rel='nofollow'>https&#58;//voms2.fnal.gov&#58;8443/voms/osg/aup/load.action</a>

Gerard

by /DC=gov/DC=fnal/O=Fermilab/OU=People/CN=Gerard Bernabeu Altayo/CN=UID&#58;gerard1</pre></div><div class='update_description'><i onclick="document.location='22428#1410885851'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-09-16T16:44:11+00:00">Sep 16, 2014 04:44 PM UTC</time> by <b>Tanya Levshina</b><a class="anchor" name="1410885851">&nbsp;</a></div><pre>The user are suspended because they didn&#39;t re-sign AUP. In 2.7.0 there is no way how to re-sign AUP from WEB UI  after it expires. So far we can not find how to do it by accessing database directly (before it was possible).

I don&#39;t know why user didn&#39;t get emails - I assume Gerard is looking into that as well.
Tanya
On Sep 16, 2014, at 11&#58;30 AM, Open Science Grid FootPrints wrote&#58;

[Duplicate message snipped]</pre></div><div class='update_description'><i onclick="document.location='22428#1410885016'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-09-16T16:30:16+00:00">Sep 16, 2014 04:30 PM UTC</time> by <b>Tim Cartwright</b><a class="anchor" name="1410885016">&nbsp;</a></div><pre>Gerard&#58; Are the suspended users suspended because of not signing the AUP or because they have expired?</pre></div><div class='update_description'><i onclick="document.location='22428#1410882236'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-09-16T15:43:56+00:00">Sep 16, 2014 03:43 PM UTC</time><a class="anchor" name="1410882236">&nbsp;</a></div><pre>Should the OSG VO upgrade to a newer version of VOMS?

Does the software team have a schedule for releasing VOMS 3.x for use in OSG?

Chander

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=Chander Sehgal 478</pre></div><div class='update_description'><i onclick="document.location='22428#1410819607'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-09-15T22:20:07+00:00">Sep 15, 2014 10:20 PM UTC</time><a class="anchor" name="1410819607">&nbsp;</a></div><pre>As requested by Tanya I&#39;m updating the AUP for all the OSG VO members&#58;

mysql&#62; update aup_acc_record set last_acceptance_date=current_date() where usr_id IN (select userid from usr where DN like &#39;%&#39;);
Query OK, 78 rows affected (0.05 sec)
Rows matched&#58; 78  Changed&#58; 78  Warnings&#58; 0

mysql&#62;

This used to work in the past, but it does not work... Tanya is still suspended. Please try the AUP sign link.

Gerard

by /DC=gov/DC=fnal/O=Fermilab/OU=People/CN=Gerard Bernabeu Altayo/CN=UID&#58;gerard1</pre></div><div class='update_description'><i onclick="document.location='22428#1410818925'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-09-15T22:08:45+00:00">Sep 15, 2014 10:08 PM UTC</time><a class="anchor" name="1410818925">&nbsp;</a></div><pre>There may be some sort of bug in VOMS-admin that does not show the button to resign the AUP, I&#39;ll look into this further.

I just tested and got an email from voms-admin and by following the provided link I could resign my AUP&#58;

-----------------------------------------
Dear gerard1@....,

you are requested to sign the VO osg AUP
in order to continue to be part of the  osg VO.

To sign the AUP, point your browser to the following
URL&#58;

<a href='https&#58;//voms1.fnal.gov&#58;8443/voms/osg/aup/sign' target='_blank' rel='nofollow'>https&#58;//voms1.fnal.gov&#58;8443/voms/osg/aup/sign</a>!input.action?aupId=2

Be sure that a trusted and valid certificate linked
to your VO membership in installed in the browser
that you use to access the sign aup web page,
or VOMS Admin will not be able to authenticate you
properly.

Please sign the AUP before the following date&#58;

Tue Sep 30 17&#58;00&#58;13 CDT 2014

After this date your membership will be suspended
and you will not be able to obtain VOMS credentials
for the osg VO. Note however that you can restore
your membership at any time by simply signing again
the AUP following the URL given above.

Your sincerely,
Voms-Admin registration service for VO osg

-----------------------------------------
<div id='show_903188575' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_903188575'>
When I tested this I&#39;m sure I followed the email link instead of trying to sign from the GUI, I&#39;ll do a couple more tests but I&#39;ll probably have to open a bug/feature request on OSG/voms SW support about this...

Gerard

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=Gerard Bernabeu Altayo 949
</div><script type='text/javascript'>
        $('#show_903188575').click(function() {
            $('#detail_903188575').slideDown("normal");
            $('#show_903188575').hide();
            $('#hide_903188575').show();
        });
        $('#hide_903188575').click(function() {
            $('#detail_903188575').slideUp();
            $('#hide_903188575').hide();
            $('#show_903188575').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='22428#1410817342'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-09-15T21:42:22+00:00">Sep 15, 2014 09:42 PM UTC</time><a class="anchor" name="1410817342">&nbsp;</a></div><pre>Can you provide the list of users that need to have toe AUP resigned?

Do you want the re-sign AUP process to be fully automated for all the users in the VO (can put a cron that does it on the DB so that this step is no longer necessary).

Gerard

by /DC=gov/DC=fnal/O=Fermilab/OU=People/CN=Gerard Bernabeu Altayo/CN=UID&#58;gerard1</pre></div><div class='update_description'><i onclick="document.location='22428#1410816228'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-09-15T21:23:48+00:00">Sep 15, 2014 09:23 PM UTC</time> by <b>Tanya Levshina</b><a class="anchor" name="1410816228">&nbsp;</a></div><pre>Gerard,

The most important part is not an email. We can not re-sign AUP now so the exp date needs to be modified directly in voms database.
Thanks,
Tanya</pre></div><div class='update_description'><i onclick="document.location='22428#1410806447'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-09-15T18:40:47+00:00">Sep 15, 2014 06:40 PM UTC</time><a class="anchor" name="1410806447">&nbsp;</a></div><pre>OSG VOMS VO at fermilab is running on voms-admin-server-2.7.0-1.12.osg31.el6.noarch and according to our testing it is and it has been sending emails (this was recently tested after an ugrade). Emails are sent 15 days prior to AUP expiration and even after expiration let the user login and sign the AUP.

There&#39;s also an email sent once the AUP expires (which is not perfect, I&#39;m working on testing it this days&#58; <a href='https&#58;//ticket.grid.iu.edu/22379' target='_blank' rel='nofollow'>https&#58;//ticket.grid.iu.edu/22379</a>).

I&#39;m looking through the logs to see if voms-admin logs anywhere whenever this emails are sent...

Gerard

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=Gerard Bernabeu Altayo 949</pre></div><div class='update_description'><i onclick="document.location='22428#1410805206'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-09-15T18:20:06+00:00">Sep 15, 2014 06:20 PM UTC</time> by <b>Tanya Levshina</b><a class="anchor" name="1410805206">&nbsp;</a></div><pre>Hi,
yes - it should be redirected to Fermi.
Thanks,
Tanya</pre></div><div class='update_description'><i onclick="document.location='22428#1410804412'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-09-15T18:06:52+00:00">Sep 15, 2014 06:06 PM UTC</time> by <b>Scott Teige</b><a class="anchor" name="1410804412">&nbsp;</a></div><pre>GOC VOMS is 2.6.1, slave to FNAL. Removing Soichi, adding FNAL via ticket exchange. I will continue to watch.</pre></div><div class='update_description'><i onclick="document.location='22428#1410804075'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-09-15T18:01:15+00:00">Sep 15, 2014 06:01 PM UTC</time> by <b>Tanya Levshina</b><a class="anchor" name="1410804075">&nbsp;</a></div><pre>added a screen shot</pre></div><div class='update_description'><i onclick="document.location='22428#1410804045'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-09-15T18:00:45+00:00">Sep 15, 2014 06:00 PM UTC</time> by <b>Tanya Levshina</b><a class="anchor" name="1410804045">&nbsp;</a></div><pre>Hi,

OSG VO has multiple users that have failed to re-sign AUP. It looks like VOMS 2.7.0 doesn&#39;t send a warning email (no notification) and doesn&#39;t allow user to re-sign AUP.

Could this be fixed in VOMS database directly ASAP?
Thanks,
Tanya</pre></div><legend>Similar Recent Tickets <small>modified within the last 30 days</small></legend><div id="similar_tickets"><p class="muted">No similar tickets found.</p></div>
</div>
<script type="text/javascript">
function reset_anchor() {
    $("#updates .selected").removeClass("selected");
    var urls = document.location.toString().split('#'); 
    var anchor = urls[1];
    if(anchor) {
        $("a[name='"+anchor+"']").parents(".update_description").addClass("selected");
    }
}
function submitspam(ticket_id) {
    myret = confirm("Would you like to close this ticket as a security ticket, and submit the ticket content to akismet?");
    if(myret == true) {
        $.ajax("viewer/processspam?id="+ticket_id).done(function() {
            window.location.reload();
        });
    }
}

$(function() {
    reset_anchor();
    var ADDITIONAL_COOKIE_NAME = 'gocticket';
    var options = { path: '/', expires: 365};

    if(window.opener && window.opener.name == "gocticket_list") {
        v = $.cookie("closewindow");
        if(!v) {
            $("#closewindow").attr("checked", "checked"); //on by default
        } else {
            if(v == "checked") {
                $("#closewindow").attr("checked", "checked");
            }
        }
        $("#closewindow").click(function() {
            $.cookie("closewindow", $(this).attr('checked'), options);
        });
    } else {
        $("#closewindow_area").hide();
    }
    function updateTimeago() {
        $("time").timeago();
        setTimeout(updateTimeago, 30*1000);
    }
    updateTimeago();
    $(".description").focus(expand_description);
});
</script>
<hr/>
<footer>
<p>GOC Ticket Version 2.2 | <a href="https://ticket.opensciencegrid.org/goc/submit?app_issue_check=on&amp;app_issue_type=goc&amp;app_goc_url=https%3A%2F%2Fticket.opensciencegrid.org%3A443%2F22428">Report Bugs</a>
 | <a href="https://github.com/opensciencegrid/operations/blob/master/docs/privacy.md">Privacy Policy</a>
</p>

<p> <img align="top" src="images/tag_orange.png"/> Copyright 2018 The Trustees of Indiana University - Developed for Open Science Grid</p>
</footer>


</div><!--container-fluid-->
<script src="https://ticket1.grid.iu.edu:8443/socket.io/socket.io.js"></script>
<script>
var chat = io.connect('https://ticket1.grid.iu.edu:8443');
chat.on('connect', function() {
    chat.emit('authenticate', {nodekey:'', ticketid: 22428});
});
chat.on('peers', function(peers) {
    $("#peers").html("");
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('peer_disconnect', function(pid) {
    $("#peer_"+pid).hide("slow");
});
chat.on('peer_connected', function(peers) {
    //expect only 1 peer connecting, but..
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('submit', function() {
    if(confirm("This ticket was updated. Do you want to refresh?")) {
        history.go(0);
    }
});

function addPeer(pid, peer) {
    var ipinfo = "";
    if(peer.ip != undefined) {
        ipinfo = "<span class=\"ip\">"+peer.ip+"</span>";
    }
    if(chat.io.engine.id == pid) {
        //don't display myself
        return;
    }
    var html = "<li class=\"new\" id=\"peer_"+pid+"\" class=\"peer\">"+peer.name+ipinfo+"</li>";
    $("#peers").prepend(html);
    $("#peers .new").animate({bottom: 0}, 1000, function() {$(this).removeClass("new")});
}

$(function() {
    $("#ticket_form").submit(function() {
        chat.emit('submit');
        return true;
    });
});
</script>
<script>
//used by searchbox
function parseValue(value) {
    var obj = new Object();
    var tokens = value.split("\t");
    obj.str = tokens[0];
    obj.count = tokens[1];
    return obj;
}

$(function() {
    //bootstrap-2.0.4 stuff
    $(".alert-message").alert();
    $(".dropdown-toggle").dropdown();
    $("span[rel='tooltip']").tooltip();
    $("a[rel=popover]").popover();

    //activate menu that user is currently on
    $("#menu_navigator").addClass("active"); 
    $("#submenu_").addClass("active"); 

    //translate zend validation error message to bootstrap
    $(".errors").addClass("alert").addClass("alert-error");

    //enable autocomplete for search box
    $("#search").autocomplete({
        source: function( request, response ) {
            $.ajax({
                url: "search/autocomplete",
                dataType: "text",
                data: {
                    //featureClass: "P",
                    //style: "full",
                    //maxRows: 12,
                    //name_startsWith: request.term
                    q: request.term
                },
                success: function( data ) {
                    response( $.map( data.split("\n"), function( item ) {
                        if(item == "") return null;
                        return {
                            value: item
                        }
                    }));
                }
            });
        },
        select: function(event, ui) {
            document.location = "search?q="+ui.item.value;
        }
    });
    
});
</script>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-69012-13");
pageTracker._trackPageview();
} catch(err) {}
</script>

</body>
