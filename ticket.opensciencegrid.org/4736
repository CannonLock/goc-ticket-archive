<!DOCTYPE html>
<html lang="en">
  <head>
  <base href="">
    <title>[4736] Nanohub jobs on Condor</title>    <meta charset="utf-8" />
    <meta name="verify-v1" content="na5IcAJsZVOfEkboRxuIiZ1zpZgnZiWra+nKcS7nA/o=" />
    <meta name="google-site-verification" content="DLrk3ft4s8b-S2TloLCL2LD_t6wcTjgSluf5pmiu2kA" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />
    <link href="https://ticket.opensciencegrid.org/rss" rel="alternate" type="application/rss+xml" title="GOC Ticket Update feed" />

    <style type="text/css">
      body {
        padding-top: 50px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
     #search {
            width: 300px;
     }

    </style>

<script src="https://code.jquery.com/jquery-3.0.0.js"></script>
<script src="https://code.jquery.com/jquery-migrate-3.0.1.js"></script>

   <link href="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet"/>
    <script src="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/js/bootstrap.min.js"></script>

    <link href="https://netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"/>
    <link href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/themes/smoothness/jquery-ui.min.css" rel="stylesheet"/>
 <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>


    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/js/select2.min.js"></script>

    <link href="css/ticket.css" rel="stylesheet" />
    <script src="lib/jquery.cookie.js"></script>

    <link href="images/tag_orange.png" rel="icon" type="image/png"/>
    <script src='https://www.google.com/recaptcha/api.js'></script>
  </head>

  <body>
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>

            <a class="brand" style="padding: 6px 0px 0px 6px;" href="http://opensciencegrid.org"><img src="images/osglogo.40x30.png"/></a>
            <ul class="nav">
                <li class="dropdown"><a href="https://ticket.opensciencegrid.org/#" class="dropdown-toggle" data-toggle="dropdown">GOC Ticket <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    <li><a href="https://my.opensciencegrid.org">MyOSG</a></li>
                    <li><a href="https://oim.opensciencegrid.org">OIM</a></li>
                    <li class="active"><a href="https://ticket.opensciencegrid.org/index">Ticket</a></li>
	<li class="divider"></li>
	<li><a href="http://repo.grid.iu.edu">Repo</a></li>
	<li class="divider"></li>
	<li><a href="http://blogs.grid.iu.edu">Blog</a></li>
                    <li><a href="http://display.grid.iu.edu">Display</a></li>
                    <li><a href="http://osggoc.blogspot.com/">News</a></li>
                    </ul>
                </li>
            </ul>
            <ul class="nav pull-right">
                <li><a href="https://ticket.opensciencegrid.org/sso/">Login</a></li>            </ul>

            <div class="nav-collapse">
                <ul class="nav">
			 <li id="menu_submit"><a href="https://ticket.opensciencegrid.org/submit">Submit</a></li><li id="menu_view" class="dropdown"><a href="https://ticket.opensciencegrid.org/\#" class="dropdown-toggle" data-toggle="dropdown">View <b class="caret"></b></a><ul class="dropdown-menu"><li id="submenu_listopen"><a href="https://ticket.opensciencegrid.org/list/open">Open Tickets</a></li><li id="submenu_listrecentclose"><a href="https://ticket.opensciencegrid.org/list/recentclose">Recently Closed Tickets</a></li><li class="divider"></li><li id="submenu_alltickets"><a href="https://ticket.opensciencegrid.org/search?q=&amp;sort=id">All Tickets</a></li></ul></li>                </ul>

                <form class="navbar-search pull-right" action="https://ticket.opensciencegrid.org/viewer">
                    <input id="search" type="text" name="id" class="search-query span2" placeholder="Search Ticket" value=""/>
                </form>
            </div>
        </div>
      </div>
    </div>

<script type='text/javascript' src='lib/jquery.timeago.js'></script>
<script type='text/javascript' src='lib/byte2size.js'></script>
<style>
#updates .toolbar {
position: relative;
margin-top: 0px;
top: -10px;
font-weight: normal;
}
#updates a.anchor {
position: relative;
top: -50px;
}
#updates .selected pre {
animation:selected 2s;
animation-iteration-count: 2;
animation-direction: alternate;
-webkit-animation:selected 2s; 
-webkit-animation-iteration-count: 2;
-webkit-animation-direction: alternate;
box-shadow: inset 1px 1px 20px #9ad;
border: 1px solid #9ab;
margin: 5px 0px;
padding-left: 10px;
}
@keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ab;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
@-webkit-keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ad;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
#updates pre {
background-color: inherit;
line-height: 15px;
padding: 5px;
}
#updates .header {
color: #999;
}
#updates .update_history pre {
background-color: #eee;
color: #666;
font-size: 85%;
}
#updates .clickable {
cursor: pointer;
}
#updates .clickable:hover {
color: #D98719;
}
#updates .meta_information pre {
background-color: #fed;
}
#similar_tickets {
max-height: 300px;
overflow-y: auto;
pointer-events: none;
padding: 5px;
background-color: #f4f4f4;
}
.btn-toolbar {
margin-bottom: 0;
height: 30px;
}
#peers {
position: fixed;
bottom: 0px;
right: 0px;
z-index: 100;
list-style: none;
padding: 5px 0px 0px 5px;
margin: 0px;
background-color: white;
box-shadow: 0px 0px 10px white;
}
#peers li {
background-color: #ccc;
color: #000;
display: inline-block;
padding: 5px 10px;
margin-right: 5px;
position: relative;
}
/*
#peers li:hover {
background-color: #999;
cursor: pointer;
}
*/
#peers span.ip {
padding-left: 5px;
color: #666;
}
#peers .new {
bottom: -30px;
}
/*
#peers .me {
background-color: red;
}
*/
</style>

<div class="container-fluid">
<ul id="peers"></ul>
<div class="alert alert-danger"><a class="close" href="https://ticket.opensciencegrid.org/#" data-dismiss="alert">&times;</a>By the end of May 2018, the ticketing system at https://ticket.opensciencegrid.org will be retired and support will be provided at https://support.opensciencegrid.org. Throughout this transition the support email (help@opensciencegrid.org) will be available as a point of contact.<br><br>                                                   
                                                                                                                                                                                   
Please see the service migration page for details: https://opensciencegrid.github.io/technology/policy/service-migrations-spring-2018/#ticket</div><div id="presence" class="pull-right"></div><div class="ticketgui"><script type="text/javascript" src="lib/checktab.js"></script>

<script>
var expanded = false;
function expand_description() {
    var desc = $(".description");
    if(!expanded) {
        expanded = true;
        //expand to minheight
        var min = 250;
        if(desc.height() < min) {
            desc.animate({height: min}, 200);
        }
    }
}

$(document).ready(function() {
    $("input[name='nad']").datepicker({
        dateFormat: 'yy-mm-dd'
    });
});

</script>



<style>
.form-horizontal .control-label {
padding-top: inherit;
font-size:90%;
color:#666;
}
label {
margin-bottom: 0px;
}
.controls {
line-height: 18px;
}
</style>
<form class="form-horizontal" action="https://ticket.opensciencegrid.org/viewer/updatebasic?id=4736" method="post">
<div class="page-header">
    <h3><span class="muted">4736</span> / Nanohub jobs on Condor</h3>
</div>

<div class="row-fluid">
<div class="span5">
    <legend>Contact</legend>
    <div class="control-group">
        <label class="control-label">Full Name</label>
        <div class="controls">Brian Moe</div>
    </div>
    <div class="control-group">
        <label class="control-label">Email</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">Phone</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">CC</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>

    <legend>Details</legend>
    
    <div class="control-group">
        <label class="control-label">Ticket Type</label>
        <div class="controls">Problem/Request</div>
    </div>
    <div class="control-group">
        <label class="control-label">Priority</label>
        <div class="controls">Normal</div>
    </div>
    <div class="control-group">
        <label class="control-label">Status</label>
        <div class="controls">
Closed</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action</label>
        <div class="controls"></div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action Deadline</label>
        <div class="controls flag_red">1970-01-01</div>
    </div>

</div><!--span-->
<div class="span7">
    <legend>Assignees</legend>
    <div class="assignee" style="width: 60%">nanoHUB <span class="muted"> / OSG Support Centers</span></div>    <br>

    <legend>Assignees</legend>
    TODO
    <br>

    <style>
legend.noborder {
border-bottom: none;
}
</style>

<div id="attachment-list"/>
<script>
$(function () {
    var first = true;
    $.getJSON("https://ticket.opensciencegrid.org/attachment/list?id=4736", function (files) {
        //console.dir(files);
        var html = "<table class=\"table table-condensed\">";
        $(files).each(function() {
            if(first) {
                first = false;
                html += "<legend class=\"noborder\">Attachmenets</legend>";
            }
            html += "<tr class=\"attachment\">";
            html += "<td><img src="https://ticket.opensciencegrid.org/\&quot;&quot;+this.thumbnail_url+&quot;\&quot;/"></td>";
            html += "<td><a href="https://ticket.opensciencegrid.org/\&quot;&quot;+this.url+&quot;\&quot;" target=\"_blank\">"+this.name+"</a></td>";
            html += "<td>"+bytesToSize(this.size, 1)+"</td>";
            html += "</tr>";
        });
        html += "</table>";
        $("#attachment-list").html(html);
    });
});

function download(url) {
    window.open(url, "_blank");
}
</script>


</div><!--span-->
</div><!--row-fluid-->


</form>

</div>
<div id="updates" style="clear: both;">
    <legend>Past Updates
    <div class="btn-toolbar pull-right toolbar">
        <div class="btn-group">
                <a class="btn btn-small" href="https://ticket.opensciencegrid.org/4736?sort=up&amp;"><i class="icon-arrow-up"></i> Sort</a>

        
        <a class="btn btn-small" href="https://ticket.opensciencegrid.org/4736?expandall=true&amp;">Expand Descriptions</a>        <a class="btn btn-small" target="_blank" href="mailto:osg@tick.globalnoc.iu.edu?subject=Open%20Science%20Grid%3A%20Nanohub%20jobs%20on%20Condor%20ISSUE%3D4736%20PROJ%3D71"><i class="icon-envelope"></i> Update w/Email</a>
        </div>
    </div><!--btn-toolbar-->
    </legend>

    <div class='update_description'><i onclick="document.location='4736#1210723088'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2008-05-13T23:58:08+00:00">May 13, 2008 11:58 PM UTC</time> by <b>Brian Moe</b><a class="anchor" name="1210723088">&nbsp;</a></div><pre>Hi Steven,

This is regrettable.

There is some problem with our Condor configuration that I have not been able
to fix myself.  Given that this cluster is to be retired this summer, there is
little incentive for anyone else here to put any time into fixing it.

Would there be any Condor help available through the GOC or should we
just leave it given that this cluster is being replaced soon anyway?

Brian

On Mon, May 12, 2008 at 11&#58;22&#58;00PM +0000, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='4736#1210721776'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2008-05-13T23:36:16+00:00">May 13, 2008 11:36 PM UTC</time> by <b>echism</b><a class="anchor" name="1210721776">&nbsp;</a></div><pre>Thanks for the update, Steven. I&#39;ll close this, then. Reply to this ticket or send an
email to the GOC if anything further comes up.

Thank you,
Elizabeth</pre></div><div class='update_description'><i onclick="document.location='4736#1210634529'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2008-05-12T23:22:09+00:00">May 12, 2008 11:22 PM UTC</time> by <b>Steven Clark</b><a class="anchor" name="1210634529">&nbsp;</a></div><pre>Due to the recurring problems with the UWM site nanoHUB has suspended job
submission to that site.
--
Steven Clark
Application Engineer for Scientific Computing

Quoting Open Science Grid FootPrints &#60;osg@....&#62;&#58;

<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='4736#1210374182'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2008-05-09T23:03:02+00:00">May 9, 2008 11:03 PM UTC</time> by <b>echism</b><a class="anchor" name="1210374182">&nbsp;</a></div><pre>This ticket has been vacant for about two months. Do you wish to keep this issue
open, or is it safe to assume it has resolved itself?</pre></div><div class='update_description'><i onclick="document.location='4736#1205257569'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2008-03-11T17:46:09+00:00">Mar 11, 2008 05:46 PM UTC</time> by <b>Steven Clark</b><a class="anchor" name="1205257569">&nbsp;</a></div><pre>I was looking for a directory under /opt/osg-temp/nanohub/runjob where the
jobs were launched. Each job is assigned a unique directory. If things go well
the directory is removed upon job completion, if not the directory and files
may hang around depending on the cleanup actions taken by your site. The
location of stdout and stderr is controlled by globus. There may be other
files in the same directory that indicate what runjob directory was used.

--
Steven Clark
Application Engineer for Scientific Computing

Quoting Open Science Grid FootPrints &#60;osg@....&#62;&#58;

<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='4736#1205251271'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2008-03-11T16:01:11+00:00">Mar 11, 2008 04:01 PM UTC</time> by <b>Brian Moe</b><a class="anchor" name="1205251271">&nbsp;</a></div><pre>Hi Steven,

Sorry... answered your 2nd question, but missed your first.. is this what
you&#39;re looking for?

13263.user.log&#58;Out = &#34;/opt/osg/home/nanohub/.globus/job/nest.phys.uwm.edu/21463.1204192093/stdout&#34;
19854.user.log&#58;Out = &#34;/opt/osg/home/nanohub/.globus/job/nest.phys.uwm.edu/962.1205062210/stdout&#34;

and I&#39;m sorry to say I don&#39;t have anything for 13270.

Brian

On Tue, Mar 11, 2008 at 02&#58;58&#58;00PM +0000, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='4736#1205250548'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2008-03-11T15:49:08+00:00">Mar 11, 2008 03:49 PM UTC</time> by <b>Brian Moe</b><a class="anchor" name="1205250548">&nbsp;</a></div><pre>Hi Steven,

Yes, it would be safe to say that this problem is similar to what happened
a few weeks ago.

Brian

On Tue, Mar 11, 2008 at 02&#58;58&#58;00PM +0000, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='4736#1205247489'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2008-03-11T14:58:09+00:00">Mar 11, 2008 02:58 PM UTC</time> by <b>Steven Clark</b><a class="anchor" name="1205247489">&nbsp;</a></div><pre>Sorry for the confusion but I received the ticketing email out of order. I
received the GOC response before the the initial ticket report. You earlier
reported the condor job ids and wondered if they were of any use.
Unfortunately they are not of use to me because local job id information is
not reported by condorG. What would be of use is to report the working
directory for the job. Each job has a unique directory that can be traced back
to a nanoHUB job.

Would it be safe to assume that yesterdays problem is similar to what happened
a few weeks ago?

--
Steven Clark
Application Engineer for Scientific Computing

Quoting Open Science Grid FootPrints &#60;osg@....&#62;&#58;

<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='4736#1205245329'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2008-03-11T14:22:09+00:00">Mar 11, 2008 02:22 PM UTC</time> by <b>Brian Moe</b><a class="anchor" name="1205245329">&nbsp;</a></div><pre>Hi Steven,

The site is UWMilwaukee (nest.phys.uwm.edu) and the timeframe is yesterday
(when the ticket was opened).

Elizabeth asked earlier, but I suppose there&#39;s no harm repeating that the user&#39;s DN was&#58;
&#34;/CN=Invigo Service04/OU=Purdue TeraGrid/O=Purdue University/ST=Indiana/C=US&#34;

Brian

On Tue, Mar 11, 2008 at 12&#58;25&#58;00AM +0000, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='4736#1205244612'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2008-03-11T14:10:12+00:00">Mar 11, 2008 02:10 PM UTC</time> by <b>Brian Moe</b><a class="anchor" name="1205244612">&nbsp;</a></div><pre>Hi Elizabeth,

The associated DN is&#58;
&#34;/CN=Invigo Service04/OU=Purdue TeraGrid/O=Purdue University/ST=Indiana/C=US&#34;

By the way, it&#39;s not the jobs that are bad, it was some hardware
gone bad which put Condor into a state I don&#39;t know how to fix
without killing the job.  (I&#39;m working on finding a better way.)

Thanks,

Brian

On Tue, Mar 11, 2008 at 12&#58;05&#58;00AM +0000, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='4736#1205195108'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2008-03-11T00:25:08+00:00">Mar 11, 2008 12:25 AM UTC</time> by <b>Steven Clark</b><a class="anchor" name="1205195108">&nbsp;</a></div><pre>What site and time frame are we dealing with here?
--
Steven Clark
Application Engineer for Scientific Computing

Quoting Open Science Grid FootPrints &#60;osg@....&#62;&#58;

<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='4736#1205193907'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2008-03-11T00:05:07+00:00">Mar 11, 2008 12:05 AM UTC</time> by <b>echism</b><a class="anchor" name="1205193907">&nbsp;</a></div><pre>Brian,

Could you let us know what user is sending the bad jobs?

Thank you,
Elizabeth</pre></div><div class='update_description'><i onclick="document.location='4736#1205188088'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2008-03-10T22:28:08+00:00">Mar 10, 2008 10:28 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1205188088">&nbsp;</a></div><pre>Queues = Grid

Submitter Name&#58; Brian Moe

Application System&#58; bmoe@....

Your Resource/Service Name&#58;
UWMilwaukee

Your VO Support Center&#58;
LIGO

Your Phone Number&#58;
414-229-3656

Description of Problem&#58;
Killed 3 nanohub jobs due to a misbehaving Condor.

Don&#39;t know if this has any meaning to the user, but the cluster id&#39;s of the jobs were&#58; 13263, 13270 and 19854.

Not sure if this warrents a trouble ticket, but it seems like killing jobs should be accounted for somehow, no?</pre></div><legend>Similar Recent Tickets <small>modified within the last 30 days</small></legend><div id="similar_tickets"><p class="muted">No similar tickets found.</p></div>
</div>
<script type="text/javascript">
function reset_anchor() {
    $("#updates .selected").removeClass("selected");
    var urls = document.location.toString().split('#'); 
    var anchor = urls[1];
    if(anchor) {
        $("a[name='"+anchor+"']").parents(".update_description").addClass("selected");
    }
}
function submitspam(ticket_id) {
    myret = confirm("Would you like to close this ticket as a security ticket, and submit the ticket content to akismet?");
    if(myret == true) {
        $.ajax("viewer/processspam?id="+ticket_id).done(function() {
            window.location.reload();
        });
    }
}

$(function() {
    reset_anchor();
    var ADDITIONAL_COOKIE_NAME = 'gocticket';
    var options = { path: '/', expires: 365};

    if(window.opener && window.opener.name == "gocticket_list") {
        v = $.cookie("closewindow");
        if(!v) {
            $("#closewindow").attr("checked", "checked"); //on by default
        } else {
            if(v == "checked") {
                $("#closewindow").attr("checked", "checked");
            }
        }
        $("#closewindow").click(function() {
            $.cookie("closewindow", $(this).attr('checked'), options);
        });
    } else {
        $("#closewindow_area").hide();
    }
    function updateTimeago() {
        $("time").timeago();
        setTimeout(updateTimeago, 30*1000);
    }
    updateTimeago();
    $(".description").focus(expand_description);
});
</script>
<hr/>
<footer>
<p>GOC Ticket Version 2.2 | <a href="https://ticket.opensciencegrid.org/goc/submit?app_issue_check=on&amp;app_issue_type=goc&amp;app_goc_url=https%3A%2F%2Fticket.opensciencegrid.org%3A443%2F4736">Report Bugs</a>
 | <a href="https://github.com/opensciencegrid/operations/blob/master/docs/privacy.md">Privacy Policy</a>
</p>

<p> <img align="top" src="images/tag_orange.png"/> Copyright 2018 The Trustees of Indiana University - Developed for Open Science Grid</p>
</footer>


</div><!--container-fluid-->
<script src="https://ticket1.grid.iu.edu:8443/socket.io/socket.io.js"></script>
<script>
var chat = io.connect('https://ticket1.grid.iu.edu:8443');
chat.on('connect', function() {
    chat.emit('authenticate', {nodekey:'', ticketid: 4736});
});
chat.on('peers', function(peers) {
    $("#peers").html("");
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('peer_disconnect', function(pid) {
    $("#peer_"+pid).hide("slow");
});
chat.on('peer_connected', function(peers) {
    //expect only 1 peer connecting, but..
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('submit', function() {
    if(confirm("This ticket was updated. Do you want to refresh?")) {
        history.go(0);
    }
});

function addPeer(pid, peer) {
    var ipinfo = "";
    if(peer.ip != undefined) {
        ipinfo = "<span class=\"ip\">"+peer.ip+"</span>";
    }
    if(chat.io.engine.id == pid) {
        //don't display myself
        return;
    }
    var html = "<li class=\"new\" id=\"peer_"+pid+"\" class=\"peer\">"+peer.name+ipinfo+"</li>";
    $("#peers").prepend(html);
    $("#peers .new").animate({bottom: 0}, 1000, function() {$(this).removeClass("new")});
}

$(function() {
    $("#ticket_form").submit(function() {
        chat.emit('submit');
        return true;
    });
});
</script>
<script>
//used by searchbox
function parseValue(value) {
    var obj = new Object();
    var tokens = value.split("\t");
    obj.str = tokens[0];
    obj.count = tokens[1];
    return obj;
}

$(function() {
    //bootstrap-2.0.4 stuff
    $(".alert-message").alert();
    $(".dropdown-toggle").dropdown();
    $("span[rel='tooltip']").tooltip();
    $("a[rel=popover]").popover();

    //activate menu that user is currently on
    $("#menu_navigator").addClass("active"); 
    $("#submenu_").addClass("active"); 

    //translate zend validation error message to bootstrap
    $(".errors").addClass("alert").addClass("alert-error");

    //enable autocomplete for search box
    $("#search").autocomplete({
        source: function( request, response ) {
            $.ajax({
                url: "search/autocomplete",
                dataType: "text",
                data: {
                    //featureClass: "P",
                    //style: "full",
                    //maxRows: 12,
                    //name_startsWith: request.term
                    q: request.term
                },
                success: function( data ) {
                    response( $.map( data.split("\n"), function( item ) {
                        if(item == "") return null;
                        return {
                            value: item
                        }
                    }));
                }
            });
        },
        select: function(event, ui) {
            document.location = "search?q="+ui.item.value;
        }
    });
    
});
</script>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-69012-13");
pageTracker._trackPageview();
} catch(err) {}
</script>

</body>
