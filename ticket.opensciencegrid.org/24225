<!DOCTYPE html>
<html lang="en">
  <head>
  <base href="">
    <title>[24225] glexec failures</title>    <meta charset="utf-8" />
    <meta name="verify-v1" content="na5IcAJsZVOfEkboRxuIiZ1zpZgnZiWra+nKcS7nA/o=" />
    <meta name="google-site-verification" content="DLrk3ft4s8b-S2TloLCL2LD_t6wcTjgSluf5pmiu2kA" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />
    <link href="https://ticket.opensciencegrid.org/rss" rel="alternate" type="application/rss+xml" title="GOC Ticket Update feed" />

    <style type="text/css">
      body {
        padding-top: 50px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
     #search {
            width: 300px;
     }

    </style>

<script src="https://code.jquery.com/jquery-3.0.0.js"></script>
<script src="https://code.jquery.com/jquery-migrate-3.0.1.js"></script>

   <link href="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet"/>
    <script src="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/js/bootstrap.min.js"></script>

    <link href="https://netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"/>
    <link href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/themes/smoothness/jquery-ui.min.css" rel="stylesheet"/>
 <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>


    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/js/select2.min.js"></script>

    <link href="css/ticket.css" rel="stylesheet" />
    <script src="lib/jquery.cookie.js"></script>

    <link href="images/tag_orange.png" rel="icon" type="image/png"/>
    <script src='https://www.google.com/recaptcha/api.js'></script>
  </head>

  <body>
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>

            <a class="brand" style="padding: 6px 0px 0px 6px;" href="http://opensciencegrid.org"><img src="images/osglogo.40x30.png"/></a>
            <ul class="nav">
                <li class="dropdown"><a href="https://ticket.opensciencegrid.org/#" class="dropdown-toggle" data-toggle="dropdown">GOC Ticket <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    <li><a href="https://my.opensciencegrid.org">MyOSG</a></li>
                    <li><a href="https://oim.opensciencegrid.org">OIM</a></li>
                    <li class="active"><a href="https://ticket.opensciencegrid.org/index">Ticket</a></li>
	<li class="divider"></li>
	<li><a href="http://repo.grid.iu.edu">Repo</a></li>
	<li class="divider"></li>
	<li><a href="http://blogs.grid.iu.edu">Blog</a></li>
                    <li><a href="http://display.grid.iu.edu">Display</a></li>
                    <li><a href="http://osggoc.blogspot.com/">News</a></li>
                    </ul>
                </li>
            </ul>
            <ul class="nav pull-right">
                <li><a href="https://ticket.opensciencegrid.org/sso/">Login</a></li>            </ul>

            <div class="nav-collapse">
                <ul class="nav">
			 <li id="menu_submit"><a href="https://ticket.opensciencegrid.org/submit">Submit</a></li><li id="menu_view" class="dropdown"><a href="https://ticket.opensciencegrid.org/\#" class="dropdown-toggle" data-toggle="dropdown">View <b class="caret"></b></a><ul class="dropdown-menu"><li id="submenu_listopen"><a href="https://ticket.opensciencegrid.org/list/open">Open Tickets</a></li><li id="submenu_listrecentclose"><a href="https://ticket.opensciencegrid.org/list/recentclose">Recently Closed Tickets</a></li><li class="divider"></li><li id="submenu_alltickets"><a href="https://ticket.opensciencegrid.org/search?q=&amp;sort=id">All Tickets</a></li></ul></li>                </ul>

                <form class="navbar-search pull-right" action="https://ticket.opensciencegrid.org/viewer">
                    <input id="search" type="text" name="id" class="search-query span2" placeholder="Search Ticket" value=""/>
                </form>
            </div>
        </div>
      </div>
    </div>

<script type='text/javascript' src='lib/jquery.timeago.js'></script>
<script type='text/javascript' src='lib/byte2size.js'></script>
<style>
#updates .toolbar {
position: relative;
margin-top: 0px;
top: -10px;
font-weight: normal;
}
#updates a.anchor {
position: relative;
top: -50px;
}
#updates .selected pre {
animation:selected 2s;
animation-iteration-count: 2;
animation-direction: alternate;
-webkit-animation:selected 2s; 
-webkit-animation-iteration-count: 2;
-webkit-animation-direction: alternate;
box-shadow: inset 1px 1px 20px #9ad;
border: 1px solid #9ab;
margin: 5px 0px;
padding-left: 10px;
}
@keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ab;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
@-webkit-keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ad;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
#updates pre {
background-color: inherit;
line-height: 15px;
padding: 5px;
}
#updates .header {
color: #999;
}
#updates .update_history pre {
background-color: #eee;
color: #666;
font-size: 85%;
}
#updates .clickable {
cursor: pointer;
}
#updates .clickable:hover {
color: #D98719;
}
#updates .meta_information pre {
background-color: #fed;
}
#similar_tickets {
max-height: 300px;
overflow-y: auto;
pointer-events: none;
padding: 5px;
background-color: #f4f4f4;
}
.btn-toolbar {
margin-bottom: 0;
height: 30px;
}
#peers {
position: fixed;
bottom: 0px;
right: 0px;
z-index: 100;
list-style: none;
padding: 5px 0px 0px 5px;
margin: 0px;
background-color: white;
box-shadow: 0px 0px 10px white;
}
#peers li {
background-color: #ccc;
color: #000;
display: inline-block;
padding: 5px 10px;
margin-right: 5px;
position: relative;
}
/*
#peers li:hover {
background-color: #999;
cursor: pointer;
}
*/
#peers span.ip {
padding-left: 5px;
color: #666;
}
#peers .new {
bottom: -30px;
}
/*
#peers .me {
background-color: red;
}
*/
</style>

<div class="container-fluid">
<ul id="peers"></ul>
<div class="alert alert-danger"><a class="close" href="https://ticket.opensciencegrid.org/#" data-dismiss="alert">&times;</a>By the end of May 2018, the ticketing system at https://ticket.opensciencegrid.org will be retired and support will be provided at https://support.opensciencegrid.org. Throughout this transition the support email (help@opensciencegrid.org) will be available as a point of contact.<br><br>                                                   
                                                                                                                                                                                   
Please see the service migration page for details: https://opensciencegrid.github.io/technology/policy/service-migrations-spring-2018/#ticket</div><div id="presence" class="pull-right"></div><div class="ticketgui"><script type="text/javascript" src="lib/checktab.js"></script>

<script>
var expanded = false;
function expand_description() {
    var desc = $(".description");
    if(!expanded) {
        expanded = true;
        //expand to minheight
        var min = 250;
        if(desc.height() < min) {
            desc.animate({height: min}, 200);
        }
    }
}

$(document).ready(function() {
    $("input[name='nad']").datepicker({
        dateFormat: 'yy-mm-dd'
    });
});

</script>



<style>
.form-horizontal .control-label {
padding-top: inherit;
font-size:90%;
color:#666;
}
label {
margin-bottom: 0px;
}
.controls {
line-height: 18px;
}
</style>
<form class="form-horizontal" action="https://ticket.opensciencegrid.org/viewer/updatebasic?id=24225" method="post">
<div class="page-header">
    <h3><span class="muted">24225</span> / glexec failures</h3>
</div>

<div class="row-fluid">
<div class="span5">
    <legend>Contact</legend>
    <div class="control-group">
        <label class="control-label">Full Name</label>
        <div class="controls">Justas Balcas</div>
    </div>
    <div class="control-group">
        <label class="control-label">Email</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">Phone</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">CC</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>

    <legend>Details</legend>
    <div class="control-group"><label class="control-label">Associated VO</label><div class="controls">CMS</div></div><div class="control-group"><label class="control-label">Submitted Via</label><div class="controls">GGUS</div></div><div class="control-group"><label class="control-label">Submitter</label><div class="controls">Justas Balcas</div></div><div class="control-group"><label class="control-label">Support Center</label><div class="controls">USCMS</div></div>
    <div class="control-group">
        <label class="control-label">Ticket Type</label>
        <div class="controls">Problem/Request</div>
    </div>
    <div class="control-group">
        <label class="control-label">Priority</label>
        <div class="controls">Elevated</div>
    </div>
    <div class="control-group">
        <label class="control-label">Status</label>
        <div class="controls">
Closed</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action</label>
        <div class="controls">TX Incoming</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action Deadline</label>
        <div class="controls flag_red">2015-03-09</div>
    </div>

</div><!--span-->
<div class="span7">
    <legend>Assignees</legend>
    <div class="assignee" style="width: 60%">FNAL (Prod)&nbsp;<a target="_blank" href="https://fermi.service-now.com/nav_to.do?uri=incident.do?sys_id=INC000000511901">INC000000511901</a> <span class="muted"> / Ticket Exchange</span></div><div class="assignee" style="width: 60%">GGUS (Prod)&nbsp;<a target="_blank" href="https://ggus.eu/ws/ticket_info.php?ticket=112026">112026</a> <span class="muted"> / Ticket Exchange</span></div>    <br>

    <legend>Assignees</legend>
    TODO
    <br>

    <style>
legend.noborder {
border-bottom: none;
}
</style>

<div id="attachment-list"/>
<script>
$(function () {
    var first = true;
    $.getJSON("attachment/list/24225", function (files) {
        //console.dir(files);
        var html = "<table class=\"table table-condensed\">";
        $(files).each(function() {
            if(first) {
                first = false;
                html += "<legend class=\"noborder\">Attachmenets</legend>";
            }
            html += "<tr class=\"attachment\">";
            html += "<td><img src="https://ticket.opensciencegrid.org/\&quot;&quot;+this.thumbnail_url+&quot;\&quot;/"></td>";
            html += "<td><a href="https://ticket.opensciencegrid.org/\&quot;&quot;+this.url+&quot;\&quot;" target=\"_blank\">"+this.name+"</a></td>";
            html += "<td>"+bytesToSize(this.size, 1)+"</td>";
            html += "</tr>";
        });
        html += "</table>";
        $("#attachment-list").html(html);
    });
});

function download(url) {
    window.open(url, "_blank");
}
</script>


</div><!--span-->
</div><!--row-fluid-->


</form>

</div>
<div id="updates" style="clear: both;">
    <legend>Past Updates
    <div class="btn-toolbar pull-right toolbar">
        <div class="btn-group">
                <a class="btn btn-small" href="https://ticket.opensciencegrid.org/24225?sort=up&amp;"><i class="icon-arrow-up"></i> Sort</a>

        
        <a class="btn btn-small" href="https://ticket.opensciencegrid.org/24225?expandall=true&amp;">Expand Descriptions</a>        <a class="btn btn-small" target="_blank" href="mailto:osg@tick.globalnoc.iu.edu?subject=Open%20Science%20Grid%3A%20glexec%20failures%20ISSUE%3D24225%20PROJ%3D71"><i class="icon-envelope"></i> Update w/Email</a>
        </div>
    </div><!--btn-toolbar-->
    </legend>

    <div class='update_description'><i onclick="document.location='24225#1427155213'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-03-24T00:00:13+00:00">Mar 24, 2015 12:00 AM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1427155213">&nbsp;</a></div><pre>This ticket was closed automatically. If this issue has not been resolved according your expectations or if you need further information, please submit a new ticket referencing this one.

-- by GGUS SYSTEM at Mon Mar 23 23&#58;59&#58;06 UTC 2015

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=112026' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=112026</a></pre></div><div class='update_description'><i onclick="document.location='24225#1425674825'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-03-06T20:47:05+00:00">Mar 6, 2015 08:47 PM UTC</time> by <b>Christopher Pipes</b><a class="anchor" name="1425674825">&nbsp;</a></div><pre>Thank you for informing us that this issue has been resolved. I will close this ticket.  Please submit problems, requests, and questions at&#58; <a href='https&#58;//ticket.grid.iu.edu/goc/open' target='_blank' rel='nofollow'>https&#58;//ticket.grid.iu.edu/goc/open</a> OSG Grid Operations Center goc@...., 317-278-9699 Visit the OSG Operations Page&#58; <a href='http&#58;//osggoc.blogspot.com/' target='_blank' rel='nofollow'>http&#58;//osggoc.blogspot.com/</a></pre></div><div class='update_description'><i onclick="document.location='24225#1425674747'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-03-06T20:45:47+00:00">Mar 6, 2015 08:45 PM UTC</time> by <b>Anthony Tiradani</b><a class="anchor" name="1425674747">&nbsp;</a></div><pre>Hi Chris,

Yes please.  The ticket is closed already in Service Now at FNAL.

Thanks,

Anthony Tiradani</pre></div><div class='update_description'><i onclick="document.location='24225#1425673783'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-03-06T20:29:43+00:00">Mar 6, 2015 08:29 PM UTC</time> by <b>Christopher Pipes</b><a class="anchor" name="1425673783">&nbsp;</a></div><pre>Brian or Tony,

Am I reading this correctly? Should I close this?

Thanks,
Chris</pre></div><div class='update_description'><i onclick="document.location='24225#1425592216'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-03-05T21:50:16+00:00">Mar 5, 2015 09:50 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1425592216">&nbsp;</a></div><pre>These were all user proxy problems.  Nothing for the site to do.
-- by tiradani at Thu Mar 05 21&#58;49&#58;18 UTC 2015

[Will not fix]
These were all user proxy problems.  Nothing for the site to do.
-- by  at Thu Mar 05 21&#58;49&#58;18 UTC 2015

GOCTX Source&#58; <a href='https&#58;//fermi.service-now.com/nav_to.do?uri=incident.do?sys_id=INC000000511901' target='_blank' rel='nofollow'>https&#58;//fermi.service-now.com/nav_to.do?uri=incident.do?sys_id=INC000000511901</a></pre></div><div class='update_description'><i onclick="document.location='24225#1425415297'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-03-03T20:41:37+00:00">Mar 3, 2015 08:41 PM UTC</time><a class="anchor" name="1425415297">&nbsp;</a></div><pre>Hi Tony,

I filed a corresponding HTCondor ticket&#58;

<a href='https&#58;//htcondor-wiki.cs.wisc.edu/index.cgi/tktview?tn=4920' target='_blank' rel='nofollow'>https&#58;//htcondor-wiki.cs.wisc.edu/index.cgi/tktview?tn=4920</a>

I currently see no way to pull the user&#39;s DN or job ID from the failure message.

We have seen many site issues at the level of &#34;individual worker node fails&#34;, &#34;entire site fails&#34;, or &#34;individual DN fails&#34;.  Other than assuming &#34;FNAL never has a problem&#34;, how should ops differentiate DN failures you outline below from generic DN failures?

Brian

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=bbockelm/CN=659869/CN=Brian Paul Bockelman</pre></div><div class='update_description'><i onclick="document.location='24225#1425412890'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-03-03T20:01:30+00:00">Mar 3, 2015 08:01 PM UTC</time> by <b>Anthony Tiradani</b><a class="anchor" name="1425412890">&nbsp;</a></div><pre>Hi Brian,

The thing is, *we* know whether or not glexec is configured correctly.  At one point in time, the pilot used to check glexec as well, maybe still does.  So, assuming that that is not an issue, the only things that go wrong were already enumerated below.  What we don&#39;t know based on the tickets are the actual users that are seeing issues.  I know that the user DN is available in the classads.  There should be a way to correlate the DN with the errors and give a count of errors per DN per time period.  I would give an educated guess that you will find that most of the errors encountered will be centered around a very small number of users and that the errors will be ephemeral or be expired proxies.

In short, without additional information on these tickets, this has the potential of becoming a very large rabbit hole monitoring-wise with little pay back.

Tony</pre></div><div class='update_description'><i onclick="document.location='24225#1425410385'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-03-03T19:19:45+00:00">Mar 3, 2015 07:19 PM UTC</time><a class="anchor" name="1425410385">&nbsp;</a></div><pre>Hi Tony,

We&#39;re limited by the information that HTCondor collects.  Doesn&#39;t FNAL have the ability to check these things quickly, as the only logs or debugging information goes to the site?

We can file a ticket with the HTCondor folks; right now, node counts and timestamps are the most useful information we&#39;re given.

Brian

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=bbockelm/CN=659869/CN=Brian Paul Bockelman</pre></div><div class='update_description'><i onclick="document.location='24225#1425405991'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-03-03T18:06:31+00:00">Mar 3, 2015 06:06 PM UTC</time> by <b>Anthony Tiradani</b><a class="anchor" name="1425405991">&nbsp;</a></div><pre>I am not sure who should we should talk to about tickets like these.  So far, for every ticket that we have received regarding glexec failures there are two failure modes.

1) The user proxy is expired
2) The user requested a user name remapping at FNAL and the mapping change was in the process of being rolled out.

There isn&#39;t anything that can be done by our admins in either case.  For 1), the user must renew their proxy.  For 2), the user just needs to wait a short period (at most a 1/2 hour) for the mapping change to propagate.

The danger here is that these tickets will be ignored if there isn&#39;t better filtering or checking at a higher level.  For example, what users are affected by the errors?  For nodes that have a high number of errors, how many users are seeing the errors?  The tickets need to be more than an error count per node.

Thanks,

Anthony Tiradani</pre></div><div class='update_description'><i onclick="document.location='24225#1425334710'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-03-02T22:18:30+00:00">Mar 2, 2015 10:18 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1425334710">&nbsp;</a></div><pre>Hi

Sorry I did not see your request last week.  I have looked on these nodes and no problem seen.
Are you still have issues with this node ?

Thank You,
Merina
-- by merina at Mon Mar 02 22&#58;17&#58;49 UTC 2015

GOCTX Source&#58; <a href='https&#58;//fermi.service-now.com/nav_to.do?uri=incident.do?sys_id=INC000000511901' target='_blank' rel='nofollow'>https&#58;//fermi.service-now.com/nav_to.do?uri=incident.do?sys_id=INC000000511901</a></pre></div><div class='update_description'><i onclick="document.location='24225#1424930670'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-02-26T06:04:30+00:00">Feb 26, 2015 06:04 AM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1424930670">&nbsp;</a></div><pre>Hi,

I see glexec failures on these nodes (Started from 02/26/15 02&#58;48&#58;53 GVA)&#58;
Count Node
19 cmswn2003.fnal.gov
15 cmswn2119.fnal.gov
15 cmswn2112.fnal.gov
10 cmswn2074.fnal.gov
10 cmswn2073.fnal.gov
10 cmswn2051.fnal.gov
10 cmswn2023.fnal.gov
10 cmswn1993.fnal.gov
5 cmswn2115.fnal.gov
5 cmswn2065.fnal.gov
5 cmswn2052.fnal.gov
5 cmswn2035.fnal.gov
5 cmswn1938.fnal.gov
5 cmswn1935.fnal.gov
5 cmswn1644.fnal.gov
1 cmswn1931.fnal.gov

02/26/15 03&#58;54&#58;37 (996980.0) (2694932)&#58; ERROR &#34;Error from slot1@glidein_64272_355962252@....&#58; error changing sandbox ownership to the user&#58; co
ndor_glexec_setup exited with status 768 and the following output&#58; [gLExec]&#58;  LCMAPS failed.;            The reason can be found in the syslog.; Glexec exit
ed with status 203; retrying in 30 seconds.; [gLExec]&#58;  LCMAPS failed.;            The reason can be found in the syslog.; Glexec exited with status 203; re
trying in 30 seconds.; [gLExec]&#58;  LCMAPS failed.;            The reason can be found in the syslog.; Glexec exited with status 203; retrying in 90 seconds.;
[gLExec]&#58;  LCMAPS failed.;            The reason can be found in the syslog.&#34; at line 558 in file /slots/03/dir_59220/userdir/src/condor_shadow.V6.1/pseudo
_ops.cpp

Can you take a look?

Cheers,
Justas

[Ticket Origin]
<a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=112026' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=112026</a>
<div id='show_1901546060' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_1901546060'>
[Ticket History]
Subject&#58; glexec failures
Ticket Type&#58; USER
CC&#58; ;cms-comp-ops-site-support-team@....
-- by Justas Balcas at Thu Feb 26 06&#58;02&#58;59 UTC 2015
</div><script type='text/javascript'>
        $('#show_1901546060').click(function() {
            $('#detail_1901546060').slideDown("normal");
            $('#show_1901546060').hide();
            $('#hide_1901546060').show();
        });
        $('#hide_1901546060').click(function() {
            $('#detail_1901546060').slideUp();
            $('#hide_1901546060').hide();
            $('#show_1901546060').show();
        });
        </script></pre></div><legend>Similar Recent Tickets <small>modified within the last 30 days</small></legend><div id="similar_tickets"><p class="muted">No similar tickets found.</p></div>
</div>
<script type="text/javascript">
function reset_anchor() {
    $("#updates .selected").removeClass("selected");
    var urls = document.location.toString().split('#'); 
    var anchor = urls[1];
    if(anchor) {
        $("a[name='"+anchor+"']").parents(".update_description").addClass("selected");
    }
}
function submitspam(ticket_id) {
    myret = confirm("Would you like to close this ticket as a security ticket, and submit the ticket content to akismet?");
    if(myret == true) {
        $.ajax("viewer/processspam?id="+ticket_id).done(function() {
            window.location.reload();
        });
    }
}

$(function() {
    reset_anchor();
    var ADDITIONAL_COOKIE_NAME = 'gocticket';
    var options = { path: '/', expires: 365};

    if(window.opener && window.opener.name == "gocticket_list") {
        v = $.cookie("closewindow");
        if(!v) {
            $("#closewindow").attr("checked", "checked"); //on by default
        } else {
            if(v == "checked") {
                $("#closewindow").attr("checked", "checked");
            }
        }
        $("#closewindow").click(function() {
            $.cookie("closewindow", $(this).attr('checked'), options);
        });
    } else {
        $("#closewindow_area").hide();
    }
    function updateTimeago() {
        $("time").timeago();
        setTimeout(updateTimeago, 30*1000);
    }
    updateTimeago();
    $(".description").focus(expand_description);
});
</script>
<hr/>
<footer>
<p>GOC Ticket Version 2.2 | <a href="https://ticket.opensciencegrid.org/goc/submit?app_issue_check=on&amp;app_issue_type=goc&amp;app_goc_url=https%3A%2F%2Fticket.opensciencegrid.org%3A443%2F24225">Report Bugs</a>
 | <a href="https://github.com/opensciencegrid/operations/blob/master/docs/privacy.md">Privacy Policy</a>
</p>

<p> <img align="top" src="images/tag_orange.png"/> Copyright 2018 The Trustees of Indiana University - Developed for Open Science Grid</p>
</footer>


</div><!--container-fluid-->
<script src="https://ticket1.grid.iu.edu:8443/socket.io/socket.io.js"></script>
<script>
var chat = io.connect('https://ticket1.grid.iu.edu:8443');
chat.on('connect', function() {
    chat.emit('authenticate', {nodekey:'', ticketid: 24225});
});
chat.on('peers', function(peers) {
    $("#peers").html("");
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('peer_disconnect', function(pid) {
    $("#peer_"+pid).hide("slow");
});
chat.on('peer_connected', function(peers) {
    //expect only 1 peer connecting, but..
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('submit', function() {
    if(confirm("This ticket was updated. Do you want to refresh?")) {
        history.go(0);
    }
});

function addPeer(pid, peer) {
    var ipinfo = "";
    if(peer.ip != undefined) {
        ipinfo = "<span class=\"ip\">"+peer.ip+"</span>";
    }
    if(chat.io.engine.id == pid) {
        //don't display myself
        return;
    }
    var html = "<li class=\"new\" id=\"peer_"+pid+"\" class=\"peer\">"+peer.name+ipinfo+"</li>";
    $("#peers").prepend(html);
    $("#peers .new").animate({bottom: 0}, 1000, function() {$(this).removeClass("new")});
}

$(function() {
    $("#ticket_form").submit(function() {
        chat.emit('submit');
        return true;
    });
});
</script>
<script>
//used by searchbox
function parseValue(value) {
    var obj = new Object();
    var tokens = value.split("\t");
    obj.str = tokens[0];
    obj.count = tokens[1];
    return obj;
}

$(function() {
    //bootstrap-2.0.4 stuff
    $(".alert-message").alert();
    $(".dropdown-toggle").dropdown();
    $("span[rel='tooltip']").tooltip();
    $("a[rel=popover]").popover();

    //activate menu that user is currently on
    $("#menu_navigator").addClass("active"); 
    $("#submenu_").addClass("active"); 

    //translate zend validation error message to bootstrap
    $(".errors").addClass("alert").addClass("alert-error");

    //enable autocomplete for search box
    $("#search").autocomplete({
        source: function( request, response ) {
            $.ajax({
                url: "search/autocomplete",
                dataType: "text",
                data: {
                    //featureClass: "P",
                    //style: "full",
                    //maxRows: 12,
                    //name_startsWith: request.term
                    q: request.term
                },
                success: function( data ) {
                    response( $.map( data.split("\n"), function( item ) {
                        if(item == "") return null;
                        return {
                            value: item
                        }
                    }));
                }
            });
        },
        select: function(event, ui) {
            document.location = "search?q="+ui.item.value;
        }
    });
    
});
</script>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-69012-13");
pageTracker._trackPageview();
} catch(err) {}
</script>

</body>
