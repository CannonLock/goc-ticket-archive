<!DOCTYPE html>
<html lang="en">
  <head>
  <base href="">
    <title>[9013] Software Cache Bugs / Requests GUMS RSV probe busted</title>    <meta charset="utf-8" />
    <meta name="verify-v1" content="na5IcAJsZVOfEkboRxuIiZ1zpZgnZiWra+nKcS7nA/o=" />
    <meta name="google-site-verification" content="DLrk3ft4s8b-S2TloLCL2LD_t6wcTjgSluf5pmiu2kA" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />
    <link href="https://ticket.opensciencegrid.org/rss" rel="alternate" type="application/rss+xml" title="GOC Ticket Update feed" />

    <style type="text/css">
      body {
        padding-top: 50px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
     #search {
            width: 300px;
     }

    </style>

<script src="https://code.jquery.com/jquery-3.0.0.js"></script>
<script src="https://code.jquery.com/jquery-migrate-3.0.1.js"></script>

   <link href="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet"/>
    <script src="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/js/bootstrap.min.js"></script>

    <link href="https://netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"/>
    <link href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/themes/smoothness/jquery-ui.min.css" rel="stylesheet"/>
 <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>


    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/js/select2.min.js"></script>

    <link href="css/ticket.css" rel="stylesheet" />
    <script src="lib/jquery.cookie.js"></script>

    <link href="images/tag_orange.png" rel="icon" type="image/png"/>
  </head>

  <body>
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>

            <a class="brand" style="padding: 6px 0px 0px 6px;" href="http://opensciencegrid.org"><img src="images/osglogo.40x30.png"/></a>
            <ul class="nav">
                <li class="dropdown"><a href="https://ticket.opensciencegrid.org/#" class="dropdown-toggle" data-toggle="dropdown">GOC Ticket <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    <li><a href="https://my.opensciencegrid.org">MyOSG</a></li>
                    <li><a href="https://oim.opensciencegrid.org">OIM</a></li>
                    <li class="active"><a href="https://ticket.opensciencegrid.org/index">Ticket</a></li>
	<li class="divider"></li>
	<li><a href="http://repo.grid.iu.edu">Repo</a></li>
	<li class="divider"></li>
	<li><a href="http://blogs.grid.iu.edu">Blog</a></li>
                    <li><a href="http://display.grid.iu.edu">Display</a></li>
                    <li><a href="http://osggoc.blogspot.com/">News</a></li>
                    </ul>
                </li>
            </ul>
            <ul class="nav pull-right">
                <li><a href="https://ticket.opensciencegrid.org/sso/">Login</a></li>            </ul>

            <div class="nav-collapse">
                <ul class="nav">
			 <li id="menu_submit"><a href="https://ticket.opensciencegrid.org/submit">Submit</a></li><li id="menu_view" class="dropdown"><a href="https://ticket.opensciencegrid.org/\#" class="dropdown-toggle" data-toggle="dropdown">View <b class="caret"></b></a><ul class="dropdown-menu"><li id="submenu_listopen"><a href="https://ticket.opensciencegrid.org/list/open">Open Tickets</a></li><li id="submenu_listrecentclose"><a href="https://ticket.opensciencegrid.org/list/recentclose">Recently Closed Tickets</a></li><li class="divider"></li><li id="submenu_alltickets"><a href="https://ticket.opensciencegrid.org/search?q=&amp;sort=id">All Tickets</a></li></ul></li>                </ul>

                <form class="navbar-search pull-right" action="https://ticket.opensciencegrid.org/viewer">
                    <input id="search" type="text" name="id" class="search-query span2" placeholder="Search Ticket" value=""/>
                </form>
            </div>
        </div>
      </div>
    </div>

<script type='text/javascript' src='lib/jquery.timeago.js'></script>
<script type='text/javascript' src='lib/byte2size.js'></script>
<style>
#updates .toolbar {
position: relative;
margin-top: 0px;
top: -10px;
font-weight: normal;
}
#updates a.anchor {
position: relative;
top: -50px;
}
#updates .selected pre {
animation:selected 2s;
animation-iteration-count: 2;
animation-direction: alternate;
-webkit-animation:selected 2s; 
-webkit-animation-iteration-count: 2;
-webkit-animation-direction: alternate;
box-shadow: inset 1px 1px 20px #9ad;
border: 1px solid #9ab;
margin: 5px 0px;
padding-left: 10px;
}
@keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ab;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
@-webkit-keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ad;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
#updates pre {
background-color: inherit;
line-height: 15px;
padding: 5px;
}
#updates .header {
color: #999;
}
#updates .update_history pre {
background-color: #eee;
color: #666;
font-size: 85%;
}
#updates .clickable {
cursor: pointer;
}
#updates .clickable:hover {
color: #D98719;
}
#updates .meta_information pre {
background-color: #fed;
}
#similar_tickets {
max-height: 300px;
overflow-y: auto;
pointer-events: none;
padding: 5px;
background-color: #f4f4f4;
}
.btn-toolbar {
margin-bottom: 0;
height: 30px;
}
#peers {
position: fixed;
bottom: 0px;
right: 0px;
z-index: 100;
list-style: none;
padding: 5px 0px 0px 5px;
margin: 0px;
background-color: white;
box-shadow: 0px 0px 10px white;
}
#peers li {
background-color: #ccc;
color: #000;
display: inline-block;
padding: 5px 10px;
margin-right: 5px;
position: relative;
}
/*
#peers li:hover {
background-color: #999;
cursor: pointer;
}
*/
#peers span.ip {
padding-left: 5px;
color: #666;
}
#peers .new {
bottom: -30px;
}
/*
#peers .me {
background-color: red;
}
*/
</style>

<div class="container-fluid">
<ul id="peers"></ul>
<div class="alert alert-danger"><a class="close" href="https://ticket.opensciencegrid.org/#" data-dismiss="alert">&times;</a>By the end of May 2018, the ticketing system at https://ticket.opensciencegrid.org will be retired and support will be provided at https://support.opensciencegrid.org. Throughout this transition the support email (help@opensciencegrid.org) will be available as a point of contact.<br><br>                                                   
                                                                                                                                                                                   
Please see the service migration page for details: https://opensciencegrid.github.io/technology/policy/service-migrations-spring-2018/#ticket</div><div id="presence" class="pull-right"></div><div class="ticketgui"><script type="text/javascript" src="lib/checktab.js"></script>

<script>
var expanded = false;
function expand_description() {
    var desc = $(".description");
    if(!expanded) {
        expanded = true;
        //expand to minheight
        var min = 250;
        if(desc.height() < min) {
            desc.animate({height: min}, 200);
        }
    }
}

$(document).ready(function() {
    $("input[name='nad']").datepicker({
        dateFormat: 'yy-mm-dd'
    });
});

</script>



<style>
.form-horizontal .control-label {
padding-top: inherit;
font-size:90%;
color:#666;
}
label {
margin-bottom: 0px;
}
.controls {
line-height: 18px;
}
</style>
<form class="form-horizontal" action="https://ticket.opensciencegrid.org/viewer/updatebasic?id=9013" method="post">
<div class="page-header">
    <h3><span class="muted">9013</span> / Software Cache Bugs / Requests GUMS RSV probe busted</h3>
</div>

<div class="row-fluid">
<div class="span5">
    <legend>Contact</legend>
    <div class="control-group">
        <label class="control-label">Full Name</label>
        <div class="controls">Steve Timm</div>
    </div>
    <div class="control-group">
        <label class="control-label">Email</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">Phone</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">CC</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>

    <legend>Details</legend>
    
    <div class="control-group">
        <label class="control-label">Ticket Type</label>
        <div class="controls">Problem/Request</div>
    </div>
    <div class="control-group">
        <label class="control-label">Priority</label>
        <div class="controls">Normal</div>
    </div>
    <div class="control-group">
        <label class="control-label">Status</label>
        <div class="controls">
Closed</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action</label>
        <div class="controls">ENG Action</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action Deadline</label>
        <div class="controls flag_red">2011-01-25</div>
    </div>

</div><!--span-->
<div class="span7">
    <legend>Assignees</legend>
        <br>

    <legend>Assignees</legend>
    TODO
    <br>

    <style>
legend.noborder {
border-bottom: none;
}
</style>

<div id="attachment-list"/>
<script>
$(function () {
    var first = true;
    $.getJSON("attachment/list/9013", function (files) {
        //console.dir(files);
        var html = "<table class=\"table table-condensed\">";
        $(files).each(function() {
            if(first) {
                first = false;
                html += "<legend class=\"noborder\">Attachmenets</legend>";
            }
            html += "<tr class=\"attachment\">";
            html += "<td><img src=\""+this.thumbnail_url+"\"/></td>";
            html += "<td><a href=\""+this.url+"\" target=\"_blank\">"+this.name+"</a></td>";
            html += "<td>"+bytesToSize(this.size, 1)+"</td>";
            html += "</tr>";
        });
        html += "</table>";
        $("#attachment-list").html(html);
    });
});

function download(url) {
    window.open(url, "_blank");
}
</script>


</div><!--span-->
</div><!--row-fluid-->


</form>

</div>
<div id="updates" style="clear: both;">
    <legend>Past Updates
    <div class="btn-toolbar pull-right toolbar">
        <div class="btn-group">
                <a class="btn btn-small" href="https://ticket.opensciencegrid.org/9013?sort=up&amp;"><i class="icon-arrow-up"></i> Sort</a>

        
        <a class="btn btn-small" href="https://ticket.opensciencegrid.org/9013?expandall=true&amp;">Expand Descriptions</a>        <a class="btn btn-small" target="_blank" href="mailto:osg@tick.globalnoc.iu.edu?subject=Open%20Science%20Grid%3A%20Software%20Cache%20Bugs%20%2F%20Requests%20GUMS%20RSV%20probe%20busted%20ISSUE%3D9013%20PROJ%3D71"><i class="icon-envelope"></i> Update w/Email</a>
        </div>
    </div><!--btn-toolbar-->
    </legend>

    <div class='update_description'><i onclick="document.location='9013#1296057081'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-01-26T15:51:21+00:00">Jan 26, 2011 03:51 PM UTC</time><a class="anchor" name="1296057081">&nbsp;</a></div><pre>This is no longer a production issue because a new version of RSV has been released
into production where the broken GUMS probe is no longer enabled by default, although
it will stay enabled by default at sites like mine who enabled it.
I am still very interested in following up the underlying problem with Xin and
John because we never reached causality on this ticket.  My patch worked but
according to any reasonable explanation of how GUMS works it shouldn&#39;t have worked.
We can keep the corresponding ITB ticket open and handle further discussion there.

Steve Timm

-- by Steve Timm</pre></div><div class='update_description'><i onclick="document.location='9013#1295381347'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-01-18T20:09:07+00:00">Jan 18, 2011 08:09 PM UTC</time> by <b>Xin zhao</b><a class="anchor" name="1295381347">&nbsp;</a></div><pre>Hello,

GUMS developers are aware and working on the ultimate solution, which
will be in a new
GUMS release. At this point, I think we can take this offline as a
development issue, instead of
keeping it as production tickets.

Cheers,
Xin

On 1/18/2011 2&#58;23 PM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='9013#1295378627'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-01-18T19:23:47+00:00">Jan 18, 2011 07:23 PM UTC</time> by <b>echism</b><a class="anchor" name="1295378627">&nbsp;</a></div><pre>Xin and Steve,

I don&#39;t think this ticket has ultimately facilitated much progress. Can we take an alternative course for resolution, or make a definitive deadline on this? I&#39;m just reluctant to keep annoying everyone in the doldrums here.

Thank you,
Elizabeth</pre></div><div class='update_description'><i onclick="document.location='9013#1294752453'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-01-11T13:27:33+00:00">Jan 11, 2011 01:27 PM UTC</time> by <b>echism</b><a class="anchor" name="1294752453">&nbsp;</a></div><pre>Steve,

Are there any updates on this?

Thank you,
Elizabeth</pre></div><div class='update_description'><i onclick="document.location='9013#1292253068'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2010-12-13T15:11:08+00:00">Dec 13, 2010 03:11 PM UTC</time> by <b>Steven Timm</b><a class="anchor" name="1292253068">&nbsp;</a></div><pre>No.. we hope to get it sorted out this week, though.

Steve

On Mon, 13 Dec 2010, Open Science Grid FootPrints wrote&#58;

<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='9013#1292249951'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2010-12-13T14:19:11+00:00">Dec 13, 2010 02:19 PM UTC</time> by <b>echism</b><a class="anchor" name="1292249951">&nbsp;</a></div><pre>Steve,

Is there anything new on this?

Thank you,
Elizabeth</pre></div><div class='update_description'><i onclick="document.location='9013#1291402347'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2010-12-03T18:52:27+00:00">Dec 3, 2010 06:52 PM UTC</time> by <b>echism</b><a class="anchor" name="1291402347">&nbsp;</a></div><pre>Steve,

Do you have the documentation?

Thank you,
Elizabeth</pre></div><div class='update_description'><i onclick="document.location='9013#1290565463'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2010-11-24T02:24:23+00:00">Nov 24, 2010 02:24 AM UTC</time> by <b>echism</b><a class="anchor" name="1290565463">&nbsp;</a></div><pre>Steve,

I&#39;m going to assume you&#39;re still dealing with the fallout from the power issues. Please send an update as one becomes available.

Thank you,
Elizabeth</pre></div><div class='update_description'><i onclick="document.location='9013#1290199274'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2010-11-19T20:41:14+00:00">Nov 19, 2010 08:41 PM UTC</time> by <b>echism</b><a class="anchor" name="1290199274">&nbsp;</a></div><pre>Okay, I&#39;ll check in on this in a few days.

Thank you,
Elizabeth</pre></div><div class='update_description'><i onclick="document.location='9013#1289942586'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2010-11-16T21:23:06+00:00">Nov 16, 2010 09:23 PM UTC</time> by <b>Steven Timm</b><a class="anchor" name="1289942586">&nbsp;</a></div><pre>No--Xin and John are still waiting for me to document my workaround
better.  I&#39;ve found a workaround but neither they nor I can explain why it
is working and we need to do so.

Steve Timm

On Tue, 16 Nov 2010, Open Science Grid FootPrints wrote&#58;

<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='9013#1289942204'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2010-11-16T21:16:44+00:00">Nov 16, 2010 09:16 PM UTC</time> by <b>echism</b><a class="anchor" name="1289942204">&nbsp;</a></div><pre>Hi Steve,

Are there any updates on this?

Thank you,
Elizabeth</pre></div><div class='update_description'><i onclick="document.location='9013#1289002807'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2010-11-06T00:20:07+00:00">Nov 6, 2010 12:20 AM UTC</time> by <b>Steven Timm</b><a class="anchor" name="1289002807">&nbsp;</a></div><pre>There is still some info that I am supposed to send to John and Xin.
Will do it next week.

STeve

On Fri, 5 Nov 2010, Open Science Grid FootPrints wrote&#58;

<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='9013#1288991467'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2010-11-05T21:11:07+00:00">Nov 5, 2010 09:11 PM UTC</time> by <b>Xin zhao</b><a class="anchor" name="1288991467">&nbsp;</a></div><pre>Hello,

This turns into a development work in GUMS. OSG will disable this probe
till a new GUMS version that can accept delegated
proxy is out.  So I would suggest to close this ticket for now.

Thanks,
Xin

On 11/5/2010 4&#58;03 PM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='9013#1288987407'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2010-11-05T20:03:27+00:00">Nov 5, 2010 08:03 PM UTC</time> by <b>echism</b><a class="anchor" name="1288987407">&nbsp;</a></div><pre>Are there any updates on this?

Thank you,
Elizabeth</pre></div><div class='update_description'><i onclick="document.location='9013#1287615188'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2010-10-20T22:53:08+00:00">Oct 20, 2010 10:53 PM UTC</time> by <b>Steven Timm</b><a class="anchor" name="1287615188">&nbsp;</a></div><pre>Haven&#39;t had a chance to try it again yet.. I am traveling this week, but
I have told John and Xin that I will document what is working for me
and get back to them.  We are in the state right now that we have
a workaround that works for Fermilab but we aren&#39;t really sure why it
works.

Steve Timm

On Wed, 20 Oct 2010, Open Science Grid FootPrints wrote&#58;

<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='9013#1287610328'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2010-10-20T21:32:08+00:00">Oct 20, 2010 09:32 PM UTC</time> by <b>Steven Timm</b><a class="anchor" name="1287610328">&nbsp;</a></div><pre>This is an automatic reply.

I am away from the lab on vacation.
If you have any need of help with FermiGrid please
contact the Service Desk at <a href='http&#58;//servicedesk.fnal.gov' target='_blank' rel='nofollow'>http&#58;//servicedesk.fnal.gov</a>,
(630) 840-2345.  If human contact is necessary, please
contact my supervisor, Keith Chadwick.
I will be checking E-mail intermittently during this time.

Steve Timm</pre></div><div class='update_description'><i onclick="document.location='9013#1287610171'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2010-10-20T21:29:31+00:00">Oct 20, 2010 09:29 PM UTC</time> by <b>echism</b><a class="anchor" name="1287610171">&nbsp;</a></div><pre>Steve,

Did you have more details on that last update you sent, or was that it?

Thank you,
Elizabeth</pre></div><div class='update_description'><i onclick="document.location='9013#1286896387'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2010-10-12T15:13:07+00:00">Oct 12, 2010 03:13 PM UTC</time><a class="anchor" name="1286896387">&nbsp;</a></div><pre>I have seen John&#39;s update.  I will try to document our setup further.
the only thing I have changed is gums-authorization-validator-probe-worker.sh
The diff is below

[root@fgitbgkc2 worker-scripts]# diff gums-authorization-validator-probe-worker.sh gums-authorization-validator-probe-worker.sh.orig
3,10c3,4
&#60; # S. Timm 9/23/10 try this from Xin Zhao
&#60; # if 2 statements below are commented out, that should make it take
&#60; # the default proxy instead.
&#60; #export X509_USER_PROXY=$1
&#60; if [ -r $X509_USER_PROXY ]
&#60; then
&#60; export X509_PROXY_FILE=$X509_USER_PROXY
&#60; fi
---
<font color='#7F7E6F'>&#62; export X509_USER_PROXY=$1</font>
<font color='#7F7E6F'>&#62; export X509_PROXY_FILE=$1</font>
---------------

I.e. I am taking the $X509_USER_PROXY from the environment of the
fork job rather than the hardwired rsvuser proxy from the config.ini
file, which the fork job has no permission to read.

I&#39;ll demonstrate how this works later
1) from a fork job that has nothing to do with RSV
2) from the command line with a limited proxy.

-- by Steve Timm</pre></div><div class='update_description'><i onclick="document.location='9013#1286895378'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2010-10-12T14:56:18+00:00">Oct 12, 2010 02:56 PM UTC</time> by <b>echism</b><a class="anchor" name="1286895378">&nbsp;</a></div><pre>Steve,

Did you see John&#39;s last update?

Thank you,
Elizabeth</pre></div><div class='update_description'><i onclick="document.location='9013#1286391549'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2010-10-06T18:59:09+00:00">Oct 6, 2010 06:59 PM UTC</time> by <b>Mariachi</b><a class="anchor" name="1286391549">&nbsp;</a></div><pre>Hi all, Steve,

Agreed that something odd is happening. What exactly is your workaround
(or can you link to a ticket thread that explains it)? Based on looking
at the logs on the server side, the DN string being passed includes
various extensions (additional CN=XYZ, where XYZ is &#34;proxy&#34; or a random
serial number). These extensions are added when a delegated proxy is
created.

Based on how the matching works, none of these DNs should succeed,
because that string is not a member of a VO.

In our discussions, we see two approaches to solving this&#58;

1) Strip off the extensions on the client side (in the gums command line
client that the RSV probe uses)
2) Process the provided DN on the server side, stripping off extensions
until we reach a string that matches a known member of a VO.

The added complication is that the SSL channel between the client and
the server is secured using the proxy provided by the client. Since the
subject of these proxies varies, there is no way to authorize only
particular users to perform the call (generate-fqan-map in this case).

We are able to manipulate what string is sent to the server from the
GUMS client, but all the SSL channel stuff is 3rd party code--not
something we can change. Our current plan is to do #2 above.

Anyway, the mystery for us is why the RSV probe should *ever* work when
submitted as a job to a gatekeeper (as opposed to being run
stand-alone--hitting GUMS directly from the RSV host).

Hope this makes sense. We&#39;re keen to hear any more info, experiments, or
ideas you may have.

<div id='show_143504595' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_143504595'>Cheers,

--john

On 10/06/2010 01&#58;20 PM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font>
</div><script type='text/javascript'>
        $('#show_143504595').click(function() {
            $('#detail_143504595').slideDown("normal");
            $('#show_143504595').hide();
            $('#hide_143504595').show();
        });
        $('#hide_143504595').click(function() {
            $('#detail_143504595').slideUp();
            $('#hide_143504595').hide();
            $('#show_143504595').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='9013#1286385607'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2010-10-06T17:20:07+00:00">Oct 6, 2010 05:20 PM UTC</time> by <b>Steven Timm</b><a class="anchor" name="1286385607">&nbsp;</a></div><pre>It is not agreeable by me (the submitter) to close the ticket.
Developers have not yet given any explanation of why GUMS either
does or does not work with the delegated proxy. If what they are
saying is true my probe workaround should not be working at all, but it
is.

Steve Timm

On Wed, 6 Oct 2010, Open Science Grid FootPrints wrote&#58;

<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='9013#1286385249'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2010-10-06T17:14:09+00:00">Oct 6, 2010 05:14 PM UTC</time> by <b>Steven Timm</b><a class="anchor" name="1286385249">&nbsp;</a></div><pre>I think we are still stuck in the state that I have a workaround
that makes the probe on my ITB site but neither I nor the developers can
explain how it can actually be working.  According to all we know, it
shouldn&#39;t be working.

Steve

On Wed, 6 Oct 2010, Open Science Grid FootPrints wrote&#58;

<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='9013#1286385246'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2010-10-06T17:14:06+00:00">Oct 6, 2010 05:14 PM UTC</time> by <b>Xin zhao</b><a class="anchor" name="1286385246">&nbsp;</a></div><pre>Hello,

We will hold off fixing the probe till a new GUMS release is out, which
can handle the delegated proxy.
In the new VDT release, the probe will not be enabled by default, only
experts can try it out if they want.

So I think we understand the issue here, and have a (long term) solution
in place. Feel free to close this
ticket for now, if agreeable by all parties, and we will address it later.

Thanks,
Xin

On 10/6/2010 1&#58;06 PM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='9013#1286384817'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2010-10-06T17:06:57+00:00">Oct 6, 2010 05:06 PM UTC</time> by <b>echism</b><a class="anchor" name="1286384817">&nbsp;</a></div><pre>Are there any updates on this?

Thank you,
Elizabeth</pre></div><div class='update_description'><i onclick="document.location='9013#1285818426'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2010-09-30T03:47:06+00:00">Sep 30, 2010 03:47 AM UTC</time> by <b>Steven Timm</b><a class="anchor" name="1285818426">&nbsp;</a></div><pre>I am not sure we have really figured out what is happening
with the limited proxy and doing the
gums generateFqanMapfile.  There are a couple of tests
I have done where the limited proxy fails to talk
to gums and others where it succeeds.  My probe is working
at the moment and it couldn&#39;t be doing so without
a limited proxy being able to work at least sometimes.

Steve

On Wed, 29 Sep 2010, Open Science Grid FootPrints wrote&#58;

<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='9013#1285800787'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2010-09-29T22:53:07+00:00">Sep 29, 2010 10:53 PM UTC</time> by <b>Xin zhao</b><a class="anchor" name="1285800787">&nbsp;</a></div><pre>Hi Steve,

I have been holding this off since we are reconsidering how the probe
should work.  I am not sure if it&#39;s appropriate to
ask the rsv probe DN to have administrator privilege in GUMS. I talked
with John a short while back, he&#39;s thinking to
change GUMS code to allow connection from the limited proxy...    I will
talk to John tomorrow, see if it&#39;s possible to
make it a two step modification, meaning firstly getting the patch you
mentioned into production, plus the gums admin
rsv user DN configuration, so whichever sites wanting to run it can make
it work that way for now. Then make the GUMS
change that will eliminate the request of the GUMS admin privilege
eventually...   I will let you know.

Thanks,
Xin

On 9/29/2010 6&#58;11 PM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='9013#1285798266'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2010-09-29T22:11:06+00:00">Sep 29, 2010 10:11 PM UTC</time> by <b>Steven Timm</b><a class="anchor" name="1285798266">&nbsp;</a></div><pre>It should be the developers of the probe who make contact with the ITB
and ask for the testing, and make sure the patch gets made.
Please go through whatever official channels are necessary to
make it happen.. this is a piece of software that has been in production
for more than a year and has been broken the whole time.

Steve Timm

On Wed, 29 Sep 2010, Open Science Grid FootPrints wrote&#58;

<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='9013#1285797311'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2010-09-29T21:55:11+00:00">Sep 29, 2010 09:55 PM UTC</time> by <b>echism</b><a class="anchor" name="1285797311">&nbsp;</a></div><pre>Steve,

Can you farm that out to the ITBers, or would you prefer I go through the official channels here?

Thank you,
Elizabeth</pre></div><div class='update_description'><i onclick="document.location='9013#1285340620'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2010-09-24T15:03:40+00:00">Sep 24, 2010 03:03 PM UTC</time><a class="anchor" name="1285340620">&nbsp;</a></div><pre>See ITB ticket #132 where this originated.
A patch to $VDT_LOCATION/osg-rsv/bin/probes/worker-scripts/gums-authorization-validator-probe-worker.sh
can be done to make this work.
#export X509_USER_PROXY=$1
if [ -r $X509_USER_PROXY ]
then
export X509_PROXY_FILE=$X509_USER_PROXY
fi

The key is to take the $X509_USER_PROXY from the job environment
and not from the value of the proxy which is owned by the submitting
rsvuser.

It should be noted that for those sites who have their
rsv submitter running as &#34;rsvuser&#34; and then map the certificate
in gums to &#34;rsvuser&#34; as well, this probe would have worked as it was.

The other trick is that it is necessary to add the subject of
the certificate that is runnign RSV as a gums admin.  As long as
the subject of the cert is listed as a gums admin it does not mattter
that it is a limited proxy.

This patch should be tested in a variety of RSV environments to make
sure that when it fixes my problem it didn&#39;t break anyone else.</pre></div><div class='update_description'><i onclick="document.location='9013#1284677360'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2010-09-16T22:49:20+00:00">Sep 16, 2010 10:49 PM UTC</time><a class="anchor" name="1284677360">&nbsp;</a></div><pre>Hello,

This will probably require a new GUMS release that can recognize the limited proxy from the CE,
along with other changes on how to run the probe etc.  I don&#39;t see a quick fix here, but will keep you
updated.

Xin</pre></div><div class='update_description'><i onclick="document.location='9013#1284673692'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2010-09-16T21:48:12+00:00">Sep 16, 2010 09:48 PM UTC</time> by <b>echism</b><a class="anchor" name="1284673692">&nbsp;</a></div><pre>Hello,

We haven&#39;t had a substantive update to either ticket in a few weeks. Is there one?

Thank you,
Elizabeth</pre></div><div class='update_description'><i onclick="document.location='9013#1283963224'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2010-09-08T16:27:04+00:00">Sep 8, 2010 04:27 PM UTC</time> by <b>echism</b><a class="anchor" name="1283963224">&nbsp;</a></div><pre>Xin,

Perhaps we should close the itb ticket considering that this probe is in production. Would that be alright?

Thank you,
Elizabeth</pre></div><div class='update_description'><i onclick="document.location='9013#1283456772'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2010-09-02T19:46:12+00:00">Sep 2, 2010 07:46 PM UTC</time><a class="anchor" name="1283456772">&nbsp;</a></div><pre>Hello,

Yes I am looking into it. I updated the ITB ticket&#58;
<a href='https&#58;//ticket.grid.iu.edu/itb/viewer?id=132' target='_blank' rel='nofollow'>https&#58;//ticket.grid.iu.edu/itb/viewer?id=132</a>
Can these two tickets be merged or linked in some way, so we don&#39;t have to keep two threads for the same problem?

Thanks,
Xin</pre></div><div class='update_description'><i onclick="document.location='9013#1283456527'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2010-09-02T19:42:07+00:00">Sep 2, 2010 07:42 PM UTC</time> by <b>Steven Timm</b><a class="anchor" name="1283456527">&nbsp;</a></div><pre>This is an automatic reply.

I am away from the lab on vacation.
If you have any need of help with FermiGrid please
contact the Service Desk at <a href='http&#58;//servicedesk.fnal.gov' target='_blank' rel='nofollow'>http&#58;//servicedesk.fnal.gov</a>,
(630) 840-2345.  If human contact is necessary, please
contact my supervisor, Keith Chadwick.
I will be checking E-mail intermittently during this time.
I will return to the lab on September 7, 2010

Steve Timm</pre></div><div class='update_description'><i onclick="document.location='9013#1283456437'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2010-09-02T19:40:37+00:00">Sep 2, 2010 07:40 PM UTC</time> by <b>echism</b><a class="anchor" name="1283456437">&nbsp;</a></div><pre>Hi Xin,

This is just a reminder that we are wanting you to look into this ticket. I hope your vacation was relaxing.

Thank you,
Elizabeth</pre></div><div class='update_description'><i onclick="document.location='9013#1281979742'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2010-08-16T17:29:02+00:00">Aug 16, 2010 05:29 PM UTC</time> by <b>echism</b><a class="anchor" name="1281979742">&nbsp;</a></div><pre>I am CCing Xin and setting out the date of this ticket to reflect the aformentoned window.

Thank you,
Elizabeth</pre></div><div class='update_description'><i onclick="document.location='9013#1281979447'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2010-08-16T17:24:07+00:00">Aug 16, 2010 05:24 PM UTC</time> by <b>Mariachi</b><a class="anchor" name="1281979447">&nbsp;</a></div><pre>Hi,

Xin Zhao is going to take the active roll in maintenance of the GUMS RSV
probe. He&#39;s on vacation through the end of August. When he returns he&#39;ll
be getting into this (and a couple other RSV probe issues).

Please be patient.

Cheers,

--john

On 08/12/2010 09&#58;33 AM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='9013#1281620012'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2010-08-12T13:33:32+00:00">Aug 12, 2010 01:33 PM UTC</time> by <b>echism</b><a class="anchor" name="1281620012">&nbsp;</a></div><pre>John,

Can you look into this, please?

Thank you,
Elizabeth</pre></div><div class='update_description'><i onclick="document.location='9013#1280770461'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2010-08-02T17:34:21+00:00">Aug 2, 2010 05:34 PM UTC</time> by <b>Rob Quick</b><a class="anchor" name="1280770461">&nbsp;</a></div><pre>Adding John Hover to this ticket.</pre></div><div class='update_description'><i onclick="document.location='9013#1280770355'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2010-08-02T17:32:35+00:00">Aug 2, 2010 05:32 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1280770355">&nbsp;</a></div><pre>I initially filed this ticket as ITB ticket #132 in November 2009.
I have raised it as a known bug in every ITB meeting before there
has been a release but the bad software was released to production
anyway.  there has been no update since February 2010 and that
was only to change the assignment to Xin Zhao of BNL.  This software
has been in the last several OSG releases broken which makes it
a production issue now, not an ITB issue.

osg-rsv is running as user &#34;rsvuser&#34; on machine
fgitbgkp2, and is also probing fgitbgkp2 using
a proxy /tmp/x509up_u42947 that is owned by rsvuser.
When rsv runs a fork job to fgitbgkp2 this proxy
is mapped to user &#34;fnalgrid&#34; which can&#39;t
read that proxy file. It appears that it is
trying to use that rsv proxy file to then
authenticate to GUMS and get the FQAN-mapfile.

Isn&#39;t there a way that the gums probe could
use the proxy it brings along with it rather
than to try to re-read it once you get there?
In general there should be no assumption that
the rsv proxy would be the same on the remote host
that is being probed, as it is on the machine that
is running RSV.

metricName&#58; org.osg.gums.authorization-status
metricType&#58; status
timestamp&#58; 2009-11-13T15&#58;26&#58;00Z
metricStatus&#58; UNKNOWN
serviceType&#58; OSG-GUMS
serviceURI&#58; fgitbgkp2.fnal.gov
gatheredAt&#58; fgitbgkp2.fnal.gov
summaryData&#58; UNKNOWN
detailsData&#58; ERROR&#58; Could not retrieve site level FQAN mapfile&#58; log4j&#58;WARN No appenders could be found for logger
(org.edg.security.trustmanager.axis.AXISSocketFactory).
<div id='show_1024089037' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_1024089037'>log4j&#58;WARN Please initialize the log4j system properly.
An error occurred when connecting to GUMS&#58; Identity reading failed&#58; /tmp/x509up_u42947 (Permission denied)
EOT

</div><script type='text/javascript'>
        $('#show_1024089037').click(function() {
            $('#detail_1024089037').slideDown("normal");
            $('#show_1024089037').hide();
            $('#hide_1024089037').show();
        });
        $('#hide_1024089037').click(function() {
            $('#detail_1024089037').slideUp();
            $('#hide_1024089037').hide();
            $('#show_1024089037').show();
        });
        </script></pre></div><legend>Similar Recent Tickets <small>modified within the last 30 days</small></legend><div id="similar_tickets"><p class="muted">No similar tickets found.</p></div>
</div>
<script type="text/javascript">
function reset_anchor() {
    $("#updates .selected").removeClass("selected");
    var urls = document.location.toString().split('#'); 
    var anchor = urls[1];
    if(anchor) {
        $("a[name='"+anchor+"']").parents(".update_description").addClass("selected");
    }
}
function submitspam(ticket_id) {
    myret = confirm("Would you like to close this ticket as a security ticket, and submit the ticket content to akismet?");
    if(myret == true) {
        $.ajax("viewer/processspam?id="+ticket_id).done(function() {
            window.location.reload();
        });
    }
}

$(function() {
    reset_anchor();
    var ADDITIONAL_COOKIE_NAME = 'gocticket';
    var options = { path: '/', expires: 365};

    if(window.opener && window.opener.name == "gocticket_list") {
        v = $.cookie("closewindow");
        if(!v) {
            $("#closewindow").attr("checked", "checked"); //on by default
        } else {
            if(v == "checked") {
                $("#closewindow").attr("checked", "checked");
            }
        }
        $("#closewindow").click(function() {
            $.cookie("closewindow", $(this).attr('checked'), options);
        });
    } else {
        $("#closewindow_area").hide();
    }
    function updateTimeago() {
        $("time").timeago();
        setTimeout(updateTimeago, 30*1000);
    }
    updateTimeago();
    $(".description").focus(expand_description);
});
</script>
<hr/>
<footer>
<p>GOC Ticket Version 2.2 | <a href="https://ticket.opensciencegrid.org/goc/submit?app_issue_check=on&amp;app_issue_type=goc&amp;app_goc_url=https%3A%2F%2Fticket.opensciencegrid.org%3A443%2F9013">Report Bugs</a>
 | <a href="https://github.com/opensciencegrid/operations/blob/master/docs/privacy.md">Privacy Policy</a>
</p>

<p> <img align="top" src="images/tag_orange.png"/> Copyright 2018 The Trustees of Indiana University - Developed for Open Science Grid</p>
</footer>


</div><!--container-fluid-->
<script>
//used by searchbox
function parseValue(value) {
    var obj = new Object();
    var tokens = value.split("\t");
    obj.str = tokens[0];
    obj.count = tokens[1];
    return obj;
}

$(function() {
    //bootstrap-2.0.4 stuff
    $(".alert-message").alert();
    $(".dropdown-toggle").dropdown();
    $("span[rel='tooltip']").tooltip();
    $("a[rel=popover]").popover();

    //activate menu that user is currently on
    $("#menu_navigator").addClass("active"); 
    $("#submenu_").addClass("active"); 

    //translate zend validation error message to bootstrap
    $(".errors").addClass("alert").addClass("alert-error");

    //enable autocomplete for search box
    $("#search").autocomplete({
        source: function( request, response ) {
            $.ajax({
                url: "search/autocomplete",
                dataType: "text",
                data: {
                    //featureClass: "P",
                    //style: "full",
                    //maxRows: 12,
                    //name_startsWith: request.term
                    q: request.term
                },
                success: function( data ) {
                    response( $.map( data.split("\n"), function( item ) {
                        if(item == "") return null;
                        return {
                            value: item
                        }
                    }));
                }
            });
        },
        select: function(event, ui) {
            document.location = "search?q="+ui.item.value;
        }
    });
    
});
</script>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-69012-13");
pageTracker._trackPageview();
} catch(err) {}
</script>

</body>
