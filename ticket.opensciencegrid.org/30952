<!DOCTYPE html>
<html lang="en">
  <head>
  <base href="">
    <title>[30952] CE service is in CRITICAL status because No proxy is setup in rsv.conf</title>    <meta charset="utf-8" />
    <meta name="verify-v1" content="na5IcAJsZVOfEkboRxuIiZ1zpZgnZiWra+nKcS7nA/o=" />
    <meta name="google-site-verification" content="DLrk3ft4s8b-S2TloLCL2LD_t6wcTjgSluf5pmiu2kA" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />
    <link href="https://ticket.opensciencegrid.org/rss" rel="alternate" type="application/rss+xml" title="GOC Ticket Update feed" />

    <style type="text/css">
      body {
        padding-top: 50px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
     #search {
            width: 300px;
     }

    </style>

<script src="https://code.jquery.com/jquery-3.0.0.js"></script>
<script src="https://code.jquery.com/jquery-migrate-3.0.1.js"></script>

   <link href="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet"/>
    <script src="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/js/bootstrap.min.js"></script>

    <link href="https://netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"/>
    <link href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/themes/smoothness/jquery-ui.min.css" rel="stylesheet"/>
 <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>


    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/js/select2.min.js"></script>

    <link href="css/ticket.css" rel="stylesheet" />
    <script src="lib/jquery.cookie.js"></script>

    <link href="images/tag_orange.png" rel="icon" type="image/png"/>
    <script src='https://www.google.com/recaptcha/api.js'></script>
  </head>

  <body>
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>

            <a class="brand" style="padding: 6px 0px 0px 6px;" href="http://opensciencegrid.org"><img src="images/osglogo.40x30.png"/></a>
            <ul class="nav">
                <li class="dropdown"><a href="https://ticket.opensciencegrid.org/#" class="dropdown-toggle" data-toggle="dropdown">GOC Ticket <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    <li><a href="https://my.opensciencegrid.org">MyOSG</a></li>
                    <li><a href="https://oim.opensciencegrid.org">OIM</a></li>
                    <li class="active"><a href="https://ticket.opensciencegrid.org/index">Ticket</a></li>
	<li class="divider"></li>
	<li><a href="http://repo.grid.iu.edu">Repo</a></li>
	<li class="divider"></li>
	<li><a href="http://blogs.grid.iu.edu">Blog</a></li>
                    <li><a href="http://display.grid.iu.edu">Display</a></li>
                    <li><a href="http://osggoc.blogspot.com/">News</a></li>
                    </ul>
                </li>
            </ul>
            <ul class="nav pull-right">
                <li><a href="https://ticket.opensciencegrid.org/sso/">Login</a></li>            </ul>

            <div class="nav-collapse">
                <ul class="nav">
			 <li id="menu_submit"><a href="https://ticket.opensciencegrid.org/submit">Submit</a></li><li id="menu_view" class="dropdown"><a href="https://ticket.opensciencegrid.org/\#" class="dropdown-toggle" data-toggle="dropdown">View <b class="caret"></b></a><ul class="dropdown-menu"><li id="submenu_listopen"><a href="https://ticket.opensciencegrid.org/list/open">Open Tickets</a></li><li id="submenu_listrecentclose"><a href="https://ticket.opensciencegrid.org/list/recentclose">Recently Closed Tickets</a></li><li class="divider"></li><li id="submenu_alltickets"><a href="https://ticket.opensciencegrid.org/search?q=&amp;sort=id">All Tickets</a></li></ul></li>                </ul>

                <form class="navbar-search pull-right" action="https://ticket.opensciencegrid.org/viewer">
                    <input id="search" type="text" name="id" class="search-query span2" placeholder="Search Ticket" value=""/>
                </form>
            </div>
        </div>
      </div>
    </div>

<script type='text/javascript' src='lib/jquery.timeago.js'></script>
<script type='text/javascript' src='lib/byte2size.js'></script>
<style>
#updates .toolbar {
position: relative;
margin-top: 0px;
top: -10px;
font-weight: normal;
}
#updates a.anchor {
position: relative;
top: -50px;
}
#updates .selected pre {
animation:selected 2s;
animation-iteration-count: 2;
animation-direction: alternate;
-webkit-animation:selected 2s; 
-webkit-animation-iteration-count: 2;
-webkit-animation-direction: alternate;
box-shadow: inset 1px 1px 20px #9ad;
border: 1px solid #9ab;
margin: 5px 0px;
padding-left: 10px;
}
@keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ab;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
@-webkit-keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ad;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
#updates pre {
background-color: inherit;
line-height: 15px;
padding: 5px;
}
#updates .header {
color: #999;
}
#updates .update_history pre {
background-color: #eee;
color: #666;
font-size: 85%;
}
#updates .clickable {
cursor: pointer;
}
#updates .clickable:hover {
color: #D98719;
}
#updates .meta_information pre {
background-color: #fed;
}
#similar_tickets {
max-height: 300px;
overflow-y: auto;
pointer-events: none;
padding: 5px;
background-color: #f4f4f4;
}
.btn-toolbar {
margin-bottom: 0;
height: 30px;
}
#peers {
position: fixed;
bottom: 0px;
right: 0px;
z-index: 100;
list-style: none;
padding: 5px 0px 0px 5px;
margin: 0px;
background-color: white;
box-shadow: 0px 0px 10px white;
}
#peers li {
background-color: #ccc;
color: #000;
display: inline-block;
padding: 5px 10px;
margin-right: 5px;
position: relative;
}
/*
#peers li:hover {
background-color: #999;
cursor: pointer;
}
*/
#peers span.ip {
padding-left: 5px;
color: #666;
}
#peers .new {
bottom: -30px;
}
/*
#peers .me {
background-color: red;
}
*/
</style>

<div class="container-fluid">
<ul id="peers"></ul>
<div class="alert alert-danger"><a class="close" href="https://ticket.opensciencegrid.org/#" data-dismiss="alert">&times;</a>By the end of May 2018, the ticketing system at https://ticket.opensciencegrid.org will be retired and support will be provided at https://support.opensciencegrid.org. Throughout this transition the support email (help@opensciencegrid.org) will be available as a point of contact.<br><br>                                                   
                                                                                                                                                                                   
Please see the service migration page for details: https://opensciencegrid.github.io/technology/policy/service-migrations-spring-2018/#ticket</div><div id="presence" class="pull-right"></div><div class="ticketgui"><script type="text/javascript" src="lib/checktab.js"></script>

<script>
var expanded = false;
function expand_description() {
    var desc = $(".description");
    if(!expanded) {
        expanded = true;
        //expand to minheight
        var min = 250;
        if(desc.height() < min) {
            desc.animate({height: min}, 200);
        }
    }
}

$(document).ready(function() {
    $("input[name='nad']").datepicker({
        dateFormat: 'yy-mm-dd'
    });
});

</script>



<style>
.form-horizontal .control-label {
padding-top: inherit;
font-size:90%;
color:#666;
}
label {
margin-bottom: 0px;
}
.controls {
line-height: 18px;
}
</style>
<form class="form-horizontal" action="https://ticket.opensciencegrid.org/viewer/updatebasic?id=30952" method="post">
<div class="page-header">
    <h3><span class="muted">30952</span> / CE service is in CRITICAL status because No proxy is setup in rsv.conf</h3>
</div>

<div class="row-fluid">
<div class="span5">
    <legend>Contact</legend>
    <div class="control-group">
        <label class="control-label">Full Name</label>
        <div class="controls">Xizhou Feng</div>
    </div>
    <div class="control-group">
        <label class="control-label">Email</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">Phone</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">CC</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>

    <legend>Details</legend>
    <div class="control-group"><label class="control-label">Resource Name</label><div class="controls">Clemson-Palmetto</div></div><div class="control-group"><label class="control-label">Associated VO</label><div class="controls">OSG</div></div><div class="control-group"><label class="control-label">Submitted Via</label><div class="controls">GOC Ticket/submit</div></div><div class="control-group"><label class="control-label">Submitter</label><div class="controls">Xizhou Feng</div></div><div class="control-group"><label class="control-label">Support Center</label><div class="controls">Community Support Center</div></div><div class="control-group"><label class="control-label">Ticket Links</label><div class="controls"></div></div>
    <div class="control-group">
        <label class="control-label">Ticket Type</label>
        <div class="controls">Problem/Request</div>
    </div>
    <div class="control-group">
        <label class="control-label">Priority</label>
        <div class="controls">Normal</div>
    </div>
    <div class="control-group">
        <label class="control-label">Status</label>
        <div class="controls">
Closed</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action</label>
        <div class="controls">ENG Action</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action Deadline</label>
        <div class="controls flag_red">2016-09-28</div>
    </div>

</div><!--span-->
<div class="span7">
    <legend>Assignees</legend>
    <div class="assignee" style="width: 60%">CSC <span class="muted"> / OSG Support Centers</span></div><div class="assignee" style="width: 60%">Software Support (Triage) <span class="muted"> / OSG Software Team</span></div><div class="assignee" style="width: 60%">Suchandra Thapa <span class="muted"> / OSG Software Team</span></div>    <br>

    <legend>Assignees</legend>
    TODO
    <br>

    <style>
legend.noborder {
border-bottom: none;
}
</style>

<div id="attachment-list"/>
<script>
$(function () {
    var first = true;
    $.getJSON("https://ticket.opensciencegrid.org/attachment/list?id=30952", function (files) {
        //console.dir(files);
        var html = "<table class=\"table table-condensed\">";
        $(files).each(function() {
            if(first) {
                first = false;
                html += "<legend class=\"noborder\">Attachmenets</legend>";
            }
            html += "<tr class=\"attachment\">";
            html += "<td><img src="https://ticket.opensciencegrid.org/\&quot;&quot;+this.thumbnail_url+&quot;\&quot;/"></td>";
            html += "<td><a href="https://ticket.opensciencegrid.org/\&quot;&quot;+this.url+&quot;\&quot;" target=\"_blank\">"+this.name+"</a></td>";
            html += "<td>"+bytesToSize(this.size, 1)+"</td>";
            html += "</tr>";
        });
        html += "</table>";
        $("#attachment-list").html(html);
    });
});

function download(url) {
    window.open(url, "_blank");
}
</script>


</div><!--span-->
</div><!--row-fluid-->


</form>

</div>
<div id="updates" style="clear: both;">
    <legend>Past Updates
    <div class="btn-toolbar pull-right toolbar">
        <div class="btn-group">
                <a class="btn btn-small" href="https://ticket.opensciencegrid.org/30952?sort=up&amp;"><i class="icon-arrow-up"></i> Sort</a>

        
        <a class="btn btn-small" href="https://ticket.opensciencegrid.org/30952?expandall=true&amp;">Expand Descriptions</a>        <a class="btn btn-small" target="_blank" href="mailto:osg@tick.globalnoc.iu.edu?subject=Open%20Science%20Grid%3A%20CE%20service%20is%20in%20CRITICAL%20status%20because%20No%20proxy%20is%20setup%20in%20rsv.conf%20ISSUE%3D30952%20PROJ%3D71"><i class="icon-envelope"></i> Update w/Email</a>
        </div>
    </div><!--btn-toolbar-->
    </legend>

    <div class='update_description'><i onclick="document.location='30952#1474478886'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-09-21T17:28:06+00:00">Sep 21, 2016 05:28 PM UTC</time> by <b>Brian Lin</b><a class="anchor" name="1474478886">&nbsp;</a></div><pre>Awesome, glad to hear it and hanks for being so responsive! I don&#39;t need SSH access to the CE anymore so you can go ahead and drop that.

Cheers,
Brian</pre></div><div class='update_description'><i onclick="document.location='30952#1474478410'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-09-21T17:20:10+00:00">Sep 21, 2016 05:20 PM UTC</time> by <b>xizhouf@....</b><a class="anchor" name="1474478410">&nbsp;</a></div><pre>Thank Brian for pinpoint the probllem. After synchronizing the clock on the NFS server that serves /usr/local, I am able to get results from running the metrics org.osg.general.osg-version. This ticket can be close now.

Thanks,

Xizhou</pre></div><div class='update_description'><i onclick="document.location='30952#1474476250'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-09-21T16:44:10+00:00">Sep 21, 2016 04:44 PM UTC</time> by <b>Brian Lin</b><a class="anchor" name="1474476250">&nbsp;</a></div><pre>Xizhou,

As far as I can tell, the time on osg-ce is fine compared to my own
machines. The times in /usr/local/osg are behind.

- Brian</pre></div><div class='update_description'><i onclick="document.location='30952#1474475711'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-09-21T16:35:11+00:00">Sep 21, 2016 04:35 PM UTC</time> by <b>xizhouf@....</b><a class="anchor" name="1474475711">&nbsp;</a></div><pre>Yes. The directory /usr/local is mounted to an NFS folder. The time difference between osg-ce and the NFS server may explain the strange RSV errors. I will check why ntpd failed to work on osg-ce.

Xizhou</pre></div><div class='update_description'><i onclick="document.location='30952#1474475277'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-09-21T16:27:57+00:00">Sep 21, 2016 04:27 PM UTC</time> by <b>Brian Lin</b><a class="anchor" name="1474475277">&nbsp;</a></div><pre>Xizhou,

/usr/local/osg is a shared FS, right? Is the clock on the shared FS machine off by any chance? I&#39;m looking at the job_queue.log in that folder and it seems to be getting updated about once a second but is always ~10 seconds behind&#58;

[rsv@osg-ce ~]$ stat -c %Y /usr/local/osg/job_queue.log && date +%s
1474475192
1474475204
[rsv@osg-ce ~]$ stat -c %Y /usr/local/osg/job_queue.log && date +%s
1474475192
1474475205
[rsv@osg-ce ~]$ stat -c %Y /usr/local/osg/job_queue.log && date +%s
1474475197
1474475205

Thanks,
Brian</pre></div><div class='update_description'><i onclick="document.location='30952#1474473592'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-09-21T15:59:52+00:00">Sep 21, 2016 03:59 PM UTC</time> by <b>Brian Lin</b><a class="anchor" name="1474473592">&nbsp;</a></div><pre>Alright, I did a lot of poking around this morning and things appear to be mostly good on the RSV end, except for the error we&#39;re getting&#58;

ERROR&#58; Data returned from job not in &#39;brief&#39; format.

I also looked on the CE end and noticed that all the RSV jobs are completing, seemingly successfully, but one thing I noticed is that runtimes are &#60;= 1 second. I&#39;ve noticed from my own testing that there&#39;s this really strange issue with Clemson&#39;s CE where they don&#39;t return output if the jobs run for less than 8 seconds or so. I&#39;m looking into this with the HTCondor folks.</pre></div><div class='update_description'><i onclick="document.location='30952#1474409951'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-09-20T22:19:11+00:00">Sep 20, 2016 10:19 PM UTC</time> by <b>xizhouf@....</b><a class="anchor" name="1474409951">&nbsp;</a></div><pre>Here is the output.

[rsv@osg-ce ~]$ voms-proxy-init --cert=/etc/grid-security/rsv/rsvcert.pem --key=/etc/grid-security/rsv/rsvkey.pem
Your identity&#58; /DC=org/DC=opensciencegrid/O=Open Science Grid/OU=Services/CN=rsv/osg-ce.clemson.edu
Creating proxy ........................................................ Done

Your proxy is valid until Wed Sep 21 06&#58;10&#58;08 2016
[rsv@osg-ce ~]$ condor_ce_ping -verbose WRITE
Remote Version&#58;              $CondorVersion&#58; 8.4.8 Jul 01 2016 $
Local  Version&#58;              $CondorVersion&#58; 8.4.8 Jul 01 2016 $
Session ID&#58;                  osg-ce&#58;128912&#58;1474409435&#58;37877
Instruction&#58;                 WRITE
Command&#58;                     60021
Encryption&#58;                  none
Integrity&#58;                   MD5
Authenticated using&#58;         GSI
All authentication methods&#58;  GSI,FS
Remote Mapping&#58;              rsv@....
Authorized&#58;                  TRUE

On Sep 20, 2016, at 5&#58;37 PM, Open Science Grid FootPrints &#60;osg@....&#62; wrote&#58;

[Duplicate message snipped]</pre></div><div class='update_description'><i onclick="document.location='30952#1474407429'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-09-20T21:37:09+00:00">Sep 20, 2016 09:37 PM UTC</time> by <b>Brian Lin</b><a class="anchor" name="1474407429">&nbsp;</a></div><pre>Could you run the same voms-proxy-init command using the rsv cert and
key then run &#96;condor_ce_ping -verbose WRITE&#96;?

Thanks,
Brian</pre></div><div class='update_description'><i onclick="document.location='30952#1474407070'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-09-20T21:31:10+00:00">Sep 20, 2016 09:31 PM UTC</time> by <b>xizhouf@....</b><a class="anchor" name="1474407070">&nbsp;</a></div><pre>It looks same. Below is the output.

Running metric org.osg.general.osg-version&#58;

INFO&#58; Executing job remotely using Condor-G
INFO&#58; Setting up job environment&#58;
INFO&#58;     No environment setup declared
INFO&#58; Condor-G working directory&#58; /var/tmp/rsv/condor_g-sB6Wda
INFO&#58; Submitting to HTCondor-CE gateway
DEBUG&#58; metric.config_get - no key &#39;htcondor-ce-collector&#39;
DEBUG&#58; metric.config_get - no key &#39;condor-ce-collector&#39;
DEBUG&#58; metric.config_get - no key &#39;htcondor-ce-schedd&#39;
DEBUG&#58; metric.config_get - no key &#39;condor-ce-schedd&#39;
INFO&#58; Forming arguments&#58;
INFO&#58;     Arguments&#58; &#39;[]&#39;
INFO&#58; List of files to transfer&#58; /usr/libexec/rsv/probes/RSVMetric.pm
DEBUG&#58; commands_getstatusoutput&#58; command=&#39;condor_cron_submit /var/tmp/rsv/condor_g-sB6Wda/org.osg.general.osg-version.sub&#39; user=&#39;rsv&#39;
INFO&#58; Condor submission&#58; Submitting job(s).
1 job(s) submitted to cluster 16475.
DEBUG&#58; Condor submission completed&#58; 0 (0)
DEBUG&#58; Condor job cluster ID&#58; 16475
DEBUG&#58; Condor-G submission job ID - 16475
DEBUG&#58; Watching log &#39;/var/tmp/rsv/condor_g-sB6Wda/org.osg.general.osg-version.log&#39; for keywords [return value, error, abort, Globus job submission failed, Detected Down Globus Resource, held].  Timeout is 1200s
DEBUG&#58; Slurping file &#39;/var/tmp/rsv/condor_g-sB6Wda/org.osg.general.osg-version.log&#39;
DEBUG&#58; Slurping file &#39;/var/tmp/rsv/condor_g-sB6Wda/org.osg.general.osg-version.log&#39;
DEBUG&#58; Slurping file &#39;/var/tmp/rsv/condor_g-sB6Wda/org.osg.general.osg-version.log&#39;
DEBUG&#58; Slurping file &#39;/var/tmp/rsv/condor_g-sB6Wda/org.osg.general.osg-version.out&#39;
DEBUG&#58; Slurping file &#39;/var/tmp/rsv/condor_g-sB6Wda/org.osg.general.osg-version.err&#39;
ERROR&#58; Data returned from job not in &#39;brief&#39; format.
Displaying first 10000 bytes of output

STDERR from metric

Xizhou</pre></div><div class='update_description'><i onclick="document.location='30952#1474406712'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-09-20T21:25:12+00:00">Sep 20, 2016 09:25 PM UTC</time> by <b>Brian Lin</b><a class="anchor" name="1474406712">&nbsp;</a></div><pre>Looks better on my end, could you try the rsv commands again?

Thanks,
Brian</pre></div><div class='update_description'><i onclick="document.location='30952#1474406350'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-09-20T21:19:10+00:00">Sep 20, 2016 09:19 PM UTC</time> by <b>xizhouf@....</b><a class="anchor" name="1474406350">&nbsp;</a></div><pre>I just fixed them. Please see if things get better.

Xizhou</pre></div><div class='update_description'><i onclick="document.location='30952#1474405854'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-09-20T21:10:54+00:00">Sep 20, 2016 09:10 PM UTC</time> by <b>Brian Lin</b><a class="anchor" name="1474405854">&nbsp;</a></div><pre>I see this error&#58;

globus_sysconfig&#58; File is not owned by current user&#58; /etc/grid-security/hostcert.pem is not owned by current user

Do /etc/grid-security/host{cert,key}.pem and /etc/grid-security/rsv/rsv{cert,key}.pem have the right permissions? The certs should be chmod 444 and the keys chmod 400. The host cert/key should be owned by root and the rsv cert/key should be owned by the rsv user, iirc. Ensure they&#39;re correct and restart the condor-ce service.</pre></div><div class='update_description'><i onclick="document.location='30952#1474405095'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-09-20T20:58:15+00:00">Sep 20, 2016 08:58 PM UTC</time> by <b>xizhouf@....</b><a class="anchor" name="1474405095">&nbsp;</a></div><pre>Hi Brian,

I put the files at&#58; <a href='https&#58;//www.palmetto.clemson.edu/xdmod/public/cert-logs/.' target='_blank' rel='nofollow'>https&#58;//www.palmetto.clemson.edu/xdmod/public/cert-logs/.</a> Please let me know if you see any problem.

Thanks,

Xizhou</pre></div><div class='update_description'><i onclick="document.location='30952#1474404255'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-09-20T20:44:15+00:00">Sep 20, 2016 08:44 PM UTC</time> by <b>Brian Lin</b><a class="anchor" name="1474404255">&nbsp;</a></div><pre>Xizhou,

Things look pretty bad, I can&#39;t seem to submit jobs to your CE becaus eof the following error&#58;

GSI&#58;5002&#58;Failed to authenticate because the remote (server) side was not able to acquire its credentials.

Could you run the following commands and attach your /var/log/condor-ce/{Collector,Master}Log?

openssl x509 -in /etc/grid-security/hostcert.pem -nout -text
openssl x509 -in /etc/grid-security/rsv/rsvcert.pem -nout -text

Thanks,
Brian</pre></div><div class='update_description'><i onclick="document.location='30952#1474395011'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-09-20T18:10:11+00:00">Sep 20, 2016 06:10 PM UTC</time> by <b>xizhouf@....</b><a class="anchor" name="1474395011">&nbsp;</a></div><pre>Thank you, Brian.

I updated the certificate but another problem arises. The error message complains that Globus Resource is not up. The entire debug from rsv-control is as follows.

[root@osg-ce condor-cron]# rsv-control --run --host osg-ce.clemson.edu --verbose 3 --ce-typ=htcondor-ce org.osg.general.osg-version
INFO&#58; Reading configuration file /etc/rsv/rsv.conf
INFO&#58; Reading configuration file /etc/rsv/consumers.conf
INFO&#58; Validating configuration&#58;
INFO&#58; Validating user&#58;
INFO&#58;     Invoked as root.  Switching to &#39;rsv&#39; user (uid&#58; 515 - gid&#58; 94175)
INFO&#58; Registered consumers&#58; html-consumer, gratia-consumer
INFO&#58; Loading config file &#39;/etc/rsv/meta/metrics/org.osg.general.osg-version.meta&#39;
INFO&#58; Loading config file &#39;/etc/rsv/metrics/org.osg.general.osg-version.conf&#39;
INFO&#58; Loading config file &#39;/etc/rsv/metrics/osg-ce.clemson.edu/allmetrics.conf&#39;
DEBUG&#58; Setting option &#39;ce-type&#39; for section &#39;org.osg.general.osg-version&#39; to &#39;htcondor-ce&#39; (from allmetrics section)
INFO&#58; Optional config file &#39;/etc/rsv/metrics/osg-ce.clemson.edu/org.osg.general.osg-version.conf&#39; does not exist
INFO&#58; Checking proxy&#58;
INFO&#58;     Using service certificate proxy
INFO&#58; Running command with timeout (1200 seconds)&#58;
/usr/bin/openssl x509 -in /tmp/rsvproxy -noout -enddate -checkend 21600
INFO&#58; Exit code of job&#58; 0
INFO&#58;     Service certificate valid for at least 6 hours.
DEBUG&#58; metric.config_getboolean - no key &#39;no-ping&#39;
INFO&#58; Pinging host osg-ce.clemson.edu&#58;
INFO&#58; Running command with timeout (1200 seconds)&#58;
/bin/ping -W 3 -c 1 osg-ce.clemson.edu
INFO&#58; Exit code of job&#58; 0
INFO&#58;     Ping successful
Running metric org.osg.general.osg-version&#58;

INFO&#58; Executing job remotely using Condor-G
INFO&#58; Setting up job environment&#58;
INFO&#58;     No environment setup declared
INFO&#58; Condor-G working directory&#58; /var/tmp/rsv/condor_g-IfLufZ
INFO&#58; Submitting to HTCondor-CE gateway
<div id='show_1594226427' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_1594226427'>DEBUG&#58; metric.config_get - no key &#39;htcondor-ce-collector&#39;
DEBUG&#58; metric.config_get - no key &#39;condor-ce-collector&#39;
DEBUG&#58; metric.config_get - no key &#39;htcondor-ce-schedd&#39;
DEBUG&#58; metric.config_get - no key &#39;condor-ce-schedd&#39;
INFO&#58; Forming arguments&#58;
INFO&#58;     Arguments&#58; &#39;[]&#39;
INFO&#58; List of files to transfer&#58; /usr/libexec/rsv/probes/RSVMetric.pm
DEBUG&#58; commands_getstatusoutput&#58; command=&#39;condor_cron_submit /var/tmp/rsv/condor_g-IfLufZ/org.osg.general.osg-version.sub&#39; user=&#39;rsv&#39;
INFO&#58; Condor submission&#58; Submitting job(s).
1 job(s) submitted to cluster 16470.
DEBUG&#58; Condor submission completed&#58; 0 (0)
DEBUG&#58; Condor job cluster ID&#58; 16470
DEBUG&#58; Condor-G submission job ID - 16470
DEBUG&#58; Watching log &#39;/var/tmp/rsv/condor_g-IfLufZ/org.osg.general.osg-version.log&#39; for keywords [return value, error, abort, Globus job submission failed, Detected Down Globus Resource, held].  Timeout is 1200s
DEBUG&#58; Slurping file &#39;/var/tmp/rsv/condor_g-IfLufZ/org.osg.general.osg-version.log&#39;
DEBUG&#58; Slurping file &#39;/var/tmp/rsv/condor_g-IfLufZ/org.osg.general.osg-version.log&#39;
DEBUG&#58; Slurping file &#39;/var/tmp/rsv/condor_g-IfLufZ/org.osg.general.osg-version.log&#39;
DEBUG&#58; Slurping file &#39;/var/tmp/rsv/condor_g-IfLufZ/org.osg.general.osg-version.out&#39;
DEBUG&#58; Slurping file &#39;/var/tmp/rsv/condor_g-IfLufZ/org.osg.general.osg-version.err&#39;
ERROR&#58; Data returned from job not in &#39;brief&#39; format.
Displaying first 10000 bytes of output

STDERR from metric&#58;

Xizhou
</div><script type='text/javascript'>
        $('#show_1594226427').click(function() {
            $('#detail_1594226427').slideDown("normal");
            $('#show_1594226427').hide();
            $('#hide_1594226427').show();
        });
        $('#hide_1594226427').click(function() {
            $('#detail_1594226427').slideUp();
            $('#hide_1594226427').hide();
            $('#show_1594226427').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='30952#1474390901'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-09-20T17:01:41+00:00">Sep 20, 2016 05:01 PM UTC</time> by <b>Brian Lin</b><a class="anchor" name="1474390901">&nbsp;</a></div><pre>Xizhou,

This is happening because your /etc/condor-ce/condor_mapfile is matching this line&#58;

GSI &#34;^&#92;/DC&#92;=org&#92;/DC&#92;=opensciencegrid&#92;/O=Open Science Grid&#92;/OU&#92;=Services&#92;/CN&#92;=(host&#92;/)?([A-Za-z0-9.&#92;-]*)$&#34; &#92;2@....

To fix this, do the following&#58;

1. You should request a service certificate [1]&#58; osg-gridadmin-cert-request --hostname rsv/osg-ce.clemson.edu
2. Place the cert/key in /etc/grid-security/rsv/rsv{cert,key}.pem
3. Add &#39;&#34;/DC=org/DC=opensciencegrid/O=Open Science Grid/OU=Services/CN=rsv/osg-ce.clemson.edu&#34; rsv&#39; to /etc/grid-security/local-grid-mapfile [2]
4. Add &#34;gmf_local /etc/grid-security/local-grid-mapfile&#34; to /etc/edg-mkgridmap.conf
5. Run &#96;edg-mkgridmap&#96;

- Brian

[1] <a href='https&#58;//twiki.grid.iu.edu/bin/view/Documentation/Release3/GetHostServiceCertificates' target='_blank' rel='nofollow'>https&#58;//twiki.grid.iu.edu/bin/view/Documentation/Release3/GetHostServiceCertificates</a>
[2] <a href='https&#58;//twiki.grid.iu.edu/bin/view/Documentation/Release3/Edg-mkgridmap#3_0_Configuration' target='_blank' rel='nofollow'>https&#58;//twiki.grid.iu.edu/bin/view/Documentation/Release3/Edg-mkgridmap#3_0_Configuration</a></pre></div><div class='update_description'><i onclick="document.location='30952#1474324284'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-09-19T22:31:24+00:00">Sep 19, 2016 10:31 PM UTC</time> by <b>echism</b><a class="anchor" name="1474324284">&nbsp;</a></div><pre>Software,

Any updates on this one?

Thank you</pre></div><div class='update_description'><i onclick="document.location='30952#1474030879'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-09-16T13:01:19+00:00">Sep 16, 2016 01:01 PM UTC</time> by <b>xizhouf@....</b><a class="anchor" name="1474030879">&nbsp;</a></div><pre>All these files are from osg-ce.clemson.edu.

The problem is due to GSI authentication, which could be caused by the new OSG service key issuing mechanism. Last year, the service key’s DN always include service_name/host_name as CN, now the key doesn’t have the service name.

1.       Related portion of the grid-mapfile as below.
$ cat /etc/grid-security/grid-mapfile | grep rsv
&#34;/DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=Service/CN=rsv/fermicloud053.fnal.gov&#34; mis
&#34;/DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=Services/CN=rsv/fermicloud053.fnal.gov&#34; mis
&#34;/DC=org/DC=opensciencegrid/O=Open Science Grid/OU=Services/CN=osg-ce.clemson.edu&#34; rsv
&#34;/DC=org/DC=opensciencegrid/O=Open Science Grid/OU=Services/CN=rsv/fermicloud053.fnal.gov&#34; osg

2.       Output from manually run a metrics
[rsv@osg-ce ~]$ rsv-control --verbose 3 --run --host osg-ce org.osg.general.osg-version
INFO&#58; Reading configuration file /etc/rsv/rsv.conf
INFO&#58; Reading configuration file /etc/rsv/consumers.conf
INFO&#58; Validating configuration&#58;
INFO&#58; Validating user&#58;
INFO&#58;     Invoked as the RSV user (rsv)
INFO&#58; Registered consumers&#58; html-consumer, gratia-consumer
INFO&#58; Loading config file &#39;/etc/rsv/meta/metrics/org.osg.general.osg-version.meta&#39;
INFO&#58; Loading config file &#39;/etc/rsv/metrics/org.osg.general.osg-version.conf&#39;
DEBUG&#58; Config file &#39;/etc/rsv/metrics/osg-ce/allmetrics.conf&#39; does not exist
INFO&#58; Optional config file &#39;/etc/rsv/metrics/osg-ce/org.osg.general.osg-version.conf&#39; does not exist
INFO&#58; Checking proxy&#58;
INFO&#58;     Using service certificate proxy
INFO&#58; Running command with timeout (1200 seconds)&#58;
/usr/bin/openssl x509 -in /tmp/rsvproxy -noout -enddate -checkend 21600
INFO&#58; Exit code of job&#58; 0
INFO&#58;     Service certificate valid for at least 6 hours.
DEBUG&#58; metric.config_getboolean - no key &#39;no-ping&#39;
INFO&#58; Pinging host osg-ce&#58;
INFO&#58; Running command with timeout (1200 seconds)&#58;
/bin/ping -W 3 -c 1 osg-ce
INFO&#58; Exit code of job&#58; 0
INFO&#58;     Ping successful
<div id='show_1797515654' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_1797515654'>
Running metric org.osg.general.osg-version&#58;

INFO&#58; Executing job remotely using Condor-G
INFO&#58; Setting up job environment&#58;
INFO&#58;     No environment setup declared
INFO&#58; Condor-G working directory&#58; /var/tmp/rsv/condor_g-n6jsfT
DEBUG&#58; metric.config_get - no key &#39;ce-type&#39;
DEBUG&#58; metric.config_get - no key &#39;gatekeeper-type&#39;
INFO&#58; Submitting to HTCondor-CE gateway
DEBUG&#58; metric.config_get - no key &#39;htcondor-ce-collector&#39;
DEBUG&#58; metric.config_get - no key &#39;condor-ce-collector&#39;
DEBUG&#58; metric.config_get - no key &#39;htcondor-ce-schedd&#39;
DEBUG&#58; metric.config_get - no key &#39;condor-ce-schedd&#39;
INFO&#58; Forming arguments&#58;
INFO&#58;     Arguments&#58; &#39;[]&#39;
INFO&#58; List of files to transfer&#58; /usr/libexec/rsv/probes/RSVMetric.pm
DEBUG&#58; commands_getstatusoutput&#58; command=&#39;condor_cron_submit /var/tmp/rsv/condor_g-n6jsfT/org.osg.general.osg-version.sub&#39; user=&#39;rsv&#39;
INFO&#58; Condor submission&#58; Submitting job(s).
1 job(s) submitted to cluster 16362.
DEBUG&#58; Condor submission completed&#58; 0 (0)
DEBUG&#58; Condor job cluster ID&#58; 16362
DEBUG&#58; Condor-G submission job ID - 16362
DEBUG&#58; Watching log &#39;/var/tmp/rsv/condor_g-n6jsfT/org.osg.general.osg-version.log&#39; for keywords [return value, error, abort, Globus job submission failed, Detected Down Globus Resource, held].  Timeout is 1200s
DEBUG&#58; Slurping file &#39;/var/tmp/rsv/condor_g-n6jsfT/org.osg.general.osg-version.log&#39;
DEBUG&#58; Slurping file &#39;/var/tmp/rsv/condor_g-n6jsfT/org.osg.general.osg-version.log&#39;
INFO&#58; Stopping all metrics with constraint &#39;ClusterId==16362&#39;
DEBUG&#58; commands_getstatusoutput&#58; command=&#39;condor_cron_q&#39; user=&#39;None&#39;
DEBUG&#58; Condor is running.  Output of condor_cron_q&#58;

-- Schedd&#58; osg-ce.clemson.edu &#58; &#60;127.0.0.1&#58;52777?...
ID      OWNER            SUBMITTED     RUN_TIME ST PRI SIZE CMD
14766.0   rsv             8/22 09&#58;52   8+09&#58;31&#58;51 I  0   97.7 rsv-control -v 3 -
14767.0   rsv             8/22 09&#58;52   3+06&#58;22&#58;49 I  0   195.3 rsv-control -v 3 -
14773.0   rsv             8/22 09&#58;52  24+22&#58;41&#58;31 R  0   0.0  html-consumer
14774.0   rsv             8/22 09&#58;52  24+22&#58;42&#58;15 R  0   0.0  gratia-consumer
16362.0   rsv             9/16 08&#58;47   0+00&#58;00&#58;00 H  0   0.0  org.osg.general.os

5 jobs; 0 completed, 0 removed, 2 idle, 2 running, 1 held, 0 suspended
DEBUG&#58; Getting Condor classads with constraint &#39;ClusterId==16362&#39;
DEBUG&#58; commands_getstatusoutput&#58; command=&#39;condor_cron_q&#39; user=&#39;None&#39;
DEBUG&#58; Condor is running.  Output of condor_cron_q&#58;

-- Schedd&#58; osg-ce.clemson.edu &#58; &#60;127.0.0.1&#58;52777?...
ID      OWNER            SUBMITTED     RUN_TIME ST PRI SIZE CMD
14766.0   rsv             8/22 09&#58;52   8+09&#58;31&#58;51 I  0   97.7 rsv-control -v 3 -
14767.0   rsv             8/22 09&#58;52   3+06&#58;22&#58;49 I  0   195.3 rsv-control -v 3 -
14773.0   rsv             8/22 09&#58;52  24+22&#58;41&#58;31 R  0   0.0  html-consumer
14774.0   rsv             8/22 09&#58;52  24+22&#58;42&#58;15 R  0   0.0  gratia-consumer
16362.0   rsv             9/16 08&#58;47   0+00&#58;00&#58;00 H  0   0.0  org.osg.general.os

5 jobs; 0 completed, 0 removed, 2 idle, 2 running, 1 held, 0 suspended
DEBUG&#58; commands_getstatusoutput&#58; command=&#39;condor_cron_q -l -constraint &#39;ClusterId==16362&#39;&#39; user=&#39;None&#39;
DEBUG&#58; commands_getstatusoutput&#58; command=&#39;condor_cron_rm -constraint &#39;ClusterId==16362&#39;&#39; user=&#39;None&#39;
DEBUG&#58; Slurping file &#39;/var/tmp/rsv/condor_g-n6jsfT/org.osg.general.osg-version.log&#39;
DEBUG&#58; In brief_result()
INFO&#58; Trimming data to 10000 bytes because details-data-trim-length is set
DEBUG&#58; STDERR from metric&#58;

INFO&#58; Result&#58;

metricName&#58; org.osg.general.osg-version
metricType&#58; status
timestamp&#58; 2016-09-16 08&#58;47&#58;53 EDT
metricStatus&#58; CRITICAL
serviceType&#58; OSG-CE
serviceURI&#58; osg-ce
gatheredAt&#58; osg-ce.clemson.edu
summaryData&#58; CRITICAL
detailsData&#58; Condor-G submission failed the job went on hold.
Check the log and the hold reason.

Log&#58;
000 (16362.000.000) 09/16 08&#58;47&#58;02 Job submitted from host&#58; &#60;127.0.0.1&#58;52777?addrs=127.0.0.1-52777&#62;
...
012 (16362.000.000) 09/16 08&#58;47&#58;44 Job was held.
ERROR&#58; Failed to submit job.
Code 0 Subcode 0
...
009 (16362.000.000) 09/16 08&#58;47&#58;53 Job was aborted by the user.
via condor_rm (by user rsv)
...

EOT

DEBUG&#58; Validating directory &#39;/var/spool/rsv/html-consumer&#39;
DEBUG&#58;     Directory &#39;/var/spool/rsv/html-consumer&#39; already exists
DEBUG&#58;     Directory &#39;/var/spool/rsv/html-consumer&#39; is writable
INFO&#58; Creating record for html-consumer consumer at &#39;/var/spool/rsv/html-consumer/org.osg.general.osg-version.BIQqXV&#39;
DEBUG&#58; Validating directory &#39;/var/spool/rsv/gratia-consumer&#39;
DEBUG&#58;     Directory &#39;/var/spool/rsv/gratia-consumer&#39; already exists
DEBUG&#58;     Directory &#39;/var/spool/rsv/gratia-consumer&#39; is writable
INFO&#58; Creating record for gratia-consumer consumer at &#39;/var/spool/rsv/gratia-consumer/org.osg.general.osg-version.Pzn1C4&#39;
---------------------------------------------------------------------

Please let me know if you need further information.

Thanks,

Xizhou
</div><script type='text/javascript'>
        $('#show_1797515654').click(function() {
            $('#detail_1797515654').slideDown("normal");
            $('#show_1797515654').hide();
            $('#hide_1797515654').show();
        });
        $('#hide_1797515654').click(function() {
            $('#detail_1797515654').slideUp();
            $('#hide_1797515654').hide();
            $('#show_1797515654').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='30952#1473972173'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-09-15T20:42:53+00:00">Sep 15, 2016 08:42 PM UTC</time> by <b>Suchandra Thapa</b><a class="anchor" name="1473972173">&nbsp;</a></div><pre>Hi,

Are those all the files from osg-ce.clemson.edu?  I don&#39;t see anything obvious in the file. It looks like your schedd is running into issues with authenticating RSV based on it&#39;s DN.  Can you provide  your current /etc/grid-security/grid-mapfile file?

Also, can you enabled debugging in Condor and then run the test (e.g. org.osg.general.osg-version ) manually using rsv-control to get more detailed logs regarding the error?

Suchandra</pre></div><div class='update_description'><i onclick="document.location='30952#1473789226'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-09-13T17:53:46+00:00">Sep 13, 2016 05:53 PM UTC</time><a class="anchor" name="1473789226">&nbsp;</a></div><pre>I was unable to load the files through the GOC ticket web interface. As I workaround, I put the files at&#58; <a href='https&#58;//www.palmetto.clemson.edu/xdmod/public/logs-for-rsv/' target='_blank' rel='nofollow'>https&#58;//www.palmetto.clemson.edu/xdmod/public/logs-for-rsv/</a> . Please let me know if you are able to access it.

Thanks,

Xizhou

by /DC=org/DC=opensciencegrid/O=Open Science Grid/OU=People/CN=Xizhou Feng 3402</pre></div><div class='update_description'><i onclick="document.location='30952#1473457450'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-09-09T21:44:10+00:00">Sep 9, 2016 09:44 PM UTC</time> by <b>xizhouf@....</b><a class="anchor" name="1473457450">&nbsp;</a></div><pre>I tried to upload through the potal before, but it said the file format is not supported.

Xizhou

<font color='#7F7E6F'>&#62; On Sep 9, 2016, at 5&#58;19 PM, Open Science Grid FootPrints &#60;osg@....&#62; wrote&#58;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='30952#1473455953'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-09-09T21:19:13+00:00">Sep 9, 2016 09:19 PM UTC</time> by <b>echism</b><a class="anchor" name="1473455953">&nbsp;</a></div><pre>Xizhou,

Did you send them by email? I don&#39;t see them. Email attachments don&#39;t work.

Try the attach files button here
<a href='https&#58;//ticket.grid.iu.edu/30952' target='_blank' rel='nofollow'>https&#58;//ticket.grid.iu.edu/30952</a></pre></div><div class='update_description'><i onclick="document.location='30952#1473267018'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-09-07T16:50:18+00:00">Sep 7, 2016 04:50 PM UTC</time> by <b>xizhouf@....</b><a class="anchor" name="1473267018">&nbsp;</a></div><pre>I attached the logs from both condor-ce and condor-cron. Please let me know if you need other logs.

Thanks,

Xizhou</pre></div><div class='update_description'><i onclick="document.location='30952#1473264935'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-09-07T16:15:35+00:00">Sep 7, 2016 04:15 PM UTC</time> by <b>Suchandra Thapa</b><a class="anchor" name="1473264935">&nbsp;</a></div><pre>The log files from condor-ce .  At the least, the MasterLog and SchedLog, but the other files may be useful.</pre></div><div class='update_description'><i onclick="document.location='30952#1473258015'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-09-07T14:20:15+00:00">Sep 7, 2016 02:20 PM UTC</time> by <b>xizhouf@....</b><a class="anchor" name="1473258015">&nbsp;</a></div><pre>Hi Suchandra,

Which condor log files do you need? The log files or condor-cron or condor-ce?

Xizhou</pre></div><div class='update_description'><i onclick="document.location='30952#1473197682'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-09-06T21:34:42+00:00">Sep 6, 2016 09:34 PM UTC</time> by <b>echism</b><a class="anchor" name="1473197682">&nbsp;</a></div><pre>Xizhou,

Did you get that request to send along your condor logfiles?

Thank you</pre></div><div class='update_description'><i onclick="document.location='30952#1473197028'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-09-06T21:23:48+00:00">Sep 6, 2016 09:23 PM UTC</time> by <b>Suchandra Thapa</b><a class="anchor" name="1473197028">&nbsp;</a></div><pre>Hi Xizhou,

Sorry about the delay in replying.  That&#39;s really odd.  Can you send me your condor log files?  (you can attach them to this ticket)

Suchandra</pre></div><div class='update_description'><i onclick="document.location='30952#1473196081'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-09-06T21:08:01+00:00">Sep 6, 2016 09:08 PM UTC</time> by <b>echism</b><a class="anchor" name="1473196081">&nbsp;</a></div><pre>Software,

Please update this ticket.</pre></div><div class='update_description'><i onclick="document.location='30952#1472677968'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-08-31T21:12:48+00:00">Aug 31, 2016 09:12 PM UTC</time> by <b>echism</b><a class="anchor" name="1472677968">&nbsp;</a></div><pre>Software,

Is there anything new on this?

Thank you</pre></div><div class='update_description'><i onclick="document.location='30952#1472228772'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-08-26T16:26:12+00:00">Aug 26, 2016 04:26 PM UTC</time> by <b>xizhouf@....</b><a class="anchor" name="1472228772">&nbsp;</a></div><pre>Out HTCondor-CE is working fine. I see new jobs coming in and running as well as the output from my own user and rsv user.

$ condor_ce_ping -verbose -name osg-ce.clemson.edu -pool osg-ce.clemson.edu&#58;9619 WRITE
Remote Version&#58;              $CondorVersion&#58; 8.4.8 Jul 01 2016 $
Local  Version&#58;              $CondorVersion&#58; 8.4.8 Jul 01 2016 $
Session ID&#58;                  osg-ce&#58;2663428&#58;1472228361&#58;15047
Instruction&#58;                 WRITE
Command&#58;                     60021
Encryption&#58;                  none
Integrity&#58;                   MD5
Authenticated using&#58;         GSI
All authentication methods&#58;  GSI,FS
Remote Mapping&#58;              osg@....
Authorized&#58;                  TRUE

[rsv@osg-ce ~]$ voms-proxy-init -key /etc/grid-security/rsv/rsvkey.pem -cert /etc/grid-security/rsv/rsvcert.pem
Your identity&#58; /DC=org/DC=opensciencegrid/O=Open Science Grid/OU=Services/CN=osg-ce.clemson.edu
Creating proxy .................................................................................................................................... Done

Your proxy is valid until Sat Aug 27 00&#58;22&#58;45 2016
[rsv@osg-ce ~]$ condor_ce_ping -verbose -name osg-ce.clemson.edu -pool osg-ce.clemson.edu&#58;9619 WRITE
Remote Version&#58;              $CondorVersion&#58; 8.4.8 Jul 01 2016 $
Local  Version&#58;              $CondorVersion&#58; 8.4.8 Jul 01 2016 $
Session ID&#58;                  osg-ce&#58;2663428&#58;1472228578&#58;15048
Instruction&#58;                 WRITE
Command&#58;                     60021
Encryption&#58;                  none
Integrity&#58;                   MD5
Authenticated using&#58;         GSI
All authentication methods&#58;  GSI,FS
Remote Mapping&#58;              osg-ce.clemson.edu@....
Authorized&#58;                  TRUE

Xizhou</pre></div><div class='update_description'><i onclick="document.location='30952#1472227478'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-08-26T16:04:38+00:00">Aug 26, 2016 04:04 PM UTC</time> by <b>Suchandra Thapa</b><a class="anchor" name="1472227478">&nbsp;</a></div><pre>Can you check to see if your HTCondor-CE instance is receiving jobs and handling them correctly?  E.g. if you run  condor_ce_ping -verbose -name condorce.example.com -pool condorce.example.com&#58;9619 WRITE
what do you see?</pre></div><div class='update_description'><i onclick="document.location='30952#1472154612'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-08-25T19:50:12+00:00">Aug 25, 2016 07:50 PM UTC</time> by <b>xizhouf@....</b><a class="anchor" name="1472154612">&nbsp;</a></div><pre>I made the change but still received the same error.

metricName&#58; org.osg.general.vo-supported
metricType&#58; status
timestamp&#58; 2016-08-25 15&#58;43&#58;52 EDT
metricStatus&#58; CRITICAL
serviceType&#58; OSG-CE
serviceURI&#58; osg-ce.clemson.edu
gatheredAt&#58; osg-ce.clemson.edu
summaryData&#58; CRITICAL
detailsData&#58; Condor-G submission failed the job went on hold.
Check the log and the hold reason.

Log&#58;
000 (14989.000.000) 08/25 15&#58;43&#58;01 Job submitted from host&#58; &#60;127.0.0.1&#58;60594?addrs=127.0.0.1-60594&#62;
...
012 (14989.000.000) 08/25 15&#58;43&#58;48 Job was held.
Error connecting to schedd osg-ce.clemson.edu&#58; SECMAN&#58;2010&#58;Received &#34;DENIED&#34; from server for user osg-ce.clemson.edu@.... using method GSI.
Code 0 Subcode 0
...

EOT

Xizhou</pre></div><div class='update_description'><i onclick="document.location='30952#1472153569'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-08-25T19:32:49+00:00">Aug 25, 2016 07:32 PM UTC</time> by <b>Suchandra Thapa</b><a class="anchor" name="1472153569">&nbsp;</a></div><pre>Hi,

The correct settings in rsv.conf are

service-cert
service-key

Could you look at your condor log files and see if your certificate is being denied?  When you renewed your rsv certificate, the DN may have changed due to a different issuer, can you check your authorization system to see if the new DN is still being accepted?

Suchandra</pre></div><div class='update_description'><i onclick="document.location='30952#1471982350'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-08-23T19:59:10+00:00">Aug 23, 2016 07:59 PM UTC</time> by <b>xizhouf@....</b><a class="anchor" name="1471982350">&nbsp;</a></div><pre>Yes, though grid-proxy-info needs the “-f” option.

[rsv@osg-ce ~]$ grid-proxy-info -f /tmp/rsvproxy
subject  &#58; /DC=org/DC=opensciencegrid/O=Open Science Grid/OU=Services/CN=osg-ce.clemson.edu/CN=204035466
issuer   &#58; /DC=org/DC=opensciencegrid/O=Open Science Grid/OU=Services/CN=osg-ce.clemson.edu
identity &#58; /DC=org/DC=opensciencegrid/O=Open Science Grid/OU=Services/CN=osg-ce.clemson.edu
type     &#58; RFC 3820 compliant impersonation proxy
strength &#58; 1024 bits
path     &#58; /tmp/rsvproxy
timeleft &#58; 10&#58;35&#58;21

[rsv@osg-ce ~]$ ls -al /tmp/rsvproxy
-rw------- 1 rsv osg 3657 Aug 23 14&#58;31 /tmp/rsvproxy</pre></div><div class='update_description'><i onclick="document.location='30952#1471981453'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-08-23T19:44:13+00:00">Aug 23, 2016 07:44 PM UTC</time> by <b>Suchandra Thapa</b><a class="anchor" name="1471981453">&nbsp;</a></div><pre>Can you run grid-proxy-info /tmp/rsvproxy and do a ls -l /tmp/rsvproxy ?

Suchandra
OSG Software Team</pre></div><div class='update_description'><i onclick="document.location='30952#1471966332'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-08-23T15:32:12+00:00">Aug 23, 2016 03:32 PM UTC</time> by <b>xizhouf@....</b><a class="anchor" name="1471966332">&nbsp;</a></div><pre>Yes. It is accessible.

Xizhou</pre></div><div class='update_description'><i onclick="document.location='30952#1471964904'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-08-23T15:08:24+00:00">Aug 23, 2016 03:08 PM UTC</time> by <b>echism</b><a class="anchor" name="1471964904">&nbsp;</a></div><pre>Well, one more. Is /tmp inaccessible? If that&#39;s not it, I&#39;m stumped.</pre></div><div class='update_description'><i onclick="document.location='30952#1471964808'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-08-23T15:06:48+00:00">Aug 23, 2016 03:06 PM UTC</time> by <b>echism</b><a class="anchor" name="1471964808">&nbsp;</a></div><pre>Software team, any thoughts?

The error is No proxy is setup in rsv.conf.
To use a service certificate (recommended), set the following variables&#58;
service_cert, service_key, service_proxy

I&#39;ve checked everything I can think of, so I would appreciate the assistance.

Thank you</pre></div><div class='update_description'><i onclick="document.location='30952#1471963810'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-08-23T14:50:10+00:00">Aug 23, 2016 02:50 PM UTC</time> by <b>xizhouf@....</b><a class="anchor" name="1471963810">&nbsp;</a></div><pre>Yes. Here is the output.

$ grid-proxy-init -cert /etc/grid-security/rsv/rsvcert.pem -key /etc/grid-security/rsv/rsvkey.pem
Your identity&#58; /DC=org/DC=opensciencegrid/O=Open Science Grid/OU=Services/CN=osg-ce.clemson.edu
Creating proxy .................................................... Done
Your proxy is valid until&#58; Tue Aug 23 22&#58;49&#58;28 2016</pre></div><div class='update_description'><i onclick="document.location='30952#1471963668'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-08-23T14:47:48+00:00">Aug 23, 2016 02:47 PM UTC</time> by <b>echism</b><a class="anchor" name="1471963668">&nbsp;</a></div><pre>Xizhou,

Are you able to run the following command (from the rsv user)?
grid-proxy-init -cert /etc/grid-security/rsv/rsvcert.pem -key /etc/grid-security/rsv/rsvkey.pem

Thank you</pre></div><div class='update_description'><i onclick="document.location='30952#1471956611'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-08-23T12:50:11+00:00">Aug 23, 2016 12:50 PM UTC</time> by <b>xizhouf@....</b><a class="anchor" name="1471956611">&nbsp;</a></div><pre>Below is the file. I added the line 5-7 because some OSG documents use service-cert and some use service_cert.

1 [rsv]
2 service-cert = /etc/grid-security/rsv/rsvcert.pem
3 service-key = /etc/grid-security/rsv/rsvkey.pem
4 service-proxy = /tmp/rsvproxy
5 service_cert = /etc/grid-security/rsv/rsvcert.pem
6 service_key = /etc/grid-security/rsv/rsvkey.pem
7 service_proxy = /tmp/rsvproxy
8 job-timeout = 1200
9 ce-type = htcondor-ce
10 user = rsv
11 use-condor-g = True

The ‘permission denied error’ may have something with the authorization configuration in condor-ce.

Xizhou</pre></div><div class='update_description'><i onclick="document.location='30952#1471925182'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-08-23T04:06:22+00:00">Aug 23, 2016 04:06 AM UTC</time> by <b>echism</b><a class="anchor" name="1471925182">&nbsp;</a></div><pre>Can you send me the contents of /etc/rsv/rsv.conf?

Thank you</pre></div><div class='update_description'><i onclick="document.location='30952#1471908189'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-08-22T23:23:09+00:00">Aug 22, 2016 11:23 PM UTC</time> by <b>xizhouf@....</b><a class="anchor" name="1471908189">&nbsp;</a></div><pre>The cert is stored at /etc/grid-security/rsv/rsvcert.pem.

Xizhou

<font color='#7F7E6F'>&#62; On Aug 22, 2016, at 4&#58;58 PM, Open Science Grid FootPrints &#60;osg@....&#62; wrote&#58;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='30952#1471899530'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-08-22T20:58:50+00:00">Aug 22, 2016 08:58 PM UTC</time> by <b>echism</b><a class="anchor" name="1471899530">&nbsp;</a></div><pre>Xizhou,

I think a regular hostcert (without rsv in the subject) should still work. I&#39;m adding the software team to confirm. Where is the cert currently stored?

Thank you</pre></div><div class='update_description'><i onclick="document.location='30952#1471893978'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-08-22T19:26:18+00:00">Aug 22, 2016 07:26 PM UTC</time> by <b>xizhouf@....</b><a class="anchor" name="1471893978">&nbsp;</a></div><pre>Hi Elizabeth,

I checked all of them and requested/installed a new certificate. The problem doesn’t resolve. However, the error messages changed to the following&#58;

Condor-G submission failed the job went on hold.Check the log and the hold reason.

Log&#58;
000 (14786.000.000) 08/22 14&#58;14&#58;17 Job submitted from host&#58; &#60;127.0.0.1&#58;62104?addrs=127.0.0.1-62104&#62;
...
012 (14786.000.000) 08/22 14&#58;15&#58;10 Job was held.
Error connecting to schedd osg-ce.clemson.edu&#58; SECMAN&#58;2010&#58;Received &#34;DENIED&#34; from server for user osg-ce.clemson.edu@.... using method GSI.
Code 0 Subcode 0
...
I looked at the grid map file and found that the certificate I requested doesn’t have rsv before osg-ce.clemson.edu.
&#34;/DC=org/DC=opensciencegrid/O=Open Science Grid/OU=Services/CN=osg-ce.clemson.edu&#34; rsv
&#34;/DC=org/DC=opensciencegrid/O=Open Science Grid/OU=Services/CN=rsv/fermicloud053.fnal.gov&#34; osg

I might have used an incompatible version of the OSG document when requesting the certificate. Can you point me the correct command to request the certificate with CN=rsv/osg-ce.clemson.edu as part of the subject?

Thanks,

Xizhou</pre></div><div class='update_description'><i onclick="document.location='30952#1471632750'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-08-19T18:52:30+00:00">Aug 19, 2016 06:52 PM UTC</time> by <b>echism</b><a class="anchor" name="1471632750">&nbsp;</a></div><pre>Xizhou,

Sorry for the delay. Please check the permissions and file size of the keypair and also ensure it maps to the right unix username.

Thank you</pre></div><div class='update_description'><i onclick="document.location='30952#1471375750'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-08-16T19:29:10+00:00">Aug 16, 2016 07:29 PM UTC</time> by <b>xizhouf@....</b><a class="anchor" name="1471375750">&nbsp;</a></div><pre>Thank you, Elizabeth,

I updated our local-grid-mapfile with the latest rsv certificate. The new DN for rsv is &#34;/DC=org/DC=opensciencegrid/O=Open Science Grid/OU=Services/CN=osg-ce.clemson.edu&#34;. This DN is different from previous DN&#58; &#34;/DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=Services/CN=rsv/osg-ce.clemson.edu&#34;. After the change and run “edg-mkgridmap” command, the certificate is still not working.

I requested the certificate using the following command.
osg-cert-request -H osg-ce.clemson.edu -e xizhouf@.... -n &#34;Xizhou Feng&#34; -p 8646569311 -v &#34;osg&#34; -y &#34;wolf@....,xizhouf@....&#34; -m &#34;Request a certificate for RSV&#34; -o rsvkey.pem
Is there something wrong with the command or should I use another way to request the certificate?

Thanks,

Xizhou</pre></div><div class='update_description'><i onclick="document.location='30952#1471373358'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-08-16T18:49:18+00:00">Aug 16, 2016 06:49 PM UTC</time> by <b>echism</b><a class="anchor" name="1471373358">&nbsp;</a></div><pre>Hi Xizhou,

The DN probably changed and you need to put the new one in GUMS or your gridmap file. Let me know if that&#39;s not the case, or if you need help doing that.

Thank you,
Elizabeth</pre></div><div class='update_description'><i onclick="document.location='30952#1471358217'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-08-16T14:36:57+00:00">Aug 16, 2016 02:36 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1471358217">&nbsp;</a></div><pre>I recently renewed a certificate for rsv on our Condor CE node. However, the current RSV status still shows CRITICAL status on myosg.grid.iu.edu website. Please advise what could be teh cause and how to fix it?

Thanks,

Xizhou Feng

--Appendix&#58; The Error Message and Debug Log--

===1&#58; Error Message on MYOSG
Critical Metrics
Reported 2 hours ago
CACert Expiry

No proxy is setup in rsv.conf.
To use a service certificate (recommended), set the following variables&#58;
service_cert, service_key, service_proxy

To use a user certificate, set the following variable&#58;
proxy_file

===2. RSV modules installed
[root@osg-ce ~]# yum list installed | grep rsv
librsvg2.x86_64                    2.26.0-14.el6          @anaconda-ScientificLinux-201410281405.x86_64/6.1
osg-configure-rsv.noarch           1.4.2-1.osg33.el6      @osg
rsv.noarch                         3.13.1-1.osg33.el6     @osg
rsv-consumers.noarch               3.13.1-1.osg33.el6     @osg
rsv-core.noarch                    3.13.1-1.osg33.el6     @osg
rsv-metrics.noarch                 3.13.1-1.osg33.el6     @osg

===3. Debug log
[root@osg-ce ~]# rsv-control --verify
Testing if Condor-Cron is running...
OK

Testing if metrics are running...
<div id='show_852082622' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_852082622'>ERROR&#58; No metrics are running

Testing if consumers are running...
OK (2 running consumers)

Checking which consumers are configured...
The following consumers are enabled&#58; html-consumer gratia-consumer
[root@osg-ce ~]#  rsv-control -r org.osg.general.osg-version -v 2 -u osg-ce.clemson.edu
INFO&#58; Reading configuration file /etc/rsv/rsv.conf
INFO&#58; Reading configuration file /etc/rsv/consumers.conf
INFO&#58; Validating configuration&#58;
INFO&#58; Validating user&#58;
INFO&#58;     Invoked as root.  Switching to &#39;rsv&#39; user (uid&#58; 515 - gid&#58; 94175)
INFO&#58; Registered consumers&#58; html-consumer, gratia-consumer
INFO&#58; Loading config file &#39;/etc/rsv/meta/metrics/org.osg.general.osg-version.meta&#39;
INFO&#58; Loading config file &#39;/etc/rsv/metrics/org.osg.general.osg-version.conf&#39;
INFO&#58; Loading config file &#39;/etc/rsv/metrics/osg-ce.clemson.edu/allmetrics.conf&#39;
INFO&#58; Optional config file &#39;/etc/rsv/metrics/osg-ce.clemson.edu/org.osg.general.osg-version.conf&#39; does not exist
INFO&#58; Checking proxy&#58;
INFO&#58;     Using service certificate proxy
INFO&#58; Running command with timeout (1200 seconds)&#58;
/usr/bin/openssl x509 -in /tmp/rsvproxy -noout -enddate -checkend 21600
INFO&#58; Exit code of job&#58; 0
INFO&#58;     Service certificate valid for at least 6 hours.
INFO&#58; Pinging host osg-ce.clemson.edu&#58;
INFO&#58; Running command with timeout (1200 seconds)&#58;
/bin/ping -W 3 -c 1 osg-ce.clemson.edu
INFO&#58; Exit code of job&#58; 0
INFO&#58;     Ping successful

Running metric org.osg.general.osg-version&#58;

INFO&#58; Executing job remotely using Condor-G
INFO&#58; Setting up job environment&#58;
INFO&#58;     No environment setup declared
INFO&#58; Condor-G working directory&#58; /var/tmp/rsv/condor_g-pX1tjo
INFO&#58; Submitting to HTCondor-CE gateway
INFO&#58; Forming arguments&#58;
INFO&#58;     Arguments&#58; &#39;[]&#39;
INFO&#58; List of files to transfer&#58; /usr/libexec/rsv/probes/RSVMetric.pm
INFO&#58; Condor submission&#58; Submitting job(s).
1 job(s) submitted to cluster 14758.
INFO&#58; Stopping all metrics with constraint &#39;ClusterId==14758&#39;
INFO&#58; Trimming data to 10000 bytes because details-data-trim-length is set
INFO&#58; Result&#58;

metricName&#58; org.osg.general.osg-version
metricType&#58; status
timestamp&#58; 2016-08-16 10&#58;23&#58;10 EDT
metricStatus&#58; CRITICAL
serviceType&#58; OSG-CE
serviceURI&#58; osg-ce.clemson.edu
gatheredAt&#58; osg-ce.clemson.edu
summaryData&#58; CRITICAL
detailsData&#58; Condor-G submission failed the job went on hold.
Check the log and the hold reason.

Log&#58;
000 (14758.000.000) 08/16 10&#58;22&#58;10 Job submitted from host&#58; &#60;127.0.0.1&#58;28001?addrs=127.0.0.1-28001&#62;
...
012 (14758.000.000) 08/16 10&#58;23&#58;03 Job was held.
Error connecting to schedd osg-ce.clemson.edu&#58; SECMAN&#58;2010&#58;Received &#34;DENIED&#34; from server for user osg-ce.clemson.edu@.... using method GSI.
Code 0 Subcode 0
...
009 (14758.000.000) 08/16 10&#58;23&#58;10 Job was aborted by the user.
via condor_rm (by user rsv)
...

EOT

INFO&#58; Creating record for html-consumer consumer at &#39;/var/spool/rsv/html-consumer/org.osg.general.osg-version.Ae8TUO&#39;
INFO&#58; Creating record for gratia-consumer consumer at &#39;/var/spool/rsv/gratia-consumer/org.osg.general.osg-version.NIeU0W&#39;

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=Xizhou Feng 3402

</div><script type='text/javascript'>
        $('#show_852082622').click(function() {
            $('#detail_852082622').slideDown("normal");
            $('#show_852082622').hide();
            $('#hide_852082622').show();
        });
        $('#hide_852082622').click(function() {
            $('#detail_852082622').slideUp();
            $('#hide_852082622').hide();
            $('#show_852082622').show();
        });
        </script></pre></div><legend>Similar Recent Tickets <small>modified within the last 30 days</small></legend><div id="similar_tickets"><p class="muted">No similar tickets found.</p></div>
</div>
<script type="text/javascript">
function reset_anchor() {
    $("#updates .selected").removeClass("selected");
    var urls = document.location.toString().split('#'); 
    var anchor = urls[1];
    if(anchor) {
        $("a[name='"+anchor+"']").parents(".update_description").addClass("selected");
    }
}
function submitspam(ticket_id) {
    myret = confirm("Would you like to close this ticket as a security ticket, and submit the ticket content to akismet?");
    if(myret == true) {
        $.ajax("viewer/processspam?id="+ticket_id).done(function() {
            window.location.reload();
        });
    }
}

$(function() {
    reset_anchor();
    var ADDITIONAL_COOKIE_NAME = 'gocticket';
    var options = { path: '/', expires: 365};

    if(window.opener && window.opener.name == "gocticket_list") {
        v = $.cookie("closewindow");
        if(!v) {
            $("#closewindow").attr("checked", "checked"); //on by default
        } else {
            if(v == "checked") {
                $("#closewindow").attr("checked", "checked");
            }
        }
        $("#closewindow").click(function() {
            $.cookie("closewindow", $(this).attr('checked'), options);
        });
    } else {
        $("#closewindow_area").hide();
    }
    function updateTimeago() {
        $("time").timeago();
        setTimeout(updateTimeago, 30*1000);
    }
    updateTimeago();
    $(".description").focus(expand_description);
});
</script>
<hr/>
<footer>
<p>GOC Ticket Version 2.2 | <a href="https://ticket.opensciencegrid.org/goc/submit?app_issue_check=on&amp;app_issue_type=goc&amp;app_goc_url=https%3A%2F%2Fticket.opensciencegrid.org%3A443%2F30952">Report Bugs</a>
 | <a href="https://github.com/opensciencegrid/operations/blob/master/docs/privacy.md">Privacy Policy</a>
</p>

<p> <img align="top" src="images/tag_orange.png"/> Copyright 2018 The Trustees of Indiana University - Developed for Open Science Grid</p>
</footer>


</div><!--container-fluid-->
<script src="https://ticket1.grid.iu.edu:8443/socket.io/socket.io.js"></script>
<script>
var chat = io.connect('https://ticket1.grid.iu.edu:8443');
chat.on('connect', function() {
    chat.emit('authenticate', {nodekey:'', ticketid: 30952});
});
chat.on('peers', function(peers) {
    $("#peers").html("");
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('peer_disconnect', function(pid) {
    $("#peer_"+pid).hide("slow");
});
chat.on('peer_connected', function(peers) {
    //expect only 1 peer connecting, but..
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('submit', function() {
    if(confirm("This ticket was updated. Do you want to refresh?")) {
        history.go(0);
    }
});

function addPeer(pid, peer) {
    var ipinfo = "";
    if(peer.ip != undefined) {
        ipinfo = "<span class=\"ip\">"+peer.ip+"</span>";
    }
    if(chat.io.engine.id == pid) {
        //don't display myself
        return;
    }
    var html = "<li class=\"new\" id=\"peer_"+pid+"\" class=\"peer\">"+peer.name+ipinfo+"</li>";
    $("#peers").prepend(html);
    $("#peers .new").animate({bottom: 0}, 1000, function() {$(this).removeClass("new")});
}

$(function() {
    $("#ticket_form").submit(function() {
        chat.emit('submit');
        return true;
    });
});
</script>
<script>
//used by searchbox
function parseValue(value) {
    var obj = new Object();
    var tokens = value.split("\t");
    obj.str = tokens[0];
    obj.count = tokens[1];
    return obj;
}

$(function() {
    //bootstrap-2.0.4 stuff
    $(".alert-message").alert();
    $(".dropdown-toggle").dropdown();
    $("span[rel='tooltip']").tooltip();
    $("a[rel=popover]").popover();

    //activate menu that user is currently on
    $("#menu_navigator").addClass("active"); 
    $("#submenu_").addClass("active"); 

    //translate zend validation error message to bootstrap
    $(".errors").addClass("alert").addClass("alert-error");

    //enable autocomplete for search box
    $("#search").autocomplete({
        source: function( request, response ) {
            $.ajax({
                url: "search/autocomplete",
                dataType: "text",
                data: {
                    //featureClass: "P",
                    //style: "full",
                    //maxRows: 12,
                    //name_startsWith: request.term
                    q: request.term
                },
                success: function( data ) {
                    response( $.map( data.split("\n"), function( item ) {
                        if(item == "") return null;
                        return {
                            value: item
                        }
                    }));
                }
            });
        },
        select: function(event, ui) {
            document.location = "search?q="+ui.item.value;
        }
    });
    
});
</script>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-69012-13");
pageTracker._trackPageview();
} catch(err) {}
</script>

</body>
