<!DOCTYPE html>
<html lang="en">
  <head>
  <base href="">
    <title>[21990] Site not reporting to RSV and Gratia</title>    <meta charset="utf-8" />
    <meta name="verify-v1" content="na5IcAJsZVOfEkboRxuIiZ1zpZgnZiWra+nKcS7nA/o=" />
    <meta name="google-site-verification" content="DLrk3ft4s8b-S2TloLCL2LD_t6wcTjgSluf5pmiu2kA" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />
    <link href="https://ticket.opensciencegrid.org/rss" rel="alternate" type="application/rss+xml" title="GOC Ticket Update feed" />

    <style type="text/css">
      body {
        padding-top: 50px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
     #search {
            width: 300px;
     }

    </style>

<script src="https://code.jquery.com/jquery-3.0.0.js"></script>
<script src="https://code.jquery.com/jquery-migrate-3.0.1.js"></script>

   <link href="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet"/>
    <script src="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/js/bootstrap.min.js"></script>

    <link href="https://netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"/>
    <link href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/themes/smoothness/jquery-ui.min.css" rel="stylesheet"/>
 <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>


    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/js/select2.min.js"></script>

    <link href="css/ticket.css" rel="stylesheet" />
    <script src="lib/jquery.cookie.js"></script>

    <link href="images/tag_orange.png" rel="icon" type="image/png"/>
  </head>

  <body>
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>

            <a class="brand" style="padding: 6px 0px 0px 6px;" href="http://opensciencegrid.org"><img src="images/osglogo.40x30.png"/></a>
            <ul class="nav">
                <li class="dropdown"><a href="https://ticket.opensciencegrid.org/#" class="dropdown-toggle" data-toggle="dropdown">GOC Ticket <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    <li><a href="https://my.opensciencegrid.org">MyOSG</a></li>
                    <li><a href="https://oim.opensciencegrid.org">OIM</a></li>
                    <li class="active"><a href="https://ticket.opensciencegrid.org/index">Ticket</a></li>
	<li class="divider"></li>
	<li><a href="http://repo.grid.iu.edu">Repo</a></li>
	<li class="divider"></li>
	<li><a href="http://blogs.grid.iu.edu">Blog</a></li>
                    <li><a href="http://display.grid.iu.edu">Display</a></li>
                    <li><a href="http://osggoc.blogspot.com/">News</a></li>
                    </ul>
                </li>
            </ul>
            <ul class="nav pull-right">
                <li><a href="https://ticket.opensciencegrid.org/sso/">Login</a></li>            </ul>

            <div class="nav-collapse">
                <ul class="nav">
			 <li id="menu_submit"><a href="https://ticket.opensciencegrid.org/submit">Submit</a></li><li id="menu_view" class="dropdown"><a href="https://ticket.opensciencegrid.org/\#" class="dropdown-toggle" data-toggle="dropdown">View <b class="caret"></b></a><ul class="dropdown-menu"><li id="submenu_listopen"><a href="https://ticket.opensciencegrid.org/list/open">Open Tickets</a></li><li id="submenu_listrecentclose"><a href="https://ticket.opensciencegrid.org/list/recentclose">Recently Closed Tickets</a></li><li class="divider"></li><li id="submenu_alltickets"><a href="https://ticket.opensciencegrid.org/search?q=&amp;sort=id">All Tickets</a></li></ul></li>                </ul>

                <form class="navbar-search pull-right" action="https://ticket.opensciencegrid.org/viewer">
                    <input id="search" type="text" name="id" class="search-query span2" placeholder="Search Ticket" value=""/>
                </form>
            </div>
        </div>
      </div>
    </div>

<script type='text/javascript' src='lib/jquery.timeago.js'></script>
<script type='text/javascript' src='lib/byte2size.js'></script>
<style>
#updates .toolbar {
position: relative;
margin-top: 0px;
top: -10px;
font-weight: normal;
}
#updates a.anchor {
position: relative;
top: -50px;
}
#updates .selected pre {
animation:selected 2s;
animation-iteration-count: 2;
animation-direction: alternate;
-webkit-animation:selected 2s; 
-webkit-animation-iteration-count: 2;
-webkit-animation-direction: alternate;
box-shadow: inset 1px 1px 20px #9ad;
border: 1px solid #9ab;
margin: 5px 0px;
padding-left: 10px;
}
@keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ab;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
@-webkit-keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ad;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
#updates pre {
background-color: inherit;
line-height: 15px;
padding: 5px;
}
#updates .header {
color: #999;
}
#updates .update_history pre {
background-color: #eee;
color: #666;
font-size: 85%;
}
#updates .clickable {
cursor: pointer;
}
#updates .clickable:hover {
color: #D98719;
}
#updates .meta_information pre {
background-color: #fed;
}
#similar_tickets {
max-height: 300px;
overflow-y: auto;
pointer-events: none;
padding: 5px;
background-color: #f4f4f4;
}
.btn-toolbar {
margin-bottom: 0;
height: 30px;
}
#peers {
position: fixed;
bottom: 0px;
right: 0px;
z-index: 100;
list-style: none;
padding: 5px 0px 0px 5px;
margin: 0px;
background-color: white;
box-shadow: 0px 0px 10px white;
}
#peers li {
background-color: #ccc;
color: #000;
display: inline-block;
padding: 5px 10px;
margin-right: 5px;
position: relative;
}
/*
#peers li:hover {
background-color: #999;
cursor: pointer;
}
*/
#peers span.ip {
padding-left: 5px;
color: #666;
}
#peers .new {
bottom: -30px;
}
/*
#peers .me {
background-color: red;
}
*/
</style>

<div class="container-fluid">
<ul id="peers"></ul>
<div class="alert alert-danger"><a class="close" href="https://ticket.opensciencegrid.org/#" data-dismiss="alert">&times;</a>By the end of May 2018, the ticketing system at https://ticket.opensciencegrid.org will be retired and support will be provided at https://support.opensciencegrid.org. Throughout this transition the support email (help@opensciencegrid.org) will be available as a point of contact.<br><br>                                                   
                                                                                                                                                                                   
Please see the service migration page for details: https://opensciencegrid.github.io/technology/policy/service-migrations-spring-2018/#ticket</div><div id="presence" class="pull-right"></div><div class="ticketgui"><script type="text/javascript" src="lib/checktab.js"></script>

<script>
var expanded = false;
function expand_description() {
    var desc = $(".description");
    if(!expanded) {
        expanded = true;
        //expand to minheight
        var min = 250;
        if(desc.height() < min) {
            desc.animate({height: min}, 200);
        }
    }
}

$(document).ready(function() {
    $("input[name='nad']").datepicker({
        dateFormat: 'yy-mm-dd'
    });
});

</script>



<style>
.form-horizontal .control-label {
padding-top: inherit;
font-size:90%;
color:#666;
}
label {
margin-bottom: 0px;
}
.controls {
line-height: 18px;
}
</style>
<form class="form-horizontal" action="https://ticket.opensciencegrid.org/viewer/updatebasic?id=21990" method="post">
<div class="page-header">
    <h3><span class="muted">21990</span> / Site not reporting to RSV and Gratia</h3>
</div>

<div class="row-fluid">
<div class="span5">
    <legend>Contact</legend>
    <div class="control-group">
        <label class="control-label">Full Name</label>
        <div class="controls">Marco Mambelli</div>
    </div>
    <div class="control-group">
        <label class="control-label">Email</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">Phone</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">CC</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>

    <legend>Details</legend>
    <div class="control-group"><label class="control-label">Resource Name</label><div class="controls">NYSGRID-CCR-U2</div></div><div class="control-group"><label class="control-label">Associated VO</label><div class="controls">NYSGRID</div></div><div class="control-group"><label class="control-label">Submitted Via</label><div class="controls">GOC Ticket/submit</div></div><div class="control-group"><label class="control-label">Submitter</label><div class="controls">Marco Mambelli</div></div><div class="control-group"><label class="control-label">Support Center</label><div class="controls">NYSGRID</div></div>
    <div class="control-group">
        <label class="control-label">Ticket Type</label>
        <div class="controls">Problem/Request</div>
    </div>
    <div class="control-group">
        <label class="control-label">Priority</label>
        <div class="controls">Normal</div>
    </div>
    <div class="control-group">
        <label class="control-label">Status</label>
        <div class="controls">
Closed</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action</label>
        <div class="controls">ENG Action</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action Deadline</label>
        <div class="controls flag_red">2014-09-24</div>
    </div>

</div><!--span-->
<div class="span7">
    <legend>Assignees</legend>
    <div class="assignee" style="width: 60%">NYSGRID <span class="muted"> / OSG Support Centers</span></div>    <br>

    <legend>Assignees</legend>
    TODO
    <br>

    <style>
legend.noborder {
border-bottom: none;
}
</style>

<div id="attachment-list"/>
<script>
$(function () {
    var first = true;
    $.getJSON("attachment/list/21990", function (files) {
        //console.dir(files);
        var html = "<table class=\"table table-condensed\">";
        $(files).each(function() {
            if(first) {
                first = false;
                html += "<legend class=\"noborder\">Attachmenets</legend>";
            }
            html += "<tr class=\"attachment\">";
            html += "<td><img src=\""+this.thumbnail_url+"\"/></td>";
            html += "<td><a href=\""+this.url+"\" target=\"_blank\">"+this.name+"</a></td>";
            html += "<td>"+bytesToSize(this.size, 1)+"</td>";
            html += "</tr>";
        });
        html += "</table>";
        $("#attachment-list").html(html);
    });
});

function download(url) {
    window.open(url, "_blank");
}
</script>


</div><!--span-->
</div><!--row-fluid-->


</form>

</div>
<div id="updates" style="clear: both;">
    <legend>Past Updates
    <div class="btn-toolbar pull-right toolbar">
        <div class="btn-group">
                <a class="btn btn-small" href="https://ticket.opensciencegrid.org/21990?sort=up&amp;"><i class="icon-arrow-up"></i> Sort</a>

        
        <a class="btn btn-small" href="https://ticket.opensciencegrid.org/21990?expandall=true&amp;">Expand Descriptions</a>        <a class="btn btn-small" target="_blank" href="mailto:osg@tick.globalnoc.iu.edu?subject=Open%20Science%20Grid%3A%20Site%20not%20reporting%20to%20RSV%20and%20Gratia%20ISSUE%3D21990%20PROJ%3D71"><i class="icon-envelope"></i> Update w/Email</a>
        </div>
    </div><!--btn-toolbar-->
    </legend>

    <div class='update_description'><i onclick="document.location='21990#1411572756'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-09-24T15:32:36+00:00">Sep 24, 2014 03:32 PM UTC</time> by <b>echism</b><a class="anchor" name="1411572756">&nbsp;</a></div><pre>Thanks, Jon. I&#39;ll close this.</pre></div><div class='update_description'><i onclick="document.location='21990#1411401434'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-09-22T15:57:14+00:00">Sep 22, 2014 03:57 PM UTC</time> by <b>GRASE</b><a class="anchor" name="1411401434">&nbsp;</a></div><pre>Ok with me.

On 09/22/2014 10&#58;56 AM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='21990#1411397791'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-09-22T14:56:31+00:00">Sep 22, 2014 02:56 PM UTC</time> by <b>echism</b><a class="anchor" name="1411397791">&nbsp;</a></div><pre>Hey all,

Since the feature request is in the JIRA ticket, would it be okay to close this?

Thank you</pre></div><div class='update_description'><i onclick="document.location='21990#1408652375'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-08-21T20:19:35+00:00">Aug 21, 2014 08:19 PM UTC</time> by <b>echism</b><a class="anchor" name="1408652375">&nbsp;</a></div><pre>I made a JIRA ticket.
<a href='https&#58;//jira.opensciencegrid.org/browse/SOFTWARE-1588' target='_blank' rel='nofollow'>https&#58;//jira.opensciencegrid.org/browse/SOFTWARE-1588</a></pre></div><div class='update_description'><i onclick="document.location='21990#1408551498'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-08-20T16:18:18+00:00">Aug 20, 2014 04:18 PM UTC</time> by <b>GRASE</b><a class="anchor" name="1408551498">&nbsp;</a></div><pre>We would like to request a new probe be developed that does not require
direct access to the slurm database. The probe should use slurm command
line tools.

Jon

On 08/19/2014 04&#58;23 PM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='21990#1408479778'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-08-19T20:22:58+00:00">Aug 19, 2014 08:22 PM UTC</time> by <b>echism</b><a class="anchor" name="1408479778">&nbsp;</a></div><pre>Hey Jon,

Which of those options sounds good to you?

Thank you</pre></div><div class='update_description'><i onclick="document.location='21990#1408120439'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-08-15T16:33:59+00:00">Aug 15, 2014 04:33 PM UTC</time> by <b>Tanya Levshina</b><a class="anchor" name="1408120439">&nbsp;</a></div><pre>Hi Jon,

I agree with Marco, if you can not accept Derek suggestions (special user, read access) you need to open a ticket and list your requirements or implement some probe modifications. The OSG resources should run gratia probe to provide accounting info.
There are two Buffalo sites  GRASE-CSE-MAGIC(pbs&#58;magic.cse.buffalo.edu) and NYSGRID-CCR-U2 ( slurm&#58;u2-grid.ccr.buffalo.edu   )  that provide significant amount of opportunistic resources (see attached plots generated from submission nodes).
but do not report any batch record data.  Please let us know how you want to proceed. We can have a phone meeting if it can help.
Tanya</pre></div><div class='update_description'><i onclick="document.location='21990#1408119955'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-08-15T16:25:55+00:00">Aug 15, 2014 04:25 PM UTC</time> by <b>Marco Mambelli</b><a class="anchor" name="1408119955">&nbsp;</a></div><pre>Hi Jon,
your site is not reporting to the OSG accounting system.
OSG has a working probe even if it does not meet your requirement.
To change the situation&#58;
1. OSG can develop an alternative SLURM probe
2. You or someone one your team can contribute an alternative SLURM probe that meets your requirements

I added in CC people from OSG software but I don&#39;t think there is effort to change the current probe.
2 is more possible but someone else can decide on this, probably Tim.

Thank you,
Marco</pre></div><div class='update_description'><i onclick="document.location='21990#1408118892'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-08-15T16:08:12+00:00">Aug 15, 2014 04:08 PM UTC</time> by <b>NYSGRID</b><a class="anchor" name="1408118892">&nbsp;</a></div><pre>Elizabeth

I did get it - we still are not going to allow a program access to the
DB. We think this information should be obtained from the commandline.

Where does this leave us?

Jon

On 08/15/2014 10&#58;08 AM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='21990#1408111731'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-08-15T14:08:51+00:00">Aug 15, 2014 02:08 PM UTC</time> by <b>echism</b><a class="anchor" name="1408111731">&nbsp;</a></div><pre>Jon,

Did you get that last update? Thoughts?

Thank you</pre></div><div class='update_description'><i onclick="document.location='21990#1408040937'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-08-14T18:28:57+00:00">Aug 14, 2014 06:28 PM UTC</time><a class="anchor" name="1408040937">&nbsp;</a></div><pre>Hi,

The person that initially wrote the probes has since left for greener pastures.  But we run the SLURM probe currently, and describe why we are ok with this.

Some history - Other batch systems provided text based access to accounting data.  For example, PBS spit out an accounting log which could easily be parsed for completed job information, so that is what gratia consumed.  Slurm does not provide a text way to view completed jobs, it does not provide a PBS like accounting log (at least as far as I know).  Instead, it was decided to directly query the slurm db for a couple of reasons&#58;
- It is very well known how to lock down a mysql database for read-only access from an application.
- Parsing data from a database is well understood in python (and applications in general)
- Raw data could be better parsed directly from the database, for example, combining job preemptions into the final runtime of a job.
- Easy to know where you left off.  Gratia maintains state where in the accounting log it last processed.

There are some cons to this, such as the format of the database could change in the future.  But, so could the output from the command line tools, so no clear winner was seen.  The alternative to the db was parsing output from sacct, which seems to be a valid choice, and may be a valid choice in the future.  But wasn&#39;t implemented since parsing command line output is difficult at best.

At Nebraska we made a special account for the slurm probe with read-only access to the slurm mysql DB.  We felt that this provided enough protection.  The Slurm probe reads a password from a protected password file, so even the read-only account is protected.

Many OSG services run as root anyways, so they could easily modify the queue with scontrol, or remove other jobs with scancel (in theory, no services actually do that).  Providing access to the slurmdb directly as read-only was not considered an escalation of privileges for OSG software.

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=Derek Weitzel 605</pre></div><div class='update_description'><i onclick="document.location='21990#1408038787'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-08-14T17:53:07+00:00">Aug 14, 2014 05:53 PM UTC</time> by <b>echism</b><a class="anchor" name="1408038787">&nbsp;</a></div><pre>Brian,

Can you assist?

Thank you</pre></div><div class='update_description'><i onclick="document.location='21990#1407935414'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-08-13T13:10:14+00:00">Aug 13, 2014 01:10 PM UTC</time> by <b>GRASE</b><a class="anchor" name="1407935414">&nbsp;</a></div><pre>Tanya

I don&#39;t think there is any update. We don&#39;t allow services or codes to
query our slurmdbd we feel this should all be done through slurm commands.

Jon

On 08/12/2014 02&#58;49 PM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='21990#1407869394'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-08-12T18:49:54+00:00">Aug 12, 2014 06:49 PM UTC</time> by <b>Tanya Levshina</b><a class="anchor" name="1407869394">&nbsp;</a></div><pre>Hi Jon,

Please let us know about the status of gratia probe. Can we help you somehow?
Thanks,
Tanya</pre></div><div class='update_description'><i onclick="document.location='21990#1407446933'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-08-07T21:28:53+00:00">Aug 7, 2014 09:28 PM UTC</time> by <b>echism</b><a class="anchor" name="1407446933">&nbsp;</a></div><pre>Hello all,

Are there any updates on this?

Thank you</pre></div><div class='update_description'><i onclick="document.location='21990#1407250966'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-08-05T15:02:46+00:00">Aug 5, 2014 03:02 PM UTC</time> by <b>Marco Mambelli</b><a class="anchor" name="1407250966">&nbsp;</a></div><pre>Jon,
RSV probes are OK now.

The Gratia probe is a script running on your gatekeeper (or you can choose another host with some adjustments) and querying the slurm db to get accounting information. You can see the source code here (or inspect directly the python script)&#58; <a href='http&#58;//sourceforge.net/p/gratia/svn/HEAD/tree/trunk/probe/slurm/SlurmProbe.py' target='_blank' rel='nofollow'>http&#58;//sourceforge.net/p/gratia/svn/HEAD/tree/trunk/probe/slurm/SlurmProbe.py</a>
There will be no outside connection to your slurm db. If you don&#39;t trust OSG software running on your host to query the slurm db I don&#39;t know if we have any ready alternative to get your contribution accounted in OSG.

I added in CC Brian and Derek from Nebraska. They run slurm and developed the probe. They probably would know if there is any alternative to querying the slurm db and why they chose to go that route.

Thank you,
Marco</pre></div><div class='update_description'><i onclick="document.location='21990#1407250162'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-08-05T14:49:22+00:00">Aug 5, 2014 02:49 PM UTC</time> by <b>Steve Gallo</b><a class="anchor" name="1407250162">&nbsp;</a></div><pre>Added cc&#58;smgallo@....</pre></div><div class='update_description'><i onclick="document.location='21990#1407246190'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-08-05T13:43:10+00:00">Aug 5, 2014 01:43 PM UTC</time> by <b>NYSGRID</b><a class="anchor" name="1407246190">&nbsp;</a></div><pre>Marco

Thanks - what non critical metrics are you interested in seeing? I will
add the ones you want.

We do use SLURM with PBS emulation.

I don&#39;t think we are going let an outside service query our slurmdbd.
Gratia is welcome to use the slurm commands (scontrol) to gather the
information. Sorry.

Jon

On 08/04/2014 06&#58;04 PM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='21990#1407190234'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-08-04T22:10:34+00:00">Aug 4, 2014 10:10 PM UTC</time> by <b>Marco Mambelli</b><a class="anchor" name="1407190234">&nbsp;</a></div><pre>Adding Carl in CC that is more familiar with the slurm probe.</pre></div><div class='update_description'><i onclick="document.location='21990#1407189840'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-08-04T22:04:00+00:00">Aug 4, 2014 10:04 PM UTC</time> by <b>Marco Mambelli</b><a class="anchor" name="1407189840">&nbsp;</a></div><pre>Thank you Jon,
the non critical metrics seem still to be missing from RSV. Not essential, but have a look at them as well&#58; <a href='http&#58;//tinyurl.com/mm2cyc3' target='_blank' rel='nofollow'>http&#58;//tinyurl.com/mm2cyc3</a>

In MyOSG seems that you have both pbs (probably slurm w/ pbs emulation) and condor.
The job manages that should be monitored is SLURM (w/ PBS emulation)?

Yes, that document is the latest one and the probe, running on your machine is querying slurmdbd and converting the data and sending it to the Gratia service.
The configuration contains the path of a password file (e.g. &#34;/etc/gratia/slurm/pwfile&#34;) that should only be readable to the probe. (chmod 600)

Thank you,
Marco</pre></div><div class='update_description'><i onclick="document.location='21990#1407172092'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-08-04T17:08:12+00:00">Aug 4, 2014 05:08 PM UTC</time> by <b>Jon Bednasz</b><a class="anchor" name="1407172092">&nbsp;</a></div><pre>Marco

Steve asked me to look at this.

RSV should be all set. I see a sliver of green and I will resolve any
red&#39;s that appear.

Gratia - I am looking at the instructions at&#58;
<a href='https&#58;//twiki.grid.iu.edu/bin/view/Documentation/Release3/InstallComputeElement' target='_blank' rel='nofollow'>https&#58;//twiki.grid.iu.edu/bin/view/Documentation/Release3/InstallComputeElement</a>

Section 7.5 - It looks like the gratia-probe-slurm rpm wants to query
the slurmdbd directly instead of using the slurm commands (scontrol,
etc) to get information.

From the webpage&#58; &#34;To configure the Gratia probe for the SLURM resource
manager, make sure that the gratia-probe-slurm RPM is installed. Then,
set the options starting with db_ and slurm_cluster in the 20-slurm.ini
file and run osg-configure as usual. &#34;

One of the db_ options is for the password. Is gratia logging into the
mysql database?

Am I looking at the correct and most up2date information on configuring
slurm and gratia?

Thanks

Jon

On 08/04/2014 11&#58;13 AM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='21990#1407165201'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-08-04T15:13:21+00:00">Aug 4, 2014 03:13 PM UTC</time> by <b>Marco Mambelli</b><a class="anchor" name="1407165201">&nbsp;</a></div><pre>The site seems not to be reporting to RSV in the last 59 days and it has not been reporting to Gratia since 2 years (2012-Jul-16).
Please check the OSG installation.

For RSV, check your OSG version and configuration

For the gratia part I&#39;d need to know the version of the probe and the configuration.
on u2-grid.ccr.buffalo.edu, let me know the output of&#58;
yum list &#39;*gratia*&#39;
and attach to the ticket the file /etc/gratia/condor/ProbeConfig
(the last probe reporting was from that host and for a condor queue. If you have a different gatekeeper or queue then things may be different)

Thank you,
Marco</pre></div><legend>Similar Recent Tickets <small>modified within the last 30 days</small></legend><div id="similar_tickets"><p class="muted">No similar tickets found.</p></div>
</div>
<script type="text/javascript">
function reset_anchor() {
    $("#updates .selected").removeClass("selected");
    var urls = document.location.toString().split('#'); 
    var anchor = urls[1];
    if(anchor) {
        $("a[name='"+anchor+"']").parents(".update_description").addClass("selected");
    }
}
function submitspam(ticket_id) {
    myret = confirm("Would you like to close this ticket as a security ticket, and submit the ticket content to akismet?");
    if(myret == true) {
        $.ajax("viewer/processspam?id="+ticket_id).done(function() {
            window.location.reload();
        });
    }
}

$(function() {
    reset_anchor();
    var ADDITIONAL_COOKIE_NAME = 'gocticket';
    var options = { path: '/', expires: 365};

    if(window.opener && window.opener.name == "gocticket_list") {
        v = $.cookie("closewindow");
        if(!v) {
            $("#closewindow").attr("checked", "checked"); //on by default
        } else {
            if(v == "checked") {
                $("#closewindow").attr("checked", "checked");
            }
        }
        $("#closewindow").click(function() {
            $.cookie("closewindow", $(this).attr('checked'), options);
        });
    } else {
        $("#closewindow_area").hide();
    }
    function updateTimeago() {
        $("time").timeago();
        setTimeout(updateTimeago, 30*1000);
    }
    updateTimeago();
    $(".description").focus(expand_description);
});
</script>
<hr/>
<footer>
<p>GOC Ticket Version 2.2 | <a href="https://ticket.opensciencegrid.org/goc/submit?app_issue_check=on&amp;app_issue_type=goc&amp;app_goc_url=https%3A%2F%2Fticket.opensciencegrid.org%3A443%2F21990">Report Bugs</a>
 | <a href="https://github.com/opensciencegrid/operations/blob/master/docs/privacy.md">Privacy Policy</a>
</p>

<p> <img align="top" src="images/tag_orange.png"/> Copyright 2018 The Trustees of Indiana University - Developed for Open Science Grid</p>
</footer>


</div><!--container-fluid-->
<script src="https://ticket1.grid.iu.edu:8443/socket.io/socket.io.js"></script>
<script>
var chat = io.connect('https://ticket1.grid.iu.edu:8443');
chat.on('connect', function() {
    chat.emit('authenticate', {nodekey:'', ticketid: 21990});
});
chat.on('peers', function(peers) {
    $("#peers").html("");
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('peer_disconnect', function(pid) {
    $("#peer_"+pid).hide("slow");
});
chat.on('peer_connected', function(peers) {
    //expect only 1 peer connecting, but..
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('submit', function() {
    if(confirm("This ticket was updated. Do you want to refresh?")) {
        history.go(0);
    }
});

function addPeer(pid, peer) {
    var ipinfo = "";
    if(peer.ip != undefined) {
        ipinfo = "<span class=\"ip\">"+peer.ip+"</span>";
    }
    if(chat.io.engine.id == pid) {
        //don't display myself
        return;
    }
    var html = "<li class=\"new\" id=\"peer_"+pid+"\" class=\"peer\">"+peer.name+ipinfo+"</li>";
    $("#peers").prepend(html);
    $("#peers .new").animate({bottom: 0}, 1000, function() {$(this).removeClass("new")});
}

$(function() {
    $("#ticket_form").submit(function() {
        chat.emit('submit');
        return true;
    });
});
</script>
<script>
//used by searchbox
function parseValue(value) {
    var obj = new Object();
    var tokens = value.split("\t");
    obj.str = tokens[0];
    obj.count = tokens[1];
    return obj;
}

$(function() {
    //bootstrap-2.0.4 stuff
    $(".alert-message").alert();
    $(".dropdown-toggle").dropdown();
    $("span[rel='tooltip']").tooltip();
    $("a[rel=popover]").popover();

    //activate menu that user is currently on
    $("#menu_navigator").addClass("active"); 
    $("#submenu_").addClass("active"); 

    //translate zend validation error message to bootstrap
    $(".errors").addClass("alert").addClass("alert-error");

    //enable autocomplete for search box
    $("#search").autocomplete({
        source: function( request, response ) {
            $.ajax({
                url: "search/autocomplete",
                dataType: "text",
                data: {
                    //featureClass: "P",
                    //style: "full",
                    //maxRows: 12,
                    //name_startsWith: request.term
                    q: request.term
                },
                success: function( data ) {
                    response( $.map( data.split("\n"), function( item ) {
                        if(item == "") return null;
                        return {
                            value: item
                        }
                    }));
                }
            });
        },
        select: function(event, ui) {
            document.location = "search?q="+ui.item.value;
        }
    });
    
});
</script>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-69012-13");
pageTracker._trackPageview();
} catch(err) {}
</script>

</body>
