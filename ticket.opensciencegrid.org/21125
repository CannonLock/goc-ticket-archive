<!DOCTYPE html>
<html lang="en">
  <head>
  <base href="/">
    <title>[21125] Gratia not reporting for NET2</title>    <meta charset="utf-8" />
    <meta name="verify-v1" content="na5IcAJsZVOfEkboRxuIiZ1zpZgnZiWra+nKcS7nA/o=" />
    <meta name="google-site-verification" content="DLrk3ft4s8b-S2TloLCL2LD_t6wcTjgSluf5pmiu2kA" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />
    <link href="https://ticket.opensciencegrid.org/rss" rel="alternate" type="application/rss+xml" title="GOC Ticket Update feed" />

    <style type="text/css">
      body {
        padding-top: 50px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
     #search {
            width: 300px;
     }

    </style>

<script src="https://code.jquery.com/jquery-3.0.0.js"></script>
<script src="https://code.jquery.com/jquery-migrate-3.0.1.js"></script>

   <link href="//netdna.bootstrapcdn.com/bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet"/>
    <script src="//netdna.bootstrapcdn.com/bootstrap/2.3.2/js/bootstrap.min.js"></script>

    <link href="//netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"/>
    <link href="//ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/themes/smoothness/jquery-ui.min.css" rel="stylesheet"/>
 <script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>


    <link href="//cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/css/select2.min.css" rel="stylesheet" />
    <script src="//cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/js/select2.min.js"></script>

    <link href="css/ticket.css" rel="stylesheet" />
    <script src="lib/jquery.cookie.js"></script>

    <link href="images/tag_orange.png" rel="icon" type="image/png"/>
    <script src='https://www.google.com/recaptcha/api.js'></script>
  </head>

  <body>
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>

            <a class="brand" style="padding: 6px 0px 0px 6px;" href="http://opensciencegrid.org"><img src="https://ticket.opensciencegrid.org/images/osglogo.40x30.png"/></a>
            <ul class="nav">
                <li class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown">GOC Ticket <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    <li><a href="https://my.opensciencegrid.org">MyOSG</a></li>
                    <li><a href="https://oim.opensciencegrid.org">OIM</a></li>
                    <li class="active"><a href="index">Ticket</a></li>
	<li class="divider"></li>
	<li><a href="http://repo.grid.iu.edu">Repo</a></li>
	<li class="divider"></li>
	<li><a href="http://blogs.grid.iu.edu">Blog</a></li>
                    <li><a href="http://display.grid.iu.edu">Display</a></li>
                    <li><a href="http://osggoc.blogspot.com/">News</a></li>
                    </ul>
                </li>
            </ul>
            <ul class="nav pull-right">
                <li><a href="https://ticket.opensciencegrid.org/sso/">Login</a></li>            </ul>

            <div class="nav-collapse">
                <ul class="nav">
			 <li id="menu_submit"><a href="https://ticket.opensciencegrid.org/submit">Submit</a></li><li id="menu_view" class="dropdown"><a href="\#" class="dropdown-toggle" data-toggle="dropdown">View <b class="caret"></b></a><ul class="dropdown-menu"><li id="submenu_listopen"><a href="https://ticket.opensciencegrid.org/list/open">Open Tickets</a></li><li id="submenu_listrecentclose"><a href="https://ticket.opensciencegrid.org/list/recentclose">Recently Closed Tickets</a></li><li class="divider"></li><li id="submenu_alltickets"><a href="https://ticket.opensciencegrid.org/search?q=&amp;sort=id">All Tickets</a></li></ul></li>                </ul>

                <form class="navbar-search pull-right" action="viewer">
                    <input id="search" type="text" name="id" class="search-query span2" placeholder="Search Ticket" value=""/>
                </form>
            </div>
        </div>
      </div>
    </div>

<script type='text/javascript' src='lib/jquery.timeago.js'></script>
<script type='text/javascript' src='lib/byte2size.js'></script>
<style>
#updates .toolbar {
position: relative;
margin-top: 0px;
top: -10px;
font-weight: normal;
}
#updates a.anchor {
position: relative;
top: -50px;
}
#updates .selected pre {
animation:selected 2s;
animation-iteration-count: 2;
animation-direction: alternate;
-webkit-animation:selected 2s; 
-webkit-animation-iteration-count: 2;
-webkit-animation-direction: alternate;
box-shadow: inset 1px 1px 20px #9ad;
border: 1px solid #9ab;
margin: 5px 0px;
padding-left: 10px;
}
@keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ab;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
@-webkit-keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ad;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
#updates pre {
background-color: inherit;
line-height: 15px;
padding: 5px;
}
#updates .header {
color: #999;
}
#updates .update_history pre {
background-color: #eee;
color: #666;
font-size: 85%;
}
#updates .clickable {
cursor: pointer;
}
#updates .clickable:hover {
color: #D98719;
}
#updates .meta_information pre {
background-color: #fed;
}
#similar_tickets {
max-height: 300px;
overflow-y: auto;
pointer-events: none;
padding: 5px;
background-color: #f4f4f4;
}
.btn-toolbar {
margin-bottom: 0;
height: 30px;
}
#peers {
position: fixed;
bottom: 0px;
right: 0px;
z-index: 100;
list-style: none;
padding: 5px 0px 0px 5px;
margin: 0px;
background-color: white;
box-shadow: 0px 0px 10px white;
}
#peers li {
background-color: #ccc;
color: #000;
display: inline-block;
padding: 5px 10px;
margin-right: 5px;
position: relative;
}
/*
#peers li:hover {
background-color: #999;
cursor: pointer;
}
*/
#peers span.ip {
padding-left: 5px;
color: #666;
}
#peers .new {
bottom: -30px;
}
/*
#peers .me {
background-color: red;
}
*/
</style>

<div class="container-fluid">
<ul id="peers"></ul>
<div class="alert alert-danger"><a class="close" href="#" data-dismiss="alert">&times;</a>By the end of May 2018, the ticketing system at https://ticket.opensciencegrid.org will be retired and support will be provided at https://support.opensciencegrid.org. Throughout this transition the support email (help@opensciencegrid.org) will be available as a point of contact.<br><br>                                                   
                                                                                                                                                                                   
Please see the service migration page for details: https://opensciencegrid.github.io/technology/policy/service-migrations-spring-2018/#ticket</div><div id="presence" class="pull-right"></div><div class="ticketgui"><script type="text/javascript" src="https://ticket.opensciencegrid.org/lib/checktab.js"></script>

<script>
var expanded = false;
function expand_description() {
    var desc = $(".description");
    if(!expanded) {
        expanded = true;
        //expand to minheight
        var min = 250;
        if(desc.height() < min) {
            desc.animate({height: min}, 200);
        }
    }
}

$(document).ready(function() {
    $("input[name='nad']").datepicker({
        dateFormat: 'yy-mm-dd'
    });
});

</script>



<style>
.form-horizontal .control-label {
padding-top: inherit;
font-size:90%;
color:#666;
}
label {
margin-bottom: 0px;
}
.controls {
line-height: 18px;
}
</style>
<form class="form-horizontal" action="https://ticket.opensciencegrid.org/viewer/updatebasic?id=21125" method="post">
<div class="page-header">
    <h3><span class="muted">21125</span> / Gratia not reporting for NET2</h3>
</div>

<div class="row-fluid">
<div class="span5">
    <legend>Contact</legend>
    <div class="control-group">
        <label class="control-label">Full Name</label>
        <div class="controls">Elizabeth Prout</div>
    </div>
    <div class="control-group">
        <label class="control-label">Email</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">Phone</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">CC</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>

    <legend>Details</legend>
    <div class="control-group"><label class="control-label">Resource Name</label><div class="controls">NET2</div></div><div class="control-group"><label class="control-label">Associated VO</label><div class="controls">ATLAS</div></div><div class="control-group"><label class="control-label">Submitted Via</label><div class="controls">GOC Ticket/submit</div></div><div class="control-group"><label class="control-label">Submitter</label><div class="controls">Elizabeth Prout</div></div><div class="control-group"><label class="control-label">Support Center</label><div class="controls">USATLAS</div></div>
    <div class="control-group">
        <label class="control-label">Ticket Type</label>
        <div class="controls">Problem/Request</div>
    </div>
    <div class="control-group">
        <label class="control-label">Priority</label>
        <div class="controls">Normal</div>
    </div>
    <div class="control-group">
        <label class="control-label">Status</label>
        <div class="controls">
Closed</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action</label>
        <div class="controls">ENG Action</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action Deadline</label>
        <div class="controls flag_red">2014-06-11</div>
    </div>

</div><!--span-->
<div class="span7">
    <legend>Assignees</legend>
    <div class="assignee" style="width: 60%">USATLAS (BNL Prod)&nbsp;<a target="_blank" href="https://rt.racf.bnl.gov/rt/Ticket/Display.html?id=24414">24414</a> <span class="muted"> / Ticket Exchange</span></div>    <br>

    <legend>Assignees</legend>
    TODO
    <br>

    <style>
legend.noborder {
border-bottom: none;
}
</style>

<div id="attachment-list"/>
<script>
$(function () {
    var first = true;
    $.getJSON("https://ticket.opensciencegrid.org/attachment/list?id=21125", function (files) {
        //console.dir(files);
        var html = "<table class=\"table table-condensed\">";
        $(files).each(function() {
            if(first) {
                first = false;
                html += "<legend class=\"noborder\">Attachmenets</legend>";
            }
            html += "<tr class=\"attachment\">";
            html += "<td><img src=\""+this.thumbnail_url+"\"/></td>";
            html += "<td><a href=\""+this.url+"\" target=\"_blank\">"+this.name+"</a></td>";
            html += "<td>"+bytesToSize(this.size, 1)+"</td>";
            html += "</tr>";
        });
        html += "</table>";
        $("#attachment-list").html(html);
    });
});

function download(url) {
    window.open(url, "_blank");
}
</script>


</div><!--span-->
</div><!--row-fluid-->


</form>

</div>
<div id="updates" style="clear: both;">
    <legend>Past Updates
    <div class="btn-toolbar pull-right toolbar">
        <div class="btn-group">
                <a class="btn btn-small" href="/21125?sort=up&"><i class="icon-arrow-up"></i> Sort</a>

        
        <a class="btn btn-small" href="/21125?expandall=true&">Expand Descriptions</a>        <a class="btn btn-small" target="_blank" href="mailto:osg@tick.globalnoc.iu.edu?subject=Open%20Science%20Grid%3A%20Gratia%20not%20reporting%20for%20NET2%20ISSUE%3D21125%20PROJ%3D71"><i class="icon-envelope"></i> Update w/Email</a>
        </div>
    </div><!--btn-toolbar-->
    </legend>

    <div class='update_description'><i onclick="document.location='21125#1402670351'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-06-13T14:39:11+00:00">Jun 13, 2014 02:39 PM UTC</time> by <b>catharine.noble@....</b><a class="anchor" name="1402670351">&nbsp;</a></div><pre>Hi - it&#39;s all updated on the pdf now, same link&#58;  <a href='https&#58;//espace2013.cern.ch/WLCG-document-repository/Accounting/Tier-2/2014/may-14/Tier2_Accounting_Report_May.pdf' target='_blank' rel='nofollow'>https&#58;//espace2013.cern.ch/WLCG-document-repository/Accounting/Tier-2/2014/may-14/Tier2_Accounting_Report_May.pdf</a>

Have a great weekend.

Kind regards,
Cath

On Jun 10, 2014, at 6&#58;18 PM, Open Science Grid FootPrints wrote&#58;

[Duplicate message snipped]</pre></div><div class='update_description'><i onclick="document.location='21125#1402579546'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-06-12T13:25:46+00:00">Jun 12, 2014 01:25 PM UTC</time> by <b>echism</b><a class="anchor" name="1402579546">&nbsp;</a></div><pre>Closing as requested.

Thank you.</pre></div><div class='update_description'><i onclick="document.location='21125#1402525949'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-06-11T22:32:29+00:00">Jun 11, 2014 10:32 PM UTC</time> by <b>Marco Mambelli</b><a class="anchor" name="1402525949">&nbsp;</a></div><pre>Augustine, all,
Since Augustine fixed the gridengine bug and the probe is back to normal, I&#39;d like to close this ticket. Here some last notes and to-dos.

Assuming that the bug was introduced sometime in may, here is a document summarizing the jobs (number, CPU hours and Wall time) mis-reported&#58; <a href='https&#58;//docs.google.com/spreadsheets/d/1LMon0M6WvwlreWthVMFcRCns_RKRPDLVSYfOymuegYc/edit#gid=565049882' target='_blank' rel='nofollow'>https&#58;//docs.google.com/spreadsheets/d/1LMon0M6WvwlreWthVMFcRCns_RKRPDLVSYfOymuegYc/edit#gid=565049882</a>

The &#34;Balance&#34; sheet reports the numbers distinguishing ATLAS, Local and OSG users (OSG includes all opportunistic use, because it is impossible to distinguish since they all run under the osg account). Use the line in red, I reported Num (number of jobs), CPU User/Sys (user and system CPU hours used by the jobs), Time (wall time in hours)
In short ATLAS number are inflated of ~20 thousand jobs (15K CPU hours, 23K wall hours). These should have been mostly opportunistic jobs, some local.

The details of the calculation are in the other sheets and the numbers come form a Gratia query like&#58;
select  CommonName, VOName, ReportableVOName, GlobalUserName, LocalUserId, count(*) as &#39;JobNum&#39;, SUM(&#96;CpuUserDuration&#96;) as &#39;CpuUser&#39;, SUM(&#96;CpuSystemDuration&#96;) as &#39;CpuSys&#39;, SUM(&#96;WallDuration&#96;) as &#39;WallT&#39;  from &#96;JobUsageRecord_Meta&#96; M, JobUsageRecord J where ProbeName = &#39;sge&#58;atlas-net2.bu.edu&#39; and M.dbid=J.dbid and ServerDate &#62; &#34;2014-05-01&#34; group by CommonName, VOName, ReportableVOName, GlobalUserName, LocalUserId;

Some last items before closing this ticket&#58;
1. When was this bug introduced?
2. The document above is available. I can explain it further. There is no plan to change the data in Gratia.
3. If the ATLAS T2 coordinator or LHC people want to correct the data reported, they can use the numbers in the document

Cheers,
Marco</pre></div><div class='update_description'><i onclick="document.location='21125#1402515012'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-06-11T19:30:12+00:00">Jun 11, 2014 07:30 PM UTC</time> by <b>augustine@....</b><a class="anchor" name="1402515012">&nbsp;</a></div><pre>1) Marco was correct about job ids rolling over.  It&#39;s due to a
gridengine bug which we &#34;cleared&#34; and do not expect this to happen going
forward.

2) I re-enabled cron and gratia probe is running.

3) I am completely swamped, so I will only be able to update gratia sge
probe to 1.13.29 on friday.

- Augustine

On 06/11/2014 12&#58;54 PM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='21125#1402505679'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-06-11T16:54:39+00:00">Jun 11, 2014 04:54 PM UTC</time><a class="anchor" name="1402505679">&nbsp;</a></div><pre>Augustine / Saul / Marco
We are all caught up through today.

Can we put the certinfo mystery in a separate goc/jira ticket?
Please have me cc&#39;d on it as I am interested in understanding the issue.

It would be good if this ticket stayed focused on insuring the daily/hourly (whatever it is)
cron running of the probe and reporting to Gratia.

1. Will we be updating the probe to 1.13.29?
2. Are we back to the cron execution of the probe?

Once we see it is working for a couple days, we can close this ticket.

Thanks
John Weigand

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=John Weigand 144</pre></div><div class='update_description'><i onclick="document.location='21125#1402428096'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-06-10T19:21:36+00:00">Jun 10, 2014 07:21 PM UTC</time> by <b>Marco Mambelli</b><a class="anchor" name="1402428096">&nbsp;</a></div><pre>Hi Augustine,
the probe is safe to restart and your action very likely helped the speedup. The probe probably never run on such a big file and may have some inefficiencies that were cleared up by the restart.

Anyway I still think the certinfo files rolled over. The data reported is plausible but it is incorrect.
The JOB_ID (or job_number) I&#39;m referring to is the 6th field in the accounting file, that seems to be used in the naming of the certinfo files and is referred as LocalJobId inside the certinfo file. This is different from the UniqID inside the certinfo file that I don&#39;t know how is evaluated. E.g.&#58;
&#60;UniqID&#62;16362044666372386386.6053409348385816469&#60;/UniqID&#62;
&#60;LocalJobId&#62;1034&#60;/LocalJobId&#62;

In the accounting file I see duplicates (same number more than once) and it seems never to grow over tens of thousand. I don&#39;t know if the reason for duplicate IDs is due to the use of multiple queues, to roll-over or to some other accidental reset. Something happened, more than once since May 9 2014 (the first record in the accounting file).

&#34;qacct -j 1034&#34; shows duplicates, some on the same queue, the last completed job from yesterday. And there is a job queued with the same ID (&#34;qstat -j 1034&#34;). Both these are from ATLAS.

Here is a query to the Gratia DB that shows how the VO/DN information coming form the certinfo file (CommonName, VOName, ReportableVOName) not always match the info coming form the unix user (GlobalUserName, LocalUserId). This is an error because the probe used the wrong certinfo files. The query counts the jobs form the beginning of May.
A job submitted with John&#39;s ATLAS production proxy is very unlikely that ran using the aomartin account.

+--------------------------------------------------------+------------------------------------------------+------------------+-------------------------+-------------+----------+
| CommonName                                             | VOName                                         | ReportableVOName | GlobalUserName          | LocalUserId | count(*) |
+--------------------------------------------------------+------------------------------------------------+------------------+-------------------------+-------------+----------+
| /CN=ddmadmin/CN=531497/CN=Robot&#58; ATLAS Data Management | /atlas/Role=lcgadmin/Capability=NULL           | atlas            | Adam  Martin            | aomartin    |        5 |
| /CN=ddmadmin/CN=531497/CN=Robot&#58; ATLAS Data Management | /atlas/Role=lcgadmin/Capability=NULL           | atlas            | Clare  Bernard          | clare1      |       26 |
| /CN=ddmadmin/CN=531497/CN=Robot&#58; ATLAS Data Management | /atlas/Role=lcgadmin/Capability=NULL           | atlas            | iVDGL                   | usatlas1    |      261 |
| /CN=ddmadmin/CN=531497/CN=Robot&#58; ATLAS Data Management | /atlas/Role=lcgadmin/Capability=NULL           | atlas            | OSG osg                 | osg         |        3 |
| /CN=ddmadmin/CN=531497/CN=Robot&#58; ATLAS Data Management | /atlas/Role=NULL/Capability=NULL               | atlas            | Adam  Martin            | aomartin    |        1 |
| /CN=ddmadmin/CN=531497/CN=Robot&#58; ATLAS Data Management | /atlas/Role=NULL/Capability=NULL               | atlas            | Clare  Bernard          | clare1      |        5 |
| /CN=ddmadmin/CN=531497/CN=Robot&#58; ATLAS Data Management | /atlas/Role=NULL/Capability=NULL               | atlas            | iVDGL                   | usatlas1    |       29 |
| /CN=ddmadmin/CN=531497/CN=Robot&#58; ATLAS Data Management | /atlas/Role=pilot/Capability=NULL              | atlas            | Adam  Martin            | aomartin    |       10 |
| /CN=ddmadmin/CN=531497/CN=Robot&#58; ATLAS Data Management | /atlas/Role=pilot/Capability=NULL              | atlas            | Clare  Bernard          | clare1      |       32 |
| /CN=ddmadmin/CN=531497/CN=Robot&#58; ATLAS Data Management | /atlas/Role=pilot/Capability=NULL              | atlas            | iVDGL                   | usatlas1    |      354 |
| /CN=ddmadmin/CN=531497/CN=Robot&#58; ATLAS Data Management | /atlas/Role=pilot/Capability=NULL              | atlas            | OSG osg                 | osg         |        8 |
| /CN=Derek Weitzel 605                                  | /hcc/Role=NULL/Capability=NULL                 | hcc              | Adam  Martin            | aomartin    |       12 |
| /CN=Derek Weitzel 605                                  | /hcc/Role=NULL/Capability=NULL                 | hcc              | Clare  Bernard          | clare1      |       34 |
| /CN=Derek Weitzel 605                                  | /hcc/Role=NULL/Capability=NULL                 | hcc              | iVDGL                   | usatlas1    |      271 |
| /CN=Derek Weitzel 605                                  | /hcc/Role=NULL/Capability=NULL                 | hcc              | OSG osg                 | osg         |       10 |
| /CN=John Hover                                         | /atlas/usatlas/Role=production/Capability=NULL | atlas            | Adam  Martin            | aomartin    |      456 |
| /CN=John Hover                                         | /atlas/usatlas/Role=production/Capability=NULL | atlas            | Clare  Bernard          | clare1      |    18400 |
<div id='show_669315156' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_669315156'>| /CN=John Hover                                         | /atlas/usatlas/Role=production/Capability=NULL | atlas            | iVDGL                   | usatlas1    |   210954 |
| /CN=John Hover                                         | /atlas/usatlas/Role=production/Capability=NULL | atlas            | OSG osg                 | osg         |     1784 |
| /CN=Mark Santcroos                                     | /osg/Role=NULL/Capability=NULL                 | osg              | iVDGL                   | usatlas1    |        2 |
| /CN=pilot/glidein2.chtc.wisc.edu                       | /GLOW/Role=NULL/Capability=NULL                | GLOW             | Adam  Martin            | aomartin    |       11 |
| /CN=pilot/glidein2.chtc.wisc.edu                       | /GLOW/Role=NULL/Capability=NULL                | GLOW             | Clare  Bernard          | clare1      |       15 |
| /CN=pilot/glidein2.chtc.wisc.edu                       | /GLOW/Role=NULL/Capability=NULL                | GLOW             | iVDGL                   | usatlas1    |      599 |
| /CN=pilot/glidein2.chtc.wisc.edu                       | /GLOW/Role=NULL/Capability=NULL                | GLOW             | OSG osg                 | osg         |       22 |
| /CN=pilot/osg-flock.grid.iu.edu                        | /osg/Role=NULL/Capability=NULL                 | osg              | Adam  Martin            | aomartin    |        2 |
| /CN=pilot/osg-flock.grid.iu.edu                        | /osg/Role=NULL/Capability=NULL                 | osg              | Clare  Bernard          | clare1      |       10 |
| /CN=pilot/osg-flock.grid.iu.edu                        | /osg/Role=NULL/Capability=NULL                 | osg              | iVDGL                   | usatlas1    |      775 |
| /CN=pilot/osg-flock.grid.iu.edu                        | /osg/Role=NULL/Capability=NULL                 | osg              | OSG osg                 | osg         |      436 |
| /CN=Saul Youssef 93                                    | /atlas/Role=NULL/Capability=NULL               | atlas            | Adam  Martin            | aomartin    |        2 |
| /CN=Saul Youssef 93                                    | /atlas/Role=NULL/Capability=NULL               | atlas            | Clare  Bernard          | clare1      |      133 |
| /CN=Saul Youssef 93                                    | /atlas/Role=NULL/Capability=NULL               | atlas            | iVDGL                   | usatlas1    |     1519 |
| /CN=Saul Youssef 93                                    | /atlas/Role=NULL/Capability=NULL               | atlas            | OSG osg                 | osg         |       30 |
| Adam  Martin                                           | Unknown                                        | NULL             | Adam  Martin            | aomartin    |      539 |
| Augustinas Abaravichyus                                | Unknown                                        | NULL             | Augustinas Abaravichyus | augustin    |        1 |
| Clare  Bernard                                         | Unknown                                        | NULL             | Clare  Bernard          | clare1      |    73033 |
| iVDGL                                                  | atlas                                          | ATLAS            | iVDGL                   | usatlas1    |   654408 |
| Kevin  Black                                           | Unknown                                        | NULL             | Kevin  Black            | kblack      |      115 |
| OSG ops                                                | ops                                            | OPS              | OSG ops                 | ops         |        8 |
| OSG osg                                                | osg                                            | OSG              | OSG osg                 | osg         |     4648 |
| Saul  Youssef                                          | Unknown                                        | NULL             | Saul  Youssef           | youssef     |       30 |
+--------------------------------------------------------+------------------------------------------------+------------------+-------------------------+-------------+----------+
</div><script type='text/javascript'>
        $('#show_669315156').click(function() {
            $('#detail_669315156').slideDown("normal");
            $('#show_669315156').hide();
            $('#hide_669315156').show();
        });
        $('#hide_669315156').click(function() {
            $('#detail_669315156').slideUp();
            $('#hide_669315156').hide();
            $('#show_669315156').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='21125#1402420742'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-06-10T17:19:02+00:00">Jun 10, 2014 05:19 PM UTC</time> by <b>augustine@....</b><a class="anchor" name="1402420742">&nbsp;</a></div><pre>Earlier on, I tried to point out some things I observed in an strace of
the probe, and asked about restarting the probe.  I don&#39;t think I
communicated my thoery of why it was slow well enough and we were got
distracted troubleshooting other things.  My understanding is that
gratia probe is safe to restart, so I decided to test my theory about
slowness and restarted the probe.  It coincided with this speed-up.
Perhaps this is a moot point, as this is most likely fixed in te newer
version of gratia anyway.

- Augustine

On 06/10/2014 12&#58;21 PM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='21125#1402420333'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-06-10T17:12:13+00:00">Jun 10, 2014 05:12 PM UTC</time> by <b>augustine@....</b><a class="anchor" name="1402420333">&nbsp;</a></div><pre>Hi Marco

I made .sav file directory by hand, in order to preserve some
evidence in case we need to dig deeper after gratia probe is done
processing and deleting those files.  I&#39;ll remove them once the dust
settles.

Grid engine job range is much greater, it&#39;s 0 to 9999999.  10 million,
not 100,000. Our job id&#39;s have only rolled over once in the entire time
we&#39;ve been using SGE on NET2 cluster.

- Augustine

On 06/10/2014 12&#58;20 PM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='21125#1402418593'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-06-10T16:43:13+00:00">Jun 10, 2014 04:43 PM UTC</time><a class="anchor" name="1402418593">&nbsp;</a></div><pre>Saul,
In regard to Clare&#39;s jobs.
It was not her that spiked it.  It was ....
+----------+--------------------------------------------------------+------------+---------+------------+--------+--------+
| SiteName | CommonName                                             | Period     | VOName  | Sum(NJobs) | SumCPU | SumWCT |
+----------+--------------------------------------------------------+------------+---------+------------+--------+--------+
| NET2     | iVDGL                                                  | 2014-05-20 | atlas   |      13838 |  36653 |  40005 |
| NET2     | iVDGL                                                  | 2014-05-21 | atlas   |      12948 |  47739 |  55505 |
| NET2     | iVDGL                                                  | 2014-05-22 | atlas   |      40046 |  41187 |  46140 |
| NET2     | iVDGL                                                  | 2014-05-23 | atlas   |      70805 |  50032 |  56455 |
| NET2     | iVDGL                                                  | 2014-05-24 | atlas   |      19824 |  26696 |  30936 |
| NET2     | iVDGL                                                  | 2014-05-25 | atlas   |       5979 |  57200 |  63282 |
+----------+--------------------------------------------------------+------------+---------+------------+--------+--------+

Her activity was not that much...
+----------+--------------------------------------------------------+------------+---------+------------+--------+--------+
| SiteName | CommonName                                             | Period     | VOName  | Sum(NJobs) | SumCPU | SumWCT |
+----------+--------------------------------------------------------+------------+---------+------------+--------+--------+
| NET2     | Clare  Bernard                                         | 2014-05-01 | Unknown |      10797 |    569 |   1134 |
| NET2     | Clare  Bernard                                         | 2014-05-02 | Unknown |       8044 |    453 |    605 |
| NET2     | Clare  Bernard                                         | 2014-05-03 | Unknown |       4763 |    510 |    597 |
| NET2     | Clare  Bernard                                         | 2014-05-05 | Unknown |        225 |     19 |     27 |
| NET2     | Clare  Bernard                                         | 2014-05-06 | Unknown |       1404 |      4 |      7 |
| NET2     | Clare  Bernard                                         | 2014-05-07 | Unknown |       6218 |     21 |     32 |
| NET2     | Clare  Bernard                                         | 2014-05-08 | Unknown |         18 |      0 |      0 |
| NET2     | Clare  Bernard                                         | 2014-05-09 | Unknown |        363 |     19 |     24 |
| NET2     | Clare  Bernard                                         | 2014-05-10 | Unknown |        257 |     14 |     18 |
| NET2     | Clare  Bernard                                         | 2014-05-14 | Unknown |       5840 |     25 |     42 |
| NET2     | Clare  Bernard                                         | 2014-05-20 | Unknown |         20 |      0 |      4 |
| NET2     | Clare  Bernard                                         | 2014-05-23 | Unknown |         60 |      3 |      7 |
| NET2     | Clare  Bernard                                         | 2014-05-24 | Unknown |         21 |      2 |      3 |
| NET2     | Clare  Bernard                                         | 2014-05-25 | Unknown |         34 |      3 |      4 |
| NET2     | Clare  Bernard                                         | 2014-05-29 | Unknown |       7249 |     65 |     81 |
| NET2     | Clare  Bernard                                         | 2014-05-30 | Unknown |        601 |     81 |     91 |
| NET2     | Clare  Bernard                                         | 2014-06-01 | Unknown |       7354 |    157 |    189 |
<div id='show_128893379' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_128893379'>| NET2     | Clare  Bernard                                         | 2014-06-05 | Unknown |        702 |      1 |      2 |
+----------+--------------------------------------------------------+------------+---------+------------+--------+--------+

John Weigand

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=John Weigand 144
</div><script type='text/javascript'>
        $('#show_128893379').click(function() {
            $('#detail_128893379').slideDown("normal");
            $('#show_128893379').hide();
            $('#hide_128893379').show();
        });
        $('#hide_128893379').click(function() {
            $('#detail_128893379').slideUp();
            $('#hide_128893379').hide();
            $('#show_128893379').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='21125#1402417292'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-06-10T16:21:32+00:00">Jun 10, 2014 04:21 PM UTC</time><a class="anchor" name="1402417292">&nbsp;</a></div><pre>To everyone else...
For whatever reason, we appear to be catching up much faster
and may likely be done in another couple hours.

However, let&#39;s not close this ticket until we accomplish 2 more things&#58;
1. upgrade to the latest probe v1.13.25
2. verify we are getting regular cron updates from NET2 to Gratia.

John Weigand

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=John Weigand 144</pre></div><div class='update_description'><i onclick="document.location='21125#1402417225'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-06-10T16:20:25+00:00">Jun 10, 2014 04:20 PM UTC</time> by <b>Marco Mambelli</b><a class="anchor" name="1402417225">&nbsp;</a></div><pre>Hi Augustine,
I think I found the problem.

Today looking at the certinfo files there are only the ones from June 10 (there is a .sav directory with 6/9 files).
Certinfo files are named /var/lib/gratia/data/gratia_certinfo_sge_JOB_ID
An the job ID is rolling over fairly quickly in your cluster (normally the range in grid engine is 0..99999).
The accounting file has 556143 lines which means that it rolled over 5 times.
E.g. job 1034 ran more times, including&#58; Sat May 10 00&#58;12&#58;46 CDT 2014, Fri May 30 02&#58;58&#58;14 CDT 2014, Sun Jun  8 01&#58;45&#58;04 CDT 2014, Mon Jun  9 02&#58;33&#58;22 CDT 2014 (which refers to the file in /var/lib/gratia/data.sav)

I think new certinfo files over-wrote the old ones and the probe parsing the data of old jobs deleted the files.
This may explain the gap in the certinfo files and the reporting.
But it is bad news because the association done via the certinfo file may be incorrect.

Marco</pre></div><div class='update_description'><i onclick="document.location='21125#1402417081'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-06-10T16:18:01+00:00">Jun 10, 2014 04:18 PM UTC</time><a class="anchor" name="1402417081">&nbsp;</a></div><pre>Cath (lcg accounting),
Unbelievably we have caught up.
The Normalized CPU in May for BU_ATLAS_Tier2 is 15,025,972
Thanks for your patience.
John Weigand

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=John Weigand 144</pre></div><div class='update_description'><i onclick="document.location='21125#1402410397'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-06-10T14:26:37+00:00">Jun 10, 2014 02:26 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1402410397">&nbsp;</a></div><pre>Hi John,

That sounds like good news. I can confirm that accounting from the local SGE
files

<a href='http&#58;//egg.bu.edu/net2/studies%7btype&#58' target='_blank' rel='nofollow'>http&#58;//egg.bu.edu/net2/studies%7btype&#58</a>;egg.Hatch%7d/Gratia-2014-05/

shows no gaps and generally looks as I would expect.

I also remember seeing Clare Bernard submitting many thousands of jobs in big
bursts. They must have either all been very short or mostly failed. I think
this might be causing the slowness. If so, I don&#39;t think we have to do anything
about it (she&#39;s defending her thesis later this month).

- Saul

On Tue Jun 10 08&#58;45&#58;14 2014, osg-goc-rest wrote&#58;
<font color='#7F7E6F'>&#62; The concern over missing certinfo files may be a mute point.</font>
<font color='#7F7E6F'>&#62; From what I am seeing on gratiaweb here...</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;</font>
<a href='http&#58;//gratiaweb.grid.iu.edu/gratia/byvo?starttime=&endtime=&span=86400&relativetime=2592000&facility=net2&exclude-' target='_blank' rel='nofollow'>http&#58;//gratiaweb.grid.iu.edu/gratia/byvo?starttime=&endtime=&span=86400&relativetime=2592000&facility=net2&exclude-</a>
<font color='#7F7E6F'>&#62; facility=&vo=&exclude-vo=&user=&exclude-dn=</font>
<font color='#7F7E6F'>&#62; .... we are still seeing predominantly atlas jobs through 5/27.</font>
<font color='#7F7E6F'>&#62; Which raises the question as to whether or not certinfo files are</font>
<font color='#7F7E6F'>&#62; needed for SGE jobs.</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; In addition, maybe to explain the slowness we&#39;ve seen in recovery,</font>
<font color='#7F7E6F'>&#62; there was a HUGE spike in jobs on 5/23-24 ....</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; <a href='http&#58;//gratiaweb.opensciencegrid.org/gratia/xml/vo_job_cnt?endtime=2014-' target='_blank' rel='nofollow'>http&#58;//gratiaweb.opensciencegrid.org/gratia/xml/vo_job_cnt?endtime=2014-</a></font>
<font color='#7F7E6F'>&#62; 06-01+23%3A59%3A59&span=86400&facility=^NET2%24&probe=.*&resource-</font>
<font color='#7F7E6F'>&#62; type=^Batch%24&vo=.*&role=.*&user=.*&starttime=2014-05-</font>
<font color='#7F7E6F'>&#62; 01+00%3A00%3A00&exclude-facility=NONE|Generic|Obsolete&exclude-</font>
<font color='#7F7E6F'>&#62; user=NONE&includeSuccess=true&exclude-</font>
<div id='show_1755327001' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_1755327001'><font color='#7F7E6F'>&#62; vo=unknown&includeFailed=true&exclude-role=NONE</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; This would be the equivalent of a 5 days of what appears to be a</font>
<font color='#7F7E6F'>&#62; normal</font>
<font color='#7F7E6F'>&#62; load.</font>
<font color='#7F7E6F'>&#62; It has still been abnormally slow and likely needs to still be looked</font>
<font color='#7F7E6F'>&#62; into when we are done.</font>
<font color='#7F7E6F'>&#62; Interestingly enough, the cpu and wall for those periods showed no</font>
<font color='#7F7E6F'>&#62; spike.</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; So, assuming no more spikes, we may get caught up soon... at least for</font>
<font color='#7F7E6F'>&#62; May reporting.</font>
<font color='#7F7E6F'>&#62; We still have June to go.</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; John Weigand</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=John</font>
<font color='#7F7E6F'>&#62; Weigand 144</font>
<font color='#7F7E6F'>&#62; -- by goc at Tue Jun 10 12&#58;44&#58;45 UTC 2014</font>
-- by youssef@.... at Tue Jun 10 14&#58;26&#58;20 UTC 2014

GOCTX Source&#58; BNL Ticket&#58; Queue=NETier2 ID=24414
</div><script type='text/javascript'>
        $('#show_1755327001').click(function() {
            $('#detail_1755327001').slideDown("normal");
            $('#show_1755327001').hide();
            $('#hide_1755327001').show();
        });
        $('#hide_1755327001').click(function() {
            $('#detail_1755327001').slideUp();
            $('#hide_1755327001').hide();
            $('#show_1755327001').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='21125#1402404285'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-06-10T12:44:45+00:00">Jun 10, 2014 12:44 PM UTC</time><a class="anchor" name="1402404285">&nbsp;</a></div><pre>The concern over missing certinfo files may be a mute point.
From what I am seeing on gratiaweb here...
<a href='http&#58;//gratiaweb.grid.iu.edu/gratia/byvo?starttime=&endtime=&span=86400&relativetime=2592000&facility=net2&exclude-facility=&vo=&exclude-vo=&user=&exclude-dn=' target='_blank' rel='nofollow'>http&#58;//gratiaweb.grid.iu.edu/gratia/byvo?starttime=&endtime=&span=86400&relativetime=2592000&facility=net2&exclude-facility=&vo=&exclude-vo=&user=&exclude-dn=</a>
.... we are still seeing predominantly atlas jobs through 5/27.
Which raises the question as to whether or not certinfo files are needed for SGE jobs.

In addition, maybe to explain the slowness we&#39;ve seen in recovery, there was a HUGE spike in jobs on 5/23-24 ....
<a href='http&#58;//gratiaweb.opensciencegrid.org/gratia/xml/vo_job_cnt?endtime=2014-06-01+23%3A59%3A59&span=86400&facility=' target='_blank' rel='nofollow'>http&#58;//gratiaweb.opensciencegrid.org/gratia/xml/vo_job_cnt?endtime=2014-06-01+23%3A59%3A59&span=86400&facility=</a>^NET2%24&probe=.*&resource-type=^Batch%24&vo=.*&role=.*&user=.*&starttime=2014-05-01+00%3A00%3A00&exclude-facility=NONE|Generic|Obsolete&exclude-user=NONE&includeSuccess=true&exclude-vo=unknown&includeFailed=true&exclude-role=NONE

This would be the equivalent of a 5 days of what appears to be a normal load.
It has still been abnormally slow and likely needs to still be looked into when we are done.
Interestingly enough, the cpu and wall for those periods showed no spike.

So, assuming no more spikes, we may get caught up soon... at least for May reporting.
We still have June to go.

John Weigand

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=John Weigand 144</pre></div><div class='update_description'><i onclick="document.location='21125#1402385231'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-06-10T07:27:11+00:00">Jun 10, 2014 07:27 AM UTC</time> by <b>catharine.noble@....</b><a class="anchor" name="1402385231">&nbsp;</a></div><pre>Hello John,

I&#39;ll run the report as usual and publish; just let me know what correct data should be when you have it, and I&#39;ll manually update the report.

Kind regards,
Cath

On Jun 9, 2014, at 5&#58;33 PM, Open Science Grid FootPrints wrote&#58;

[Duplicate message snipped]</pre></div><div class='update_description'><i onclick="document.location='21125#1402347522'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-06-09T20:58:42+00:00">Jun 9, 2014 08:58 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1402347522">&nbsp;</a></div><pre>Hello Marco,

On Mon, Jun 9, 2014 at 3&#58;23 PM, OSG GOC TX via RT &#60;RT-RACF@....&#62;
wrote&#58;

<font color='#7F7E6F'>&#62; Hi Augustine,</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; the missing gratia_certinfo_* files could mean that either you run</font>
no
<font color='#7F7E6F'>&#62; grid jobs between 5/24 and 6/5 (local jobs are not counted here) or</font>
<font color='#7F7E6F'>&#62; something did not work during those days and we should investigate</font>
more
<font color='#7F7E6F'>&#62; what was.</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;</font>
Please investigate, because we were running PanDA grid production jobs
24/7
throughout this period as usual.  I&#39;ve attached a table of just the
finished jobs as just one of our PanDA sites for May

<font color='#7F7E6F'>&#62; At the moment you are reporting also the jobs of local users (e.g.</font>
<font color='#7F7E6F'>&#62; Clare  Bernard). These are not used by OSG. Unless you particularly</font>
<font color='#7F7E6F'>&#62; care about having them in Gratia (e.g. for your internal accounting)</font>
I
<font color='#7F7E6F'>&#62; would suggest to stop reporting local jobs, this will speed up the</font>
<font color='#7F7E6F'>&#62; parsing and reporting&#58;</font>
<font color='#7F7E6F'>&#62;     SuppressGridLocalRecords=&#34;1&#34;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;</font>
I&#39;m surprised by this, Marco.  Do you really think that local user job
records is the cause of the slowness?  Clare Bernard is an ATLAS
graduate
student who has used a totally negligible amount of CPU.  I believe
she is
being reported in Gratia on the advice of OSG from a long time ago,
<div id='show_816882156' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_816882156'>but my
main question is - what do you think this has to do with the problem?
Are
you seeing something strange?

- Saul

--
Saul Youssef
Research Associate Professor
Center for Computational Science
Boston University
3 Cummington Street
Boston, MA 02215
youssef@....
<a href='http&#58;//physics.bu.edu/' target='_blank' rel='nofollow'>http&#58;//physics.bu.edu/</a>~youssef
-- by youssef@.... at Mon Jun 09 20&#58;58&#58;23 UTC 2014

GOCTX Source&#58; BNL Ticket&#58; Queue=NETier2 ID=24414
</div><script type='text/javascript'>
        $('#show_816882156').click(function() {
            $('#detail_816882156').slideDown("normal");
            $('#show_816882156').hide();
            $('#hide_816882156').show();
        });
        $('#hide_816882156').click(function() {
            $('#detail_816882156').slideUp();
            $('#hide_816882156').hide();
            $('#show_816882156').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='21125#1402341735'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-06-09T19:22:15+00:00">Jun 9, 2014 07:22 PM UTC</time> by <b>Marco Mambelli</b><a class="anchor" name="1402341735">&nbsp;</a></div><pre>Hi Augustine,
the missing gratia_certinfo_* files could mean that either you run no grid jobs between 5/24 and 6/5 (local jobs are not counted here) or something did not work during those days and we should investigate more what was.

At the moment you are reporting also the jobs of local users (e.g. Clare  Bernard). These are not used by OSG. Unless you particularly care about having them in Gratia (e.g. for your internal accounting) I would suggest to stop reporting local jobs, this will speed up the parsing and reporting&#58;
SuppressGridLocalRecords=&#34;1&#34;

At the moment there are no records reported that miss the gratia_certinfo_*. They would be seen as non local records from Unknown VO.

For your information, some data from your Gratia records.
Local users, without certificates and Grid=Local&#58;
+-------------------------+
| CommonName        |
+-------------------------+
| Clare  Bernard          |
| Adam  Martin            |
| Augustinas Abaravichyus |
| Saul  Youssef           |
+-------------------------+

Users from Grid jobs without and with certificate&#58;

+------------+--------+
| CommonName | VOName |
+------------+--------+
| iVDGL      | atlas  |
| OSG GLOW   | glow   |
| OSG osg    | osg    |
| OSG ops    | ops    |
+------------+--------+

+--------------------------------------------------------+--------+
| CommonName                                             | VOName |
+--------------------------------------------------------+--------+
| /CN=John Hover                                         | atlas  |
| /CN=Saul Youssef 93                                    | atlas  |
<div id='show_36512753' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_36512753'>| /CN=ddmadmin/CN=531497/CN=Robot&#58; ATLAS Data Management | atlas  |
| /CN=pilot/osg-flock.grid.iu.edu                        | osg    |
| /CN=pilot/glidein2.chtc.wisc.edu                       | glow   |
| /CN=Derek Weitzel 605                                  | hcc    |
| iVDGL                                                  | atlas  |
| OSG osg                                                | osg    |
| /CN=Mark Santcroos                                     | osg    |
+--------------------------------------------------------+--------+

Cheers,
Marco
</div><script type='text/javascript'>
        $('#show_36512753').click(function() {
            $('#detail_36512753').slideDown("normal");
            $('#show_36512753').hide();
            $('#hide_36512753').show();
        });
        $('#hide_36512753').click(function() {
            $('#detail_36512753').slideUp();
            $('#hide_36512753').hide();
            $('#show_36512753').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='21125#1402341722'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-06-09T19:22:02+00:00">Jun 9, 2014 07:22 PM UTC</time> by <b>Marco Mambelli</b><a class="anchor" name="1402341722">&nbsp;</a></div><pre>Hi Augustine,
the missing gratia_certinfo_* files could mean that either you run no grid jobs between 5/24 and 6/5 (local jobs are not counted here) or something did not work during those days and we should investigate more what was.

At the moment you are reporting also the jobs of local users (e.g. Clare  Bernard). These are not used by OSG. Unless you particularly care about having them in Gratia (e.g. for your internal accounting) I would suggest to stop reporting local jobs, this will speed up the parsing and reporting&#58;
SuppressGridLocalRecords=&#34;1&#34;

At the moment there are no records reported that miss the gratia_certinfo_*. They would be seen as non local records from Unknown VO.

For your information, some data from your Gratia records.
Local users, without certificates and Grid=Local&#58;
+-------------------------+
| CommonName        |
+-------------------------+
| Clare  Bernard          |
| Adam  Martin            |
| Augustinas Abaravichyus |
| Saul  Youssef           |
+-------------------------+

Users from Grid jobs without and with certificate&#58;

+------------+--------+
| CommonName | VOName |
+------------+--------+
| iVDGL      | atlas  |
| OSG GLOW   | glow   |
| OSG osg    | osg    |
| OSG ops    | ops    |
+------------+--------+

+--------------------------------------------------------+--------+
| CommonName                                             | VOName |
+--------------------------------------------------------+--------+
| /CN=John Hover                                         | atlas  |
| /CN=Saul Youssef 93                                    | atlas  |
<div id='show_1599670150' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_1599670150'>| /CN=ddmadmin/CN=531497/CN=Robot&#58; ATLAS Data Management | atlas  |
| /CN=pilot/osg-flock.grid.iu.edu                        | osg    |
| /CN=pilot/glidein2.chtc.wisc.edu                       | glow   |
| /CN=Derek Weitzel 605                                  | hcc    |
| iVDGL                                                  | atlas  |
| OSG osg                                                | osg    |
| /CN=Mark Santcroos                                     | osg    |
+--------------------------------------------------------+--------+

Cheers,
Marco
</div><script type='text/javascript'>
        $('#show_1599670150').click(function() {
            $('#detail_1599670150').slideDown("normal");
            $('#show_1599670150').hide();
            $('#hide_1599670150').show();
        });
        $('#hide_1599670150').click(function() {
            $('#detail_1599670150').slideUp();
            $('#hide_1599670150').hide();
            $('#show_1599670150').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='21125#1402340595'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-06-09T19:03:15+00:00">Jun 9, 2014 07:03 PM UTC</time> by <b>Saul Youssef</b><a class="anchor" name="1402340595">&nbsp;</a></div><pre>Hi,

On Mon, Jun 9, 2014 at 1&#58;41 PM, Augustine Abaris &#60;augustine@....&#62; wrote&#58;

<font color='#7F7E6F'>&#62; Marco,</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; could you please explain about the &#34;whole&#34; from 5/23 to 6/6  (I&#39;m reading</font>
<font color='#7F7E6F'>&#62; this as a &#34;hole&#34;) ??  This sounds like a big problem.  How are those</font>
<font color='#7F7E6F'>&#62; records unusable?  We have all the logs from globus and the batch system,</font>
<font color='#7F7E6F'>&#62; can we re-construct these?  I&#39;m hoping I&#39;m misunderstanding you, so for now</font>
<font color='#7F7E6F'>&#62; I&#39;ll proceed with an attempt to respond to other questions.</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;</font>
Yes, a hole is a problem that we should definitely fix if possible and
prevent in the future.

<font color='#7F7E6F'>&#62; the extra info you asking about is not from a log, I&#39;ve attached to the</font>
<font color='#7F7E6F'>&#62; process using strace command to see what was going on.</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; the reason I thought of restarting the sge_meter script was because I was</font>
<font color='#7F7E6F'>&#62; wondering if that would regenerate a fresh list of files to scan for and</font>
<font color='#7F7E6F'>&#62; reduce the number of pointless stat() calls.  It&#39;s only a theory that those</font>
<font color='#7F7E6F'>&#62; stats are what&#39;s taking most of the time, but do dominate the count of</font>
<font color='#7F7E6F'>&#62; system calls the processing script is making.</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; I will look into our options for bugfix upgrades when all is said and done</font>
<font color='#7F7E6F'>&#62; and we&#39;re all caught up with the backlog and running this probe only to</font>
<font color='#7F7E6F'>&#62; process new records.</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; To answer your previous question about disabling cron, yes it is disabled</font>
<font color='#7F7E6F'>&#62; (to spare me from a lot of emails).  There&#39;s only one instance running, I</font>
<font color='#7F7E6F'>&#62; find that the SGE probe is very good at detecting a lock/run file and</font>
<font color='#7F7E6F'>&#62; exiting immediately.</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; I don&#39;t see an issue with you taking a copy of the files you mention, but</font>
<div id='show_20951574' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_20951574'><font color='#7F7E6F'>&#62; I would like for Saul Youssef to confirm that it&#39;s ok.  I&#39;m cc&#39;ing him as</font>
<font color='#7F7E6F'>&#62; well as adding him to this ticket.</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;</font>
No problem.  - Saul

<font color='#7F7E6F'>&#62; - Augustine</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; On 06/09/2014 01&#58;06 PM, Open Science Grid FootPrints wrote&#58;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;&#62; [Duplicate message snipped]</font>
</div><script type='text/javascript'>
        $('#show_20951574').click(function() {
            $('#detail_20951574').slideDown("normal");
            $('#show_20951574').hide();
            $('#hide_20951574').show();
        });
        $('#hide_20951574').click(function() {
            $('#detail_20951574').slideUp();
            $('#hide_20951574').hide();
            $('#show_20951574').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='21125#1402335916'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-06-09T17:45:16+00:00">Jun 9, 2014 05:45 PM UTC</time> by <b>augustine@....</b><a class="anchor" name="1402335916">&nbsp;</a></div><pre>Marco,

could you please explain about the &#34;whole&#34; from 5/23 to 6/6  (I&#39;m
reading this as a &#34;hole&#34;) ??  This sounds like a big problem.  How are
those records unusable?  We have all the logs from globus and the batch
system, can we re-construct these?  I&#39;m hoping I&#39;m misunderstanding you,
so for now I&#39;ll proceed with an attempt to respond to other questions.

the extra info you asking about is not from a log, I&#39;ve attached to the
process using strace command to see what was going on.

the reason I thought of restarting the sge_meter script was because I
was wondering if that would regenerate a fresh list of files to scan for
and reduce the number of pointless stat() calls.  It&#39;s only a theory
that those stats are what&#39;s taking most of the time, but do dominate the
count of system calls the processing script is making.

I will look into our options for bugfix upgrades when all is said and
done and we&#39;re all caught up with the backlog and running this probe
only to process new records.

To answer your previous question about disabling cron, yes it is
disabled (to spare me from a lot of emails).  There&#39;s only one instance
running, I find that the SGE probe is very good at detecting a lock/run
file and exiting immediately.

I don&#39;t see an issue with you taking a copy of the files you mention,
but I would like for Saul Youssef to confirm that it&#39;s ok.  I&#39;m cc&#39;ing
him as well as adding him to this ticket.

- Augustine

On 06/09/2014 01&#58;06 PM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='21125#1402334113'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-06-09T17:15:13+00:00">Jun 9, 2014 05:15 PM UTC</time> by <b>Bobby Ball</b><a class="anchor" name="1402334113">&nbsp;</a></div><pre>The non-correlated gratio_certinfo file presence may be due to an osg
bug, fixed in the osg 3.2.10 release.  I think it was also present in
the 3.1 series after some point.  The files were simply not being
deleted at the end of reporting.  This affected AGLT2 for a few months.

bob

On 6/9/2014 1&#58;06 PM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='21125#1402333570'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-06-09T17:06:10+00:00">Jun 9, 2014 05:06 PM UTC</time> by <b>Marco Mambelli</b><a class="anchor" name="1402333570">&nbsp;</a></div><pre>Hi Augustine,
I removed LCG accounting from CC. They will issue a report and update it once the final data is there.

I saw the log level and it seems OK (2).
I don&#39;t know why all this extra information is printed.
The certinfo files now are only 14000, so the globbing should not be a problem.
It should not attempt to check 20 times for the file, should look for something like &#34;/var/lib/gratia/data/gratia_certinfo_sge_73622*&#34;, but the probe you are running is fairly dated and may be different and I&#39;m not so familiar with the SGE probe.
Carl and Lisa are more familiar with it.

Then you have a whole in the certinfo files between 5/23 and 6/6. This means that those record will likely be unusable because there is no information about who ran those jobs.

I talked also with John. At this point I&#39;ll leave the process running even if it is slow (at least if it is not interfering with the gatekeeper and jobs are running fine). It is making progress.
When it is done we&#39;ll notify LCG to update the reports.
And I would suggest you to update the probe.
I noticed that there are some small modification to the probe script. Put back the original or move the changed one, otherwise the RPM upgrade may complain.

Chers,
Marco

PS I&#39;d like to copy the accounting file and certinfo to do some local test/benchmark on my machine. Let me know if you prefer me not to do it. Thanks</pre></div><div class='update_description'><i onclick="document.location='21125#1402327993'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-06-09T15:33:13+00:00">Jun 9, 2014 03:33 PM UTC</time> by <b>augustine@....</b><a class="anchor" name="1402327993">&nbsp;</a></div><pre>Is there anything I can do to further investigate the slowness?

SGE accounting log is 185MB
/var/lib/gratia/data is 46MB - 7212 files
sge_meter python script is using about 181MB of memory and is constantly
using 100% of a single core.

on a closer look strace for sge_meter script is showing that it&#39;s
spending most of it&#39;s time in&#58;

stat(&#34;/var/lib/gratia/data/gratia_certinfo_sge_73622.0.0&#34;,
0x7fff33fa2320) = -1 ENOENT (No such file or directory)
stat(&#34;/var/lib/gratia/data/gratia_certinfo_sge_73622&#34;, 0x7fff33fa2320) =
-1 ENOENT (No such file or directory)

does it for a bout a minute and then processes a bunch of records, then
goes back to that. (it tries a file with same job ID about 20 something
times, then moves on to another job id and does that another 20 times).

I could kill it and restart it if that&#39;s safe enough to do and will not
send it back to reprocess older logs.

- Augustine

On 06/06/2014 04&#58;08 PM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='21125#1402327168'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-06-09T15:19:28+00:00">Jun 9, 2014 03:19 PM UTC</time> by <b>Marco Mambelli</b><a class="anchor" name="1402327168">&nbsp;</a></div><pre>Augustine,
make sure that the cron probe is not running while you run this manually (they would contend for IO on the same file and send duplicate records)&#58;
service gratia-probes-cron stop

then the log files are very detailed. This may delay the process because there is a lot of IO.
Which are your values of DebugLevel and LogLevel?
Now you should have&#58;
LogLevel=&#34;2&#34;
DebugLevel=&#34;0&#34;

If your levels are different change the values and restart the process sending these records.

Let&#39;s see if this helps increasing the speed.
Thanks,
Marco</pre></div><div class='update_description'><i onclick="document.location='21125#1402319526'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-06-09T13:12:06+00:00">Jun 9, 2014 01:12 PM UTC</time><a class="anchor" name="1402319526">&nbsp;</a></div><pre>Cath (lcg accounting),

The NET2 Gratia resource we are having problems with is reported to APEL-EGI
as BU_ATLAS_Tier2 (US-NET2 federation)   It is mysteriously slow in catching up to even the end of May.
We have recovered only up to 5/24.  At the current rate, we may not be caught up until
the end of the week.

I am not sure what you want to do for the May report.
Do you want to go ahead and issue it as is?
And can we then update it for May once caught up?

Thanks
John Weigand

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=John Weigand 144</pre></div><div class='update_description'><i onclick="document.location='21125#1402085302'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-06-06T20:08:22+00:00">Jun 6, 2014 08:08 PM UTC</time> by <b>augustine@....</b><a class="anchor" name="1402085302">&nbsp;</a></div><pre>Marco,

logs are too large to upload (even if zipped).  You can grab them from&#58;

<a href='http&#58;//atlas.bu.edu/' target='_blank' rel='nofollow'>http&#58;//atlas.bu.edu/</a>~augustin/gratia.logs/2014-06-05.log.gz
<a href='http&#58;//atlas.bu.edu/' target='_blank' rel='nofollow'>http&#58;//atlas.bu.edu/</a>~augustin/gratia.logs/2014-06-06.log.gz

10 and 20 MB respectively, about 100 and 200MB when unziped.

- Augustine

On 06/06/2014 02&#58;21 PM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='21125#1402078883'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-06-06T18:21:23+00:00">Jun 6, 2014 06:21 PM UTC</time> by <b>Marco Mambelli</b><a class="anchor" name="1402078883">&nbsp;</a></div><pre>Augustine,
can you attach the gratia log files form the last couple of days?
To try to understand why it is so slow.
Thank you,
Marco</pre></div><div class='update_description'><i onclick="document.location='21125#1402060372'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-06-06T13:12:52+00:00">Jun 6, 2014 01:12 PM UTC</time><a class="anchor" name="1402060372">&nbsp;</a></div><pre>The updates are going very very slow.  We are only up to 5/20.
<a href='http&#58;//gratiaweb.grid.iu.edu/gratia/bysite?starttime=&endtime=&span=86400&relativetime=2592000&facility=net2&exclude-facility=&vo=&exclude-vo=&user=&exclude-dn=' target='_blank' rel='nofollow'>http&#58;//gratiaweb.grid.iu.edu/gratia/bysite?starttime=&endtime=&span=86400&relativetime=2592000&facility=net2&exclude-facility=&vo=&exclude-vo=&user=&exclude-dn=</a>
Someone needs to notify LCG accounting (LCG.office@....) so they
can hold off issuing the May MOU report until we have caught up and the
data is in the EGI accounting portal.

John Weigand

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=John Weigand 144</pre></div><div class='update_description'><i onclick="document.location='21125#1402060010'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-06-06T13:06:50+00:00">Jun 6, 2014 01:06 PM UTC</time><a class="anchor" name="1402060010">&nbsp;</a></div><pre>Lisa

Thanks for the input. I ts greatly appreciated.
I will add you to the JIRA ticket for this documentation issue.

John Weigand

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=John Weigand 144</pre></div><div class='update_description'><i onclick="document.location='21125#1402016170'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-06-06T00:56:10+00:00">Jun 6, 2014 12:56 AM UTC</time> by <b>lgerhardt@....</b><a class="anchor" name="1402016170">&nbsp;</a></div><pre>Hi John,
NET2 shouldn&#39;t need to do anything special to make sure they keep
reporting. If they rotate files again, they&#39;ll need to reset the
checkpoint file with their current gratia version. With the newest
version of gratia if they rotate files (and set the
SGEPrevAccountingFile to point to the previous file), they shouldn&#39;t
need to do anything special either.

Here&#39;s answers to your other questions&#58;
1. I usually keep my LogLevel set to 2 in the gratia ProbeConfig. With
the newest version of gratia, this prints out something into the gratia
logs (in the LogFolder directory) for every job record it reads. That&#39;s
pretty much the only place where there&#39;s any records of what gratia is
doing. Here&#39;s what the start of a gratia run looks like for me at LogLevel2&#58;

00&#58;27&#58;35 PDT Gratia&#58; Using config file&#58; ProbeConfig
00&#58;27&#58;35 PDT Gratia&#58; Initializing Gratia with ProbeConfig
00&#58;27&#58;35 PDT Gratia&#58; Creating a ProbeDetails record 2014-06-05T07&#58;27&#58;35Z
00&#58;27&#58;35 PDT Gratia&#58;
***********************************************************
00&#58;27&#58;35 PDT Gratia&#58; OK - Handshake added to bundle (1/100)
00&#58;27&#58;35 PDT Gratia&#58;
***********************************************************
00&#58;27&#58;35 PDT Gratia&#58; List of backup directories&#58; [u&#39;/var/lib/gratia/tmp&#39;]
00&#58;27&#58;35 PDT Gratia&#58; Reprocessing response&#58; OK - Reprocessing 0
record(s) uploaded, 0 bundled, 0 failed
00&#58;27&#58;35 PDT Gratia&#58; After reprocessing&#58; 0 in outbox 0 in staged outbox
0 tar files
00&#58;27&#58;35 PDT Gratia&#58; Using /var/lib/gratia/tmp/checkpoint
00&#58;27&#58;35 PDT Gratia&#58; Using Accounting file&#58;
/common/nsg/sge/prod/default/common/accounting
00&#58;27&#58;35 PDT Gratia&#58; Using previous Accounting file&#58;
/common/nsg/sge/prod/default/common/accounting.previous
00&#58;27&#58;35 PDT Gratia&#58; Expecting accounting files to rotate at some point.
00&#58;27&#58;35 PDT Gratia&#58; Using grid-mapfile&#58; /etc/grid-security/grid-mapfile
<div id='show_1811539824' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_1811539824'>00&#58;27&#58;35 PDT Gratia&#58; Checking file ages&#58; checkpoint file&#58; 1401951879.93
previous file 1401876111.01
00&#58;27&#58;35 PDT Gratia&#58; Looking at regular file. Checkpoint value at 37508
00&#58;27&#58;35 PDT Gratia&#58; Opened file&#58;
/common/nsg/sge/prod/default/common/accounting
00&#58;27&#58;35 PDT Gratia&#58; [&#39;all.q&#39;, &#39;pc2631.nersc.gov&#39;, &#39;atlas&#39;, &#39;ocelot&#39;,
&#39;batchSub.sh&#39;, &#39;9440820&#39;, &#39;12646.pdsf6&#39;, &#39;0&#39;, &#39;1401948358&#39;,
&#39;1401948405&#39;, &#39;1401951872&#39;, &#39;0&#39;, &#39;0&#39;, &#39;3467&#39;, &#39;2693.114584&#39;, &#39;6.359033&#39;,
&#39;326748.000000&#39;, &#39;0&#39;, &#39;0&#39;, &#39;0&#39;, &#39;0&#39;, &#39;393680&#39;, &#39;437&#39;, &#39;0&#39;,
&#39;92464.000000&#39;, &#39;61224&#39;, &#39;0&#39;, &#39;0&#39;, &#39;0&#39;, &#39;110703&#39;, &#39;5863&#39;, &#39;atlas&#39;,
&#39;defaultdepartment&#39;, &#39;NONE&#39;, &#39;1&#39;, &#39;0&#39;, &#39;2699.473617&#39;, &#39;1425.053658&#39;,
&#39;4.883991&#39;, &#39;-u ocelot -l
cvmfs=1,eliza11io=1,eliza18io=1,h_cpu=86400,h_stack=10240K,h_vmem=4000M
-soft -l project_account=12646.pdsf6 -binding no_job_binding 0 0 0 0
no_explicit_binding&#39;, &#39;0.000000&#39;, &#39;NONE&#39;, &#39;595402752.000000&#39;, &#39;0&#39;, &#39;0&#39;,
&#39;NONE&#39;]
00&#58;27&#58;35 PDT Gratia&#58; =================================

2. Yes, it&#39;s the same one. After talking to the other SGE users, we were
the only ones who did nightly file rotating, so it was decided to leave
that attribute out of the default gratia ProbeConfig. It sounds like
Carl is going to address the documentation issues? Let me know if
there&#39;s anything I can do to help.

3. If you set SGEPrevAccountingFile to point to the previous file, the
new version of gratia assumes you are rotated accounting files and will
automatically check the time stamp of the previous file against the
checkpoint file. If the previous file has been modified later than the
checkpoint file, it assumes the files have been rotated since the last
time it reported. Then it will read from the checkpoint line to the end
of the previous file and then read all of the current accounting file.
This works for us because we always have a accouting.previous that is a
link to yesterday&#39;s file and an accounting that is a link to the current
file, so the names of SGEPrevAccountingFile and SGEAccountingFile in the
ProbeConfig file are static.

Bye,
Lisa

On 6/5/14 7&#58;50 AM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font>
</div><script type='text/javascript'>
        $('#show_1811539824').click(function() {
            $('#detail_1811539824').slideDown("normal");
            $('#show_1811539824').hide();
            $('#hide_1811539824').show();
        });
        $('#hide_1811539824').click(function() {
            $('#detail_1811539824').slideUp();
            $('#hide_1811539824').hide();
            $('#show_1811539824').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='21125#1401980181'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-06-05T14:56:21+00:00">Jun 5, 2014 02:56 PM UTC</time> by <b>augustine@....</b><a class="anchor" name="1401980181">&nbsp;</a></div><pre>Yes, it is still running.  Based on the log entries it appears to be
doing the right thing.

- Augustine

On 06/05/2014 10&#58;13 AM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='21125#1401980178'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-06-05T14:56:18+00:00">Jun 5, 2014 02:56 PM UTC</time> by <b>Tanya Levshina</b><a class="anchor" name="1401980178">&nbsp;</a></div><pre>Hi,

I will create a Jira ticket for Carl to address documentation issues.
Thanks,
Tanya</pre></div><div class='update_description'><i onclick="document.location='21125#1401979825'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-06-05T14:50:25+00:00">Jun 5, 2014 02:50 PM UTC</time><a class="anchor" name="1401979825">&nbsp;</a></div><pre>Lisa,
Thanks for your help.
Once NET2 is caught up, is there anything special that needs to be done to insure we continue reporting.

I think we need to update this section of the Gratia Troubleshooting guide for SGE sites and this kind of issue.
<a href='https&#58;//twiki.grid.iu.edu/bin/view/Documentation/Release3/TroubleshootingGratia#6_Common_Gratia_Problems' target='_blank' rel='nofollow'>https&#58;//twiki.grid.iu.edu/bin/view/Documentation/Release3/TroubleshootingGratia#6_Common_Gratia_Problems</a>

1. Is there something we should have looked at earlier that would have tipped us off to the problem?
Specifics (like files, messages, etc) would help as we are not familiar with SGE.

2. Is this SGEPrevAccountingFile an attribute in the Gratia ProbeConfig file mentioned in the
<a href='https&#58;//jira.opensciencegrid.org/browse/GRATIA-120' target='_blank' rel='nofollow'>https&#58;//jira.opensciencegrid.org/browse/GRATIA-120</a> ticket?
I can&#39;t find any Gratia doc related to this type of attribute.

3. When log rotation occurs with SGE are there manual procedures for insuring the new log file is accessed
by the probe?  Or do the changes you put in for v1.13.25 back in March take care of this...
<a href='http&#58;//sourceforge.net/p/gratia/svn/5388/log/?path=/trunk/probe/sge/sge_meter' target='_blank' rel='nofollow'>http&#58;//sourceforge.net/p/gratia/svn/5388/log/?path=/trunk/probe/sge/sge_meter</a>

John Weigand

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=John Weigand 144</pre></div><div class='update_description'><i onclick="document.location='21125#1401977579'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-06-05T14:12:59+00:00">Jun 5, 2014 02:12 PM UTC</time><a class="anchor" name="1401977579">&nbsp;</a></div><pre>Augustine,
Need to verify it is still running.
You now have data up through 5/15 and
is updating for 5/16.
Maybe by tonight we will be caught up.
John Weigand

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=John Weigand 144</pre></div><div class='update_description'><i onclick="document.location='21125#1401914531'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-06-04T20:42:11+00:00">Jun 4, 2014 08:42 PM UTC</time> by <b>augustine@....</b><a class="anchor" name="1401914531">&nbsp;</a></div><pre>Looks promising.  Script is still running, gratia logs are showing
records being uploaded.

- Augustine

On 06/04/2014 02&#58;54 PM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='21125#1401908057'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-06-04T18:54:17+00:00">Jun 4, 2014 06:54 PM UTC</time> by <b>lgerhardt@....</b><a class="anchor" name="1401908057">&nbsp;</a></div><pre>Hi,
I concur with Marco. If you set the checkpoint file to zero and run the
cron again it should pick up the new job records.

Bye,
Lisa

On Wednesday, June 4, 2014, Open Science Grid FootPrints &#60;
osg@....&#62; wrote&#58;

<font color='#7F7E6F'>&#62;  [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='21125#1401907128'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-06-04T18:38:48+00:00">Jun 4, 2014 06:38 PM UTC</time> by <b>Marco Mambelli</b><a class="anchor" name="1401907128">&nbsp;</a></div><pre>Augustine, I think it is a good idea.
The new version handles rotation (Lisa can confirm) but the one you are running does not.
Moving the checkpoint to 0 or 1 (initial lines are comments) should process the records in the new file.
Cheers,
Marco</pre></div><div class='update_description'><i onclick="document.location='21125#1401906865'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-06-04T18:34:25+00:00">Jun 4, 2014 06:34 PM UTC</time><a class="anchor" name="1401906865">&nbsp;</a></div><pre>Lisa,

Can you help us out here?
This is an SGE site and the issue may be a log rotation as to why it is
not reporting to Gratia since a log file rotation back on 5/9.
Look at Augustine&#39;s last comment.
Do you think this is the issue?

John Weigand

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=John Weigand 144</pre></div><div class='update_description'><i onclick="document.location='21125#1401905354'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-06-04T18:09:14+00:00">Jun 4, 2014 06:09 PM UTC</time> by <b>augustine@....</b><a class="anchor" name="1401905354">&nbsp;</a></div><pre>Ok, I think I found something&#58;
<a href='http&#58;//ticket.grid.iu.edu/16691' target='_blank' rel='nofollow'>http&#58;//ticket.grid.iu.edu/16691</a>

we rotated our accounting file when it grew to 1.8Gigs on May 9th.  Old
accounting file was 5425082 lines long, the gratia checkpoint file
contains # 5399760.

How about I set the checkpoint file number to 0 and then run the cron
script by hand?  Just want to consult you guys before proceeding.

- Augustine

On 06/04/2014 12&#58;42 PM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='21125#1401900124'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-06-04T16:42:04+00:00">Jun 4, 2014 04:42 PM UTC</time> by <b>Marco Mambelli</b><a class="anchor" name="1401900124">&nbsp;</a></div><pre>ProbeConfig refers to an accounting file that has records from May 9 to today&#58;
SGEAccountingFile=&#34;/usr/local/sge/sge_root/atlas/common/accounting&#34;

The file exists and I attached the fors 100 lines and last 100 lines (the whole file is too big, ~170MB)

Other note. The probe version seems old. I would update it.
Adding Carl that did some changes recently.</pre></div><div class='update_description'><i onclick="document.location='21125#1401892391'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-06-04T14:33:11+00:00">Jun 4, 2014 02:33 PM UTC</time> by <b>augustine@....</b><a class="anchor" name="1401892391">&nbsp;</a></div><pre>John

It is my understanding that the cron_check return status only
affects ability to run out of cron.  When running by hand I invoke it
using /usr/share/gratia/sge/sge_meter.cron.sh.  I have had restarted rsv
gratia monitors in my earlier attempts to troubleshoot this, just for
good measure.  I also checked on the exit status of cron_check and it is
now returning 0 as it&#39;s supposed.

I am currently trying to dig up when our batch system job id
counter rolled over (sometime in the last monty), I am wondering if this
could be the culprit?

- Augustine

On 06/04/2014 09&#58;22 AM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='21125#1401888173'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-06-04T13:22:53+00:00">Jun 4, 2014 01:22 PM UTC</time><a class="anchor" name="1401888173">&nbsp;</a></div><pre>Augustine,

This is what you reported on ticket 20966 on May 9th when the
April reporting issue was resolved...
---------
&#34;Last nights cron did not run.  I double checked everything and discovered that
/usr/share/gratia/common/cron_check  /etc/gratia/sge/ProbeConfig was not
returning 0 as expected with no additional output available.
ProbeConfig indicated probe as enabled as well as the init script was
chkconfiged on.  I disabled and re-enabled gratia-probes-cron service as
well as restarted it.  It looks like cron_check script now passes the
test and I have reasons to believe that the cron will run next time it&#39;s
invoked.&#34;
-----

Can we be running into something similar?

John Weigand

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=John Weigand 144</pre></div><div class='update_description'><i onclick="document.location='21125#1401887749'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-06-04T13:15:49+00:00">Jun 4, 2014 01:15 PM UTC</time><a class="anchor" name="1401887749">&nbsp;</a></div><pre>A quick exit may indicate a lock file issue.
i would look there first.
John Weigand

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=John Weigand 144</pre></div><div class='update_description'><i onclick="document.location='21125#1401887499'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-06-04T13:11:39+00:00">Jun 4, 2014 01:11 PM UTC</time> by <b>Marco Mambelli</b><a class="anchor" name="1401887499">&nbsp;</a></div><pre>He did run it but exited quickly w/ no records reported. Augustine restored my login access to the node and I&#39;ll look into it. Marco</pre></div><div class='update_description'><i onclick="document.location='21125#1401886511'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-06-04T12:55:11+00:00">Jun 4, 2014 12:55 PM UTC</time><a class="anchor" name="1401886511">&nbsp;</a></div><pre>Augustine,
Did you run the cron entry manually?
If you did, then we need to pursue other options as
I don&#39;t see any new data in Gratia.

We only have &#39;til Friday to resolve this before the May MOU reports
are issued.
However, if it is not urgent on your end, I have no problem.
John Weigand

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=John Weigand 144</pre></div><div class='update_description'><i onclick="document.location='21125#1401806720'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-06-03T14:45:20+00:00">Jun 3, 2014 02:45 PM UTC</time><a class="anchor" name="1401806720">&nbsp;</a></div><pre>Augustine,
Certainly can&#39;t hurt.  Go for it.
john weigand

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=John Weigand 144</pre></div><div class='update_description'><i onclick="document.location='21125#1401806593'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-06-03T14:43:13+00:00">Jun 3, 2014 02:43 PM UTC</time> by <b>augustine@....</b><a class="anchor" name="1401806593">&nbsp;</a></div><pre>I have not changed anything in the config or the environment when I ran
these by hand.  I can run the script by hand again if you think that is
worth trying?

- Augustine

On 06/03/2014 09&#58;52 AM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='21125#1401803560'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-06-03T13:52:40+00:00">Jun 3, 2014 01:52 PM UTC</time><a class="anchor" name="1401803560">&nbsp;</a></div><pre>I have to jump in on this as I just recalled this appears to be a continuation of the same
problem we had last month on <a href='https&#58;//ticket.grid.iu.edu/20966' target='_blank' rel='nofollow'>https&#58;//ticket.grid.iu.edu/20966</a> (ignore all references to
graphs and gratiaweb as that just confused the issue).

See the 05/08/2014 03&#58;27 PM response from Augustine starting with &#34;Last nights cron did no run..&#34;.
It seems very coincidental that we stopped reporting right after the last manual run of the cron on 5/8.
Were there any other changes made on that day to resolve that issue?
... a change to the ProbeConfig?
... was something else changed such that the manual run of the probe was successful and
subsequent runs have not been? ... something in the environment?

Have you tried running the entry manually?

This is too coincidental.

John Weigand

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=John Weigand 144</pre></div><div class='update_description'><i onclick="document.location='21125#1401732793'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-06-02T18:13:13+00:00">Jun 2, 2014 06:13 PM UTC</time> by <b>augustine@....</b><a class="anchor" name="1401732793">&nbsp;</a></div><pre>Hi Marco,

our versions are as follows&#58;

gratia-probe-metric-1.12-1.osg.el5
gratia-probe-gram-1.12-1.osg.el5
gratia-probe-sge-1.12-1.osg.el5
gratia-probe-gridftp-transfer-1.12-1.osg.el5
gratia-probe-common-1.12-1.osg.el5
osg-configure-gratia-1.0.14-1.osg.el5

as for /var/lib/gratia/data the directory contains 73,925 files. They
are in format of gratia_certinfo_sge_{number}.  Largest number used is
9999999

You have an account on atlas-net2.bu.edu from some time in the past.
(it&#39;s username mambelli).  You&#39;re welcome to log in and look around.
Please let us know if you need your password reset.

- Augustine

On 06/02/2014 11&#58;43 AM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='21125#1401723835'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-06-02T15:43:55+00:00">Jun 2, 2014 03:43 PM UTC</time> by <b>Marco Mambelli</b><a class="anchor" name="1401723835">&nbsp;</a></div><pre>Saul, Augustin,
which version of the probe do you have (use yum or rpm) and which are the names of the files in /var/lib/gratia/data  ?
Thank you,
Marco</pre></div><div class='update_description'><i onclick="document.location='21125#1401721666'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-06-02T15:07:46+00:00">Jun 2, 2014 03:07 PM UTC</time> by <b>echism</b><a class="anchor" name="1401721666">&nbsp;</a></div><pre>Gratia ops,

Can you assist on this?

Thank you,
Elizabeth</pre></div><div class='update_description'><i onclick="document.location='21125#1401475032'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-05-30T18:37:12+00:00">May 30, 2014 06:37 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1401475032">&nbsp;</a></div><pre>Hi Elizabeth,

I don&#39;t think we&#39;ve got a response to Augustine&#39;s message below. Would it help
for us to make a local account so someone from OSG can look at the logs
directly?

- Saul

On Wed May 28 17&#58;16&#58;28 2014, osg-goc-rest wrote&#58;
<font color='#7F7E6F'>&#62; Hello,</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; we need help troubleshooting this. Cron runs on regular basis,</font>
<font color='#7F7E6F'>&#62; jobs are running, there are 73928 files in /var/lib/gratia/data</font>
<font color='#7F7E6F'>&#62; directory. When I review the logs, it seems that even if everything</font>
<font color='#7F7E6F'>&#62; seems to be running fine, no job info is being reported. Bellow is a</font>
<font color='#7F7E6F'>&#62; sample log output&#58;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; 16&#58;45&#58;01 EDT Gratia&#58; Using config file&#58; /etc/gratia/sge/ProbeConfig</font>
<font color='#7F7E6F'>&#62; 16&#58;57&#58;16 EDT Gratia&#58; Using config file&#58; ProbeConfig</font>
<font color='#7F7E6F'>&#62; 16&#58;57&#58;16 EDT Gratia&#58; Initializing Gratia with ProbeConfig</font>
<font color='#7F7E6F'>&#62; 16&#58;57&#58;16 EDT Gratia&#58; Creating a ProbeDetails record 2014-05-</font>
<font color='#7F7E6F'>&#62; 28T20&#58;57&#58;16Z</font>
<font color='#7F7E6F'>&#62; 16&#58;57&#58;16 EDT Gratia&#58;</font>
<font color='#7F7E6F'>&#62; ***********************************************************</font>
<font color='#7F7E6F'>&#62; 16&#58;57&#58;16 EDT Gratia&#58; OK - Handshake added to bundle (1/100)</font>
<font color='#7F7E6F'>&#62; 16&#58;57&#58;16 EDT Gratia&#58;</font>
<font color='#7F7E6F'>&#62; ***********************************************************</font>
<font color='#7F7E6F'>&#62; 16&#58;57&#58;16 EDT Gratia&#58; List of backup directories&#58;</font>
<font color='#7F7E6F'>&#62; [u&#39;/var/lib/gratia/tmp&#39;]</font>
<font color='#7F7E6F'>&#62; 16&#58;57&#58;16 EDT Gratia&#58; Reprocessing response&#58; OK - Reprocessing 0</font>
<font color='#7F7E6F'>&#62; record(s) uploaded, 0 bundled, 0 failed</font>
<font color='#7F7E6F'>&#62; 16&#58;57&#58;16 EDT Gratia&#58; After reprocessing&#58; 0 in outbox 0 in staged</font>
<font color='#7F7E6F'>&#62; outbox</font>
<font color='#7F7E6F'>&#62; 0 tar files</font>
<font color='#7F7E6F'>&#62; 16&#58;57&#58;16 EDT Gratia&#58; Using /var/lib/gratia/tmp/checkpoint</font>
<div id='show_1371162441' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_1371162441'><font color='#7F7E6F'>&#62; 16&#58;57&#58;16 EDT Gratia&#58; Processing bundle file&#58;</font>
<font color='#7F7E6F'>&#62; 16&#58;57&#58;16 EDT Gratia&#58; Connection via HTTP to&#58;</font>
<font color='#7F7E6F'>&#62; gratia-osg-prod.opensciencegrid.org&#58;80</font>
<font color='#7F7E6F'>&#62; 16&#58;57&#58;16 EDT Gratia&#58; OK - Processed bundle with 1 records&#58; OK</font>
<font color='#7F7E6F'>&#62; 16&#58;57&#58;16 EDT Gratia&#58;</font>
<font color='#7F7E6F'>&#62; ***********************************************************</font>
<font color='#7F7E6F'>&#62; 16&#58;57&#58;16 EDT Gratia&#58; Removing log files older than 31 days from</font>
<font color='#7F7E6F'>&#62; /var/log/gratia</font>
<font color='#7F7E6F'>&#62; 16&#58;57&#58;16 EDT Gratia&#58; /var/log/gratia uses 3.4% and there is 59% free</font>
<font color='#7F7E6F'>&#62; 16&#58;57&#58;16 EDT Gratia&#58; Removing incomplete data files older than 31 days</font>
<font color='#7F7E6F'>&#62; from /var/lib/gratia/data/</font>
<font color='#7F7E6F'>&#62; 16&#58;57&#58;17 EDT Gratia&#58; /var/lib/gratia/data uses 0.080% and there is 59%</font>
<font color='#7F7E6F'>&#62; free</font>
<font color='#7F7E6F'>&#62; 16&#58;57&#58;18 EDT Gratia&#58; End of execution summary&#58; new records sent</font>
<font color='#7F7E6F'>&#62; successfully&#58; 0</font>
<font color='#7F7E6F'>&#62; 16&#58;57&#58;18 EDT Gratia&#58; new records suppressed&#58;</font>
<font color='#7F7E6F'>&#62; 0</font>
<font color='#7F7E6F'>&#62; 16&#58;57&#58;18 EDT Gratia&#58; new records failed&#58; 0</font>
<font color='#7F7E6F'>&#62; 16&#58;57&#58;18 EDT Gratia&#58; records reprocessed</font>
<font color='#7F7E6F'>&#62; successfully&#58; 0</font>
<font color='#7F7E6F'>&#62; 16&#58;57&#58;18 EDT Gratia&#58; reprocessed records</font>
<font color='#7F7E6F'>&#62; failed&#58; 0</font>
<font color='#7F7E6F'>&#62; 16&#58;57&#58;18 EDT Gratia&#58; handshake records sent</font>
<font color='#7F7E6F'>&#62; successfully&#58; 1</font>
<font color='#7F7E6F'>&#62; 16&#58;57&#58;18 EDT Gratia&#58; handshake records</font>
<font color='#7F7E6F'>&#62; failed&#58; 0</font>
<font color='#7F7E6F'>&#62; 16&#58;57&#58;18 EDT Gratia&#58; bundle of records sent</font>
<font color='#7F7E6F'>&#62; successfully&#58; 1</font>
<font color='#7F7E6F'>&#62; 16&#58;57&#58;18 EDT Gratia&#58; bundle of records</font>
<font color='#7F7E6F'>&#62; failed&#58; 0</font>
<font color='#7F7E6F'>&#62; 16&#58;57&#58;18 EDT Gratia&#58; outstanding records&#58; 0</font>
<font color='#7F7E6F'>&#62; 16&#58;57&#58;18 EDT Gratia&#58; outstanding staged</font>
<font color='#7F7E6F'>&#62; records&#58; 0</font>
<font color='#7F7E6F'>&#62; 16&#58;57&#58;18 EDT Gratia&#58; outstanding records tar</font>
<font color='#7F7E6F'>&#62; files&#58; 0</font>
<font color='#7F7E6F'>&#62; 16&#58;57&#58;18 EDT Gratia&#58; End-of-execution disconnect ...</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; On 05/28/2014 08&#58;06 AM, Open Science Grid FootPrints wrote&#58;</font>
<font color='#7F7E6F'>&#62; &#62; [Duplicate message snipped]</font>
<font color='#7F7E6F'>&#62; -- by augustine@.... at Wed May 28 21&#58;15&#58;10 UTC 2014</font>
-- by youssef@.... at Fri May 30 18&#58;37&#58;01 UTC 2014

GOCTX Source&#58; BNL Ticket&#58; Queue=NETier2 ID=24414
</div><script type='text/javascript'>
        $('#show_1371162441').click(function() {
            $('#detail_1371162441').slideDown("normal");
            $('#show_1371162441').hide();
            $('#hide_1371162441').show();
        });
        $('#hide_1371162441').click(function() {
            $('#detail_1371162441').slideUp();
            $('#hide_1371162441').hide();
            $('#show_1371162441').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='21125#1401311710'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-05-28T21:15:10+00:00">May 28, 2014 09:15 PM UTC</time> by <b>augustine@....</b><a class="anchor" name="1401311710">&nbsp;</a></div><pre>Hello,

we need help troubleshooting this.  Cron runs on regular basis,
jobs are running, there are 73928 files in /var/lib/gratia/data
directory.  When I review the logs, it seems that even if everything
seems to be running fine, no job info is being reported.  Bellow is a
sample log output&#58;

16&#58;45&#58;01 EDT Gratia&#58; Using config file&#58; /etc/gratia/sge/ProbeConfig
16&#58;57&#58;16 EDT Gratia&#58; Using config file&#58; ProbeConfig
16&#58;57&#58;16 EDT Gratia&#58; Initializing Gratia with ProbeConfig
16&#58;57&#58;16 EDT Gratia&#58; Creating a ProbeDetails record 2014-05-28T20&#58;57&#58;16Z
16&#58;57&#58;16 EDT Gratia&#58;
***********************************************************
16&#58;57&#58;16 EDT Gratia&#58; OK - Handshake added to bundle (1/100)
16&#58;57&#58;16 EDT Gratia&#58;
***********************************************************
16&#58;57&#58;16 EDT Gratia&#58; List of backup directories&#58; [u&#39;/var/lib/gratia/tmp&#39;]
16&#58;57&#58;16 EDT Gratia&#58; Reprocessing response&#58; OK - Reprocessing 0
record(s) uploaded, 0 bundled, 0 failed
16&#58;57&#58;16 EDT Gratia&#58; After reprocessing&#58; 0 in outbox 0 in staged outbox
0 tar files
16&#58;57&#58;16 EDT Gratia&#58; Using /var/lib/gratia/tmp/checkpoint
16&#58;57&#58;16 EDT Gratia&#58; Processing bundle file&#58;
16&#58;57&#58;16 EDT Gratia&#58; Connection via HTTP to&#58;
gratia-osg-prod.opensciencegrid.org&#58;80
16&#58;57&#58;16 EDT Gratia&#58; OK - Processed bundle with 1 records&#58;  OK
16&#58;57&#58;16 EDT Gratia&#58;
***********************************************************
16&#58;57&#58;16 EDT Gratia&#58; Removing log files older than 31 days from
/var/log/gratia
16&#58;57&#58;16 EDT Gratia&#58; /var/log/gratia uses 3.4% and there is 59% free
16&#58;57&#58;16 EDT Gratia&#58; Removing incomplete data files older than 31 days
from /var/lib/gratia/data/
16&#58;57&#58;17 EDT Gratia&#58; /var/lib/gratia/data uses 0.080% and there is 59% free
<div id='show_523264441' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_523264441'>16&#58;57&#58;18 EDT Gratia&#58; End of execution summary&#58; new records sent
successfully&#58; 0
16&#58;57&#58;18 EDT Gratia&#58;                           new records suppressed&#58; 0
16&#58;57&#58;18 EDT Gratia&#58;                           new records failed&#58; 0
16&#58;57&#58;18 EDT Gratia&#58;                           records reprocessed
successfully&#58; 0
16&#58;57&#58;18 EDT Gratia&#58;                           reprocessed records failed&#58; 0
16&#58;57&#58;18 EDT Gratia&#58;                           handshake records sent
successfully&#58; 1
16&#58;57&#58;18 EDT Gratia&#58;                           handshake records failed&#58; 0
16&#58;57&#58;18 EDT Gratia&#58;                           bundle of records sent
successfully&#58; 1
16&#58;57&#58;18 EDT Gratia&#58;                           bundle of records failed&#58; 0
16&#58;57&#58;18 EDT Gratia&#58;                           outstanding records&#58; 0
16&#58;57&#58;18 EDT Gratia&#58;                           outstanding staged records&#58; 0
16&#58;57&#58;18 EDT Gratia&#58;                           outstanding records tar
files&#58; 0
16&#58;57&#58;18 EDT Gratia&#58; End-of-execution disconnect ...

On 05/28/2014 08&#58;06 AM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font>
</div><script type='text/javascript'>
        $('#show_523264441').click(function() {
            $('#detail_523264441').slideDown("normal");
            $('#show_523264441').hide();
            $('#hide_523264441').show();
        });
        $('#hide_523264441').click(function() {
            $('#detail_523264441').slideUp();
            $('#hide_523264441').hide();
            $('#show_523264441').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='21125#1401278812'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-05-28T12:06:52+00:00">May 28, 2014 12:06 PM UTC</time> by <b>echism</b><a class="anchor" name="1401278812">&nbsp;</a></div><pre>Saul and Augustine,

Please send us an update on this.

Thank you,
Elizabeth</pre></div><div class='update_description'><i onclick="document.location='21125#1400688021'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-05-21T16:00:21+00:00">May 21, 2014 04:00 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1400688021">&nbsp;</a></div><pre>Hi, Augustine is working on it. We&#39;ll be in touch soon. - Saul

On Thu May 15 14&#58;00&#58;15 2014, osg-goc-rest wrote&#58;
<font color='#7F7E6F'>&#62; Hello,</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; We received the following report of missing gratia data&#58;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; Sites missing data for more than 2 days&#58;</font>
<font color='#7F7E6F'>&#62; NET2&#58; [&#39;2014-05-09&#39;, &#39;2014-05-10&#39;, &#39;2014-05-11&#39;, &#39;2014-05-12&#39;,</font>
<font color='#7F7E6F'>&#62; &#39;2014-05-13&#39;, &#39;2014-05-14&#39;]</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; [META Information]</font>
<font color='#7F7E6F'>&#62; Primary Admin for NET2 is Augustine Abaris and has been CC&#39;d.</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; [Ticket Origin]</font>
<font color='#7F7E6F'>&#62; <a href='https&#58;//ticket.grid.iu.edu/viewer?id=21125#1400176768' target='_blank' rel='nofollow'>https&#58;//ticket.grid.iu.edu/viewer?id=21125#1400176768</a></font>
-- by youssef@.... at Wed May 21 16&#58;00&#58;10 UTC 2014

GOCTX Source&#58; BNL Ticket&#58; Queue=NETier2 ID=24414</pre></div><div class='update_description'><i onclick="document.location='21125#1400521843'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-05-19T17:50:43+00:00">May 19, 2014 05:50 PM UTC</time> by <b>Vince Neal</b><a class="anchor" name="1400521843">&nbsp;</a></div><pre>Continued&#58;  NET2&#58; [&#39;2014-05-09&#39;, &#39;2014-05-10&#39;, &#39;2014-05-11&#39;, &#39;2014-05-12&#39;, &#39;2014-05-13&#39;, &#39;2014-05-14&#39;, &#39;2014-05-15&#39;, &#39;2014-05-16&#39;, &#39;2014-05-17&#39;, &#39;2014-05-18&#39;]</pre></div><div class='update_description'><i onclick="document.location='21125#1400176769'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-05-15T17:59:29+00:00">May 15, 2014 05:59 PM UTC</time> by <b>echism</b><a class="anchor" name="1400176769">&nbsp;</a></div><pre>Hello,

We received the following report of missing gratia data&#58;

Sites missing data for more than 2 days&#58;
NET2&#58; [&#39;2014-05-09&#39;, &#39;2014-05-10&#39;, &#39;2014-05-11&#39;, &#39;2014-05-12&#39;, &#39;2014-05-13&#39;, &#39;2014-05-14&#39;]</pre></div><legend>Similar Recent Tickets <small>modified within the last 30 days</small></legend><div id="similar_tickets"><p class="muted">No similar tickets found.</p></div>
</div>
<script type="text/javascript">
function reset_anchor() {
    $("#updates .selected").removeClass("selected");
    var urls = document.location.toString().split('#'); 
    var anchor = urls[1];
    if(anchor) {
        $("a[name='"+anchor+"']").parents(".update_description").addClass("selected");
    }
}
function submitspam(ticket_id) {
    myret = confirm("Would you like to close this ticket as a security ticket, and submit the ticket content to akismet?");
    if(myret == true) {
        $.ajax("viewer/processspam?id="+ticket_id).done(function() {
            window.location.reload();
        });
    }
}

$(function() {
    reset_anchor();
    var ADDITIONAL_COOKIE_NAME = 'gocticket';
    var options = { path: '/', expires: 365};

    if(window.opener && window.opener.name == "gocticket_list") {
        v = $.cookie("closewindow");
        if(!v) {
            $("#closewindow").attr("checked", "checked"); //on by default
        } else {
            if(v == "checked") {
                $("#closewindow").attr("checked", "checked");
            }
        }
        $("#closewindow").click(function() {
            $.cookie("closewindow", $(this).attr('checked'), options);
        });
    } else {
        $("#closewindow_area").hide();
    }
    function updateTimeago() {
        $("time").timeago();
        setTimeout(updateTimeago, 30*1000);
    }
    updateTimeago();
    $(".description").focus(expand_description);
});
</script>
<hr/>
<footer>
<p>GOC Ticket Version 2.2 | <a href="https://ticket.opensciencegrid.org/goc/submit?app_issue_check=on&amp;app_issue_type=goc&amp;app_goc_url=https%3A%2F%2Fticket.opensciencegrid.org%3A443%2F21125">Report Bugs</a>
 | <a href="https://github.com/opensciencegrid/operations/blob/master/docs/privacy.md">Privacy Policy</a>
</p>

<p> <img align="top" src="/images/tag_orange.png"/> Copyright 2018 The Trustees of Indiana University - Developed for Open Science Grid</p>
</footer>


</div><!--container-fluid-->
<script src="https://ticket1.grid.iu.edu:8443/socket.io/socket.io.js"></script>
<script>
var chat = io.connect('https://ticket1.grid.iu.edu:8443');
chat.on('connect', function() {
    chat.emit('authenticate', {nodekey:'', ticketid: 21125});
});
chat.on('peers', function(peers) {
    $("#peers").html("");
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('peer_disconnect', function(pid) {
    $("#peer_"+pid).hide("slow");
});
chat.on('peer_connected', function(peers) {
    //expect only 1 peer connecting, but..
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('submit', function() {
    if(confirm("This ticket was updated. Do you want to refresh?")) {
        history.go(0);
    }
});

function addPeer(pid, peer) {
    var ipinfo = "";
    if(peer.ip != undefined) {
        ipinfo = "<span class=\"ip\">"+peer.ip+"</span>";
    }
    if(chat.io.engine.id == pid) {
        //don't display myself
        return;
    }
    var html = "<li class=\"new\" id=\"peer_"+pid+"\" class=\"peer\">"+peer.name+ipinfo+"</li>";
    $("#peers").prepend(html);
    $("#peers .new").animate({bottom: 0}, 1000, function() {$(this).removeClass("new")});
}

$(function() {
    $("#ticket_form").submit(function() {
        chat.emit('submit');
        return true;
    });
});
</script>
<script>
//used by searchbox
function parseValue(value) {
    var obj = new Object();
    var tokens = value.split("\t");
    obj.str = tokens[0];
    obj.count = tokens[1];
    return obj;
}

$(function() {
    //bootstrap-2.0.4 stuff
    $(".alert-message").alert();
    $(".dropdown-toggle").dropdown();
    $("span[rel='tooltip']").tooltip();
    $("a[rel=popover]").popover();

    //activate menu that user is currently on
    $("#menu_navigator").addClass("active"); 
    $("#submenu_").addClass("active"); 

    //translate zend validation error message to bootstrap
    $(".errors").addClass("alert").addClass("alert-error");

    //enable autocomplete for search box
    $("#search").autocomplete({
        source: function( request, response ) {
            $.ajax({
                url: "search/autocomplete",
                dataType: "text",
                data: {
                    //featureClass: "P",
                    //style: "full",
                    //maxRows: 12,
                    //name_startsWith: request.term
                    q: request.term
                },
                success: function( data ) {
                    response( $.map( data.split("\n"), function( item ) {
                        if(item == "") return null;
                        return {
                            value: item
                        }
                    }));
                }
            });
        },
        select: function(event, ui) {
            document.location = "search?q="+ui.item.value;
        }
    });
    
});
</script>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-69012-13");
pageTracker._trackPageview();
} catch(err) {}
</script>

</body>
