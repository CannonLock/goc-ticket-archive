<!DOCTYPE html>
<html lang="en">
  <head>
  <base href="">
    <title>[25479] CPU Efficiency Quality Map - What is it?</title>    <meta charset="utf-8" />
    <meta name="verify-v1" content="na5IcAJsZVOfEkboRxuIiZ1zpZgnZiWra+nKcS7nA/o=" />
    <meta name="google-site-verification" content="DLrk3ft4s8b-S2TloLCL2LD_t6wcTjgSluf5pmiu2kA" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />
    <link href="https://ticket.opensciencegrid.org/rss" rel="alternate" type="application/rss+xml" title="GOC Ticket Update feed" />

    <style type="text/css">
      body {
        padding-top: 50px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
     #search {
            width: 300px;
     }

    </style>

<script src="https://code.jquery.com/jquery-3.0.0.js"></script>
<script src="https://code.jquery.com/jquery-migrate-3.0.1.js"></script>

   <link href="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet"/>
    <script src="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/js/bootstrap.min.js"></script>

    <link href="https://netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"/>
    <link href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/themes/smoothness/jquery-ui.min.css" rel="stylesheet"/>
 <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>


    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/js/select2.min.js"></script>

    <link href="css/ticket.css" rel="stylesheet" />
    <script src="lib/jquery.cookie.js"></script>

    <link href="images/tag_orange.png" rel="icon" type="image/png"/>
    <script src='https://www.google.com/recaptcha/api.js'></script>
  </head>

  <body>
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>

            <a class="brand" style="padding: 6px 0px 0px 6px;" href="http://opensciencegrid.org"><img src="images/osglogo.40x30.png"/></a>
            <ul class="nav">
                <li class="dropdown"><a href="https://ticket.opensciencegrid.org/#" class="dropdown-toggle" data-toggle="dropdown">GOC Ticket <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    <li><a href="https://my.opensciencegrid.org">MyOSG</a></li>
                    <li><a href="https://oim.opensciencegrid.org">OIM</a></li>
                    <li class="active"><a href="https://ticket.opensciencegrid.org/index">Ticket</a></li>
	<li class="divider"></li>
	<li><a href="http://repo.grid.iu.edu">Repo</a></li>
	<li class="divider"></li>
	<li><a href="http://blogs.grid.iu.edu">Blog</a></li>
                    <li><a href="http://display.grid.iu.edu">Display</a></li>
                    <li><a href="http://osggoc.blogspot.com/">News</a></li>
                    </ul>
                </li>
            </ul>
            <ul class="nav pull-right">
                <li><a href="https://ticket.opensciencegrid.org/sso/">Login</a></li>            </ul>

            <div class="nav-collapse">
                <ul class="nav">
			 <li id="menu_submit"><a href="https://ticket.opensciencegrid.org/submit">Submit</a></li><li id="menu_view" class="dropdown"><a href="https://ticket.opensciencegrid.org/\#" class="dropdown-toggle" data-toggle="dropdown">View <b class="caret"></b></a><ul class="dropdown-menu"><li id="submenu_listopen"><a href="https://ticket.opensciencegrid.org/list/open">Open Tickets</a></li><li id="submenu_listrecentclose"><a href="https://ticket.opensciencegrid.org/list/recentclose">Recently Closed Tickets</a></li><li class="divider"></li><li id="submenu_alltickets"><a href="https://ticket.opensciencegrid.org/search?q=&amp;sort=id">All Tickets</a></li></ul></li>                </ul>

                <form class="navbar-search pull-right" action="https://ticket.opensciencegrid.org/viewer">
                    <input id="search" type="text" name="id" class="search-query span2" placeholder="Search Ticket" value=""/>
                </form>
            </div>
        </div>
      </div>
    </div>

<script type='text/javascript' src='lib/jquery.timeago.js'></script>
<script type='text/javascript' src='lib/byte2size.js'></script>
<style>
#updates .toolbar {
position: relative;
margin-top: 0px;
top: -10px;
font-weight: normal;
}
#updates a.anchor {
position: relative;
top: -50px;
}
#updates .selected pre {
animation:selected 2s;
animation-iteration-count: 2;
animation-direction: alternate;
-webkit-animation:selected 2s; 
-webkit-animation-iteration-count: 2;
-webkit-animation-direction: alternate;
box-shadow: inset 1px 1px 20px #9ad;
border: 1px solid #9ab;
margin: 5px 0px;
padding-left: 10px;
}
@keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ab;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
@-webkit-keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ad;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
#updates pre {
background-color: inherit;
line-height: 15px;
padding: 5px;
}
#updates .header {
color: #999;
}
#updates .update_history pre {
background-color: #eee;
color: #666;
font-size: 85%;
}
#updates .clickable {
cursor: pointer;
}
#updates .clickable:hover {
color: #D98719;
}
#updates .meta_information pre {
background-color: #fed;
}
#similar_tickets {
max-height: 300px;
overflow-y: auto;
pointer-events: none;
padding: 5px;
background-color: #f4f4f4;
}
.btn-toolbar {
margin-bottom: 0;
height: 30px;
}
#peers {
position: fixed;
bottom: 0px;
right: 0px;
z-index: 100;
list-style: none;
padding: 5px 0px 0px 5px;
margin: 0px;
background-color: white;
box-shadow: 0px 0px 10px white;
}
#peers li {
background-color: #ccc;
color: #000;
display: inline-block;
padding: 5px 10px;
margin-right: 5px;
position: relative;
}
/*
#peers li:hover {
background-color: #999;
cursor: pointer;
}
*/
#peers span.ip {
padding-left: 5px;
color: #666;
}
#peers .new {
bottom: -30px;
}
/*
#peers .me {
background-color: red;
}
*/
</style>

<div class="container-fluid">
<ul id="peers"></ul>
<div class="alert alert-danger"><a class="close" href="https://ticket.opensciencegrid.org/#" data-dismiss="alert">&times;</a>By the end of May 2018, the ticketing system at https://ticket.opensciencegrid.org will be retired and support will be provided at https://support.opensciencegrid.org. Throughout this transition the support email (help@opensciencegrid.org) will be available as a point of contact.<br><br>                                                   
                                                                                                                                                                                   
Please see the service migration page for details: https://opensciencegrid.github.io/technology/policy/service-migrations-spring-2018/#ticket</div><div id="presence" class="pull-right"></div><div class="ticketgui"><script type="text/javascript" src="lib/checktab.js"></script>

<script>
var expanded = false;
function expand_description() {
    var desc = $(".description");
    if(!expanded) {
        expanded = true;
        //expand to minheight
        var min = 250;
        if(desc.height() < min) {
            desc.animate({height: min}, 200);
        }
    }
}

$(document).ready(function() {
    $("input[name='nad']").datepicker({
        dateFormat: 'yy-mm-dd'
    });
});

</script>



<style>
.form-horizontal .control-label {
padding-top: inherit;
font-size:90%;
color:#666;
}
label {
margin-bottom: 0px;
}
.controls {
line-height: 18px;
}
</style>
<form class="form-horizontal" action="https://ticket.opensciencegrid.org/viewer/updatebasic?id=25479" method="post">
<div class="page-header">
    <h3><span class="muted">25479</span> / CPU Efficiency Quality Map - What is it?</h3>
</div>

<div class="row-fluid">
<div class="span5">
    <legend>Contact</legend>
    <div class="control-group">
        <label class="control-label">Full Name</label>
        <div class="controls">Donald Krieger</div>
    </div>
    <div class="control-group">
        <label class="control-label">Email</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">Phone</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">CC</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>

    <legend>Details</legend>
    <div class="control-group"><label class="control-label">Submitted Via</label><div class="controls">GOC Ticket/submit</div></div><div class="control-group"><label class="control-label">Submitter</label><div class="controls">Donald Krieger</div></div><div class="control-group"><label class="control-label">Ticket Links</label><div class="controls"></div></div>
    <div class="control-group">
        <label class="control-label">Ticket Type</label>
        <div class="controls">Problem/Request</div>
    </div>
    <div class="control-group">
        <label class="control-label">Priority</label>
        <div class="controls">Normal</div>
    </div>
    <div class="control-group">
        <label class="control-label">Status</label>
        <div class="controls">
Closed</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action</label>
        <div class="controls">Resolved</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action Deadline</label>
        <div class="controls flag_red">2015-06-01</div>
    </div>

</div><!--span-->
<div class="span7">
    <legend>Assignees</legend>
    <div class="assignee" style="width: 60%">Software Support (Triage) <span class="muted"> / OSG Software Team</span></div><div class="assignee" style="width: 60%">Carl Edquist <span class="muted"> / OSG Software Team</span></div>    <br>

    <legend>Assignees</legend>
    TODO
    <br>

    <style>
legend.noborder {
border-bottom: none;
}
</style>

<div id="attachment-list"/>
<script>
$(function () {
    var first = true;
    $.getJSON("attachment/list/25479", function (files) {
        //console.dir(files);
        var html = "<table class=\"table table-condensed\">";
        $(files).each(function() {
            if(first) {
                first = false;
                html += "<legend class=\"noborder\">Attachmenets</legend>";
            }
            html += "<tr class=\"attachment\">";
            html += "<td><img src="https://ticket.opensciencegrid.org/\&quot;&quot;+this.thumbnail_url+&quot;\&quot;/"></td>";
            html += "<td><a href="https://ticket.opensciencegrid.org/\&quot;&quot;+this.url+&quot;\&quot;" target=\"_blank\">"+this.name+"</a></td>";
            html += "<td>"+bytesToSize(this.size, 1)+"</td>";
            html += "</tr>";
        });
        html += "</table>";
        $("#attachment-list").html(html);
    });
});

function download(url) {
    window.open(url, "_blank");
}
</script>


</div><!--span-->
</div><!--row-fluid-->


</form>

</div>
<div id="updates" style="clear: both;">
    <legend>Past Updates
    <div class="btn-toolbar pull-right toolbar">
        <div class="btn-group">
                <a class="btn btn-small" href="https://ticket.opensciencegrid.org/25479?sort=up&amp;"><i class="icon-arrow-up"></i> Sort</a>

        
        <a class="btn btn-small" href="https://ticket.opensciencegrid.org/25479?expandall=true&amp;">Expand Descriptions</a>        <a class="btn btn-small" target="_blank" href="mailto:osg@tick.globalnoc.iu.edu?subject=Open%20Science%20Grid%3A%20CPU%20Efficiency%20Quality%20Map%20-%20What%20is%20it%3F%20ISSUE%3D25479%20PROJ%3D71"><i class="icon-envelope"></i> Update w/Email</a>
        </div>
    </div><!--btn-toolbar-->
    </legend>

    <div class='update_description'><i onclick="document.location='25479#1433005218'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-05-30T17:00:18+00:00">May 30, 2015 05:00 PM UTC</time> by <b>Don Krieger</b><a class="anchor" name="1433005218">&nbsp;</a></div><pre>Hi Juan,

First, I have the information I requested and think this ticket could be retired.
Thank you, Juan, for getting back and for all of your efforts.

It seems pretty clear that what you are calling CPU Efficiency Quality is a composite measure&#58;

CPUEffcyQual = 100 x Numerator/Denominator where
Numerator = total user cpu time on grid node from which the job exits the grid
Denominator =  time to job exit from the grid - time at which job begins running on the first grid node to which it is sent

The numerator compared with the total time on the grid node from which the job exits is the number I asked about.
That is what one could get from the unix/linux utility, time, which provides the user and system times consumed by a process from start to finish.
The ratio (user time)/(user time + system time) can be extracted from the log file of each job and provides a measure of how much the job took doing arithmetic compared with how much time it took doing IO.  That total is included in the denominator of CPUEffcyQual but to it is added extra time which results from the job failing on one or more node due to communications failures, getting bumped, etc.

It would be useful to have the two things separated.
The first is cpu vs IO efficiency which is potentially controllable by the programmer.
The second might be called grid efficiency or grid performance since that portion may or may  not have anything to do with the job.
The reason I asked the question in the first place is that I was alarmed that there was something wrong with my jobs based on your measure.
My spot checks of the cpu vs IO efficiency put it consistently at 93-99+ percent whereas my jobs are at 65-80% on your measure.
That’s a big difference and worth understanding.

Thanks again.

Don</pre></div><div class='update_description'><i onclick="document.location='25479#1432926554'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-05-29T19:09:14+00:00">May 29, 2015 07:09 PM UTC</time><a class="anchor" name="1432926554">&nbsp;</a></div><pre>Hi Don,

1. Yes the contribution of that job would be 93.4%

2. Yes in this plot the times of all the jobs are included in the denominator, so if many jobs fail that time would reduce the overall efficiency.

Thanks,
Juan F. Mosquera

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=jmosquer/CN=760823/CN=Juan Felipe Mosquera Morales</pre></div><div class='update_description'><i onclick="document.location='25479#1432763590'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-05-27T21:53:10+00:00">May 27, 2015 09:53 PM UTC</time> by <b>Don Krieger</b><a class="anchor" name="1432763590">&nbsp;</a></div><pre>Thanks for the response, Juan.
The delay was no problem.
Your last statement is helpful – perhaps you could expand on it.
Please keep in mind that I have no knowledge of the data base to which you refer nor am I familiar with SQL syntax.

Here are a couple of additional questions&#58;

1.       Below are the pertinent lines from a log file shown starting time (21&#58;26&#58;47), termination time (21&#58;39&#58;34), and total remote usage (11&#58;57).  The total run time is 21&#58;39&#58;34-21&#58;26&#58;47 = 12&#58;47.   Would the contribution of this job to the tabulated total efficiency be 11&#58;57/12&#58;47 = 717/767 = 93.4% ?

001 (19839896.000.000) 05/27 21&#58;26&#58;47 Job executing on host&#58; &#60;169.228.131.104&#58;54203?CCBID=129.79.53.179&#58;9700#243873&noUDP&#62;
...
006 (19839896.000.000) 05/27 21&#58;26&#58;56 Image size of job updated&#58; 1000000
2  -  MemoryUsage of job (MB)
1868  -  ResidentSetSize of job (KB)
...
006 (19839896.000.000) 05/27 21&#58;31&#58;58 Image size of job updated&#58; 1078736
307  -  MemoryUsage of job (MB)
313348  -  ResidentSetSize of job (KB)
...
005 (19839896.000.000) 05/27 21&#58;39&#58;34 Job terminated.
(1) Normal termination (return value 0)
Usr 0 00&#58;11&#58;57, Sys 0 00&#58;00&#58;00  -  Run Remote Usage
Usr 0 00&#58;00&#58;00, Sys 0 00&#58;00&#58;00  -  Run Local Usage
Usr 0 00&#58;11&#58;57, Sys 0 00&#58;00&#58;00  -  Total Remote Usage
Usr 0 00&#58;00&#58;00, Sys 0 00&#58;00&#58;00  -  Total Local Usage

2.       How would the values you are tabulating be effected If a job was disconnected or otherwise abnormally terminated on one host and automatically restarted 60 minutes later on another where it completed normally?  Would that time be counted into the denominator from the first question?

Regards,

Don</pre></div><div class='update_description'><i onclick="document.location='25479#1432760824'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-05-27T21:07:04+00:00">May 27, 2015 09:07 PM UTC</time> by <b>Carl Edquist</b><a class="anchor" name="1432760824">&nbsp;</a></div><pre>Thanks Juan!

Don, please let us know if this answers your question and we can close the ticket or if there are any further concerns.

Thanks!
Carl</pre></div><div class='update_description'><i onclick="document.location='25479#1432752230'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-05-27T18:43:50+00:00">May 27, 2015 06:43 PM UTC</time><a class="anchor" name="1432752230">&nbsp;</a></div><pre>Hi  All,

I&#39;m sorry i was on vacation during the last 2 weeks.

The efficiency is computed with this SQL clause&#58;

sum(case when ApplicationExitCode = 0 then CpuUserDuration + CpuSystemDuration else 0 end)/sum(Cores*WallDuration)

So if the application exits correctly a low inefficiency could be due to any blocking situation that is happening and preventing the application from use the cpu, like I/O of any kind, sleep, semaphores (wait, select), deadlock, etc.

I hope this helps.

Thanks,
Juan F. Mosquera

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=jmosquer/CN=760823/CN=Juan Felipe Mosquera Morales</pre></div><div class='update_description'><i onclick="document.location='25479#1432750862'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-05-27T18:21:02+00:00">May 27, 2015 06:21 PM UTC</time> by <b>Vince Neal</b><a class="anchor" name="1432750862">&nbsp;</a></div><pre>Adding the Software Team for this request.</pre></div><div class='update_description'><i onclick="document.location='25479#1432066126'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-05-19T20:08:46+00:00">May 19, 2015 08:08 PM UTC</time> by <b>Vince Neal</b><a class="anchor" name="1432066126">&nbsp;</a></div><pre>Hi Don,

I have added Juan to this ticket to shed some light on your request.
Please let me know if I can assist.

Thanks!
Vince</pre></div><div class='update_description'><i onclick="document.location='25479#1432051918'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-05-19T16:11:58+00:00">May 19, 2015 04:11 PM UTC</time> by <b>Vince Neal</b><a class="anchor" name="1432051918">&nbsp;</a></div><pre>The link below shows a graphic for a parameter called CPU Efficiency Quality.

What is it?

How is it computed?

I am user donkri and would like to know if there is a problem with what I’m doing which is leading to the low value my work has on this metric.

<a href='http&#58;//gratiaweb.grid.iu.edu/gratia/xml/glidein_dn_efficiency_summary?facility=.*&probe=.*&resource-type=BatchPilot&vo=osg&grid=.*&user=.*&fixed-height=False&endtime=2015-05-19+23%3A59%3A59&exclude-vo=Unknown|unknown|other&includeFailed=true&exclude-role=NONE&span=86400&min_hours=0&role=.*&starttime=2015-05-05+00%3A00%3A00&exclude-facility=NONE&exclude-user=NONE&includeSuccess=true' target='_blank' rel='nofollow'>http&#58;//gratiaweb.grid.iu.edu/gratia/xml/glidein_dn_efficiency_summary?facility=.*&probe=.*&resource-type=BatchPilot&vo=osg&grid=.*&user=.*&fixed-height=False&endtime=2015-05-19+23%3A59%3A59&exclude-vo=Unknown|unknown|other&includeFailed=true&exclude-role=NONE&span=86400&min_hours=0&role=.*&starttime=2015-05-05+00%3A00%3A00&exclude-facility=NONE&exclude-user=NONE&includeSuccess=true</a>

Thanks,

Don

[Image&#58; &#34;Signature0001&#34;]
Don Krieger, Ph.D.

Department of Neurological Surgery

University of Pittsburgh

(412)648-9654 Office

(412)521-4431 Cell/Text</pre></div><legend>Similar Recent Tickets <small>modified within the last 30 days</small></legend><div id="similar_tickets"><p class="muted">No similar tickets found.</p></div>
</div>
<script type="text/javascript">
function reset_anchor() {
    $("#updates .selected").removeClass("selected");
    var urls = document.location.toString().split('#'); 
    var anchor = urls[1];
    if(anchor) {
        $("a[name='"+anchor+"']").parents(".update_description").addClass("selected");
    }
}
function submitspam(ticket_id) {
    myret = confirm("Would you like to close this ticket as a security ticket, and submit the ticket content to akismet?");
    if(myret == true) {
        $.ajax("viewer/processspam?id="+ticket_id).done(function() {
            window.location.reload();
        });
    }
}

$(function() {
    reset_anchor();
    var ADDITIONAL_COOKIE_NAME = 'gocticket';
    var options = { path: '/', expires: 365};

    if(window.opener && window.opener.name == "gocticket_list") {
        v = $.cookie("closewindow");
        if(!v) {
            $("#closewindow").attr("checked", "checked"); //on by default
        } else {
            if(v == "checked") {
                $("#closewindow").attr("checked", "checked");
            }
        }
        $("#closewindow").click(function() {
            $.cookie("closewindow", $(this).attr('checked'), options);
        });
    } else {
        $("#closewindow_area").hide();
    }
    function updateTimeago() {
        $("time").timeago();
        setTimeout(updateTimeago, 30*1000);
    }
    updateTimeago();
    $(".description").focus(expand_description);
});
</script>
<hr/>
<footer>
<p>GOC Ticket Version 2.2 | <a href="https://ticket.opensciencegrid.org/goc/submit?app_issue_check=on&amp;app_issue_type=goc&amp;app_goc_url=https%3A%2F%2Fticket.opensciencegrid.org%3A443%2F25479">Report Bugs</a>
 | <a href="https://github.com/opensciencegrid/operations/blob/master/docs/privacy.md">Privacy Policy</a>
</p>

<p> <img align="top" src="images/tag_orange.png"/> Copyright 2018 The Trustees of Indiana University - Developed for Open Science Grid</p>
</footer>


</div><!--container-fluid-->
<script src="https://ticket1.grid.iu.edu:8443/socket.io/socket.io.js"></script>
<script>
var chat = io.connect('https://ticket1.grid.iu.edu:8443');
chat.on('connect', function() {
    chat.emit('authenticate', {nodekey:'', ticketid: 25479});
});
chat.on('peers', function(peers) {
    $("#peers").html("");
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('peer_disconnect', function(pid) {
    $("#peer_"+pid).hide("slow");
});
chat.on('peer_connected', function(peers) {
    //expect only 1 peer connecting, but..
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('submit', function() {
    if(confirm("This ticket was updated. Do you want to refresh?")) {
        history.go(0);
    }
});

function addPeer(pid, peer) {
    var ipinfo = "";
    if(peer.ip != undefined) {
        ipinfo = "<span class=\"ip\">"+peer.ip+"</span>";
    }
    if(chat.io.engine.id == pid) {
        //don't display myself
        return;
    }
    var html = "<li class=\"new\" id=\"peer_"+pid+"\" class=\"peer\">"+peer.name+ipinfo+"</li>";
    $("#peers").prepend(html);
    $("#peers .new").animate({bottom: 0}, 1000, function() {$(this).removeClass("new")});
}

$(function() {
    $("#ticket_form").submit(function() {
        chat.emit('submit');
        return true;
    });
});
</script>
<script>
//used by searchbox
function parseValue(value) {
    var obj = new Object();
    var tokens = value.split("\t");
    obj.str = tokens[0];
    obj.count = tokens[1];
    return obj;
}

$(function() {
    //bootstrap-2.0.4 stuff
    $(".alert-message").alert();
    $(".dropdown-toggle").dropdown();
    $("span[rel='tooltip']").tooltip();
    $("a[rel=popover]").popover();

    //activate menu that user is currently on
    $("#menu_navigator").addClass("active"); 
    $("#submenu_").addClass("active"); 

    //translate zend validation error message to bootstrap
    $(".errors").addClass("alert").addClass("alert-error");

    //enable autocomplete for search box
    $("#search").autocomplete({
        source: function( request, response ) {
            $.ajax({
                url: "search/autocomplete",
                dataType: "text",
                data: {
                    //featureClass: "P",
                    //style: "full",
                    //maxRows: 12,
                    //name_startsWith: request.term
                    q: request.term
                },
                success: function( data ) {
                    response( $.map( data.split("\n"), function( item ) {
                        if(item == "") return null;
                        return {
                            value: item
                        }
                    }));
                }
            });
        },
        select: function(event, ui) {
            document.location = "search?q="+ui.item.value;
        }
    });
    
});
</script>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-69012-13");
pageTracker._trackPageview();
} catch(err) {}
</script>

</body>
