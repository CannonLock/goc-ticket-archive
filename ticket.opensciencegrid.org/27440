<!DOCTYPE html>
<html lang="en">
  <head>
  <base href="">
    <title>[27440] Bestman2 and Adler32 checksum</title>    <meta charset="utf-8" />
    <meta name="verify-v1" content="na5IcAJsZVOfEkboRxuIiZ1zpZgnZiWra+nKcS7nA/o=" />
    <meta name="google-site-verification" content="DLrk3ft4s8b-S2TloLCL2LD_t6wcTjgSluf5pmiu2kA" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />
    <link href="https://ticket.opensciencegrid.org/rss" rel="alternate" type="application/rss+xml" title="GOC Ticket Update feed" />

    <style type="text/css">
      body {
        padding-top: 50px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
     #search {
            width: 300px;
     }

    </style>

<script src="https://code.jquery.com/jquery-3.0.0.js"></script>
<script src="https://code.jquery.com/jquery-migrate-3.0.1.js"></script>

   <link href="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet"/>
    <script src="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/js/bootstrap.min.js"></script>

    <link href="https://netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"/>
    <link href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/themes/smoothness/jquery-ui.min.css" rel="stylesheet"/>
 <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>


    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/js/select2.min.js"></script>

    <link href="css/ticket.css" rel="stylesheet" />
    <script src="lib/jquery.cookie.js"></script>

    <link href="images/tag_orange.png" rel="icon" type="image/png"/>
    <script src='https://www.google.com/recaptcha/api.js'></script>
  </head>

  <body>
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>

            <a class="brand" style="padding: 6px 0px 0px 6px;" href="http://opensciencegrid.org"><img src="images/osglogo.40x30.png"/></a>
            <ul class="nav">
                <li class="dropdown"><a href="https://ticket.opensciencegrid.org/#" class="dropdown-toggle" data-toggle="dropdown">GOC Ticket <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    <li><a href="https://my.opensciencegrid.org">MyOSG</a></li>
                    <li><a href="https://oim.opensciencegrid.org">OIM</a></li>
                    <li class="active"><a href="https://ticket.opensciencegrid.org/index">Ticket</a></li>
	<li class="divider"></li>
	<li><a href="http://repo.grid.iu.edu">Repo</a></li>
	<li class="divider"></li>
	<li><a href="http://blogs.grid.iu.edu">Blog</a></li>
                    <li><a href="http://display.grid.iu.edu">Display</a></li>
                    <li><a href="http://osggoc.blogspot.com/">News</a></li>
                    </ul>
                </li>
            </ul>
            <ul class="nav pull-right">
                <li><a href="https://ticket.opensciencegrid.org/sso/">Login</a></li>            </ul>

            <div class="nav-collapse">
                <ul class="nav">
			 <li id="menu_submit"><a href="https://ticket.opensciencegrid.org/submit">Submit</a></li><li id="menu_view" class="dropdown"><a href="https://ticket.opensciencegrid.org/\#" class="dropdown-toggle" data-toggle="dropdown">View <b class="caret"></b></a><ul class="dropdown-menu"><li id="submenu_listopen"><a href="https://ticket.opensciencegrid.org/list/open">Open Tickets</a></li><li id="submenu_listrecentclose"><a href="https://ticket.opensciencegrid.org/list/recentclose">Recently Closed Tickets</a></li><li class="divider"></li><li id="submenu_alltickets"><a href="https://ticket.opensciencegrid.org/search?q=&amp;sort=id">All Tickets</a></li></ul></li>                </ul>

                <form class="navbar-search pull-right" action="https://ticket.opensciencegrid.org/viewer">
                    <input id="search" type="text" name="id" class="search-query span2" placeholder="Search Ticket" value=""/>
                </form>
            </div>
        </div>
      </div>
    </div>

<script type='text/javascript' src='lib/jquery.timeago.js'></script>
<script type='text/javascript' src='lib/byte2size.js'></script>
<style>
#updates .toolbar {
position: relative;
margin-top: 0px;
top: -10px;
font-weight: normal;
}
#updates a.anchor {
position: relative;
top: -50px;
}
#updates .selected pre {
animation:selected 2s;
animation-iteration-count: 2;
animation-direction: alternate;
-webkit-animation:selected 2s; 
-webkit-animation-iteration-count: 2;
-webkit-animation-direction: alternate;
box-shadow: inset 1px 1px 20px #9ad;
border: 1px solid #9ab;
margin: 5px 0px;
padding-left: 10px;
}
@keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ab;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
@-webkit-keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ad;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
#updates pre {
background-color: inherit;
line-height: 15px;
padding: 5px;
}
#updates .header {
color: #999;
}
#updates .update_history pre {
background-color: #eee;
color: #666;
font-size: 85%;
}
#updates .clickable {
cursor: pointer;
}
#updates .clickable:hover {
color: #D98719;
}
#updates .meta_information pre {
background-color: #fed;
}
#similar_tickets {
max-height: 300px;
overflow-y: auto;
pointer-events: none;
padding: 5px;
background-color: #f4f4f4;
}
.btn-toolbar {
margin-bottom: 0;
height: 30px;
}
#peers {
position: fixed;
bottom: 0px;
right: 0px;
z-index: 100;
list-style: none;
padding: 5px 0px 0px 5px;
margin: 0px;
background-color: white;
box-shadow: 0px 0px 10px white;
}
#peers li {
background-color: #ccc;
color: #000;
display: inline-block;
padding: 5px 10px;
margin-right: 5px;
position: relative;
}
/*
#peers li:hover {
background-color: #999;
cursor: pointer;
}
*/
#peers span.ip {
padding-left: 5px;
color: #666;
}
#peers .new {
bottom: -30px;
}
/*
#peers .me {
background-color: red;
}
*/
</style>

<div class="container-fluid">
<ul id="peers"></ul>
<div class="alert alert-danger"><a class="close" href="https://ticket.opensciencegrid.org/#" data-dismiss="alert">&times;</a>By the end of May 2018, the ticketing system at https://ticket.opensciencegrid.org will be retired and support will be provided at https://support.opensciencegrid.org. Throughout this transition the support email (help@opensciencegrid.org) will be available as a point of contact.<br><br>                                                   
                                                                                                                                                                                   
Please see the service migration page for details: https://opensciencegrid.github.io/technology/policy/service-migrations-spring-2018/#ticket</div><div id="presence" class="pull-right"></div><div class="ticketgui"><script type="text/javascript" src="lib/checktab.js"></script>

<script>
var expanded = false;
function expand_description() {
    var desc = $(".description");
    if(!expanded) {
        expanded = true;
        //expand to minheight
        var min = 250;
        if(desc.height() < min) {
            desc.animate({height: min}, 200);
        }
    }
}

$(document).ready(function() {
    $("input[name='nad']").datepicker({
        dateFormat: 'yy-mm-dd'
    });
});

</script>



<style>
.form-horizontal .control-label {
padding-top: inherit;
font-size:90%;
color:#666;
}
label {
margin-bottom: 0px;
}
.controls {
line-height: 18px;
}
</style>
<form class="form-horizontal" action="https://ticket.opensciencegrid.org/viewer/updatebasic?id=27440" method="post">
<div class="page-header">
    <h3><span class="muted">27440</span> / Bestman2 and Adler32 checksum</h3>
</div>

<div class="row-fluid">
<div class="span5">
    <legend>Contact</legend>
    <div class="control-group">
        <label class="control-label">Full Name</label>
        <div class="controls">Lisa Gerhardt</div>
    </div>
    <div class="control-group">
        <label class="control-label">Email</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">Phone</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">CC</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>

    <legend>Details</legend>
    <div class="control-group"><label class="control-label">Submitted Via</label><div class="controls">GOC Ticket/submit</div></div><div class="control-group"><label class="control-label">Submitter</label><div class="controls">Lisa Gerhardt</div></div><div class="control-group"><label class="control-label">Ticket Links</label><div class="controls"></div></div>
    <div class="control-group">
        <label class="control-label">Ticket Type</label>
        <div class="controls">Problem/Request</div>
    </div>
    <div class="control-group">
        <label class="control-label">Priority</label>
        <div class="controls">Normal</div>
    </div>
    <div class="control-group">
        <label class="control-label">Status</label>
        <div class="controls">
Closed</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action</label>
        <div class="controls">Resolved</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action Deadline</label>
        <div class="controls flag_red">2015-11-18</div>
    </div>

</div><!--span-->
<div class="span7">
    <legend>Assignees</legend>
        <br>

    <legend>Assignees</legend>
    TODO
    <br>

    <style>
legend.noborder {
border-bottom: none;
}
</style>

<div id="attachment-list"/>
<script>
$(function () {
    var first = true;
    $.getJSON("https://ticket.opensciencegrid.org/attachment/list?id=27440", function (files) {
        //console.dir(files);
        var html = "<table class=\"table table-condensed\">";
        $(files).each(function() {
            if(first) {
                first = false;
                html += "<legend class=\"noborder\">Attachmenets</legend>";
            }
            html += "<tr class=\"attachment\">";
            html += "<td><img src="https://ticket.opensciencegrid.org/\&quot;&quot;+this.thumbnail_url+&quot;\&quot;/"></td>";
            html += "<td><a href="https://ticket.opensciencegrid.org/\&quot;&quot;+this.url+&quot;\&quot;" target=\"_blank\">"+this.name+"</a></td>";
            html += "<td>"+bytesToSize(this.size, 1)+"</td>";
            html += "</tr>";
        });
        html += "</table>";
        $("#attachment-list").html(html);
    });
});

function download(url) {
    window.open(url, "_blank");
}
</script>


</div><!--span-->
</div><!--row-fluid-->


</form>

</div>
<div id="updates" style="clear: both;">
    <legend>Past Updates
    <div class="btn-toolbar pull-right toolbar">
        <div class="btn-group">
                <a class="btn btn-small" href="https://ticket.opensciencegrid.org/27440?sort=up&amp;"><i class="icon-arrow-up"></i> Sort</a>

        
        <a class="btn btn-small" href="https://ticket.opensciencegrid.org/27440?expandall=true&amp;">Expand Descriptions</a>        <a class="btn btn-small" target="_blank" href="mailto:osg@tick.globalnoc.iu.edu?subject=Open%20Science%20Grid%3A%20Bestman2%20and%20Adler32%20checksum%20ISSUE%3D27440%20PROJ%3D71"><i class="icon-envelope"></i> Update w/Email</a>
        </div>
    </div><!--btn-toolbar-->
    </legend>

    <div class='update_description'><i onclick="document.location='27440#1447952016'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-11-19T16:53:36+00:00">Nov 19, 2015 04:53 PM UTC</time> by <b>Vince Neal</b><a class="anchor" name="1447952016">&nbsp;</a></div><pre>Thank you Horst and Lisa.  I will set this to resolved.</pre></div><div class='update_description'><i onclick="document.location='27440#1447941630'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-11-19T14:00:30+00:00">Nov 19, 2015 02:00 PM UTC</time><a class="anchor" name="1447941630">&nbsp;</a></div><pre>HI Lisa,

glad to hear that! I have no idea why you need this showChecksumWhenListingFile, either, we&#39;ve just always had it, since those were the directions from the developers. And no, I don&#39;t think that this would ever work without these lines, since I don&#39;t think bestman2 has a default checksum program -- or if it does, the default is most likely md5 and not adler32.

Cheers,

Horst

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=Horst Severini 27</pre></div><div class='update_description'><i onclick="document.location='27440#1447895010'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-11-19T01:03:30+00:00">Nov 19, 2015 01:03 AM UTC</time><a class="anchor" name="1447895010">&nbsp;</a></div><pre>Hi Horst,
Thanks. The &#34;-fulldetailed&#34; flag helped speed along the debugging. So once I declared

showChecksumWhenListingFile=true
defaultChecksumType=adler32
hexChecksumCommand=/chos/common/srm/bin/adler32.py

in the config file, transfers started working again (adler32.py is the same as calc_adler32.py from the bestman adler32 checksum page). The only thing different from what I had before is showChecksumWhenListingFile is set to true. I&#39;m a bit perplexed why this option has any effect. Also, I&#39;m perplexed why commenting all three of these options out doesn&#39;t work, since it sounds like it should use adler32 by default and be able to calculate this without external help. I didn&#39;t want to poke it any more, since the scientists were getting antsy for their data, but I might revisit this once the backlog clears.

Thanks Horst and Vince for the help,
Lisa

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=Lisa Gerhardt</pre></div><div class='update_description'><i onclick="document.location='27440#1447882363'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-11-18T21:32:43+00:00">Nov 18, 2015 09:32 PM UTC</time><a class="anchor" name="1447882363">&nbsp;</a></div><pre>Hi Lisa,

I just looked at our Tier3 Bestman2 server, and restarted it as a test, and I&#39;m also seeing these &#39;unrecognized configuration entry&#39; messages, so I&#39;m afraid that&#39;s a red herring, since our server reports adler32 checksums back just fine.

I noticed that in your bestman2.rc, the &#39;showChecksumWhenListingFile=true&#39; is commented out. We have that uncommented. Can you try uncommenting it and restarting? This may or may not help, since I doubt you recently changed that, but you never know ...

Also, I assume you haven&#39;t made any recent changes to /etc/sudoers? That might affect things as well -- well, they do here, but then again, our hexChecksumCommand contains a sudo, whereas yours doesn&#39;t seem to, so maybe not ...

I tried running some srm-commands against pd2015.nersc.gov, but it doesn&#39;t seem to be running right now. Another thing you can try is the equivalent of this command on one of the files in your storage&#58;

srm-ls <a href='srm&#58;//ouhep2.nhn.ou.edu&#58;8443/srm/v2/server&#92' target='_blank' rel='nofollow'>srm&#58;//ouhep2.nhn.ou.edu&#58;8443/srm/v2/server&#92</a>;?SFN=/raid/users/hs/test1 -fulldetailed

That might give you a hint as to where the checksum command is failing, too. The relevant section should look something like this&#58;

----
CheckSumType=ADLER32
CheckSumValue=1238d73a
[...]
SRM-CLIENT*CHECKSUMTYPE=ADLER32
SRM-CLIENT*CHECKSUMVALUE=1238d73a
----

And in the past when we had problems with our checksumming, these lines threw very weird errors, which helped us track down the issue further.

Hope this helps,

Horst

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=Horst Severini 27</pre></div><div class='update_description'><i onclick="document.location='27440#1447881998'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-11-18T21:26:38+00:00">Nov 18, 2015 09:26 PM UTC</time><a class="anchor" name="1447881998">&nbsp;</a></div><pre>Hi,
Have you had a chance to look at this? All bestman transfers have been failing since this weekend.

Thanks,
Lisa

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=Lisa Gerhardt</pre></div><div class='update_description'><i onclick="document.location='27440#1447807271'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-11-18T00:41:11+00:00">Nov 18, 2015 12:41 AM UTC</time><a class="anchor" name="1447807271">&nbsp;</a></div><pre>Hi Vince,
More weirdness to add to this. I turned on debug and restarted bestman2 and noticed that hexChecksumCommand and defaultChecksumType are showing as &#34;unrecognized configuration entry&#34; in the logs&#58;

ts=2015-11-18T01&#58;29&#58;54.861Z level=Console class=gov.lbl.srm.util.TSRMUtil ==&#62; assigned event log to be&#58; /var/log/bestman2/event.srm.log max bytes to rotate&#58;50000000 t
id=main
ts=2015-11-18T01&#58;29&#58;54.862Z level=Console class=gov.lbl.srm.util.TSRMUtil              no cache log tid=main
ts=2015-11-18T01&#58;29&#58;54.862Z level=Console class=gov.lbl.srm.util.TSRMUtil Log level is setting to&#58;DEBUG tid=main
ts=2015-11-18T01&#58;29&#58;54.862Z level=Console class=gov.lbl.srm.util.TSRMUtil .......local file system will be accessed through sudo tid=main
ts=2015-11-18T01&#58;29&#58;54.862Z level=Console class=gov.lbl.srm.util.TSRMUtil        however, local _ls_ will not invoke sudo tid=main
ts=2015-11-18T01&#58;29&#58;54.876Z level=Console class=gov.lbl.srm.util.TSRMUtil sudo -v -S succeed. tid=main
ts=2015-11-18T01&#58;29&#58;54.892Z level=Console class=gov.lbl.srm.util.TSRMUtil &#62;&#62;&#62;&#62;&#62;&#62;&#62;&#62; unrecognized configuration entry&#58; hexChecksumCommand tid=main
ts=2015-11-18T01&#58;29&#58;54.892Z level=Console class=gov.lbl.srm.util.TSRMUtil &#62;&#62;&#62;&#62;&#62;&#62;&#62;&#62; Gateway mode specific&#58; checkSizeWithFS tid=main
ts=2015-11-18T01&#58;29&#58;54.892Z level=Console class=gov.lbl.srm.util.TSRMUtil &#62;&#62;&#62;&#62;&#62;&#62;&#62;&#62; Gateway mode specific&#58; fsConcurrency tid=main
ts=2015-11-18T01&#58;29&#58;54.892Z level=Console class=gov.lbl.srm.util.TSRMUtil &#62;&#62;&#62;&#62;&#62;&#62;&#62;&#62; unrecognized configuration entry&#58; defaultChecksumType tid=main
ts=2015-11-18T01&#58;29&#58;54.892Z level=Console class=gov.lbl.srm.util.TSRMUtil &#62;&#62;&#62;&#62;&#62;&#62;&#62;&#62; Gateway mode specific&#58; pathForToken tid=main
ts=2015-11-18T01&#58;29&#58;54.892Z level=Console class=gov.lbl.srm.util.TSRMUtil &#62;&#62;&#62;&#62;&#62;&#62;&#62;&#62; Gateway mode specific&#58; checkSizeWithGsiftp tid=main
ts=2015-11-18T01&#58;29&#58;54.901Z level=Console class=gov.lbl.srm.util.TSRMUtil ## countIpAddress&#58; loopback tid=main
ts=2015-11-18T01&#58;29&#58;54.901Z level=Console class=gov.lbl.srm.util.TSRMUtil ## countIpAddress&#58; loopback tid=main
ts=2015-11-18T01&#58;29&#58;54.902Z level=Console class=gov.lbl.srm.util.TSRMUtil ## countIpAddress&#58; found 0th address=pd2015.nersc.gov tid=main
ts=2015-11-18T01&#58;29&#58;54.902Z level=Console class=gov.lbl.srm.util.TSRMUtil ## found 1 host addresses tid=main

Have you ever seen this before?

In case it&#39;s helpful, here&#39;s the rpms that are installed&#58;

[root@pd2015 ~]# rpm -qa | grep bestman
bestman2-server-dep-libs-2.3.0-25.osg32.el6.noarch
bestman2-server-2.3.0-25.osg32.el6.noarch
bestman2-client-libs-2.3.0-25.osg32.el6.noarch
bestman2-server-libs-2.3.0-25.osg32.el6.noarch
bestman2-client-2.3.0-25.osg32.el6.noarch
bestman2-common-libs-2.3.0-25.osg32.el6.noarch
bestman2-tester-libs-2.3.0-25.osg32.el6.noarch
bestman2-tester-2.3.0-25.osg32.el6.noarch
osg-se-bestman-3.0.0-9.osg.el6.x86_64
<div id='show_1696359410' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_1696359410'>
Thanks,
Lisa

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=Lisa Gerhardt
</div><script type='text/javascript'>
        $('#show_1696359410').click(function() {
            $('#detail_1696359410').slideDown("normal");
            $('#show_1696359410').hide();
            $('#hide_1696359410').show();
        });
        $('#hide_1696359410').click(function() {
            $('#detail_1696359410').slideUp();
            $('#hide_1696359410').hide();
            $('#show_1696359410').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='27440#1447717579'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-11-16T23:46:19+00:00">Nov 16, 2015 11:46 PM UTC</time><a class="anchor" name="1447717579">&nbsp;</a></div><pre>Hi Vince,
Thanks for the link and the suggestions. Here&#39;s the relevant bits from /etc/bestman2/conf/bestman2.rc

[root@pd2015 ~]# cat /etc/bestman2/conf/bestman2.rc | grep Check
### showChecksumWhenListingFile to return checksum in srmLs
### defaultChecksumType supports adler32, md5, crc32
#showChecksumWhenListingFile=true
defaultChecksumType=adler32
### hexChecksumCommand to plugin checksum calculation callout
### defaultChecksumType should be adler32 in hex
### only valid when showChecksumWhenListingFile=true
### e.g. hexChecksumCommand=/usr/local/mychecksum -adler32
#hexChecksumCommand=/home/srm/bestman_apps/adler32/adler32.py
#hexChecksumCommand=/export/data/atlas/bestman/adler32.sh
hexChecksumCommand=/chos/common/srm/bin/adler32.py

Where /chos/common/srm/bin/adler32.py is the same as calc_adler32.py on <a href='https&#58;//twiki.opensciencegrid.org/bin/view/Storage/BestmanAdler32Checksum.' target='_blank' rel='nofollow'>https&#58;//twiki.opensciencegrid.org/bin/view/Storage/BestmanAdler32Checksum.</a> I checked that this is world visible and can be run as the correct user. I looked in /var/log/bestman2/event.srm.log and /var/log/bestman2/bestman2.log, but they seem to be pretty unhelpful. Is there any way I can get bestman to report what variables it has set or any other internal information?

Thanks,
Lisa

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=Lisa Gerhardt</pre></div><div class='update_description'><i onclick="document.location='27440#1447707788'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-11-16T21:03:08+00:00">Nov 16, 2015 09:03 PM UTC</time> by <b>Vince Neal</b><a class="anchor" name="1447707788">&nbsp;</a></div><pre>Hi Lisa,

From what I can see in our documentation you should be using adler32 as the default checksum.  Is it possible that the power failure changed or corrupted an environment variable?
For more information please see this document&#58;  <a href='https&#58;//twiki.opensciencegrid.org/bin/view/Storage/BestmanAdler32Checksum' target='_blank' rel='nofollow'>https&#58;//twiki.opensciencegrid.org/bin/view/Storage/BestmanAdler32Checksum</a>

Please let me know how I can assist.

Thank you,
Vince</pre></div><div class='update_description'><i onclick="document.location='27440#1447703425'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-11-16T19:50:25+00:00">Nov 16, 2015 07:50 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1447703425">&nbsp;</a></div><pre>After a power outage transfers are failing at our ATLAS endpoint because the checksums don&#39;t agree&#58;

TRANSFER CHECKSUM Source and destination checksums do not match 8e23565f != 486428bdea188010c7beb66acc0fe663

In our /etc/bestman2/conf/bestman2.rc we have the line&#58;
#defaultChecksumType=adler32

I tried changing this to
defaultChecksumType=md5

and restarting the bestman2 service and I&#39;m still getting this error. The checksum does not seem to be changed by this parameter.

Is there some way to get more information about this? Any suggestions for what I should try?

Here&#39;s the full transfer information that is failing&#58;
<a href='http&#58;//dashb-atlas-ddm.cern.ch/ddm2/#activity=%28Data+Brokering' target='_blank' rel='nofollow'>http&#58;//dashb-atlas-ddm.cern.ch/ddm2/#activity=%28Data+Brokering</a>,Data+Consolidation,Data+Export+Test,Debug,Deletion,Express,Functional+Test,Group+Subscriptions,Production,Production+Input,Production+Output,Recovery,Staging,T0+Export,T0+Tape,User+Subscriptions,default,on,on,rucio-integration,test,test%3AT0_T1+export,test%3AT1_T2+export,testactivity10,testactivity20,testactivity70%29&d.page.offset=100&dst.site=%28NERSC%29&tab=details

Thanks,
Lisa

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=Lisa Gerhardt</pre></div><legend>Similar Recent Tickets <small>modified within the last 30 days</small></legend><div id="similar_tickets"><p class="muted">No similar tickets found.</p></div>
</div>
<script type="text/javascript">
function reset_anchor() {
    $("#updates .selected").removeClass("selected");
    var urls = document.location.toString().split('#'); 
    var anchor = urls[1];
    if(anchor) {
        $("a[name='"+anchor+"']").parents(".update_description").addClass("selected");
    }
}
function submitspam(ticket_id) {
    myret = confirm("Would you like to close this ticket as a security ticket, and submit the ticket content to akismet?");
    if(myret == true) {
        $.ajax("viewer/processspam?id="+ticket_id).done(function() {
            window.location.reload();
        });
    }
}

$(function() {
    reset_anchor();
    var ADDITIONAL_COOKIE_NAME = 'gocticket';
    var options = { path: '/', expires: 365};

    if(window.opener && window.opener.name == "gocticket_list") {
        v = $.cookie("closewindow");
        if(!v) {
            $("#closewindow").attr("checked", "checked"); //on by default
        } else {
            if(v == "checked") {
                $("#closewindow").attr("checked", "checked");
            }
        }
        $("#closewindow").click(function() {
            $.cookie("closewindow", $(this).attr('checked'), options);
        });
    } else {
        $("#closewindow_area").hide();
    }
    function updateTimeago() {
        $("time").timeago();
        setTimeout(updateTimeago, 30*1000);
    }
    updateTimeago();
    $(".description").focus(expand_description);
});
</script>
<hr/>
<footer>
<p>GOC Ticket Version 2.2 | <a href="https://ticket.opensciencegrid.org/goc/submit?app_issue_check=on&amp;app_issue_type=goc&amp;app_goc_url=https%3A%2F%2Fticket.opensciencegrid.org%3A443%2F27440">Report Bugs</a>
 | <a href="https://github.com/opensciencegrid/operations/blob/master/docs/privacy.md">Privacy Policy</a>
</p>

<p> <img align="top" src="images/tag_orange.png"/> Copyright 2018 The Trustees of Indiana University - Developed for Open Science Grid</p>
</footer>


</div><!--container-fluid-->
<script src="https://ticket1.grid.iu.edu:8443/socket.io/socket.io.js"></script>
<script>
var chat = io.connect('https://ticket1.grid.iu.edu:8443');
chat.on('connect', function() {
    chat.emit('authenticate', {nodekey:'', ticketid: 27440});
});
chat.on('peers', function(peers) {
    $("#peers").html("");
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('peer_disconnect', function(pid) {
    $("#peer_"+pid).hide("slow");
});
chat.on('peer_connected', function(peers) {
    //expect only 1 peer connecting, but..
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('submit', function() {
    if(confirm("This ticket was updated. Do you want to refresh?")) {
        history.go(0);
    }
});

function addPeer(pid, peer) {
    var ipinfo = "";
    if(peer.ip != undefined) {
        ipinfo = "<span class=\"ip\">"+peer.ip+"</span>";
    }
    if(chat.io.engine.id == pid) {
        //don't display myself
        return;
    }
    var html = "<li class=\"new\" id=\"peer_"+pid+"\" class=\"peer\">"+peer.name+ipinfo+"</li>";
    $("#peers").prepend(html);
    $("#peers .new").animate({bottom: 0}, 1000, function() {$(this).removeClass("new")});
}

$(function() {
    $("#ticket_form").submit(function() {
        chat.emit('submit');
        return true;
    });
});
</script>
<script>
//used by searchbox
function parseValue(value) {
    var obj = new Object();
    var tokens = value.split("\t");
    obj.str = tokens[0];
    obj.count = tokens[1];
    return obj;
}

$(function() {
    //bootstrap-2.0.4 stuff
    $(".alert-message").alert();
    $(".dropdown-toggle").dropdown();
    $("span[rel='tooltip']").tooltip();
    $("a[rel=popover]").popover();

    //activate menu that user is currently on
    $("#menu_navigator").addClass("active"); 
    $("#submenu_").addClass("active"); 

    //translate zend validation error message to bootstrap
    $(".errors").addClass("alert").addClass("alert-error");

    //enable autocomplete for search box
    $("#search").autocomplete({
        source: function( request, response ) {
            $.ajax({
                url: "search/autocomplete",
                dataType: "text",
                data: {
                    //featureClass: "P",
                    //style: "full",
                    //maxRows: 12,
                    //name_startsWith: request.term
                    q: request.term
                },
                success: function( data ) {
                    response( $.map( data.split("\n"), function( item ) {
                        if(item == "") return null;
                        return {
                            value: item
                        }
                    }));
                }
            });
        },
        select: function(event, ui) {
            document.location = "search?q="+ui.item.value;
        }
    });
    
});
</script>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-69012-13");
pageTracker._trackPageview();
} catch(err) {}
</script>

</body>
