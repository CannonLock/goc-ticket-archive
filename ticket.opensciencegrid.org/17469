<!DOCTYPE html>
<html lang="en">
  <head>
  <base href="">
    <title>[17469] dq2-get fails with &#39;Error reading token data header&#58; Connection reset by peer&#39;</title>    <meta charset="utf-8" />
    <meta name="verify-v1" content="na5IcAJsZVOfEkboRxuIiZ1zpZgnZiWra+nKcS7nA/o=" />
    <meta name="google-site-verification" content="DLrk3ft4s8b-S2TloLCL2LD_t6wcTjgSluf5pmiu2kA" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />
    <link href="https://ticket.opensciencegrid.org/rss" rel="alternate" type="application/rss+xml" title="GOC Ticket Update feed" />

    <style type="text/css">
      body {
        padding-top: 50px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
     #search {
            width: 300px;
     }

    </style>

<script src="https://code.jquery.com/jquery-3.0.0.js"></script>
<script src="https://code.jquery.com/jquery-migrate-3.0.1.js"></script>

   <link href="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet"/>
    <script src="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/js/bootstrap.min.js"></script>

    <link href="https://netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"/>
    <link href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/themes/smoothness/jquery-ui.min.css" rel="stylesheet"/>
 <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>


    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/js/select2.min.js"></script>

    <link href="css/ticket.css" rel="stylesheet" />
    <script src="lib/jquery.cookie.js"></script>

    <link href="images/tag_orange.png" rel="icon" type="image/png"/>
    <script src='https://www.google.com/recaptcha/api.js'></script>
  </head>

  <body>
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>

            <a class="brand" style="padding: 6px 0px 0px 6px;" href="http://opensciencegrid.org"><img src="images/osglogo.40x30.png"/></a>
            <ul class="nav">
                <li class="dropdown"><a href="https://ticket.opensciencegrid.org/#" class="dropdown-toggle" data-toggle="dropdown">GOC Ticket <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    <li><a href="https://my.opensciencegrid.org">MyOSG</a></li>
                    <li><a href="https://oim.opensciencegrid.org">OIM</a></li>
                    <li class="active"><a href="https://ticket.opensciencegrid.org/index">Ticket</a></li>
	<li class="divider"></li>
	<li><a href="http://repo.grid.iu.edu">Repo</a></li>
	<li class="divider"></li>
	<li><a href="http://blogs.grid.iu.edu">Blog</a></li>
                    <li><a href="http://display.grid.iu.edu">Display</a></li>
                    <li><a href="http://osggoc.blogspot.com/">News</a></li>
                    </ul>
                </li>
            </ul>
            <ul class="nav pull-right">
                <li><a href="https://ticket.opensciencegrid.org/sso/">Login</a></li>            </ul>

            <div class="nav-collapse">
                <ul class="nav">
			 <li id="menu_submit"><a href="https://ticket.opensciencegrid.org/submit">Submit</a></li><li id="menu_view" class="dropdown"><a href="https://ticket.opensciencegrid.org/\#" class="dropdown-toggle" data-toggle="dropdown">View <b class="caret"></b></a><ul class="dropdown-menu"><li id="submenu_listopen"><a href="https://ticket.opensciencegrid.org/list/open">Open Tickets</a></li><li id="submenu_listrecentclose"><a href="https://ticket.opensciencegrid.org/list/recentclose">Recently Closed Tickets</a></li><li class="divider"></li><li id="submenu_alltickets"><a href="https://ticket.opensciencegrid.org/search?q=&amp;sort=id">All Tickets</a></li></ul></li>                </ul>

                <form class="navbar-search pull-right" action="https://ticket.opensciencegrid.org/viewer">
                    <input id="search" type="text" name="id" class="search-query span2" placeholder="Search Ticket" value=""/>
                </form>
            </div>
        </div>
      </div>
    </div>

<script type='text/javascript' src='lib/jquery.timeago.js'></script>
<script type='text/javascript' src='lib/byte2size.js'></script>
<style>
#updates .toolbar {
position: relative;
margin-top: 0px;
top: -10px;
font-weight: normal;
}
#updates a.anchor {
position: relative;
top: -50px;
}
#updates .selected pre {
animation:selected 2s;
animation-iteration-count: 2;
animation-direction: alternate;
-webkit-animation:selected 2s; 
-webkit-animation-iteration-count: 2;
-webkit-animation-direction: alternate;
box-shadow: inset 1px 1px 20px #9ad;
border: 1px solid #9ab;
margin: 5px 0px;
padding-left: 10px;
}
@keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ab;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
@-webkit-keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ad;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
#updates pre {
background-color: inherit;
line-height: 15px;
padding: 5px;
}
#updates .header {
color: #999;
}
#updates .update_history pre {
background-color: #eee;
color: #666;
font-size: 85%;
}
#updates .clickable {
cursor: pointer;
}
#updates .clickable:hover {
color: #D98719;
}
#updates .meta_information pre {
background-color: #fed;
}
#similar_tickets {
max-height: 300px;
overflow-y: auto;
pointer-events: none;
padding: 5px;
background-color: #f4f4f4;
}
.btn-toolbar {
margin-bottom: 0;
height: 30px;
}
#peers {
position: fixed;
bottom: 0px;
right: 0px;
z-index: 100;
list-style: none;
padding: 5px 0px 0px 5px;
margin: 0px;
background-color: white;
box-shadow: 0px 0px 10px white;
}
#peers li {
background-color: #ccc;
color: #000;
display: inline-block;
padding: 5px 10px;
margin-right: 5px;
position: relative;
}
/*
#peers li:hover {
background-color: #999;
cursor: pointer;
}
*/
#peers span.ip {
padding-left: 5px;
color: #666;
}
#peers .new {
bottom: -30px;
}
/*
#peers .me {
background-color: red;
}
*/
</style>

<div class="container-fluid">
<ul id="peers"></ul>
<div class="alert alert-danger"><a class="close" href="https://ticket.opensciencegrid.org/#" data-dismiss="alert">&times;</a>By the end of May 2018, the ticketing system at https://ticket.opensciencegrid.org will be retired and support will be provided at https://support.opensciencegrid.org. Throughout this transition the support email (help@opensciencegrid.org) will be available as a point of contact.<br><br>                                                   
                                                                                                                                                                                   
Please see the service migration page for details: https://opensciencegrid.github.io/technology/policy/service-migrations-spring-2018/#ticket</div><div id="presence" class="pull-right"></div><div class="ticketgui"><script type="text/javascript" src="lib/checktab.js"></script>

<script>
var expanded = false;
function expand_description() {
    var desc = $(".description");
    if(!expanded) {
        expanded = true;
        //expand to minheight
        var min = 250;
        if(desc.height() < min) {
            desc.animate({height: min}, 200);
        }
    }
}

$(document).ready(function() {
    $("input[name='nad']").datepicker({
        dateFormat: 'yy-mm-dd'
    });
});

</script>



<style>
.form-horizontal .control-label {
padding-top: inherit;
font-size:90%;
color:#666;
}
label {
margin-bottom: 0px;
}
.controls {
line-height: 18px;
}
</style>
<form class="form-horizontal" action="https://ticket.opensciencegrid.org/viewer/updatebasic?id=17469" method="post">
<div class="page-header">
    <h3><span class="muted">17469</span> / dq2-get fails with &#39;Error reading token data header&#58; Connection reset by peer&#39;</h3>
</div>

<div class="row-fluid">
<div class="span5">
    <legend>Contact</legend>
    <div class="control-group">
        <label class="control-label">Full Name</label>
        <div class="controls">Monica Dobre</div>
    </div>
    <div class="control-group">
        <label class="control-label">Email</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">Phone</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">CC</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>

    <legend>Details</legend>
    <div class="control-group"><label class="control-label">Associated VO</label><div class="controls">ATLAS</div></div><div class="control-group"><label class="control-label">Submitted Via</label><div class="controls">GGUS</div></div><div class="control-group"><label class="control-label">Submitter</label><div class="controls">Monica Dobre</div></div><div class="control-group"><label class="control-label">Support Center</label><div class="controls">USATLAS</div></div>
    <div class="control-group">
        <label class="control-label">Ticket Type</label>
        <div class="controls">Problem/Request</div>
    </div>
    <div class="control-group">
        <label class="control-label">Priority</label>
        <div class="controls">High</div>
    </div>
    <div class="control-group">
        <label class="control-label">Status</label>
        <div class="controls">
Closed</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action</label>
        <div class="controls">TX Incoming</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action Deadline</label>
        <div class="controls flag_red">2013-10-28</div>
    </div>

</div><!--span-->
<div class="span7">
    <legend>Assignees</legend>
    <div class="assignee" style="width: 60%">GGUS (Prod)&nbsp;<a target="_blank" href="https://ggus.eu/ws/ticket_info.php?ticket=97979">97979</a> <span class="muted"> / Ticket Exchange</span></div><div class="assignee" style="width: 60%">USATLAS (BNL Prod)&nbsp;<a target="_blank" href="https://rt.racf.bnl.gov/rt/Ticket/Display.html?id=23796">23796</a> <span class="muted"> / Ticket Exchange</span></div>    <br>

    <legend>Assignees</legend>
    TODO
    <br>

    <style>
legend.noborder {
border-bottom: none;
}
</style>

<div id="attachment-list"/>
<script>
$(function () {
    var first = true;
    $.getJSON("attachment/list/17469", function (files) {
        //console.dir(files);
        var html = "<table class=\"table table-condensed\">";
        $(files).each(function() {
            if(first) {
                first = false;
                html += "<legend class=\"noborder\">Attachmenets</legend>";
            }
            html += "<tr class=\"attachment\">";
            html += "<td><img src="\&quot;&quot;+this.thumbnail_url+&quot;\&quot;/"></td>";
            html += "<td><a href="\&quot;&quot;+this.url+&quot;\&quot;" target=\"_blank\">"+this.name+"</a></td>";
            html += "<td>"+bytesToSize(this.size, 1)+"</td>";
            html += "</tr>";
        });
        html += "</table>";
        $("#attachment-list").html(html);
    });
});

function download(url) {
    window.open(url, "_blank");
}
</script>


</div><!--span-->
</div><!--row-fluid-->


</form>

</div>
<div id="updates" style="clear: both;">
    <legend>Past Updates
    <div class="btn-toolbar pull-right toolbar">
        <div class="btn-group">
                <a class="btn btn-small" href="https://ticket.opensciencegrid.org/17469?sort=up&amp;"><i class="icon-arrow-up"></i> Sort</a>

        
        <a class="btn btn-small" href="https://ticket.opensciencegrid.org/17469?expandall=true&amp;">Expand Descriptions</a>        <a class="btn btn-small" target="_blank" href="mailto:osg@tick.globalnoc.iu.edu?subject=Open%20Science%20Grid%3A%20dq2-get%20fails%20with%20%26%2339%3BError%20reading%20token%20data%20header%26%2358%3B%20Connection%20reset%20by%20peer%26%2339%3B%20ISSUE%3D17469%20PROJ%3D71"><i class="icon-envelope"></i> Update w/Email</a>
        </div>
    </div><!--btn-toolbar-->
    </legend>

    <div class='update_description'><i onclick="document.location='17469#1384387210'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-11-14T00:00:10+00:00">Nov 14, 2013 12:00 AM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1384387210">&nbsp;</a></div><pre>This ticket was closed automatically. If this issue has not been resolved according your expectations or if you need further information, please submit a new ticket referencing this one.

-- by SYSTEM at Wed Nov 13 23&#58;59&#58;01 UTC 2013

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=97979' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=97979</a></pre></div><div class='update_description'><i onclick="document.location='17469#1383125104'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-10-30T09:25:04+00:00">Oct 30, 2013 09:25 AM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1383125104">&nbsp;</a></div><pre>Dear Patrick,

Thank you for the update. It seems there are some issues with the
Romanian GRID certificates being recognized by some sites, this one
included. Colleagues with Romanian GRID certificates told me of having
similar problems with this site and others in the past few months. We&#39;ve
decided to apply for CERN certificates, in order to make sure we don&#39;t
have any more troubles.

Thank you,
Monica

GOCTX Source&#58; BNL Ticket&#58; Queue=SWTier2 ID=23796
*********************************************************************************
This is an automated mail. When replying don&#39;t change the subject line!
Type your text above this box and S T R I P P R E V I O U S M A I L S
please!!
*********************************************************************************

-- by Monica Dobre at Wed Oct 30 09&#58;23&#58;53 UTC 2013

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=97979' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=97979</a></pre></div><div class='update_description'><i onclick="document.location='17469#1383124231'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-10-30T09:10:31+00:00">Oct 30, 2013 09:10 AM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1383124231">&nbsp;</a></div><pre>It was never clear that this problem exists at SWT2 and we have not received
updates from the shifters for more clarification. The second problem reported
under this ticket concerning LFC registrations was, at worst, a transient
problem that is no longer applicable. I am closing this ticket.

Patrick
-- by mcguigan@.... at Wed Oct 30 09&#58;10&#58;13 UTC 2013

GOCTX Source&#58; BNL Ticket&#58; Queue=SWTier2 ID=23796</pre></div><div class='update_description'><i onclick="document.location='17469#1382466097'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-10-22T18:21:37+00:00">Oct 22, 2013 06:21 PM UTC</time> by <b>Christopher Pipes</b><a class="anchor" name="1382466097">&nbsp;</a></div><pre>Hi Patrick,

Do you have any new information on this problem?

Thanks,
Chris</pre></div><div class='update_description'><i onclick="document.location='17469#1381748422'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-10-14T11:00:22+00:00">Oct 14, 2013 11:00 AM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1381748422">&nbsp;</a></div><pre>Hi Monica,

There is something strange happening with the SRM and your proxy.

At times, I see that our SRM is accepting the connection, at least to
the point
where the system is mapping you to a local account.  However, there is
no
information provided from this last test.  I will have to get in touch
with
the developers to see what can be done.

In the mean time, can you get someone else to retrieve your files?  Or
submit a
request to have the dataset transferred to BNL-OSG2_SCRATCHDISK so
that you can
access it?

I will likely have to create a test instance of our SRM service and I
may need
to get a copy of your proxy to test with.

Regards,

Patrick

-- by mcguigan@.... at Mon Oct 14 11&#58;00&#58;12 UTC 2013

GOCTX Source&#58; BNL Ticket&#58; Queue=SWTier2 ID=23796</pre></div><div class='update_description'><i onclick="document.location='17469#1381744550'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-10-14T09:55:50+00:00">Oct 14, 2013 09:55 AM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1381744550">&nbsp;</a></div><pre>Hi Patrick,

localSetupEmi&#58;
emi version 2.6.1-1_v4_patch1.sl5  - already set with the environment

date -u&#58;
Mon Oct 14 09&#58;51&#58;29 UTC 2013

srmping -2 -webservice_path=srm/v2/server <a href='srm&#58;//gk03.atlas-swt2.org&#58;8443&#58' target='_blank' rel='nofollow'>srm&#58;//gk03.atlas-swt2.org&#58;8443&#58</a>;
2013-10-14 11&#58;52&#58;38,415 [main] ERROR org.dcache.srm.client.SRMClientV2 - srmPing &#58; try # 0 failed with error ; nested exception is&#58;
java.net.SocketException&#58; Connection reset
2013-10-14 11&#58;52&#58;38,419 [main] ERROR org.dcache.srm.client.SRMClientV2 -  srmPing &#58; try again
2013-10-14 11&#58;52&#58;49,273 [main] ERROR org.dcache.srm.client.SRMClientV2 - srmPing &#58; try # 1 failed with error ; nested exception is&#58;
java.net.SocketException&#58; Connection reset
2013-10-14 11&#58;52&#58;49,273 [main] ERROR org.dcache.srm.client.SRMClientV2 -  srmPing &#58; try again
2013-10-14 11&#58;53&#58;10,184 [main] ERROR org.dcache.srm.client.SRMClientV2 - srmPing &#58; try # 2 failed with error ; nested exception is&#58;
java.net.SocketException&#58; Connection reset

and it keeps trying. I&#39;ve pasted here only the first 3 tries.

Thank you,
Monica

-- by Monica Dobre at Mon Oct 14 09&#58;54&#58;34 UTC 2013

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=97979' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=97979</a></pre></div><div class='update_description'><i onclick="document.location='17469#1381743317'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-10-14T09:35:17+00:00">Oct 14, 2013 09:35 AM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1381743317">&nbsp;</a></div><pre>Hi Monica,

The problem does not seem to be with our CA files or CRL&#39;s if you can
authenticate with gk01.  I am hoping you can do another test for me
from lxplus&#58;

After setting up your proxy and normal environment can you send me the
output of
the following commands&#58;

localSetupEmi
date -u
srmping -2 -webservice_path=srm/v2/server <a href='srm&#58;//gk03.atlas-' target='_blank' rel='nofollow'>srm&#58;//gk03.atlas-</a>
swt2.org&#58;8443

Regards,

Patrick

-- by mcguigan@.... at Mon Oct 14 09&#58;35&#58;05 UTC 2013

GOCTX Source&#58; BNL Ticket&#58; Queue=SWTier2 ID=23796</pre></div><div class='update_description'><i onclick="document.location='17469#1381736620'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-10-14T07:43:40+00:00">Oct 14, 2013 07:43 AM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1381736620">&nbsp;</a></div><pre>Hello,

1) Issuing &#39;uberftp gk01.atlas-swt2.org&#39; I get&#58;
220 gk01.atlas-swt2.org GridFTP Server 6.14 (gcc64, 1342551528-83) [unknown] ready.
230 User usatlas4 logged in.
UberFTP&#62;
I mentioned the uberftp command, because this is the prescription on <a href='https&#58;//twiki.cern.ch/twiki/bin/viewauth/AtlasComputing/DQ2ClientsTroubleshooting#dq2_get_fails_with_Error_reading' target='_blank' rel='nofollow'>https&#58;//twiki.cern.ch/twiki/bin/viewauth/AtlasComputing/DQ2ClientsTroubleshooting#dq2_get_fails_with_Error_reading</a>  for filing a bug report.

2) The environment is set on /afs/cern.ch/work/m/mdobre&#58;
ATLAS_LOCAL_ROOT_BASE=/cvmfs/atlas.cern.ch/repo/ATLASLocalRootBase
source ${ATLAS_LOCAL_ROOT_BASE}/user/atlasLocalSetup.sh
localSetupDQ2Client --skipConfirm
voms-proxy-init --voms atlas

Thank you,
Monica

-- by Monica Dobre at Mon Oct 14 07&#58;42&#58;51 UTC 2013

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=97979' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=97979</a></pre></div><div class='update_description'><i onclick="document.location='17469#1381735819'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-10-14T07:30:19+00:00">Oct 14, 2013 07:30 AM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1381735819">&nbsp;</a></div><pre>Thanks Monica,

Can you try a couple other things?

1) Can you try using your uberftp commands (something like ls) against
gk01.atlas-swt2.org.  This machine runs a gridftp service.

2) Can you provide the commands that you use to set up your working
environment
on lxplus?

Patrick

-- by mcguigan@.... at Mon Oct 14 07&#58;30&#58;07 UTC 2013

GOCTX Source&#58; BNL Ticket&#58; Queue=SWTier2 ID=23796</pre></div><div class='update_description'><i onclick="document.location='17469#1381733816'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-10-14T06:56:56+00:00">Oct 14, 2013 06:56 AM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1381733816">&nbsp;</a></div><pre>Added attachment opensslout.out
<a href='https&#58;//ggus.eu/pages/windownload.php?attid=ATT103484' target='_blank' rel='nofollow'>https&#58;//ggus.eu/pages/windownload.php?attid=ATT103484</a>

-- by Monica Dobre at Mon Oct 14 06&#58;56&#58;30 UTC 2013

Output from openssl x509 -in ~/.globus/usercert.pem -noout -text  attached.

-- by Monica Dobre at Mon Oct 14 06&#58;56&#58;30 UTC 2013

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=97979' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=97979</a></pre></div><div class='update_description'><i onclick="document.location='17469#1381733797'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-10-14T06:56:37+00:00">Oct 14, 2013 06:56 AM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1381733797">&nbsp;</a></div><pre>Hello,

I&#39;ve attached the output from voms-info-proxy -all and the output from openssl x509 -in ~/.globus/usercert.pem -noout -text. When issuing date; globusrun -a -r gk01.atlas-swt2.org, the date is printed, but it seems that the globusrun command is not available on lxplus&#58;
-bash&#58; globusrun&#58; command not found

Thank you,
Monica

-- by Monica Dobre at Mon Oct 14 06&#58;55&#58;45 UTC 2013

Added attachment voms-proxy-info-all.out
<a href='https&#58;//ggus.eu/pages/windownload.php?attid=ATT103483' target='_blank' rel='nofollow'>https&#58;//ggus.eu/pages/windownload.php?attid=ATT103483</a>

-- by Monica Dobre at Mon Oct 14 06&#58;55&#58;44 UTC 2013

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=97979' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=97979</a></pre></div><div class='update_description'><i onclick="document.location='17469#1381572494'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-10-12T10:08:14+00:00">Oct 12, 2013 10:08 AM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1381572494">&nbsp;</a></div><pre>Hi Monica,

I can&#39;t find the output from voms-proxy-info attached to the ticket.
Can you
provide this again?  Also, can you provide the output of&#58;
openssl x509 -in ~/.globus/usercert.pem -noout -text

We don&#39;t run an uberFTP service on the SRM host (or on our cluster).
As a test,
can you try&#58;

date; globusrun -a -r gk01.atlas-swt2.org

I would like to understand if the problem with the certificates or
with our SRM
service.

Regards,

Patrick

On 10/11/2013 01&#58;38 PM, OSG GOC TX via RT wrote&#58;
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;    *Ticket URL&#58;*</font>
<a href='https&#58;//rt.racf.bnl.gov/rt/Ticket/Display.html?id=23796' target='_blank' rel='nofollow'>https&#58;//rt.racf.bnl.gov/rt/Ticket/Display.html?id=23796</a>
<font color='#7F7E6F'>&#62;    *Requestors&#58;*  tx+rtbnlprod_fp71@....</font>
<font color='#7F7E6F'>&#62;           *Ccs&#58;*  (None)</font>
<font color='#7F7E6F'>&#62;         *Queue&#58;*  SWTier2</font>
<font color='#7F7E6F'>&#62;         *Owner&#58;*  Patrick McGuigan</font>
<font color='#7F7E6F'>&#62;        *Status&#58;*  /new/</font>
<font color='#7F7E6F'>&#62;      *Priority&#58;*  /High/</font>
<font color='#7F7E6F'>&#62;   *Transaction&#58;*  Correspondence added by osg-goc-rest</font>
<font color='#7F7E6F'>&#62;       *Subject&#58;*  dq2-get fails with &#39;Error reading token data</font>
header&#58; Connection reset by peer&#39;
<div id='show_1617199611' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_1617199611'><font color='#7F7E6F'>&#62;               *GGUS Ticket&#58;*  97979</font>
&#60;<a href='https&#58;//gus.fzk.de/ws/ticket_info.php?ticket=97979&#62' target='_blank' rel='nofollow'>https&#58;//gus.fzk.de/ws/ticket_info.php?ticket=97979&#62</a>;
<font color='#7F7E6F'>&#62;            *OSG GOC Ticket&#58;*  17469</font>
&#60;<a href='17469.html' target='_blank' rel='nofollow'>https&#58;//ticket.grid.iu.edu/goc/viewer?id=17469&#62</a>;
<font color='#7F7E6F'>&#62;          *GGUS Ticket Type&#58;*  USER</font>
<font color='#7F7E6F'>&#62;       *Resource Group Name&#58;*  SWT2_CPB</font>
<font color='#7F7E6F'>&#62;                   *VO Name&#58;*  ATLAS</font>
<font color='#7F7E6F'>&#62;         *GGUS Problem Type&#58;*  File Transfer</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;</font>
--------------------------------------------------------------------------------
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; Output from CGSI trace attached.</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;   -- by Monica Dobre at Fri Oct 11 18&#58;36&#58;24 UTC 2013</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; Added attachment cgsi_trace.out</font>
<font color='#7F7E6F'>&#62;   <a href='https&#58;//ggus.eu/pages/windownload.php?attid=ATT103476' target='_blank' rel='nofollow'>https&#58;//ggus.eu/pages/windownload.php?attid=ATT103476</a></font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;   -- by Monica Dobre at Fri Oct 11 18&#58;35&#58;39 UTC 2013</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; Output from &#39;voms-proxy-info -all&#39;  attached.</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;   -- by Monica Dobre at Fri Oct 11 18&#58;35&#58;39 UTC 2013</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=97979' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=97979</a></font>
<font color='#7F7E6F'>&#62;   -- by OSG-GOC at Fri Oct 11 18&#58;37&#58;08 UTC 2013</font>
<font color='#7F7E6F'>&#62;</font>

-- by mcguigan@.... at Sat Oct 12 10&#58;08&#58;03 UTC 2013

GOCTX Source&#58; BNL Ticket&#58; Queue=SWTier2 ID=23796
</div><script type='text/javascript'>
        $('#show_1617199611').click(function() {
            $('#detail_1617199611').slideDown("normal");
            $('#show_1617199611').hide();
            $('#hide_1617199611').show();
        });
        $('#hide_1617199611').click(function() {
            $('#detail_1617199611').slideUp();
            $('#hide_1617199611').hide();
            $('#show_1617199611').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='17469#1381516628'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-10-11T18:37:08+00:00">Oct 11, 2013 06:37 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1381516628">&nbsp;</a></div><pre>Output from CGSI trace attached.

-- by Monica Dobre at Fri Oct 11 18&#58;36&#58;24 UTC 2013

Added attachment cgsi_trace.out
<a href='https&#58;//ggus.eu/pages/windownload.php?attid=ATT103476' target='_blank' rel='nofollow'>https&#58;//ggus.eu/pages/windownload.php?attid=ATT103476</a>

-- by Monica Dobre at Fri Oct 11 18&#58;35&#58;39 UTC 2013

Output from &#39;voms-proxy-info -all&#39;  attached.

-- by Monica Dobre at Fri Oct 11 18&#58;35&#58;39 UTC 2013

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=97979' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=97979</a></pre></div><div class='update_description'><i onclick="document.location='17469#1381516492'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-10-11T18:34:52+00:00">Oct 11, 2013 06:34 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1381516492">&nbsp;</a></div><pre>Hello,

When trying to retrieve the user dataset user.mdobre.mctruth.herwig.WWnoleptonfilter.14TeV.0910.131009143433 using the dq2-get command, it fails with&#58;

user.mdobre.mctruth.herwig.WWnoleptonfilter.14TeV.0910.131009143433/user.mdobre.000515.161995._1952685307.log.tgz&#58; no SRM size information available. No transfer progress display.
user.mdobre.mctruth.herwig.WWnoleptonfilter.14TeV.0910.131009143433/user.mdobre.000515.161995._1952685307.log.tgz&#58; no SRM caching information available. Are you using a local protocol?
[SE][Ls][] httpg&#58;//gk03.atlas-swt2.org&#58;8443/srm/v2/server&#58; CGSI-gSOAP running on lxplus430.cern.ch reports Error reading token data header&#58; Connection closed
user.mdobre.mctruth.herwig.WWnoleptonfilter.14TeV.0910.131009143433/user.mdobre.000515.161995._1952685307.log.tgz&#58; external tool failed, no file was transferred

The problem was discussed with Atlas DAST and it seems to be an issue with this particular site recognizing my certificate. Could you please take a look? I&#39;ve attached 2 files, cgsi_trace.out and vomsproxyinfoall.out. The information about the pool account can&#39;t be retrieved (the command &#39;uberftpgk03.atlas-swt2.org &#39; fails with &#39;Failed to read()&#58; Connection refused&#39;). The problem occurs on several lxplus hosts and on different days.

Thank you,
Monica
Used commandline&#58; dq2-get -n 1 user.mdobre.mctruth.herwig.WWnoleptonfilter.14TeV.0910.131009143433 | egrep &#39;Using site|lcg-cp|Connection closed|no SRM|no file&#39;
Received error message&#58; Error reading token data header&#58; Connection reset by peer
Softwareversion&#58; SLC5,lxplus,emi version 2.6.1-1_v4_patch1.sl5,DQ2 Client version 2.4.1
Affected site&#58; SWT2_CPB
Affected VO&#58; atlas

[Ticket Origin]
<a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=97979' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=97979</a>

[Ticket History]
Subject&#58; dq2-get fails with &#39;Error reading token data header&#58; Connection reset by peer&#39;
Ticket Type&#58; USER
CC&#58;
-- by Monica Dobre at Fri Oct 11 18&#58;33&#58;48 UTC 2013</pre></div><legend>Similar Recent Tickets <small>modified within the last 30 days</small></legend><div id="similar_tickets"><p class="muted">No similar tickets found.</p></div>
</div>
<script type="text/javascript">
function reset_anchor() {
    $("#updates .selected").removeClass("selected");
    var urls = document.location.toString().split('#'); 
    var anchor = urls[1];
    if(anchor) {
        $("a[name='"+anchor+"']").parents(".update_description").addClass("selected");
    }
}
function submitspam(ticket_id) {
    myret = confirm("Would you like to close this ticket as a security ticket, and submit the ticket content to akismet?");
    if(myret == true) {
        $.ajax("viewer/processspam?id="+ticket_id).done(function() {
            window.location.reload();
        });
    }
}

$(function() {
    reset_anchor();
    var ADDITIONAL_COOKIE_NAME = 'gocticket';
    var options = { path: '/', expires: 365};

    if(window.opener && window.opener.name == "gocticket_list") {
        v = $.cookie("closewindow");
        if(!v) {
            $("#closewindow").attr("checked", "checked"); //on by default
        } else {
            if(v == "checked") {
                $("#closewindow").attr("checked", "checked");
            }
        }
        $("#closewindow").click(function() {
            $.cookie("closewindow", $(this).attr('checked'), options);
        });
    } else {
        $("#closewindow_area").hide();
    }
    function updateTimeago() {
        $("time").timeago();
        setTimeout(updateTimeago, 30*1000);
    }
    updateTimeago();
    $(".description").focus(expand_description);
});
</script>
<hr/>
<footer>
<p>GOC Ticket Version 2.2 | <a href="https://ticket.opensciencegrid.org/goc/submit?app_issue_check=on&amp;app_issue_type=goc&amp;app_goc_url=https%3A%2F%2Fticket.opensciencegrid.org%3A443%2F17469">Report Bugs</a>
 | <a href="https://github.com/opensciencegrid/operations/blob/master/docs/privacy.md">Privacy Policy</a>
</p>

<p> <img align="top" src="images/tag_orange.png"/> Copyright 2018 The Trustees of Indiana University - Developed for Open Science Grid</p>
</footer>


</div><!--container-fluid-->
<script src="https://ticket1.grid.iu.edu:8443/socket.io/socket.io.js"></script>
<script>
var chat = io.connect('https://ticket1.grid.iu.edu:8443');
chat.on('connect', function() {
    chat.emit('authenticate', {nodekey:'', ticketid: 17469});
});
chat.on('peers', function(peers) {
    $("#peers").html("");
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('peer_disconnect', function(pid) {
    $("#peer_"+pid).hide("slow");
});
chat.on('peer_connected', function(peers) {
    //expect only 1 peer connecting, but..
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('submit', function() {
    if(confirm("This ticket was updated. Do you want to refresh?")) {
        history.go(0);
    }
});

function addPeer(pid, peer) {
    var ipinfo = "";
    if(peer.ip != undefined) {
        ipinfo = "<span class=\"ip\">"+peer.ip+"</span>";
    }
    if(chat.io.engine.id == pid) {
        //don't display myself
        return;
    }
    var html = "<li class=\"new\" id=\"peer_"+pid+"\" class=\"peer\">"+peer.name+ipinfo+"</li>";
    $("#peers").prepend(html);
    $("#peers .new").animate({bottom: 0}, 1000, function() {$(this).removeClass("new")});
}

$(function() {
    $("#ticket_form").submit(function() {
        chat.emit('submit');
        return true;
    });
});
</script>
<script>
//used by searchbox
function parseValue(value) {
    var obj = new Object();
    var tokens = value.split("\t");
    obj.str = tokens[0];
    obj.count = tokens[1];
    return obj;
}

$(function() {
    //bootstrap-2.0.4 stuff
    $(".alert-message").alert();
    $(".dropdown-toggle").dropdown();
    $("span[rel='tooltip']").tooltip();
    $("a[rel=popover]").popover();

    //activate menu that user is currently on
    $("#menu_navigator").addClass("active"); 
    $("#submenu_").addClass("active"); 

    //translate zend validation error message to bootstrap
    $(".errors").addClass("alert").addClass("alert-error");

    //enable autocomplete for search box
    $("#search").autocomplete({
        source: function( request, response ) {
            $.ajax({
                url: "search/autocomplete",
                dataType: "text",
                data: {
                    //featureClass: "P",
                    //style: "full",
                    //maxRows: 12,
                    //name_startsWith: request.term
                    q: request.term
                },
                success: function( data ) {
                    response( $.map( data.split("\n"), function( item ) {
                        if(item == "") return null;
                        return {
                            value: item
                        }
                    }));
                }
            });
        },
        select: function(event, ui) {
            document.location = "search?q="+ui.item.value;
        }
    });
    
});
</script>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-69012-13");
pageTracker._trackPageview();
} catch(err) {}
</script>

</body>
