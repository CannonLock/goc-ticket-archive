<!DOCTYPE html>
<html lang="en">
  <head>
  <base href="">
    <title>[17090] OSG-XSEDE reporting ridiculous CPU from some jobs</title>    <meta charset="utf-8" />
    <meta name="verify-v1" content="na5IcAJsZVOfEkboRxuIiZ1zpZgnZiWra+nKcS7nA/o=" />
    <meta name="google-site-verification" content="DLrk3ft4s8b-S2TloLCL2LD_t6wcTjgSluf5pmiu2kA" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />
    <link href="https://ticket.opensciencegrid.org/rss" rel="alternate" type="application/rss+xml" title="GOC Ticket Update feed" />

    <style type="text/css">
      body {
        padding-top: 50px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
     #search {
            width: 300px;
     }

    </style>

<script src="https://code.jquery.com/jquery-3.0.0.js"></script>
<script src="https://code.jquery.com/jquery-migrate-3.0.1.js"></script>

   <link href="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet"/>
    <script src="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/js/bootstrap.min.js"></script>

    <link href="https://netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"/>
    <link href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/themes/smoothness/jquery-ui.min.css" rel="stylesheet"/>
 <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>


    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/js/select2.min.js"></script>

    <link href="css/ticket.css" rel="stylesheet" />
    <script src="lib/jquery.cookie.js"></script>

    <link href="images/tag_orange.png" rel="icon" type="image/png"/>
  </head>

  <body>
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>

            <a class="brand" style="padding: 6px 0px 0px 6px;" href="http://opensciencegrid.org"><img src="images/osglogo.40x30.png"/></a>
            <ul class="nav">
                <li class="dropdown"><a href="https://ticket.opensciencegrid.org/#" class="dropdown-toggle" data-toggle="dropdown">GOC Ticket <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    <li><a href="https://my.opensciencegrid.org">MyOSG</a></li>
                    <li><a href="https://oim.opensciencegrid.org">OIM</a></li>
                    <li class="active"><a href="https://ticket.opensciencegrid.org/index">Ticket</a></li>
	<li class="divider"></li>
	<li><a href="http://repo.grid.iu.edu">Repo</a></li>
	<li class="divider"></li>
	<li><a href="http://blogs.grid.iu.edu">Blog</a></li>
                    <li><a href="http://display.grid.iu.edu">Display</a></li>
                    <li><a href="http://osggoc.blogspot.com/">News</a></li>
                    </ul>
                </li>
            </ul>
            <ul class="nav pull-right">
                <li><a href="https://ticket.opensciencegrid.org/sso/">Login</a></li>            </ul>

            <div class="nav-collapse">
                <ul class="nav">
			 <li id="menu_submit"><a href="https://ticket.opensciencegrid.org/submit">Submit</a></li><li id="menu_view" class="dropdown"><a href="https://ticket.opensciencegrid.org/\#" class="dropdown-toggle" data-toggle="dropdown">View <b class="caret"></b></a><ul class="dropdown-menu"><li id="submenu_listopen"><a href="https://ticket.opensciencegrid.org/list/open">Open Tickets</a></li><li id="submenu_listrecentclose"><a href="https://ticket.opensciencegrid.org/list/recentclose">Recently Closed Tickets</a></li><li class="divider"></li><li id="submenu_alltickets"><a href="https://ticket.opensciencegrid.org/search?q=&amp;sort=id">All Tickets</a></li></ul></li>                </ul>

                <form class="navbar-search pull-right" action="https://ticket.opensciencegrid.org/viewer">
                    <input id="search" type="text" name="id" class="search-query span2" placeholder="Search Ticket" value=""/>
                </form>
            </div>
        </div>
      </div>
    </div>

<script type='text/javascript' src='lib/jquery.timeago.js'></script>
<script type='text/javascript' src='lib/byte2size.js'></script>
<style>
#updates .toolbar {
position: relative;
margin-top: 0px;
top: -10px;
font-weight: normal;
}
#updates a.anchor {
position: relative;
top: -50px;
}
#updates .selected pre {
animation:selected 2s;
animation-iteration-count: 2;
animation-direction: alternate;
-webkit-animation:selected 2s; 
-webkit-animation-iteration-count: 2;
-webkit-animation-direction: alternate;
box-shadow: inset 1px 1px 20px #9ad;
border: 1px solid #9ab;
margin: 5px 0px;
padding-left: 10px;
}
@keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ab;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
@-webkit-keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ad;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
#updates pre {
background-color: inherit;
line-height: 15px;
padding: 5px;
}
#updates .header {
color: #999;
}
#updates .update_history pre {
background-color: #eee;
color: #666;
font-size: 85%;
}
#updates .clickable {
cursor: pointer;
}
#updates .clickable:hover {
color: #D98719;
}
#updates .meta_information pre {
background-color: #fed;
}
#similar_tickets {
max-height: 300px;
overflow-y: auto;
pointer-events: none;
padding: 5px;
background-color: #f4f4f4;
}
.btn-toolbar {
margin-bottom: 0;
height: 30px;
}
#peers {
position: fixed;
bottom: 0px;
right: 0px;
z-index: 100;
list-style: none;
padding: 5px 0px 0px 5px;
margin: 0px;
background-color: white;
box-shadow: 0px 0px 10px white;
}
#peers li {
background-color: #ccc;
color: #000;
display: inline-block;
padding: 5px 10px;
margin-right: 5px;
position: relative;
}
/*
#peers li:hover {
background-color: #999;
cursor: pointer;
}
*/
#peers span.ip {
padding-left: 5px;
color: #666;
}
#peers .new {
bottom: -30px;
}
/*
#peers .me {
background-color: red;
}
*/
</style>

<div class="container-fluid">
<ul id="peers"></ul>
<div class="alert alert-danger"><a class="close" href="https://ticket.opensciencegrid.org/#" data-dismiss="alert">&times;</a>By the end of May 2018, the ticketing system at https://ticket.opensciencegrid.org will be retired and support will be provided at https://support.opensciencegrid.org. Throughout this transition the support email (help@opensciencegrid.org) will be available as a point of contact.<br><br>                                                   
                                                                                                                                                                                   
Please see the service migration page for details: https://opensciencegrid.github.io/technology/policy/service-migrations-spring-2018/#ticket</div><div id="presence" class="pull-right"></div><div class="ticketgui"><script type="text/javascript" src="lib/checktab.js"></script>

<script>
var expanded = false;
function expand_description() {
    var desc = $(".description");
    if(!expanded) {
        expanded = true;
        //expand to minheight
        var min = 250;
        if(desc.height() < min) {
            desc.animate({height: min}, 200);
        }
    }
}

$(document).ready(function() {
    $("input[name='nad']").datepicker({
        dateFormat: 'yy-mm-dd'
    });
});

</script>



<style>
.form-horizontal .control-label {
padding-top: inherit;
font-size:90%;
color:#666;
}
label {
margin-bottom: 0px;
}
.controls {
line-height: 18px;
}
</style>
<form class="form-horizontal" action="https://ticket.opensciencegrid.org/viewer/updatebasic?id=17090" method="post">
<div class="page-header">
    <h3><span class="muted">17090</span> / OSG-XSEDE reporting ridiculous CPU from some jobs</h3>
</div>

<div class="row-fluid">
<div class="span5">
    <legend>Contact</legend>
    <div class="control-group">
        <label class="control-label">Full Name</label>
        <div class="controls">John Weigand</div>
    </div>
    <div class="control-group">
        <label class="control-label">Email</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">Phone</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">CC</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>

    <legend>Details</legend>
    <div class="control-group"><label class="control-label">Resource Name</label><div class="controls">OSG_XSEDE</div></div><div class="control-group"><label class="control-label">Associated VO</label><div class="controls">Engage</div></div><div class="control-group"><label class="control-label">Submitted Via</label><div class="controls">GOC Ticket/submit</div></div><div class="control-group"><label class="control-label">Submitter</label><div class="controls">John Weigand</div></div><div class="control-group"><label class="control-label">Support Center</label><div class="controls">OSG-GOC</div></div>
    <div class="control-group">
        <label class="control-label">Ticket Type</label>
        <div class="controls">Problem/Request</div>
    </div>
    <div class="control-group">
        <label class="control-label">Priority</label>
        <div class="controls">Normal</div>
    </div>
    <div class="control-group">
        <label class="control-label">Status</label>
        <div class="controls">
Closed</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action</label>
        <div class="controls">ENG Action</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action Deadline</label>
        <div class="controls flag_red">2013-09-24</div>
    </div>

</div><!--span-->
<div class="span7">
    <legend>Assignees</legend>
    <div class="assignee" style="width: 60%">OSG-GOC <span class="muted"> / OSG Support Centers</span></div><div class="assignee" style="width: 60%">Software Support (Triage) <span class="muted"> / OSG Software Team</span></div><div class="assignee" style="width: 60%">Tim Cartwright <span class="muted"> / OSG Software Team</span></div><div class="assignee" style="width: 60%">Suchandra Thapa <span class="muted"> / OSG Software Team</span></div>    <br>

    <legend>Assignees</legend>
    TODO
    <br>

    <style>
legend.noborder {
border-bottom: none;
}
</style>

<div id="attachment-list"/>
<script>
$(function () {
    var first = true;
    $.getJSON("attachment/list/17090", function (files) {
        //console.dir(files);
        var html = "<table class=\"table table-condensed\">";
        $(files).each(function() {
            if(first) {
                first = false;
                html += "<legend class=\"noborder\">Attachmenets</legend>";
            }
            html += "<tr class=\"attachment\">";
            html += "<td><img src=\""+this.thumbnail_url+"\"/></td>";
            html += "<td><a href=\""+this.url+"\" target=\"_blank\">"+this.name+"</a></td>";
            html += "<td>"+bytesToSize(this.size, 1)+"</td>";
            html += "</tr>";
        });
        html += "</table>";
        $("#attachment-list").html(html);
    });
});

function download(url) {
    window.open(url, "_blank");
}
</script>


</div><!--span-->
</div><!--row-fluid-->


</form>

</div>
<div id="updates" style="clear: both;">
    <legend>Past Updates
    <div class="btn-toolbar pull-right toolbar">
        <div class="btn-group">
                <a class="btn btn-small" href="https://ticket.opensciencegrid.org/17090?sort=up&amp;"><i class="icon-arrow-up"></i> Sort</a>

        
        <a class="btn btn-small" href="https://ticket.opensciencegrid.org/17090?expandall=true&amp;">Expand Descriptions</a>        <a class="btn btn-small" target="_blank" href="mailto:osg@tick.globalnoc.iu.edu?subject=Open%20Science%20Grid%3A%20OSG-XSEDE%20reporting%20ridiculous%20CPU%20from%20some%20jobs%20ISSUE%3D17090%20PROJ%3D71"><i class="icon-envelope"></i> Update w/Email</a>
        </div>
    </div><!--btn-toolbar-->
    </legend>

    <div class='update_description'><i onclick="document.location='17090#1379519971'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-09-18T15:59:31+00:00">Sep 18, 2013 03:59 PM UTC</time> by <b>Tim Cartwright</b><a class="anchor" name="1379519971">&nbsp;</a></div><pre>The ticket for tweaking the logging format of the Gratia HTCondor probe is here&#58;

<a href='https&#58;//jira.opensciencegrid.org/browse/SOFTWARE-1207' target='_blank' rel='nofollow'>https&#58;//jira.opensciencegrid.org/browse/SOFTWARE-1207</a>

Closing the ticket now.  Thanks, everyone!</pre></div><div class='update_description'><i onclick="document.location='17090#1379519232'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-09-18T15:47:12+00:00">Sep 18, 2013 03:47 PM UTC</time><a class="anchor" name="1379519232">&nbsp;</a></div><pre>From the perspective of the original intent of this ticket,
upgrading to gratia-probe-condor-1.13.15-1, this ticket has
been satisfied.

It can be closed.

All other issues will be addressed by the respective software
development groups.

Mats... thanks for your feedback.  It will be included in the next
release of the probe, hopefully.

John Weigand

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=John Weigand 144</pre></div><div class='update_description'><i onclick="document.location='17090#1379518042'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-09-18T15:27:22+00:00">Sep 18, 2013 03:27 PM UTC</time><a class="anchor" name="1379518042">&nbsp;</a></div><pre>It would be nice to change Gratia&#39;s logging to log the original value and what it was changed to. It also has to include cluster/proc id Something like&#58;

Record for CCCCCCCC.PP has invalid RemoteSysCpu time BADVALUE. The value was replaced with 0.

I can not be 100% sure if this was with HTCondor 8.0.2 or not. We are running 8.0.2 on the submit node, but the glideins were only recently configured to use 8.0.2. There might be some glideins requested before the switchover which start up with an older HTCondor version.

by /DC=org/DC=doegrids/OU=People/CN=Mats Rynge 274484</pre></div><div class='update_description'><i onclick="document.location='17090#1379516262'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-09-18T14:57:42+00:00">Sep 18, 2013 02:57 PM UTC</time> by <b>Tim Cartwright</b><a class="anchor" name="1379516262">&nbsp;</a></div><pre>We need to be *very* careful about deciding what constitutes good evidence
for or against the claim that HTCondor 8.0.2 did not fix the problem.  The
one detailed condor_history record that I have seen (via Tanya) appears to
be from a glidein job.  Hence, the version of HTCondor that actually wrote
the original raw data was the version of HTCondor used in the glidein pilot
job.  The condor_history record does NOT include that version of HTCondor,
I believe.  TJ Knoeller on the HTCondor developer team is going to look at
that record and figure out what can and cannot be learned from it.  Until
then, I am not sure that we can claim to know much about the behavior of
HTCondor 8.0.2 yet.

As for seeing the spike in data, I was referring to Gratia summary data,
probably at the daily level.  Adding even one job with an O(10B) runtime is
likely to be noticeable in daily summaries.

Suchandra&#58; Would it be easy to add the HTCondor job ID (cluster and
process) to the logging output of the Gratia HTCondor probe?</pre></div><div class='update_description'><i onclick="document.location='17090#1379515273'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-09-18T14:41:13+00:00">Sep 18, 2013 02:41 PM UTC</time><a class="anchor" name="1379515273">&nbsp;</a></div><pre>Tim,

1. The 2 JIRA tickets, GRATIA-114 and SOFTWARE-1132, tell you nothing about
what the criteria is for suppressing CPU.  I had to find it in the code.  Hence,
the need to document.

2. HTCondor 8.02 did stop us from seeing the CpuSystemDuration of 2147483648 but
now we are seeing a value always around 18446744476 (9x bigger) coming up.
And in the Condor ticket 3814 it mentions that they have no real means of testing
this.

3. Regarding &#34;The crazy data is likely to be orders of magnitude larger than entire days
worth of jobs, so looking for a spike in runtime data, then a drop back to normal should be adequate.&#34;
- Where are you assuming this spike/drop is going to be seen?

4. Regarding logging... the 1st thing Mats asked was ...
&#34;I have one such record in the logs&#58;
05&#58;22&#58;15 UTC Gratia&#58; Record has invalid RemoteSysCpu time&#58;  &#39;RemoteSysCpu&#39;&#58; 18446744318.0
How can we check what was sent to Gratia? Maybe search for job id?
&#39;ClusterId&#39;&#58; 39890822
&#39;ProcId&#39;&#58; 0&#34;
- If I was an admin, I would want to know just what he is asking.  And how often this is occurring.
The current logging is insufficient.

John Weigand

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=John Weigand 144</pre></div><div class='update_description'><i onclick="document.location='17090#1379514359'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-09-18T14:25:59+00:00">Sep 18, 2013 02:25 PM UTC</time> by <b>Tim Cartwright</b><a class="anchor" name="1379514359">&nbsp;</a></div><pre>To recap this ticket so far&#58;

* Yes, HTCondor has a problem with occasionally writing history records
with crazy remote run-time values.  They know about it and are getting the
new evidence from systems running HTCondor 8.0.2.  This is a work in
progress and can be tracked at

&#60;<a href='https&#58;//htcondor-wiki.cs.wisc.edu/index.cgi/tktview?tn=3814&#62' target='_blank' rel='nofollow'>https&#58;//htcondor-wiki.cs.wisc.edu/index.cgi/tktview?tn=3814&#62</a>;

* In OSG 3.1.22, we released a new Gratia HTCondor probe that suppresses
RemoteSysCpu and RemoteUserCpu values that seem excessive.  Details are
below and in &#60;<a href='https&#58;//jira.opensciencegrid.org/browse/SOFTWARE-1132&#62' target='_blank' rel='nofollow'>https&#58;//jira.opensciencegrid.org/browse/SOFTWARE-1132&#62</a>; and
&#60;<a href='https&#58;//jira.opensciencegrid.org/browse/GRATIA-114&#62' target='_blank' rel='nofollow'>https&#58;//jira.opensciencegrid.org/browse/GRATIA-114&#62</a>;.

So, what is next?

* It sounds like we are waiting for Mats to confirm that the new Gratia
HTCondor probe is helping his situation.  I think we do not need to worry
about finding individual records.  The crazy data is likely to be orders of
magnitude larger than entire days worth of jobs, so looking for a spike in
runtime data, then a drop back to normal should be adequate.  Mats?

* John&#58; Are you requesting further logging when the Gratia HTCondor probe
encounters the crazy data?  Why?  What problem(s) are you trying to solve
with extra logging?

Are there other remaining actions that people would like to see on *this*
ticket?  As stated above, the HTCondor developers are aware of the problem,
aware of the fact that the changes in 8.0.2 did not fix the problem, and
are working on the issue.  As long as the Gratia probe is suppressing the
data correctly, what else can we do right now?</pre></div><div class='update_description'><i onclick="document.location='17090#1379512704'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-09-18T13:58:24+00:00">Sep 18, 2013 01:58 PM UTC</time><a class="anchor" name="1379512704">&nbsp;</a></div><pre>Mats,
Really would like your input.
Let me ask this about the Gratia logging...
Would it be sufficient to show&#58;
* CPU System Duration (actual/sent)
* CPU User Duration (actual/sent)
* CPU Wall Duration (actual/sent)

And for Condor (I am kind of ignorant in this area), would
the ClusterId be sufficient (or GlobalJobId).?
Looking for something that allows for easy access into the condor
history.

The log message should also have the &#34;Record has invalid data&#34; or
something consistent to that affect so it is easily identifiable for script access.

John Weigand

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=John Weigand 144</pre></div><div class='update_description'><i onclick="document.location='17090#1379443041'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-09-17T18:37:21+00:00">Sep 17, 2013 06:37 PM UTC</time><a class="anchor" name="1379443041">&nbsp;</a></div><pre>Mats,

That appears the new number we are seeing from condor 8.0.2.
Instead of the 2147483648 we  use to see before the &#34;fix&#34;, we
now get 9x that.

As for what you see in gratia, it will be zero for the System CPU
for that specific job.  But will not be that obvious because all queries
in Gratia go against summary tables.
To see the detail (aka JobUsageRecord) is an
really really long (like a over an hour and highly discouraged) query.

If you can give me the End Time on that job, I might be able to find
it for you if really necessary.

But let me ask this,  would you need
to see additional data in the log that would provide you with that
information,  like User CPU, Wall, Condor jobid... &#34;.  Suchandra is on the
cc and we could ask him to provide that additional data.

John Weigand

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=John Weigand 144</pre></div><div class='update_description'><i onclick="document.location='17090#1379437162'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-09-17T16:59:22+00:00">Sep 17, 2013 04:59 PM UTC</time><a class="anchor" name="1379437162">&nbsp;</a></div><pre>I have one such record in the logs&#58;

05&#58;22&#58;15 UTC Gratia&#58; Record has invalid RemoteSysCpu time&#58;
&#39;RemoteSysCpu&#39;&#58; 18446744318.0

How can we check what was sent to Gratia? Maybe search for job id?
&#39;ClusterId&#39;&#58; 39890822
&#39;ProcId&#39;&#58; 0

by /DC=org/DC=doegrids/OU=People/CN=Mats Rynge 274484</pre></div><div class='update_description'><i onclick="document.location='17090#1379436348'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-09-17T16:45:48+00:00">Sep 17, 2013 04:45 PM UTC</time><a class="anchor" name="1379436348">&nbsp;</a></div><pre>Mats,

From what I am understanding, you upgraded your gratia condor probe to v1.13.15 yesterday.
I am looking at the code and it appears to be writing a message to the Gratia probe log
when either RemoteUserCpu or RemoteSysCpu in the condor logs for a job exceeds 2000000000
and something called slot_ratio is &#62; 1000.
if classad[field] &#60; 2000000000&#58;
return False
slot_ratio = classad[field] / (float(classad[&#39;CumulativeSlotTime&#39;]) + 1)
if slot_ratio &#62; 1000&#58;
return True
&#34;slot_ratio&#39; means nothing to me.

When this condition is hit, it will zero that usage going up to Gratia as best I can tell.

But, what I was wondering if maybe tomorrow, you could grep your logs (/var/log/gratia) for today 2013-09-17 and 18
for &#39;&#34;Record has invalid&#39;.  I don&#39;t hit that condition on my test nodes.

When this condition is hit, it will zero out that usage going up to Gratia.

I just want to verify it is working working.

Thanks
John Weigand

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=John Weigand 144</pre></div><div class='update_description'><i onclick="document.location='17090#1379434150'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-09-17T16:09:10+00:00">Sep 17, 2013 04:09 PM UTC</time> by <b>Tanya Levshina</b><a class="anchor" name="1379434150">&nbsp;</a></div><pre>I&#39;ve provided Tim Cartwright with all relevant information. He will update condor ticket. The goc ticket <a href='https&#58;//ticket.grid.iu.edu/goc/16096' target='_blank' rel='nofollow'>https&#58;//ticket.grid.iu.edu/goc/16096</a> should probably stay closed. The patch in gratia probe should be able to handle this problem.
Tanya
On Sep 17, 2013, at 10&#58;39 AM, Open Science Grid FootPrints wrote&#58;

[Duplicate message snipped]</pre></div><div class='update_description'><i onclick="document.location='17090#1379432393'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-09-17T15:39:53+00:00">Sep 17, 2013 03:39 PM UTC</time><a class="anchor" name="1379432393">&nbsp;</a></div><pre>Tanya,

What does gratia-condor probe 1.13.15 do?
I can&#39;t find a JIRA ticket on it.
I found this... <a href='https&#58;//jira.opensciencegrid.org/browse/SOFTWARE-1132' target='_blank' rel='nofollow'>https&#58;//jira.opensciencegrid.org/browse/SOFTWARE-1132</a>
but it is closed and fixed too.  Is this the changes?

John Weigand

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=John Weigand 144</pre></div><div class='update_description'><i onclick="document.location='17090#1379431115'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-09-17T15:18:35+00:00">Sep 17, 2013 03:18 PM UTC</time><a class="anchor" name="1379431115">&nbsp;</a></div><pre>Tanya,

That ticket 16096 is closed and once closed, I don&#39;t think emails go out on it.
I did not see any email anyway.
Should we get goc to re-open it.
news to me about the new gratia probe.

John Weigand

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=John Weigand 144</pre></div><div class='update_description'><i onclick="document.location='17090#1379426209'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-09-17T13:56:49+00:00">Sep 17, 2013 01:56 PM UTC</time> by <b>Tanya Levshina</b><a class="anchor" name="1379426209">&nbsp;</a></div><pre>John,
I think I have answered to all of your questions yesterday.
The new version of condor 8.0.2 has been installed on osg-xsede about two weeks ago.
I&#39;ve updated the ticket <a href='https&#58;//ticket.grid.iu.edu/goc/16096' target='_blank' rel='nofollow'>https&#58;//ticket.grid.iu.edu/goc/16096</a> and added condor history file for one of jobs.
Mats has installed newest gratia-condor probe 1.13.15 yesterday that has Suchandra&#39;s fix for condor cpuSystemDuration recommended by condor&#39;s team.
I&#39;ve also asked Tim Cartwright to update condor ticket
<a href='https&#58;//htcondor-wiki.cs.wisc.edu/index.cgi/tktview?tn=3814' target='_blank' rel='nofollow'>https&#58;//htcondor-wiki.cs.wisc.edu/index.cgi/tktview?tn=3814</a>

Let&#39;s see if it fix the problem.</pre></div><div class='update_description'><i onclick="document.location='17090#1379424012'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-09-17T13:20:12+00:00">Sep 17, 2013 01:20 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1379424012">&nbsp;</a></div><pre>For some time now, Gratia has been getting a ridiculously high CPU usage on some jobs. Times are in seconds below&#58;

+------------+-------------------+-----------------+--------------+------------+--------------+------------+
| dbid       | CpuSystemDuration | CpuUserDuration | WallDuration | Processors | Wall_w_Cores | Efficiency |
+------------+-------------------+-----------------+--------------+------------+--------------+------------+
| 1140271758 |       18446744476 |           30975 |        34140 |       NULL |        34140 |   54032734 |
| 1140297735 |       18446744305 |            1487 |         3451 |       NULL |         3451 |  534533347 |
| 1140325757 |       18446744489 |             447 |         5156 |       NULL |         5156 |  357772400 |
| 1140326891 |       18446744146 |              94 |          568 |       NULL |          568 | 3247666239 |
| 1140354089 |       18446744461 |            1752 |         5293 |       NULL |         5293 |  348512114 |
| 1140471648 |       18446744426 |            1388 |         7307 |       NULL |         7307 |  252453070 |
| 1140519133 |       18446744502 |           10671 |        14249 |       NULL |        14249 |  129459998 |
| 1140655640 |       18446744177 |             938 |         2030 |       NULL |         2030 |  908706656 |
| 1140671577 |       18446744517 |           12848 |        18350 |       NULL |        18350 |  100527288 |
| 1140678693 |       18446744637 |           30509 |        35259 |       NULL |        35259 |   52317919 |
| 1140801318 |       18446744441 |           12271 |        14820 |       NULL |        14820 |  124472043 |
| 1140801788 |       18446744620 |           25815 |        33046 |       NULL |        33046 |   55821493 |
| 1140852176 |       18446744593 |           34549 |        39039 |       NULL |        39039 |   47252182 |
| 1140925901 |       18446744372 |            4229 |         6682 |       NULL |         6682 |  276066277 |
| 1141008111 |       18446744293 |             831 |         4037 |       NULL |         4037 |  456941915 |
+------------+-------------------+-----------------+--------------+------------+--------------+------------+

This is between 9/15 and 9/17.

This may be related to this Condor ticket&#58;
<a href='https&#58;//htcondor-wiki.cs.wisc.edu/index.cgi/tktview?tn=3814' target='_blank' rel='nofollow'>https&#58;//htcondor-wiki.cs.wisc.edu/index.cgi/tktview?tn=3814</a>

What version of Condor are you using?

Can  you perform a query into your condor history looking for a high level of cpu usage?
Maybe just over the last day (as they are appearing daily).  It may provide some insight
into the problem.

Do you run multi-core jobs?
From what I see in Gratia, everything is coming up here as single core?
<div id='show_233041184' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_233041184'>
Thanks
John Weigand

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=John Weigand 144

</div><script type='text/javascript'>
        $('#show_233041184').click(function() {
            $('#detail_233041184').slideDown("normal");
            $('#show_233041184').hide();
            $('#hide_233041184').show();
        });
        $('#hide_233041184').click(function() {
            $('#detail_233041184').slideUp();
            $('#hide_233041184').hide();
            $('#show_233041184').show();
        });
        </script></pre></div><legend>Similar Recent Tickets <small>modified within the last 30 days</small></legend><div id="similar_tickets"><p class="muted">No similar tickets found.</p></div>
</div>
<script type="text/javascript">
function reset_anchor() {
    $("#updates .selected").removeClass("selected");
    var urls = document.location.toString().split('#'); 
    var anchor = urls[1];
    if(anchor) {
        $("a[name='"+anchor+"']").parents(".update_description").addClass("selected");
    }
}
function submitspam(ticket_id) {
    myret = confirm("Would you like to close this ticket as a security ticket, and submit the ticket content to akismet?");
    if(myret == true) {
        $.ajax("viewer/processspam?id="+ticket_id).done(function() {
            window.location.reload();
        });
    }
}

$(function() {
    reset_anchor();
    var ADDITIONAL_COOKIE_NAME = 'gocticket';
    var options = { path: '/', expires: 365};

    if(window.opener && window.opener.name == "gocticket_list") {
        v = $.cookie("closewindow");
        if(!v) {
            $("#closewindow").attr("checked", "checked"); //on by default
        } else {
            if(v == "checked") {
                $("#closewindow").attr("checked", "checked");
            }
        }
        $("#closewindow").click(function() {
            $.cookie("closewindow", $(this).attr('checked'), options);
        });
    } else {
        $("#closewindow_area").hide();
    }
    function updateTimeago() {
        $("time").timeago();
        setTimeout(updateTimeago, 30*1000);
    }
    updateTimeago();
    $(".description").focus(expand_description);
});
</script>
<hr/>
<footer>
<p>GOC Ticket Version 2.2 | <a href="https://ticket.opensciencegrid.org/goc/submit?app_issue_check=on&amp;app_issue_type=goc&amp;app_goc_url=https%3A%2F%2Fticket.opensciencegrid.org%3A443%2F17090">Report Bugs</a>
 | <a href="https://github.com/opensciencegrid/operations/blob/master/docs/privacy.md">Privacy Policy</a>
</p>

<p> <img align="top" src="images/tag_orange.png"/> Copyright 2018 The Trustees of Indiana University - Developed for Open Science Grid</p>
</footer>


</div><!--container-fluid-->
<script>
//used by searchbox
function parseValue(value) {
    var obj = new Object();
    var tokens = value.split("\t");
    obj.str = tokens[0];
    obj.count = tokens[1];
    return obj;
}

$(function() {
    //bootstrap-2.0.4 stuff
    $(".alert-message").alert();
    $(".dropdown-toggle").dropdown();
    $("span[rel='tooltip']").tooltip();
    $("a[rel=popover]").popover();

    //activate menu that user is currently on
    $("#menu_navigator").addClass("active"); 
    $("#submenu_").addClass("active"); 

    //translate zend validation error message to bootstrap
    $(".errors").addClass("alert").addClass("alert-error");

    //enable autocomplete for search box
    $("#search").autocomplete({
        source: function( request, response ) {
            $.ajax({
                url: "search/autocomplete",
                dataType: "text",
                data: {
                    //featureClass: "P",
                    //style: "full",
                    //maxRows: 12,
                    //name_startsWith: request.term
                    q: request.term
                },
                success: function( data ) {
                    response( $.map( data.split("\n"), function( item ) {
                        if(item == "") return null;
                        return {
                            value: item
                        }
                    }));
                }
            });
        },
        select: function(event, ui) {
            document.location = "search?q="+ui.item.value;
        }
    });
    
});
</script>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-69012-13");
pageTracker._trackPageview();
} catch(err) {}
</script>

</body>
