<!DOCTYPE html>
<html lang="en">
  <head>
  <base href="">
    <title>[27464] voms server at FNAL too old to work with EMI3</title>    <meta charset="utf-8" />
    <meta name="verify-v1" content="na5IcAJsZVOfEkboRxuIiZ1zpZgnZiWra+nKcS7nA/o=" />
    <meta name="google-site-verification" content="DLrk3ft4s8b-S2TloLCL2LD_t6wcTjgSluf5pmiu2kA" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />
    <link href="https://ticket.opensciencegrid.org/rss" rel="alternate" type="application/rss+xml" title="GOC Ticket Update feed" />

    <style type="text/css">
      body {
        padding-top: 50px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
     #search {
            width: 300px;
     }

    </style>

<script src="https://code.jquery.com/jquery-3.0.0.js"></script>
<script src="https://code.jquery.com/jquery-migrate-3.0.1.js"></script>

   <link href="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet"/>
    <script src="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/js/bootstrap.min.js"></script>

    <link href="https://netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"/>
    <link href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/themes/smoothness/jquery-ui.min.css" rel="stylesheet"/>
 <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>


    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/js/select2.min.js"></script>

    <link href="css/ticket.css" rel="stylesheet" />
    <script src="lib/jquery.cookie.js"></script>

    <link href="images/tag_orange.png" rel="icon" type="image/png"/>
  </head>

  <body>
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>

            <a class="brand" style="padding: 6px 0px 0px 6px;" href="http://opensciencegrid.org"><img src="images/osglogo.40x30.png"/></a>
            <ul class="nav">
                <li class="dropdown"><a href="https://ticket.opensciencegrid.org/#" class="dropdown-toggle" data-toggle="dropdown">GOC Ticket <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    <li><a href="https://my.opensciencegrid.org">MyOSG</a></li>
                    <li><a href="https://oim.opensciencegrid.org">OIM</a></li>
                    <li class="active"><a href="https://ticket.opensciencegrid.org/index">Ticket</a></li>
	<li class="divider"></li>
	<li><a href="http://repo.grid.iu.edu">Repo</a></li>
	<li class="divider"></li>
	<li><a href="http://blogs.grid.iu.edu">Blog</a></li>
                    <li><a href="http://display.grid.iu.edu">Display</a></li>
                    <li><a href="http://osggoc.blogspot.com/">News</a></li>
                    </ul>
                </li>
            </ul>
            <ul class="nav pull-right">
                <li><a href="https://ticket.opensciencegrid.org/sso/">Login</a></li>            </ul>

            <div class="nav-collapse">
                <ul class="nav">
			 <li id="menu_submit"><a href="https://ticket.opensciencegrid.org/submit">Submit</a></li><li id="menu_view" class="dropdown"><a href="https://ticket.opensciencegrid.org/\#" class="dropdown-toggle" data-toggle="dropdown">View <b class="caret"></b></a><ul class="dropdown-menu"><li id="submenu_listopen"><a href="https://ticket.opensciencegrid.org/list/open">Open Tickets</a></li><li id="submenu_listrecentclose"><a href="https://ticket.opensciencegrid.org/list/recentclose">Recently Closed Tickets</a></li><li class="divider"></li><li id="submenu_alltickets"><a href="https://ticket.opensciencegrid.org/search?q=&amp;sort=id">All Tickets</a></li></ul></li>                </ul>

                <form class="navbar-search pull-right" action="https://ticket.opensciencegrid.org/viewer">
                    <input id="search" type="text" name="id" class="search-query span2" placeholder="Search Ticket" value=""/>
                </form>
            </div>
        </div>
      </div>
    </div>

<script type='text/javascript' src='lib/jquery.timeago.js'></script>
<script type='text/javascript' src='lib/byte2size.js'></script>
<style>
#updates .toolbar {
position: relative;
margin-top: 0px;
top: -10px;
font-weight: normal;
}
#updates a.anchor {
position: relative;
top: -50px;
}
#updates .selected pre {
animation:selected 2s;
animation-iteration-count: 2;
animation-direction: alternate;
-webkit-animation:selected 2s; 
-webkit-animation-iteration-count: 2;
-webkit-animation-direction: alternate;
box-shadow: inset 1px 1px 20px #9ad;
border: 1px solid #9ab;
margin: 5px 0px;
padding-left: 10px;
}
@keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ab;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
@-webkit-keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ad;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
#updates pre {
background-color: inherit;
line-height: 15px;
padding: 5px;
}
#updates .header {
color: #999;
}
#updates .update_history pre {
background-color: #eee;
color: #666;
font-size: 85%;
}
#updates .clickable {
cursor: pointer;
}
#updates .clickable:hover {
color: #D98719;
}
#updates .meta_information pre {
background-color: #fed;
}
#similar_tickets {
max-height: 300px;
overflow-y: auto;
pointer-events: none;
padding: 5px;
background-color: #f4f4f4;
}
.btn-toolbar {
margin-bottom: 0;
height: 30px;
}
#peers {
position: fixed;
bottom: 0px;
right: 0px;
z-index: 100;
list-style: none;
padding: 5px 0px 0px 5px;
margin: 0px;
background-color: white;
box-shadow: 0px 0px 10px white;
}
#peers li {
background-color: #ccc;
color: #000;
display: inline-block;
padding: 5px 10px;
margin-right: 5px;
position: relative;
}
/*
#peers li:hover {
background-color: #999;
cursor: pointer;
}
*/
#peers span.ip {
padding-left: 5px;
color: #666;
}
#peers .new {
bottom: -30px;
}
/*
#peers .me {
background-color: red;
}
*/
</style>

<div class="container-fluid">
<ul id="peers"></ul>
<div class="alert alert-danger"><a class="close" href="https://ticket.opensciencegrid.org/#" data-dismiss="alert">&times;</a>By the end of May 2018, the ticketing system at https://ticket.opensciencegrid.org will be retired and support will be provided at https://support.opensciencegrid.org. Throughout this transition the support email (help@opensciencegrid.org) will be available as a point of contact.<br><br>                                                   
                                                                                                                                                                                   
Please see the service migration page for details: https://opensciencegrid.github.io/technology/policy/service-migrations-spring-2018/#ticket</div><div id="presence" class="pull-right"></div><div class="ticketgui"><script type="text/javascript" src="lib/checktab.js"></script>

<script>
var expanded = false;
function expand_description() {
    var desc = $(".description");
    if(!expanded) {
        expanded = true;
        //expand to minheight
        var min = 250;
        if(desc.height() < min) {
            desc.animate({height: min}, 200);
        }
    }
}

$(document).ready(function() {
    $("input[name='nad']").datepicker({
        dateFormat: 'yy-mm-dd'
    });
});

</script>



<style>
.form-horizontal .control-label {
padding-top: inherit;
font-size:90%;
color:#666;
}
label {
margin-bottom: 0px;
}
.controls {
line-height: 18px;
}
</style>
<form class="form-horizontal" action="https://ticket.opensciencegrid.org/viewer/updatebasic?id=27464" method="post">
<div class="page-header">
    <h3><span class="muted">27464</span> / voms server at FNAL too old to work with EMI3</h3>
</div>

<div class="row-fluid">
<div class="span5">
    <legend>Contact</legend>
    <div class="control-group">
        <label class="control-label">Full Name</label>
        <div class="controls">Daniela Bauer</div>
    </div>
    <div class="control-group">
        <label class="control-label">Email</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">Phone</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">CC</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>

    <legend>Details</legend>
    <div class="control-group"><label class="control-label">Submitted Via</label><div class="controls">GGUS</div></div><div class="control-group"><label class="control-label">Submitter</label><div class="controls">Daniela Bauer</div></div><div class="control-group"><label class="control-label">Ticket Links</label><div class="controls"></div></div>
    <div class="control-group">
        <label class="control-label">Ticket Type</label>
        <div class="controls"></div>
    </div>
    <div class="control-group">
        <label class="control-label">Priority</label>
        <div class="controls">Elevated</div>
    </div>
    <div class="control-group">
        <label class="control-label">Status</label>
        <div class="controls">
Closed</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action</label>
        <div class="controls">Joe to reply</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action Deadline</label>
        <div class="controls flag_red">2016-01-08</div>
    </div>

</div><!--span-->
<div class="span7">
    <legend>Assignees</legend>
    <div class="assignee" style="width: 60%">FNAL (Prod)&nbsp;<a target="_blank" href="https://fermi.service-now.com/nav_to.do?uri=incident.do?sys_id=INC000000628506">INC000000628506</a> <span class="muted"> / Ticket Exchange</span></div><div class="assignee" style="width: 60%">GGUS (Prod)&nbsp;<a target="_blank" href="https://ggus.eu/ws/ticket_info.php?ticket=117587">117587</a> <span class="muted"> / Ticket Exchange</span></div><div class="assignee" style="width: 60%">Tim Cartwright <span class="muted"> / OSG Software Team</span></div>    <br>

    <legend>Assignees</legend>
    TODO
    <br>

    <style>
legend.noborder {
border-bottom: none;
}
</style>

<div id="attachment-list"/>
<script>
$(function () {
    var first = true;
    $.getJSON("attachment/list/27464", function (files) {
        //console.dir(files);
        var html = "<table class=\"table table-condensed\">";
        $(files).each(function() {
            if(first) {
                first = false;
                html += "<legend class=\"noborder\">Attachmenets</legend>";
            }
            html += "<tr class=\"attachment\">";
            html += "<td><img src=\""+this.thumbnail_url+"\"/></td>";
            html += "<td><a href=\""+this.url+"\" target=\"_blank\">"+this.name+"</a></td>";
            html += "<td>"+bytesToSize(this.size, 1)+"</td>";
            html += "</tr>";
        });
        html += "</table>";
        $("#attachment-list").html(html);
    });
});

function download(url) {
    window.open(url, "_blank");
}
</script>


</div><!--span-->
</div><!--row-fluid-->


</form>

</div>
<div id="updates" style="clear: both;">
    <legend>Past Updates
    <div class="btn-toolbar pull-right toolbar">
        <div class="btn-group">
                <a class="btn btn-small" href="https://ticket.opensciencegrid.org/27464?sort=up&amp;"><i class="icon-arrow-up"></i> Sort</a>

        
        <a class="btn btn-small" href="https://ticket.opensciencegrid.org/27464?expandall=true&amp;">Expand Descriptions</a>        <a class="btn btn-small" target="_blank" href="mailto:osg@tick.globalnoc.iu.edu?subject=Open%20Science%20Grid%3A%20voms%20server%20at%20FNAL%20too%20old%20to%20work%20with%20EMI3%20ISSUE%3D27464%20PROJ%3D71"><i class="icon-envelope"></i> Update w/Email</a>
        </div>
    </div><!--btn-toolbar-->
    </legend>

    <div class='update_description'><i onclick="document.location='27464#1453507263'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-01-23T00:01:03+00:00">Jan 23, 2016 12:01 AM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1453507263">&nbsp;</a></div><pre>[Permanent Solution]
Upgraded VOMS servers from osg 3.1 release to osg 3.3.
-- by  at Tue Jan 12 06&#58;00&#58;28 UTC 2016

GOCTX Source&#58; <a href='https&#58;//fermi.service-now.com/nav_to.do?uri=incident.do?sys_id=INC000000628506' target='_blank' rel='nofollow'>https&#58;//fermi.service-now.com/nav_to.do?uri=incident.do?sys_id=INC000000628506</a></pre></div><div class='update_description'><i onclick="document.location='27464#1453507184'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-01-22T23:59:44+00:00">Jan 22, 2016 11:59 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1453507184">&nbsp;</a></div><pre>This ticket was closed automatically. If this issue has not been resolved according your expectations or if you need further information, please submit a new ticket referencing this one.

-- by GGUS SYSTEM at Fri Jan 22 23&#58;59&#58;06 UTC 2016

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=117587' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=117587</a></pre></div><div class='update_description'><i onclick="document.location='27464#1452265499'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-01-08T15:04:59+00:00">Jan 8, 2016 03:04 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1452265499">&nbsp;</a></div><pre>I&#39;ll go ahead and mark this ticket as resolved.
-- by njp at Fri Jan 08 15&#58;04&#58;24 UTC 2016

[Permanent Solution]
Upgraded VOMS servers from osg 3.1 release to osg 3.3.
-- by  at Fri Jan 08 15&#58;04&#58;24 UTC 2016

GOCTX Source&#58; <a href='https&#58;//fermi.service-now.com/nav_to.do?uri=incident.do?sys_id=INC000000628506' target='_blank' rel='nofollow'>https&#58;//fermi.service-now.com/nav_to.do?uri=incident.do?sys_id=INC000000628506</a></pre></div><div class='update_description'><i onclick="document.location='27464#1452246879'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-01-08T09:54:39+00:00">Jan 8, 2016 09:54 AM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1452246879">&nbsp;</a></div><pre>it works for me too. If nobody has any objection we can close the ticket. If the voms instance goes away as Daniela hinted, I trust Gabriele to update the operations portal.

-- by Alessandra.Forti at Fri Jan 08 09&#58;54&#58;01 UTC 2016

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=117587' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=117587</a></pre></div><div class='update_description'><i onclick="document.location='27464#1452246338'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-01-08T09:45:38+00:00">Jan 8, 2016 09:45 AM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1452246338">&nbsp;</a></div><pre>voms.fnal.gov is still used as admin interface. I think this is why it was left. It doesn&#39;t cause any harm if it is in the list anyway.

-- by Alessandra.Forti at Fri Jan 08 09&#58;45&#58;02 UTC 2016

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=117587' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=117587</a></pre></div><div class='update_description'><i onclick="document.location='27464#1452245917'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-01-08T09:38:37+00:00">Jan 8, 2016 09:38 AM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1452245917">&nbsp;</a></div><pre>Hi,

Yes, it seems to work now (voms1 and voms2 - I understand voms.fnal.gov is being retired).

Thanks,
Daniela

-- by Daniela Bauer at Fri Jan 08 09&#58;38&#58;17 UTC 2016

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=117587' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=117587</a></pre></div><div class='update_description'><i onclick="document.location='27464#1452203766'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-01-07T21:56:06+00:00">Jan 7, 2016 09:56 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1452203766">&nbsp;</a></div><pre>Hi,

Today we finished updating our voms servers to the latest version of VOMS from OSG Repo 3.3. This should bring out site in line with the required updates needed.

Can you please test again?
-- by njp at Thu Jan 07 21&#58;55&#58;06 UTC 2016

GOCTX Source&#58; <a href='https&#58;//fermi.service-now.com/nav_to.do?uri=incident.do?sys_id=INC000000628506' target='_blank' rel='nofollow'>https&#58;//fermi.service-now.com/nav_to.do?uri=incident.do?sys_id=INC000000628506</a></pre></div><div class='update_description'><i onclick="document.location='27464#1451987433'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-01-05T09:50:33+00:00">Jan 5, 2016 09:50 AM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1451987433">&nbsp;</a></div><pre>From Update #20 &#34;Will start a thread outside this ticket to correct the ops portal.&#34;

Gabriele has now updated the Ops portal adding voms1 and voms2. voms, though not working, remains because it&#39;s the admin interface.Changed CC to garzogli@....

-- by Alessandra.Forti at Tue Jan 05 09&#58;50&#58;01 UTC 2016

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=117587' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=117587</a></pre></div><div class='update_description'><i onclick="document.location='27464#1449862090'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-12-11T19:28:10+00:00">Dec 11, 2015 07:28 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1449862090">&nbsp;</a></div><pre>no, the problem isn&#39;t solved. I&#39;m putting it on hold.

-- by Alessandra.Forti at Fri Dec 11 19&#58;27&#58;33 UTC 2015

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=117587' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=117587</a></pre></div><div class='update_description'><i onclick="document.location='27464#1449860997'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-12-11T19:09:57+00:00">Dec 11, 2015 07:09 PM UTC</time> by <b>Christopher Pipes</b><a class="anchor" name="1449860997">&nbsp;</a></div><pre>Hello All,

Should we go ahead and close this ticket for now until a newer version is in place and maybe open one up later for testing if need be?

Thanks,
Chris</pre></div><div class='update_description'><i onclick="document.location='27464#1449519503'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-12-07T20:18:23+00:00">Dec 7, 2015 08:18 PM UTC</time><a class="anchor" name="1449519503">&nbsp;</a></div><pre>Yup - after being on critical-security-updates-only, support for OSG 3.1 was dropped earlier in the year.  Upgrading to 3.2 is probably a good first step.

Thanks for looking into this.  I&#39;ll be happy to probe a test server once one is ready.

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=bbockelm/CN=659869/CN=Brian Paul Bockelman</pre></div><div class='update_description'><i onclick="document.location='27464#1449509396'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-12-07T17:29:56+00:00">Dec 7, 2015 05:29 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1449509396">&nbsp;</a></div><pre>I&#39;ve compared our packages between what is running at the OSG and what&#39;s running at FNAL. FNAL is running voms-2.0.11-2.3.osg31.el6.x86_64, where the OSG is running voms-2.0.12-3.1.osg32.el5.i386.rpm

The OSG version is running on a RHEL 5 clone(not sure if centos, SL) and FNAL is running on SLF6.

As I understand it, when the queries are against the OSG VOMS server, the issue isn&#39;t encountered. As FNAL is still using OSG 3.1, I am assuming it&#39;s safe to say, we need to move to a newer version of the OSG releases, and a more recent VOMS.

-- by njp at Mon Dec 07 17&#58;29&#58;05 UTC 2015

GOCTX Source&#58; <a href='https&#58;//fermi.service-now.com/nav_to.do?uri=incident.do?sys_id=INC000000628506' target='_blank' rel='nofollow'>https&#58;//fermi.service-now.com/nav_to.do?uri=incident.do?sys_id=INC000000628506</a></pre></div><div class='update_description'><i onclick="document.location='27464#1449078741'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-12-02T17:52:21+00:00">Dec 2, 2015 05:52 PM UTC</time><a class="anchor" name="1449078741">&nbsp;</a></div><pre>Hi Daniele, Alessandra,

Gerard and I did some further work on this yesterday (but failed to update the ticket).

We found that the VOMS servers hosted at FNAL (voms{1,2}.fnal.gov, voms{1,2}.opensciencegrid.org) don&#39;t seem to work with the VOMS3 client.  However, the VOMS server hosted at the GOC (voms.grid.iu.edu) for the OSG VO *does* work with the VOMS3 client.  However, both hosts should be similar setups - they both should run the OSG stack.

He is following up with GOC to compare RPM version differences to see if something needs an upgrade or if there&#39;s a regression.

Brian

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=bbockelm/CN=659869/CN=Brian Paul Bockelman</pre></div><div class='update_description'><i onclick="document.location='27464#1449051541'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-12-02T10:19:01+00:00">Dec 2, 2015 10:19 AM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1449051541">&nbsp;</a></div><pre>Will start a thread outside this ticket to correct the ops portal. To solve this problem though ignore voms.fnal.gov. It is a red herring, even removing it the other two don&#39;t work.

-- by Alessandra.Forti at Wed Dec 02 10&#58;18&#58;13 UTC 2015

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=117587' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=117587</a></pre></div><div class='update_description'><i onclick="document.location='27464#1449048780'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-12-02T09:33:00+00:00">Dec 2, 2015 09:33 AM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1449048780">&nbsp;</a></div><pre>Thanks Alessandra.
If you (plural you) look in the original submission, it had both voms1 and voms2 in there. If voms.fnal.gov should not be used, it needs to be indicated in the EU operations portal (I can&#39;t make a direct link, but <a href='http&#58;//operations-portal.egi.eu/vo/search' target='_blank' rel='nofollow'>http&#58;//operations-portal.egi.eu/vo/search</a> and then putting lsst in the search box will do), how can people know otherwise ?.

Cheers,
Daniela

-- by Daniela Bauer at Wed Dec 02 09&#58;32&#58;21 UTC 2015

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=117587' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=117587</a></pre></div><div class='update_description'><i onclick="document.location='27464#1449018711'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-12-02T01:11:51+00:00">Dec 2, 2015 01:11 AM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1449018711">&nbsp;</a></div><pre>Hi,

the problem was not voms.fnal.gov in the UI configuration. That may be obsolete and cause 1 failure but the client then tries the other server names listed and they both return an end of file error message. Example from my UI using

cat /etc/vomses/lsst-voms*
&#34;lsst&#34; &#34;voms1.fnal.gov&#34; &#34;15003&#34; &#34;/DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=Services/CN=voms1.fnal.gov&#34; &#34;lsst&#34;
&#34;lsst&#34; &#34;voms2.fnal.gov&#34; &#34;15003&#34; &#34;/DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=Services/CN=voms2.fnal.gov&#34; &#34;lsst&#34;
&#34;lsst&#34; &#34;voms.fnal.gov&#34; &#34;15003&#34; &#34;/DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=Services/CN=voms.fnal.gov&#34; &#34;lsst&#34;

aforti@vm7&#62;/usr/bin/voms-proxy-init3 --version
voms-proxy-init v. 3.0.6 (voms-api-java/3.0.5 canl/1.3.3)

aforti@vm7&#62;/usr/bin/voms-proxy-init3 -voms lsst
Enter GRID pass phrase for this identity&#58;
Contacting voms.fnal.gov&#58;15003 [/DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=Services/CN=voms.fnal.gov] &#34;lsst&#34;...
Error contacting voms.fnal.gov&#58;15003 for VO lsst&#58; HTTPS hostname wrong&#58;  should be &#60;voms.fnal.gov&#62;
Error contacting voms.fnal.gov&#58;15003 for VO lsst&#58; peer not authenticated
Error contacting voms.fnal.gov&#58;15003 for VO lsst&#58; REST and legacy VOMS endpoints failed.
Contacting voms2.fnal.gov&#58;15003 [/DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=Services/CN=voms2.fnal.gov] &#34;lsst&#34;...
Error contacting voms2.fnal.gov&#58;15003 for VO lsst&#58; Unexpected end of file from server
Error contacting voms2.fnal.gov&#58;15003 for VO lsst&#58; peer not authenticated
Error contacting voms2.fnal.gov&#58;15003 for VO lsst&#58; REST and legacy VOMS endpoints failed.
Contacting voms1.fnal.gov&#58;15003 [/DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=Services/CN=voms1.fnal.gov] &#34;lsst&#34;...
Error contacting voms1.fnal.gov&#58;15003 for VO lsst&#58; Unexpected end of file from server
Error contacting voms1.fnal.gov&#58;15003 for VO lsst&#58; peer not authenticated
Error contacting voms1.fnal.gov&#58;15003 for VO lsst&#58; REST and legacy VOMS endpoints failed.
None of the contacted servers for lsst were capable of returning a valid AC for the user.
User&#39;s request for VOMS attributes could not be fulfilled.

you can see that neither voms1 nor voms2 is responding.

-- by Alessandra.Forti at Wed Dec 02 01&#58;11&#58;00 UTC 2015

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=117587' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=117587</a></pre></div><div class='update_description'><i onclick="document.location='27464#1449002892'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-12-01T20:48:12+00:00">Dec 1, 2015 08:48 PM UTC</time><a class="anchor" name="1449002892">&nbsp;</a></div><pre>I see that the OSG VOMS server has the same issue in the OSG vo-client; can someone from Operations open a separate ticket for that?

Daniela, do you know how we should route the ticket to have this fixed at the UI?

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=bbockelm/CN=659869/CN=Brian Paul Bockelman</pre></div><div class='update_description'><i onclick="document.location='27464#1448998995'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-12-01T19:43:15+00:00">Dec 1, 2015 07:43 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1448998995">&nbsp;</a></div><pre>Hi Brian,

thanks for pointing to the vomses file, it looks like it&#39;s outdated in that client (the EMI3 UI).

FNAL decommissioned voms.fnal.gov as a VOMS server a while back and sites should have updated their vomses file. For the OSG sites this comes form the vo-client package and recent ones do not have voms.fnal.gov&#58;

[root@cmslpc27 ~]# rpm -qf /etc/vomses
vo-client-59-1.osg32.el6.noarch
[root@cmslpc27 ~]# grep lsst /etc/vomses
&#34;lsst&#34; &#34;voms1.fnal.gov&#34; &#34;15003&#34; &#34;/DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=Services/CN=voms1.fnal.gov&#34; &#34;lsst&#34;
&#34;lsst&#34; &#34;voms2.fnal.gov&#34; &#34;15003&#34; &#34;/DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=Services/CN=voms2.fnal.gov&#34; &#34;lsst&#34;
[root@cmslpc27 ~]#

So the issue here seems to be an outdated vomses file in the EMI3 UI.

Gerard
-- by gerard1 at Tue Dec 01 19&#58;42&#58;20 UTC 2015

GOCTX Source&#58; <a href='https&#58;//fermi.service-now.com/nav_to.do?uri=incident.do?sys_id=INC000000628506' target='_blank' rel='nofollow'>https&#58;//fermi.service-now.com/nav_to.do?uri=incident.do?sys_id=INC000000628506</a></pre></div><div class='update_description'><i onclick="document.location='27464#1448980435'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-12-01T14:33:55+00:00">Dec 1, 2015 02:33 PM UTC</time><a class="anchor" name="1448980435">&nbsp;</a></div><pre>Actually, the comment about SSLv3 may be a red-herring due to an ambiguous error message (&#34;No appropriate protocol (protocol is disabled or cipher suites are inappropriate)&#34;).  Testing the OSG VOMS server (which has one DNS entry configured similarly to FNAL&#39;s and a third entry which is not load-balanced)&#58;

&#34;&#34;&#34;
$ voms-proxy-init --voms osg&#58;/osg
Contacting voms2.opensciencegrid.org&#58;15027 [/DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=Services/CN=voms2.opensciencegrid.org] &#34;osg&#34;...
Error contacting voms2.opensciencegrid.org&#58;15027 for VO osg&#58; Unexpected end of file from server
Error contacting voms2.opensciencegrid.org&#58;15027 for VO osg&#58; peer not authenticated
Error contacting voms2.opensciencegrid.org&#58;15027 for VO osg&#58; REST and legacy VOMS endpoints failed.
Contacting voms.grid.iu.edu&#58;15027 [/DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=Services/CN=http/voms.grid.iu.edu] &#34;osg&#34;...
Remote VOMS server contacted succesfully.

Created proxy in /tmp/x509up_u1221.

Your proxy is valid until Tue Dec 01 20&#58;32&#58;16 CST 2015
&#34;&#34;&#34;

So, I suspect that fixing the hostcert at FNAL would fix the issue here.

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=bbockelm/CN=659869/CN=Brian Paul Bockelman</pre></div><div class='update_description'><i onclick="document.location='27464#1448979374'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-12-01T14:16:14+00:00">Dec 1, 2015 02:16 PM UTC</time><a class="anchor" name="1448979374">&nbsp;</a></div><pre>Hi,

Again, it seems nothing to do with VOMS server version but the TLS connection.  Here&#39;s the line from vomses&#58;

&#34;lsst&#34; &#34;voms.fnal.gov&#34; &#34;15003&#34; &#34;/DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=Services/CN=voms.fnal.gov&#34; &#34;lsst&#34;

However, the certificate is /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=Services/CN=voms2.fnal.gov (and voms.fnal.gov is not on the SAN).

So, the new client is simply applying more stringent checking than the old client; alternately, there&#39;s a simple work-around in the vomses config.

Next, it appears that the VOMS3 client in the lxplus UI hardcodes SSLv3 as the only client protocol for legacy negotiation but the Java configuration on the UI explicitly disables SSLv3.  This is a UI issue / client bug, not something fundamental with VOMS v2 / v3 (at least at this point.  I didn&#39;t try fixing the client to see what happens).  I would note that the FNAL VOMS server happily negotiates TLSv1.2 / AES256-GCM-SHA384 when I test.

Brian

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=bbockelm/CN=659869/CN=Brian Paul Bockelman</pre></div><div class='update_description'><i onclick="document.location='27464#1448970805'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-12-01T11:53:25+00:00">Dec 1, 2015 11:53 AM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1448970805">&nbsp;</a></div><pre>Hi Brian,

if you want to have a look yourself, I can reproduce this with the standard UI on lxplus at CERN.

Cheers,
Daniela

-- by Daniela Bauer at Tue Dec 01 11&#58;52&#58;24 UTC 2015

Alessandra.Forti has subscribed to this ticket.

-- by Alessandra.Forti at Tue Dec 01 11&#58;31&#58;47 UTC 2015

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=117587' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=117587</a></pre></div><div class='update_description'><i onclick="document.location='27464#1448921330'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-11-30T22:08:50+00:00">Nov 30, 2015 10:08 PM UTC</time><a class="anchor" name="1448921330">&nbsp;</a></div><pre>Hi,

This message&#58;

Error contacting voms1.fnal.gov&#58;15003 for VO lsst&#58; Unexpected end of file from server
Error contacting voms1.fnal.gov&#58;15003 for VO lsst&#58; peer not authenticated

Indicates the issue is in the TLS connection; nothing to do with VOMS version.  It hasn&#39;t proceeded to the point where there&#39;s a difference between the two VOMS server versions.

Tony was looking into this earlier - anything to report?

Brian

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=bbockelm/CN=659869/CN=Brian Paul Bockelman</pre></div><div class='update_description'><i onclick="document.location='27464#1448388266'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-11-24T18:04:26+00:00">Nov 24, 2015 06:04 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1448388266">&nbsp;</a></div><pre>The use case is that users at European universities are using the EMI3/UMD3 software stack and for security reasons are not meant to use EMI2/UMD2 (support for UMD2 was discontinued 30 April 2014 !).

Daniela

-- by Daniela Bauer at Tue Nov 24 18&#58;03&#58;59 UTC 2015

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=117587' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=117587</a></pre></div><div class='update_description'><i onclick="document.location='27464#1448386703'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-11-24T17:38:23+00:00">Nov 24, 2015 05:38 PM UTC</time> by <b>Tim Cartwright</b><a class="anchor" name="1448386703">&nbsp;</a></div><pre>At the moment, there are no concrete plans to move the OSG software stack from VOMS 2 to VOMS 3. This is a significant transition, including a language change (C/C++ to Java) and a database schema change.

I would guess that the OSG Technology Investigations team, led by Brian Bockelman (CCed), will be interested in the use cases that require VOMS 3.</pre></div><div class='update_description'><i onclick="document.location='27464#1448038384'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-11-20T16:53:04+00:00">Nov 20, 2015 04:53 PM UTC</time> by <b>Neha Sharma</b><a class="anchor" name="1448038384">&nbsp;</a></div><pre>Adding Tim Cartwright to cc. for his feedback/plans on upgrading VOMS in OSG Software</pre></div><div class='update_description'><i onclick="document.location='27464#1448038143'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-11-20T16:49:03+00:00">Nov 20, 2015 04:49 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1448038143">&nbsp;</a></div><pre>Hi,

at FNAL we are running the OSG VOMS versions.

The latest voms-server RPMs in the OSG repo are&#58;
voms-server-2.0.12-3.osg33.el6.x86_64.rpm
voms-admin-server-2.7.0-1.14.osg33.el6.noarch.rpm

and the FNAL VOMS servers are running
voms-2.0.11-2.3.osg31.el6.x86_64
voms-admin-server-2.7.0-1.12.osg31.el6.noarch

At this time there is no upgrade to VOMS3 scheduled at FNAL but if an upgrade within the OSG versions would help we will plan an upgrade.

I&#39;d like this issue to be considered by the OSG software team to assess if an upgrade of the OSG repos to a newer upstream version is needed or if a minor upgrade of the FNAL servers to the last OSG releases would suffice.

sorry for the inconvenience,
Gerard
-- by gerard1 at Fri Nov 20 16&#58;47&#58;11 UTC 2015

GOCTX Source&#58; <a href='https&#58;//fermi.service-now.com/nav_to.do?uri=incident.do?sys_id=INC000000628506' target='_blank' rel='nofollow'>https&#58;//fermi.service-now.com/nav_to.do?uri=incident.do?sys_id=INC000000628506</a></pre></div><div class='update_description'><i onclick="document.location='27464#1447973050'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-11-19T22:44:10+00:00">Nov 19, 2015 10:44 PM UTC</time><a class="anchor" name="1447973050">&nbsp;</a></div><pre>Adding more Fermi folks to the cc.

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=Joe Boyd 579</pre></div><div class='update_description'><i onclick="document.location='27464#1447964667'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-11-19T20:24:27+00:00">Nov 19, 2015 08:24 PM UTC</time><a class="anchor" name="1447964667">&nbsp;</a></div><pre>Discussing our upgrade options on this end.  I&#39;ll get back to you.

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=Joe Boyd 579</pre></div><div class='update_description'><i onclick="document.location='27464#1447930691'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-11-19T10:58:11+00:00">Nov 19, 2015 10:58 AM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1447930691">&nbsp;</a></div><pre>The  VOMS Admin version number si what I read of the voms servers webpage, as I actually don&#39;t have access to the server.

Daniela

-- by Daniela Bauer at Thu Nov 19 10&#58;58&#58;00 UTC 2015

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=117587' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=117587</a></pre></div><div class='update_description'><i onclick="document.location='27464#1447878861'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-11-18T20:34:21+00:00">Nov 18, 2015 08:34 PM UTC</time> by <b>Christopher Pipes</b><a class="anchor" name="1447878861">&nbsp;</a></div><pre>Hello Joe,

Could you please take a look this and let us know if you are able to help?

Thanks,
Chris</pre></div><div class='update_description'><i onclick="document.location='27464#1447862144'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-11-18T15:55:44+00:00">Nov 18, 2015 03:55 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1447862144">&nbsp;</a></div><pre>Hi,

I have trouble generating a proxy (for the lsst VO) using the FNAL vomsserver
(voms1,2.fnal.gov) when using a EMI3 UI&#58;

voms-proxy-init --voms lsst&#58;/lsst/Role=pilot
[...]
Contacting voms1.fnal.gov&#58;15003 [/DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=Services/CN=voms1.fnal.gov] &#34;lsst&#34;...
Error contacting voms1.fnal.gov&#58;15003 for VO lsst&#58; Unexpected end of file from server
Error contacting voms1.fnal.gov&#58;15003 for VO lsst&#58; peer not authenticated
Error contacting voms1.fnal.gov&#58;15003 for VO lsst&#58; REST and legacy VOMS endpoints failed.
Contacting voms2.fnal.gov&#58;15003 [/DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=Services/CN=voms2.fnal.gov] &#34;lsst&#34;...
Error contacting voms2.fnal.gov&#58;15003 for VO lsst&#58; Unexpected end of file from server
Error contacting voms2.fnal.gov&#58;15003 for VO lsst&#58; peer not authenticated
Error contacting voms2.fnal.gov&#58;15003 for VO lsst&#58; REST and legacy VOMS endpoints failed.
None of the contacted servers for lsst were capable of returning a valid AC for the user.
User&#39;s request for VOMS attributes could not be fulfilled

It does work if I use an EMI2 UI&#58;
voms-proxy-init --voms lsst&#58;/lsst/Role=pilot
[...]
Your identity&#58; /C=UK/O=eScience/OU=Imperial/L=Physics/CN=dirac-pilot.grid.hep.ph.ic.ac.uk
Creating temporary proxy ................................... Done
Contacting  voms1.fnal.gov&#58;15003 [/DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=Services/CN=voms1.fnal.gov] &#34;lsst&#34; Done
Creating proxy ................... Done

Your proxy is valid until Sat Nov 14 02&#58;25&#58;36 2015

Looking at the voms server version  at FNAL it seems to be VOMS Admin version 2.7.0. The rest of the world (TM) seems to be on VOMS Admin version 3.3.3 and these servers seem to work.

Assuming the old software is indeed the problem, are there any plans to upgrade this any time soon ?

Regards,
Daniela

<div id='show_8429996' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_8429996'>[Ticket Origin]
<a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=117587' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=117587</a>

[Ticket History]
Subject&#58; voms server at FNAL too old to work with EMI3
Ticket Type&#58; USER
CC&#58;
-- by Daniela Bauer at Fri Nov 13 14&#58;32&#58;01 UTC 2015

-- by Pablo Orviz Fernandez at Mon Nov 16 07&#58;49&#58;00 UTC 2015

Hello,
yes, ancient voms-server (not voms-admin) version is likely to cause this
(except using v2 voms-proxy-init, you can possibly workaround the bug
by reenabling SSLv3 in Java). Reassigning to OSG(Prod)...

-- by Zdenek Salvet at Wed Nov 18 15&#58;55&#58;29 UTC 2015
</div><script type='text/javascript'>
        $('#show_8429996').click(function() {
            $('#detail_8429996').slideDown("normal");
            $('#show_8429996').hide();
            $('#hide_8429996').show();
        });
        $('#hide_8429996').click(function() {
            $('#detail_8429996').slideUp();
            $('#hide_8429996').hide();
            $('#show_8429996').show();
        });
        </script></pre></div><legend>Similar Recent Tickets <small>modified within the last 30 days</small></legend><div id="similar_tickets"><p class="muted">No similar tickets found.</p></div>
</div>
<script type="text/javascript">
function reset_anchor() {
    $("#updates .selected").removeClass("selected");
    var urls = document.location.toString().split('#'); 
    var anchor = urls[1];
    if(anchor) {
        $("a[name='"+anchor+"']").parents(".update_description").addClass("selected");
    }
}
function submitspam(ticket_id) {
    myret = confirm("Would you like to close this ticket as a security ticket, and submit the ticket content to akismet?");
    if(myret == true) {
        $.ajax("viewer/processspam?id="+ticket_id).done(function() {
            window.location.reload();
        });
    }
}

$(function() {
    reset_anchor();
    var ADDITIONAL_COOKIE_NAME = 'gocticket';
    var options = { path: '/', expires: 365};

    if(window.opener && window.opener.name == "gocticket_list") {
        v = $.cookie("closewindow");
        if(!v) {
            $("#closewindow").attr("checked", "checked"); //on by default
        } else {
            if(v == "checked") {
                $("#closewindow").attr("checked", "checked");
            }
        }
        $("#closewindow").click(function() {
            $.cookie("closewindow", $(this).attr('checked'), options);
        });
    } else {
        $("#closewindow_area").hide();
    }
    function updateTimeago() {
        $("time").timeago();
        setTimeout(updateTimeago, 30*1000);
    }
    updateTimeago();
    $(".description").focus(expand_description);
});
</script>
<hr/>
<footer>
<p>GOC Ticket Version 2.2 | <a href="https://ticket.opensciencegrid.org/goc/submit?app_issue_check=on&amp;app_issue_type=goc&amp;app_goc_url=https%3A%2F%2Fticket.opensciencegrid.org%3A443%2F27464">Report Bugs</a>
 | <a href="https://github.com/opensciencegrid/operations/blob/master/docs/privacy.md">Privacy Policy</a>
</p>

<p> <img align="top" src="images/tag_orange.png"/> Copyright 2018 The Trustees of Indiana University - Developed for Open Science Grid</p>
</footer>


</div><!--container-fluid-->
<script>
//used by searchbox
function parseValue(value) {
    var obj = new Object();
    var tokens = value.split("\t");
    obj.str = tokens[0];
    obj.count = tokens[1];
    return obj;
}

$(function() {
    //bootstrap-2.0.4 stuff
    $(".alert-message").alert();
    $(".dropdown-toggle").dropdown();
    $("span[rel='tooltip']").tooltip();
    $("a[rel=popover]").popover();

    //activate menu that user is currently on
    $("#menu_navigator").addClass("active"); 
    $("#submenu_").addClass("active"); 

    //translate zend validation error message to bootstrap
    $(".errors").addClass("alert").addClass("alert-error");

    //enable autocomplete for search box
    $("#search").autocomplete({
        source: function( request, response ) {
            $.ajax({
                url: "search/autocomplete",
                dataType: "text",
                data: {
                    //featureClass: "P",
                    //style: "full",
                    //maxRows: 12,
                    //name_startsWith: request.term
                    q: request.term
                },
                success: function( data ) {
                    response( $.map( data.split("\n"), function( item ) {
                        if(item == "") return null;
                        return {
                            value: item
                        }
                    }));
                }
            });
        },
        select: function(event, ui) {
            document.location = "search?q="+ui.item.value;
        }
    });
    
});
</script>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-69012-13");
pageTracker._trackPageview();
} catch(err) {}
</script>

</body>
