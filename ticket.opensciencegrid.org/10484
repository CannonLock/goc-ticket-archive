<!DOCTYPE html>
<html lang="en">
  <head>
  <base href="/">
    <title>[10484] NET2_DATADISK failing FT&#58; failed to contact on remote SRM</title>    <meta charset="utf-8" />
    <meta name="verify-v1" content="na5IcAJsZVOfEkboRxuIiZ1zpZgnZiWra+nKcS7nA/o=" />
    <meta name="google-site-verification" content="DLrk3ft4s8b-S2TloLCL2LD_t6wcTjgSluf5pmiu2kA" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />
    <link href="https://ticket.opensciencegrid.org/rss" rel="alternate" type="application/rss+xml" title="GOC Ticket Update feed" />

    <style type="text/css">
      body {
        padding-top: 50px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
     #search {
            width: 300px;
     }

    </style>

<script src="https://code.jquery.com/jquery-3.0.0.js"></script>
<script src="https://code.jquery.com/jquery-migrate-3.0.1.js"></script>

   <link href="//netdna.bootstrapcdn.com/bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet"/>
    <script src="//netdna.bootstrapcdn.com/bootstrap/2.3.2/js/bootstrap.min.js"></script>

    <link href="//netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"/>
    <link href="//ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/themes/smoothness/jquery-ui.min.css" rel="stylesheet"/>
 <script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>


    <link href="//cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/css/select2.min.css" rel="stylesheet" />
    <script src="//cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/js/select2.min.js"></script>

    <link href="css/ticket.css" rel="stylesheet" />
    <script src="lib/jquery.cookie.js"></script>

    <link href="images/tag_orange.png" rel="icon" type="image/png"/>
    <script src='https://www.google.com/recaptcha/api.js'></script>
  </head>

  <body>
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>

            <a class="brand" style="padding: 6px 0px 0px 6px;" href="http://opensciencegrid.org"><img src="https://ticket.opensciencegrid.org/images/osglogo.40x30.png"/></a>
            <ul class="nav">
                <li class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown">GOC Ticket <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    <li><a href="https://my.opensciencegrid.org">MyOSG</a></li>
                    <li><a href="https://oim.opensciencegrid.org">OIM</a></li>
                    <li class="active"><a href="index">Ticket</a></li>
	<li class="divider"></li>
	<li><a href="http://repo.grid.iu.edu">Repo</a></li>
	<li class="divider"></li>
	<li><a href="http://blogs.grid.iu.edu">Blog</a></li>
                    <li><a href="http://display.grid.iu.edu">Display</a></li>
                    <li><a href="http://osggoc.blogspot.com/">News</a></li>
                    </ul>
                </li>
            </ul>
            <ul class="nav pull-right">
                <li><a href="https://ticket.opensciencegrid.org/sso/">Login</a></li>            </ul>

            <div class="nav-collapse">
                <ul class="nav">
			 <li id="menu_submit"><a href="https://ticket.opensciencegrid.org/submit">Submit</a></li><li id="menu_view" class="dropdown"><a href="\#" class="dropdown-toggle" data-toggle="dropdown">View <b class="caret"></b></a><ul class="dropdown-menu"><li id="submenu_listopen"><a href="https://ticket.opensciencegrid.org/list/open">Open Tickets</a></li><li id="submenu_listrecentclose"><a href="https://ticket.opensciencegrid.org/list/recentclose">Recently Closed Tickets</a></li><li class="divider"></li><li id="submenu_alltickets"><a href="https://ticket.opensciencegrid.org/search?q=&amp;sort=id">All Tickets</a></li></ul></li>                </ul>

                <form class="navbar-search pull-right" action="viewer">
                    <input id="search" type="text" name="id" class="search-query span2" placeholder="Search Ticket" value=""/>
                </form>
            </div>
        </div>
      </div>
    </div>

<script type='text/javascript' src='lib/jquery.timeago.js'></script>
<script type='text/javascript' src='lib/byte2size.js'></script>
<style>
#updates .toolbar {
position: relative;
margin-top: 0px;
top: -10px;
font-weight: normal;
}
#updates a.anchor {
position: relative;
top: -50px;
}
#updates .selected pre {
animation:selected 2s;
animation-iteration-count: 2;
animation-direction: alternate;
-webkit-animation:selected 2s; 
-webkit-animation-iteration-count: 2;
-webkit-animation-direction: alternate;
box-shadow: inset 1px 1px 20px #9ad;
border: 1px solid #9ab;
margin: 5px 0px;
padding-left: 10px;
}
@keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ab;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
@-webkit-keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ad;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
#updates pre {
background-color: inherit;
line-height: 15px;
padding: 5px;
}
#updates .header {
color: #999;
}
#updates .update_history pre {
background-color: #eee;
color: #666;
font-size: 85%;
}
#updates .clickable {
cursor: pointer;
}
#updates .clickable:hover {
color: #D98719;
}
#updates .meta_information pre {
background-color: #fed;
}
#similar_tickets {
max-height: 300px;
overflow-y: auto;
pointer-events: none;
padding: 5px;
background-color: #f4f4f4;
}
.btn-toolbar {
margin-bottom: 0;
height: 30px;
}
#peers {
position: fixed;
bottom: 0px;
right: 0px;
z-index: 100;
list-style: none;
padding: 5px 0px 0px 5px;
margin: 0px;
background-color: white;
box-shadow: 0px 0px 10px white;
}
#peers li {
background-color: #ccc;
color: #000;
display: inline-block;
padding: 5px 10px;
margin-right: 5px;
position: relative;
}
/*
#peers li:hover {
background-color: #999;
cursor: pointer;
}
*/
#peers span.ip {
padding-left: 5px;
color: #666;
}
#peers .new {
bottom: -30px;
}
/*
#peers .me {
background-color: red;
}
*/
</style>

<div class="container-fluid">
<ul id="peers"></ul>
<div class="alert alert-danger"><a class="close" href="#" data-dismiss="alert">&times;</a>By the end of May 2018, the ticketing system at https://ticket.opensciencegrid.org will be retired and support will be provided at https://support.opensciencegrid.org. Throughout this transition the support email (help@opensciencegrid.org) will be available as a point of contact.<br><br>                                                   
                                                                                                                                                                                   
Please see the service migration page for details: https://opensciencegrid.github.io/technology/policy/service-migrations-spring-2018/#ticket</div><div id="presence" class="pull-right"></div><div class="ticketgui"><script type="text/javascript" src="https://ticket.opensciencegrid.org/lib/checktab.js"></script>

<script>
var expanded = false;
function expand_description() {
    var desc = $(".description");
    if(!expanded) {
        expanded = true;
        //expand to minheight
        var min = 250;
        if(desc.height() < min) {
            desc.animate({height: min}, 200);
        }
    }
}

$(document).ready(function() {
    $("input[name='nad']").datepicker({
        dateFormat: 'yy-mm-dd'
    });
});

</script>



<style>
.form-horizontal .control-label {
padding-top: inherit;
font-size:90%;
color:#666;
}
label {
margin-bottom: 0px;
}
.controls {
line-height: 18px;
}
</style>
<form class="form-horizontal" action="https://ticket.opensciencegrid.org/viewer/updatebasic?id=10484" method="post">
<div class="page-header">
    <h3><span class="muted">10484</span> / NET2_DATADISK failing FT&#58; failed to contact on remote SRM</h3>
</div>

<div class="row-fluid">
<div class="span5">
    <legend>Contact</legend>
    <div class="control-group">
        <label class="control-label">Full Name</label>
        <div class="controls">CompAtP1Shift </div>
    </div>
    <div class="control-group">
        <label class="control-label">Email</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">Phone</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">CC</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>

    <legend>Details</legend>
    <div class="control-group"><label class="control-label">Associated VO</label><div class="controls">ATLAS</div></div><div class="control-group"><label class="control-label">Submitted Via</label><div class="controls">GGUS</div></div><div class="control-group"><label class="control-label">Submitter</label><div class="controls"> CompAtP1Shift</div></div><div class="control-group"><label class="control-label">Support Center</label><div class="controls">USATLAS</div></div>
    <div class="control-group">
        <label class="control-label">Ticket Type</label>
        <div class="controls">Problem/Request</div>
    </div>
    <div class="control-group">
        <label class="control-label">Priority</label>
        <div class="controls">Elevated</div>
    </div>
    <div class="control-group">
        <label class="control-label">Status</label>
        <div class="controls">
Closed</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action</label>
        <div class="controls">TX Incoming</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action Deadline</label>
        <div class="controls flag_red">2011-06-14</div>
    </div>

</div><!--span-->
<div class="span7">
    <legend>Assignees</legend>
    <div class="assignee" style="width: 60%">Tanya Levshina <span class="muted"> / OSG Storage Team</span></div><div class="assignee" style="width: 60%">GGUS (Prod)&nbsp;<a target="_blank" href="https://ggus.eu/ws/ticket_info.php?ticket=70973">70973</a> <span class="muted"> / Ticket Exchange</span></div><div class="assignee" style="width: 60%">USATLAS (BNL Prod)&nbsp;<a target="_blank" href="https://rt.racf.bnl.gov/rt/Ticket/Display.html?id=20093">20093</a> <span class="muted"> / Ticket Exchange</span></div>    <br>

    <legend>Assignees</legend>
    TODO
    <br>

    <style>
legend.noborder {
border-bottom: none;
}
</style>

<div id="attachment-list"/>
<script>
$(function () {
    var first = true;
    $.getJSON("https://ticket.opensciencegrid.org/attachment/list?id=10484", function (files) {
        //console.dir(files);
        var html = "<table class=\"table table-condensed\">";
        $(files).each(function() {
            if(first) {
                first = false;
                html += "<legend class=\"noborder\">Attachmenets</legend>";
            }
            html += "<tr class=\"attachment\">";
            html += "<td><img src=\""+this.thumbnail_url+"\"/></td>";
            html += "<td><a href=\""+this.url+"\" target=\"_blank\">"+this.name+"</a></td>";
            html += "<td>"+bytesToSize(this.size, 1)+"</td>";
            html += "</tr>";
        });
        html += "</table>";
        $("#attachment-list").html(html);
    });
});

function download(url) {
    window.open(url, "_blank");
}
</script>


</div><!--span-->
</div><!--row-fluid-->


</form>

</div>
<div id="updates" style="clear: both;">
    <legend>Past Updates
    <div class="btn-toolbar pull-right toolbar">
        <div class="btn-group">
                <a class="btn btn-small" href="/10484?sort=up&"><i class="icon-arrow-up"></i> Sort</a>

        
        <a class="btn btn-small" href="/10484?expandall=true&">Expand Descriptions</a>        <a class="btn btn-small" target="_blank" href="mailto:osg@tick.globalnoc.iu.edu?subject=Open%20Science%20Grid%3A%20NET2_DATADISK%20failing%20FT%26%2358%3B%20failed%20to%20contact%20on%20remote%20SRM%20ISSUE%3D10484%20PROJ%3D71"><i class="icon-envelope"></i> Update w/Email</a>
        </div>
    </div><!--btn-toolbar-->
    </legend>

    <div class='update_description'><i onclick="document.location='10484#1307023605'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-06-02T14:06:45+00:00">Jun 2, 2011 02:06 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1307023605">&nbsp;</a></div><pre>Normal operations restored. Upgrading from bestman 1 to bestman 2.
-- by youssef@.... at Thu Jun 02 14&#58;06&#58;34 UTC 2011

GOCTX Source&#58; BNL Ticket&#58; Queue=NETier2 ID=20093</pre></div><div class='update_description'><i onclick="document.location='10484#1306946825'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-06-01T16:47:05+00:00">Jun 1, 2011 04:47 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1306946825">&nbsp;</a></div><pre>Hello,

According to glite-transfer-channel-audit, most of our FTS channels (and
specifically BUSRM-BNLDCACHE) were turned off at 2011-05-31 21&#58;53&#58;17. Was there
a specific reason for this?

As mentioned in the previous update, everything was (and still is) looking good
with our SRM and at the site in general. The transfer errors stopped (though
now I&#39;m not sure if that was due to intervention or natural recovery) and we
did successfully finish many jobs before FTS was turned off. Jobs are now
piling up in transferring state though because FTS is inactive. We&#39;re going to
reactive FTS channels and want to continue to see these queued FTS transfers
succeed before fully unblacklisting us.

If my understanding of the situation is off please correct me, or anyone wants
to change FTS/DDM status please let us know.

Thanks,

John and Saul
-- by brunejo@.... at Wed Jun 01 16&#58;46&#58;56 UTC 2011

GOCTX Source&#58; BNL Ticket&#58; Queue=NETier2 ID=20093</pre></div><div class='update_description'><i onclick="document.location='10484#1306885972'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-05-31T23:52:52+00:00">May 31, 2011 11:52 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1306885972">&nbsp;</a></div><pre>Hello,

The errors are from this afternoon (EDT) when bestman crashed again.

But the SRM has been back for almost three hours.  We&#39;re still waiting
for DDM/FTS to recognize this.  I can&#39;t explain why logs still show a
failure to srm-ping.  We saw the same sort of latency on Friday.

In summary, local status is okay at the moment (when I got this
email), FTS channels should remain open, and PRODDISK (at least)
should remain unblacklisted.

Thanks,

John

On May 31, 2011, at 7&#58;14 PM, OSG GOC TX via RT &#60;RT-RACF@....&#62; wrote&#58;

<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;   Ticket URL&#58; <a href='https&#58;//rt.racf.bnl.gov/rt/Ticket/Display.html?id=20093' target='_blank' rel='nofollow'>https&#58;//rt.racf.bnl.gov/rt/Ticket/Display.html?id=20093</a></font>
<font color='#7F7E6F'>&#62;   Requestors&#58; tx+rtbnlprod_fp71@....</font>
<font color='#7F7E6F'>&#62;          Ccs&#58; hito@....</font>
<font color='#7F7E6F'>&#62;        Queue&#58; NETier2</font>
<font color='#7F7E6F'>&#62;        Owner&#58; Saul Youssef</font>
<font color='#7F7E6F'>&#62;       Status&#58; open</font>
<font color='#7F7E6F'>&#62;     Priority&#58; Medium</font>
<font color='#7F7E6F'>&#62;  Transaction&#58; Correspondence added by osg-goc-rest</font>
<font color='#7F7E6F'>&#62;      Subject&#58; NET2_DATADISK failing FT&#58; failed to contact on remote</font>
<font color='#7F7E6F'>&#62; SRM</font>
<font color='#7F7E6F'>&#62;              GGUS Ticket&#58; 70973</font>
<font color='#7F7E6F'>&#62;           OSG GOC Ticket&#58; 10484</font>
<font color='#7F7E6F'>&#62;         GGUS Ticket Type&#58; TEAM</font>
<font color='#7F7E6F'>&#62;      Resource Group Name&#58; BU_ATLAS_Tier2</font>
<font color='#7F7E6F'>&#62;                  VO Name&#58; ATLAS</font>
<div id='show_99559399' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_99559399'><font color='#7F7E6F'>&#62;        GGUS Problem Type&#58; Other</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; Hi,</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; A quick update to say there are still lots of errors in the US of the</font>
<font color='#7F7E6F'>&#62; form failed to contact on remote SRM</font>
<font color='#7F7E6F'>&#62; [httpg&#58;//atlas.bu.edu&#58;8443/srm/v2/server], including errors at</font>
<font color='#7F7E6F'>&#62; NET2_PHYS-TOP, NET2_DATADISK and BNL-OSG2_DATADISK.</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; Cheers,</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; Martin</font>
<font color='#7F7E6F'>&#62;  -- by Martin White at Tue May 31 23&#58;06&#58;03 UTC 2011</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=70973' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=70973</a></font>
<font color='#7F7E6F'>&#62;  -- by OSG-GOC at Tue May 31 23&#58;13&#58;05 UTC 2011</font>
-- by brunejo@.... at Tue May 31 23&#58;52&#58;40 UTC 2011

GOCTX Source&#58; BNL Ticket&#58; Queue=NETier2 ID=20093
</div><script type='text/javascript'>
        $('#show_99559399').click(function() {
            $('#detail_99559399').slideDown("normal");
            $('#show_99559399').hide();
            $('#hide_99559399').show();
        });
        $('#hide_99559399').click(function() {
            $('#detail_99559399').slideUp();
            $('#hide_99559399').hide();
            $('#show_99559399').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='10484#1306883585'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-05-31T23:13:05+00:00">May 31, 2011 11:13 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1306883585">&nbsp;</a></div><pre>Hi,

A quick update to say there are still lots of errors in the US of the form failed to contact on remote SRM [httpg&#58;//atlas.bu.edu&#58;8443/srm/v2/server], including errors at NET2_PHYS-TOP, NET2_DATADISK and BNL-OSG2_DATADISK.

Cheers,

Martin
-- by Martin White at Tue May 31 23&#58;06&#58;03 UTC 2011

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=70973' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=70973</a></pre></div><div class='update_description'><i onclick="document.location='10484#1306862533'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-05-31T17:22:13+00:00">May 31, 2011 05:22 PM UTC</time> by <b>Christopher Pipes</b><a class="anchor" name="1306862533">&nbsp;</a></div><pre>Thanks for the update. I am going to set this ticket out a few weeks and check on it then. If I don&#39;t see any more updates during that time. I will ping to confirm this is resolved and close it then.

Regards,
Christopher
GOC</pre></div><div class='update_description'><i onclick="document.location='10484#1306627023'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-05-28T23:57:03+00:00">May 28, 2011 11:57 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1306627023">&nbsp;</a></div><pre>Greetings,

Everything continues to be working as far as I can tell. We have a likely
explanation for the problem we&#39;ve experienced and we think we&#39;re ready to be
tested and unblacklisted in DDM and ready to start to turn on our production
sites. I see that our Panda sites are in test mode already. If they pass the
standard testing we should be ready to start production again by gradually
turning on our sites in the order BU_ATLAS_Tier2o, ANALY_NET2, HU_ATLAS_Tier2
followed by ANALY_HU_ATLAS_Tier2.

Here&#39;s what we think happened and the steps we have taken&#58;

PROBLEM&#58; In the process of merging almost all of our space token areas into
one, many files lost their adler32 values stored in extended attributes in
GPFS. These get recomputed and re-stored on demand. This is normally not a
problem, but there are occasional bursts of many requests for checksum
computations via our bestman instance and there is nothing that I know of that
limits the number of these requests. If there are enough of these which happen
to hit data where the checksum needs to be recomputed, GPFS can suddenly get
overloaded and start to perform poorly causing LSM timeouts and failing PanDA
jobs.

FIX&#58; We have had a process running for more than a week restoring all of the
checksums. This will eventually fix the problem but it will need to run for one
or two more weeks to work through our entire inventory. To get around the
problem in the mean time, we have replaced our adler32 callout with a more
flexible python script which throttles the requests if there are too many and
gives us much better feedback about what&#39;s happening. This fix has been in
place since this morning and has been working fine for SAM tests, Hiro&#39;s
loadtest files and extra-DDM system use of SRM by users. With this in place, we
know of no problems preventing our sites from being tested and put into
production as described above.

Saul & John

<div id='show_1056937267' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_1056937267'>On Fri May 27 14&#58;26&#58;12 2011, hiroito wrote&#58;
<font color='#7F7E6F'>&#62; Hello.</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; Your SE is working. I just tested it. I unblacklisted PRODDISK (only).</font>
<font color='#7F7E6F'>&#62; And, BU-&#62;BNL is the only open channel. Let&#39;s see how it goes.</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; Hiro</font>
-- by youssef@.... at Sat May 28 23&#58;56&#58;54 UTC 2011

GOCTX Source&#58; BNL Ticket&#58; Queue=NETier2 ID=20093
</div><script type='text/javascript'>
        $('#show_1056937267').click(function() {
            $('#detail_1056937267').slideDown("normal");
            $('#show_1056937267').hide();
            $('#hide_1056937267').show();
        });
        $('#hide_1056937267').click(function() {
            $('#detail_1056937267').slideUp();
            $('#hide_1056937267').hide();
            $('#show_1056937267').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='10484#1306520780'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-05-27T18:26:20+00:00">May 27, 2011 06:26 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1306520780">&nbsp;</a></div><pre>Hello.

Your SE is working.  I just tested it.  I unblacklisted PRODDISK (only).
And, BU-&#62;BNL is the only open channel.   Let&#39;s see how it goes.

Hiro
-- by hiroito at Fri May 27 18&#58;26&#58;12 UTC 2011

GOCTX Source&#58; BNL Ticket&#58; Queue=NETier2 ID=20093</pre></div><div class='update_description'><i onclick="document.location='10484#1306514977'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-05-27T16:49:37+00:00">May 27, 2011 04:49 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1306514977">&nbsp;</a></div><pre>I&#39;m trying to test from BNL, in case source network host is the problem, but
not finding the srm-ping command&#58;

[acas0007] /usatlas/u/brunejo &#62; source
/afs/usatlas.bnl.gov/lcg/current/etc/profile.d/grid_env.sh
[acas0007] /usatlas/u/brunejo &#62; srm-ping
httpg&#58;//atlas.bu.edu&#58;8443/srm/v2/server
[acas0007] /usatlas/u/brunejo &#62;

Network connections are for sure not blocked, though I guess that was already
established&#58;

[acas0007] /usatlas/u/brunejo &#62; telnet atlas.bu.edu 8443
Trying 192.5.207.10...
Connected to atlas.bu.edu (192.5.207.10).
Escape character is &#39;^]&#39;.

John
-- by brunejo@.... at Fri May 27 16&#58;49&#58;29 UTC 2011

GOCTX Source&#58; BNL Ticket&#58; Queue=NETier2 ID=20093</pre></div><div class='update_description'><i onclick="document.location='10484#1306513950'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-05-27T16:32:30+00:00">May 27, 2011 04:32 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1306513950">&nbsp;</a></div><pre>Hello,

I still can&#39;t figure out why fts is getting errors like this&#58;

2011-05-27 12&#58;18&#58;55,730 [WARN ] - Failed to contact remote SRM
[httpg&#58;//atlas.bu.edu&#58;8443/srm/v2/server]&#58; [SrmPing] failed&#58; SOAP-ENV&#58;Client -
CGSI-gSOAP running on fts02.usatlas.bnl.gov reports Error reading token data
header&#58; Connection closed

srm-ping works fine for me, and RSV says the SE is up (and reported Reported 7
minutes ago), and there are no relevant errors I can find in event.srm.log.
Since it works for some and not for others, could be be a cert/CA-specific
issue? I&#39;m looking through to make sure all those are up-to-date, but that
would be quite a coincidence if an expiration happened exactly during this same
episode...

jab@herophysics&#58;~$ srm-ping httpg&#58;//atlas.bu.edu&#58;8443/srm/v2/server
srm-ping 2.2.1.3.12 Tue Apr 27 13&#58;13&#58;24 PDT 2010
BeStMan and SRM-Clients Copyright(c) 2007-2010,
Lawrence Berkeley National Laboratory. All rights reserved.
Support at SRM@.... and documents at <a href='http&#58;//sdm.lbl.gov/bestman' target='_blank' rel='nofollow'>http&#58;//sdm.lbl.gov/bestman</a>
SRM-CLIENT&#58; Connecting to serviceurl httpg&#58;//atlas.bu.edu&#58;8443/srm/v2/server

SRM-PING&#58; Fri May 27 12&#58;31&#58;22 EDT 2011 Calling SrmPing Request...
versionInfo=v2.2

Extra information (Key=Value)
backend_type=BeStMan
backend_version=2.2.1.3.9
backend_build_date=2010-01-11T16&#58;58&#58;02.000Z
gsiftpTxfServers[0]=<a href='gsiftp&#58;//atlas.bu.edu' target='_blank' rel='nofollow'>gsiftp&#58;//atlas.bu.edu</a>
GatewayMode=Enabled
clientDN=/DC=org/DC=doegrids/OU=People/CN=John Brunelle 583223
localIDMapped=usatlas1
staticToken(0)=ATLASLOCALGROUPDISK desc=ATLASLOCALGROUPDISK size=52398601011200
<div id='show_1359590540' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_1359590540'>staticToken(1)=ATLASDATADISK desc=ATLASDATADISK size=689342251008000
staticToken(2)=ATLASPRODDISK desc=ATLASPRODDISK size=53687091200000
staticToken(3)=ATLASUSERDISK desc=ATLASUSERDISK size=34359738368000
staticToken(4)=ATLASGROUPDISK desc=ATLASGROUPDISK size=96636764160000
staticToken(5)=ATLASSCRATCHDISK desc=ATLASSCRATCHDISK size=16106127360000
staticToken(6)=ATLASHOTDISK desc=ATLASHOTDISK size=10737418240000
jab@herophysics&#58;~$

(I see there&#39;s srmping, too, in addition to srm-ping... haven&#39;t yet figured out
how to get that to work for *any* site.)
-- by brunejo@.... at Fri May 27 16&#58;32&#58;21 UTC 2011

GOCTX Source&#58; BNL Ticket&#58; Queue=NETier2 ID=20093
</div><script type='text/javascript'>
        $('#show_1359590540').click(function() {
            $('#detail_1359590540').slideDown("normal");
            $('#show_1359590540').hide();
            $('#hide_1359590540').show();
        });
        $('#hide_1359590540').click(function() {
            $('#detail_1359590540').slideUp();
            $('#hide_1359590540').hide();
            $('#show_1359590540').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='10484#1306513545'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-05-27T16:25:45+00:00">May 27, 2011 04:25 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1306513545">&nbsp;</a></div><pre>Hello,
it seems that SRM is down. Can you please have a look?
Thanks, cheers,
Jarka

<a href='http&#58;//dashb-atlas-data.cern.ch/dashboard/request.py/file-placement?site=BNL-OSG2_DATADISK&srcSite=NET2_PRODDISK&fromDate=2011-05-27%2015&#58' target='_blank' rel='nofollow'>http&#58;//dashb-atlas-data.cern.ch/dashboard/request.py/file-placement?site=BNL-OSG2_DATADISK&srcSite=NET2_PRODDISK&fromDate=2011-05-27%2015&#58</a>;20&#58;00&toDate=2011-05-27%2016&#58;20&#58;00&state=FAILED_TRANSFER&errorType=228&activity=0&activity=1&activity=2&activity=3&activity=4&activity=5&activity=6&activity=7
-- by Jaroslava Schovancova at Fri May 27 16&#58;24&#58;56 UTC 2011

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=70973' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=70973</a></pre></div><div class='update_description'><i onclick="document.location='10484#1306508865'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-05-27T15:07:45+00:00">May 27, 2011 03:07 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1306508865">&nbsp;</a></div><pre>Okay, I see -- the main fail listing is in UTC but these log entries must
be in EDT (not labeled).  (ftsmon is great, though!)

I don&#39;t know why it says &#34;failed to contact on remote SRM&#34;.  I can
srm-ping and transfer files in both directions.  I&#39;m watching the log and
see basically nothing but srmLs and loadtest transfers.

Thanks,

John

Fri May 27 14&#58;56&#58;56 UTC 2011

On Fri, 27 May 2011, Hironori Ito via RT wrote&#58;

<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;   Ticket URL&#58; <a href='https&#58;//rt.racf.bnl.gov/rt/Ticket/Display.html?id=20093' target='_blank' rel='nofollow'>https&#58;//rt.racf.bnl.gov/rt/Ticket/Display.html?id=20093</a></font>
<font color='#7F7E6F'>&#62;   Requestors&#58; tx+rtbnlprod_fp71@....</font>
<font color='#7F7E6F'>&#62;          Ccs&#58; hito@....</font>
<font color='#7F7E6F'>&#62;        Queue&#58; NETier2</font>
<font color='#7F7E6F'>&#62;        Owner&#58; Saul Youssef</font>
<font color='#7F7E6F'>&#62;       Status&#58; open</font>
<font color='#7F7E6F'>&#62;     Priority&#58; Medium</font>
<font color='#7F7E6F'>&#62;  Transaction&#58; Correspondence added by hiroito</font>
<font color='#7F7E6F'>&#62;      Subject&#58; NET2_DATADISK failing FT&#58; failed to contact on remote SRM</font>
<font color='#7F7E6F'>&#62;              GGUS Ticket&#58; 70973</font>
<font color='#7F7E6F'>&#62;           OSG GOC Ticket&#58; 10484</font>
<font color='#7F7E6F'>&#62;         GGUS Ticket Type&#58; TEAM</font>
<font color='#7F7E6F'>&#62;      Resource Group Name&#58; BU_ATLAS_Tier2</font>
<font color='#7F7E6F'>&#62;                  VO Name&#58; ATLAS</font>
<font color='#7F7E6F'>&#62;        GGUS Problem Type&#58; Other</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;</font>
<div id='show_926061447' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_926061447'>_________________________________________________________________________________________________________________________________________________________________________________
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; Hello, John.</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; DDM transfers from BU to BNL is still active.�� The reason that you don&#39;t see</font>
any transfers is that they are failing.
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; For example, see</font>
<font color='#7F7E6F'>&#62; <a href='http&#58;//www.usatlas.bnl.gov/fts-monitor/ftsmon/showJob?jobid=8af15095-8870-' target='_blank' rel='nofollow'>http&#58;//www.usatlas.bnl.gov/fts-monitor/ftsmon/showJob?jobid=8af15095-8870-</a></font>
11e0-8502-bc6a80f213f0
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; Hiro</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; On 05/27/2011 10&#58;43 AM, John Brunelle via RT wrote&#58;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;    Ticket ID&#58; [rt.racf.bnl.gov #20093]</font>
<font color='#7F7E6F'>&#62;   Requestors&#58; tx+rtbnlprod_fp71@....</font>
<font color='#7F7E6F'>&#62;        Queue&#58; NETier2</font>
<font color='#7F7E6F'>&#62;        Owner&#58; Saul Youssef</font>
<font color='#7F7E6F'>&#62;       Status&#58; new</font>
<font color='#7F7E6F'>&#62;     Priority&#58; Medium</font>
<font color='#7F7E6F'>&#62;  Transaction&#58; Correspondence added by brunejo@....</font>
<font color='#7F7E6F'>&#62;      Subject&#58; NET2_DATADISK failing FT&#58; failed to contact on remote SRM</font>
<font color='#7F7E6F'>&#62;              GGUS Ticket&#58; 70973</font>
<font color='#7F7E6F'>&#62;           OSG GOC Ticket&#58; 10484</font>
<font color='#7F7E6F'>&#62;         GGUS Ticket Type&#58; TEAM</font>
<font color='#7F7E6F'>&#62;      Resource Group Name&#58; BU_ATLAS_Tier2</font>
<font color='#7F7E6F'>&#62;                  VO Name&#58; ATLAS</font>
<font color='#7F7E6F'>&#62;        GGUS Problem Type&#58; Other</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;</font>
_________________________________________________________________________________________________________________________________________________________________________________
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; Hello,</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; Bestman is back up (these issues filled the local disk, too).  BU staff</font>
<font color='#7F7E6F'>&#62; are monitoring that now.</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; How about just opening up BU proddisk -&#62; BNL transfers (this job output</font>
<font color='#7F7E6F'>&#62; backlog)?</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; I see BUSRM-BNLDCACHE is active.  I do not see any NET2 sites blacklisted,</font>
<font color='#7F7E6F'>&#62; though.  I&#39;m looking here&#58;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; <a href='http&#58;//bourricot.cern.ch/blacklisted_production.html' target='_blank' rel='nofollow'>http&#58;//bourricot.cern.ch/blacklisted_production.html</a></font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; which I know used to be authoritative -- is it still?  The only other</font>
<font color='#7F7E6F'>&#62; active FTS channel is BUSRM-STAR.  Can I set that to inactive so other</font>
<font color='#7F7E6F'>&#62; transfers don&#39;t interfere with this crititcal backlog handling?</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; Thanks,</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; John</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; *** RT-Note&#58; Stripped 43 quoted lines from message body!</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;</font>
-- by brunejo@.... at Fri May 27 15&#58;07&#58;37 UTC 2011

GOCTX Source&#58; BNL Ticket&#58; Queue=NETier2 ID=20093
</div><script type='text/javascript'>
        $('#show_926061447').click(function() {
            $('#detail_926061447').slideDown("normal");
            $('#show_926061447').hide();
            $('#hide_926061447').show();
        });
        $('#hide_926061447').click(function() {
            $('#detail_926061447').slideUp();
            $('#hide_926061447').hide();
            $('#show_926061447').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='10484#1306507957'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-05-27T14:52:37+00:00">May 27, 2011 02:52 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1306507957">&nbsp;</a></div><pre>Hello, John.

DDM transfers from BU to BNL is still active.  The reason that you don&#39;t
see any transfers is that they are failing.

For example, see
<a href='http&#58;//www.usatlas.bnl.gov/fts-monitor/ftsmon/showJob?jobid=8af15095-8870-11e0-' target='_blank' rel='nofollow'>http&#58;//www.usatlas.bnl.gov/fts-monitor/ftsmon/showJob?jobid=8af15095-8870-11e0-</a>
8502-bc6a80f213f0

Hiro
-- by hiroito at Fri May 27 14&#58;52&#58;29 UTC 2011

GOCTX Source&#58; BNL Ticket&#58; Queue=NETier2 ID=20093</pre></div><div class='update_description'><i onclick="document.location='10484#1306507428'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-05-27T14:43:48+00:00">May 27, 2011 02:43 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1306507428">&nbsp;</a></div><pre>Hello,

Bestman is back up (these issues filled the local disk, too).  BU staff
are monitoring that now.

How about just opening up BU proddisk -&#62; BNL transfers (this job output
backlog)?

I see BUSRM-BNLDCACHE is active.  I do not see any NET2 sites blacklisted,
though.  I&#39;m looking here&#58;

<a href='http&#58;//bourricot.cern.ch/blacklisted_production.html' target='_blank' rel='nofollow'>http&#58;//bourricot.cern.ch/blacklisted_production.html</a>

which I know used to be authoritative -- is it still?  The only other
active FTS channel is BUSRM-STAR.  Can I set that to inactive so other
transfers don&#39;t interfere with this crititcal backlog handling?

Thanks,

John

*** RT-Note&#58; Stripped 43 quoted lines from message body!

-- by brunejo@.... at Fri May 27 14&#58;43&#58;31 UTC 2011

GOCTX Source&#58; BNL Ticket&#58; Queue=NETier2 ID=20093</pre></div><div class='update_description'><i onclick="document.location='10484#1306506638'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-05-27T14:30:38+00:00">May 27, 2011 02:30 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1306506638">&nbsp;</a></div><pre>Update from  John B. / NET2&#58;
&#34;There is an issue with DDM checksumming -- performance, and bestman keeps crashing.  We&#39;ve been in touch with Hiro and other experts, and are disucussing our options&#58;
(a) some sort of throttling so the SE doesn&#39;t get overloaded
(b) turn checksumming off while backlog clears out (checksumming was also recently off and these issues cropped up
after turning it on)
(c) wait for a daemon we have running that&#39;s pre-computing checksums (stored as extra fs atts) to finish
We have some other things to try for the future, but they won&#39;t affect the current backlog.&#34;

-- by Yuri Smirnov at Fri May 27 14&#58;29&#58;17 UTC 2011

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=70973' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=70973</a></pre></div><div class='update_description'><i onclick="document.location='10484#1306490895'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-05-27T10:08:15+00:00">May 27, 2011 10:08 AM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1306490895">&nbsp;</a></div><pre>It looks like the site was restored over the night (in Europe) and collapsed again later.
-- by Stephane Jezequel at Fri May 27 10&#58;07&#58;57 UTC 2011

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=70973' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=70973</a></pre></div><div class='update_description'><i onclick="document.location='10484#1306453851'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-05-26T23:50:51+00:00">May 26, 2011 11:50 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1306453851">&nbsp;</a></div><pre>observing 30+ SOURCE transfer errors during TRANSFER_PREPARATION phase&#58; [CONNECTION_ERROR] failed to contact on remote SRM [httpg&#58;//atlas.bu.edu&#58;8443/srm/v2/server]. Givin&#39; up after 3 tries] Duration [0]
for transfers from NET2_DATADISK to UKI-SOUTHGRID-RALPP_DATADISK

Error details&#58;
2011-05-26 23&#58;42&#58;42	step09.50000030.sonar_1.sonar.RAW.NET2_DATADISK._lb0004._0001.data_1286528528	FAILED_TRANSFER
GUID&#58; 	0bb2841c-c123-43b5-85d5-5aa66ff51b5f
TOOL ID&#58; 	DQ2	ATTEMPT&#58; 	11
SRC SURL&#58; 	<a href='srm&#58;//atlas.bu.edu&#58;8443/srm/v2/server?SFN=/gpfs1/atlasdatadisk/step09/RAW/NET2_DATADISK/step09.50000030.sonar_1.sonar.RAW.NET2_DATADISK/step09.50000030.sonar_1.sonar.RAW.NET2_DATADISK._lb0004._0001.data_1286528528' target='_blank' rel='nofollow'>srm&#58;//atlas.bu.edu&#58;8443/srm/v2/server?SFN=/gpfs1/atlasdatadisk/step09/RAW/NET2_DATADISK/step09.50000030.sonar_1.sonar.RAW.NET2_DATADISK/step09.50000030.sonar_1.sonar.RAW.NET2_DATADISK._lb0004._0001.data_1286528528</a>
DEST SURL&#58; 	<a href='srm&#58;//heplnx204.pp.rl.ac.uk&#58;8443/srm/managerv2?SFN=/pnfs/pp.rl.ac.uk/data/atlas/atlasdatadisk/step09/RAW/NET2_DATADISK/step09.50000030.sonar_1.sonar.RAW.NET2_DATADISK/step09.50000030.sonar_1.sonar.RAW.NET2_DATADISK._lb0004._0001.data_1286528528__DQ2-1306453236' target='_blank' rel='nofollow'>srm&#58;//heplnx204.pp.rl.ac.uk&#58;8443/srm/managerv2?SFN=/pnfs/pp.rl.ac.uk/data/atlas/atlasdatadisk/step09/RAW/NET2_DATADISK/step09.50000030.sonar_1.sonar.RAW.NET2_DATADISK/step09.50000030.sonar_1.sonar.RAW.NET2_DATADISK._lb0004._0001.data_1286528528__DQ2-1306453236</a>
TRANSFER ID&#58; 	906178d8-87f1-11e0-a371-a71d12629c75
CHANNEL&#58; 	<a href='https&#58;//lcgfts.gridpp.rl.ac.uk&#58;8443/glite-data-transfer-fts/services/FileTransfer' target='_blank' rel='nofollow'>https&#58;//lcgfts.gridpp.rl.ac.uk&#58;8443/glite-data-transfer-fts/services/FileTransfer</a>
ERROR MSG&#58; 	[FTS] FTS State [Failed] FTS Retries [1] Reason [SOURCE error during TRANSFER_PREPARATION phase&#58; [CONNECTION_
ERROR] failed to contact on remote SRM [httpg&#58;//atlas.bu.edu&#58;8443/srm/v2/server]. Givin&#39; up after 3 tries] Du
ration [0]
ACTIVITY&#58; 	Functional Test

<a href='http&#58;//dashb-atlas-data.cern.ch/dashboard/request.py/file-placement?site=UKI-SOUTHGRID-RALPP_DATADISK&guid=0bb2841c-c123-43b5-85d5-5aa66ff51b5f' target='_blank' rel='nofollow'>http&#58;//dashb-atlas-data.cern.ch/dashboard/request.py/file-placement?site=UKI-SOUTHGRID-RALPP_DATADISK&guid=0bb2841c-c123-43b5-85d5-5aa66ff51b5f</a>

Would you please have a look, thanks
Tomas Blazek

[Ticket Origin]
<a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=70973' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=70973</a>

[Ticket History]
Sent TEAM notification mail to mail address augustine@....;
-- by  CompAtP1Shift at Thu May 26 23&#58;50&#58;35 UTC 2011</pre></div><legend>Similar Recent Tickets <small>modified within the last 30 days</small></legend><div id="similar_tickets"><p class="muted">No similar tickets found.</p></div>
</div>
<script type="text/javascript">
function reset_anchor() {
    $("#updates .selected").removeClass("selected");
    var urls = document.location.toString().split('#'); 
    var anchor = urls[1];
    if(anchor) {
        $("a[name='"+anchor+"']").parents(".update_description").addClass("selected");
    }
}
function submitspam(ticket_id) {
    myret = confirm("Would you like to close this ticket as a security ticket, and submit the ticket content to akismet?");
    if(myret == true) {
        $.ajax("viewer/processspam?id="+ticket_id).done(function() {
            window.location.reload();
        });
    }
}

$(function() {
    reset_anchor();
    var ADDITIONAL_COOKIE_NAME = 'gocticket';
    var options = { path: '/', expires: 365};

    if(window.opener && window.opener.name == "gocticket_list") {
        v = $.cookie("closewindow");
        if(!v) {
            $("#closewindow").attr("checked", "checked"); //on by default
        } else {
            if(v == "checked") {
                $("#closewindow").attr("checked", "checked");
            }
        }
        $("#closewindow").click(function() {
            $.cookie("closewindow", $(this).attr('checked'), options);
        });
    } else {
        $("#closewindow_area").hide();
    }
    function updateTimeago() {
        $("time").timeago();
        setTimeout(updateTimeago, 30*1000);
    }
    updateTimeago();
    $(".description").focus(expand_description);
});
</script>
<hr/>
<footer>
<p>GOC Ticket Version 2.2 | <a href="https://ticket.opensciencegrid.org/goc/submit?app_issue_check=on&amp;app_issue_type=goc&amp;app_goc_url=https%3A%2F%2Fticket.opensciencegrid.org%3A443%2F10484">Report Bugs</a>
 | <a href="https://github.com/opensciencegrid/operations/blob/master/docs/privacy.md">Privacy Policy</a>
</p>

<p> <img align="top" src="/images/tag_orange.png"/> Copyright 2018 The Trustees of Indiana University - Developed for Open Science Grid</p>
</footer>


</div><!--container-fluid-->
<script src="https://ticket1.grid.iu.edu:8443/socket.io/socket.io.js"></script>
<script>
var chat = io.connect('https://ticket1.grid.iu.edu:8443');
chat.on('connect', function() {
    chat.emit('authenticate', {nodekey:'', ticketid: 10484});
});
chat.on('peers', function(peers) {
    $("#peers").html("");
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('peer_disconnect', function(pid) {
    $("#peer_"+pid).hide("slow");
});
chat.on('peer_connected', function(peers) {
    //expect only 1 peer connecting, but..
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('submit', function() {
    if(confirm("This ticket was updated. Do you want to refresh?")) {
        history.go(0);
    }
});

function addPeer(pid, peer) {
    var ipinfo = "";
    if(peer.ip != undefined) {
        ipinfo = "<span class=\"ip\">"+peer.ip+"</span>";
    }
    if(chat.io.engine.id == pid) {
        //don't display myself
        return;
    }
    var html = "<li class=\"new\" id=\"peer_"+pid+"\" class=\"peer\">"+peer.name+ipinfo+"</li>";
    $("#peers").prepend(html);
    $("#peers .new").animate({bottom: 0}, 1000, function() {$(this).removeClass("new")});
}

$(function() {
    $("#ticket_form").submit(function() {
        chat.emit('submit');
        return true;
    });
});
</script>
<script>
//used by searchbox
function parseValue(value) {
    var obj = new Object();
    var tokens = value.split("\t");
    obj.str = tokens[0];
    obj.count = tokens[1];
    return obj;
}

$(function() {
    //bootstrap-2.0.4 stuff
    $(".alert-message").alert();
    $(".dropdown-toggle").dropdown();
    $("span[rel='tooltip']").tooltip();
    $("a[rel=popover]").popover();

    //activate menu that user is currently on
    $("#menu_navigator").addClass("active"); 
    $("#submenu_").addClass("active"); 

    //translate zend validation error message to bootstrap
    $(".errors").addClass("alert").addClass("alert-error");

    //enable autocomplete for search box
    $("#search").autocomplete({
        source: function( request, response ) {
            $.ajax({
                url: "search/autocomplete",
                dataType: "text",
                data: {
                    //featureClass: "P",
                    //style: "full",
                    //maxRows: 12,
                    //name_startsWith: request.term
                    q: request.term
                },
                success: function( data ) {
                    response( $.map( data.split("\n"), function( item ) {
                        if(item == "") return null;
                        return {
                            value: item
                        }
                    }));
                }
            });
        },
        select: function(event, ui) {
            document.location = "search?q="+ui.item.value;
        }
    });
    
});
</script>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-69012-13");
pageTracker._trackPageview();
} catch(err) {}
</script>

</body>
