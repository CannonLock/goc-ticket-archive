<!DOCTYPE html>
<html lang="en">
  <head>
  <base href="">
    <title>[25459] OASIS Publishing appears to be stuck or broken</title>    <meta charset="utf-8" />
    <meta name="verify-v1" content="na5IcAJsZVOfEkboRxuIiZ1zpZgnZiWra+nKcS7nA/o=" />
    <meta name="google-site-verification" content="DLrk3ft4s8b-S2TloLCL2LD_t6wcTjgSluf5pmiu2kA" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />

    <style type="text/css">
      body {
        padding-top: 50px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
     #search {
            width: 300px;
     }

    </style>

<script src="https://code.jquery.com/jquery-3.0.0.js"></script>
<script src="https://code.jquery.com/jquery-migrate-3.0.1.js"></script>

   <link href="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet"/>
    <script src="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/js/bootstrap.min.js"></script>

    <link href="https://netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"/>
    <link href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/themes/smoothness/jquery-ui.min.css" rel="stylesheet"/>
 <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>


    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/js/select2.min.js"></script>

    <link href="css/ticket.css" rel="stylesheet" />
    <script src="lib/jquery.cookie.js"></script>

    <link href="images/tag_orange.png" rel="icon" type="image/png"/>
  </head>

  <body>
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>

            <a class="brand" style="padding: 6px 0px 0px 6px;" href="http://opensciencegrid.org"><img src="images/osglogo.40x30.png"/></a>
            <ul class="nav">
                <li class="dropdown"><a href="https://ticket.opensciencegrid.org/#" class="dropdown-toggle" data-toggle="dropdown">GOC Ticket <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    <li><a href="https://my.opensciencegrid.org">MyOSG</a></li>
                    <li><a href="https://oim.opensciencegrid.org">OIM</a></li>
                    <li class="active"><a href="https://ticket.opensciencegrid.org/index">Ticket</a></li>
	<li class="divider"></li>
	<li><a href="http://repo.grid.iu.edu">Repo</a></li>
	<li class="divider"></li>
	<li><a href="http://blogs.grid.iu.edu">Blog</a></li>
                    <li><a href="http://display.grid.iu.edu">Display</a></li>
                    <li><a href="http://osggoc.blogspot.com/">News</a></li>
                    </ul>
                </li>
            </ul>
            <ul class="nav pull-right">
                <li><a href="https://ticket.opensciencegrid.org/sso/">Login</a></li>            </ul>

            <div class="nav-collapse">
                <ul class="nav">
			 <li id="menu_submit"><a href="https://ticket.opensciencegrid.org/submit">Submit</a></li><li id="menu_view" class="dropdown"><a href="https://ticket.opensciencegrid.org/\#" class="dropdown-toggle" data-toggle="dropdown">View <b class="caret"></b></a><ul class="dropdown-menu"><li id="submenu_listopen"><a href="https://ticket.opensciencegrid.org/list/open">Open Tickets</a></li><li id="submenu_listrecentclose"><a href="https://ticket.opensciencegrid.org/list/recentclose">Recently Closed Tickets</a></li><li class="divider"></li><li id="submenu_alltickets"><a href="https://ticket.opensciencegrid.org/search?q=&amp;sort=id">All Tickets</a></li></ul></li>                </ul>

                <form class="navbar-search pull-right" action="https://ticket.opensciencegrid.org/viewer">
                    <input id="search" type="text" name="id" class="search-query span2" placeholder="Search Ticket" value=""/>
                </form>
            </div>
        </div>
      </div>
    </div>

<script type='text/javascript' src='lib/jquery.timeago.js'></script>
<script type='text/javascript' src='lib/byte2size.js'></script>
<style>
#updates .toolbar {
position: relative;
margin-top: 0px;
top: -10px;
font-weight: normal;
}
#updates a.anchor {
position: relative;
top: -50px;
}
#updates .selected pre {
animation:selected 2s;
animation-iteration-count: 2;
animation-direction: alternate;
-webkit-animation:selected 2s; 
-webkit-animation-iteration-count: 2;
-webkit-animation-direction: alternate;
box-shadow: inset 1px 1px 20px #9ad;
border: 1px solid #9ab;
margin: 5px 0px;
padding-left: 10px;
}
@keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ab;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
@-webkit-keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ad;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
#updates pre {
background-color: inherit;
line-height: 15px;
padding: 5px;
}
#updates .header {
color: #999;
}
#updates .update_history pre {
background-color: #eee;
color: #666;
font-size: 85%;
}
#updates .clickable {
cursor: pointer;
}
#updates .clickable:hover {
color: #D98719;
}
#updates .meta_information pre {
background-color: #fed;
}
#similar_tickets {
max-height: 300px;
overflow-y: auto;
pointer-events: none;
padding: 5px;
background-color: #f4f4f4;
}
.btn-toolbar {
margin-bottom: 0;
height: 30px;
}
#peers {
position: fixed;
bottom: 0px;
right: 0px;
z-index: 100;
list-style: none;
padding: 5px 0px 0px 5px;
margin: 0px;
background-color: white;
box-shadow: 0px 0px 10px white;
}
#peers li {
background-color: #ccc;
color: #000;
display: inline-block;
padding: 5px 10px;
margin-right: 5px;
position: relative;
}
/*
#peers li:hover {
background-color: #999;
cursor: pointer;
}
*/
#peers span.ip {
padding-left: 5px;
color: #666;
}
#peers .new {
bottom: -30px;
}
/*
#peers .me {
background-color: red;
}
*/
</style>

<div class="container-fluid">
<ul id="peers"></ul>
<div class="alert alert-danger"><a class="close" href="https://ticket.opensciencegrid.org/#" data-dismiss="alert">&times;</a>By the end of May 2018, the ticketing system at https://ticket.opensciencegrid.org will be retired and support will be provided at https://support.opensciencegrid.org. Throughout this transition the support email (help@opensciencegrid.org) will be available as a point of contact.<br><br>                                                   
                                                                                                                                                                                   
Please see the service migration page for details: https://opensciencegrid.github.io/technology/policy/service-migrations-spring-2018/#ticket</div><div id="presence" class="pull-right"></div><div class="ticketgui"><script type="text/javascript" src="lib/checktab.js"></script>

<script>
var expanded = false;
function expand_description() {
    var desc = $(".description");
    if(!expanded) {
        expanded = true;
        //expand to minheight
        var min = 250;
        if(desc.height() < min) {
            desc.animate({height: min}, 200);
        }
    }
}

$(document).ready(function() {
    $("input[name='nad']").datepicker({
        dateFormat: 'yy-mm-dd'
    });
});

</script>



<style>
.form-horizontal .control-label {
padding-top: inherit;
font-size:90%;
color:#666;
}
label {
margin-bottom: 0px;
}
.controls {
line-height: 18px;
}
</style>
<form class="form-horizontal" action="https://ticket.opensciencegrid.org/viewer/updatebasic?id=25459" method="post">
<div class="page-header">
    <h3><span class="muted">25459</span> / OASIS Publishing appears to be stuck or broken</h3>
</div>

<div class="row-fluid">
<div class="span5">
    <legend>Contact</legend>
    <div class="control-group">
        <label class="control-label">Full Name</label>
        <div class="controls">Anthony Tiradani</div>
    </div>
    <div class="control-group">
        <label class="control-label">Email</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">Phone</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">CC</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>

    <legend>Details</legend>
    <div class="control-group"><label class="control-label">Submitted Via</label><div class="controls">GOC Ticket/submit</div></div><div class="control-group"><label class="control-label">Submitter</label><div class="controls">Anthony Tiradani</div></div><div class="control-group"><label class="control-label">Ticket Links</label><div class="controls"></div></div>
    <div class="control-group">
        <label class="control-label">Ticket Type</label>
        <div class="controls">Problem/Request</div>
    </div>
    <div class="control-group">
        <label class="control-label">Priority</label>
        <div class="controls">Normal</div>
    </div>
    <div class="control-group">
        <label class="control-label">Status</label>
        <div class="controls">
Closed</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action</label>
        <div class="controls">ENG Action</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action Deadline</label>
        <div class="controls flag_red">2015-05-19</div>
    </div>

</div><!--span-->
<div class="span7">
    <legend>Assignees</legend>
        <br>

    <legend>Assignees</legend>
    TODO
    <br>

    <style>
legend.noborder {
border-bottom: none;
}
</style>

<div id="attachment-list"/>
<script>
$(function () {
    var first = true;
    $.getJSON("attachment/list/25459", function (files) {
        //console.dir(files);
        var html = "<table class=\"table table-condensed\">";
        $(files).each(function() {
            if(first) {
                first = false;
                html += "<legend class=\"noborder\">Attachmenets</legend>";
            }
            html += "<tr class=\"attachment\">";
            html += "<td><img src=\""+this.thumbnail_url+"\"/></td>";
            html += "<td><a href=\""+this.url+"\" target=\"_blank\">"+this.name+"</a></td>";
            html += "<td>"+bytesToSize(this.size, 1)+"</td>";
            html += "</tr>";
        });
        html += "</table>";
        $("#attachment-list").html(html);
    });
});

function download(url) {
    window.open(url, "_blank");
}
</script>


</div><!--span-->
</div><!--row-fluid-->


</form>

</div>
<div id="updates" style="clear: both;">
    <legend>Past Updates
    <div class="btn-toolbar pull-right toolbar">
    </div><!--btn-toolbar-->
    </legend>

    <div class='update_description'><i onclick="document.location='25459#1431974212'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-05-18T18:36:52+00:00">May 18, 2015 06:36 PM UTC</time><a class="anchor" name="1431974212">&nbsp;</a></div><pre>It&#39;s working fine now, I think the ticket can be closed.

It&#39;s still a mystery why Nova&#39;s initial request, which was the first one since Wednesday night&#39;s crash, did not end up putting anything in the oasis /var/log/oasis/updates.log file even though /net/nas01/Public/ouser.nova/update.details did get updated.   When we tried another osg-oasis-update on the fermilab VO, it didn&#39;t publish anything because of leftovers from the crash caused only the publish step to fail but not the beginning transaction step.  However the next osg-oasis-update on nova that you ran did automatically recover; it got a failure at the beginning cvmfs_server transaction step, so it called cvmfs_server abort and cvmfs_server transaction again and that cleaned everything up as it was supposed to.

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=Dave Dykstra 508</pre></div><div class='update_description'><i onclick="document.location='25459#1431971996'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-05-18T17:59:56+00:00">May 18, 2015 05:59 PM UTC</time> by <b>Scott Teige</b><a class="anchor" name="1431971996">&nbsp;</a></div><pre>Dave, any update on this?
Thanks,
S</pre></div><div class='update_description'><i onclick="document.location='25459#1431723536'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-05-15T20:58:56+00:00">May 15, 2015 08:58 PM UTC</time> by <b>Rob Quick</b><a class="anchor" name="1431723536">&nbsp;</a></div><pre>Checked from a local worker node and see the v1_1_1 directory was updated a few minutes ago. We&#39;ll investigate what may have caused the previous update not to happen, but for now NoVA should be current.</pre></div><div class='update_description'><i onclick="document.location='25459#1431722987'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-05-15T20:49:47+00:00">May 15, 2015 08:49 PM UTC</time> by <b>Rob Quick</b><a class="anchor" name="1431722987">&nbsp;</a></div><pre>Looks like this competed without issue.

Fri May 15 20&#58;42&#58;17 UTC 2015 starting cvmfs_server publish
Processing changes...
.............................................Exporting repository manifest

Waiting for upload of files before committing...
Committing file catalogs...
Tagging oasis.opensciencegrid.org
Flushing file system buffers
Signing new manifest
Remounting newly created repository revision
Cleaning out spooler temp dir... done
Fri May 15 20&#58;44&#58;42 UTC 2015 finished cvmfs_server publish</pre></div><div class='update_description'><i onclick="document.location='25459#1431718837'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-05-15T19:40:37+00:00">May 15, 2015 07:40 PM UTC</time> by <b>Rob Quick</b><a class="anchor" name="1431718837">&nbsp;</a></div><pre>Tony,

Dave and Scott did some troubleshooting and the NoVA repo is currenly replicating. There will be more of an explanation of the issue coming from Dave and Scott shortly, but I wanted to let you know the new repo should appear shortly.</pre></div><div class='update_description'><i onclick="document.location='25459#1431715668'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-05-15T18:47:48+00:00">May 15, 2015 06:47 PM UTC</time><a class="anchor" name="1431715668">&nbsp;</a></div><pre>does /cvmfs/oasis.opensciencegrid.org/nova/externals/jobsub_client/v1_1_1  files exist at the oasis host? I understand they don&#39;t, correct?

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=Jose Caballero 649</pre></div><div class='update_description'><i onclick="document.location='25459#1431712279'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-05-15T17:51:19+00:00">May 15, 2015 05:51 PM UTC</time> by <b>Rob Quick</b><a class="anchor" name="1431712279">&nbsp;</a></div><pre>Tony,

We have an OASIS meeting at the top of the hour. I will bring this up to Dave, Jose, and Scott to see if we can find the cause.</pre></div><div class='update_description'><i onclick="document.location='25459#1431711396'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-05-15T17:36:36+00:00">May 15, 2015 05:36 PM UTC</time> by <b>Scott Teige</b><a class="anchor" name="1431711396">&nbsp;</a></div><pre>adding cc</pre></div><div class='update_description'><i onclick="document.location='25459#1431711066'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-05-15T17:31:06+00:00">May 15, 2015 05:31 PM UTC</time> by <b>Anthony Tiradani</b><a class="anchor" name="1431711066">&nbsp;</a></div><pre>Nova reported that they performed a small update yesterday (~10s of MB) but cannot see the new software mounted at /cvmfs/oasis.opensciencegrid.org/nova/externals/jobsub_client/v1_1_1 at FNAL.  I looked at our Stratum-1 servers and they have no errors.  Looking at the catalog information on the OASIS server and comparing it to what is on the FNAL stratum-1s show that they are in sync.  However, it appears that the last publish date was Wed May 13 15&#58;49&#58;23 CDT 2015.

To get this information, I performed the following commands&#58;
# wget -dqO- <a href='http&#58;//oasis.opensciencegrid.org&#58;8000/cvmfs/oasis.opensciencegrid.org/.cvmfspublished|cat' target='_blank' rel='nofollow'>http&#58;//oasis.opensciencegrid.org&#58;8000/cvmfs/oasis.opensciencegrid.org/.cvmfspublished|cat</a> -v
# wget -dqO- <a href='http&#58;//cvmfs.fnal.gov&#58;8000/cvmfs/oasis.opensciencegrid.org/.cvmfspublished|cat' target='_blank' rel='nofollow'>http&#58;//cvmfs.fnal.gov&#58;8000/cvmfs/oasis.opensciencegrid.org/.cvmfspublished|cat</a> -v

The relevant fields are&#58;
S3892                   - This is the catalog number
T1431550163     - This is the timestamp (Wed May 13 15&#58;49&#58;23 CDT 2015)

They are the same on both OASIS and the FNAL Stratum-1 servers.

Thanks,

Anthony Tiradani</pre></div>
</div>
<script type="text/javascript">
function reset_anchor() {
    $("#updates .selected").removeClass("selected");
    var urls = document.location.toString().split('#'); 
    var anchor = urls[1];
    if(anchor) {
        $("a[name='"+anchor+"']").parents(".update_description").addClass("selected");
    }
}
function submitspam(ticket_id) {
    myret = confirm("Would you like to close this ticket as a security ticket, and submit the ticket content to akismet?");
    if(myret == true) {
        $.ajax("viewer/processspam?id="+ticket_id).done(function() {
            window.location.reload();
        });
    }
}

$(function() {
    reset_anchor();
    var ADDITIONAL_COOKIE_NAME = 'gocticket';
    var options = { path: '/', expires: 365};

    if(window.opener && window.opener.name == "gocticket_list") {
        v = $.cookie("closewindow");
        if(!v) {
            $("#closewindow").attr("checked", "checked"); //on by default
        } else {
            if(v == "checked") {
                $("#closewindow").attr("checked", "checked");
            }
        }
        $("#closewindow").click(function() {
            $.cookie("closewindow", $(this).attr('checked'), options);
        });
    } else {
        $("#closewindow_area").hide();
    }
    function updateTimeago() {
        $("time").timeago();
        setTimeout(updateTimeago, 30*1000);
    }
    updateTimeago();
    $(".description").focus(expand_description);
});
</script>
<hr/>
<footer>
<p>GOC Ticket Version 2.2 | <a href="https://ticket.opensciencegrid.org/goc/submit?app_issue_check=on&amp;app_issue_type=goc&amp;app_goc_url=https%3A%2F%2Fticket.opensciencegrid.org%3A443%2F25459">Report Bugs</a>
 | <a href="https://github.com/opensciencegrid/operations/blob/master/docs/privacy.md">Privacy Policy</a>
</p>

<p> <img align="top" src="images/tag_orange.png"/> Copyright 2018 The Trustees of Indiana University - Developed for Open Science Grid</p>
</footer>


</div><!--container-fluid-->
<script>
//used by searchbox
function parseValue(value) {
    var obj = new Object();
    var tokens = value.split("\t");
    obj.str = tokens[0];
    obj.count = tokens[1];
    return obj;
}

$(function() {
    //bootstrap-2.0.4 stuff
    $(".alert-message").alert();
    $(".dropdown-toggle").dropdown();
    $("span[rel='tooltip']").tooltip();
    $("a[rel=popover]").popover();

    //activate menu that user is currently on
    $("#menu_navigator").addClass("active"); 
    $("#submenu_").addClass("active"); 

    //translate zend validation error message to bootstrap
    $(".errors").addClass("alert").addClass("alert-error");

    //enable autocomplete for search box
    $("#search").autocomplete({
        source: function( request, response ) {
            $.ajax({
                url: "search/autocomplete",
                dataType: "text",
                data: {
                    //featureClass: "P",
                    //style: "full",
                    //maxRows: 12,
                    //name_startsWith: request.term
                    q: request.term
                },
                success: function( data ) {
                    response( $.map( data.split("\n"), function( item ) {
                        if(item == "") return null;
                        return {
                            value: item
                        }
                    }));
                }
            });
        },
        select: function(event, ui) {
            document.location = "search?q="+ui.item.value;
        }
    });
    
});
</script>


</body>
