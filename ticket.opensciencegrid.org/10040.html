<!DOCTYPE html>
<html lang="en">
  <head>
  <base href="">
    <title>[10040] BU_ATLAS_Tier2 did not report to gratia</title>    <meta charset="utf-8" />
    <meta name="verify-v1" content="na5IcAJsZVOfEkboRxuIiZ1zpZgnZiWra+nKcS7nA/o=" />
    <meta name="google-site-verification" content="DLrk3ft4s8b-S2TloLCL2LD_t6wcTjgSluf5pmiu2kA" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />
    <link href="https://ticket.opensciencegrid.org/rss" rel="alternate" type="application/rss+xml" title="GOC Ticket Update feed" />

    <style type="text/css">
      body {
        padding-top: 50px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
     #search {
            width: 300px;
     }

    </style>

<script src="https://code.jquery.com/jquery-3.0.0.js"></script>
<script src="https://code.jquery.com/jquery-migrate-3.0.1.js"></script>

   <link href="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet"/>
    <script src="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/js/bootstrap.min.js"></script>

    <link href="https://netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"/>
    <link href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/themes/smoothness/jquery-ui.min.css" rel="stylesheet"/>
 <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>


    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/js/select2.min.js"></script>

    <link href="css/ticket.css" rel="stylesheet" />
    <script src="lib/jquery.cookie.js"></script>

    <link href="images/tag_orange.png" rel="icon" type="image/png"/>
    <script src='https://www.google.com/recaptcha/api.js'></script>
  </head>

  <body>
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>

            <a class="brand" style="padding: 6px 0px 0px 6px;" href="http://opensciencegrid.org"><img src="images/osglogo.40x30.png"/></a>
            <ul class="nav">
                <li class="dropdown"><a href="https://ticket.opensciencegrid.org/#" class="dropdown-toggle" data-toggle="dropdown">GOC Ticket <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    <li><a href="https://my.opensciencegrid.org">MyOSG</a></li>
                    <li><a href="https://oim.opensciencegrid.org">OIM</a></li>
                    <li class="active"><a href="https://ticket.opensciencegrid.org/index">Ticket</a></li>
	<li class="divider"></li>
	<li><a href="http://repo.grid.iu.edu">Repo</a></li>
	<li class="divider"></li>
	<li><a href="http://blogs.grid.iu.edu">Blog</a></li>
                    <li><a href="http://display.grid.iu.edu">Display</a></li>
                    <li><a href="http://osggoc.blogspot.com/">News</a></li>
                    </ul>
                </li>
            </ul>
            <ul class="nav pull-right">
                <li><a href="https://ticket.opensciencegrid.org/sso/">Login</a></li>            </ul>

            <div class="nav-collapse">
                <ul class="nav">
			 <li id="menu_submit"><a href="https://ticket.opensciencegrid.org/submit">Submit</a></li><li id="menu_view" class="dropdown"><a href="https://ticket.opensciencegrid.org/\#" class="dropdown-toggle" data-toggle="dropdown">View <b class="caret"></b></a><ul class="dropdown-menu"><li id="submenu_listopen"><a href="https://ticket.opensciencegrid.org/list/open">Open Tickets</a></li><li id="submenu_listrecentclose"><a href="https://ticket.opensciencegrid.org/list/recentclose">Recently Closed Tickets</a></li><li class="divider"></li><li id="submenu_alltickets"><a href="https://ticket.opensciencegrid.org/search?q=&amp;sort=id">All Tickets</a></li></ul></li>                </ul>

                <form class="navbar-search pull-right" action="https://ticket.opensciencegrid.org/viewer">
                    <input id="search" type="text" name="id" class="search-query span2" placeholder="Search Ticket" value=""/>
                </form>
            </div>
        </div>
      </div>
    </div>

<script type='text/javascript' src='lib/jquery.timeago.js'></script>
<script type='text/javascript' src='lib/byte2size.js'></script>
<style>
#updates .toolbar {
position: relative;
margin-top: 0px;
top: -10px;
font-weight: normal;
}
#updates a.anchor {
position: relative;
top: -50px;
}
#updates .selected pre {
animation:selected 2s;
animation-iteration-count: 2;
animation-direction: alternate;
-webkit-animation:selected 2s; 
-webkit-animation-iteration-count: 2;
-webkit-animation-direction: alternate;
box-shadow: inset 1px 1px 20px #9ad;
border: 1px solid #9ab;
margin: 5px 0px;
padding-left: 10px;
}
@keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ab;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
@-webkit-keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ad;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
#updates pre {
background-color: inherit;
line-height: 15px;
padding: 5px;
}
#updates .header {
color: #999;
}
#updates .update_history pre {
background-color: #eee;
color: #666;
font-size: 85%;
}
#updates .clickable {
cursor: pointer;
}
#updates .clickable:hover {
color: #D98719;
}
#updates .meta_information pre {
background-color: #fed;
}
#similar_tickets {
max-height: 300px;
overflow-y: auto;
pointer-events: none;
padding: 5px;
background-color: #f4f4f4;
}
.btn-toolbar {
margin-bottom: 0;
height: 30px;
}
#peers {
position: fixed;
bottom: 0px;
right: 0px;
z-index: 100;
list-style: none;
padding: 5px 0px 0px 5px;
margin: 0px;
background-color: white;
box-shadow: 0px 0px 10px white;
}
#peers li {
background-color: #ccc;
color: #000;
display: inline-block;
padding: 5px 10px;
margin-right: 5px;
position: relative;
}
/*
#peers li:hover {
background-color: #999;
cursor: pointer;
}
*/
#peers span.ip {
padding-left: 5px;
color: #666;
}
#peers .new {
bottom: -30px;
}
/*
#peers .me {
background-color: red;
}
*/
</style>

<div class="container-fluid">
<ul id="peers"></ul>
<div class="alert alert-danger"><a class="close" href="https://ticket.opensciencegrid.org/#" data-dismiss="alert">&times;</a>By the end of May 2018, the ticketing system at https://ticket.opensciencegrid.org will be retired and support will be provided at https://support.opensciencegrid.org. Throughout this transition the support email (help@opensciencegrid.org) will be available as a point of contact.<br><br>                                                   
                                                                                                                                                                                   
Please see the service migration page for details: https://opensciencegrid.github.io/technology/policy/service-migrations-spring-2018/#ticket</div><div id="presence" class="pull-right"></div><div class="ticketgui"><script type="text/javascript" src="lib/checktab.js"></script>

<script>
var expanded = false;
function expand_description() {
    var desc = $(".description");
    if(!expanded) {
        expanded = true;
        //expand to minheight
        var min = 250;
        if(desc.height() < min) {
            desc.animate({height: min}, 200);
        }
    }
}

$(document).ready(function() {
    $("input[name='nad']").datepicker({
        dateFormat: 'yy-mm-dd'
    });
});

</script>



<style>
.form-horizontal .control-label {
padding-top: inherit;
font-size:90%;
color:#666;
}
label {
margin-bottom: 0px;
}
.controls {
line-height: 18px;
}
</style>
<form class="form-horizontal" action="https://ticket.opensciencegrid.org/viewer/updatebasic?id=10040" method="post">
<div class="page-header">
    <h3><span class="muted">10040</span> / BU_ATLAS_Tier2 did not report to gratia</h3>
</div>

<div class="row-fluid">
<div class="span5">
    <legend>Contact</legend>
    <div class="control-group">
        <label class="control-label">Full Name</label>
        <div class="controls">Karthik Arunachalam</div>
    </div>
    <div class="control-group">
        <label class="control-label">Email</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">Phone</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">CC</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>

    <legend>Details</legend>
    <div class="control-group"><label class="control-label">Resource Name</label><div class="controls">BU_ATLAS_Tier2</div></div><div class="control-group"><label class="control-label">Submitted Via</label><div class="controls">GOC Ticket/resource</div></div><div class="control-group"><label class="control-label">Submitter</label><div class="controls">Karthik Arunachalam</div></div>
    <div class="control-group">
        <label class="control-label">Ticket Type</label>
        <div class="controls">Problem/Request</div>
    </div>
    <div class="control-group">
        <label class="control-label">Priority</label>
        <div class="controls">Normal</div>
    </div>
    <div class="control-group">
        <label class="control-label">Status</label>
        <div class="controls">
Closed</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action</label>
        <div class="controls">ENG Action</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action Deadline</label>
        <div class="controls flag_red">2011-05-16</div>
    </div>

</div><!--span-->
<div class="span7">
    <legend>Assignees</legend>
    <div class="assignee" style="width: 60%">OSG RA <span class="muted"> / OSG GOC Support Team</span></div><div class="assignee" style="width: 60%">USATLAS (BNL Prod)&nbsp;<a target="_blank" href="https://rt.racf.bnl.gov/rt/Ticket/Display.html?id=19523">19523</a> <span class="muted"> / Ticket Exchange</span></div>    <br>

    <legend>Assignees</legend>
    TODO
    <br>

    <style>
legend.noborder {
border-bottom: none;
}
</style>

<div id="attachment-list"/>
<script>
$(function () {
    var first = true;
    $.getJSON("attachment/list/10040", function (files) {
        //console.dir(files);
        var html = "<table class=\"table table-condensed\">";
        $(files).each(function() {
            if(first) {
                first = false;
                html += "<legend class=\"noborder\">Attachmenets</legend>";
            }
            html += "<tr class=\"attachment\">";
            html += "<td><img src="\&quot;&quot;+this.thumbnail_url+&quot;\&quot;/"></td>";
            html += "<td><a href="\&quot;&quot;+this.url+&quot;\&quot;" target=\"_blank\">"+this.name+"</a></td>";
            html += "<td>"+bytesToSize(this.size, 1)+"</td>";
            html += "</tr>";
        });
        html += "</table>";
        $("#attachment-list").html(html);
    });
});

function download(url) {
    window.open(url, "_blank");
}
</script>


</div><!--span-->
</div><!--row-fluid-->


</form>

</div>
<div id="updates" style="clear: both;">
    <legend>Past Updates
    <div class="btn-toolbar pull-right toolbar">
        <div class="btn-group">
                <a class="btn btn-small" href="https://ticket.opensciencegrid.org/10040?sort=up&amp;"><i class="icon-arrow-up"></i> Sort</a>

        
        <a class="btn btn-small" href="https://ticket.opensciencegrid.org/10040?expandall=true&amp;">Expand Descriptions</a>        <a class="btn btn-small" target="_blank" href="mailto:osg@tick.globalnoc.iu.edu?subject=Open%20Science%20Grid%3A%20BU_ATLAS_Tier2%20did%20not%20report%20to%20gratia%20ISSUE%3D10040%20PROJ%3D71"><i class="icon-envelope"></i> Update w/Email</a>
        </div>
    </div><!--btn-toolbar-->
    </legend>

    <div class='update_description'><i onclick="document.location='10040#1305555039'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-05-16T14:10:39+00:00">May 16, 2011 02:10 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1305555039">&nbsp;</a></div><pre>Resolved. S.Y.
-- by youssef@.... at Mon May 16 14&#58;10&#58;21 UTC 2011</pre></div><div class='update_description'><i onclick="document.location='10040#1305239407'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-05-12T22:30:07+00:00">May 12, 2011 10:30 PM UTC</time> by <b>Karthik Arunachalam</b><a class="anchor" name="1305239407">&nbsp;</a></div><pre>Hi Saul,

About you not getting the report for BU_ATLAS_Tier2, from
<a href='http&#58;//tinyurl.com/6z9kz3s' target='_blank' rel='nofollow'>http&#58;//tinyurl.com/6z9kz3s</a>, I see that under &#34;Resource Report Contact&#34;
only &#34;Augustine Abaravichyus&#34; is listed. The solution is that you
should go to <a href='https&#58;//oim.grid.iu.edu' target='_blank' rel='nofollow'>https&#58;//oim.grid.iu.edu</a> and add yourself as a &#34;Resource
Report Contact&#34; for BU_ATLAS_Tier2. I see that you are listed as a Report
contact for HU_ATLAS_Tier2 (the reason you are receiving the report for
that site).

About the nature of the content and format of the report, that is
something that needs to be looked into (wish list for future report
modifications). But for now, you could go to
<a href='http&#58;//gratia-osg-prod-reports.opensciencegrid.org/gratia-reporting/' target='_blank' rel='nofollow'>http&#58;//gratia-osg-prod-reports.opensciencegrid.org/gratia-reporting/</a> and
click on &#34;Daily usage by site&#34; (on the left hand side menu) and get the
daily site statistics. Also we get alerts from the Graitia APEL interface
if a site is missing data for more than 2 days.

-Karthik

On Thu, 12 May 2011, Open Science Grid FootPrints wrote&#58;

<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='10040#1305237334'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-05-12T21:55:34+00:00">May 12, 2011 09:55 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1305237334">&nbsp;</a></div><pre>Hi Karthik,

Sorry to let this slip for a while. I think it&#39;s OK to ignore those three days
in February, but since we don&#39;t know why there were missing days this has
probably happened before and may repeat, so I would like to watch out for that
and track it down when it happens again.

I was thinking that I could watch for this from email feedback that I&#39;m getting
from OSG, but I&#39;m a little bit confused about this. I get reports emailed to me
like the one below, but only for HU_ATLAS_Tier2 not for the BU site. Shouldn&#39;t
I be getting a BU report as well? Also, these reports show sums of CPU times
etc. for the week. It would be very handy for me (and probably others) if this
email had a table of #jobs and CPU time for each day of the week, so that if
there is a day missing it will be obvious.

- Saul

On Thu May 12 15&#58;16&#58;10 2011, osg-goc-rest wrote&#58;
<font color='#7F7E6F'>&#62; We have provided the guidelines to BU about how to try restoring the</font>
<font color='#7F7E6F'>&#62; missing data. But if this isn&#39;t critical to BU (which seems to be the</font>
<font color='#7F7E6F'>&#62; case) and if there are no objections, we could close this case.</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; -Karthik</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; On Thu, 12 May 2011, Open Science Grid FootPrints wrote&#58;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; &#62; [Duplicate message snipped]</font>
<font color='#7F7E6F'>&#62; -- by Karthik Arunachalam at Thu May 12 19&#58;15&#58;08 UTC 2011</font>
-- by youssef@.... at Thu May 12 21&#58;55&#58;25 UTC 2011</pre></div><div class='update_description'><i onclick="document.location='10040#1305227708'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-05-12T19:15:08+00:00">May 12, 2011 07:15 PM UTC</time> by <b>Karthik Arunachalam</b><a class="anchor" name="1305227708">&nbsp;</a></div><pre>We have provided the guidelines to BU about how to try restoring the
missing data. But if this isn&#39;t critical to BU (which seems to be the
case) and if there are no objections, we could close this case.

-Karthik

On Thu, 12 May 2011, Open Science Grid FootPrints wrote&#58;

<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='10040#1305226364'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-05-12T18:52:44+00:00">May 12, 2011 06:52 PM UTC</time> by <b>Christopher Pipes</b><a class="anchor" name="1305226364">&nbsp;</a></div><pre>Are there any updates on this issue?

Please submit problems, requests, and questions at&#58;
<a href='https&#58;//ticket.grid.iu.edu/goc/open' target='_blank' rel='nofollow'>https&#58;//ticket.grid.iu.edu/goc/open</a>

Thank You,
OSG Grid Operations Center
goc@...., 317-278-9699
Visit the Open Science Grid Operations Page&#58;
<a href='http&#58;//osggoc.blogspot.com/' target='_blank' rel='nofollow'>http&#58;//osggoc.blogspot.com/</a></pre></div><div class='update_description'><i onclick="document.location='10040#1304339662'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-05-02T12:34:22+00:00">May 2, 2011 12:34 PM UTC</time> by <b>echism</b><a class="anchor" name="1304339662">&nbsp;</a></div><pre>Saul,

Please update this ticket.

Thank you,
Elizabeth</pre></div><div class='update_description'><i onclick="document.location='10040#1303506667'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-04-22T21:11:07+00:00">Apr 22, 2011 09:11 PM UTC</time> by <b>Karthik Arunachalam</b><a class="anchor" name="1303506667">&nbsp;</a></div><pre>Hi,

Philippe had provided the guidelines to extract the missing data
and push them to the collector.

Saul, would you or someone else at BU be
able to work on this? If you think that isn&#39;t critical and you are ok with
the missing data, we could close this ticket.

-Karthik

On Fri, 22 Apr 2011, Open Science Grid FootPrints wrote&#58;

<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='10040#1303499410'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-04-22T19:10:10+00:00">Apr 22, 2011 07:10 PM UTC</time> by <b>echism</b><a class="anchor" name="1303499410">&nbsp;</a></div><pre>Are there any updates on this?

Thank you,
Elizabeth</pre></div><div class='update_description'><i onclick="document.location='10040#1302635256'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-04-12T19:07:36+00:00">Apr 12, 2011 07:07 PM UTC</time> by <b>echism</b><a class="anchor" name="1302635256">&nbsp;</a></div><pre>Are there any updates on this?

Thank you,
Elizabeth</pre></div><div class='update_description'><i onclick="document.location='10040#1301947328'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-04-04T20:02:08+00:00">Apr 4, 2011 08:02 PM UTC</time> by <b>Karthik Arunachalam</b><a class="anchor" name="1301947328">&nbsp;</a></div><pre><font color='#7F7E6F'>&#62; But indeed, once the data is known to be in the server, one could kill</font>
<font color='#7F7E6F'>&#62; the probe processes, (after doing a vdt-control off of the probe) and</font>
<font color='#7F7E6F'>&#62; reset the urCollectorBuffer.pbs</font>

I didn&#39;t realize that killing the process midway was safe. But it is good
to get your confirmation!

Saul, could you please try rewinding the probe (and fast forwarding it to
the current period once we know missing data has been restored)? This
should restore the missing data.

-Karthik

On Mon, 4 Apr 2011, Open Science Grid FootPrints wrote&#58;

<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='10040#1301944626'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-04-04T19:17:06+00:00">Apr 4, 2011 07:17 PM UTC</time> by <b>Philippe Canal</b><a class="anchor" name="1301944626">&nbsp;</a></div><pre><font color='#7F7E6F'>&#62; I guess it would be safer to wait until the probe is not running and then</font>
<font color='#7F7E6F'>&#62; turn it off by using the vdt-control --off of the probe and then do a --on</font>
<font color='#7F7E6F'>&#62; after changing the $VDT_LOCATION/gratia/var/tmp/urCollectorBuffer.pbs</font>
<font color='#7F7E6F'>&#62; file.</font>
Yes.
<font color='#7F7E6F'>&#62; Is it possible that we could cut down considerably on the duplicate data</font>
<font color='#7F7E6F'>&#62; by saving the current contents of urCollectorBuffer.pbs (make a backup)</font>
<font color='#7F7E6F'>&#62; and then restoring it once we know that the data for 2/26 to 2/28 has been</font>
<font color='#7F7E6F'>&#62; sent to Gratia?</font>
Yes.

<font color='#7F7E6F'>&#62; Is that possible or may be not, since the</font>
<font color='#7F7E6F'>&#62; probe will keep running as long as it has data to push over to gratia and</font>
<font color='#7F7E6F'>&#62; that means we don&#39;t want to change that file when the probe is running? or</font>
<font color='#7F7E6F'>&#62; could we stop the probe in the middle by doing a vdt-control -off of the</font>
<font color='#7F7E6F'>&#62; probe?</font>
I don&#39;t know if vdt-control -off will kill the running process (I doubt it does).
But indeed, once the data is known to be in the server, one could kill the
probe processes, (after doing a vdt-control off) and reset the urCollectorBuffer.pbs

Cheers,
Philippe.

On 4/4/11 2&#58;05 PM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='10040#1301943910'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-04-04T19:05:10+00:00">Apr 4, 2011 07:05 PM UTC</time> by <b>Karthik Arunachalam</b><a class="anchor" name="1301943910">&nbsp;</a></div><pre>Thanks Philippe for providing the detailed step by step instructions. As
you suggest, alternative 1 (rewinding the probe) sounds like the simpler
solution. I hope there is no risk of trying this procedure. I have these
questions/comments&#58;

<font color='#7F7E6F'>&#62; make sure that the probe is not running (and not about to run).</font>

I guess it would be safer to wait until the probe is not running and then
turn it off by using the vdt-control --off of the probe and then do a --on
after changing the $VDT_LOCATION/gratia/var/tmp/urCollectorBuffer.pbs
file.

<font color='#7F7E6F'>&#62; This will result in duplicate record being</font>
<font color='#7F7E6F'>&#62; sent up to the collector, but those will be thrown out by the collector.</font>
<font color='#7F7E6F'>&#62; (It will take a little while to process the data).</font>

Is it possible that we could cut down considerably on the duplicate data
by saving the current contents of urCollectorBuffer.pbs (make a backup)
and then restoring it once we know that the data for 2/26 to 2/28 has been
sent to Gratia? Is that possible or may be not, since the
probe will keep running as long as it has data to push over to gratia and
that means we don&#39;t want to change that file when the probe is running? or
could we stop the probe in the middle by doing a vdt-control -off of the
probe?

Saul, could you try this at BU&#39;s end. Make sure that you do a backup of
$VDT_LOCATION/gratia/var/tmp/urCollectorBuffer.pbs before you change it!

Thanks,
Karthik

On Mon, 4 Apr 2011, Open Science Grid FootPrints wrote&#58;

<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='10040#1301941567'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-04-04T18:26:07+00:00">Apr 4, 2011 06:26 PM UTC</time> by <b>Philippe Canal</b><a class="anchor" name="1301941567">&nbsp;</a></div><pre>Hi,

In the case of PBS and since the missing data is not that long ago,
the easiest is to rewind the probe.  To do locate the file

$VDT_LOCATION/gratia/var/tmp/urCollectorBuffer.pbs

Its content would be something like&#58;

6593816.steele-adm.rcac.purdue.edu&#58;1280381382

The first number is the local job-id of the last job processed
and the 2nd number is the &#39;epoch&#39; number.   So to
reset to before 2/26, you need to find a local job id of
job that finish shortly before 2/26 (i.e. sometime mid-day 2/25 would do)
and get the value of the epoch to around the same time
(for example 1298630000).

Once you have those 2 numbers, make sure that the probe is not
running (and not about to run).   Enter the two number in
the urCollectorBuffer.pbs.

The next time the probe runs, it will start to reprocess the data starting
from the job you selected.   This will result in duplicate record being
sent up to the collector, but those will be thrown out by the collector.
(It will take a little while to process the data).

The alternative is to&#58;
a) extract the entries corresponding to the missing jobs to separate
(but similarly named) accounting file
b) tweak the urCollector.conf to change pbsAcctLogDir to point
to the location the &#39;small&#39; accounting file
c) tweak the ProbeConfig to have the WorkingFolder points to
a new temporary area (to not use nor squash   $VDT_LOCATION/gratia/var/tmp/urCollectorBuffer.pbs)
d) run the probe
<div id='show_890768667' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_890768667'>e) revert b and c (if done in place).

Cheers,
Philippe.

On 4/2/11 11&#58;27 AM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font>
</div><script type='text/javascript'>
        $('#show_890768667').click(function() {
            $('#detail_890768667').slideDown("normal");
            $('#show_890768667').hide();
            $('#hide_890768667').show();
        });
        $('#hide_890768667').click(function() {
            $('#detail_890768667').slideUp();
            $('#hide_890768667').hide();
            $('#show_890768667').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='10040#1301938326'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-04-04T17:32:06+00:00">Apr 4, 2011 05:32 PM UTC</time> by <b>Karthik Arunachalam</b><a class="anchor" name="1301938326">&nbsp;</a></div><pre><font color='#7F7E6F'>&#62; PBS. We do have pbs logs going back to 2008.</font>

We have the PBS log file (sample file attached) for the missing days. The
steps are&#58;

1) Extract the needed accounting data from the PBS log file
2) push data the gratia collector/db
3) push data to the WLCG

Philippe, how do we perform the 1st two steps? I guess it would involve
using some combination of the gratia scripts? But I don&#39;t have the
specific details. Could you please share provide your guidance? Also I
guess it would be easier to perform this from the site itself, since it
would have the correct software/environment to
do so.

Once the 1st two steps are accomplished, I could (with John&#39;s help) figure
out the 3rd step of how to retroactively push the data to WLCG.

Thanks,
Karthik

On Sat, 2 Apr 2011, Open Science Grid FootPrints wrote&#58;

<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='10040#1301761675'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-04-02T16:27:55+00:00">Apr 2, 2011 04:27 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1301761675">&nbsp;</a></div><pre>On Fri Apr 01 15&#58;51&#58;10 2011, osg-goc-rest wrote&#58;
<font color='#7F7E6F'>&#62; &#62; Yes, there are ways, depending on which Batch system BU_ATLAS_Tier2</font>
<font color='#7F7E6F'>&#62; uses.</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; That is good to know. Saul, what batch system does BU_ATLAS_Tier2 use?</font>

Hi Karthik;

PBS. We do have pbs logs going back to 2008. I&#39;ve put them here

<a href='http&#58;//atlas.bu.edu/gpfs1/karthik' target='_blank' rel='nofollow'>http&#58;//atlas.bu.edu/gpfs1/karthik</a>

in case you want to grab them an process them yourself.

- Saul

<font color='#7F7E6F'>&#62; Philippe, is there a documentation to refer to for this? If not what</font>
<font color='#7F7E6F'>&#62; would</font>
<font color='#7F7E6F'>&#62; be the best way to go about doing this? My best guess is that do</font>
<font color='#7F7E6F'>&#62; manually</font>
<font color='#7F7E6F'>&#62; what gratia would have done automatically for this time period. But</font>
<font color='#7F7E6F'>&#62; more</font>
<font color='#7F7E6F'>&#62; specific instructions would be helpful.</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; Thanks,</font>
<font color='#7F7E6F'>&#62; Karthik</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; Saul, which batch system does BU_ATLAS_Tier2 use?</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; On Fri, 1 Apr 2011, Open Science Grid FootPrints wrote&#58;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; &#62; [Duplicate message snipped]</font>
<font color='#7F7E6F'>&#62; -- by Karthik Arunachalam at Fri Apr 01 19&#58;50&#58;07 UTC 2011</font>
-- by youssef@.... at Sat Apr 02 16&#58;27&#58;47 UTC 2011</pre></div><div class='update_description'><i onclick="document.location='10040#1301687407'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-04-01T19:50:07+00:00">Apr 1, 2011 07:50 PM UTC</time> by <b>Karthik Arunachalam</b><a class="anchor" name="1301687407">&nbsp;</a></div><pre><font color='#7F7E6F'>&#62; Yes, there are ways, depending on which Batch system BU_ATLAS_Tier2 uses.</font>

That is good to know. Saul, what batch system does BU_ATLAS_Tier2 use?
Philippe, is there a documentation to refer to for this? If not what would
be the best way to go about doing this? My best guess is that do manually
what gratia would have done automatically for this time period. But more
specific instructions would be helpful.

Thanks,
Karthik

Saul, which batch system does BU_ATLAS_Tier2 use?

On Fri, 1 Apr 2011, Open Science Grid FootPrints wrote&#58;

<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='10040#1301686326'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-04-01T19:32:06+00:00">Apr 1, 2011 07:32 PM UTC</time> by <b>Philippe Canal</b><a class="anchor" name="1301686326">&nbsp;</a></div><pre><font color='#7F7E6F'>&#62;  - Would the gratia log files for this time period be available somewhere else?</font>

It is unlikely unless the local administrators are taking backups of the area and still have those backups.

<font color='#7F7E6F'>&#62; - If there are no leads, is it possible to retroactively extract the data (from panda or from the site itself) and put it to the</font>
collectof for these three days?

Yes, there are ways, depending on which Batch system BU_ATLAS_Tier2 uses.

Cheers,
Philippe.

On 4/1/11 12&#58;48 PM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='10040#1301680079'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-04-01T17:47:59+00:00">Apr 1, 2011 05:47 PM UTC</time><a class="anchor" name="1301680079">&nbsp;</a></div><pre>I am including Philippe, John & Brian to see if they any suggestions. BU_ATLAS_Tier2 is missing data for 2/26 to 2/28 and there doesn&#39;t seem to be good leads on figuring out why. Looks like the log files are only available from Mar 1st. The questions are&#58;

- Would the gratia log files for this time period be available somewhere else?
- If not, how else could we troubleshoot this issue?
- If there are no leads, is it possible to retroactively extract the data (from panda or from the site itself) and put it to the collectof for these three days?

Thanks,
Karthik

-- by Karthik Arunachalam</pre></div><div class='update_description'><i onclick="document.location='10040#1301618056'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-04-01T00:34:16+00:00">Apr 1, 2011 12:34 AM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1301618056">&nbsp;</a></div><pre>Hi Elizabeth,

Sorry to be slow responding to this. We&#39;re very busy.

So as to 2/26, 2/27 and 2/28 2011, I can confirm that we were up and running
for all three days
(see table below showing panda running and wall times), so there is definitely
something wrong.

Our logs only go back to March 1, 2011 - I don&#39;t have Gratia logs for those
three days. I don&#39;t see any problems in the logs that I have except for
repeated errors that look like the following (from 2011-03-25)&#58;

===================
15&#58;41&#58;03 EDT Gratia&#58; Processing bundle file&#58;
/software/osg-1.2.6/gratia/var/tmp/gratiafiles/subdir.pbs_atlas.bu.edu_gratia-osg-prod.opensciencegrid.org_80/outbox/r.15738.pbs_atlas.bu.edu_gratia-osg-prod.opensciencegrid.org_80.gratia.xml__QUIMh3233515&#58;41&#58;03
EDT Gratia&#58; Failed to send xml to web service due to an error of type
&#34;exceptions.IOError&#34;&#58; 15&#58;41&#58;03 EDT Gratia&#58; Traceback (most recent call last)&#58;
File &#34;/software/osg-1.2.6/gratia/probe/common/Gratia.py&#34;, line 1005, in
__sendUsageXML raise IOError # Kick out to except&#58; clauseIOError 15&#58;41&#58;03 EDT
Gratia&#58; Response indicates failure, the following files will not be deleted&#58;15&#58;41&#58;03
EDT Gratia&#58;
/software/osg-1.2.6/gratia/var/tmp/gratiafiles/subdir.pbs_atlas.bu.edu_gratia-osg-prod.opensciencegrid.org_80/outbox/r.15738.pbs_atlas.bu.edu_gratia-osg-prod.opensciencegrid.org_80.gratia.xml__nPrJO31432========================
Here&#39;s a table of part of our cpu and wall time consumption in February for
atlas&#58;

day--------------panda.cputime------panda.walltime2011-01-31...299 days
19&#58;23&#58;28...404 days 05&#58;29&#58;152011-02-01..1766 days 04&#58;03&#58;16..2482 days 00&#58;21&#58;442011-02-02..1722
days 11&#58;29&#58;07..2523 days 23&#58;50&#58;222011-02-03..1665 days 06&#58;29&#58;51..2366 days
11&#58;20&#58;062011-02-04..1337 days 21&#58;25&#58;56..1682 days 04&#58;50&#58;042011-02-05..1336 days
01&#58;55&#58;56..1790 days 00&#58;59&#58;262011-02-06..1106 days 19&#58;32&#58;23..1510 days 09&#58;49&#58;432011-02-07..2138
days 08&#58;03&#58;02..2874 days 17&#58;39&#58;412011-02-08..1533 days 07&#58;11&#58;43..2006 days
22&#58;41&#58;032011-02-09...857 days 21&#58;18&#58;53..1170 days 16&#58;25&#58;082011-02-10..3273 days
23&#58;50&#58;44..4106 days 13&#58;16&#58;272011-02-11..2174 days 07&#58;58&#58;23..3116 days 03&#58;45&#58;472011-02-12..1274
days 16&#58;22&#58;40..1480 days 04&#58;55&#58;072011-02-13...831 days 12&#58;20&#58;28...929 days
<div id='show_633735991' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_633735991'>13&#58;27&#58;482011-02-14..1632 days 12&#58;12&#58;08..1900 days 14&#58;23&#58;512011-02-15..1313 days
21&#58;52&#58;40..1779 days 15&#58;13&#58;502011-02-16..1493 days 16&#58;28&#58;32..1755 days 18&#58;29&#58;452011-02-17..2937
days 10&#58;43&#58;20..3699 days 20&#58;25&#58;112011-02-18..2252 days 01&#58;28&#58;40..2721 days
14&#58;35&#58;242011-02-19..1382 days 11&#58;31&#58;32..1619 days 01&#58;57&#58;282011-02-20...389 days
11&#58;48&#58;56...466 days 10&#58;03&#58;562011-02-21...783 days 11&#58;49&#58;37..1018 days 23&#58;00&#58;012011-02-22...911
days 18&#58;39&#58;41..1399 days 12&#58;54&#58;472011-02-23..2068 days 18&#58;04&#58;09..2781 days
21&#58;31&#58;362011-02-24..1125 days 03&#58;45&#58;36..1556 days 13&#58;49&#58;412011-02-25..1382 days
11&#58;11&#58;02..1974 days 22&#58;16&#58;542011-02-26...631 days 21&#58;52&#58;13...762 days 19&#58;15&#58;042011-02-27...178
days 00&#58;21&#58;51...595 days 22&#58;28&#58;392011-02-28...498 days 02&#58;13&#58;44...662 days
03&#58;51&#58;57 If it helps, we&#39;re planning to upgrade to a new OSG release pretty
soon.

- Saul

On Tue Mar 29 15&#58;17&#58;09 2011, osg-goc-rest wrote&#58;
<font color='#7F7E6F'>&#62; Saul,</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; Are there any updates on this?</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; Thank you,</font>
<font color='#7F7E6F'>&#62; Elizabeth</font>
<font color='#7F7E6F'>&#62; -- by Elizabeth Chism at Tue Mar 29 19&#58;16&#58;23 UTC 2011</font>
-- by youssef@.... at Fri Apr 01 00&#58;34&#58;07 UTC 2011
</div><script type='text/javascript'>
        $('#show_633735991').click(function() {
            $('#detail_633735991').slideDown("normal");
            $('#show_633735991').hide();
            $('#hide_633735991').show();
        });
        $('#hide_633735991').click(function() {
            $('#detail_633735991').slideUp();
            $('#hide_633735991').hide();
            $('#show_633735991').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='10040#1301426183'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-03-29T19:16:23+00:00">Mar 29, 2011 07:16 PM UTC</time> by <b>echism</b><a class="anchor" name="1301426183">&nbsp;</a></div><pre>Saul,

Are there any updates on this?

Thank you,
Elizabeth</pre></div><div class='update_description'><i onclick="document.location='10040#1300816532'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-03-22T17:55:32+00:00">Mar 22, 2011 05:55 PM UTC</time> by <b>echism</b><a class="anchor" name="1300816532">&nbsp;</a></div><pre>Saul,

Please let us know if you need help. If not, please send an update.

Thank you,
Elizabeth</pre></div><div class='update_description'><i onclick="document.location='10040#1299605347'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-03-08T17:29:07+00:00">Mar 8, 2011 05:29 PM UTC</time> by <b>Karthik Arunachalam</b><a class="anchor" name="1299605347">&nbsp;</a></div><pre>Hi Saul,

Looking at the gratia log files would be a good starting point.

-Karthik

On Tue, 8 Mar 2011, Open Science Grid FootPrints wrote&#58;

<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='10040#1299596510'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-03-08T15:01:50+00:00">Mar 8, 2011 03:01 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1299596510">&nbsp;</a></div><pre>Hi Karthik,

Thanks very much for paying attention to this.

On Wed Mar 02 12&#58;57&#58;07 2011, osg-goc-rest wrote&#58;
<font color='#7F7E6F'>&#62; [by Karthik Arunachalam]</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; BU_ATLAS_Tier2 did not report to Gratia for the following days&#58;</font>
<font color='#7F7E6F'>&#62; [&#39;2011-02-26&#39;, &#39;2011-02-27&#39;, &#39;2011-02-28&#39;]</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; You could verify this by looking at the chart at</font>
<font color='#7F7E6F'>&#62; <a href='http&#58;//tinyurl.com/4wh686b' target='_blank' rel='nofollow'>http&#58;//tinyurl.com/4wh686b</a></font>
<font color='#7F7E6F'>&#62;</font>

Verified.

<font color='#7F7E6F'>&#62; This is affecting the data that is being reported to WLCG for MOU</font>
<font color='#7F7E6F'>&#62; purposes. We want to clarify if this is part of a planned downtime and</font>
<font color='#7F7E6F'>&#62; not</font>
<font color='#7F7E6F'>&#62; a real problem before it gets too difficult to catch up.</font>
<font color='#7F7E6F'>&#62;</font>

We haven&#39;t had any downtime, so there&#39;s apparently a real problem. I&#39;m at a
meeting, right now, but we will investigate. If you have any thoughts about
what to look for, please let me know.

- Saul

<font color='#7F7E6F'>&#62; The Gratia-APEL interface checks for sites not reporting any data in a</font>
<font color='#7F7E6F'>&#62; given day and validates that against MyOsg planned downtime before</font>
<font color='#7F7E6F'>&#62; raising</font>
<font color='#7F7E6F'>&#62; a warning flag.</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; So, if this is part of the planned downtime period, it would help if</font>
<font color='#7F7E6F'>&#62; OIM is updated for these days. If not, then we need to</font>
<div id='show_464774645' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_464774645'><font color='#7F7E6F'>&#62; troubleshoot the problem with Gratia reporting.</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; [META Information]</font>
<font color='#7F7E6F'>&#62; Assignment Reason&#58; possible assignees at this hour (13)&#58; adeximo echism</font>
<font color='#7F7E6F'>&#62; kagross cpipes. doubling the ticket count for chris - since he works</font>
<font color='#7F7E6F'>&#62; half time. echism has the least amount of tickets.</font>
<font color='#7F7E6F'>&#62; adeximo has 21 tickets. echism has 18 tickets. kagross has 18 tickets.</font>
<font color='#7F7E6F'>&#62; cpipes has 9 tickets.</font>
<font color='#7F7E6F'>&#62; Submitter DN&#58; /DC=org/DC=doegrids/OU=People/CN=Karthik Arunachalam</font>
<font color='#7F7E6F'>&#62; 265532Resource on which user is having this issue&#58; BU_ATLAS_Tier2(8)</font>
<font color='#7F7E6F'>&#62; Selecting ATLAS(FP name&#58; USATLAS) for Destination VO since it has the</font>
<font color='#7F7E6F'>&#62; highest resource ownership.</font>
<font color='#7F7E6F'>&#62; Assigned support center&#58; TX_FP71_RTBNLPROD which supports this resource</font>
<font color='#7F7E6F'>&#62; Primary Admin for BU_ATLAS_Tier2 is Augustine Abaravichyus and has been</font>
<font color='#7F7E6F'>&#62; CC&#39;d.</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; [Ticket Origin]</font>
<font color='#7F7E6F'>&#62; <a href='10040.html#1299088578' target='_blank' rel='nofollow'>https&#58;//ticket.grid.iu.edu/goc/viewer?id=10040#1299088578</a></font>
-- by youssef@.... at Tue Mar 08 15&#58;01&#58;28 UTC 2011
</div><script type='text/javascript'>
        $('#show_464774645').click(function() {
            $('#detail_464774645').slideDown("normal");
            $('#show_464774645').hide();
            $('#hide_464774645').show();
        });
        $('#hide_464774645').click(function() {
            $('#detail_464774645').slideUp();
            $('#hide_464774645').hide();
            $('#show_464774645').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='10040#1299341212'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-03-05T16:06:52+00:00">Mar 5, 2011 04:06 PM UTC</time><a class="anchor" name="1299341212">&nbsp;</a></div><pre>Any updates on this?

-- by Karthik Arunachalam</pre></div><div class='update_description'><i onclick="document.location='10040#1299252931'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-03-04T15:35:31+00:00">Mar 4, 2011 03:35 PM UTC</time><a class="anchor" name="1299252931">&nbsp;</a></div><pre>Are there any updates on this?

-- by Karthik Arunachalam</pre></div><div class='update_description'><i onclick="document.location='10040#1299088578'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-03-02T17:56:18+00:00">Mar 2, 2011 05:56 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1299088578">&nbsp;</a></div><pre>[by Karthik Arunachalam]

BU_ATLAS_Tier2 did not report to Gratia for the following days&#58;
[&#39;2011-02-26&#39;, &#39;2011-02-27&#39;, &#39;2011-02-28&#39;]

You could verify this by looking at the chart at
<a href='http&#58;//tinyurl.com/4wh686b' target='_blank' rel='nofollow'>http&#58;//tinyurl.com/4wh686b</a>

This is affecting the data that is being reported to WLCG for MOU
purposes. We want to clarify if this is part of a planned downtime and not
a real problem before it gets too difficult to catch up.

The Gratia-APEL interface checks for sites not reporting any data in a
given day and validates that against MyOsg planned downtime before raising
a warning flag.

So, if this is part of the planned downtime period, it would help if
OIM is updated for these days.  If not, then we need to
troubleshoot the problem with Gratia reporting.</pre></div><legend>Similar Recent Tickets <small>modified within the last 30 days</small></legend><div id="similar_tickets"><p class="muted">No similar tickets found.</p></div>
</div>
<script type="text/javascript">
function reset_anchor() {
    $("#updates .selected").removeClass("selected");
    var urls = document.location.toString().split('#'); 
    var anchor = urls[1];
    if(anchor) {
        $("a[name='"+anchor+"']").parents(".update_description").addClass("selected");
    }
}
function submitspam(ticket_id) {
    myret = confirm("Would you like to close this ticket as a security ticket, and submit the ticket content to akismet?");
    if(myret == true) {
        $.ajax("viewer/processspam?id="+ticket_id).done(function() {
            window.location.reload();
        });
    }
}

$(function() {
    reset_anchor();
    var ADDITIONAL_COOKIE_NAME = 'gocticket';
    var options = { path: '/', expires: 365};

    if(window.opener && window.opener.name == "gocticket_list") {
        v = $.cookie("closewindow");
        if(!v) {
            $("#closewindow").attr("checked", "checked"); //on by default
        } else {
            if(v == "checked") {
                $("#closewindow").attr("checked", "checked");
            }
        }
        $("#closewindow").click(function() {
            $.cookie("closewindow", $(this).attr('checked'), options);
        });
    } else {
        $("#closewindow_area").hide();
    }
    function updateTimeago() {
        $("time").timeago();
        setTimeout(updateTimeago, 30*1000);
    }
    updateTimeago();
    $(".description").focus(expand_description);
});
</script>
<hr/>
<footer>
<p>GOC Ticket Version 2.2 | <a href="https://ticket.opensciencegrid.org/goc/submit?app_issue_check=on&amp;app_issue_type=goc&amp;app_goc_url=https%3A%2F%2Fticket.opensciencegrid.org%3A443%2F10040">Report Bugs</a>
 | <a href="https://github.com/opensciencegrid/operations/blob/master/docs/privacy.md">Privacy Policy</a>
</p>

<p> <img align="top" src="images/tag_orange.png"/> Copyright 2018 The Trustees of Indiana University - Developed for Open Science Grid</p>
</footer>


</div><!--container-fluid-->
<script src="https://ticket1.grid.iu.edu:8443/socket.io/socket.io.js"></script>
<script>
var chat = io.connect('https://ticket1.grid.iu.edu:8443');
chat.on('connect', function() {
    chat.emit('authenticate', {nodekey:'', ticketid: 10040});
});
chat.on('peers', function(peers) {
    $("#peers").html("");
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('peer_disconnect', function(pid) {
    $("#peer_"+pid).hide("slow");
});
chat.on('peer_connected', function(peers) {
    //expect only 1 peer connecting, but..
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('submit', function() {
    if(confirm("This ticket was updated. Do you want to refresh?")) {
        history.go(0);
    }
});

function addPeer(pid, peer) {
    var ipinfo = "";
    if(peer.ip != undefined) {
        ipinfo = "<span class=\"ip\">"+peer.ip+"</span>";
    }
    if(chat.io.engine.id == pid) {
        //don't display myself
        return;
    }
    var html = "<li class=\"new\" id=\"peer_"+pid+"\" class=\"peer\">"+peer.name+ipinfo+"</li>";
    $("#peers").prepend(html);
    $("#peers .new").animate({bottom: 0}, 1000, function() {$(this).removeClass("new")});
}

$(function() {
    $("#ticket_form").submit(function() {
        chat.emit('submit');
        return true;
    });
});
</script>
<script>
//used by searchbox
function parseValue(value) {
    var obj = new Object();
    var tokens = value.split("\t");
    obj.str = tokens[0];
    obj.count = tokens[1];
    return obj;
}

$(function() {
    //bootstrap-2.0.4 stuff
    $(".alert-message").alert();
    $(".dropdown-toggle").dropdown();
    $("span[rel='tooltip']").tooltip();
    $("a[rel=popover]").popover();

    //activate menu that user is currently on
    $("#menu_navigator").addClass("active"); 
    $("#submenu_").addClass("active"); 

    //translate zend validation error message to bootstrap
    $(".errors").addClass("alert").addClass("alert-error");

    //enable autocomplete for search box
    $("#search").autocomplete({
        source: function( request, response ) {
            $.ajax({
                url: "search/autocomplete",
                dataType: "text",
                data: {
                    //featureClass: "P",
                    //style: "full",
                    //maxRows: 12,
                    //name_startsWith: request.term
                    q: request.term
                },
                success: function( data ) {
                    response( $.map( data.split("\n"), function( item ) {
                        if(item == "") return null;
                        return {
                            value: item
                        }
                    }));
                }
            });
        },
        select: function(event, ui) {
            document.location = "search?q="+ui.item.value;
        }
    });
    
});
</script>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-69012-13");
pageTracker._trackPageview();
} catch(err) {}
</script>

</body>
