<!DOCTYPE html>
<html lang="en">
  <head>
  <base href="">
    <title>[8631] OSG Storage&#58; dcache&#58; Defective Credential Detected Error on gsiftp door</title>    <meta charset="utf-8" />
    <meta name="verify-v1" content="na5IcAJsZVOfEkboRxuIiZ1zpZgnZiWra+nKcS7nA/o=" />
    <meta name="google-site-verification" content="DLrk3ft4s8b-S2TloLCL2LD_t6wcTjgSluf5pmiu2kA" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />

    <style type="text/css">
      body {
        padding-top: 50px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
     #search {
            width: 300px;
     }

    </style>

<script src="https://code.jquery.com/jquery-3.0.0.js"></script>
<script src="https://code.jquery.com/jquery-migrate-3.0.1.js"></script>

   <link href="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet"/>
    <script src="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/js/bootstrap.min.js"></script>

    <link href="https://netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"/>
    <link href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/themes/smoothness/jquery-ui.min.css" rel="stylesheet"/>
 <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>


    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/js/select2.min.js"></script>

    <link href="css/ticket.css" rel="stylesheet" />
    <script src="lib/jquery.cookie.js"></script>

    <link href="images/tag_orange.png" rel="icon" type="image/png"/>
  </head>

  <body>
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>

            <a class="brand" style="padding: 6px 0px 0px 6px;" href="http://opensciencegrid.org"><img src="images/osglogo.40x30.png"/></a>
            <ul class="nav">
                <li class="dropdown"><a href="https://ticket.opensciencegrid.org/#" class="dropdown-toggle" data-toggle="dropdown">GOC Ticket <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    <li><a href="https://my.opensciencegrid.org">MyOSG</a></li>
                    <li><a href="https://oim.opensciencegrid.org">OIM</a></li>
                    <li class="active"><a href="https://ticket.opensciencegrid.org/index">Ticket</a></li>
	<li class="divider"></li>
	<li><a href="http://repo.grid.iu.edu">Repo</a></li>
	<li class="divider"></li>
	<li><a href="http://blogs.grid.iu.edu">Blog</a></li>
                    <li><a href="http://display.grid.iu.edu">Display</a></li>
                    <li><a href="http://osggoc.blogspot.com/">News</a></li>
                    </ul>
                </li>
            </ul>
            <ul class="nav pull-right">
                <li><a href="https://ticket.opensciencegrid.org/sso/">Login</a></li>            </ul>

            <div class="nav-collapse">
                <ul class="nav">
			 <li id="menu_submit"><a href="https://ticket.opensciencegrid.org/submit">Submit</a></li><li id="menu_view" class="dropdown"><a href="https://ticket.opensciencegrid.org/\#" class="dropdown-toggle" data-toggle="dropdown">View <b class="caret"></b></a><ul class="dropdown-menu"><li id="submenu_listopen"><a href="https://ticket.opensciencegrid.org/list/open">Open Tickets</a></li><li id="submenu_listrecentclose"><a href="https://ticket.opensciencegrid.org/list/recentclose">Recently Closed Tickets</a></li><li class="divider"></li><li id="submenu_alltickets"><a href="https://ticket.opensciencegrid.org/search?q=&amp;sort=id">All Tickets</a></li></ul></li>                </ul>

                <form class="navbar-search pull-right" action="https://ticket.opensciencegrid.org/viewer">
                    <input id="search" type="text" name="id" class="search-query span2" placeholder="Search Ticket" value=""/>
                </form>
            </div>
        </div>
      </div>
    </div>

<script type='text/javascript' src='lib/jquery.timeago.js'></script>
<script type='text/javascript' src='lib/byte2size.js'></script>
<style>
#updates .toolbar {
position: relative;
margin-top: 0px;
top: -10px;
font-weight: normal;
}
#updates a.anchor {
position: relative;
top: -50px;
}
#updates .selected pre {
animation:selected 2s;
animation-iteration-count: 2;
animation-direction: alternate;
-webkit-animation:selected 2s; 
-webkit-animation-iteration-count: 2;
-webkit-animation-direction: alternate;
box-shadow: inset 1px 1px 20px #9ad;
border: 1px solid #9ab;
margin: 5px 0px;
padding-left: 10px;
}
@keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ab;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
@-webkit-keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ad;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
#updates pre {
background-color: inherit;
line-height: 15px;
padding: 5px;
}
#updates .header {
color: #999;
}
#updates .update_history pre {
background-color: #eee;
color: #666;
font-size: 85%;
}
#updates .clickable {
cursor: pointer;
}
#updates .clickable:hover {
color: #D98719;
}
#updates .meta_information pre {
background-color: #fed;
}
#similar_tickets {
max-height: 300px;
overflow-y: auto;
pointer-events: none;
padding: 5px;
background-color: #f4f4f4;
}
.btn-toolbar {
margin-bottom: 0;
height: 30px;
}
#peers {
position: fixed;
bottom: 0px;
right: 0px;
z-index: 100;
list-style: none;
padding: 5px 0px 0px 5px;
margin: 0px;
background-color: white;
box-shadow: 0px 0px 10px white;
}
#peers li {
background-color: #ccc;
color: #000;
display: inline-block;
padding: 5px 10px;
margin-right: 5px;
position: relative;
}
/*
#peers li:hover {
background-color: #999;
cursor: pointer;
}
*/
#peers span.ip {
padding-left: 5px;
color: #666;
}
#peers .new {
bottom: -30px;
}
/*
#peers .me {
background-color: red;
}
*/
</style>

<div class="container-fluid">
<ul id="peers"></ul>
<div class="alert alert-danger"><a class="close" href="https://ticket.opensciencegrid.org/#" data-dismiss="alert">&times;</a>By the end of May 2018, the ticketing system at https://ticket.opensciencegrid.org will be retired and support will be provided at https://support.opensciencegrid.org. Throughout this transition the support email (help@opensciencegrid.org) will be available as a point of contact.<br><br>                                                   
                                                                                                                                                                                   
Please see the service migration page for details: https://opensciencegrid.github.io/technology/policy/service-migrations-spring-2018/#ticket</div><div id="presence" class="pull-right"></div><div class="ticketgui"><script type="text/javascript" src="lib/checktab.js"></script>

<script>
var expanded = false;
function expand_description() {
    var desc = $(".description");
    if(!expanded) {
        expanded = true;
        //expand to minheight
        var min = 250;
        if(desc.height() < min) {
            desc.animate({height: min}, 200);
        }
    }
}

$(document).ready(function() {
    $("input[name='nad']").datepicker({
        dateFormat: 'yy-mm-dd'
    });
});

</script>



<style>
.form-horizontal .control-label {
padding-top: inherit;
font-size:90%;
color:#666;
}
label {
margin-bottom: 0px;
}
.controls {
line-height: 18px;
}
</style>
<form class="form-horizontal" action="https://ticket.opensciencegrid.org/viewer/updatebasic?id=8631" method="post">
<div class="page-header">
    <h3><span class="muted">8631</span> / OSG Storage&#58; dcache&#58; Defective Credential Detected Error on gsiftp door</h3>
</div>

<div class="row-fluid">
<div class="span5">
    <legend>Contact</legend>
    <div class="control-group">
        <label class="control-label">Full Name</label>
        <div class="controls">david lesny</div>
    </div>
    <div class="control-group">
        <label class="control-label">Email</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">Phone</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">CC</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>

    <legend>Details</legend>
    
    <div class="control-group">
        <label class="control-label">Ticket Type</label>
        <div class="controls">Problem/Request</div>
    </div>
    <div class="control-group">
        <label class="control-label">Priority</label>
        <div class="controls">Normal</div>
    </div>
    <div class="control-group">
        <label class="control-label">Status</label>
        <div class="controls">
Closed</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action</label>
        <div class="controls"></div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action Deadline</label>
        <div class="controls flag_red">2010-06-02</div>
    </div>

</div><!--span-->
<div class="span7">
    <legend>Assignees</legend>
    <div class="assignee" style="width: 60%">Neha Sharma <span class="muted"> / OSG Storage Team</span></div>    <br>

    <legend>Assignees</legend>
    TODO
    <br>

    <style>
legend.noborder {
border-bottom: none;
}
</style>

<div id="attachment-list"/>
<script>
$(function () {
    var first = true;
    $.getJSON("attachment/list/8631", function (files) {
        //console.dir(files);
        var html = "<table class=\"table table-condensed\">";
        $(files).each(function() {
            if(first) {
                first = false;
                html += "<legend class=\"noborder\">Attachmenets</legend>";
            }
            html += "<tr class=\"attachment\">";
            html += "<td><img src=\""+this.thumbnail_url+"\"/></td>";
            html += "<td><a href=\""+this.url+"\" target=\"_blank\">"+this.name+"</a></td>";
            html += "<td>"+bytesToSize(this.size, 1)+"</td>";
            html += "</tr>";
        });
        html += "</table>";
        $("#attachment-list").html(html);
    });
});

function download(url) {
    window.open(url, "_blank");
}
</script>


</div><!--span-->
</div><!--row-fluid-->


</form>

</div>
<div id="updates" style="clear: both;">
    <legend>Past Updates
    <div class="btn-toolbar pull-right toolbar">
    </div><!--btn-toolbar-->
    </legend>

    <div class='update_description'><i onclick="document.location='8631#1275490591'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2010-06-02T14:56:31+00:00">Jun 2, 2010 02:56 PM UTC</time> by <b>Neha Sharma</b><a class="anchor" name="1275490591">&nbsp;</a></div><pre>the new release does fix this problem
-neha</pre></div><div class='update_description'><i onclick="document.location='8631#1274905134'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2010-05-26T20:18:54+00:00">May 26, 2010 08:18 PM UTC</time> by <b>Neha Sharma</b><a class="anchor" name="1274905134">&nbsp;</a></div><pre>Hi David

I will confirm with the developer (he is off today) that the problem you are seeing is indeed caused by the bug that you mentioned in your email
We will be releasing the new VDT-dCache tarball tomorrow afternoon. It has 1.9.5-19 ,  among other updates

-Neha
On May 25, 2010, at 3&#58;09 PM, David Lesny wrote&#58;

Neha,

Today we had a problem with a file system and I lost of email.

I know that you sent me an email this morning that you were looking into this,
but I lost that one....

Not sure if you sent anything else that I might have lost......

In any event,  this error, and others with the Bad Sequence do occur
at irregular intervals and do seem to also happen around the time of
the CA updates...or just right after....

21 May 2010 13&#58;00&#58;26 (GFTP-osgx2-Unknown-1798) [gridftp-osgx2Domain-1274464825633] GssFtpDoorV1&#58;&#58;ac_adat&#58; got service context
exception&#58; Defective credential detected [Caused by&#58;  [Caused by&#58; Bad sequence size&#58; 2]]

I did find the following in the release notes for 1.9.5-18 which might be the cause?

gsiftp, gsidcap, SRM, gPlazma

Fixed a bug that prevented CRL files from being reloaded. The bug would cause the CRL in memory to eventually expire and blacklist certificates from
the corresponding CA.

Would the above bug cause my error message?

If my problem is fixed by the -18 release, how can I get it.

<div id='show_375990958' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_375990958'>From what I can tell, the current VDT package is -12 (I am 1.9.5-8),
but I believe you are working on -19 ?  If so, I can wait
and perhaps work with you (ITB) to get it going ?

But....I would like to first make certain this is a bug addressed in
-18 or -19 first...hate to go to the effort (yes I know I will anyway)
and not get it fixed if it is something else!!

thanks, dave

David Lesny wrote&#58;
Neha,

Sometime ago, I reported a problem I was having with dcache with gridftp on my doors.
Even though I have made some suggested changes, I am still having some problems.

Periodically I get the following type of errors logged in gridftp.log

20 May 2010 07&#58;35&#58;57 (GFTP-osgx2-Unknown-2110) [gridftp-osgx2Domain-1274358957488] GssFtpDoorV1&#58;&#58;ac_adat&#58; got service context
exception&#58; Defective credential detected [Caused by&#58;  [Caused by&#58; unknown object in factory&#58; org.bouncycastle.asn1.DERInteger]]
20 May 2010 07&#58;36&#58;10 (GFTP-osgx2-Unknown-2112) [gridftp-osgx2Domain-1274358970290] GssFtpDoorV1&#58;&#58;ac_adat&#58; got service context
exception&#58; Defective credential detected [Caused by&#58;  [Caused by&#58; unknown object in factory&#58; org.bouncycastle.asn1.DERInteger]]
20 May 2010 07&#58;36&#58;19 (GFTP-osgx2-Unknown-2113) [gridftp-osgx2Domain-1274358979400] GssFtpDoorV1&#58;&#58;ac_adat&#58; got service context
exception&#58; Defective credential detected [Caused by&#58;  [Caused by&#58; unknown object in factory&#58; org.bouncycastle.asn1.DERInteger]]
20 May 2010 07&#58;36&#58;31 (GFTP-osgx2-Unknown-2114) [gridftp-osgx2Domain-1274358991032] GssFtpDoorV1&#58;&#58;ac_adat&#58; got service context
exception&#58; Defective credential detected [Caused by&#58;  [Caused by&#58; unknown object in factory&#58; org.bouncycastle.asn1.DERInteger]]
20 May 2010 07&#58;36&#58;53 (GFTP-osgx2-Unknown-2115) [gridftp-osgx2Domain-1274359013032] GssFtpDoorV1&#58;&#58;ac_adat&#58; got service context
exception&#58; Defective credential detected [Caused by&#58;  [Caused by&#58; unknown object in factory&#58; org.bouncycastle.asn1.DERInteger]]
20 May 2010 07&#58;37&#58;13 (GFTP-osgx2-Unknown-2117) [gridftp-osgx2Domain-1274359033073] GssFtpDoorV1&#58;&#58;ac_adat&#58; got service context
exception&#58; Defective credential detected [Caused by&#58;  [Caused by&#58; unknown object in factory&#58; org.bouncycastle.asn1.DERInteger]]
20 May 2010 07&#58;37&#58;33 (GFTP-osgx2-Unknown-2120) [gridftp-osgx2Domain-1274359053316] GssFtpDoorV1&#58;&#58;ac_adat&#58; got service context
exception&#58; Defective credential detected [Caused by&#58;  [Caused by&#58; unknown object in factory&#58; org.bouncycastle.asn1.DERInteger]]
20 May 2010 07&#58;37&#58;54 (GFTP-osgx2-Unknown-2121) [gridftp-osgx2Domain-1274359073595] GssFtpDoorV1&#58;&#58;ac_adat&#58; got service context
exception&#58; Defective credential detected [Caused by&#58;  [Caused by&#58; unknown object in factory&#58; org.bouncycastle.asn1.DERInteger]]
20 May 2010 07&#58;38&#58;16 (GFTP-osgx2-Unknown-2122) [gridftp-osgx2Domain-1274359096384] GssFtpDoorV1&#58;&#58;ac_adat&#58; got service context
exception&#58; Defective credential detected [Caused by&#58;  [Caused by&#58; unknown object in factory&#58; org.bouncycastle.asn1.DERInteger]]

Most times, they are one failure, but the gridftp daemon seems to recover and life goes on.
However, on occasion, like this morning, it gets hung in a loop with error message like the above.
The &#34;Caused by&#34; varies. It is usually some number like 4 or 6 or 8, but.....

The transfer that was taking place reports a failure to the remote end and the transfer fails.

The problem is that when this happens the only way to fix it is to restart gridftp on the offending door.
However, since we are a Panda site for USAtlas, FTS transfers fail and Hiro turns my site off until I get it fixed.

Obviously I would like to get this resolved but do not know if this is a configuration problem at my end,
a bug in my dCache version or....

A bit of history, my CA area is on an NFS served file system which is updated every 6 six hours by my Gums server.
This CA is served to all the nodes that need a CA. The problems seem to come up right after a fetch of new CAs.

So I changed my dCache doors to use a local copy in /etc/grid-security/certificates which is updated every six hours
using rsync from the NFS CA area. This update is done one 1 after the update by Gums to the NFS area.
For examples, the CA is updated via fetch at 6am, the rsync to the dCache local copy is at 7am.

However, this did not seem to have solved the problem as it keeps occuring

My dCache version is 1.9.5-8.   If this is a bug in this version, I can look at upgrading to the newest release.
I noticed that you are packaging a newer version in VDT. Which release will that be?   I think 1.9.5-19 is out
but I know that you lag behiind by a few updates so that you can test.

If you need any other information, please let me know.  I am working from home today, so my reponses might
lag a bit today/tomorrow.

thanks, dave
</div><script type='text/javascript'>
        $('#show_375990958').click(function() {
            $('#detail_375990958').slideDown("normal");
            $('#show_375990958').hide();
            $('#hide_375990958').show();
        });
        $('#hide_375990958').click(function() {
            $('#detail_375990958').slideUp();
            $('#hide_375990958').hide();
            $('#show_375990958').show();
        });
        </script></pre></div>
</div>
<script type="text/javascript">
function reset_anchor() {
    $("#updates .selected").removeClass("selected");
    var urls = document.location.toString().split('#'); 
    var anchor = urls[1];
    if(anchor) {
        $("a[name='"+anchor+"']").parents(".update_description").addClass("selected");
    }
}
function submitspam(ticket_id) {
    myret = confirm("Would you like to close this ticket as a security ticket, and submit the ticket content to akismet?");
    if(myret == true) {
        $.ajax("viewer/processspam?id="+ticket_id).done(function() {
            window.location.reload();
        });
    }
}

$(function() {
    reset_anchor();
    var ADDITIONAL_COOKIE_NAME = 'gocticket';
    var options = { path: '/', expires: 365};

    if(window.opener && window.opener.name == "gocticket_list") {
        v = $.cookie("closewindow");
        if(!v) {
            $("#closewindow").attr("checked", "checked"); //on by default
        } else {
            if(v == "checked") {
                $("#closewindow").attr("checked", "checked");
            }
        }
        $("#closewindow").click(function() {
            $.cookie("closewindow", $(this).attr('checked'), options);
        });
    } else {
        $("#closewindow_area").hide();
    }
    function updateTimeago() {
        $("time").timeago();
        setTimeout(updateTimeago, 30*1000);
    }
    updateTimeago();
    $(".description").focus(expand_description);
});
</script>
<hr/>
<footer>
<p>GOC Ticket Version 2.2 | <a href="https://ticket.opensciencegrid.org/goc/submit?app_issue_check=on&amp;app_issue_type=goc&amp;app_goc_url=https%3A%2F%2Fticket.opensciencegrid.org%3A443%2F8631">Report Bugs</a>
 | <a href="https://github.com/opensciencegrid/operations/blob/master/docs/privacy.md">Privacy Policy</a>
</p>

<p> <img align="top" src="images/tag_orange.png"/> Copyright 2018 The Trustees of Indiana University - Developed for Open Science Grid</p>
</footer>


</div><!--container-fluid-->
<script>
//used by searchbox
function parseValue(value) {
    var obj = new Object();
    var tokens = value.split("\t");
    obj.str = tokens[0];
    obj.count = tokens[1];
    return obj;
}

$(function() {
    //bootstrap-2.0.4 stuff
    $(".alert-message").alert();
    $(".dropdown-toggle").dropdown();
    $("span[rel='tooltip']").tooltip();
    $("a[rel=popover]").popover();

    //activate menu that user is currently on
    $("#menu_navigator").addClass("active"); 
    $("#submenu_").addClass("active"); 

    //translate zend validation error message to bootstrap
    $(".errors").addClass("alert").addClass("alert-error");

});
</script>


</body>
