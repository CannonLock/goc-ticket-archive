<!DOCTYPE html>
<html lang="en">
  <head>
  <base href="">
    <title>[23419] rsv gratia collector (rsv.grid.iu.edu) stopped sending metric replication (to rsv1.grid.iu.edu)</title>    <meta charset="utf-8" />
    <meta name="verify-v1" content="na5IcAJsZVOfEkboRxuIiZ1zpZgnZiWra+nKcS7nA/o=" />
    <meta name="google-site-verification" content="DLrk3ft4s8b-S2TloLCL2LD_t6wcTjgSluf5pmiu2kA" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />
    <link href="https://ticket.opensciencegrid.org/rss" rel="alternate" type="application/rss+xml" title="GOC Ticket Update feed" />

    <style type="text/css">
      body {
        padding-top: 50px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
     #search {
            width: 300px;
     }

    </style>

<script src="https://code.jquery.com/jquery-3.0.0.js"></script>
<script src="https://code.jquery.com/jquery-migrate-3.0.1.js"></script>

   <link href="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet"/>
    <script src="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/js/bootstrap.min.js"></script>

    <link href="https://netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"/>
    <link href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/themes/smoothness/jquery-ui.min.css" rel="stylesheet"/>
 <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>


    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/js/select2.min.js"></script>

    <link href="css/ticket.css" rel="stylesheet" />
    <script src="lib/jquery.cookie.js"></script>

    <link href="images/tag_orange.png" rel="icon" type="image/png"/>
  </head>

  <body>
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>

            <a class="brand" style="padding: 6px 0px 0px 6px;" href="http://opensciencegrid.org"><img src="images/osglogo.40x30.png"/></a>
            <ul class="nav">
                <li class="dropdown"><a href="https://ticket.opensciencegrid.org/#" class="dropdown-toggle" data-toggle="dropdown">GOC Ticket <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    <li><a href="https://my.opensciencegrid.org">MyOSG</a></li>
                    <li><a href="https://oim.opensciencegrid.org">OIM</a></li>
                    <li class="active"><a href="https://ticket.opensciencegrid.org/index">Ticket</a></li>
	<li class="divider"></li>
	<li><a href="http://repo.grid.iu.edu">Repo</a></li>
	<li class="divider"></li>
	<li><a href="http://blogs.grid.iu.edu">Blog</a></li>
                    <li><a href="http://display.grid.iu.edu">Display</a></li>
                    <li><a href="http://osggoc.blogspot.com/">News</a></li>
                    </ul>
                </li>
            </ul>
            <ul class="nav pull-right">
                <li><a href="https://ticket.opensciencegrid.org/sso/">Login</a></li>            </ul>

            <div class="nav-collapse">
                <ul class="nav">
			 <li id="menu_submit"><a href="https://ticket.opensciencegrid.org/submit">Submit</a></li><li id="menu_view" class="dropdown"><a href="https://ticket.opensciencegrid.org/\#" class="dropdown-toggle" data-toggle="dropdown">View <b class="caret"></b></a><ul class="dropdown-menu"><li id="submenu_listopen"><a href="https://ticket.opensciencegrid.org/list/open">Open Tickets</a></li><li id="submenu_listrecentclose"><a href="https://ticket.opensciencegrid.org/list/recentclose">Recently Closed Tickets</a></li><li class="divider"></li><li id="submenu_alltickets"><a href="https://ticket.opensciencegrid.org/search?q=&amp;sort=id">All Tickets</a></li></ul></li>                </ul>

                <form class="navbar-search pull-right" action="https://ticket.opensciencegrid.org/viewer">
                    <input id="search" type="text" name="id" class="search-query span2" placeholder="Search Ticket" value=""/>
                </form>
            </div>
        </div>
      </div>
    </div>

<script type='text/javascript' src='lib/jquery.timeago.js'></script>
<script type='text/javascript' src='lib/byte2size.js'></script>
<style>
#updates .toolbar {
position: relative;
margin-top: 0px;
top: -10px;
font-weight: normal;
}
#updates a.anchor {
position: relative;
top: -50px;
}
#updates .selected pre {
animation:selected 2s;
animation-iteration-count: 2;
animation-direction: alternate;
-webkit-animation:selected 2s; 
-webkit-animation-iteration-count: 2;
-webkit-animation-direction: alternate;
box-shadow: inset 1px 1px 20px #9ad;
border: 1px solid #9ab;
margin: 5px 0px;
padding-left: 10px;
}
@keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ab;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
@-webkit-keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ad;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
#updates pre {
background-color: inherit;
line-height: 15px;
padding: 5px;
}
#updates .header {
color: #999;
}
#updates .update_history pre {
background-color: #eee;
color: #666;
font-size: 85%;
}
#updates .clickable {
cursor: pointer;
}
#updates .clickable:hover {
color: #D98719;
}
#updates .meta_information pre {
background-color: #fed;
}
#similar_tickets {
max-height: 300px;
overflow-y: auto;
pointer-events: none;
padding: 5px;
background-color: #f4f4f4;
}
.btn-toolbar {
margin-bottom: 0;
height: 30px;
}
#peers {
position: fixed;
bottom: 0px;
right: 0px;
z-index: 100;
list-style: none;
padding: 5px 0px 0px 5px;
margin: 0px;
background-color: white;
box-shadow: 0px 0px 10px white;
}
#peers li {
background-color: #ccc;
color: #000;
display: inline-block;
padding: 5px 10px;
margin-right: 5px;
position: relative;
}
/*
#peers li:hover {
background-color: #999;
cursor: pointer;
}
*/
#peers span.ip {
padding-left: 5px;
color: #666;
}
#peers .new {
bottom: -30px;
}
/*
#peers .me {
background-color: red;
}
*/
</style>

<div class="container-fluid">
<ul id="peers"></ul>
<div class="alert alert-danger"><a class="close" href="https://ticket.opensciencegrid.org/#" data-dismiss="alert">&times;</a>By the end of May 2018, the ticketing system at https://ticket.opensciencegrid.org will be retired and support will be provided at https://support.opensciencegrid.org. Throughout this transition the support email (help@opensciencegrid.org) will be available as a point of contact.<br><br>                                                   
                                                                                                                                                                                   
Please see the service migration page for details: https://opensciencegrid.github.io/technology/policy/service-migrations-spring-2018/#ticket</div><div id="presence" class="pull-right"></div><div class="ticketgui"><script type="text/javascript" src="lib/checktab.js"></script>

<script>
var expanded = false;
function expand_description() {
    var desc = $(".description");
    if(!expanded) {
        expanded = true;
        //expand to minheight
        var min = 250;
        if(desc.height() < min) {
            desc.animate({height: min}, 200);
        }
    }
}

$(document).ready(function() {
    $("input[name='nad']").datepicker({
        dateFormat: 'yy-mm-dd'
    });
});

</script>



<style>
.form-horizontal .control-label {
padding-top: inherit;
font-size:90%;
color:#666;
}
label {
margin-bottom: 0px;
}
.controls {
line-height: 18px;
}
</style>
<form class="form-horizontal" action="https://ticket.opensciencegrid.org/viewer/updatebasic?id=23419" method="post">
<div class="page-header">
    <h3><span class="muted">23419</span> / rsv gratia collector (rsv.grid.iu.edu) stopped sending metric replication (to rsv1.grid.iu.edu)</h3>
</div>

<div class="row-fluid">
<div class="span5">
    <legend>Contact</legend>
    <div class="control-group">
        <label class="control-label">Full Name</label>
        <div class="controls">Soichi Hayashi</div>
    </div>
    <div class="control-group">
        <label class="control-label">Email</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">Phone</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">CC</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>

    <legend>Details</legend>
    <div class="control-group"><label class="control-label">Submitted Via</label><div class="controls">GOC Ticket/submit</div></div><div class="control-group"><label class="control-label">Submitter</label><div class="controls">Soichi Hayashi</div></div>
    <div class="control-group">
        <label class="control-label">Ticket Type</label>
        <div class="controls">Problem/Request</div>
    </div>
    <div class="control-group">
        <label class="control-label">Priority</label>
        <div class="controls">Normal</div>
    </div>
    <div class="control-group">
        <label class="control-label">Status</label>
        <div class="controls">
Closed</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action</label>
        <div class="controls">Wait for Tanya to get new key</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action Deadline</label>
        <div class="controls flag_red">2015-03-04</div>
    </div>

</div><!--span-->
<div class="span7">
    <legend>Assignees</legend>
    <div class="assignee" style="width: 60%">Thomas Lee <span class="muted"> / OSG Operations Infrastructure</span></div><div class="assignee" style="width: 60%">Software Support (Triage) <span class="muted"> / OSG Software Team</span></div><div class="assignee" style="width: 60%">Carl Edquist <span class="muted"> / OSG Software Team</span></div>    <br>

    <legend>Assignees</legend>
    TODO
    <br>

    <style>
legend.noborder {
border-bottom: none;
}
</style>

<div id="attachment-list"/>
<script>
$(function () {
    var first = true;
    $.getJSON("attachment/list/23419", function (files) {
        //console.dir(files);
        var html = "<table class=\"table table-condensed\">";
        $(files).each(function() {
            if(first) {
                first = false;
                html += "<legend class=\"noborder\">Attachmenets</legend>";
            }
            html += "<tr class=\"attachment\">";
            html += "<td><img src=\""+this.thumbnail_url+"\"/></td>";
            html += "<td><a href=\""+this.url+"\" target=\"_blank\">"+this.name+"</a></td>";
            html += "<td>"+bytesToSize(this.size, 1)+"</td>";
            html += "</tr>";
        });
        html += "</table>";
        $("#attachment-list").html(html);
    });
});

function download(url) {
    window.open(url, "_blank");
}
</script>


</div><!--span-->
</div><!--row-fluid-->


</form>

</div>
<div id="updates" style="clear: both;">
    <legend>Past Updates
    <div class="btn-toolbar pull-right toolbar">
    </div><!--btn-toolbar-->
    </legend>

    <div class='update_description'><i onclick="document.location='23419#1425500326'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-03-04T20:18:46+00:00">Mar 4, 2015 08:18 PM UTC</time> by <b>Christopher Pipes</b><a class="anchor" name="1425500326">&nbsp;</a></div><pre>Thank you for informing us that this issue has been resolved. I will close this ticket.  Please submit problems, requests, and questions at&#58; <a href='https&#58;//ticket.grid.iu.edu/goc/open' target='_blank' rel='nofollow'>https&#58;//ticket.grid.iu.edu/goc/open</a> OSG Grid Operations Center goc@...., 317-278-9699 Visit the OSG Operations Page&#58; <a href='http&#58;//osggoc.blogspot.com/' target='_blank' rel='nofollow'>http&#58;//osggoc.blogspot.com/</a></pre></div><div class='update_description'><i onclick="document.location='23419#1425402858'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-03-03T17:14:18+00:00">Mar 3, 2015 05:14 PM UTC</time> by <b>Tanya Levshina</b><a class="anchor" name="1425402858">&nbsp;</a></div><pre>Yes, please do!
Tanya</pre></div><div class='update_description'><i onclick="document.location='23419#1425402743'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-03-03T17:12:23+00:00">Mar 3, 2015 05:12 PM UTC</time> by <b>Christopher Pipes</b><a class="anchor" name="1425402743">&nbsp;</a></div><pre>Tanya, would you like to close this and just restart it when needed? And we can work on this once your staffing is up to par and have time to do so?

Thanks,
Chris</pre></div><div class='update_description'><i onclick="document.location='23419#1424882853'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-02-25T16:47:33+00:00">Feb 25, 2015 04:47 PM UTC</time> by <b>Tanya Levshina</b><a class="anchor" name="1424882853">&nbsp;</a></div><pre>I am not able to debug it right now. I guess restarting it from time to time is the only option for the time being. We are in the process of hiring a person so hopefully we will be able to address this issue.

Thanks,
Tanya

On Feb 24, 2015, at 2&#58;25 PM, Open Science Grid FootPrints &#60;osg@....&#60;mailto&#58;osg@....&#62;&#62; wrote&#58;

[Duplicate message snipped]</pre></div><div class='update_description'><i onclick="document.location='23419#1424809548'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-02-24T20:25:48+00:00">Feb 24, 2015 08:25 PM UTC</time> by <b>Christopher Pipes</b><a class="anchor" name="1424809548">&nbsp;</a></div><pre>Hi Tanya, I just wanted to check back with you to see if there was any news or if you needed more time on this, or what exactly we should do with this ticket if its going to be a long while before we there is any movement. Please advise the best course of action.

Thanks,
Chris</pre></div><div class='update_description'><i onclick="document.location='23419#1423515227'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-02-09T20:53:47+00:00">Feb 9, 2015 08:53 PM UTC</time> by <b>Tanya Levshina</b><a class="anchor" name="1423515227">&nbsp;</a></div><pre>Hi,

There  is no news and I don&#39;t really know when I can start debugging this problem. I will ask for key when I have a least a day to work on it.
Sorry,
Tanya</pre></div><div class='update_description'><i onclick="document.location='23419#1423515058'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-02-09T20:50:58+00:00">Feb 9, 2015 08:50 PM UTC</time> by <b>Brian Lin</b><a class="anchor" name="1423515058">&nbsp;</a></div><pre>Tanya&#58; Will you have a chance to look at this any time soon? It looks like your pubkey that Thomas set up has likely expired...
Carl&#58; Is there anything that we can do on the software end?</pre></div><div class='update_description'><i onclick="document.location='23419#1422998023'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-02-03T21:13:43+00:00">Feb 3, 2015 09:13 PM UTC</time> by <b>Christopher Pipes</b><a class="anchor" name="1422998023">&nbsp;</a></div><pre>Hi Tanya,

Any news on this ?

Thanks,
Chris</pre></div><div class='update_description'><i onclick="document.location='23419#1422381428'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-01-27T17:57:08+00:00">Jan 27, 2015 05:57 PM UTC</time> by <b>Christopher Pipes</b><a class="anchor" name="1422381428">&nbsp;</a></div><pre>Hi Tanya,

Any news on this ?

Thanks,
Chris</pre></div><div class='update_description'><i onclick="document.location='23419#1421868052'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-01-21T19:20:52+00:00">Jan 21, 2015 07:20 PM UTC</time> by <b>Christopher Pipes</b><a class="anchor" name="1421868052">&nbsp;</a></div><pre>Thanks for the update, Tanya. I&#39;ll check back with you next week.

~Chris</pre></div><div class='update_description'><i onclick="document.location='23419#1421776765'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-01-20T17:59:25+00:00">Jan 20, 2015 05:59 PM UTC</time> by <b>Tanya Levshina</b><a class="anchor" name="1421776765">&nbsp;</a></div><pre>Sorry, I have not had a chance to debug this problem.
Tanya
On Jan 20, 2015, at 11&#58;50 AM, Open Science Grid FootPrints &#60;osg@....&#60;mailto&#58;osg@....&#62;&#62; wrote&#58;

[Duplicate message snipped]</pre></div><div class='update_description'><i onclick="document.location='23419#1421776230'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-01-20T17:50:30+00:00">Jan 20, 2015 05:50 PM UTC</time> by <b>Christopher Pipes</b><a class="anchor" name="1421776230">&nbsp;</a></div><pre>Hi Tanya,

Do you have an update on this? Has everything worked out?

Thanks,
Chris</pre></div><div class='update_description'><i onclick="document.location='23419#1421776216'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-01-20T17:50:16+00:00">Jan 20, 2015 05:50 PM UTC</time> by <b>Christopher Pipes</b><a class="anchor" name="1421776216">&nbsp;</a></div><pre>Hi Tanya,

Do you have an update on this? Has everything worked out?

Thanks,
Chris</pre></div><div class='update_description'><i onclick="document.location='23419#1421078887'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-01-12T16:08:07+00:00">Jan 12, 2015 04:08 PM UTC</time> by <b>Thomas Lee</b><a class="anchor" name="1421078887">&nbsp;</a></div><pre>You appear to be attempting to connect to rsv.grid.iu.edu, rather than rsv1.grid.iu.edu.  The rsv.grid.iu.edu is the old RSV machine and is definitely not the same as rsv1.grid.iu.edu.  You are correct in connecting to jump.grid.iu.edu first and then connecting to the second machine from there.  As you can see, connecting via ssh as root is not allowed on any machine we administer, for security reasons.</pre></div><div class='update_description'><i onclick="document.location='23419#1418934376'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-12-18T20:26:16+00:00">Dec 18, 2014 08:26 PM UTC</time> by <b>Tanya Levshina</b><a class="anchor" name="1418934376">&nbsp;</a></div><pre>Hi Thomas,
hostname
jump.grid.iu.edu
ssh root@....
Permission denied (publickey).
2014-12-18 20&#58;24&#58;53 UTC [tanya@jump&#58;~]$ ssh tanya@....
Permission denied (publickey).

any idea?
Thanks,
Tanya</pre></div><div class='update_description'><i onclick="document.location='23419#1418760175'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-12-16T20:02:55+00:00">Dec 16, 2014 08:02 PM UTC</time> by <b>Tanya Levshina</b><a class="anchor" name="1418760175">&nbsp;</a></div><pre>Soichi,

I am overload so you should be patient. I will start debugging eventually. We don&#39;t see any of this problem here even for the osg instance. So it should be some correlation with hardware.
Tanya</pre></div><div class='update_description'><i onclick="document.location='23419#1418759915'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-12-16T19:58:35+00:00">Dec 16, 2014 07:58 PM UTC</time> by <b>Soichi Hayashi</b><a class="anchor" name="1418759915">&nbsp;</a></div><pre>rsv.grid.iu.edu&#39;s tomcat had a similar crash today. I&#39;ve restarted tomcat service on rsv.grid.iu.edu. rsv.grid.iu.edu is running unsupported (old) version of gratia collector, so I won&#39;t report the details here, but I am making this update just for the record. All downstream rsv collectors (rsv1, rsv-itb) were affected by this issue.After rsv.grid.iu.edu&#39;s tomcat was restarted, I also had to restart rsv1&#39;s tomcat before replication stream was restored.</pre></div><div class='update_description'><i onclick="document.location='23419#1418677247'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-12-15T21:00:47+00:00">Dec 15, 2014 09:00 PM UTC</time> by <b>Christopher Pipes</b><a class="anchor" name="1418677247">&nbsp;</a></div><pre>Setting this to 1-12-15. Please update with info as needed. Or close when work has been completed.</pre></div><div class='update_description'><i onclick="document.location='23419#1418404032'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-12-12T17:07:12+00:00">Dec 12, 2014 05:07 PM UTC</time> by <b>Thomas Lee</b><a class="anchor" name="1418404032">&nbsp;</a></div><pre>Temporary access granted until 2015-01-12.  I copied Tanya&#39;s ssh public key from jump.grid.  Should be ready to go; let me know if there are problems.</pre></div><div class='update_description'><i onclick="document.location='23419#1418403182'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-12-12T16:53:02+00:00">Dec 12, 2014 04:53 PM UTC</time> by <b>Soichi Hayashi</b><a class="anchor" name="1418403182">&nbsp;</a></div><pre>Tom,

Can you give Tanya the temporary sudo access to rsv1.grid.iu.edu? I know we usually don&#39;t give sudo access on our production instances, but I think this is somewhat a unique case.

Tanya,

While you are waiting on sudo access, here is the requested info.

rsv1.grid.iu.edu

2014-12-12 16&#58;52&#58;17 UTC [hayashis@rsv1&#58;~]$ uname -a
Linux rsv1.grid.iu.edu 2.6.32-504.1.3.el6.x86_64 #1 SMP Fri Oct 31 11&#58;37&#58;10 EDT 2014 x86_64 x86_64 x86_64 GNU/Linux
2014-12-12 16&#58;52&#58;20 UTC [hayashis@rsv1&#58;~]$ cat /etc/issue
Red Hat Enterprise Linux Server release 6.6 (Santiago)
Kernel &#92;r on an &#92;m

2014-12-12 16&#58;52&#58;23 UTC [hayashis@rsv1&#58;~]$ rpm -qi gratia-service
Name        &#58; gratia-service               Relocations&#58; (not relocatable)
Version     &#58; 1.14.0                            Vendor&#58; Koji
Release     &#58; 1.osg31.el6                   Build Date&#58; Fri 07 Mar 2014 07&#58;22&#58;58 AM UTC
Install Date&#58; Tue 12 Aug 2014 02&#58;38&#58;58 PM UTC      Build Host&#58; kojibuilder3.chtc.wisc.edu
Group       &#58; Applications/System           Source RPM&#58; gratia-1.14.0-1.osg31.el6.src.rpm
Size        &#58; 31556034                         License&#58; GPL
Signature   &#58; DSA/SHA1, Fri 07 Mar 2014 12&#58;33&#58;30 AM UTC, Key ID 2110b1c8824b8603
Packager    &#58; Koji
URL         &#58; <a href='http&#58;//sourceforge.net/projects/gratia/' target='_blank' rel='nofollow'>http&#58;//sourceforge.net/projects/gratia/</a>
Summary     &#58; Gratia OSG accounting system
Description &#58;
Gratia OSG accounting system</pre></div><div class='update_description'><i onclick="document.location='23419#1418402424'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-12-12T16:40:24+00:00">Dec 12, 2014 04:40 PM UTC</time> by <b>Tanya Levshina</b><a class="anchor" name="1418402424">&nbsp;</a></div><pre>Soichi,
what version of gratia service you are running, what OS? can we get access to rsv node?
Tanya</pre></div><div class='update_description'><i onclick="document.location='23419#1418402363'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-12-12T16:39:23+00:00">Dec 12, 2014 04:39 PM UTC</time> by <b>Tanya Levshina</b><a class="anchor" name="1418402363">&nbsp;</a></div><pre>Hi,

I completely missed this ticket, sorry.  I don&#39;t think Carl should be involved because it concerns gratia collector. We will try debug this problem.
Tanya</pre></div><div class='update_description'><i onclick="document.location='23419#1418401763'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-12-12T16:29:23+00:00">Dec 12, 2014 04:29 PM UTC</time> by <b>Soichi Hayashi</b><a class="anchor" name="1418401763">&nbsp;</a></div><pre>FYI.

rsv1 died again today.

<font color='#7F7E6F'>&#62; 12 Dec 2014 16&#58;25&#58;46,910 gratia.service(Thread-14) [WARNING]&#58; ReplicationService&#58; exception detail follows&#58;</font>
<font color='#7F7E6F'>&#62; org.hibernate.exception.JDBCConnectionException&#58; could not execute query using iterate</font>
<font color='#7F7E6F'>&#62;       at org.hibernate.exception.SQLStateConverter.convert(SQLStateConverter.java&#58;97)</font>

As usual, I&#39;ve restarted the tomcat on rsv1, and replication seems to be backup.</pre></div><div class='update_description'><i onclick="document.location='23419#1418234998'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-12-10T18:09:58+00:00">Dec 10, 2014 06:09 PM UTC</time> by <b>Carl Edquist</b><a class="anchor" name="1418234998">&nbsp;</a></div><pre>Thanks Chris,

It&#39;s not clear to me whether this is just a configuration issue or if there are changes to the software that need to be made to address the problem.  (But if we need to make software changes then yeah we should move it to jira.)

Soichi, for your question about upgrading mysql-connector -- sorry, I have no idea whether that would be contributing to the memory issue.

Tanya, do you have any thoughts about this?

Thanks,
Carl</pre></div><div class='update_description'><i onclick="document.location='23419#1418226181'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-12-10T15:43:01+00:00">Dec 10, 2014 03:43 PM UTC</time> by <b>Christopher Pipes</b><a class="anchor" name="1418226181">&nbsp;</a></div><pre>Hi Carl,

Let me know if you want this to be a jira ticket with the gratia-dev assigned and I will most this over.

Thanks,
Chris</pre></div><div class='update_description'><i onclick="document.location='23419#1418163827'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-12-09T22:23:47+00:00">Dec 9, 2014 10:23 PM UTC</time> by <b>Tim Theisen</b><a class="anchor" name="1418163827">&nbsp;</a></div><pre>Assigning to Carl as he is the gratia contact in the software team.</pre></div><div class='update_description'><i onclick="document.location='23419#1418072780'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-12-08T21:06:20+00:00">Dec 8, 2014 09:06 PM UTC</time> by <b>Christopher Pipes</b><a class="anchor" name="1418072780">&nbsp;</a></div><pre>I am adding the Software team to this. But I think this needs to be converted over to a Jira ticket. Please let me know if this is true and I will do so.

Thanks,
Chris</pre></div><div class='update_description'><i onclick="document.location='23419#1418044937'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-12-08T13:22:17+00:00">Dec 8, 2014 01:22 PM UTC</time> by <b>Soichi Hayashi</b><a class="anchor" name="1418044937">&nbsp;</a></div><pre>rsv1&#39;s mysql driver died again at around 13&#58;12 UTC on 12/08.

Following is the log from the /var/log/gratia-service/gratia.log

08 Dec 2014 13&#58;11&#58;47,687 gratia.service(Thread-14) [WARNING]&#58; ReplicationService&#58; exception detail follows&#58;
org.hibernate.exception.JDBCConnectionException&#58; could not execute query using iterate
at org.hibernate.exception.SQLStateConverter.convert(SQLStateConverter.java&#58;97)
at org.hibernate.exception.JDBCExceptionHelper.convert(JDBCExceptionHelper.java&#58;66)
at org.hibernate.loader.hql.QueryLoader.iterate(QueryLoader.java&#58;450)
at org.hibernate.hql.ast.QueryTranslatorImpl.iterate(QueryTranslatorImpl.java&#58;405)
at org.hibernate.engine.query.HQLQueryPlan.performIterate(HQLQueryPlan.java&#58;248)
at org.hibernate.impl.SessionImpl.iterate(SessionImpl.java&#58;1220)
at org.hibernate.impl.QueryImpl.iterate(QueryImpl.java&#58;69)
at net.sf.gratia.services.ReplicationService.loop(Unknown Source)
at net.sf.gratia.services.ReplicationService.run(Unknown Source)
Caused by&#58; com.mysql.jdbc.CommunicationsException&#58; Communications link failure due to underlying exception&#58;

** BEGIN NESTED EXCEPTION **

java.net.SocketException
MESSAGE&#58; Broken pipe

STACKTRACE&#58;

java.net.SocketException&#58; Broken pipe
at java.net.SocketOutputStream.socketWrite0(Native Method)
at java.net.SocketOutputStream.socketWrite(SocketOutputStream.java&#58;113)
at java.net.SocketOutputStream.write(SocketOutputStream.java&#58;159)
at java.io.BufferedOutputStream.flushBuffer(BufferedOutputStream.java&#58;82)
at java.io.BufferedOutputStream.write(BufferedOutputStream.java&#58;126)
at com.mysql.jdbc.MysqlIO.send(MysqlIO.java&#58;2742)
at com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java&#58;1612)
at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java&#58;1723)
at com.mysql.jdbc.Connection.execSQL(Connection.java&#58;3283)
at com.mysql.jdbc.PreparedStatement.executeInternal(PreparedStatement.java&#58;1332)
<div id='show_2037471533' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_2037471533'>at com.mysql.jdbc.PreparedStatement.executeQuery(PreparedStatement.java&#58;1467)
at org.hibernate.jdbc.AbstractBatcher.getResultSet(AbstractBatcher.java&#58;208)
at org.hibernate.loader.Loader.getResultSet(Loader.java&#58;1812)
at org.hibernate.loader.hql.QueryLoader.iterate(QueryLoader.java&#58;427)
at org.hibernate.hql.ast.QueryTranslatorImpl.iterate(QueryTranslatorImpl.java&#58;405)
at org.hibernate.engine.query.HQLQueryPlan.performIterate(HQLQueryPlan.java&#58;248)
at org.hibernate.impl.SessionImpl.iterate(SessionImpl.java&#58;1220)
at org.hibernate.impl.QueryImpl.iterate(QueryImpl.java&#58;69)
at net.sf.gratia.services.ReplicationService.loop(Unknown Source)
at net.sf.gratia.services.ReplicationService.run(Unknown Source)

** END NESTED EXCEPTION **

Last packet sent to the server was 0 ms ago.
at com.mysql.jdbc.MysqlIO.send(MysqlIO.java&#58;2759)
at com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java&#58;1612)
at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java&#58;1723)
at com.mysql.jdbc.Connection.execSQL(Connection.java&#58;3283)
at com.mysql.jdbc.PreparedStatement.executeInternal(PreparedStatement.java&#58;1332)
at com.mysql.jdbc.PreparedStatement.executeQuery(PreparedStatement.java&#58;1467)
at org.hibernate.jdbc.AbstractBatcher.getResultSet(AbstractBatcher.java&#58;208)
at org.hibernate.loader.Loader.getResultSet(Loader.java&#58;1812)
at org.hibernate.loader.hql.QueryLoader.iterate(QueryLoader.java&#58;427)
... 6 more
08 Dec 2014 13&#58;11&#58;58,307 gratia.service(Thread-10) [WARNING]&#58; RecordProcessor&#58; 0&#58; Replication MetricRecord 1 / 10 (metric&#58;antaeus.hpcc.ttu.edu)&#58; Received unexpected exception could not execute query
08 Dec 2014 13&#58;11&#58;58,307 gratia.service(Thread-10) [WARNING]&#58; RecordProcessor&#58; 0&#58; Communications error&#58; shutting down
08 Dec 2014 13&#58;11&#58;58,307 gratia.service(Thread-10) [WARNING]&#58; RecordProcessor&#58; 0&#58; Communications error&#58; shutting down
08 Dec 2014 13&#58;12&#58;02,183 gratia.service(RMI TCP Connection(4261)-129.79.53.76) [WARNING]&#58; Queue&#58;&#58;clearStatusTable&#58; error when updating CollectorStatus table&#58; could not execute native bulk manipulation query
08 Dec 2014 13&#58;12&#58;02,304 gratia.service(RMI TCP Connection(4261)-129.79.53.76) [WARNING]&#58; updateStatus&#58; error when updating CollectorStatus table&#58; could not execute native bulk manipulation query
08 Dec 2014 13&#58;12&#58;02,305 gratia.service(RMI TCP Connection(4261)-129.79.53.76) [WARNING]&#58; updateStatus&#58; error when updating CollectorStatus table&#58; could not execute native bulk manipulation query
08 Dec 2014 13&#58;12&#58;02,368 gratia.service(RMI TCP Connection(4261)-129.79.53.76) [WARNING]&#58; Queue&#58;&#58;clearStatusTable&#58; error when updating CollectorStatus table&#58; could not execute native bulk manipulation query
08 Dec 2014 13&#58;12&#58;02,485 gratia.service(RMI TCP Connection(4261)-129.79.53.76) [WARNING]&#58; updateStatus&#58; error when updating CollectorStatus table&#58; could not execute native bulk manipulation query
08 Dec 2014 13&#58;12&#58;02,486 gratia.service(RMI TCP Connection(4261)-129.79.53.76) [WARNING]&#58; updateStatus&#58; error when updating CollectorStatus table&#58; could not execute native bulk manipulation query
08 Dec 2014 13&#58;12&#58;02,527 gratia.service(RMI TCP Connection(4261)-129.79.53.76) [WARNING]&#58; Queue&#58;&#58;clearStatusTable&#58; error when updating CollectorStatus table&#58; could not execute native bulk manipulation query

I have restarted tomcat and replication started working again.

Should I try installing newer version of mysql-connector?
</div><script type='text/javascript'>
        $('#show_2037471533').click(function() {
            $('#detail_2037471533').slideDown("normal");
            $('#show_2037471533').hide();
            $('#hide_2037471533').show();
        });
        $('#hide_2037471533').click(function() {
            $('#detail_2037471533').slideUp();
            $('#hide_2037471533').hide();
            $('#show_2037471533').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='23419#1417811763'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-12-05T20:36:03+00:00">Dec 5, 2014 08:36 PM UTC</time> by <b>Christopher Pipes</b><a class="anchor" name="1417811763">&nbsp;</a></div><pre>Hi Tanya,

I was wondering if you could take a look at this and provide some feedback. Please let me know if this needs to be converted over to a jira ticket.

Thanks,
Chris</pre></div><div class='update_description'><i onclick="document.location='23419#1417785985'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-12-05T13:26:25+00:00">Dec 5, 2014 01:26 PM UTC</time> by <b>Soichi Hayashi</b><a class="anchor" name="1417785985">&nbsp;</a></div><pre>rsv1.grid died again during while rsv.grid was sending large amount of back-logged rsv metrics.

java.io.EOFException&#58; Can not read response from server. Expected to read 4 bytes, read 0 bytes before connection was unexpectedly lost.
at com.mysql.jdbc.MysqlIO.readFully(MysqlIO.java&#58;1997)

I&#39;ve added &#34;autoReconnect=true&#34; inside /etc/gratia/services/service-configuration.properties
<font color='#7F7E6F'>&#62; service.mysql.url=jdbc&#58;mysql&#58;//localhost&#58;3306/gratia?autoReconnect=true</font>
.. although this is not a recommended configuration according to MySQL website.. I&#39;d like to see if this helps or not.

I&#39;d appreciate if Gratia team can comment on what I need to do as far as the container configuratio nand jdbc parameters, etc..</pre></div><div class='update_description'><i onclick="document.location='23419#1417713974'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-12-04T17:26:14+00:00">Dec 4, 2014 05:26 PM UTC</time> by <b>Soichi Hayashi</b><a class="anchor" name="1417713974">&nbsp;</a></div><pre>rsv1&#39;s gratia service(mysql driver) ran out of memory again. The tomcat is currently configured with -Xmx4096M -XX&#58;MaxPermSize=2024m.

Dec 04, 2014 12&#58;25&#58;22 PM org.apache.catalina.connector.CoyoteAdapter service
SEVERE&#58; An exception or error occurred in the container during the request processing
java.lang.OutOfMemoryError&#58; Java heap space
at java.io.BufferedOutputStream.&#60;init&#62;(BufferedOutputStream.java&#58;76)
at com.mysql.jdbc.MysqlIO.&#60;init&#62;(MysqlIO.java&#58;296)
at com.mysql.jdbc.Connection.createNewIO(Connection.java&#58;2771)
at com.mysql.jdbc.Connection.&#60;init&#62;(Connection.java&#58;1555)
at com.mysql.jdbc.NonRegisteringDriver.connect(NonRegisteringDriver.java&#58;285)
at java.sql.DriverManager.getConnection(DriverManager.java&#58;571)
at java.sql.DriverManager.getConnection(DriverManager.java&#58;187)
at org.hibernate.connection.DriverManagerConnectionProvider.getConnection(DriverManagerConnectionProvider.java&#58;133)
at org.hibernate.jdbc.ConnectionManager.openConnection(ConnectionManager.java&#58;446)
at org.hibernate.jdbc.ConnectionManager.getConnection(ConnectionManager.java&#58;167)
at org.hibernate.impl.SessionImpl.doWork(SessionImpl.java&#58;1858)
at net.sf.gratia.services.HibernateWrapper$ConnectionChecker.isFullyConnected(Unknown Source)
at net.sf.gratia.services.HibernateWrapper.isFullyConnected(Unknown Source)
at net.sf.gratia.services.HibernateWrapper.isFullyConnected(Unknown Source)
at net.sf.gratia.services.HibernateWrapper.databaseUp(Unknown Source)
at net.sf.gratia.services.RecordProcessor.run(Unknown Source)

rsv.grid.iu.edu, on the other hand, with much less memory allocated (-Xmx1024M -XX&#58;MaxPermSize=256m) but running on a physical machine, haven&#39;t had any issue for more than a year. I&#39;d like to know if Gratia collecter team has any theory on why the mysql driver keeps running out of memory on rsv1. Clearly, increasing the -Xmx -XX option doesn&#39;t seem to be helping, and I am wondering if there is other configuration parameter that I need to adjust specifically for mysql driver (or maybe even update the mysql driver itself?)

Anyway, I&#39;ve restarted the rsv1, and Gratia service seems to is up and running again (as usual). However, rsv.grid.iu.edu didn&#39;t restart replication until I removed all metric replication configuration via the administration GUI. on rsv.grid.iu.edu,

Note to myself&#58; MetricRecord_Xml table only contains 46k records, and in the past I was told that replication doesn&#39;t work unless the Gratia collector has records in MetricRecord_Xml. It looks like the /usr/local/dump_xml_recores.sh has a faulty logic in it and truncating records that it shouldn&#39;t be truncating. I need to check..

Soichi</pre></div>
</div>
<script type="text/javascript">
function reset_anchor() {
    $("#updates .selected").removeClass("selected");
    var urls = document.location.toString().split('#'); 
    var anchor = urls[1];
    if(anchor) {
        $("a[name='"+anchor+"']").parents(".update_description").addClass("selected");
    }
}
function submitspam(ticket_id) {
    myret = confirm("Would you like to close this ticket as a security ticket, and submit the ticket content to akismet?");
    if(myret == true) {
        $.ajax("viewer/processspam?id="+ticket_id).done(function() {
            window.location.reload();
        });
    }
}

$(function() {
    reset_anchor();
    var ADDITIONAL_COOKIE_NAME = 'gocticket';
    var options = { path: '/', expires: 365};

    if(window.opener && window.opener.name == "gocticket_list") {
        v = $.cookie("closewindow");
        if(!v) {
            $("#closewindow").attr("checked", "checked"); //on by default
        } else {
            if(v == "checked") {
                $("#closewindow").attr("checked", "checked");
            }
        }
        $("#closewindow").click(function() {
            $.cookie("closewindow", $(this).attr('checked'), options);
        });
    } else {
        $("#closewindow_area").hide();
    }
    function updateTimeago() {
        $("time").timeago();
        setTimeout(updateTimeago, 30*1000);
    }
    updateTimeago();
    $(".description").focus(expand_description);
});
</script>
<hr/>
<footer>
<p>GOC Ticket Version 2.2 | <a href="https://ticket.opensciencegrid.org/goc/submit?app_issue_check=on&amp;app_issue_type=goc&amp;app_goc_url=https%3A%2F%2Fticket.opensciencegrid.org%3A443%2F23419">Report Bugs</a>
 | <a href="https://github.com/opensciencegrid/operations/blob/master/docs/privacy.md">Privacy Policy</a>
</p>

<p> <img align="top" src="images/tag_orange.png"/> Copyright 2018 The Trustees of Indiana University - Developed for Open Science Grid</p>
</footer>


</div><!--container-fluid-->
<script>
//used by searchbox
function parseValue(value) {
    var obj = new Object();
    var tokens = value.split("\t");
    obj.str = tokens[0];
    obj.count = tokens[1];
    return obj;
}

$(function() {
    //bootstrap-2.0.4 stuff
    $(".alert-message").alert();
    $(".dropdown-toggle").dropdown();
    $("span[rel='tooltip']").tooltip();
    $("a[rel=popover]").popover();

    //activate menu that user is currently on
    $("#menu_navigator").addClass("active"); 
    $("#submenu_").addClass("active"); 

    //translate zend validation error message to bootstrap
    $(".errors").addClass("alert").addClass("alert-error");

    //enable autocomplete for search box
    $("#search").autocomplete({
        source: function( request, response ) {
            $.ajax({
                url: "search/autocomplete",
                dataType: "text",
                data: {
                    //featureClass: "P",
                    //style: "full",
                    //maxRows: 12,
                    //name_startsWith: request.term
                    q: request.term
                },
                success: function( data ) {
                    response( $.map( data.split("\n"), function( item ) {
                        if(item == "") return null;
                        return {
                            value: item
                        }
                    }));
                }
            });
        },
        select: function(event, ui) {
            document.location = "search?q="+ui.item.value;
        }
    });
    
});
</script>


</body>
