<!DOCTYPE html>
<html lang="en">
  <head>
  <base href="">
    <title>[20746] Site&#39;s CE not found by WMS/BDII?</title>    <meta charset="utf-8" />
    <meta name="verify-v1" content="na5IcAJsZVOfEkboRxuIiZ1zpZgnZiWra+nKcS7nA/o=" />
    <meta name="google-site-verification" content="DLrk3ft4s8b-S2TloLCL2LD_t6wcTjgSluf5pmiu2kA" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />
    <link href="https://ticket.opensciencegrid.org/rss" rel="alternate" type="application/rss+xml" title="GOC Ticket Update feed" />

    <style type="text/css">
      body {
        padding-top: 50px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
     #search {
            width: 300px;
     }

    </style>

<script src="https://code.jquery.com/jquery-3.0.0.js"></script>
<script src="https://code.jquery.com/jquery-migrate-3.0.1.js"></script>

   <link href="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet"/>
    <script src="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/js/bootstrap.min.js"></script>

    <link href="https://netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"/>
    <link href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/themes/smoothness/jquery-ui.min.css" rel="stylesheet"/>
 <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>


    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/js/select2.min.js"></script>

    <link href="css/ticket.css" rel="stylesheet" />
    <script src="lib/jquery.cookie.js"></script>

    <link href="images/tag_orange.png" rel="icon" type="image/png"/>
  </head>

  <body>
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>

            <a class="brand" style="padding: 6px 0px 0px 6px;" href="http://opensciencegrid.org"><img src="images/osglogo.40x30.png"/></a>
            <ul class="nav">
                <li class="dropdown"><a href="https://ticket.opensciencegrid.org/#" class="dropdown-toggle" data-toggle="dropdown">GOC Ticket <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    <li><a href="https://my.opensciencegrid.org">MyOSG</a></li>
                    <li><a href="https://oim.opensciencegrid.org">OIM</a></li>
                    <li class="active"><a href="https://ticket.opensciencegrid.org/index">Ticket</a></li>
	<li class="divider"></li>
	<li><a href="http://repo.grid.iu.edu">Repo</a></li>
	<li class="divider"></li>
	<li><a href="http://blogs.grid.iu.edu">Blog</a></li>
                    <li><a href="http://display.grid.iu.edu">Display</a></li>
                    <li><a href="http://osggoc.blogspot.com/">News</a></li>
                    </ul>
                </li>
            </ul>
            <ul class="nav pull-right">
                <li><a href="https://ticket.opensciencegrid.org/sso/">Login</a></li>            </ul>

            <div class="nav-collapse">
                <ul class="nav">
			 <li id="menu_submit"><a href="https://ticket.opensciencegrid.org/submit">Submit</a></li><li id="menu_view" class="dropdown"><a href="https://ticket.opensciencegrid.org/\#" class="dropdown-toggle" data-toggle="dropdown">View <b class="caret"></b></a><ul class="dropdown-menu"><li id="submenu_listopen"><a href="https://ticket.opensciencegrid.org/list/open">Open Tickets</a></li><li id="submenu_listrecentclose"><a href="https://ticket.opensciencegrid.org/list/recentclose">Recently Closed Tickets</a></li><li class="divider"></li><li id="submenu_alltickets"><a href="https://ticket.opensciencegrid.org/search?q=&amp;sort=id">All Tickets</a></li></ul></li>                </ul>

                <form class="navbar-search pull-right" action="https://ticket.opensciencegrid.org/viewer">
                    <input id="search" type="text" name="id" class="search-query span2" placeholder="Search Ticket" value=""/>
                </form>
            </div>
        </div>
      </div>
    </div>

<script type='text/javascript' src='lib/jquery.timeago.js'></script>
<script type='text/javascript' src='lib/byte2size.js'></script>
<style>
#updates .toolbar {
position: relative;
margin-top: 0px;
top: -10px;
font-weight: normal;
}
#updates a.anchor {
position: relative;
top: -50px;
}
#updates .selected pre {
animation:selected 2s;
animation-iteration-count: 2;
animation-direction: alternate;
-webkit-animation:selected 2s; 
-webkit-animation-iteration-count: 2;
-webkit-animation-direction: alternate;
box-shadow: inset 1px 1px 20px #9ad;
border: 1px solid #9ab;
margin: 5px 0px;
padding-left: 10px;
}
@keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ab;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
@-webkit-keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ad;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
#updates pre {
background-color: inherit;
line-height: 15px;
padding: 5px;
}
#updates .header {
color: #999;
}
#updates .update_history pre {
background-color: #eee;
color: #666;
font-size: 85%;
}
#updates .clickable {
cursor: pointer;
}
#updates .clickable:hover {
color: #D98719;
}
#updates .meta_information pre {
background-color: #fed;
}
#similar_tickets {
max-height: 300px;
overflow-y: auto;
pointer-events: none;
padding: 5px;
background-color: #f4f4f4;
}
.btn-toolbar {
margin-bottom: 0;
height: 30px;
}
#peers {
position: fixed;
bottom: 0px;
right: 0px;
z-index: 100;
list-style: none;
padding: 5px 0px 0px 5px;
margin: 0px;
background-color: white;
box-shadow: 0px 0px 10px white;
}
#peers li {
background-color: #ccc;
color: #000;
display: inline-block;
padding: 5px 10px;
margin-right: 5px;
position: relative;
}
/*
#peers li:hover {
background-color: #999;
cursor: pointer;
}
*/
#peers span.ip {
padding-left: 5px;
color: #666;
}
#peers .new {
bottom: -30px;
}
/*
#peers .me {
background-color: red;
}
*/
</style>

<div class="container-fluid">
<ul id="peers"></ul>
<div class="alert alert-danger"><a class="close" href="https://ticket.opensciencegrid.org/#" data-dismiss="alert">&times;</a>By the end of May 2018, the ticketing system at https://ticket.opensciencegrid.org will be retired and support will be provided at https://support.opensciencegrid.org. Throughout this transition the support email (help@opensciencegrid.org) will be available as a point of contact.<br><br>                                                   
                                                                                                                                                                                   
Please see the service migration page for details: https://opensciencegrid.github.io/technology/policy/service-migrations-spring-2018/#ticket</div><div id="presence" class="pull-right"></div><div class="ticketgui"><script type="text/javascript" src="lib/checktab.js"></script>

<script>
var expanded = false;
function expand_description() {
    var desc = $(".description");
    if(!expanded) {
        expanded = true;
        //expand to minheight
        var min = 250;
        if(desc.height() < min) {
            desc.animate({height: min}, 200);
        }
    }
}

$(document).ready(function() {
    $("input[name='nad']").datepicker({
        dateFormat: 'yy-mm-dd'
    });
});

</script>



<style>
.form-horizontal .control-label {
padding-top: inherit;
font-size:90%;
color:#666;
}
label {
margin-bottom: 0px;
}
.controls {
line-height: 18px;
}
</style>
<form class="form-horizontal" action="https://ticket.opensciencegrid.org/viewer/updatebasic?id=20746" method="post">
<div class="page-header">
    <h3><span class="muted">20746</span> / Site&#39;s CE not found by WMS/BDII?</h3>
</div>

<div class="row-fluid">
<div class="span5">
    <legend>Contact</legend>
    <div class="control-group">
        <label class="control-label">Full Name</label>
        <div class="controls">samir </div>
    </div>
    <div class="control-group">
        <label class="control-label">Email</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">Phone</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">CC</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>

    <legend>Details</legend>
    <div class="control-group"><label class="control-label">Associated VO</label><div class="controls">CMS</div></div><div class="control-group"><label class="control-label">Submitted Via</label><div class="controls">GGUS</div></div><div class="control-group"><label class="control-label">Submitter</label><div class="controls">samir</div></div><div class="control-group"><label class="control-label">Support Center</label><div class="controls">USCMS_Tier2</div></div>
    <div class="control-group">
        <label class="control-label">Ticket Type</label>
        <div class="controls">Problem/Request</div>
    </div>
    <div class="control-group">
        <label class="control-label">Priority</label>
        <div class="controls">Normal</div>
    </div>
    <div class="control-group">
        <label class="control-label">Status</label>
        <div class="controls">
Closed</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action</label>
        <div class="controls">TX Incoming</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action Deadline</label>
        <div class="controls flag_red">2014-04-16</div>
    </div>

</div><!--span-->
<div class="span7">
    <legend>Assignees</legend>
    <div class="assignee" style="width: 60%">Kyle Gross <span class="muted"> / OSG GOC Support Team</span></div><div class="assignee" style="width: 60%">USCMS Tier 2 <span class="muted"> / OSG Support Centers</span></div><div class="assignee" style="width: 60%">GGUS (Prod)&nbsp;<a target="_blank" href="https://ggus.eu/ws/ticket_info.php?ticket=103174">103174</a> <span class="muted"> / Ticket Exchange</span></div>    <br>

    <legend>Assignees</legend>
    TODO
    <br>

    <style>
legend.noborder {
border-bottom: none;
}
</style>

<div id="attachment-list"/>
<script>
$(function () {
    var first = true;
    $.getJSON("attachment/list/20746", function (files) {
        //console.dir(files);
        var html = "<table class=\"table table-condensed\">";
        $(files).each(function() {
            if(first) {
                first = false;
                html += "<legend class=\"noborder\">Attachmenets</legend>";
            }
            html += "<tr class=\"attachment\">";
            html += "<td><img src=\""+this.thumbnail_url+"\"/></td>";
            html += "<td><a href=\""+this.url+"\" target=\"_blank\">"+this.name+"</a></td>";
            html += "<td>"+bytesToSize(this.size, 1)+"</td>";
            html += "</tr>";
        });
        html += "</table>";
        $("#attachment-list").html(html);
    });
});

function download(url) {
    window.open(url, "_blank");
}
</script>


</div><!--span-->
</div><!--row-fluid-->


</form>

</div>
<div id="updates" style="clear: both;">
    <legend>Past Updates
    <div class="btn-toolbar pull-right toolbar">
        <div class="btn-group">
                <a class="btn btn-small" href="https://ticket.opensciencegrid.org/20746?sort=up&amp;"><i class="icon-arrow-up"></i> Sort</a>

        
        <a class="btn btn-small" href="https://ticket.opensciencegrid.org/20746?expandall=true&amp;">Expand Descriptions</a>        <a class="btn btn-small" target="_blank" href="mailto:osg@tick.globalnoc.iu.edu?subject=Open%20Science%20Grid%3A%20Site%26%2339%3Bs%20CE%20not%20found%20by%20WMS%2FBDII%3F%20ISSUE%3D20746%20PROJ%3D71"><i class="icon-envelope"></i> Update w/Email</a>
        </div>
    </div><!--btn-toolbar-->
    </legend>

    <div class='update_description'><i onclick="document.location='20746#1400544013'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-05-20T00:00:13+00:00">May 20, 2014 12:00 AM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1400544013">&nbsp;</a></div><pre>This ticket was closed automatically. If this issue has not been resolved according your expectations or if you need further information, please submit a new ticket referencing this one.

-- by SYSTEM at Mon May 19 23&#58;59&#58;11 UTC 2014

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=103174' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=103174</a></pre></div><div class='update_description'><i onclick="document.location='20746#1399293261'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-05-05T12:34:21+00:00">May 5, 2014 12:34 PM UTC</time> by <b>Kyle Gross</b><a class="anchor" name="1399293261">&nbsp;</a></div><pre>Closing this ticket per Samir&#39;s update.</pre></div><div class='update_description'><i onclick="document.location='20746#1398272118'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-04-23T16:55:18+00:00">Apr 23, 2014 04:55 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1398272118">&nbsp;</a></div><pre>Hi,

The CE looks ok, but its software is a bit old now. The twin CE has the same hardware/software but we don&#39;t see the same problem on it. Anyway, after your report it looks like that something is wrong in the CE side.

I&#39;m working on upgrading my both CEs to the latest versions of GRAM CE. That might help. As there&#39;s nothing to be checked in the BDII side for now, feel free to close the ticket. Thanks for following up.

Cheers,
Samir

-- by samir at Wed Apr 23 16&#58;54&#58;50 UTC 2014

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=103174' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=103174</a></pre></div><div class='update_description'><i onclick="document.location='20746#1397664391'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-04-16T16:06:31+00:00">Apr 16, 2014 04:06 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1397664391">&nbsp;</a></div><pre>Seems to be &#58;

<a href='https&#58;//ticket.grid.iu.edu/18433' target='_blank' rel='nofollow'>https&#58;//ticket.grid.iu.edu/18433</a>

Coming back. More details from the SAM side at &#58;

<a href='https&#58;//hypernews.cern.ch/HyperNews/CMS/get/comp-monitoring/275.html' target='_blank' rel='nofollow'>https&#58;//hypernews.cern.ch/HyperNews/CMS/get/comp-monitoring/275.html</a>

(let me know if you don&#39;t have accesss).

Clearly CERN BDII works but OSG&#39;s (?) doesn&#39;t &#58;

[root@nagios ~]# ldapsearch -h lcg-bdii.cern.ch -p 2170 -x -b Mds-Vo-name=local,o=grid &#39;(&(objectClass=GlueCE)(|(GlueCEAccessControlBaseRule=VO&#58;CMS)(GlueCEAccessControlBaseRule=VOMS&#58;/CMS/Role=production)))&#39; GlueSiteUniqueID -LLL | perl -p -00 -e &#39;s/&#92;n //g;&#39;|grep -i &#39;Mds-Vo-name=CIT_CMS_T2,&#39;
dn&#58; GlueCEUniqueID=cit-gatekeeper2.ultralight.org&#58;2119/jobmanager-condor-cms_user,Mds-Vo-name=CIT_CMS_T2,Mds-Vo-name=local,o=grid
dn&#58; GlueCEUniqueID=cit-gatekeeper2.ultralight.org&#58;2119/jobmanager-condor-cms_monitor,Mds-Vo-name=CIT_CMS_T2,Mds-Vo-name=local,o=grid
dn&#58; GlueCEUniqueID=cit-gatekeeper2.ultralight.org&#58;2119/jobmanager-condor-cms_priority,Mds-Vo-name=CIT_CMS_T2,Mds-Vo-name=local,o=grid
dn&#58; GlueCEUniqueID=cit-gatekeeper2.ultralight.org&#58;2119/jobmanager-condor-cms_production,Mds-Vo-name=CIT_CMS_T2,Mds-Vo-name=local,o=grid
[root@nagios ~]# ldapsearch -h is.grid.iu.edu -p 2170 -x -b Mds-Vo-name=local,o=grid &#39;(&(objectClass=GlueCE)(|(GlueCEAccessControlBaseRule=VO&#58;CMS)(GlueCEAccessControlBaseRule=VOMS&#58;/CMS/Role=production)))&#39; GlueSiteUniqueID -LLL | perl -p -00 -e &#39;s/&#92;n //g;&#39;|grep -i &#39;Mds-Vo-name=CIT_CMS_T2,&#39;
[root@nagios ~]#

Affected Site&#58; CIT_CMS_T2

[Ticket Origin]
<a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=103174' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=103174</a>

[Ticket History]
Subject&#58; Site&#39;s CE not found by WMS/BDII?
Ticket Type&#58; USER
CC&#58; ;tier2admin@....
-- by samir at Tue Apr 08 21&#58;28&#58;15 UTC 2014

-- by Alessandro Paolini at Wed Apr 09 06&#58;54&#58;40 UTC 2014

Hi Again,

<div id='show_1868696566' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_1868696566'>It seems that the problem is intermittent, so if it can be found before it disappears again it will be great.

As of now, both BDIIs seem happy &#58; [1]

But this is what I&#39;m getting from the SAM Nagios web interface &#58;

CRITICAL&#58; [Waiting-&#62;Cancelled [timeout/dropped]] &#39;BrokerHelper&#58; no compatible resources&#39;. <a href='https&#58;//wms305.cern.ch&#58;9000/9uuNmLdSauN_aPse8-ecKQ' target='_blank' rel='nofollow'>https&#58;//wms305.cern.ch&#58;9000/9uuNmLdSauN_aPse8-ecKQ</a>

<a href='https&#58;//sam-cms-prod.cern.ch/nagios/cgi-bin/status.cgi?host=cit-gatekeeper2.ultralight.org&style=detail' target='_blank' rel='nofollow'>https&#58;//sam-cms-prod.cern.ch/nagios/cgi-bin/status.cgi?host=cit-gatekeeper2.ultralight.org&style=detail</a>

Thanks,
Samir

[1] &#58;

[root@cithep231 ~]# ldapsearch -h is.grid.iu.edu -p 2170 -x -b Mds-Vo-name=local,o=grid &#39;(&(objectClass=GlueCE)(|(GlueCEAccessControlBaseRule=VO&#58;CMS)(GlueCEAccessControlBaseRule=VOMS&#58;/CMS/Role=production)))&#39; GlueSiteUniqueID -LLL | perl -p -00 -e &#39;s/&#92;n //g;&#39;|grep -i &#39;Mds-Vo-name=CIT_CMS_T2,&#39;
dn&#58; GlueCEUniqueID=cit-gatekeeper.ultralight.org&#58;2119/jobmanager-condor-cms_monitor,Mds-Vo-name=CIT_CMS_T2,Mds-Vo-name=local,o=grid
dn&#58; GlueCEUniqueID=cit-gatekeeper.ultralight.org&#58;2119/jobmanager-condor-cms_user,Mds-Vo-name=CIT_CMS_T2,Mds-Vo-name=local,o=grid
dn&#58; GlueCEUniqueID=cit-gatekeeper.ultralight.org&#58;2119/jobmanager-condor-cms_priority,Mds-Vo-name=CIT_CMS_T2,Mds-Vo-name=local,o=grid
dn&#58; GlueCEUniqueID=cit-gatekeeper.ultralight.org&#58;2119/jobmanager-condor-cms_production,Mds-Vo-name=CIT_CMS_T2,Mds-Vo-name=local,o=grid
dn&#58; GlueCEUniqueID=cit-gatekeeper2.ultralight.org&#58;2119/jobmanager-condor-cms_monitor,Mds-Vo-name=CIT_CMS_T2,Mds-Vo-name=local,o=grid
dn&#58; GlueCEUniqueID=cit-gatekeeper2.ultralight.org&#58;2119/jobmanager-condor-cms_user,Mds-Vo-name=CIT_CMS_T2,Mds-Vo-name=local,o=grid
dn&#58; GlueCEUniqueID=cit-gatekeeper2.ultralight.org&#58;2119/jobmanager-condor-cms_priority,Mds-Vo-name=CIT_CMS_T2,Mds-Vo-name=local,o=grid
dn&#58; GlueCEUniqueID=cit-gatekeeper2.ultralight.org&#58;2119/jobmanager-condor-cms_production,Mds-Vo-name=CIT_CMS_T2,Mds-Vo-name=local,o=grid
[root@cithep231 ~]# ldapsearch -h lcg-bdii.cern.ch -p 2170 -x -b Mds-Vo-name=local,o=grid &#39;(&(objectClass=GlueCE)(|(GlueCEAccessControlBaseRule=VO&#58;CMS)(GlueCEAccessControlBaseRule=VOMS&#58;/CMS/Role=production)))&#39; GlueSiteUniqueID -LLL | perl -p -00 -e &#39;s/&#92;n //g;&#39;|grep -i &#39;Mds-Vo-name=CIT_CMS_T2,&#39;
dn&#58; GlueCEUniqueID=cit-gatekeeper2.ultralight.org&#58;2119/jobmanager-condor-cms_user,Mds-Vo-name=CIT_CMS_T2,Mds-Vo-name=local,o=grid
dn&#58; GlueCEUniqueID=cit-gatekeeper2.ultralight.org&#58;2119/jobmanager-condor-cms_monitor,Mds-Vo-name=CIT_CMS_T2,Mds-Vo-name=local,o=grid
dn&#58; GlueCEUniqueID=cit-gatekeeper2.ultralight.org&#58;2119/jobmanager-condor-cms_priority,Mds-Vo-name=CIT_CMS_T2,Mds-Vo-name=local,o=grid
dn&#58; GlueCEUniqueID=cit-gatekeeper2.ultralight.org&#58;2119/jobmanager-condor-cms_production,Mds-Vo-name=CIT_CMS_T2,Mds-Vo-name=local,o=grid
dn&#58; GlueCEUniqueID=cit-gatekeeper.ultralight.org&#58;2119/jobmanager-condor-cms_user,Mds-Vo-name=CIT_CMS_T2,Mds-Vo-name=local,o=grid
dn&#58; GlueCEUniqueID=cit-gatekeeper.ultralight.org&#58;2119/jobmanager-condor-cms_monitor,Mds-Vo-name=CIT_CMS_T2,Mds-Vo-name=local,o=grid
dn&#58; GlueCEUniqueID=cit-gatekeeper.ultralight.org&#58;2119/jobmanager-condor-cms_priority,Mds-Vo-name=CIT_CMS_T2,Mds-Vo-name=local,o=grid
dn&#58; GlueCEUniqueID=cit-gatekeeper.ultralight.org&#58;2119/jobmanager-condor-cms_production,Mds-Vo-name=CIT_CMS_T2,Mds-Vo-name=local,o=grid

-- by samir at Thu Apr 10 19&#58;33&#58;27 UTC 2014

Hello all,

I noticed one thing yesterday&#58; occasionally, the GlueCEStateStatus of this computing element in sam-bdii.cern.ch becomes &#34;Unknown&#34;. This would explain the job matching failures in the SAM gliteWMS.

The problem seems to be that the BDII used by SAM (sam-bdii.cern.ch) is intermittently out of sync with the OSG BDII (is.grid.iu.edu) and top-level LCG BDII (lcg-bdii.cern.ch). Yesterday around 13&#58;30 CERN time the following queries gave different results&#58;

<font color='#7F7E6F'>&#62; ldapsearch -h sam-bdii.cern.ch -p 2170 -x -b Mds-Vo-name=local,o=grid &#39;(GlueCEInfoHostName=cit-gatekeeper*.ultralight.org)&#39; GlueCEStateStatus</font>
<font color='#7F7E6F'>&#62; ldapsearch -h lcg-bdii.cern.ch -p 2170 -x -b Mds-Vo-name=local,o=grid &#39;(GlueCEInfoHostName=cit-gatekeeper*.ultralight.org)&#39; GlueCEStateStatus</font>
<font color='#7F7E6F'>&#62; ldapsearch -h is.grid.iu.edu  -p 2170 -x -b Mds-Vo-name=local,o=grid &#39;(GlueCEInfoHostName=cit-gatekeeper*.ultralight.org)&#39; GlueCEStateStatus</font>

Unfortunately I&#39;m not able to reproduce the issue right now, hopefully the BDII experts can check the servers to see if there was anything wrong at the time.

Samir also reported this issue for cit-gatekeeper2.ultralight.org around 21.30 CERN time yesterday.

Cheers,
Nicolo&#39;

-- by Nicolo.Magini at Fri Apr 11 10&#58;45&#58;53 UTC 2014

Hi,

assigning to ROC_CERN and notifying Maria Alandes as BDII expert.

Cheers
Nicolo&#39;
Changed problem type to&#58; Information System

-- by Nicolo.Magini at Fri Apr 11 10&#58;51&#58;01 UTC 2014

CERN ticket reference&#58; <a href='https&#58;//cern.service-now.com/nav_to.do?uri=incident.do?sysparm_query=number=INC0533786' target='_blank' rel='nofollow'>https&#58;//cern.service-now.com/nav_to.do?uri=incident.do?sysparm_query=number=INC0533786</a>

-- by SYSTEM at Fri Apr 11 10&#58;51&#58;26 UTC 2014

Assignemnt group&#58; BDII 2nd Line Support

-- by hakan.ilhan@.... at Fri Apr 11 10&#58;54&#58;54 UTC 2014

SAM BDII has a cache of 12h. lcg-bdii has a cache of 12h as well. I&#39;m not sure the OSG BDII is a top BDII, so I don&#39;t know whether it has a cache. Who can confirm this?

So in terms of cache they seem to be pretty similar and we should be able to see similar values. Right now I see the same values published for the 3 BDIIs in the queries posted by Nicolo in update#3. Please, ping me again if this problem comes back so that I can have a look.

Looking at the sam-bdii logs, CIT_CMS_T2 could be contacted without any problem at all times yesterday, the command below returns nothing, which means there were no errors logged for CIT_CMS_T2&#58;

more /var/lib/bdii/gip/tmp/gip/log/top-urls.conf/top-urls.conf-2014-04-10.log | grep CIT_CMS_T2

I can&#39;t get more info than this right now, so the only way would be to debug the problem if it happens again.

-- by Maria Alandes Pradillo at Fri Apr 11 12&#58;45&#58;35 UTC 2014

Interesting, the problem is that as happened before the turnaround time of the ticket is usually not fast enough to catch the problem (3 days this time?). If there is any faster way to get people to look at it it might help next time.

Also, there is any way to reproduce (or try to simulate) the problem? For example, turning off BDII publication in the CE.

Thanks,
Samir

-- by samir at Fri Apr 11 15&#58;44&#58;29 UTC 2014

The issue is happening again &#58;

[root@cithep231 ~]# ldapsearch -h lcg-bdii.cern.ch -p 2170 -x -b Mds-Vo-name=local,o=grid &#39;(&(objectClass=GlueCE)(|(GlueCEAccessControlBaseRule=VO&#58;CMS)(GlueCEAccessControlBaseRule=VOMS&#58;/CMS/Role=production)))&#39; GlueSiteUniqueID -LLL | perl -p -00 -e &#39;s/&#92;n //g;&#39;|grep -i &#39;Mds-Vo-name=CIT_CMS_T2,&#39;
dn&#58; GlueCEUniqueID=cit-gatekeeper.ultralight.org&#58;2119/jobmanager-condor-cms_user,Mds-Vo-name=CIT_CMS_T2,Mds-Vo-name=local,o=grid
dn&#58; GlueCEUniqueID=cit-gatekeeper.ultralight.org&#58;2119/jobmanager-condor-cms_monitor,Mds-Vo-name=CIT_CMS_T2,Mds-Vo-name=local,o=grid
dn&#58; GlueCEUniqueID=cit-gatekeeper.ultralight.org&#58;2119/jobmanager-condor-cms_priority,Mds-Vo-name=CIT_CMS_T2,Mds-Vo-name=local,o=grid
dn&#58; GlueCEUniqueID=cit-gatekeeper.ultralight.org&#58;2119/jobmanager-condor-cms_production,Mds-Vo-name=CIT_CMS_T2,Mds-Vo-name=local,o=grid
dn&#58; GlueCEUniqueID=cit-gatekeeper2.ultralight.org&#58;2119/jobmanager-condor-cms_user,Mds-Vo-name=CIT_CMS_T2,Mds-Vo-name=local,o=grid
dn&#58; GlueCEUniqueID=cit-gatekeeper2.ultralight.org&#58;2119/jobmanager-condor-cms_monitor,Mds-Vo-name=CIT_CMS_T2,Mds-Vo-name=local,o=grid
dn&#58; GlueCEUniqueID=cit-gatekeeper2.ultralight.org&#58;2119/jobmanager-condor-cms_priority,Mds-Vo-name=CIT_CMS_T2,Mds-Vo-name=local,o=grid
dn&#58; GlueCEUniqueID=cit-gatekeeper2.ultralight.org&#58;2119/jobmanager-condor-cms_production,Mds-Vo-name=CIT_CMS_T2,Mds-Vo-name=local,o=grid
[root@cithep231 ~]# ldapsearch -h is.grid.iu.edu -p 2170 -x -b Mds-Vo-name=local,o=grid &#39;(&(objectClass=GlueCE)(|(GlueCEAccessControlBaseRule=VO&#58;CMS)(GlueCEAccessControlBaseRule=VOMS&#58;/CMS/Role=production)))&#39; GlueSiteUniqueID -LLL | perl -p -00 -e &#39;s/&#92;n //g;&#39;|grep -i &#39;Mds-Vo-name=CIT_CMS_T2,&#39;
dn&#58; GlueCEUniqueID=cit-gatekeeper.ultralight.org&#58;2119/jobmanager-condor-cms_monitor,Mds-Vo-name=CIT_CMS_T2,Mds-Vo-name=local,o=grid
dn&#58; GlueCEUniqueID=cit-gatekeeper.ultralight.org&#58;2119/jobmanager-condor-cms_user,Mds-Vo-name=CIT_CMS_T2,Mds-Vo-name=local,o=grid
dn&#58; GlueCEUniqueID=cit-gatekeeper.ultralight.org&#58;2119/jobmanager-condor-cms_priority,Mds-Vo-name=CIT_CMS_T2,Mds-Vo-name=local,o=grid
dn&#58; GlueCEUniqueID=cit-gatekeeper.ultralight.org&#58;2119/jobmanager-condor-cms_production,Mds-Vo-name=CIT_CMS_T2,Mds-Vo-name=local,o=grid
dn&#58; GlueCEUniqueID=cit-gatekeeper2.ultralight.org&#58;2119/jobmanager-condor-cms_monitor,Mds-Vo-name=CIT_CMS_T2,Mds-Vo-name=local,o=grid
dn&#58; GlueCEUniqueID=cit-gatekeeper2.ultralight.org&#58;2119/jobmanager-condor-cms_user,Mds-Vo-name=CIT_CMS_T2,Mds-Vo-name=local,o=grid
dn&#58; GlueCEUniqueID=cit-gatekeeper2.ultralight.org&#58;2119/jobmanager-condor-cms_priority,Mds-Vo-name=CIT_CMS_T2,Mds-Vo-name=local,o=grid
dn&#58; GlueCEUniqueID=cit-gatekeeper2.ultralight.org&#58;2119/jobmanager-condor-cms_production,Mds-Vo-name=CIT_CMS_T2,Mds-Vo-name=local,o=grid

CRITICAL&#58; [Waiting-&#62;Cancelled [timeout/dropped]] &#39;BrokerHelper&#58; no compatible resources&#39;. <a href='https&#58;//wms304.cern.ch&#58;9000/1E7HJ2O5hAU7N7S7HXhmYA' target='_blank' rel='nofollow'>https&#58;//wms304.cern.ch&#58;9000/1E7HJ2O5hAU7N7S7HXhmYA</a>

Could you please have a look?

Thanks,
Samir

-- by samir at Tue Apr 15 21&#58;17&#58;02 UTC 2014

Yes, I see some queues in the SAM BDII are publishing status Unknow. I&#39;m having a look.

-- by Maria Alandes Pradillo at Wed Apr 16 07&#58;59&#58;19 UTC 2014

Right now, 2 out of the 3 SAM BDII machines behind the alias are publishing the Unknown status.

ldapsearch -x -LLL -h sambdii03.cern.ch -p 2170 -x -b Mds-Vo-name=local,o=grid &#39;(GlueCEInfoHostName=cit-gatekeeper*.ultralight.org)&#39; GlueCEStateStatus | grep GlueCEStateStatus&#58;
GlueCEStateStatus&#58; Production
GlueCEStateStatus&#58; Production
GlueCEStateStatus&#58; Production
GlueCEStateStatus&#58; Production
GlueCEStateStatus&#58; Production
GlueCEStateStatus&#58; Production
GlueCEStateStatus&#58; Production
GlueCEStateStatus&#58; Production
GlueCEStateStatus&#58; Production
GlueCEStateStatus&#58; Production
GlueCEStateStatus&#58; Production
GlueCEStateStatus&#58; Production
[lxadm14] /afs/cern.ch/user/m/malandes &#62;  ldapsearch -x -LLL -h sambdii01.cern.ch -p 2170 -x -b Mds-Vo-name=local,o=grid &#39;(GlueCEInfoHostName=cit-gatekeeper*.ultralight.org)&#39; GlueCEStateStatus | grep GlueCEStateStatus&#58;
GlueCEStateStatus&#58; Unknown
GlueCEStateStatus&#58; Unknown
GlueCEStateStatus&#58; Unknown
GlueCEStateStatus&#58; Unknown
GlueCEStateStatus&#58; Unknown
GlueCEStateStatus&#58; Unknown
GlueCEStateStatus&#58; Production
GlueCEStateStatus&#58; Production
GlueCEStateStatus&#58; Production
GlueCEStateStatus&#58; Production
GlueCEStateStatus&#58; Production
GlueCEStateStatus&#58; Production
[lxadm14] /afs/cern.ch/user/m/malandes &#62;  ldapsearch -x -LLL -h sambdii02.cern.ch -p 2170 -x -b Mds-Vo-name=local,o=grid &#39;(GlueCEInfoHostName=cit-gatekeeper*.ultralight.org)&#39; GlueCEStateStatus | grep GlueCEStateStatus&#58;
GlueCEStateStatus&#58; Unknown
GlueCEStateStatus&#58; Unknown
GlueCEStateStatus&#58; Unknown
GlueCEStateStatus&#58; Unknown
GlueCEStateStatus&#58; Unknown
GlueCEStateStatus&#58; Unknown
GlueCEStateStatus&#58; Production
GlueCEStateStatus&#58; Production
GlueCEStateStatus&#58; Production
GlueCEStateStatus&#58; Production
GlueCEStateStatus&#58; Production
GlueCEStateStatus&#58; Production

-- by Maria Alandes Pradillo at Wed Apr 16 08&#58;18&#58;50 UTC 2014

Dear all,

After observing the behaviour for a while, it seems that host cit-gatekeeper2.ultralight.org comes and goes in an intermittent way. Depending on when we query the CIT_CMS_T2 site, you may or may not get info for this host. If the host disappears, then BDII correctly publishes status &#39;Unknown&#39;. If the CE is there, then we see Production.

Right now if you query&#58;

[lxadm14] /afs/cern.ch/user/m/malandes &#62; date
Wed Apr 16 10&#58;50&#58;14 CEST 2014
[lxadm14] /afs/cern.ch/user/m/malandes &#62;  ldapsearch -x -LLL -h is.grid.iu.edu&#58;2180 -b Mds-Vo-name=CIT_CMS_T2,o=grid &#39;(GlueCEInfoHostName=cit-gatekeeper*.ultralight.org)&#39; GlueCEUniqueID | perl -p -00 -e &#39;s/&#92;n //g&#39; | grep GlueCEUniqueID&#58; | wc -l
6

The CE has disappeared.

If you check some of the top BDIIs behind alias lcg-bdii, depending on when they last contacted CIT_CMS_T2, they may or may not see the missing CE&#58;

[root@topbdii01 ~]#  more /var/lib/bdii/gip/cache/gip/top-urls.conf/CIT_CMS_T2.ldif | grep &#34;GlueCEUniqueID&#58;&#34;
GlueCEUniqueID&#58; cit-gatekeeper.ultralight.org&#58;2119/jobmanager-condor-cms_monit
GlueCEUniqueID&#58; cit-gatekeeper.ultralight.org&#58;2119/jobmanager-condor-default
GlueCEUniqueID&#58; cit-gatekeeper.ultralight.org&#58;2119/jobmanager-condor-cms_user
GlueCEUniqueID&#58; cit-gatekeeper.ultralight.org&#58;2119/jobmanager-condor-osg_user
GlueCEUniqueID&#58; cit-gatekeeper.ultralight.org&#58;2119/jobmanager-condor-cms_prior
GlueCEUniqueID&#58; cit-gatekeeper.ultralight.org&#58;2119/jobmanager-condor-cms_produ

[root@topbdii05 ~]# more /var/lib/bdii/gip/cache/gip/top-urls.conf/CIT_CMS_T2.ldif | grep &#34;GlueCEUniqueID&#58;&#34;
GlueCEUniqueID&#58; cit-gatekeeper.ultralight.org&#58;2119/jobmanager-condor-cms_monit
GlueCEUniqueID&#58; cit-gatekeeper.ultralight.org&#58;2119/jobmanager-condor-default
GlueCEUniqueID&#58; cit-gatekeeper.ultralight.org&#58;2119/jobmanager-condor-cms_user
GlueCEUniqueID&#58; cit-gatekeeper.ultralight.org&#58;2119/jobmanager-condor-osg_user
GlueCEUniqueID&#58; cit-gatekeeper.ultralight.org&#58;2119/jobmanager-condor-cms_prior
GlueCEUniqueID&#58; cit-gatekeeper.ultralight.org&#58;2119/jobmanager-condor-cms_produ
GlueCEUniqueID&#58; cit-gatekeeper2.ultralight.org&#58;2119/jobmanager-condor-cms_moni
GlueCEUniqueID&#58; cit-gatekeeper2.ultralight.org&#58;2119/jobmanager-condor-default
GlueCEUniqueID&#58; cit-gatekeeper2.ultralight.org&#58;2119/jobmanager-condor-cms_user
GlueCEUniqueID&#58; cit-gatekeeper2.ultralight.org&#58;2119/jobmanager-condor-osg_user
GlueCEUniqueID&#58; cit-gatekeeper2.ultralight.org&#58;2119/jobmanager-condor-cms_prio
GlueCEUniqueID&#58; cit-gatekeeper2.ultralight.org&#58;2119/jobmanager-condor-cms_prod

So the BDIIs are working fine and the reason why the values do not match are due to the instability of the cit-gatekeeper2.ultralight.org side. Since we have several machines behind each alias, in both SAM and top BDII, depending on which one is actually queried you may see this or not.

I assign the ticket to the TPM so they can assign it to CIT_CMS_T2 who can then check the availability of that CE.

-- by Maria Alandes Pradillo at Wed Apr 16 08&#58;54&#58;09 UTC 2014

-- by Zdenek Sustr at Wed Apr 16 16&#58;05&#58;26 UTC 2014
</div><script type='text/javascript'>
        $('#show_1868696566').click(function() {
            $('#detail_1868696566').slideDown("normal");
            $('#show_1868696566').hide();
            $('#hide_1868696566').show();
        });
        $('#hide_1868696566').click(function() {
            $('#detail_1868696566').slideUp();
            $('#hide_1868696566').hide();
            $('#show_1868696566').show();
        });
        </script></pre></div><legend>Similar Recent Tickets <small>modified within the last 30 days</small></legend><div id="similar_tickets"><p class="muted">No similar tickets found.</p></div>
</div>
<script type="text/javascript">
function reset_anchor() {
    $("#updates .selected").removeClass("selected");
    var urls = document.location.toString().split('#'); 
    var anchor = urls[1];
    if(anchor) {
        $("a[name='"+anchor+"']").parents(".update_description").addClass("selected");
    }
}
function submitspam(ticket_id) {
    myret = confirm("Would you like to close this ticket as a security ticket, and submit the ticket content to akismet?");
    if(myret == true) {
        $.ajax("viewer/processspam?id="+ticket_id).done(function() {
            window.location.reload();
        });
    }
}

$(function() {
    reset_anchor();
    var ADDITIONAL_COOKIE_NAME = 'gocticket';
    var options = { path: '/', expires: 365};

    if(window.opener && window.opener.name == "gocticket_list") {
        v = $.cookie("closewindow");
        if(!v) {
            $("#closewindow").attr("checked", "checked"); //on by default
        } else {
            if(v == "checked") {
                $("#closewindow").attr("checked", "checked");
            }
        }
        $("#closewindow").click(function() {
            $.cookie("closewindow", $(this).attr('checked'), options);
        });
    } else {
        $("#closewindow_area").hide();
    }
    function updateTimeago() {
        $("time").timeago();
        setTimeout(updateTimeago, 30*1000);
    }
    updateTimeago();
    $(".description").focus(expand_description);
});
</script>
<hr/>
<footer>
<p>GOC Ticket Version 2.2 | <a href="https://ticket.opensciencegrid.org/goc/submit?app_issue_check=on&amp;app_issue_type=goc&amp;app_goc_url=https%3A%2F%2Fticket.opensciencegrid.org%3A443%2F20746">Report Bugs</a>
 | <a href="https://github.com/opensciencegrid/operations/blob/master/docs/privacy.md">Privacy Policy</a>
</p>

<p> <img align="top" src="images/tag_orange.png"/> Copyright 2018 The Trustees of Indiana University - Developed for Open Science Grid</p>
</footer>


</div><!--container-fluid-->
<script src="https://ticket1.grid.iu.edu:8443/socket.io/socket.io.js"></script>
<script>
var chat = io.connect('https://ticket1.grid.iu.edu:8443');
chat.on('connect', function() {
    chat.emit('authenticate', {nodekey:'', ticketid: 20746});
});
chat.on('peers', function(peers) {
    $("#peers").html("");
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('peer_disconnect', function(pid) {
    $("#peer_"+pid).hide("slow");
});
chat.on('peer_connected', function(peers) {
    //expect only 1 peer connecting, but..
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('submit', function() {
    if(confirm("This ticket was updated. Do you want to refresh?")) {
        history.go(0);
    }
});

function addPeer(pid, peer) {
    var ipinfo = "";
    if(peer.ip != undefined) {
        ipinfo = "<span class=\"ip\">"+peer.ip+"</span>";
    }
    if(chat.io.engine.id == pid) {
        //don't display myself
        return;
    }
    var html = "<li class=\"new\" id=\"peer_"+pid+"\" class=\"peer\">"+peer.name+ipinfo+"</li>";
    $("#peers").prepend(html);
    $("#peers .new").animate({bottom: 0}, 1000, function() {$(this).removeClass("new")});
}

$(function() {
    $("#ticket_form").submit(function() {
        chat.emit('submit');
        return true;
    });
});
</script>
<script>
//used by searchbox
function parseValue(value) {
    var obj = new Object();
    var tokens = value.split("\t");
    obj.str = tokens[0];
    obj.count = tokens[1];
    return obj;
}

$(function() {
    //bootstrap-2.0.4 stuff
    $(".alert-message").alert();
    $(".dropdown-toggle").dropdown();
    $("span[rel='tooltip']").tooltip();
    $("a[rel=popover]").popover();

    //activate menu that user is currently on
    $("#menu_navigator").addClass("active"); 
    $("#submenu_").addClass("active"); 

    //translate zend validation error message to bootstrap
    $(".errors").addClass("alert").addClass("alert-error");

    //enable autocomplete for search box
    $("#search").autocomplete({
        source: function( request, response ) {
            $.ajax({
                url: "search/autocomplete",
                dataType: "text",
                data: {
                    //featureClass: "P",
                    //style: "full",
                    //maxRows: 12,
                    //name_startsWith: request.term
                    q: request.term
                },
                success: function( data ) {
                    response( $.map( data.split("\n"), function( item ) {
                        if(item == "") return null;
                        return {
                            value: item
                        }
                    }));
                }
            });
        },
        select: function(event, ui) {
            document.location = "search?q="+ui.item.value;
        }
    });
    
});
</script>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-69012-13");
pageTracker._trackPageview();
} catch(err) {}
</script>

</body>
