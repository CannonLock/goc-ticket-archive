<!DOCTYPE html>
<html lang="en">
  <head>
  <base href="">
    <title>[19499] Issue with fetch-crl/fetch-crl3</title>    <meta charset="utf-8" />
    <meta name="verify-v1" content="na5IcAJsZVOfEkboRxuIiZ1zpZgnZiWra+nKcS7nA/o=" />
    <meta name="google-site-verification" content="DLrk3ft4s8b-S2TloLCL2LD_t6wcTjgSluf5pmiu2kA" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />

    <style type="text/css">
      body {
        padding-top: 50px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
     #search {
            width: 300px;
     }

    </style>

<script src="https://code.jquery.com/jquery-3.0.0.js"></script>
<script src="https://code.jquery.com/jquery-migrate-3.0.1.js"></script>

   <link href="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet"/>
    <script src="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/js/bootstrap.min.js"></script>

    <link href="https://netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"/>
    <link href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/themes/smoothness/jquery-ui.min.css" rel="stylesheet"/>
 <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>


    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/js/select2.min.js"></script>

    <link href="css/ticket.css" rel="stylesheet" />
    <script src="lib/jquery.cookie.js"></script>

    <link href="images/tag_orange.png" rel="icon" type="image/png"/>
  </head>

  <body>
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>

            <a class="brand" style="padding: 6px 0px 0px 6px;" href="http://opensciencegrid.org"><img src="images/osglogo.40x30.png"/></a>
            <ul class="nav">
                <li class="dropdown"><a href="https://ticket.opensciencegrid.org/#" class="dropdown-toggle" data-toggle="dropdown">GOC Ticket <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    <li><a href="https://my.opensciencegrid.org">MyOSG</a></li>
                    <li><a href="https://oim.opensciencegrid.org">OIM</a></li>
                    <li class="active"><a href="https://ticket.opensciencegrid.org/index">Ticket</a></li>
	<li class="divider"></li>
	<li><a href="http://repo.grid.iu.edu">Repo</a></li>
	<li class="divider"></li>
	<li><a href="http://blogs.grid.iu.edu">Blog</a></li>
                    <li><a href="http://display.grid.iu.edu">Display</a></li>
                    <li><a href="http://osggoc.blogspot.com/">News</a></li>
                    </ul>
                </li>
            </ul>
            <ul class="nav pull-right">
                <li><a href="https://ticket.opensciencegrid.org/sso/">Login</a></li>            </ul>

            <div class="nav-collapse">
                <ul class="nav">
			 <li id="menu_submit"><a href="https://ticket.opensciencegrid.org/submit">Submit</a></li><li id="menu_view" class="dropdown"><a href="https://ticket.opensciencegrid.org/\#" class="dropdown-toggle" data-toggle="dropdown">View <b class="caret"></b></a><ul class="dropdown-menu"><li id="submenu_listopen"><a href="https://ticket.opensciencegrid.org/list/open">Open Tickets</a></li><li id="submenu_listrecentclose"><a href="https://ticket.opensciencegrid.org/list/recentclose">Recently Closed Tickets</a></li><li class="divider"></li><li id="submenu_alltickets"><a href="https://ticket.opensciencegrid.org/search?q=&amp;sort=id">All Tickets</a></li></ul></li>                </ul>

                <form class="navbar-search pull-right" action="https://ticket.opensciencegrid.org/viewer">
                    <input id="search" type="text" name="id" class="search-query span2" placeholder="Search Ticket" value=""/>
                </form>
            </div>
        </div>
      </div>
    </div>

<script type='text/javascript' src='lib/jquery.timeago.js'></script>
<script type='text/javascript' src='lib/byte2size.js'></script>
<style>
#updates .toolbar {
position: relative;
margin-top: 0px;
top: -10px;
font-weight: normal;
}
#updates a.anchor {
position: relative;
top: -50px;
}
#updates .selected pre {
animation:selected 2s;
animation-iteration-count: 2;
animation-direction: alternate;
-webkit-animation:selected 2s; 
-webkit-animation-iteration-count: 2;
-webkit-animation-direction: alternate;
box-shadow: inset 1px 1px 20px #9ad;
border: 1px solid #9ab;
margin: 5px 0px;
padding-left: 10px;
}
@keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ab;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
@-webkit-keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ad;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
#updates pre {
background-color: inherit;
line-height: 15px;
padding: 5px;
}
#updates .header {
color: #999;
}
#updates .update_history pre {
background-color: #eee;
color: #666;
font-size: 85%;
}
#updates .clickable {
cursor: pointer;
}
#updates .clickable:hover {
color: #D98719;
}
#updates .meta_information pre {
background-color: #fed;
}
#similar_tickets {
max-height: 300px;
overflow-y: auto;
pointer-events: none;
padding: 5px;
background-color: #f4f4f4;
}
.btn-toolbar {
margin-bottom: 0;
height: 30px;
}
#peers {
position: fixed;
bottom: 0px;
right: 0px;
z-index: 100;
list-style: none;
padding: 5px 0px 0px 5px;
margin: 0px;
background-color: white;
box-shadow: 0px 0px 10px white;
}
#peers li {
background-color: #ccc;
color: #000;
display: inline-block;
padding: 5px 10px;
margin-right: 5px;
position: relative;
}
/*
#peers li:hover {
background-color: #999;
cursor: pointer;
}
*/
#peers span.ip {
padding-left: 5px;
color: #666;
}
#peers .new {
bottom: -30px;
}
/*
#peers .me {
background-color: red;
}
*/
</style>

<div class="container-fluid">
<ul id="peers"></ul>
<div class="alert alert-danger"><a class="close" href="https://ticket.opensciencegrid.org/#" data-dismiss="alert">&times;</a>By the end of May 2018, the ticketing system at https://ticket.opensciencegrid.org will be retired and support will be provided at https://support.opensciencegrid.org. Throughout this transition the support email (help@opensciencegrid.org) will be available as a point of contact.<br><br>                                                   
                                                                                                                                                                                   
Please see the service migration page for details: https://opensciencegrid.github.io/technology/policy/service-migrations-spring-2018/#ticket</div><div id="presence" class="pull-right"></div><div class="ticketgui"><script type="text/javascript" src="lib/checktab.js"></script>

<script>
var expanded = false;
function expand_description() {
    var desc = $(".description");
    if(!expanded) {
        expanded = true;
        //expand to minheight
        var min = 250;
        if(desc.height() < min) {
            desc.animate({height: min}, 200);
        }
    }
}

$(document).ready(function() {
    $("input[name='nad']").datepicker({
        dateFormat: 'yy-mm-dd'
    });
});

</script>



<style>
.form-horizontal .control-label {
padding-top: inherit;
font-size:90%;
color:#666;
}
label {
margin-bottom: 0px;
}
.controls {
line-height: 18px;
}
</style>
<form class="form-horizontal" action="https://ticket.opensciencegrid.org/viewer/updatebasic?id=19499" method="post">
<div class="page-header">
    <h3><span class="muted">19499</span> / Issue with fetch-crl/fetch-crl3</h3>
</div>

<div class="row-fluid">
<div class="span5">
    <legend>Contact</legend>
    <div class="control-group">
        <label class="control-label">Full Name</label>
        <div class="controls">Neha Sharma</div>
    </div>
    <div class="control-group">
        <label class="control-label">Email</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">Phone</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">CC</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>

    <legend>Details</legend>
    <div class="control-group"><label class="control-label">Submitted Via</label><div class="controls">GOC Ticket/submit</div></div><div class="control-group"><label class="control-label">Submitter</label><div class="controls">Neha Sharma</div></div>
    <div class="control-group">
        <label class="control-label">Ticket Type</label>
        <div class="controls">Problem/Request</div>
    </div>
    <div class="control-group">
        <label class="control-label">Priority</label>
        <div class="controls">Normal</div>
    </div>
    <div class="control-group">
        <label class="control-label">Status</label>
        <div class="controls">
Closed</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action</label>
        <div class="controls">Wait for user response</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action Deadline</label>
        <div class="controls flag_red">2014-04-07</div>
    </div>

</div><!--span-->
<div class="span7">
    <legend>Assignees</legend>
    <div class="assignee" style="width: 60%">Software Support (Triage) <span class="muted"> / OSG Software Team</span></div><div class="assignee" style="width: 60%">Brian Lin <span class="muted"> / OSG Software Team</span></div>    <br>

    <legend>Assignees</legend>
    TODO
    <br>

    <style>
legend.noborder {
border-bottom: none;
}
</style>

<div id="attachment-list"/>
<script>
$(function () {
    var first = true;
    $.getJSON("attachment/list/19499", function (files) {
        //console.dir(files);
        var html = "<table class=\"table table-condensed\">";
        $(files).each(function() {
            if(first) {
                first = false;
                html += "<legend class=\"noborder\">Attachmenets</legend>";
            }
            html += "<tr class=\"attachment\">";
            html += "<td><img src=\""+this.thumbnail_url+"\"/></td>";
            html += "<td><a href=\""+this.url+"\" target=\"_blank\">"+this.name+"</a></td>";
            html += "<td>"+bytesToSize(this.size, 1)+"</td>";
            html += "</tr>";
        });
        html += "</table>";
        $("#attachment-list").html(html);
    });
});

function download(url) {
    window.open(url, "_blank");
}
</script>


</div><!--span-->
</div><!--row-fluid-->


</form>

</div>
<div id="updates" style="clear: both;">
    <legend>Past Updates
    <div class="btn-toolbar pull-right toolbar">
    </div><!--btn-toolbar-->
    </legend>

    <div class='update_description'><i onclick="document.location='19499#1396713061'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-04-05T15:51:01+00:00">Apr 5, 2014 03:51 PM UTC</time> by <b>Brian Lin</b><a class="anchor" name="1396713061">&nbsp;</a></div><pre>In that case I&#39;m going to close this ticket. If you&#39;d like to track the issue with the fetch-crl-boot not failing with a bad config, please follow the JIRA ticket&#58; <a href='https&#58;//jira.opensciencegrid.org/browse/SOFTWARE-1447.' target='_blank' rel='nofollow'>https&#58;//jira.opensciencegrid.org/browse/SOFTWARE-1447.</a></pre></div><div class='update_description'><i onclick="document.location='19499#1396560337'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-04-03T21:25:37+00:00">Apr 3, 2014 09:25 PM UTC</time><a class="anchor" name="1396560337">&nbsp;</a></div><pre>Hi Brian,

Neha and I work at the same group (Grid and Cloud Services Operations, GCSO) and we internally discussed this already. I&#39;m happy with the improvements, thanks a lot!

regards,
Gerard

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=Gerard Bernabeu Altayo 949</pre></div><div class='update_description'><i onclick="document.location='19499#1396554979'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-04-03T19:56:19+00:00">Apr 3, 2014 07:56 PM UTC</time> by <b>Brian Lin</b><a class="anchor" name="1396554979">&nbsp;</a></div><pre>Neha&#58; I&#39;ve created a JIRA ticket regarding that issue you&#39;ve found, <a href='https&#58;//jira.opensciencegrid.org/browse/SOFTWARE-1447.' target='_blank' rel='nofollow'>https&#58;//jira.opensciencegrid.org/browse/SOFTWARE-1447.</a> Is it ok if we track that issue from there?
Gerard&#58; Have you been able to test the new version of fetch-crl?</pre></div><div class='update_description'><i onclick="document.location='19499#1396535407'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-04-03T14:30:07+00:00">Apr 3, 2014 02:30 PM UTC</time> by <b>Brian Lin</b><a class="anchor" name="1396535407">&nbsp;</a></div><pre>From the developer&#58;

Hi Brian,

It indeed seems a bti strange, but that&#39;s how the config paring works&#58; the
fetch-crl code will pick pu configuration from the config file that it
recognises, and will ignore anything it does not know about. That&#39;s due to the
way the config file is parsed and processed, and is not readily changed.

I&#39;m glad that otherwise the 3.0.13 release works OK, and I&#39;ll push it to
release. In due course, the EPEL and Debian distro&#39;s will pick it up as well.

Cheers,
DavidG.</pre></div><div class='update_description'><i onclick="document.location='19499#1396391859'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-04-01T22:37:39+00:00">Apr 1, 2014 10:37 PM UTC</time> by <b>Neha Sharma</b><a class="anchor" name="1396391859">&nbsp;</a></div><pre>Hi Brian
Within our puppet setup, I have confirmed that
1. When I put in &#34;noerrors&#34; in /etc/fetch-crl.conf and there are retrieval errors only - fetch-crl exits with exit code of 0 and prints the errors in /var/log/daemon
2. Puppet runs clean (as far as this part is concerned )
3. crl files are created when fetch-crl-boot is run (for first time)

I do have one question - when  explicitly made a typo in my config file
(changed infodir to fodir)
[root@fgt5x1 ~]# cat /etc/fetch-crl.conf | grep dir
fodir = /etc/grid-security/certificates
[root@fgt5x1 ~]#

and ran fetch-crl-boot, it ran successfully and did not complain/log-anything about config error

[root@fgt5x1 ~]# cat /etc/fetch-crl.conf | grep dir
fodir = /etc/grid-security/certificates
[root@fgt5x1 ~]#
[root@fgt5x1 ~]# rm /var/lock/subsys/fetch-crl-boot
rm&#58; remove regular empty file &#96;/var/lock/subsys/fetch-crl-boot&#39;? y
[root@fgt5x1 ~]#
[root@fgt5x1 ~]# rm -rf /etc/grid-security/certificates/*.r0
[root@fgt5x1 ~]#
[root@fgt5x1 ~]# cat /etc/fetch-crl.conf | grep dir
fodir = /etc/grid-security/certificates
[root@fgt5x1 ~]#
[root@fgt5x1 ~]# service fetch-crl-boot start
Running fetch-crl on boot&#58;                                 [  OK  ]
[root@fgt5x1 ~]# echo $?
0
[root@fgt5x1 ~]# ls -hlt /etc/grid-security/certificates/*r0 | head -6
-rw-r--r-- 1 root root 1.5K Apr  1 17&#58;35 /etc/grid-security/certificates/0a12b607.r0
-rw-r--r-- 1 root root  11K Apr  1 17&#58;35 /etc/grid-security/certificates/1691b9ba.r0
-rw-r--r-- 1 root root  21K Apr  1 17&#58;35 /etc/grid-security/certificates/169d7f9c.r0
-rw-r--r-- 1 root root  638 Apr  1 17&#58;35 /etc/grid-security/certificates/1b6f5ede.r0
-rw-r--r-- 1 root root 1.1K Apr  1 17&#58;35 /etc/grid-security/certificates/20ce830e.r0
<div id='show_575754756' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_575754756'>-rw-r--r-- 1 root root 3.0K Apr  1 17&#58;35 /etc/grid-security/certificates/24c3ccde.r0
[root@fgt5x1 ~]#

I would expect it to burp on this..

-Neha
</div><script type='text/javascript'>
        $('#show_575754756').click(function() {
            $('#detail_575754756').slideDown("normal");
            $('#show_575754756').hide();
            $('#hide_575754756').show();
        });
        $('#hide_575754756').click(function() {
            $('#detail_575754756').slideUp();
            $('#hide_575754756').hide();
            $('#show_575754756').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='19499#1396373379'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-04-01T17:29:39+00:00">Apr 1, 2014 05:29 PM UTC</time> by <b>Neha Sharma</b><a class="anchor" name="1396373379">&nbsp;</a></div><pre>Hi Brian
I have tested the new version (for our use case) and it seems to do what we need it to outside of our puppet environment.
Testing of this from inside of puppet env. is in progress.

-Neha</pre></div><div class='update_description'><i onclick="document.location='19499#1396368477'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-04-01T16:07:57+00:00">Apr 1, 2014 04:07 PM UTC</time> by <b>Brian Lin</b><a class="anchor" name="1396368477">&nbsp;</a></div><pre>Any word on testing this?</pre></div><div class='update_description'><i onclick="document.location='19499#1395348771'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-03-20T20:52:51+00:00">Mar 20, 2014 08:52 PM UTC</time> by <b>Neha Sharma</b><a class="anchor" name="1395348771">&nbsp;</a></div><pre>Sorry for being silent on this one Edgar. I plan on testing it very soon (if possible tomorrow)
Thank you for your patience.
-Neha</pre></div><div class='update_description'><i onclick="document.location='19499#1395348560'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-03-20T20:49:20+00:00">Mar 20, 2014 08:49 PM UTC</time><a class="anchor" name="1395348560">&nbsp;</a></div><pre>Hi,

in my group we intend to test this when time permits, right now we&#39;re dealing with some other stuff and have workarounds in place to solve the immediate issue with fetch-crl.

Will update the ticket with the results.

Thanks,
Gerard

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=Gerard Bernabeu Altayo 949</pre></div><div class='update_description'><i onclick="document.location='19499#1395343318'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-03-20T19:21:58+00:00">Mar 20, 2014 07:21 PM UTC</time> by <b>Anthony Tiradani</b><a class="anchor" name="1395343318">&nbsp;</a></div><pre>Hi,

I can only speak for the Tier-1 at FNAL.  We have not tried them and don&#39;t plan to at this point.  I have completely replaced the functionality of the service by using a cron job that fires off when the node reboots..

Thanks,

Anthony Tiradani</pre></div><div class='update_description'><i onclick="document.location='19499#1395249616'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-03-19T17:20:16+00:00">Mar 19, 2014 05:20 PM UTC</time><a class="anchor" name="1395249616">&nbsp;</a></div><pre>Ping.

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=Edgar Mauricio Fajardo Hernandez 2020</pre></div><div class='update_description'><i onclick="document.location='19499#1395084469'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-03-17T19:27:49+00:00">Mar 17, 2014 07:27 PM UTC</time><a class="anchor" name="1395084469">&nbsp;</a></div><pre>Hi Tony, Gerard, Neha,

Have you tried the RPMS&#39;s provided here&#58;

<a href='https&#58;//dist.eugridpma.info/distribution/tests/PMA-PRIVATE-PREVIEW/fetch-crl-3.0.13/' target='_blank' rel='nofollow'>https&#58;//dist.eugridpma.info/distribution/tests/PMA-PRIVATE-PREVIEW/fetch-crl-3.0.13/</a>

To see if it fixed the problem?

Thanks,

Edgar

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=Edgar Mauricio Fajardo Hernandez 2020</pre></div><div class='update_description'><i onclick="document.location='19499#1394051142'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-03-05T20:25:42+00:00">Mar 5, 2014 08:25 PM UTC</time> by <b>Brian Lin</b><a class="anchor" name="1394051142">&nbsp;</a></div><pre>Hi all,

The developer&#39;s responded with some RPM&#39;s/tarballs that should fix your issues and is inviting you to test them&#58; <a href='https&#58;//bugzilla.nikhef.nl/show_bug.cgi?id=12' target='_blank' rel='nofollow'>https&#58;//bugzilla.nikhef.nl/show_bug.cgi?id=12</a>

Thanks,
Brian</pre></div><div class='update_description'><i onclick="document.location='19499#1393949307'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-03-04T16:08:27+00:00">Mar 4, 2014 04:08 PM UTC</time> by <b>Brian Lin</b><a class="anchor" name="1393949307">&nbsp;</a></div><pre>Tony/Gerard&#58; The fetch-crl developer has responded and I responded with the following. Does that echo how you would like fetch-crl to act? Did I miss anything (he did respond to my inquiry of standard LSB service behavior)?

<a href='https&#58;//bugzilla.nikhef.nl/show_bug.cgi?id=12' target='_blank' rel='nofollow'>https&#58;//bugzilla.nikhef.nl/show_bug.cgi?id=12</a>
(In reply to David Groep from comment #7)
<font color='#7F7E6F'>&#62; The only potential downside to &#39;noerrors&#39; is that also the message itself is</font>
<font color='#7F7E6F'>&#62; suppressed. In a future version this can be made into a separate option</font>
<font color='#7F7E6F'>&#62; (&#34;noexitfailureonerrors&#34; or so) that will print the message to the log</font>
<font color='#7F7E6F'>&#62; destination but not increase the retrieval error counter (and thus exit 0).</font>

That is indeed the issue. I believe that sysadmins prefer the service to fail *only* on programmatic/config errors and log retrieval errors so that they can decide how to respond on their own.</pre></div><div class='update_description'><i onclick="document.location='19499#1393860744'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-03-03T15:32:24+00:00">Mar 3, 2014 03:32 PM UTC</time> by <b>Anthony Tiradani</b><a class="anchor" name="1393860744">&nbsp;</a></div><pre>Just as an aside...  All of these points including the issues I raised in SOFTWARE-1073 have caused me to completely abandon fetch-crl-boot and (re)implement it outside the service framework.

- Tony</pre></div><div class='update_description'><i onclick="document.location='19499#1393608270'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-02-28T17:24:30+00:00">Feb 28, 2014 05:24 PM UTC</time> by <b>Brian Lin</b><a class="anchor" name="1393608270">&nbsp;</a></div><pre>It looks like I can&#39;t add you to the CC list unless you have a bugzilla account so I&#39;ll just leave this ticket open in the meantime.

- Brian</pre></div><div class='update_description'><i onclick="document.location='19499#1393608070'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-02-28T17:21:10+00:00">Feb 28, 2014 05:21 PM UTC</time><a class="anchor" name="1393608070">&nbsp;</a></div><pre>I think that, when addressed, that bugzilla ticket will help us. I do not have an account there, can you please add me in the CC list so that I can get the updates?

The issue is not resolved, but if you have some sort of &#39;close by opening a bug&#39; status, then it&#39;d be fine I guess.

thanks,
Gerard

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=Gerard Bernabeu Altayo 949</pre></div><div class='update_description'><i onclick="document.location='19499#1393607788'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-02-28T17:16:28+00:00">Feb 28, 2014 05:16 PM UTC</time> by <b>Brian Lin</b><a class="anchor" name="1393607788">&nbsp;</a></div><pre>Ah, both good points. We already have a somewhat related ticket open with the fetch-crl developer, <a href='https&#58;//bugzilla.nikhef.nl/show_bug.cgi?id=12#add_comment.' target='_blank' rel='nofollow'>https&#58;//bugzilla.nikhef.nl/show_bug.cgi?id=12#add_comment.</a> Would following that ticket suffice for you? If so, I&#39;ll close this ticket. Also, feel free to weigh in on that discussion!

- Brian</pre></div><div class='update_description'><i onclick="document.location='19499#1393605541'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-02-28T16:39:01+00:00">Feb 28, 2014 04:39 PM UTC</time><a class="anchor" name="1393605541">&nbsp;</a></div><pre>Hi Brian,

- You can set the logmode in your fetch-crl.conf file to syslog (<a href='http&#58;//wiki.nikhef.nl/grid/FetchCRL3' target='_blank' rel='nofollow'>http&#58;//wiki.nikhef.nl/grid/FetchCRL3</a>).
* But this does not solve the issue because in order for the service to work I need to set the &#39;noerror&#39; so they are just ignored and not printed anywhere right?

- Is this actually what you would want? What if there were some retrieval errors for a CA that was temporarily down and you want to run it again? Shouldn&#39;t checking the status of fetch-crl-boot before deciding to run the service again suffice?
* If I want to manually debug something there are other fetch-crl tools to do that. As you pointed before the service should be standard, this should follow <a href='http&#58;//refspecs.linuxbase.org/LSB_3.1.1/LSB-Core-generic/LSB-Core-generic/iniscrptact.html' target='_blank' rel='nofollow'>http&#58;//refspecs.linuxbase.org/LSB_3.1.1/LSB-Core-generic/LSB-Core-generic/iniscrptact.html</a>
* If there are errors in the script they should be logged somewhere. I need the service to work following standards and logging errors whenever they&#39;re found, this way I can parse logs, rise alarms and act if needed.

Thanks,
Gerard

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=Gerard Bernabeu Altayo 949</pre></div><div class='update_description'><i onclick="document.location='19499#1393603448'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-02-28T16:04:08+00:00">Feb 28, 2014 04:04 PM UTC</time> by <b>Brian Lin</b><a class="anchor" name="1393603448">&nbsp;</a></div><pre>Gerard,

- You can set the logmode in your fetch-crl.conf file to syslog (<a href='http&#58;//wiki.nikhef.nl/grid/FetchCRL3' target='_blank' rel='nofollow'>http&#58;//wiki.nikhef.nl/grid/FetchCRL3</a>).
- Is this actually what you would want? What if there were some retrieval errors for a CA that was temporarily down and you want to run it again? Shouldn&#39;t checking the status of fetch-crl-boot before deciding to run the service again suffice?

- Brian</pre></div><div class='update_description'><i onclick="document.location='19499#1393545190'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-02-27T23:53:10+00:00">Feb 27, 2014 11:53 PM UTC</time><a class="anchor" name="1393545190">&nbsp;</a></div><pre>Hi Brian,

this is almost good, just a couple issues&#58;

- I&#39;d actually like to know if there&#39;s some issue while fetching the CRLs, so a log message somewhere (eg&#58; messages) would be great
- If I run &#39;service fetch-crl-boot start&#39; twice in a row, it fetches the CRLs twice. The standard says&#58; whenever you have a service started, if you start it again, it just returns 0 and does nothing.

Thanks,
Gerard

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=Gerard Bernabeu Altayo 949</pre></div><div class='update_description'><i onclick="document.location='19499#1393529644'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-02-27T19:34:04+00:00">Feb 27, 2014 07:34 PM UTC</time> by <b>Brian Lin</b><a class="anchor" name="1393529644">&nbsp;</a></div><pre>To solve the issue, you could edit &#39;/etc/fetch-crl3.d/00-personal.conf&#39; (or the file in &#39;/etc/fetch-crl.d&#39; if you&#39;re on EL6) and add a line that says &#39;noerrors&#39;, which will suppress any retrieval errors that you have. Before editing the file&#58;

[root@fermicloud083 site-packages]# service fetch-crl3-boot start; echo $?
Running fetch-crl3 on boot&#58;  ERROR CRL verification failed for HIAST/0 (HIAST)

[FAILED]
1
[root@fermicloud083 site-packages]#

After editing the file&#58;

[root@fermicloud083 site-packages]# service fetch-crl3-boot start; echo $?
Running fetch-crl3 on boot&#58;                                [  OK  ]
0
[root@fermicloud083 site-packages]# service fetch-crl3-boot status
fetch-crl3-boot lockfile present                           [  OK  ]

Is that enough to solve your problem?

- Brian</pre></div><div class='update_description'><i onclick="document.location='19499#1393520961'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-02-27T17:09:21+00:00">Feb 27, 2014 05:09 PM UTC</time><a class="anchor" name="1393520961">&nbsp;</a></div><pre>Hi Brian,

I agree we should not go against any packaging guidelines, we should also make sure that the services follow standard return codes and have a consistent behaviour. This is the main issue we have is that we should be able to rely on one of the &#39;fetch-crl*&#39; service status to ensure CRLs are up-to-date in a system.

Perhaps the easiest one to fix would be fetch-crl-boot, which returns false even when it runs &#39;ok&#39;&#58;

[root@fcl010 ~]# /etc/init.d/fetch-crl-boot status
fetch-crl-boot lockfile missing                            [FAILED]
[root@fcl010 ~]# /etc/init.d/fetch-crl-boot status; echo $?
fetch-crl-boot lockfile missing                            [FAILED]
1
[root@fcl010 ~]# /etc/init.d/fetch-crl-boot start; echo $?
Running fetch-crl on boot&#58;  ERROR CRL verification failed for HIAST/0 (HIAST)
[FAILED]
1
[root@fcl010 ~]# /etc/init.d/fetch-crl-boot status; echo $?
fetch-crl-boot lockfile missing                            [FAILED]
1
[root@fcl010 ~]#

What I would do to fix this is&#58;

1. If a CA is CRL verification fails (like in the example above) on &#39;service start&#39;, echo an ERROR or WARNING message, but return 0 as the service managed to run.
2. If fetch-crl-boot is running (it&#39;s a service, it must have that concept), a &#39;service status&#39; should return 0. Also, &#39;service start&#39; should return 0 and do nothing if the service is running already.
3. (optional, could help implement 2) starting fetch-crl-boot should check if the CRLs are up to date, and if they are, just consider that the service is running already, there&#39;s no need to fetch them again.

This way the RPM does not need to run any script and configuration management tools can just manage the service in a standard way, as if it was any other service in the system.

The following is out of the scope of this ticket&#58; my personal opinion is that fetch-crl-cron should go away and a single fetch-crl service should be able to do everything the admin can now do with 2 services, when properly managed by a configuration file.

Thanks,
Gerard

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=Gerard Bernabeu Altayo 949</pre></div><div class='update_description'><i onclick="document.location='19499#1393515319'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-02-27T15:35:19+00:00">Feb 27, 2014 03:35 PM UTC</time> by <b>Neha Sharma</b><a class="anchor" name="1393515319">&nbsp;</a></div><pre>Hi Brian
We&#39;ll get back to you on this today. Sorry for the delay.
-Neha</pre></div><div class='update_description'><i onclick="document.location='19499#1392918923'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-02-20T17:55:23+00:00">Feb 20, 2014 05:55 PM UTC</time> by <b>Brian Lin</b><a class="anchor" name="1392918923">&nbsp;</a></div><pre>Neha,

After consulting with the rest of the software team, it sounds like your original request goes against packaging guidelines of running scripts and such in post-install (e.g. imagine a machine with no external network access, fetch-crl&#39;s install will fail). If this is causing a problem in your automatic setup, is there a reason why you can&#39;t just run fetch-crl as part of your automated process?

- Brian</pre></div><div class='update_description'><i onclick="document.location='19499#1392742309'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-02-18T16:51:49+00:00">Feb 18, 2014 04:51 PM UTC</time><a class="anchor" name="1392742309">&nbsp;</a></div><pre>Hi, I believe that a proper solution would be to architect the fetch-crl* service(s) so that it can be started and fetches the CRLs only if necessary. Then if the RPM wants to enable the service by default or not is not an issue since admins/management tools can do that.

Thanks,
Gerard

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=Gerard Bernabeu Altayo 949</pre></div><div class='update_description'><i onclick="document.location='19499#1392650967'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-02-17T15:29:27+00:00">Feb 17, 2014 03:29 PM UTC</time> by <b>Brian Lin</b><a class="anchor" name="1392650967">&nbsp;</a></div><pre>Neha,

We don&#39;t actually maintain fetch-crl or fetch-crl3, it&#39;s in EPEL so you may want to submit a feature request here <a href='https&#58;//bugzilla.nikhef.nl/enter_bug.cgi?product=FetchCRL.' target='_blank' rel='nofollow'>https&#58;//bugzilla.nikhef.nl/enter_bug.cgi?product=FetchCRL.</a> One concern I have is that fetch-crl can take a while to run so it could be confusing to users when their yum install seemingly stalls. Additionally, fetch-crl tends to fail pretty often so what happens when it fails in a post-install? There are probably plenty of solutions to these problems but those are just some things that come to mind.

- Brian</pre></div><div class='update_description'><i onclick="document.location='19499#1391810755'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-02-07T22:05:55+00:00">Feb 7, 2014 10:05 PM UTC</time> by <b>Neha Sharma</b><a class="anchor" name="1391810755">&nbsp;</a></div><pre>Thanks Elizabeth. Please add these people as watchers

Tyler Parsons &#60;tparsons@....&#62;, Edward Simmonds &#60;esimm@....&#62;, Gerard Bernabeu Altayo &#60;gerard1@....&#62;</pre></div><div class='update_description'><i onclick="document.location='19499#1391810453'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-02-07T22:00:53+00:00">Feb 7, 2014 10:00 PM UTC</time> by <b>echism</b><a class="anchor" name="1391810453">&nbsp;</a></div><pre>Neha,

I sent this to the software team. I&#39;m confused by the behavior you&#39;re seeing in ticket. I&#39;ve never seen that in any operating system with any browser and I&#39;ve used most. If you want any particular CC&#39;s on this just send a list and for the other thing, maybe email soichi or open another ticket and we&#39;ll try to figure it out.

Thank you</pre></div><div class='update_description'><i onclick="document.location='19499#1391800088'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-02-07T19:08:08+00:00">Feb 7, 2014 07:08 PM UTC</time> by <b>Neha Sharma</b><a class="anchor" name="1391800088">&nbsp;</a></div><pre>Please note that when I try to click on the &#39;Add CC&#39; button, it takes me to <a href='https&#58;//ticket.grid.iu.edu/goc/submit' target='_blank' rel='nofollow'>https&#58;//ticket.grid.iu.edu/goc/submit</a>

Could this be fixed, as there are other people who would like to watch the updates on this?

Thanks</pre></div><div class='update_description'><i onclick="document.location='19499#1391790060'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-02-07T16:21:00+00:00">Feb 7, 2014 04:21 PM UTC</time> by <b>Neha Sharma</b><a class="anchor" name="1391790060">&nbsp;</a></div><pre>Hi

This is a question for OSG Software team-

At present, once the fetch-crl/fetch-crl3 package gets installed, if user wants to get the CRLs right away, she needs to run the fetch-crl command manually  (as it may be a while before fetch-crl-cron is scheduled to run and fetch-crl-boot, if enabled, will run only once node gets rebooted)

This presents an issue when we automate the deployments of software that depends on fetch-crl (example - VOMS/VOMS-Admin, in which case service is not functional right away since CRLs are not in place)

So, my question is, would it be possible to add a post installation step for the fetch-crl/fetch-crl3 package install, that actually runs the fetch-crl/fetch-crl3 command and brings in the crls?

Thanks
-Neha</pre></div>
</div>
<script type="text/javascript">
function reset_anchor() {
    $("#updates .selected").removeClass("selected");
    var urls = document.location.toString().split('#'); 
    var anchor = urls[1];
    if(anchor) {
        $("a[name='"+anchor+"']").parents(".update_description").addClass("selected");
    }
}
function submitspam(ticket_id) {
    myret = confirm("Would you like to close this ticket as a security ticket, and submit the ticket content to akismet?");
    if(myret == true) {
        $.ajax("viewer/processspam?id="+ticket_id).done(function() {
            window.location.reload();
        });
    }
}

$(function() {
    reset_anchor();
    var ADDITIONAL_COOKIE_NAME = 'gocticket';
    var options = { path: '/', expires: 365};

    if(window.opener && window.opener.name == "gocticket_list") {
        v = $.cookie("closewindow");
        if(!v) {
            $("#closewindow").attr("checked", "checked"); //on by default
        } else {
            if(v == "checked") {
                $("#closewindow").attr("checked", "checked");
            }
        }
        $("#closewindow").click(function() {
            $.cookie("closewindow", $(this).attr('checked'), options);
        });
    } else {
        $("#closewindow_area").hide();
    }
    function updateTimeago() {
        $("time").timeago();
        setTimeout(updateTimeago, 30*1000);
    }
    updateTimeago();
    $(".description").focus(expand_description);
});
</script>
<hr/>
<footer>
<p>GOC Ticket Version 2.2 | <a href="https://ticket.opensciencegrid.org/goc/submit?app_issue_check=on&amp;app_issue_type=goc&amp;app_goc_url=https%3A%2F%2Fticket.opensciencegrid.org%3A443%2F19499">Report Bugs</a>
 | <a href="https://github.com/opensciencegrid/operations/blob/master/docs/privacy.md">Privacy Policy</a>
</p>

<p> <img align="top" src="images/tag_orange.png"/> Copyright 2018 The Trustees of Indiana University - Developed for Open Science Grid</p>
</footer>


</div><!--container-fluid-->
<script>
//used by searchbox
function parseValue(value) {
    var obj = new Object();
    var tokens = value.split("\t");
    obj.str = tokens[0];
    obj.count = tokens[1];
    return obj;
}

$(function() {
    //bootstrap-2.0.4 stuff
    $(".alert-message").alert();
    $(".dropdown-toggle").dropdown();
    $("span[rel='tooltip']").tooltip();
    $("a[rel=popover]").popover();

    //activate menu that user is currently on
    $("#menu_navigator").addClass("active"); 
    $("#submenu_").addClass("active"); 

    //translate zend validation error message to bootstrap
    $(".errors").addClass("alert").addClass("alert-error");

});
</script>


</body>
