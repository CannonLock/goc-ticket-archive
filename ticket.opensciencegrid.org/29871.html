<!DOCTYPE html>
<html lang="en">
  <head>
  <base href="">
    <title>[29871] Unprivileged identity for existing OSG Grid Admin account</title>    <meta charset="utf-8" />
    <meta name="verify-v1" content="na5IcAJsZVOfEkboRxuIiZ1zpZgnZiWra+nKcS7nA/o=" />
    <meta name="google-site-verification" content="DLrk3ft4s8b-S2TloLCL2LD_t6wcTjgSluf5pmiu2kA" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />
    <link href="https://ticket.opensciencegrid.org/rss" rel="alternate" type="application/rss+xml" title="GOC Ticket Update feed" />

    <style type="text/css">
      body {
        padding-top: 50px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
     #search {
            width: 300px;
     }

    </style>

<script src="https://code.jquery.com/jquery-3.0.0.js"></script>
<script src="https://code.jquery.com/jquery-migrate-3.0.1.js"></script>

   <link href="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet"/>
    <script src="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/js/bootstrap.min.js"></script>

    <link href="https://netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"/>
    <link href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/themes/smoothness/jquery-ui.min.css" rel="stylesheet"/>
 <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>


    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/js/select2.min.js"></script>

    <link href="css/ticket.css" rel="stylesheet" />
    <script src="lib/jquery.cookie.js"></script>

    <link href="images/tag_orange.png" rel="icon" type="image/png"/>
    <script src='https://www.google.com/recaptcha/api.js'></script>
  </head>

  <body>
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>

            <a class="brand" style="padding: 6px 0px 0px 6px;" href="http://opensciencegrid.org"><img src="images/osglogo.40x30.png"/></a>
            <ul class="nav">
                <li class="dropdown"><a href="https://ticket.opensciencegrid.org/#" class="dropdown-toggle" data-toggle="dropdown">GOC Ticket <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    <li><a href="https://my.opensciencegrid.org">MyOSG</a></li>
                    <li><a href="https://oim.opensciencegrid.org">OIM</a></li>
                    <li class="active"><a href="https://ticket.opensciencegrid.org/index">Ticket</a></li>
	<li class="divider"></li>
	<li><a href="http://repo.grid.iu.edu">Repo</a></li>
	<li class="divider"></li>
	<li><a href="http://blogs.grid.iu.edu">Blog</a></li>
                    <li><a href="http://display.grid.iu.edu">Display</a></li>
                    <li><a href="http://osggoc.blogspot.com/">News</a></li>
                    </ul>
                </li>
            </ul>
            <ul class="nav pull-right">
                <li><a href="https://ticket.opensciencegrid.org/sso/">Login</a></li>            </ul>

            <div class="nav-collapse">
                <ul class="nav">
			 <li id="menu_submit"><a href="https://ticket.opensciencegrid.org/submit">Submit</a></li><li id="menu_view" class="dropdown"><a href="https://ticket.opensciencegrid.org/\#" class="dropdown-toggle" data-toggle="dropdown">View <b class="caret"></b></a><ul class="dropdown-menu"><li id="submenu_listopen"><a href="https://ticket.opensciencegrid.org/list/open">Open Tickets</a></li><li id="submenu_listrecentclose"><a href="https://ticket.opensciencegrid.org/list/recentclose">Recently Closed Tickets</a></li><li class="divider"></li><li id="submenu_alltickets"><a href="https://ticket.opensciencegrid.org/search?q=&amp;sort=id">All Tickets</a></li></ul></li>                </ul>

                <form class="navbar-search pull-right" action="https://ticket.opensciencegrid.org/viewer">
                    <input id="search" type="text" name="id" class="search-query span2" placeholder="Search Ticket" value=""/>
                </form>
            </div>
        </div>
      </div>
    </div>

<script type='text/javascript' src='lib/jquery.timeago.js'></script>
<script type='text/javascript' src='lib/byte2size.js'></script>
<style>
#updates .toolbar {
position: relative;
margin-top: 0px;
top: -10px;
font-weight: normal;
}
#updates a.anchor {
position: relative;
top: -50px;
}
#updates .selected pre {
animation:selected 2s;
animation-iteration-count: 2;
animation-direction: alternate;
-webkit-animation:selected 2s; 
-webkit-animation-iteration-count: 2;
-webkit-animation-direction: alternate;
box-shadow: inset 1px 1px 20px #9ad;
border: 1px solid #9ab;
margin: 5px 0px;
padding-left: 10px;
}
@keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ab;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
@-webkit-keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ad;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
#updates pre {
background-color: inherit;
line-height: 15px;
padding: 5px;
}
#updates .header {
color: #999;
}
#updates .update_history pre {
background-color: #eee;
color: #666;
font-size: 85%;
}
#updates .clickable {
cursor: pointer;
}
#updates .clickable:hover {
color: #D98719;
}
#updates .meta_information pre {
background-color: #fed;
}
#similar_tickets {
max-height: 300px;
overflow-y: auto;
pointer-events: none;
padding: 5px;
background-color: #f4f4f4;
}
.btn-toolbar {
margin-bottom: 0;
height: 30px;
}
#peers {
position: fixed;
bottom: 0px;
right: 0px;
z-index: 100;
list-style: none;
padding: 5px 0px 0px 5px;
margin: 0px;
background-color: white;
box-shadow: 0px 0px 10px white;
}
#peers li {
background-color: #ccc;
color: #000;
display: inline-block;
padding: 5px 10px;
margin-right: 5px;
position: relative;
}
/*
#peers li:hover {
background-color: #999;
cursor: pointer;
}
*/
#peers span.ip {
padding-left: 5px;
color: #666;
}
#peers .new {
bottom: -30px;
}
/*
#peers .me {
background-color: red;
}
*/
</style>

<div class="container-fluid">
<ul id="peers"></ul>
<div class="alert alert-danger"><a class="close" href="https://ticket.opensciencegrid.org/#" data-dismiss="alert">&times;</a>By the end of May 2018, the ticketing system at https://ticket.opensciencegrid.org will be retired and support will be provided at https://support.opensciencegrid.org. Throughout this transition the support email (help@opensciencegrid.org) will be available as a point of contact.<br><br>                                                   
                                                                                                                                                                                   
Please see the service migration page for details: https://opensciencegrid.github.io/technology/policy/service-migrations-spring-2018/#ticket</div><div id="presence" class="pull-right"></div><div class="ticketgui"><script type="text/javascript" src="lib/checktab.js"></script>

<script>
var expanded = false;
function expand_description() {
    var desc = $(".description");
    if(!expanded) {
        expanded = true;
        //expand to minheight
        var min = 250;
        if(desc.height() < min) {
            desc.animate({height: min}, 200);
        }
    }
}

$(document).ready(function() {
    $("input[name='nad']").datepicker({
        dateFormat: 'yy-mm-dd'
    });
});

</script>



<style>
.form-horizontal .control-label {
padding-top: inherit;
font-size:90%;
color:#666;
}
label {
margin-bottom: 0px;
}
.controls {
line-height: 18px;
}
</style>
<form class="form-horizontal" action="https://ticket.opensciencegrid.org/viewer/updatebasic?id=29871" method="post">
<div class="page-header">
    <h3><span class="muted">29871</span> / Unprivileged identity for existing OSG Grid Admin account</h3>
</div>

<div class="row-fluid">
<div class="span5">
    <legend>Contact</legend>
    <div class="control-group">
        <label class="control-label">Full Name</label>
        <div class="controls">John S. De Stefano Jr.</div>
    </div>
    <div class="control-group">
        <label class="control-label">Email</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">Phone</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">CC</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>

    <legend>Details</legend>
    <div class="control-group"><label class="control-label">Submitted Via</label><div class="controls">GOC Ticket/submit</div></div><div class="control-group"><label class="control-label">Submitter</label><div class="controls">John S. De Stefano Jr.</div></div><div class="control-group"><label class="control-label">Ticket Links</label><div class="controls"></div></div>
    <div class="control-group">
        <label class="control-label">Ticket Type</label>
        <div class="controls">Problem/Request</div>
    </div>
    <div class="control-group">
        <label class="control-label">Priority</label>
        <div class="controls">Normal</div>
    </div>
    <div class="control-group">
        <label class="control-label">Status</label>
        <div class="controls">
Closed</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action</label>
        <div class="controls">ENG Action</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action Deadline</label>
        <div class="controls flag_red">2016-05-27</div>
    </div>

</div><!--span-->
<div class="span7">
    <legend>Assignees</legend>
    <div class="assignee" style="width: 60%">Kyle Gross <span class="muted"> / OSG GOC Support Team</span></div>    <br>

    <legend>Assignees</legend>
    TODO
    <br>

    <style>
legend.noborder {
border-bottom: none;
}
</style>

<div id="attachment-list"/>
<script>
$(function () {
    var first = true;
    $.getJSON("attachment/list/29871", function (files) {
        //console.dir(files);
        var html = "<table class=\"table table-condensed\">";
        $(files).each(function() {
            if(first) {
                first = false;
                html += "<legend class=\"noborder\">Attachmenets</legend>";
            }
            html += "<tr class=\"attachment\">";
            html += "<td><img src=\""+this.thumbnail_url+"\"/></td>";
            html += "<td><a href=\""+this.url+"\" target=\"_blank\">"+this.name+"</a></td>";
            html += "<td>"+bytesToSize(this.size, 1)+"</td>";
            html += "</tr>";
        });
        html += "</table>";
        $("#attachment-list").html(html);
    });
});

function download(url) {
    window.open(url, "_blank");
}
</script>


</div><!--span-->
</div><!--row-fluid-->


</form>

</div>
<div id="updates" style="clear: both;">
    <legend>Past Updates
    <div class="btn-toolbar pull-right toolbar">
        <div class="btn-group">
                <a class="btn btn-small" href="https://ticket.opensciencegrid.org/29871?sort=up&amp;"><i class="icon-arrow-up"></i> Sort</a>

        
        <a class="btn btn-small" href="https://ticket.opensciencegrid.org/29871?expandall=true&amp;">Expand Descriptions</a>        <a class="btn btn-small" target="_blank" href="mailto:osg@tick.globalnoc.iu.edu?subject=Open%20Science%20Grid%3A%20Unprivileged%20identity%20for%20existing%20OSG%20Grid%20Admin%20account%20ISSUE%3D29871%20PROJ%3D71"><i class="icon-envelope"></i> Update w/Email</a>
        </div>
    </div><!--btn-toolbar-->
    </legend>

    <div class='update_description'><i onclick="document.location='29871#1464784193'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-06-01T12:29:53+00:00">Jun 1, 2016 12:29 PM UTC</time> by <b>Kyle Gross</b><a class="anchor" name="1464784193">&nbsp;</a></div><pre>Since John has requested this  cert, I will close the ticket.  If a new issue comes up, please open a new ticket.

-Kyle</pre></div><div class='update_description'><i onclick="document.location='29871#1464269770'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-05-26T13:36:10+00:00">May 26, 2016 01:36 PM UTC</time> by <b>jd@....</b><a class="anchor" name="1464269770">&nbsp;</a></div><pre>Hi Kyle,

No problem, and I hope you’re well. For now, I’ve requested a new certificate via the OSG VO.

Thanks,
~John</pre></div><div class='update_description'><i onclick="document.location='29871#1464264881'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-05-26T12:14:41+00:00">May 26, 2016 12:14 PM UTC</time> by <b>Kyle Gross</b><a class="anchor" name="1464264881">&nbsp;</a></div><pre>John,

Sorry about the delay in this ticket.  I had been out of the office a bit lately with a medical issue and must have missed this.  I&#39;ll see what I can figure out today by talking to some other people to get their opinions.

In my head, I don&#39;t see why you couldn&#39;t just ask for a certificate in the OSG VO and use that.  The certificate isn&#39;t *actually* tied to any particular VO, the only reason we need to know what VO it&#39;s for is so that the right people get notified and authorized to approve the request.

Again, sorry about the delay!

-Kyle</pre></div><div class='update_description'><i onclick="document.location='29871#1463603949'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-05-18T20:39:09+00:00">May 18, 2016 08:39 PM UTC</time> by <b>jd@....</b><a class="anchor" name="1463603949">&nbsp;</a></div><pre>Hi Kyle,

Thanks for your reply.

In this particular case, I’ve helped put myself in a bit of a pickle&#58; we’ve disabled new requests for US ATLAS user certificates via OSG, but as the host certificate requests I’d like this separate profile to make would also be for US ATLAS, it seems to make sense that the associated user certificate should come from OSG. I use my CERN certificate to authenticate to my current, primary OSG OIM profile. Would it be possible (and appropriate) to ask the GOC to request and issue a new, CILogin-issued user certificate on my behalf?

Thanks,
~John</pre></div><div class='update_description'><i onclick="document.location='29871#1463172501'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-05-13T20:48:21+00:00">May 13, 2016 08:48 PM UTC</time> by <b>Kyle Gross</b><a class="anchor" name="1463172501">&nbsp;</a></div><pre>&#34;Are these different access levels again something that needs to be handled on the OIM service side? In my OIM profile, I see a list of &#34;Associated DNs”, but all seem to be tagged as &#34;• OSG End User”, with no way to modify privileges.&#34;

This is something that GOC staff can do for you, but those privileges you see are OIM privileges, not certificate privileges. The certificate service was bolted on to OIM.  For example if I look at my DNs in OIM, I see &#34;OSG GOC Support Staff&#34; &#34;OIM Admin&#34; etc.  The only privilege that shows up with regards to the PKI is &#34;OSG PKI Staff&#34; which basically gives us the power to do deeper administrative tasks in the interface, but not with regards to approving certificates.

&#34;I can certainly request a distinct, disconnected profile, if that’s the preferred way forward, but perhaps this request for multiple request privileges or roles could be considered part of a higher-level discussion regarding such permissions, and the “right way” to make such certificate requests.&#34;

I&#39;ve no problem discussing how the permissions work.  Changing anything short-term is tough as we&#39;re working to fill our developer role.  Once she gets up to speed, perhaps we should look at assigning gridadmin powers and the like to DNs instead of people themselves.  Good thought there and thanks for bringing it up.

That being said, for the time being, a distinct profile is really the only way to accomplish what you&#39;re trying to do, I think.

-Kyle</pre></div><div class='update_description'><i onclick="document.location='29871#1463171771'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-05-13T20:36:11+00:00">May 13, 2016 08:36 PM UTC</time> by <b>jd@....</b><a class="anchor" name="1463171771">&nbsp;</a></div><pre>Hi Kyle,

<font color='#7F7E6F'>&#62; Bit of an issue since you&#39;re not a security contact anywhere so security notification wont&#39; work either, so I&#39;ve changed this to a normal ticket since I don&#39;t think it really is a security issue. You should be able to see it now and</font>

Thanks, and aologies for the confusion. This seems at least tangentially related to security, but that tag seems to have a very specific and different meaning in the context.

<font color='#7F7E6F'>&#62; OIM itself can certainly handle different access levels per DN. For example, I have one DN that makes me a full admin for OIM, and then I have another DN that makes me a standard user.</font>

Are these different access levels again something that needs to be handled on the OIM service side? In my OIM profile, I see a list of &#34;Associated DNs”, but all seem to be tagged as &#34;• OSG End User”, with no way to modify privileges.

<font color='#7F7E6F'>&#62; That being said, the certificate service is a separate beast altogether. It only recognizes that you are a certain person, no matter what certificate that you are using. It wasn&#39;t designed with that in mind, unfortunately. Of course, on the contrary, nobody has ever asked for such an ability until now.</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; The way around this would be to create another profile with some other DN. &#34;John De Stefano (Basic User)&#34; or something of the like. You would need a separate email address to do that, but that&#39;s not too hard to come by.</font>

I can certainly request a distinct, disconnected profile, if that’s the preferred way forward, but perhaps this request for multiple request privileges or roles could be considered part of a higher-level discussion regarding such permissions, and the “right way” to make such certificate requests.

<font color='#7F7E6F'>&#62; Hopefully this clear things up a little.</font>

Thanks very much for your help.

~John</pre></div><div class='update_description'><i onclick="document.location='29871#1463170427'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-05-13T20:13:47+00:00">May 13, 2016 08:13 PM UTC</time> by <b>Kyle Gross</b><a class="anchor" name="1463170427">&nbsp;</a></div><pre>John,

Bit of an issue since you&#39;re not a security contact anywhere so security notification wont&#39; work either, so I&#39;ve changed this to a normal ticket since I don&#39;t think it really is a security issue.  You should be able to see it now and

OIM itself can certainly handle different access levels per DN.  For example, I have one DN that makes me a full admin for OIM, and then I have another DN that makes me a standard user.

That being said, the certificate service is a separate beast altogether.  It only recognizes that you are a certain person, no matter what certificate that you are using.  It wasn&#39;t designed with that in mind, unfortunately.  Of course, on the contrary, nobody has ever asked for such an ability until now.

The way around this would be to create another profile with some other DN.  &#34;John De Stefano (Basic User)&#34; or something of the like.  You would need a separate email address to do that, but that&#39;s not too hard to come by.

Hopefully this clear things up a little.

-Kyle</pre></div><div class='update_description'><i onclick="document.location='29871#1463167990'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-05-13T19:33:10+00:00">May 13, 2016 07:33 PM UTC</time> by <b>jd@....</b><a class="anchor" name="1463167990">&nbsp;</a></div><pre>By the way&#58; I understand this is a sensitive ticket queue, but perhaps the ACLs could be adjusted to afford a requester view access to their own tickets?

&#34;Permission Denied to view ticket id 29871
This is a Security Incident ticket. It can only be viewed by authorized personnel.&#34;

~John</pre></div><div class='update_description'><i onclick="document.location='29871#1463167840'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-05-13T19:30:40+00:00">May 13, 2016 07:30 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1463167840">&nbsp;</a></div><pre>Hi,

I&#39;d like to know whether it&#39;s possible for an OSG user with Grid Admin privileges (in this case, myself, as an admin for the ATLAS VO) to establish an identity with OSG, separate or otherwise, without inheriting escalated privileges? I would like to register a DN that would be used to make grid requests (i.e., grid host certificate requests), but I would like the DN to be unprivileged, so that any requests made on its behalf are made as an unprivileged, &#34;normal&#34; user.

If my understanding of OIM is correct&#58; there is currently no automated mechanism by which an OSG user can add a DN to an existing OIM profile; a ticket must be generated to ask OSG to add the DN manually. Further, once that DN has been added, it inherits the privileges of the OSG user, meaning there&#39;s no way to segregate registered DNs into groups of separate or lesser privilege. If that&#39;s accurate, is there another, recommended way to approach this problem, perhaps by creating another user profile?

Thank you,
~John

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=destefan/CN=665120/CN=John Steven De Stefano Jr</pre></div><legend>Similar Recent Tickets <small>modified within the last 30 days</small></legend><div id="similar_tickets"><p class="muted">No similar tickets found.</p></div>
</div>
<script type="text/javascript">
function reset_anchor() {
    $("#updates .selected").removeClass("selected");
    var urls = document.location.toString().split('#'); 
    var anchor = urls[1];
    if(anchor) {
        $("a[name='"+anchor+"']").parents(".update_description").addClass("selected");
    }
}
function submitspam(ticket_id) {
    myret = confirm("Would you like to close this ticket as a security ticket, and submit the ticket content to akismet?");
    if(myret == true) {
        $.ajax("viewer/processspam?id="+ticket_id).done(function() {
            window.location.reload();
        });
    }
}

$(function() {
    reset_anchor();
    var ADDITIONAL_COOKIE_NAME = 'gocticket';
    var options = { path: '/', expires: 365};

    if(window.opener && window.opener.name == "gocticket_list") {
        v = $.cookie("closewindow");
        if(!v) {
            $("#closewindow").attr("checked", "checked"); //on by default
        } else {
            if(v == "checked") {
                $("#closewindow").attr("checked", "checked");
            }
        }
        $("#closewindow").click(function() {
            $.cookie("closewindow", $(this).attr('checked'), options);
        });
    } else {
        $("#closewindow_area").hide();
    }
    function updateTimeago() {
        $("time").timeago();
        setTimeout(updateTimeago, 30*1000);
    }
    updateTimeago();
    $(".description").focus(expand_description);
});
</script>
<hr/>
<footer>
<p>GOC Ticket Version 2.2 | <a href="https://ticket.opensciencegrid.org/goc/submit?app_issue_check=on&amp;app_issue_type=goc&amp;app_goc_url=https%3A%2F%2Fticket.opensciencegrid.org%3A443%2F29871">Report Bugs</a>
 | <a href="https://github.com/opensciencegrid/operations/blob/master/docs/privacy.md">Privacy Policy</a>
</p>

<p> <img align="top" src="images/tag_orange.png"/> Copyright 2018 The Trustees of Indiana University - Developed for Open Science Grid</p>
</footer>


</div><!--container-fluid-->
<script src="https://ticket1.grid.iu.edu:8443/socket.io/socket.io.js"></script>
<script>
var chat = io.connect('https://ticket1.grid.iu.edu:8443');
chat.on('connect', function() {
    chat.emit('authenticate', {nodekey:'', ticketid: 29871});
});
chat.on('peers', function(peers) {
    $("#peers").html("");
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('peer_disconnect', function(pid) {
    $("#peer_"+pid).hide("slow");
});
chat.on('peer_connected', function(peers) {
    //expect only 1 peer connecting, but..
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('submit', function() {
    if(confirm("This ticket was updated. Do you want to refresh?")) {
        history.go(0);
    }
});

function addPeer(pid, peer) {
    var ipinfo = "";
    if(peer.ip != undefined) {
        ipinfo = "<span class=\"ip\">"+peer.ip+"</span>";
    }
    if(chat.io.engine.id == pid) {
        //don't display myself
        return;
    }
    var html = "<li class=\"new\" id=\"peer_"+pid+"\" class=\"peer\">"+peer.name+ipinfo+"</li>";
    $("#peers").prepend(html);
    $("#peers .new").animate({bottom: 0}, 1000, function() {$(this).removeClass("new")});
}

$(function() {
    $("#ticket_form").submit(function() {
        chat.emit('submit');
        return true;
    });
});
</script>
<script>
//used by searchbox
function parseValue(value) {
    var obj = new Object();
    var tokens = value.split("\t");
    obj.str = tokens[0];
    obj.count = tokens[1];
    return obj;
}

$(function() {
    //bootstrap-2.0.4 stuff
    $(".alert-message").alert();
    $(".dropdown-toggle").dropdown();
    $("span[rel='tooltip']").tooltip();
    $("a[rel=popover]").popover();

    //activate menu that user is currently on
    $("#menu_navigator").addClass("active"); 
    $("#submenu_").addClass("active"); 

    //translate zend validation error message to bootstrap
    $(".errors").addClass("alert").addClass("alert-error");

    //enable autocomplete for search box
    $("#search").autocomplete({
        source: function( request, response ) {
            $.ajax({
                url: "search/autocomplete",
                dataType: "text",
                data: {
                    //featureClass: "P",
                    //style: "full",
                    //maxRows: 12,
                    //name_startsWith: request.term
                    q: request.term
                },
                success: function( data ) {
                    response( $.map( data.split("\n"), function( item ) {
                        if(item == "") return null;
                        return {
                            value: item
                        }
                    }));
                }
            });
        },
        select: function(event, ui) {
            document.location = "search?q="+ui.item.value;
        }
    });
    
});
</script>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-69012-13");
pageTracker._trackPageview();
} catch(err) {}
</script>

</body>
