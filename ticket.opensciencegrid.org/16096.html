<!DOCTYPE html>
<html lang="en">
  <head>
  <base href="">
    <title>[16096] Problem in Monthly CPU hours per Project graph</title>    <meta charset="utf-8" />
    <meta name="verify-v1" content="na5IcAJsZVOfEkboRxuIiZ1zpZgnZiWra+nKcS7nA/o=" />
    <meta name="google-site-verification" content="DLrk3ft4s8b-S2TloLCL2LD_t6wcTjgSluf5pmiu2kA" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />
    <link href="https://ticket.opensciencegrid.org/rss" rel="alternate" type="application/rss+xml" title="GOC Ticket Update feed" />

    <style type="text/css">
      body {
        padding-top: 50px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
     #search {
            width: 300px;
     }

    </style>

<script src="https://code.jquery.com/jquery-3.0.0.js"></script>
<script src="https://code.jquery.com/jquery-migrate-3.0.1.js"></script>

   <link href="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet"/>
    <script src="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/js/bootstrap.min.js"></script>

    <link href="https://netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"/>
    <link href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/themes/smoothness/jquery-ui.min.css" rel="stylesheet"/>
 <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>


    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/js/select2.min.js"></script>

    <link href="css/ticket.css" rel="stylesheet" />
    <script src="lib/jquery.cookie.js"></script>

    <link href="images/tag_orange.png" rel="icon" type="image/png"/>
  </head>

  <body>
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>

            <a class="brand" style="padding: 6px 0px 0px 6px;" href="http://opensciencegrid.org"><img src="images/osglogo.40x30.png"/></a>
            <ul class="nav">
                <li class="dropdown"><a href="https://ticket.opensciencegrid.org/#" class="dropdown-toggle" data-toggle="dropdown">GOC Ticket <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    <li><a href="https://my.opensciencegrid.org">MyOSG</a></li>
                    <li><a href="https://oim.opensciencegrid.org">OIM</a></li>
                    <li class="active"><a href="https://ticket.opensciencegrid.org/index">Ticket</a></li>
	<li class="divider"></li>
	<li><a href="http://repo.grid.iu.edu">Repo</a></li>
	<li class="divider"></li>
	<li><a href="http://blogs.grid.iu.edu">Blog</a></li>
                    <li><a href="http://display.grid.iu.edu">Display</a></li>
                    <li><a href="http://osggoc.blogspot.com/">News</a></li>
                    </ul>
                </li>
            </ul>
            <ul class="nav pull-right">
                <li><a href="https://ticket.opensciencegrid.org/sso/">Login</a></li>            </ul>

            <div class="nav-collapse">
                <ul class="nav">
			 <li id="menu_submit"><a href="https://ticket.opensciencegrid.org/submit">Submit</a></li><li id="menu_view" class="dropdown"><a href="https://ticket.opensciencegrid.org/\#" class="dropdown-toggle" data-toggle="dropdown">View <b class="caret"></b></a><ul class="dropdown-menu"><li id="submenu_listopen"><a href="https://ticket.opensciencegrid.org/list/open">Open Tickets</a></li><li id="submenu_listrecentclose"><a href="https://ticket.opensciencegrid.org/list/recentclose">Recently Closed Tickets</a></li><li class="divider"></li><li id="submenu_alltickets"><a href="https://ticket.opensciencegrid.org/search?q=&amp;sort=id">All Tickets</a></li></ul></li>                </ul>

                <form class="navbar-search pull-right" action="https://ticket.opensciencegrid.org/viewer">
                    <input id="search" type="text" name="id" class="search-query span2" placeholder="Search Ticket" value=""/>
                </form>
            </div>
        </div>
      </div>
    </div>

<script type='text/javascript' src='lib/jquery.timeago.js'></script>
<script type='text/javascript' src='lib/byte2size.js'></script>
<style>
#updates .toolbar {
position: relative;
margin-top: 0px;
top: -10px;
font-weight: normal;
}
#updates a.anchor {
position: relative;
top: -50px;
}
#updates .selected pre {
animation:selected 2s;
animation-iteration-count: 2;
animation-direction: alternate;
-webkit-animation:selected 2s; 
-webkit-animation-iteration-count: 2;
-webkit-animation-direction: alternate;
box-shadow: inset 1px 1px 20px #9ad;
border: 1px solid #9ab;
margin: 5px 0px;
padding-left: 10px;
}
@keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ab;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
@-webkit-keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ad;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
#updates pre {
background-color: inherit;
line-height: 15px;
padding: 5px;
}
#updates .header {
color: #999;
}
#updates .update_history pre {
background-color: #eee;
color: #666;
font-size: 85%;
}
#updates .clickable {
cursor: pointer;
}
#updates .clickable:hover {
color: #D98719;
}
#updates .meta_information pre {
background-color: #fed;
}
#similar_tickets {
max-height: 300px;
overflow-y: auto;
pointer-events: none;
padding: 5px;
background-color: #f4f4f4;
}
.btn-toolbar {
margin-bottom: 0;
height: 30px;
}
#peers {
position: fixed;
bottom: 0px;
right: 0px;
z-index: 100;
list-style: none;
padding: 5px 0px 0px 5px;
margin: 0px;
background-color: white;
box-shadow: 0px 0px 10px white;
}
#peers li {
background-color: #ccc;
color: #000;
display: inline-block;
padding: 5px 10px;
margin-right: 5px;
position: relative;
}
/*
#peers li:hover {
background-color: #999;
cursor: pointer;
}
*/
#peers span.ip {
padding-left: 5px;
color: #666;
}
#peers .new {
bottom: -30px;
}
/*
#peers .me {
background-color: red;
}
*/
</style>

<div class="container-fluid">
<ul id="peers"></ul>
<div class="alert alert-danger"><a class="close" href="https://ticket.opensciencegrid.org/#" data-dismiss="alert">&times;</a>By the end of May 2018, the ticketing system at https://ticket.opensciencegrid.org will be retired and support will be provided at https://support.opensciencegrid.org. Throughout this transition the support email (help@opensciencegrid.org) will be available as a point of contact.<br><br>                                                   
                                                                                                                                                                                   
Please see the service migration page for details: https://opensciencegrid.github.io/technology/policy/service-migrations-spring-2018/#ticket</div><div id="presence" class="pull-right"></div><div class="ticketgui"><script type="text/javascript" src="lib/checktab.js"></script>

<script>
var expanded = false;
function expand_description() {
    var desc = $(".description");
    if(!expanded) {
        expanded = true;
        //expand to minheight
        var min = 250;
        if(desc.height() < min) {
            desc.animate({height: min}, 200);
        }
    }
}

$(document).ready(function() {
    $("input[name='nad']").datepicker({
        dateFormat: 'yy-mm-dd'
    });
});

</script>



<style>
.form-horizontal .control-label {
padding-top: inherit;
font-size:90%;
color:#666;
}
label {
margin-bottom: 0px;
}
.controls {
line-height: 18px;
}
</style>
<form class="form-horizontal" action="https://ticket.opensciencegrid.org/viewer/updatebasic?id=16096" method="post">
<div class="page-header">
    <h3><span class="muted">16096</span> / Problem in Monthly CPU hours per Project graph</h3>
</div>

<div class="row-fluid">
<div class="span5">
    <legend>Contact</legend>
    <div class="control-group">
        <label class="control-label">Full Name</label>
        <div class="controls">Chander Sehgal</div>
    </div>
    <div class="control-group">
        <label class="control-label">Email</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">Phone</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">CC</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>

    <legend>Details</legend>
    <div class="control-group"><label class="control-label">Submitted Via</label><div class="controls">GOC Ticket/submit</div></div><div class="control-group"><label class="control-label">Submitter</label><div class="controls">Chander Sehgal</div></div>
    <div class="control-group">
        <label class="control-label">Ticket Type</label>
        <div class="controls">Problem/Request</div>
    </div>
    <div class="control-group">
        <label class="control-label">Priority</label>
        <div class="controls">Normal</div>
    </div>
    <div class="control-group">
        <label class="control-label">Status</label>
        <div class="controls">
Closed</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action</label>
        <div class="controls">ENG Action</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action Deadline</label>
        <div class="controls flag_red">2013-07-22</div>
    </div>

</div><!--span-->
<div class="span7">
    <legend>Assignees</legend>
    <div class="assignee" style="width: 60%">Scott Teige <span class="muted"> / OSG Operations Infrastructure</span></div><div class="assignee" style="width: 60%">Software Support (Triage) <span class="muted"> / OSG Software Team</span></div><div class="assignee" style="width: 60%">Tim Cartwright <span class="muted"> / OSG Software Team</span></div><div class="assignee" style="width: 60%">Suchandra Thapa <span class="muted"> / OSG Software Team</span></div>    <br>

    <legend>Assignees</legend>
    TODO
    <br>

    <style>
legend.noborder {
border-bottom: none;
}
</style>

<div id="attachment-list"/>
<script>
$(function () {
    var first = true;
    $.getJSON("attachment/list/16096", function (files) {
        //console.dir(files);
        var html = "<table class=\"table table-condensed\">";
        $(files).each(function() {
            if(first) {
                first = false;
                html += "<legend class=\"noborder\">Attachmenets</legend>";
            }
            html += "<tr class=\"attachment\">";
            html += "<td><img src=\""+this.thumbnail_url+"\"/></td>";
            html += "<td><a href=\""+this.url+"\" target=\"_blank\">"+this.name+"</a></td>";
            html += "<td>"+bytesToSize(this.size, 1)+"</td>";
            html += "</tr>";
        });
        html += "</table>";
        $("#attachment-list").html(html);
    });
});

function download(url) {
    window.open(url, "_blank");
}
</script>


</div><!--span-->
</div><!--row-fluid-->


</form>

</div>
<div id="updates" style="clear: both;">
    <legend>Past Updates
    <div class="btn-toolbar pull-right toolbar">
    </div><!--btn-toolbar-->
    </legend>

    <div class='update_description'><i onclick="document.location='16096#1379522575'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-09-18T16:42:55+00:00">Sep 18, 2013 04:42 PM UTC</time> by <b>Tanya Levshina</b><a class="anchor" name="1379522575">&nbsp;</a></div><pre>Hi,
I think that it could be still problem of the older condor&#58;
According to attached condor job history the glidein ran on
MachineAttrGLIDEIN_ResourceName0 = &#34;MWT2&#34;
MATCH_EXP_GLIDEIN_GatekeeperB = &#34;mwt2-gk.campuscluster.illinois.edu&#58;2119/jobmanager-condor&#34;

I&#39;ve ran
globus-job-run iut2-gk.mwt2.org&#58;2119/jobmanager-fork /usr/bin/condor_version
$CondorVersion&#58; 7.8.8 Mar 20 2013 BuildID&#58; 110288 $
$CondorPlatform&#58; x86_64_rhap_5.8 $

I am still waiting for response from Dave that it is indeed the right gatekeeper and version.
Both MWT2 sites (MWT2_CE_IU and MWT2_CE_UC) reported &#34;bad&#34; job records (<a href='https&#58;//ticket.grid.iu.edu/goc/17099' target='_blank' rel='nofollow'>https&#58;//ticket.grid.iu.edu/goc/17099</a>, <a href='https&#58;//ticket.grid.iu.edu/goc/17100' target='_blank' rel='nofollow'>https&#58;//ticket.grid.iu.edu/goc/17100</a>)
Tanya</pre></div><div class='update_description'><i onclick="document.location='16096#1379513019'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-09-18T14:03:39+00:00">Sep 18, 2013 02:03 PM UTC</time> by <b>Tim Cartwright</b><a class="anchor" name="1379513019">&nbsp;</a></div><pre>As long as the changes to the Gratia HTCondor probe are still suppressing
the crazy run-time data correctly, then I see no need to keep this GOC
ticket open or to have a Software team ticket in JIRA.  I believe that the
best way to track the issue is still the HTCondor developer ticket&#58;

<a href='https&#58;//htcondor-wiki.cs.wisc.edu/index.cgi/tktview?tn=3814' target='_blank' rel='nofollow'>https&#58;//htcondor-wiki.cs.wisc.edu/index.cgi/tktview?tn=3814</a>

I will upload the new attachment to the gittrac ticket now.</pre></div><div class='update_description'><i onclick="document.location='16096#1379363343'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-09-16T20:29:03+00:00">Sep 16, 2013 08:29 PM UTC</time> by <b>Tanya Levshina</b><a class="anchor" name="1379363343">&nbsp;</a></div><pre>Hi,
We have noticed that newly installed condor 8.0.2 reports the following information&#58;
grep Remote 39691901.0.out

WantRemoteSyscalls = false
RemoteSysCpu = 18446744146.000000
LastRemoteHost = &#34;glidein_28657@....&#34;
RemoteWallClockTime = 568.000000
RemoteUserCpu = 94.000000
WantRemoteIO = true

I am attaching the whole history output</pre></div><div class='update_description'><i onclick="document.location='16096#1374844645'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-07-26T13:17:25+00:00">Jul 26, 2013 01:17 PM UTC</time> by <b>Tim Cartwright</b><a class="anchor" name="1374844645">&nbsp;</a></div><pre>It seems that we are proceeding with the Gratia quarantine process now. There are two OSG JIRA tickets for tracking progress&#58;

<a href='https&#58;//jira.opensciencegrid.org/browse/GRATIA-114' target='_blank' rel='nofollow'>https&#58;//jira.opensciencegrid.org/browse/GRATIA-114</a>
<a href='https&#58;//jira.opensciencegrid.org/browse/SOFTWARE-1132' target='_blank' rel='nofollow'>https&#58;//jira.opensciencegrid.org/browse/SOFTWARE-1132</a>

Further, the HTCondor developers are looking into the underlying cause of the enormous remote time values&#58;

<a href='https&#58;//htcondor-wiki.cs.wisc.edu/index.cgi/tktview?tn=3814' target='_blank' rel='nofollow'>https&#58;//htcondor-wiki.cs.wisc.edu/index.cgi/tktview?tn=3814</a>

Given the multiplicity of tickets, and the fact that all stakeholders have one or more means of tracking progress, I think we can safely close this GOC ticket. Unless I hear objections soon, I will do so. If need be, we can always reopen the ticket. Further, the ticket data will remain, and both the JIRA and gittrac tickets cited above refer back to it.</pre></div><div class='update_description'><i onclick="document.location='16096#1374783537'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-07-25T20:18:57+00:00">Jul 25, 2013 08:18 PM UTC</time> by <b>Suchandra Thapa</b><a class="anchor" name="1374783537">&nbsp;</a></div><pre>Adding myself back to this.  I&#39;ll shortly have a patch for the condor probe written for the probe  that will catch these cases and set RemoteSysCpu to zero.

Suchandra</pre></div><div class='update_description'><i onclick="document.location='16096#1374763336'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-07-25T14:42:16+00:00">Jul 25, 2013 02:42 PM UTC</time> by <b>John Weigand</b><a class="anchor" name="1374763336">&nbsp;</a></div><pre>I will be unavailable until Monday 7/28.
I will get back to you at that time.

John Weigand</pre></div><div class='update_description'><i onclick="document.location='16096#1374763171'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-07-25T14:39:31+00:00">Jul 25, 2013 02:39 PM UTC</time> by <b>Tim Cartwright</b><a class="anchor" name="1374763171">&nbsp;</a></div><pre>From the HTCondor development staff, TJ Knoeller (johnkn@....) is going to take over on this ticket. Greg and I will make sure that he knows about the history so far. I have added TJ to the CC list, and dropped Greg (and Suchandra).

After talking to Greg and Chander, though, I think we have a few small status updates&#58;

* The problem certainly seems to lie with HTCondor itself, not Gratia or the charting code. We see actual HTCondor log records with RemoteSysCpu set to 2147483648, which is suspiciously close to 32-bit MAXINT.
* If the problem can be found and fixed soon, a bug fix could become part of HTCondor 8.0.2.
* Depending on the nature of the fix, there may be an update to HTCondor 7.8 and/or a patch to the OSG packaging of HTCondor 7.8.8.
* If it is not possible to fix HTCondor in a reasonable timeframe, we could patch Gratia itself to ignore the records with RemoteSysCpu = 2147483648. This would mean some data loss, but at least the obviously false records would not affect overall statistics.</pre></div><div class='update_description'><i onclick="document.location='16096#1374617686'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-07-23T22:14:46+00:00">Jul 23, 2013 10:14 PM UTC</time> by <b>Tanya Levshina</b><a class="anchor" name="1374617686">&nbsp;</a></div><pre>I&#39;ve added Greg in the list again. It looks like it was deleted.</pre></div><div class='update_description'><i onclick="document.location='16096#1374617573'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-07-23T22:12:53+00:00">Jul 23, 2013 10:12 PM UTC</time> by <b>Tanya Levshina</b><a class="anchor" name="1374617573">&nbsp;</a></div><pre>I have attached (xsede_job) output of condor_history for a relevant job.
Thanks,
Tanya</pre></div><div class='update_description'><i onclick="document.location='16096#1374604476'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-07-23T18:34:36+00:00">Jul 23, 2013 06:34 PM UTC</time> by <b>Tim Cartwright</b><a class="anchor" name="1374604476">&nbsp;</a></div><pre>I am adding Greg Thain to this ticket for now, so that he can ask questions and see data directly.

In the meantime, he asked for a complete job ad from the condor_history output, for one of the jobs that has the &#34;RemoteSysCpu = 2147483648.000000&#34; value. Job ads are usually quite long, so it might be best to include it as an attachment.

— Tim</pre></div><div class='update_description'><i onclick="document.location='16096#1374600659'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-07-23T17:30:59+00:00">Jul 23, 2013 05:30 PM UTC</time> by <b>Tanya Levshina</b><a class="anchor" name="1374600659">&nbsp;</a></div><pre>Hi,
I&#39;ve ran condor_history on osg-xsede&#58;
condor_history -l |grep RemoteSysCpu|grep 2147483648
RemoteSysCpu = 2147483648.000000
RemoteSysCpu = 2147483648.000000
Is it possible to ask HTCondor development team to look at this problem? Let me know if you need any additional information.
Thanks,
Tanya</pre></div><div class='update_description'><i onclick="document.location='16096#1374597551'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-07-23T16:39:11+00:00">Jul 23, 2013 04:39 PM UTC</time> by <b>Tanya Levshina</b><a class="anchor" name="1374597551">&nbsp;</a></div><pre>Hi Tim,

Thanks for clarification. Gratia condor probe gets information from condor history and form CPUSystemDuration by adding class[RemoteSysCpu&#39;] and classad[&#39;LocalSysCpu&#39;].

I will try to figure out if I can pull history for the offending records directly from condor history.
Thanks,
Tanya</pre></div><div class='update_description'><i onclick="document.location='16096#1374593778'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-07-23T15:36:18+00:00">Jul 23, 2013 03:36 PM UTC</time> by <b>Tim Cartwright</b><a class="anchor" name="1374593778">&nbsp;</a></div><pre>I talked to Greg Thain on the HTCondor development team, and learned (maybe) a few things. For one, the “CpuSystemDuration” field is NOT an HTCondor attribute, at least not by that name. Also, the CpuSystemDuration value of 2147483648 looks suspiciously close to one possible maximum integer value (typically, a maximum negative integer in a 32-bit value), so it makes it seem much more like a programmatic error of some sort.

Assuming that this is HTCondor data going through Gratia... Suchandra, you are currently listed as the owner of the HTCondor probe. Can you look at the code very carefully and see if there is any failure condition such that it could report MAXINT CPU usage?

Other than that, I have only fact-finding and background types of questions&#58;

1. Who can trace the sequence of programs through which this data passed? Again, I assume that it started with raw HTCondor usage data on some system, which was parsed and consolidated by Gratia?, then passed to a Gratia collector, then reported on by ???, etc.

2. For what site(s), user(s), etc., is this problem visible? Is it only the user spadhi? Does it occur only for one VO? From a particular site? I cannot actually get the GOC ticket system to display the attached graph, except in thumbnail form, so I cannot read it myself to learn more.

— Tim</pre></div><div class='update_description'><i onclick="document.location='16096#1374593776'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-07-23T15:36:16+00:00">Jul 23, 2013 03:36 PM UTC</time> by <b>Tim Cartwright</b><a class="anchor" name="1374593776">&nbsp;</a></div><pre>I talked to Greg Thain on the HTCondor development team, and learned (maybe) a few things. For one, the “CpuSystemDuration” field is NOT an HTCondor attribute, at least not by that name. Also, the CpuSystemDuration value of 2147483648 looks suspiciously close to one possible maximum integer value (typically, a maximum negative integer in a 32-bit value), so it makes it seem much more like a programmatic error of some sort.

Assuming that this is HTCondor data going through Gratia... Suchandra, you are currently listed as the owner of the HTCondor probe. Can you look at the code very carefully and see if there is any failure condition such that it could report MAXINT CPU usage?

Other than that, I have only fact-finding and background types of questions&#58;

1. Who can trace the sequence of programs through which this data passed? Again, I assume that it started with raw HTCondor usage data on some system, which was parsed and consolidated by Gratia?, then passed to a Gratia collector, then reported on by ???, etc.

2. For what site(s), user(s), etc., is this problem visible? Is it only the user spadhi? Does it occur only for one VO? From a particular site? I cannot actually get the GOC ticket system to display the attached graph, except in thumbnail form, so I cannot read it myself to learn more.

— Tim</pre></div><div class='update_description'><i onclick="document.location='16096#1374593772'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-07-23T15:36:12+00:00">Jul 23, 2013 03:36 PM UTC</time> by <b>Tim Cartwright</b><a class="anchor" name="1374593772">&nbsp;</a></div><pre>I talked to Greg Thain on the HTCondor development team, and learned (maybe) a few things. For one, the “CpuSystemDuration” field is NOT an HTCondor attribute, at least not by that name. Also, the CpuSystemDuration value of 2147483648 looks suspiciously close to one possible maximum integer value (typically, a maximum negative integer in a 32-bit value), so it makes it seem much more like a programmatic error of some sort.

Assuming that this is HTCondor data going through Gratia... Suchandra, you are currently listed as the owner of the HTCondor probe. Can you look at the code very carefully and see if there is any failure condition such that it could report MAXINT CPU usage?

Other than that, I have only fact-finding and background types of questions&#58;

1. Who can trace the sequence of programs through which this data passed? Again, I assume that it started with raw HTCondor usage data on some system, which was parsed and consolidated by Gratia?, then passed to a Gratia collector, then reported on by ???, etc.

2. For what site(s), user(s), etc., is this problem visible? Is it only the user spadhi? Does it occur only for one VO? From a particular site? I cannot actually get the GOC ticket system to display the attached graph, except in thumbnail form, so I cannot read it myself to learn more.

— Tim</pre></div><div class='update_description'><i onclick="document.location='16096#1374591942'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-07-23T15:05:42+00:00">Jul 23, 2013 03:05 PM UTC</time> by <b>Tim Cartwright</b><a class="anchor" name="1374591942">&nbsp;</a></div><pre>What is the original source of the invalid data? Is it one of the HTCondor log files? All that I can see in this ticket is summary data that has passed through many pieces of code. I think that it will help the HTCondor folks debug this issue if we dig down to the raw data. In the meantime, I will talk to the developers and see what I can learn from them.

-- TimC</pre></div><div class='update_description'><i onclick="document.location='16096#1374530832'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-07-22T22:07:12+00:00">Jul 22, 2013 10:07 PM UTC</time> by <b>Tanya Levshina</b><a class="anchor" name="1374530832">&nbsp;</a></div><pre>I have ran a script that identified the records that are reporting unrealistic cpu time. This script has been  just recently developed by John Weigand.
Below  are just couple of records that were causing problems on 07/09/2013 by condor&#58;osg-xsede.grid.iu.edu.
+-----------------------------------------------+-------------+------------+-------------------+-----------------+--------------+
| CommonName                                                               | LocalUserID | LocalJobId | CpuSystemDuration | CpuUserDuration | WallDuration |
+-----------------------------------------------+-------------+------------+-------------------+-----------------+--------------+
| /CN=spadhi/CN=634969/CN=Sanjay Padhi/CN=proxy | spadhi      | 34345946   |        2147483648 |           23919 |        35292 |
| /CN=spadhi/CN=634969/CN=Sanjay Padhi                   | spadhi      | 34421789   |        2147483648 |             554 |         1091 |
| /CN=spadhi/CN=634969/CN=Sanjay Padhi                   | spadhi      | 34435243   |        2147483648 |            1002 |         1899 |
+-----------------------------------------------+-------------+------------+-------------------+-----------------+--------------+

We should contact condor team and ask them why CpuSystemDuration can be set to 2147483648?
John has developed a procedure to fix the database but we should try to understand the source of the problem.

Thanks,
Tanya</pre></div><div class='update_description'><i onclick="document.location='16096#1374530590'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-07-22T22:03:10+00:00">Jul 22, 2013 10:03 PM UTC</time> by <b>wbhurst@....</b><a class="anchor" name="1374530590">&nbsp;</a></div><pre>Hello Soichi,

Sure, I can take a look at the graph and the code.

Best Regards,
Brad Hurst

On Mon, 2013-07-22 at 18&#58;16 +0000, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='16096#1374526818'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-07-22T21:00:18+00:00">Jul 22, 2013 09:00 PM UTC</time> by <b>Tanya Levshina</b><a class="anchor" name="1374526818">&nbsp;</a></div><pre>Yes, and I agree with Scott and you. I didn&#39;t really look at WallHours/CPU - we have very efficient jobs here.
The problem is with CPUSystemHours&#58;

+-----------+-----------+-------------+------------+
| WallHours | UserHours | SystemHours | sum(NJobs) |
+-----------+-----------+-------------+------------+
|    762833 |    471771 |    15524219 |     364040 |
+-----------+-----------+-------------+------------+

CpuSystemHours number doesn&#39;t make any sense. It has started happening on 7/9/2013.
Efficiency for the previous month until 7/10/2013&#58;
+---------------------+------------+
| EndTime             | Efficiency |
+---------------------+------------+
| 2013-06-02 00&#58;00&#58;00 |    39.0663 |
| 2013-06-03 00&#58;00&#58;00 |    27.5981 |
| 2013-06-04 00&#58;00&#58;00 |    43.5970 |
| 2013-06-05 00&#58;00&#58;00 |    44.1273 |
| 2013-06-06 00&#58;00&#58;00 |    56.2817 |
| 2013-06-07 00&#58;00&#58;00 |    52.1039 |
| 2013-06-08 00&#58;00&#58;00 |    53.3688 |
| 2013-06-09 00&#58;00&#58;00 |    52.9736 |
| 2013-06-10 00&#58;00&#58;00 |    51.5486 |
| 2013-06-11 00&#58;00&#58;00 |    49.1730 |
| 2013-06-12 00&#58;00&#58;00 |    51.6239 |
| 2013-06-13 00&#58;00&#58;00 |    52.1695 |
| 2013-06-14 00&#58;00&#58;00 |    61.5212 |
| 2013-06-15 00&#58;00&#58;00 |    72.1470 |
| 2013-06-16 00&#58;00&#58;00 |    79.3284 |
| 2013-06-17 00&#58;00&#58;00 |    78.8745 |
| 2013-06-18 00&#58;00&#58;00 |    17.0747 |
| 2013-06-19 00&#58;00&#58;00 |    51.5567 |
| 2013-06-20 00&#58;00&#58;00 |    60.4406 |
| 2013-06-21 00&#58;00&#58;00 |    63.1548 |
| 2013-06-22 00&#58;00&#58;00 |    18.1256 |
<div id='show_1589792889' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_1589792889'>| 2013-06-23 00&#58;00&#58;00 |    47.2176 |
| 2013-06-24 00&#58;00&#58;00 |    48.1540 |
| 2013-06-25 00&#58;00&#58;00 |    40.0456 |
| 2013-06-26 00&#58;00&#58;00 |    68.2153 |
| 2013-06-27 00&#58;00&#58;00 |    63.1735 |
| 2013-06-28 00&#58;00&#58;00 |     6.9899 |
| 2013-06-29 00&#58;00&#58;00 |    19.0476 |
| 2013-07-02 00&#58;00&#58;00 |    17.8641 |
| 2013-07-03 00&#58;00&#58;00 |     3.3333 |
| 2013-07-04 00&#58;00&#58;00 |    21.8009 |
| 2013-07-05 00&#58;00&#58;00 |    19.5455 |
| 2013-07-06 00&#58;00&#58;00 |    24.8673 |
| 2013-07-07 00&#58;00&#58;00 |    60.9866 |
| 2013-07-08 00&#58;00&#58;00 |    53.7296 |
| 2013-07-09 00&#58;00&#58;00 |  2387.3226 |
| 2013-07-10 00&#58;00&#58;00 |    56.3224 |
| 2013-07-11 00&#58;00&#58;00 |    67.4155 |
| 2013-07-12 00&#58;00&#58;00 |  7005.8484 |
| 2013-07-13 00&#58;00&#58;00 |  3574.3690 |
| 2013-07-14 00&#58;00&#58;00 |    72.4671 |
| 2013-07-15 00&#58;00&#58;00 |  5602.2814 |

but I&#39;ve just checked individual records and they all looks fine. I will investigate further.

Thanks,
Tanya

On Jul 22, 2013, at 3&#58;15 PM, Open Science Grid FootPrints wrote&#58;

[Duplicate message snipped]
</div><script type='text/javascript'>
        $('#show_1589792889').click(function() {
            $('#detail_1589792889').slideDown("normal");
            $('#show_1589792889').hide();
            $('#hide_1589792889').show();
        });
        $('#hide_1589792889').click(function() {
            $('#detail_1589792889').slideUp();
            $('#hide_1589792889').hide();
            $('#show_1589792889').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='16096#1374524109'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-07-22T20:15:09+00:00">Jul 22, 2013 08:15 PM UTC</time> by <b>Chander Sehgal</b><a class="anchor" name="1374524109">&nbsp;</a></div><pre>I agree with Scott; the graph may be a correct representation of the data .  But the data looks suspect.

The wall time hours look right but the CPU hours look wrong;

| 2013-07-15 00&#58;00&#58;00 | 53915 | 3020470 | 22817 |

On July 15, this says they did over 3M hours; but all of OSG only does about 2M hours in a day.

Chander</pre></div><div class='update_description'><i onclick="document.location='16096#1374520049'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-07-22T19:07:29+00:00">Jul 22, 2013 07:07 PM UTC</time> by <b>Scott Teige</b><a class="anchor" name="1374520049">&nbsp;</a></div><pre>Hello,
Looks like the data is incorrect. Unless the snowmass folk are running somewhere other than osg-xsede
I can see no way they could get more than ~5M hours/month. And I used wildly optimistic assumptions to get
that number.
S</pre></div><div class='update_description'><i onclick="document.location='16096#1374517150'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-07-22T18:19:10+00:00">Jul 22, 2013 06:19 PM UTC</time> by <b>Kyle Gross</b><a class="anchor" name="1374517150">&nbsp;</a></div><pre>Chander,

The graph is correct (it display the information store in gratia)&#58;

select endtime,round(sum(WallDuration)/3600.,0) as WallHours,(round(sum(CpuUserDuration)/3600.,0)+round(sum(CpuSystemDuration)/3600.,0)) as CPUHours, sum(NJobs) from VOProbeSummary  where ReportableProjectName=&#34;SNOWMASS&#34; and EndTime &#62;&#39;2013-07-01&#39; and ResourceType=&#34;BatchPilot&#34; group by endTime;
+---------------------+-----------+----------+------------+
| EndTime             | WallHours | CPUHours | sum(NJobs) |
+---------------------+-----------+----------+------------+
| 2013-07-02 00&#58;00&#58;00 |      2060 |      368 |       2997 |
| 2013-07-03 00&#58;00&#58;00 |        60 |        2 |          3 |
| 2013-07-04 00&#58;00&#58;00 |       211 |       46 |        777 |
| 2013-07-05 00&#58;00&#58;00 |      1540 |      301 |       4419 |
| 2013-07-06 00&#58;00&#58;00 |      1130 |      281 |       4045 |
| 2013-07-07 00&#58;00&#58;00 |     28057 |    17111 |      20091 |
| 2013-07-08 00&#58;00&#58;00 |     45621 |    24512 |      24996 |
| 2013-07-09 00&#58;00&#58;00 |     76609 |  1828904 |      30220 |
| 2013-07-10 00&#58;00&#58;00 |     91271 |    51406 |      48379 |
| 2013-07-11 00&#58;00&#58;00 |    100109 |    67489 |      39349 |
| 2013-07-12 00&#58;00&#58;00 |     42935 |  3007961 |      23539 |
| 2013-07-13 00&#58;00&#58;00 |     51067 |  1825323 |      28654 |
| 2013-07-14 00&#58;00&#58;00 |     42008 |    30442 |      20486 |
| 2013-07-15 00&#58;00&#58;00 |     53915 |  3020470 |      22817 |
| 2013-07-16 00&#58;00&#58;00 |     49990 |    37249 |      19604 |
| 2013-07-17 00&#58;00&#58;00 |     38463 |    25530 |      13790 |
| 2013-07-18 00&#58;00&#58;00 |     40157 |  1817005 |      18803 |
| 2013-07-19 00&#58;00&#58;00 |     39283 |  1224515 |      15469 |
| 2013-07-20 00&#58;00&#58;00 |     20690 |  1804033 |       9291 |
| 2013-07-21 00&#58;00&#58;00 |     20478 |   607759 |       9099 |
| 2013-07-22 00&#58;00&#58;00 |     14578 |   603877 |       6175 |
+---------------------+-----------+----------+------------+
21 rows in set (0.45 sec)

mysql&#62; select round(sum(WallDuration)/3600.,0) as WallHours,(round(sum(CpuUserDuration)/3600.,0)+round(sum(CpuSystemDuration)/3600.,0)) as CPUHours, sum(NJobs) from VOProbeSummary  where ReportableProjectName=&#34;SNOWMASS&#34; and EndTime &#62;&#39;2013-07-01&#39; and ResourceType=&#34;BatchPilot&#34;;
+-----------+----------+------------+
| WallHours | CPUHours | sum(NJobs) |
<div id='show_1310355790' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_1310355790'>+-----------+----------+------------+
|    760367 | 15994635 |     363033 |
+-----------+----------+------------+

or
<a href='http&#58;//gratiaweb.grid.iu.edu/gratia/xml/monthly_project_cpu_hours?endtime=2013-07-22+23%3A59%3A59&span=2419200&facility=.*&exclude-projectname=unknown|other|BNL.*|UMICH|EIC|DET.*|TG-*|OSG-*|CSIU|RIT&probe=.*&resource-type=BatchPilot&vo=.*&role=.*&starttime=2012-07-15+00%3A00%3A00&exclude-facility=NONE|Generic|Obsolete&exclude-user=NONE&includeSuccess=true&exclude-vo=Unknown|unknown|other&includeFailed=true&exclude-role=NONE' target='_blank' rel='nofollow'>http&#58;//gratiaweb.grid.iu.edu/gratia/xml/monthly_project_cpu_hours?endtime=2013-07-22+23%3A59%3A59&span=2419200&facility=.*&exclude-projectname=unknown|other|BNL.*|UMICH|EIC|DET.*|TG-*|OSG-*|CSIU|RIT&probe=.*&resource-type=BatchPilot&vo=.*&role=.*&starttime=2012-07-15+00%3A00%3A00&exclude-facility=NONE|Generic|Obsolete&exclude-user=NONE&includeSuccess=true&exclude-vo=Unknown|unknown|other&includeFailed=true&exclude-role=NONE</a>

If you are concerned about this data , please let me know if I need to investigate further.

Thanks,
Tanya
</div><script type='text/javascript'>
        $('#show_1310355790').click(function() {
            $('#detail_1310355790').slideDown("normal");
            $('#show_1310355790').hide();
            $('#hide_1310355790').show();
        });
        $('#hide_1310355790').click(function() {
            $('#detail_1310355790').slideUp();
            $('#hide_1310355790').hide();
            $('#show_1310355790').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='16096#1374516975'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-07-22T18:16:15+00:00">Jul 22, 2013 06:16 PM UTC</time> by <b>Soichi Hayashi</b><a class="anchor" name="1374516975">&nbsp;</a></div><pre>Brad,

Will you take a look at the graph?</pre></div><div class='update_description'><i onclick="document.location='16096#1374516510'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-07-22T18:08:30+00:00">Jul 22, 2013 06:08 PM UTC</time> by <b>Kyle Gross</b><a class="anchor" name="1374516510">&nbsp;</a></div><pre>Adding Attachment.</pre></div><div class='update_description'><i onclick="document.location='16096#1374516455'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-07-22T18:07:35+00:00">Jul 22, 2013 06:07 PM UTC</time> by <b>Kyle Gross</b><a class="anchor" name="1374516455">&nbsp;</a></div><pre>The second graph at <a href='http&#58;//gratiaweb.grid.iu.edu/gratia/project' target='_blank' rel='nofollow'>http&#58;//gratiaweb.grid.iu.edu/gratia/project</a> called “Monthly CPU hours per Project” shows results for the current month that look to be wrong; see attached.    I believe the correct answer for July 2013 is approx 2.5M hours – not 17M hours.

Thanks,

Chander</pre></div>
</div>
<script type="text/javascript">
function reset_anchor() {
    $("#updates .selected").removeClass("selected");
    var urls = document.location.toString().split('#'); 
    var anchor = urls[1];
    if(anchor) {
        $("a[name='"+anchor+"']").parents(".update_description").addClass("selected");
    }
}
function submitspam(ticket_id) {
    myret = confirm("Would you like to close this ticket as a security ticket, and submit the ticket content to akismet?");
    if(myret == true) {
        $.ajax("viewer/processspam?id="+ticket_id).done(function() {
            window.location.reload();
        });
    }
}

$(function() {
    reset_anchor();
    var ADDITIONAL_COOKIE_NAME = 'gocticket';
    var options = { path: '/', expires: 365};

    if(window.opener && window.opener.name == "gocticket_list") {
        v = $.cookie("closewindow");
        if(!v) {
            $("#closewindow").attr("checked", "checked"); //on by default
        } else {
            if(v == "checked") {
                $("#closewindow").attr("checked", "checked");
            }
        }
        $("#closewindow").click(function() {
            $.cookie("closewindow", $(this).attr('checked'), options);
        });
    } else {
        $("#closewindow_area").hide();
    }
    function updateTimeago() {
        $("time").timeago();
        setTimeout(updateTimeago, 30*1000);
    }
    updateTimeago();
    $(".description").focus(expand_description);
});
</script>
<hr/>
<footer>
<p>GOC Ticket Version 2.2 | <a href="https://ticket.opensciencegrid.org/goc/submit?app_issue_check=on&amp;app_issue_type=goc&amp;app_goc_url=https%3A%2F%2Fticket.opensciencegrid.org%3A443%2F16096">Report Bugs</a>
 | <a href="https://github.com/opensciencegrid/operations/blob/master/docs/privacy.md">Privacy Policy</a>
</p>

<p> <img align="top" src="images/tag_orange.png"/> Copyright 2018 The Trustees of Indiana University - Developed for Open Science Grid</p>
</footer>


</div><!--container-fluid-->
<script>
//used by searchbox
function parseValue(value) {
    var obj = new Object();
    var tokens = value.split("\t");
    obj.str = tokens[0];
    obj.count = tokens[1];
    return obj;
}

$(function() {
    //bootstrap-2.0.4 stuff
    $(".alert-message").alert();
    $(".dropdown-toggle").dropdown();
    $("span[rel='tooltip']").tooltip();
    $("a[rel=popover]").popover();

    //activate menu that user is currently on
    $("#menu_navigator").addClass("active"); 
    $("#submenu_").addClass("active"); 

    //translate zend validation error message to bootstrap
    $(".errors").addClass("alert").addClass("alert-error");

    //enable autocomplete for search box
    $("#search").autocomplete({
        source: function( request, response ) {
            $.ajax({
                url: "search/autocomplete",
                dataType: "text",
                data: {
                    //featureClass: "P",
                    //style: "full",
                    //maxRows: 12,
                    //name_startsWith: request.term
                    q: request.term
                },
                success: function( data ) {
                    response( $.map( data.split("\n"), function( item ) {
                        if(item == "") return null;
                        return {
                            value: item
                        }
                    }));
                }
            });
        },
        select: function(event, ui) {
            document.location = "search?q="+ui.item.value;
        }
    });
    
});
</script>


</body>
