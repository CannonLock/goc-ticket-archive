<!DOCTYPE html>
<html lang="en">
  <head>
  <base href="">
    <title>[13286] GLOW jobs are thrashing on worker nodes at UConn-OSG site</title>    <meta charset="utf-8" />
    <meta name="verify-v1" content="na5IcAJsZVOfEkboRxuIiZ1zpZgnZiWra+nKcS7nA/o=" />
    <meta name="google-site-verification" content="DLrk3ft4s8b-S2TloLCL2LD_t6wcTjgSluf5pmiu2kA" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />
    <link href="https://ticket.opensciencegrid.org/rss" rel="alternate" type="application/rss+xml" title="GOC Ticket Update feed" />

    <style type="text/css">
      body {
        padding-top: 50px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
     #search {
            width: 300px;
     }

    </style>

<script src="https://code.jquery.com/jquery-3.0.0.js"></script>
<script src="https://code.jquery.com/jquery-migrate-3.0.1.js"></script>

   <link href="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet"/>
    <script src="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/js/bootstrap.min.js"></script>

    <link href="https://netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"/>
    <link href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/themes/smoothness/jquery-ui.min.css" rel="stylesheet"/>
 <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>


    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/js/select2.min.js"></script>

    <link href="css/ticket.css" rel="stylesheet" />
    <script src="lib/jquery.cookie.js"></script>

    <link href="images/tag_orange.png" rel="icon" type="image/png"/>
    <script src='https://www.google.com/recaptcha/api.js'></script>
  </head>

  <body>
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>

            <a class="brand" style="padding: 6px 0px 0px 6px;" href="http://opensciencegrid.org"><img src="images/osglogo.40x30.png"/></a>
            <ul class="nav">
                <li class="dropdown"><a href="https://ticket.opensciencegrid.org/#" class="dropdown-toggle" data-toggle="dropdown">GOC Ticket <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    <li><a href="https://my.opensciencegrid.org">MyOSG</a></li>
                    <li><a href="https://oim.opensciencegrid.org">OIM</a></li>
                    <li class="active"><a href="https://ticket.opensciencegrid.org/index">Ticket</a></li>
	<li class="divider"></li>
	<li><a href="http://repo.grid.iu.edu">Repo</a></li>
	<li class="divider"></li>
	<li><a href="http://blogs.grid.iu.edu">Blog</a></li>
                    <li><a href="http://display.grid.iu.edu">Display</a></li>
                    <li><a href="http://osggoc.blogspot.com/">News</a></li>
                    </ul>
                </li>
            </ul>
            <ul class="nav pull-right">
                <li><a href="https://ticket.opensciencegrid.org/sso/">Login</a></li>            </ul>

            <div class="nav-collapse">
                <ul class="nav">
			 <li id="menu_submit"><a href="https://ticket.opensciencegrid.org/submit">Submit</a></li><li id="menu_view" class="dropdown"><a href="https://ticket.opensciencegrid.org/\#" class="dropdown-toggle" data-toggle="dropdown">View <b class="caret"></b></a><ul class="dropdown-menu"><li id="submenu_listopen"><a href="https://ticket.opensciencegrid.org/list/open">Open Tickets</a></li><li id="submenu_listrecentclose"><a href="https://ticket.opensciencegrid.org/list/recentclose">Recently Closed Tickets</a></li><li class="divider"></li><li id="submenu_alltickets"><a href="https://ticket.opensciencegrid.org/search?q=&amp;sort=id">All Tickets</a></li></ul></li>                </ul>

                <form class="navbar-search pull-right" action="https://ticket.opensciencegrid.org/viewer">
                    <input id="search" type="text" name="id" class="search-query span2" placeholder="Search Ticket" value=""/>
                </form>
            </div>
        </div>
      </div>
    </div>

<script type='text/javascript' src='lib/jquery.timeago.js'></script>
<script type='text/javascript' src='lib/byte2size.js'></script>
<style>
#updates .toolbar {
position: relative;
margin-top: 0px;
top: -10px;
font-weight: normal;
}
#updates a.anchor {
position: relative;
top: -50px;
}
#updates .selected pre {
animation:selected 2s;
animation-iteration-count: 2;
animation-direction: alternate;
-webkit-animation:selected 2s; 
-webkit-animation-iteration-count: 2;
-webkit-animation-direction: alternate;
box-shadow: inset 1px 1px 20px #9ad;
border: 1px solid #9ab;
margin: 5px 0px;
padding-left: 10px;
}
@keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ab;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
@-webkit-keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ad;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
#updates pre {
background-color: inherit;
line-height: 15px;
padding: 5px;
}
#updates .header {
color: #999;
}
#updates .update_history pre {
background-color: #eee;
color: #666;
font-size: 85%;
}
#updates .clickable {
cursor: pointer;
}
#updates .clickable:hover {
color: #D98719;
}
#updates .meta_information pre {
background-color: #fed;
}
#similar_tickets {
max-height: 300px;
overflow-y: auto;
pointer-events: none;
padding: 5px;
background-color: #f4f4f4;
}
.btn-toolbar {
margin-bottom: 0;
height: 30px;
}
#peers {
position: fixed;
bottom: 0px;
right: 0px;
z-index: 100;
list-style: none;
padding: 5px 0px 0px 5px;
margin: 0px;
background-color: white;
box-shadow: 0px 0px 10px white;
}
#peers li {
background-color: #ccc;
color: #000;
display: inline-block;
padding: 5px 10px;
margin-right: 5px;
position: relative;
}
/*
#peers li:hover {
background-color: #999;
cursor: pointer;
}
*/
#peers span.ip {
padding-left: 5px;
color: #666;
}
#peers .new {
bottom: -30px;
}
/*
#peers .me {
background-color: red;
}
*/
</style>

<div class="container-fluid">
<ul id="peers"></ul>
<div class="alert alert-danger"><a class="close" href="https://ticket.opensciencegrid.org/#" data-dismiss="alert">&times;</a>By the end of May 2018, the ticketing system at https://ticket.opensciencegrid.org will be retired and support will be provided at https://support.opensciencegrid.org. Throughout this transition the support email (help@opensciencegrid.org) will be available as a point of contact.<br><br>                                                   
                                                                                                                                                                                   
Please see the service migration page for details: https://opensciencegrid.github.io/technology/policy/service-migrations-spring-2018/#ticket</div><div id="presence" class="pull-right"></div><div class="ticketgui"><script type="text/javascript" src="lib/checktab.js"></script>

<script>
var expanded = false;
function expand_description() {
    var desc = $(".description");
    if(!expanded) {
        expanded = true;
        //expand to minheight
        var min = 250;
        if(desc.height() < min) {
            desc.animate({height: min}, 200);
        }
    }
}

$(document).ready(function() {
    $("input[name='nad']").datepicker({
        dateFormat: 'yy-mm-dd'
    });
});

</script>



<style>
.form-horizontal .control-label {
padding-top: inherit;
font-size:90%;
color:#666;
}
label {
margin-bottom: 0px;
}
.controls {
line-height: 18px;
}
</style>
<form class="form-horizontal" action="https://ticket.opensciencegrid.org/viewer/updatebasic?id=13286" method="post">
<div class="page-header">
    <h3><span class="muted">13286</span> / GLOW jobs are thrashing on worker nodes at UConn-OSG site</h3>
</div>

<div class="row-fluid">
<div class="span5">
    <legend>Contact</legend>
    <div class="control-group">
        <label class="control-label">Full Name</label>
        <div class="controls">Richard T. Jones</div>
    </div>
    <div class="control-group">
        <label class="control-label">Email</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">Phone</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">CC</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>

    <legend>Details</legend>
    <div class="control-group"><label class="control-label">Associated VO</label><div class="controls">GLOW</div></div><div class="control-group"><label class="control-label">Submitted Via</label><div class="controls">GOC Ticket/submit</div></div><div class="control-group"><label class="control-label">Submitter</label><div class="controls">Richard T. Jones</div></div><div class="control-group"><label class="control-label">Support Center</label><div class="controls">GLOW-TECH</div></div>
    <div class="control-group">
        <label class="control-label">Ticket Type</label>
        <div class="controls">Problem/Request</div>
    </div>
    <div class="control-group">
        <label class="control-label">Priority</label>
        <div class="controls">Normal</div>
    </div>
    <div class="control-group">
        <label class="control-label">Status</label>
        <div class="controls">
Closed</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action</label>
        <div class="controls">ENG Action</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action Deadline</label>
        <div class="controls flag_red">2013-01-18</div>
    </div>

</div><!--span-->
<div class="span7">
    <legend>Assignees</legend>
    <div class="assignee" style="width: 60%">GLOW-TECH <span class="muted"> / OSG Support Centers</span></div><div class="assignee" style="width: 60%">Rob Quick <span class="muted"> / OSG GOC Management</span></div>    <br>

    <legend>Assignees</legend>
    TODO
    <br>

    <style>
legend.noborder {
border-bottom: none;
}
</style>

<div id="attachment-list"/>
<script>
$(function () {
    var first = true;
    $.getJSON("attachment/list/13286", function (files) {
        //console.dir(files);
        var html = "<table class=\"table table-condensed\">";
        $(files).each(function() {
            if(first) {
                first = false;
                html += "<legend class=\"noborder\">Attachmenets</legend>";
            }
            html += "<tr class=\"attachment\">";
            html += "<td><img src=\""+this.thumbnail_url+"\"/></td>";
            html += "<td><a href=\""+this.url+"\" target=\"_blank\">"+this.name+"</a></td>";
            html += "<td>"+bytesToSize(this.size, 1)+"</td>";
            html += "</tr>";
        });
        html += "</table>";
        $("#attachment-list").html(html);
    });
});

function download(url) {
    window.open(url, "_blank");
}
</script>


</div><!--span-->
</div><!--row-fluid-->


</form>

</div>
<div id="updates" style="clear: both;">
    <legend>Past Updates
    <div class="btn-toolbar pull-right toolbar">
        <div class="btn-group">
                <a class="btn btn-small" href="https://ticket.opensciencegrid.org/13286?sort=up&amp;"><i class="icon-arrow-up"></i> Sort</a>

        
        <a class="btn btn-small" href="https://ticket.opensciencegrid.org/13286?expandall=true&amp;">Expand Descriptions</a>        <a class="btn btn-small" target="_blank" href="mailto:osg@tick.globalnoc.iu.edu?subject=Open%20Science%20Grid%3A%20GLOW%20jobs%20are%20thrashing%20on%20worker%20nodes%20at%20UConn-OSG%20site%20ISSUE%3D13286%20PROJ%3D71"><i class="icon-envelope"></i> Update w/Email</a>
        </div>
    </div><!--btn-toolbar-->
    </legend>

    <div class='update_description'><i onclick="document.location='13286#1358871804'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-01-22T16:23:24+00:00">Jan 22, 2013 04:23 PM UTC</time> by <b>Igor Sfiligoi</b><a class="anchor" name="1358871804">&nbsp;</a></div><pre>As far as I can tell, there is noting in the OSG environemnt that tells us what the limit is; so finding it out at runtime is not possible (in the genaral case).
Physical memry/nr slots(or CPUs) is not a goo estimate for a lot odf sites.

Plus, we want to know the limit during frontend matchmaking, so the factory should be advertising it anyhow.

Bottom line, we (the factory ops) just must get better at keeping the MAXMBs number accurate for the different sites.
(My appologies that we have not been good enough at it so far)

As for this specific ticket, if Richard can confirm that the limit is 1G, we can set the number appropriately in the factory config.

Cheers,
Igor</pre></div><div class='update_description'><i onclick="document.location='13286#1358282402'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-01-15T20:40:02+00:00">Jan 15, 2013 08:40 PM UTC</time><a class="anchor" name="1358282402">&nbsp;</a></div><pre>Burt, I&#39;ll have to discuss this more with Igor to determine what would be best.  I&#39;ll get back to you when we&#39;ve done so.  Since the present issue seems resolved, I&#39;m closing the ticket.

--Alex

by /DC=org/DC=doegrids/OU=People/CN=Alexander Georges 435073</pre></div><div class='update_description'><i onclick="document.location='13286#1358278571'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-01-15T19:36:11+00:00">Jan 15, 2013 07:36 PM UTC</time> by <b>GLUEX</b><a class="anchor" name="1358278571">&nbsp;</a></div><pre>Dan and all,

Yes, I agree.  The GLOW jobs I see running now are all well within bounds in terms of resident set.  They seem to be short jobs (typical run time I see is less than 15 minutes) but they are running fine.

-Richard J.

On 1/15/2013 12&#58;49 PM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='13286#1358274249'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-01-15T18:24:09+00:00">Jan 15, 2013 06:24 PM UTC</time> by <b>Burt Holzman</b><a class="anchor" name="1358274249">&nbsp;</a></div><pre>Does it work better if we don&#39;t set it in the factory and let the
scripts do the estimation?  (They just take physmem/cores).

On 01/14/13 16&#58;28, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='13286#1358272163'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-01-15T17:49:23+00:00">Jan 15, 2013 05:49 PM UTC</time><a class="anchor" name="1358272163">&nbsp;</a></div><pre>Alex & Richard,

The glideins are now reporting 1GB of memory available, rather than 2GB.  Currently, I see no evidence on our end that we are overusing the memory of these nodes.  I would expect well behaved jobs to respect the memory availability that is advertised, so, barring accidents, I think the problem has been largely solved.  Unless Richard objects, I recommend that we close this ticket until further evidence of trouble appears.

--Dan

by /DC=org/DC=doegrids/OU=People/CN=Dan Bradley 268953</pre></div><div class='update_description'><i onclick="document.location='13286#1358271550'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-01-15T17:39:10+00:00">Jan 15, 2013 05:39 PM UTC</time><a class="anchor" name="1358271550">&nbsp;</a></div><pre>Dan, I see glideins have started up successfully after implementing this change.  How do things look on your end?

--Alex

by /DC=org/DC=doegrids/OU=People/CN=Alexander Georges 435073</pre></div><div class='update_description'><i onclick="document.location='13286#1358203556'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-01-14T22:45:56+00:00">Jan 14, 2013 10:45 PM UTC</time><a class="anchor" name="1358203556">&nbsp;</a></div><pre>Dan, I&#39;ve changed this attribute to 1GB in the UCSD and GOC factories for UConn sites.  I suggest we wait to see pilots start successfully before closing this ticket.

Best,
Alex

by /DC=org/DC=doegrids/OU=People/CN=Alexander Georges 435073</pre></div><div class='update_description'><i onclick="document.location='13286#1358202534'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-01-14T22:28:54+00:00">Jan 14, 2013 10:28 PM UTC</time><a class="anchor" name="1358202534">&nbsp;</a></div><pre>Hi Dan,

We can change this right away but I have to warn you, GLIDEIN_MaxMemMBs may not be the most reliable attribute.  We really just have it default to 2GB most of the time regardless of the site limit, unless the actual limit has become known to us.  It is more meaningful for the big memory entries in the factory.

Since the limit at UConn has become clear based on this ticket we will change it 1 GB in the factory.

Sorry for any trouble this may have caused,
Jeff Dost
OSG Glidein Factory Operations

by /DC=org/DC=doegrids/OU=People/CN=Jeffrey M. Dost 948199</pre></div><div class='update_description'><i onclick="document.location='13286#1358202052'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-01-14T22:20:52+00:00">Jan 14, 2013 10:20 PM UTC</time><a class="anchor" name="1358202052">&nbsp;</a></div><pre>Dear glidein factory admins,

GLOW relies on GLIDEIN_MaxMemMBs to know how much memory is available for jobs that run under glideins.  We have been informed by Richard Jones at UConn that worker nodes at that site have 1GB/core, but glidein is advertising the default 2GB.

What is the best solution?  Would you consider configuring the glidein factory so that it advertises GLIDEIN_MaxMemMBs of 1GB at UConn?

Thanks,
--Dan

by /DC=org/DC=doegrids/OU=People/CN=Dan Bradley 268953</pre></div><div class='update_description'><i onclick="document.location='13286#1358201285'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-01-14T22:08:05+00:00">Jan 14, 2013 10:08 PM UTC</time><a class="anchor" name="1358201285">&nbsp;</a></div><pre>Richard,

I am _very_ sorry we overlooked this ticket.  I have updated the contact information for GLOW-TECH to help avoid this in the future.

We are now looking into this memory usage problem.

--Dan

by /DC=org/DC=doegrids/OU=People/CN=Dan Bradley 268953</pre></div><div class='update_description'><i onclick="document.location='13286#1358200115'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-01-14T21:48:35+00:00">Jan 14, 2013 09:48 PM UTC</time> by <b>Christopher Pipes</b><a class="anchor" name="1358200115">&nbsp;</a></div><pre>GLOW support,

Could you please review this ticket and provide feedback on the issue with the GLOW jobs running on worker nodes at UConn-OSG?

Thanks,

Chris</pre></div><div class='update_description'><i onclick="document.location='13286#1357188367'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-01-03T04:46:07+00:00">Jan 3, 2013 04:46 AM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1357188367">&nbsp;</a></div><pre>Hello,

GLOW jobs running at our site over the past week have been thrashing badly on the worker nodes at UConn-OSG site.  I cannot see who the true submitter is, but the glideins pilot cert is DC=org, DC=doegrids, OU=Services, CN=pilot/glidein.chtc.wisc.edu and the executable is  F2F4LOCO4CHTC.  Our workers have a maximum RAM of 1GB per job slot.  Depending on the job&#39;s memory access pattern, some jobs with much larger vsize values run fine with a resident set less than 1GB.  These jobs are fighting with each other (and the rest of the system processes) for resident set, and nodes are dying.  Can you ask the user to add a physical memory clause to his job Requirements?  I don&#39;t want to block the GLOW vo, as typically GLOW jobs run fine here.

-Richard Jones

by /DC=org/DC=doegrids/OU=People/CN=Richard T. Jones 975420</pre></div><legend>Similar Recent Tickets <small>modified within the last 30 days</small></legend><div id="similar_tickets"><p class="muted">No similar tickets found.</p></div>
</div>
<script type="text/javascript">
function reset_anchor() {
    $("#updates .selected").removeClass("selected");
    var urls = document.location.toString().split('#'); 
    var anchor = urls[1];
    if(anchor) {
        $("a[name='"+anchor+"']").parents(".update_description").addClass("selected");
    }
}
function submitspam(ticket_id) {
    myret = confirm("Would you like to close this ticket as a security ticket, and submit the ticket content to akismet?");
    if(myret == true) {
        $.ajax("viewer/processspam?id="+ticket_id).done(function() {
            window.location.reload();
        });
    }
}

$(function() {
    reset_anchor();
    var ADDITIONAL_COOKIE_NAME = 'gocticket';
    var options = { path: '/', expires: 365};

    if(window.opener && window.opener.name == "gocticket_list") {
        v = $.cookie("closewindow");
        if(!v) {
            $("#closewindow").attr("checked", "checked"); //on by default
        } else {
            if(v == "checked") {
                $("#closewindow").attr("checked", "checked");
            }
        }
        $("#closewindow").click(function() {
            $.cookie("closewindow", $(this).attr('checked'), options);
        });
    } else {
        $("#closewindow_area").hide();
    }
    function updateTimeago() {
        $("time").timeago();
        setTimeout(updateTimeago, 30*1000);
    }
    updateTimeago();
    $(".description").focus(expand_description);
});
</script>
<hr/>
<footer>
<p>GOC Ticket Version 2.2 | <a href="https://ticket.opensciencegrid.org/goc/submit?app_issue_check=on&amp;app_issue_type=goc&amp;app_goc_url=https%3A%2F%2Fticket.opensciencegrid.org%3A443%2F13286">Report Bugs</a>
 | <a href="https://github.com/opensciencegrid/operations/blob/master/docs/privacy.md">Privacy Policy</a>
</p>

<p> <img align="top" src="images/tag_orange.png"/> Copyright 2018 The Trustees of Indiana University - Developed for Open Science Grid</p>
</footer>


</div><!--container-fluid-->
<script src="https://ticket1.grid.iu.edu:8443/socket.io/socket.io.js"></script>
<script>
var chat = io.connect('https://ticket1.grid.iu.edu:8443');
chat.on('connect', function() {
    chat.emit('authenticate', {nodekey:'', ticketid: 13286});
});
chat.on('peers', function(peers) {
    $("#peers").html("");
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('peer_disconnect', function(pid) {
    $("#peer_"+pid).hide("slow");
});
chat.on('peer_connected', function(peers) {
    //expect only 1 peer connecting, but..
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('submit', function() {
    if(confirm("This ticket was updated. Do you want to refresh?")) {
        history.go(0);
    }
});

function addPeer(pid, peer) {
    var ipinfo = "";
    if(peer.ip != undefined) {
        ipinfo = "<span class=\"ip\">"+peer.ip+"</span>";
    }
    if(chat.io.engine.id == pid) {
        //don't display myself
        return;
    }
    var html = "<li class=\"new\" id=\"peer_"+pid+"\" class=\"peer\">"+peer.name+ipinfo+"</li>";
    $("#peers").prepend(html);
    $("#peers .new").animate({bottom: 0}, 1000, function() {$(this).removeClass("new")});
}

$(function() {
    $("#ticket_form").submit(function() {
        chat.emit('submit');
        return true;
    });
});
</script>
<script>
//used by searchbox
function parseValue(value) {
    var obj = new Object();
    var tokens = value.split("\t");
    obj.str = tokens[0];
    obj.count = tokens[1];
    return obj;
}

$(function() {
    //bootstrap-2.0.4 stuff
    $(".alert-message").alert();
    $(".dropdown-toggle").dropdown();
    $("span[rel='tooltip']").tooltip();
    $("a[rel=popover]").popover();

    //activate menu that user is currently on
    $("#menu_navigator").addClass("active"); 
    $("#submenu_").addClass("active"); 

    //translate zend validation error message to bootstrap
    $(".errors").addClass("alert").addClass("alert-error");

    //enable autocomplete for search box
    $("#search").autocomplete({
        source: function( request, response ) {
            $.ajax({
                url: "search/autocomplete",
                dataType: "text",
                data: {
                    //featureClass: "P",
                    //style: "full",
                    //maxRows: 12,
                    //name_startsWith: request.term
                    q: request.term
                },
                success: function( data ) {
                    response( $.map( data.split("\n"), function( item ) {
                        if(item == "") return null;
                        return {
                            value: item
                        }
                    }));
                }
            });
        },
        select: function(event, ui) {
            document.location = "search?q="+ui.item.value;
        }
    });
    
});
</script>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-69012-13");
pageTracker._trackPageview();
} catch(err) {}
</script>

</body>
