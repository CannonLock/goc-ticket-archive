<!DOCTYPE html>
<html lang="en">
  <head>
  <base href="/">
    <title>[21182] OSG jobs filling up /tmp/ filesystem</title>    <meta charset="utf-8" />
    <meta name="verify-v1" content="na5IcAJsZVOfEkboRxuIiZ1zpZgnZiWra+nKcS7nA/o=" />
    <meta name="google-site-verification" content="DLrk3ft4s8b-S2TloLCL2LD_t6wcTjgSluf5pmiu2kA" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />
    <link href="https://ticket.opensciencegrid.org/rss" rel="alternate" type="application/rss+xml" title="GOC Ticket Update feed" />

    <style type="text/css">
      body {
        padding-top: 50px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
     #search {
            width: 300px;
     }

    </style>

<script src="https://code.jquery.com/jquery-3.0.0.js"></script>
<script src="https://code.jquery.com/jquery-migrate-3.0.1.js"></script>

   <link href="//netdna.bootstrapcdn.com/bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet"/>
    <script src="//netdna.bootstrapcdn.com/bootstrap/2.3.2/js/bootstrap.min.js"></script>

    <link href="//netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"/>
    <link href="//ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/themes/smoothness/jquery-ui.min.css" rel="stylesheet"/>
 <script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>


    <link href="//cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/css/select2.min.css" rel="stylesheet" />
    <script src="//cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/js/select2.min.js"></script>

    <link href="css/ticket.css" rel="stylesheet" />
    <script src="lib/jquery.cookie.js"></script>

    <link href="images/tag_orange.png" rel="icon" type="image/png"/>
    <script src='https://www.google.com/recaptcha/api.js'></script>
  </head>

  <body>
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>

            <a class="brand" style="padding: 6px 0px 0px 6px;" href="http://opensciencegrid.org"><img src="https://ticket.opensciencegrid.org/images/osglogo.40x30.png"/></a>
            <ul class="nav">
                <li class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown">GOC Ticket <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    <li><a href="https://my.opensciencegrid.org">MyOSG</a></li>
                    <li><a href="https://oim.opensciencegrid.org">OIM</a></li>
                    <li class="active"><a href="index">Ticket</a></li>
	<li class="divider"></li>
	<li><a href="http://repo.grid.iu.edu">Repo</a></li>
	<li class="divider"></li>
	<li><a href="http://blogs.grid.iu.edu">Blog</a></li>
                    <li><a href="http://display.grid.iu.edu">Display</a></li>
                    <li><a href="http://osggoc.blogspot.com/">News</a></li>
                    </ul>
                </li>
            </ul>
            <ul class="nav pull-right">
                <li><a href="https://ticket.opensciencegrid.org/sso/">Login</a></li>            </ul>

            <div class="nav-collapse">
                <ul class="nav">
			 <li id="menu_submit"><a href="https://ticket.opensciencegrid.org/submit">Submit</a></li><li id="menu_view" class="dropdown"><a href="\#" class="dropdown-toggle" data-toggle="dropdown">View <b class="caret"></b></a><ul class="dropdown-menu"><li id="submenu_listopen"><a href="https://ticket.opensciencegrid.org/list/open">Open Tickets</a></li><li id="submenu_listrecentclose"><a href="https://ticket.opensciencegrid.org/list/recentclose">Recently Closed Tickets</a></li><li class="divider"></li><li id="submenu_alltickets"><a href="https://ticket.opensciencegrid.org/search?q=&amp;sort=id">All Tickets</a></li></ul></li>                </ul>

                <form class="navbar-search pull-right" action="viewer">
                    <input id="search" type="text" name="id" class="search-query span2" placeholder="Search Ticket" value=""/>
                </form>
            </div>
        </div>
      </div>
    </div>

<script type='text/javascript' src='lib/jquery.timeago.js'></script>
<script type='text/javascript' src='lib/byte2size.js'></script>
<style>
#updates .toolbar {
position: relative;
margin-top: 0px;
top: -10px;
font-weight: normal;
}
#updates a.anchor {
position: relative;
top: -50px;
}
#updates .selected pre {
animation:selected 2s;
animation-iteration-count: 2;
animation-direction: alternate;
-webkit-animation:selected 2s; 
-webkit-animation-iteration-count: 2;
-webkit-animation-direction: alternate;
box-shadow: inset 1px 1px 20px #9ad;
border: 1px solid #9ab;
margin: 5px 0px;
padding-left: 10px;
}
@keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ab;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
@-webkit-keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ad;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
#updates pre {
background-color: inherit;
line-height: 15px;
padding: 5px;
}
#updates .header {
color: #999;
}
#updates .update_history pre {
background-color: #eee;
color: #666;
font-size: 85%;
}
#updates .clickable {
cursor: pointer;
}
#updates .clickable:hover {
color: #D98719;
}
#updates .meta_information pre {
background-color: #fed;
}
#similar_tickets {
max-height: 300px;
overflow-y: auto;
pointer-events: none;
padding: 5px;
background-color: #f4f4f4;
}
.btn-toolbar {
margin-bottom: 0;
height: 30px;
}
#peers {
position: fixed;
bottom: 0px;
right: 0px;
z-index: 100;
list-style: none;
padding: 5px 0px 0px 5px;
margin: 0px;
background-color: white;
box-shadow: 0px 0px 10px white;
}
#peers li {
background-color: #ccc;
color: #000;
display: inline-block;
padding: 5px 10px;
margin-right: 5px;
position: relative;
}
/*
#peers li:hover {
background-color: #999;
cursor: pointer;
}
*/
#peers span.ip {
padding-left: 5px;
color: #666;
}
#peers .new {
bottom: -30px;
}
/*
#peers .me {
background-color: red;
}
*/
</style>

<div class="container-fluid">
<ul id="peers"></ul>
<div class="alert alert-danger"><a class="close" href="#" data-dismiss="alert">&times;</a>By the end of May 2018, the ticketing system at https://ticket.opensciencegrid.org will be retired and support will be provided at https://support.opensciencegrid.org. Throughout this transition the support email (help@opensciencegrid.org) will be available as a point of contact.<br><br>                                                   
                                                                                                                                                                                   
Please see the service migration page for details: https://opensciencegrid.github.io/technology/policy/service-migrations-spring-2018/#ticket</div><div id="presence" class="pull-right"></div><div class="ticketgui"><script type="text/javascript" src="https://ticket.opensciencegrid.org/lib/checktab.js"></script>

<script>
var expanded = false;
function expand_description() {
    var desc = $(".description");
    if(!expanded) {
        expanded = true;
        //expand to minheight
        var min = 250;
        if(desc.height() < min) {
            desc.animate({height: min}, 200);
        }
    }
}

$(document).ready(function() {
    $("input[name='nad']").datepicker({
        dateFormat: 'yy-mm-dd'
    });
});

</script>



<style>
.form-horizontal .control-label {
padding-top: inherit;
font-size:90%;
color:#666;
}
label {
margin-bottom: 0px;
}
.controls {
line-height: 18px;
}
</style>
<form class="form-horizontal" action="https://ticket.opensciencegrid.org/viewer/updatebasic?id=21182" method="post">
<div class="page-header">
    <h3><span class="muted">21182</span> / OSG jobs filling up /tmp/ filesystem</h3>
</div>

<div class="row-fluid">
<div class="span5">
    <legend>Contact</legend>
    <div class="control-group">
        <label class="control-label">Full Name</label>
        <div class="controls">Samir Cury Siqueira</div>
    </div>
    <div class="control-group">
        <label class="control-label">Email</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">Phone</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">CC</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>

    <legend>Details</legend>
    <div class="control-group"><label class="control-label">Associated VO</label><div class="controls">OSG</div></div><div class="control-group"><label class="control-label">Submitted Via</label><div class="controls">GOC Ticket/submit</div></div><div class="control-group"><label class="control-label">Submitter</label><div class="controls">Samir Cury Siqueira</div></div><div class="control-group"><label class="control-label">Support Center</label><div class="controls">CSC</div></div>
    <div class="control-group">
        <label class="control-label">Ticket Type</label>
        <div class="controls">Problem/Request</div>
    </div>
    <div class="control-group">
        <label class="control-label">Priority</label>
        <div class="controls">Normal</div>
    </div>
    <div class="control-group">
        <label class="control-label">Status</label>
        <div class="controls">
Closed</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action</label>
        <div class="controls">ENG Action</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action Deadline</label>
        <div class="controls flag_red">2014-05-28</div>
    </div>

</div><!--span-->
<div class="span7">
    <legend>Assignees</legend>
    <div class="assignee" style="width: 60%">CSC <span class="muted"> / OSG Support Centers</span></div><div class="assignee" style="width: 60%">Suchandra Thapa <span class="muted"> / OSG Software Team</span></div>    <br>

    <legend>Assignees</legend>
    TODO
    <br>

    <style>
legend.noborder {
border-bottom: none;
}
</style>

<div id="attachment-list"/>
<script>
$(function () {
    var first = true;
    $.getJSON("https://ticket.opensciencegrid.org/attachment/list?id=21182", function (files) {
        //console.dir(files);
        var html = "<table class=\"table table-condensed\">";
        $(files).each(function() {
            if(first) {
                first = false;
                html += "<legend class=\"noborder\">Attachmenets</legend>";
            }
            html += "<tr class=\"attachment\">";
            html += "<td><img src=\""+this.thumbnail_url+"\"/></td>";
            html += "<td><a href=\""+this.url+"\" target=\"_blank\">"+this.name+"</a></td>";
            html += "<td>"+bytesToSize(this.size, 1)+"</td>";
            html += "</tr>";
        });
        html += "</table>";
        $("#attachment-list").html(html);
    });
});

function download(url) {
    window.open(url, "_blank");
}
</script>


</div><!--span-->
</div><!--row-fluid-->


</form>

</div>
<div id="updates" style="clear: both;">
    <legend>Past Updates
    <div class="btn-toolbar pull-right toolbar">
        <div class="btn-group">
                <a class="btn btn-small" href="/21182?sort=up&"><i class="icon-arrow-up"></i> Sort</a>

        
        <a class="btn btn-small" href="/21182?expandall=true&">Expand Descriptions</a>        <a class="btn btn-small" target="_blank" href="mailto:osg@tick.globalnoc.iu.edu?subject=Open%20Science%20Grid%3A%20OSG%20jobs%20filling%20up%20%2Ftmp%2F%20filesystem%20ISSUE%3D21182%20PROJ%3D71"><i class="icon-envelope"></i> Update w/Email</a>
        </div>
    </div><!--btn-toolbar-->
    </legend>

    <div class='update_description'><i onclick="document.location='21182#1401294420'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-05-28T16:27:00+00:00">May 28, 2014 04:27 PM UTC</time> by <b>Vince Neal</b><a class="anchor" name="1401294420">&nbsp;</a></div><pre>Thanks!

Closing

Vince</pre></div><div class='update_description'><i onclick="document.location='21182#1401226975'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-05-27T21:42:55+00:00">May 27, 2014 09:42 PM UTC</time><a class="anchor" name="1401226975">&nbsp;</a></div><pre>This is solved. Observed for several days and didn&#39;t see the issue happening again. Thanks!

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=samir/CN=695732/CN=Samir Cury Siqueira</pre></div><div class='update_description'><i onclick="document.location='21182#1401226971'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-05-27T21:42:51+00:00">May 27, 2014 09:42 PM UTC</time><a class="anchor" name="1401226971">&nbsp;</a></div><pre>This is solved. Observed for several days and didn&#39;t see the issue happening again. Thanks!

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=samir/CN=695732/CN=Samir Cury Siqueira</pre></div><div class='update_description'><i onclick="document.location='21182#1400774912'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-05-22T16:08:32+00:00">May 22, 2014 04:08 PM UTC</time> by <b>Vince Neal</b><a class="anchor" name="1400774912">&nbsp;</a></div><pre>Thanks to all for your work on this.  Please let me know when I may consider this resolved and close the ticket.

Thanks!
Vince</pre></div><div class='update_description'><i onclick="document.location='21182#1400737058'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-05-22T05:37:38+00:00">May 22, 2014 05:37 AM UTC</time><a class="anchor" name="1400737058">&nbsp;</a></div><pre>Oh, ok, that env is not easily accessible by me. But if the glideInWMS does that I&#39;m fine with it. I&#39;m deploying monitoring for this issue so I will be able to spot if it happens again.

Thanks,
Samir

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=samir/CN=695732/CN=Samir Cury Siqueira</pre></div><div class='update_description'><i onclick="document.location='21182#1400725995'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-05-22T02:33:15+00:00">May 22, 2014 02:33 AM UTC</time><a class="anchor" name="1400725995">&nbsp;</a></div><pre>The jobs should use $TMP. This is set by glideinWMS/HTCondor to a path that is indeed cleaned up by the end of the job. For example, from a test job&#58;

TMPDIR=/wntmp/condor/compute-6-31/execute/dir_5315/glide_wWc6Qs/execute/dir_15260
OSG_WN_TMP=/wntmp/condor/compute-6-31/execute/dir_5315
TMP=/wntmp/condor/compute-6-31/execute/dir_5315/glide_wWc6Qs/execute/dir_15260

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=Mats Rynge 45</pre></div><div class='update_description'><i onclick="document.location='21182#1400705417'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-05-21T20:50:17+00:00">May 21, 2014 08:50 PM UTC</time> by <b>Suchandra Thapa</b><a class="anchor" name="1400705417">&nbsp;</a></div><pre>I&#39;ll try that.  I think part of the problem was that the user job wasn&#39;t cleaning up after itself so I&#39;ll have the user change his job so that it deletes the directory it was using.

Suchandra</pre></div><div class='update_description'><i onclick="document.location='21182#1400705168'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-05-21T20:46:08+00:00">May 21, 2014 08:46 PM UTC</time><a class="anchor" name="1400705168">&nbsp;</a></div><pre>Apparently the only useful variable available is &#58;

-bash-4.1$ globus-job-run cit-gatekeeper2.ultralight.org /bin/env   | grep TMP
OSG_WN_TMP=/wntmp

Although I believe that the user does something as &#58;

mkdir $PWD/scratch/
cd $PWD/scratch/
wget <a href='http&#58;//mypayload.abc.edu/a.tar.gz' target='_blank' rel='nofollow'>http&#58;//mypayload.abc.edu/a.tar.gz</a>

It should use better /wntmp/condor/$HOSTNAME/execute/abc/

I&#39;m guessing with some certainty that $PWD will be the condor scratch dir. No straightforward way to test it.

Even if you use $OSG_WN_TMP it won&#39;t be cleaned up by Condor, but this is acceptable, as the partition is big and cleaned up periodically. Maybe is worth trying $PWD before that.

Thanks,
Samir

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=samir/CN=695732/CN=Samir Cury Siqueira</pre></div><div class='update_description'><i onclick="document.location='21182#1400704490'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-05-21T20:34:50+00:00">May 21, 2014 08:34 PM UTC</time> by <b>Suchandra Thapa</b><a class="anchor" name="1400704490">&nbsp;</a></div><pre>The user&#39;s jobs have been killed so you shouldn&#39;t see them anymore.  Just curious should they use $TMP or would $OSG_WN_TMP work as well?

Suchandra</pre></div><div class='update_description'><i onclick="document.location='21182#1400702938'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-05-21T20:08:58+00:00">May 21, 2014 08:08 PM UTC</time> by <b>Suchandra Thapa</b><a class="anchor" name="1400702938">&nbsp;</a></div><pre>I&#39;ll let you know when the jobs have been fixed.

Suchandra</pre></div><div class='update_description'><i onclick="document.location='21182#1400702703'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-05-21T20:05:03+00:00">May 21, 2014 08:05 PM UTC</time><a class="anchor" name="1400702703">&nbsp;</a></div><pre>Thanks a lot, Suchandra! Let me know when I should see the behavior changing. Until then I&#39;m keeping a close eye in my nodes. I will not block the VO then.

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=samir/CN=695732/CN=Samir Cury Siqueira</pre></div><div class='update_description'><i onclick="document.location='21182#1400702612'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-05-21T20:03:32+00:00">May 21, 2014 08:03 PM UTC</time> by <b>Suchandra Thapa</b><a class="anchor" name="1400702612">&nbsp;</a></div><pre>Hi Samir,
I&#39;ll talk to the user about this and have him change his workflow appropriately.  This should get resolved this afternoon.

Suchandra</pre></div><div class='update_description'><i onclick="document.location='21182#1400697747'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-05-21T18:42:27+00:00">May 21, 2014 06:42 PM UTC</time><a class="anchor" name="1400697747">&nbsp;</a></div><pre>Just chatted with Anthony. If we know which VO can be doing that I can ban it while we figure this out. Apparently this is acceptable. The problem is that when listing the directories I see that the owner is OSG &#58;

-rw-r--r--. 1 osg osg        0 May 21 10&#58;02 installed
drwxr-xr-x. 3 osg osg     4096 May 21 10&#58;02 ngram
-rw-r--r--. 1 osg osg  4198524 May  7 13&#58;44 ngram-pyenv.tar.gz
-rw-r--r--. 1 osg osg 13518430 May 19 15&#58;19 ngram.tar.gz
drwxr-xr-x. 5 osg osg     4096 May  7 13&#58;43 python

And the only users (pilots) DNs I see being mapped are legitimally OSG &#58;

[root@gums2 ~]# grep -i osg /var/log/tomcat6/gums-service-admin.log | awk &#39;{print $23}&#39; | sort | uniq -c
14
8188 &#39;/osg/Role=NULL/Capability=NULL&#39;

So I&#39;m seeing no other option than banning the OSG VO for now. No easy way to do a more fine-grain blocking. Ideas?

sbgrid, glow and other VOs submitting to Caltech won&#39;t be banned.

Thanks,
Samir

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=samir/CN=695732/CN=Samir Cury Siqueira</pre></div><div class='update_description'><i onclick="document.location='21182#1400689602'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-05-21T16:26:42+00:00">May 21, 2014 04:26 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1400689602">&nbsp;</a></div><pre>Dear GOC,

It would really be nice to address this kind of experiment&#39;s software problem too. I&#39;m not sure which is the best channel. We don&#39;t have a lot of time to deal with non-CMS problems  but this one is preventing CMS glideins to start and all sorts of problems.

I still have to track down which OSG VO (sbgrid,glow) is creating /tmp/ngramwork . But definitely the OSG user. I&#39;m getting these directories created and not cleaned up and at the end of the day / is full and we lose the node. Had to reomve it by hand so far a couple of times this week.

In principle jobs should STAY in /wntmp/condor (execution dir) and not try to do anything out of it. I need this fixed before the weekend so if there is no follow up from OSG/Experiment in 48h I will have to find a way to ban this user/VO from the site. Note that OSG is getting few thousands of slots here as CMS jobs are filling the site lately.

In the best case scenario I can spend a bit of time to do a workaround that will periodically delete the directory with no careful checks. That will be bad for me and for the running jobs that will die in the process. So the best is that this gets fixed in the user side. Or they use a job environment variable to find/use the right scratch area that is much bigger and will get cleaned up automatically by Condor.

Regards,
Samir

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=samir/CN=695732/CN=Samir Cury Siqueira</pre></div><legend>Similar Recent Tickets <small>modified within the last 30 days</small></legend><div id="similar_tickets"><p class="muted">No similar tickets found.</p></div>
</div>
<script type="text/javascript">
function reset_anchor() {
    $("#updates .selected").removeClass("selected");
    var urls = document.location.toString().split('#'); 
    var anchor = urls[1];
    if(anchor) {
        $("a[name='"+anchor+"']").parents(".update_description").addClass("selected");
    }
}
function submitspam(ticket_id) {
    myret = confirm("Would you like to close this ticket as a security ticket, and submit the ticket content to akismet?");
    if(myret == true) {
        $.ajax("viewer/processspam?id="+ticket_id).done(function() {
            window.location.reload();
        });
    }
}

$(function() {
    reset_anchor();
    var ADDITIONAL_COOKIE_NAME = 'gocticket';
    var options = { path: '/', expires: 365};

    if(window.opener && window.opener.name == "gocticket_list") {
        v = $.cookie("closewindow");
        if(!v) {
            $("#closewindow").attr("checked", "checked"); //on by default
        } else {
            if(v == "checked") {
                $("#closewindow").attr("checked", "checked");
            }
        }
        $("#closewindow").click(function() {
            $.cookie("closewindow", $(this).attr('checked'), options);
        });
    } else {
        $("#closewindow_area").hide();
    }
    function updateTimeago() {
        $("time").timeago();
        setTimeout(updateTimeago, 30*1000);
    }
    updateTimeago();
    $(".description").focus(expand_description);
});
</script>
<hr/>
<footer>
<p>GOC Ticket Version 2.2 | <a href="https://ticket.opensciencegrid.org/goc/submit?app_issue_check=on&amp;app_issue_type=goc&amp;app_goc_url=https%3A%2F%2Fticket.opensciencegrid.org%3A443%2F21182">Report Bugs</a>
 | <a href="https://github.com/opensciencegrid/operations/blob/master/docs/privacy.md">Privacy Policy</a>
</p>

<p> <img align="top" src="/images/tag_orange.png"/> Copyright 2018 The Trustees of Indiana University - Developed for Open Science Grid</p>
</footer>


</div><!--container-fluid-->
<script src="https://ticket1.grid.iu.edu:8443/socket.io/socket.io.js"></script>
<script>
var chat = io.connect('https://ticket1.grid.iu.edu:8443');
chat.on('connect', function() {
    chat.emit('authenticate', {nodekey:'', ticketid: 21182});
});
chat.on('peers', function(peers) {
    $("#peers").html("");
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('peer_disconnect', function(pid) {
    $("#peer_"+pid).hide("slow");
});
chat.on('peer_connected', function(peers) {
    //expect only 1 peer connecting, but..
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('submit', function() {
    if(confirm("This ticket was updated. Do you want to refresh?")) {
        history.go(0);
    }
});

function addPeer(pid, peer) {
    var ipinfo = "";
    if(peer.ip != undefined) {
        ipinfo = "<span class=\"ip\">"+peer.ip+"</span>";
    }
    if(chat.io.engine.id == pid) {
        //don't display myself
        return;
    }
    var html = "<li class=\"new\" id=\"peer_"+pid+"\" class=\"peer\">"+peer.name+ipinfo+"</li>";
    $("#peers").prepend(html);
    $("#peers .new").animate({bottom: 0}, 1000, function() {$(this).removeClass("new")});
}

$(function() {
    $("#ticket_form").submit(function() {
        chat.emit('submit');
        return true;
    });
});
</script>
<script>
//used by searchbox
function parseValue(value) {
    var obj = new Object();
    var tokens = value.split("\t");
    obj.str = tokens[0];
    obj.count = tokens[1];
    return obj;
}

$(function() {
    //bootstrap-2.0.4 stuff
    $(".alert-message").alert();
    $(".dropdown-toggle").dropdown();
    $("span[rel='tooltip']").tooltip();
    $("a[rel=popover]").popover();

    //activate menu that user is currently on
    $("#menu_navigator").addClass("active"); 
    $("#submenu_").addClass("active"); 

    //translate zend validation error message to bootstrap
    $(".errors").addClass("alert").addClass("alert-error");

    //enable autocomplete for search box
    $("#search").autocomplete({
        source: function( request, response ) {
            $.ajax({
                url: "search/autocomplete",
                dataType: "text",
                data: {
                    //featureClass: "P",
                    //style: "full",
                    //maxRows: 12,
                    //name_startsWith: request.term
                    q: request.term
                },
                success: function( data ) {
                    response( $.map( data.split("\n"), function( item ) {
                        if(item == "") return null;
                        return {
                            value: item
                        }
                    }));
                }
            });
        },
        select: function(event, ui) {
            document.location = "search?q="+ui.item.value;
        }
    });
    
});
</script>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-69012-13");
pageTracker._trackPageview();
} catch(err) {}
</script>

</body>
