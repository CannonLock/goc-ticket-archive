<!DOCTYPE html>
<html lang="en">
  <head>
  <base href="">
    <title>[33249] Need extra DN&#39;s in the cert for osg VO voms-admin</title>    <meta charset="utf-8" />
    <meta name="verify-v1" content="na5IcAJsZVOfEkboRxuIiZ1zpZgnZiWra+nKcS7nA/o=" />
    <meta name="google-site-verification" content="DLrk3ft4s8b-S2TloLCL2LD_t6wcTjgSluf5pmiu2kA" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />
    <link href="https://ticket.opensciencegrid.org/rss" rel="alternate" type="application/rss+xml" title="GOC Ticket Update feed" />

    <style type="text/css">
      body {
        padding-top: 50px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
     #search {
            width: 300px;
     }

    </style>

<script src="https://code.jquery.com/jquery-3.0.0.js"></script>
<script src="https://code.jquery.com/jquery-migrate-3.0.1.js"></script>

   <link href="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet"/>
    <script src="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/js/bootstrap.min.js"></script>

    <link href="https://netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"/>
    <link href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/themes/smoothness/jquery-ui.min.css" rel="stylesheet"/>
 <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>


    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/js/select2.min.js"></script>

    <link href="css/ticket.css" rel="stylesheet" />
    <script src="lib/jquery.cookie.js"></script>

    <link href="images/tag_orange.png" rel="icon" type="image/png"/>
    <script src='https://www.google.com/recaptcha/api.js'></script>
  </head>

  <body>
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>

            <a class="brand" style="padding: 6px 0px 0px 6px;" href="http://opensciencegrid.org"><img src="images/osglogo.40x30.png"/></a>
            <ul class="nav">
                <li class="dropdown"><a href="https://ticket.opensciencegrid.org/#" class="dropdown-toggle" data-toggle="dropdown">GOC Ticket <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    <li><a href="https://my.opensciencegrid.org">MyOSG</a></li>
                    <li><a href="https://oim.opensciencegrid.org">OIM</a></li>
                    <li class="active"><a href="https://ticket.opensciencegrid.org/index">Ticket</a></li>
	<li class="divider"></li>
	<li><a href="http://repo.grid.iu.edu">Repo</a></li>
	<li class="divider"></li>
	<li><a href="http://blogs.grid.iu.edu">Blog</a></li>
                    <li><a href="http://display.grid.iu.edu">Display</a></li>
                    <li><a href="http://osggoc.blogspot.com/">News</a></li>
                    </ul>
                </li>
            </ul>
            <ul class="nav pull-right">
                <li><a href="https://ticket.opensciencegrid.org/sso/">Login</a></li>            </ul>

            <div class="nav-collapse">
                <ul class="nav">
			 <li id="menu_submit"><a href="https://ticket.opensciencegrid.org/submit">Submit</a></li><li id="menu_view" class="dropdown"><a href="https://ticket.opensciencegrid.org/\#" class="dropdown-toggle" data-toggle="dropdown">View <b class="caret"></b></a><ul class="dropdown-menu"><li id="submenu_listopen"><a href="https://ticket.opensciencegrid.org/list/open">Open Tickets</a></li><li id="submenu_listrecentclose"><a href="https://ticket.opensciencegrid.org/list/recentclose">Recently Closed Tickets</a></li><li class="divider"></li><li id="submenu_alltickets"><a href="https://ticket.opensciencegrid.org/search?q=&amp;sort=id">All Tickets</a></li></ul></li>                </ul>

                <form class="navbar-search pull-right" action="https://ticket.opensciencegrid.org/viewer">
                    <input id="search" type="text" name="id" class="search-query span2" placeholder="Search Ticket" value=""/>
                </form>
            </div>
        </div>
      </div>
    </div>

<script type='text/javascript' src='lib/jquery.timeago.js'></script>
<script type='text/javascript' src='lib/byte2size.js'></script>
<style>
#updates .toolbar {
position: relative;
margin-top: 0px;
top: -10px;
font-weight: normal;
}
#updates a.anchor {
position: relative;
top: -50px;
}
#updates .selected pre {
animation:selected 2s;
animation-iteration-count: 2;
animation-direction: alternate;
-webkit-animation:selected 2s; 
-webkit-animation-iteration-count: 2;
-webkit-animation-direction: alternate;
box-shadow: inset 1px 1px 20px #9ad;
border: 1px solid #9ab;
margin: 5px 0px;
padding-left: 10px;
}
@keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ab;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
@-webkit-keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ad;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
#updates pre {
background-color: inherit;
line-height: 15px;
padding: 5px;
}
#updates .header {
color: #999;
}
#updates .update_history pre {
background-color: #eee;
color: #666;
font-size: 85%;
}
#updates .clickable {
cursor: pointer;
}
#updates .clickable:hover {
color: #D98719;
}
#updates .meta_information pre {
background-color: #fed;
}
#similar_tickets {
max-height: 300px;
overflow-y: auto;
pointer-events: none;
padding: 5px;
background-color: #f4f4f4;
}
.btn-toolbar {
margin-bottom: 0;
height: 30px;
}
#peers {
position: fixed;
bottom: 0px;
right: 0px;
z-index: 100;
list-style: none;
padding: 5px 0px 0px 5px;
margin: 0px;
background-color: white;
box-shadow: 0px 0px 10px white;
}
#peers li {
background-color: #ccc;
color: #000;
display: inline-block;
padding: 5px 10px;
margin-right: 5px;
position: relative;
}
/*
#peers li:hover {
background-color: #999;
cursor: pointer;
}
*/
#peers span.ip {
padding-left: 5px;
color: #666;
}
#peers .new {
bottom: -30px;
}
/*
#peers .me {
background-color: red;
}
*/
</style>

<div class="container-fluid">
<ul id="peers"></ul>
<div class="alert alert-danger"><a class="close" href="https://ticket.opensciencegrid.org/#" data-dismiss="alert">&times;</a>By the end of May 2018, the ticketing system at https://ticket.opensciencegrid.org will be retired and support will be provided at https://support.opensciencegrid.org. Throughout this transition the support email (help@opensciencegrid.org) will be available as a point of contact.<br><br>                                                   
                                                                                                                                                                                   
Please see the service migration page for details: https://opensciencegrid.github.io/technology/policy/service-migrations-spring-2018/#ticket</div><div id="presence" class="pull-right"></div><div class="ticketgui"><script type="text/javascript" src="lib/checktab.js"></script>

<script>
var expanded = false;
function expand_description() {
    var desc = $(".description");
    if(!expanded) {
        expanded = true;
        //expand to minheight
        var min = 250;
        if(desc.height() < min) {
            desc.animate({height: min}, 200);
        }
    }
}

$(document).ready(function() {
    $("input[name='nad']").datepicker({
        dateFormat: 'yy-mm-dd'
    });
});

</script>



<style>
.form-horizontal .control-label {
padding-top: inherit;
font-size:90%;
color:#666;
}
label {
margin-bottom: 0px;
}
.controls {
line-height: 18px;
}
</style>
<form class="form-horizontal" action="https://ticket.opensciencegrid.org/viewer/updatebasic?id=33249" method="post">
<div class="page-header">
    <h3><span class="muted">33249</span> / Need extra DN&#39;s in the cert for osg VO voms-admin</h3>
</div>

<div class="row-fluid">
<div class="span5">
    <legend>Contact</legend>
    <div class="control-group">
        <label class="control-label">Full Name</label>
        <div class="controls">Steve Timm</div>
    </div>
    <div class="control-group">
        <label class="control-label">Email</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">Phone</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">CC</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>

    <legend>Details</legend>
    <div class="control-group"><label class="control-label">Submitted Via</label><div class="controls">GOC Ticket/submit</div></div><div class="control-group"><label class="control-label">Submitter</label><div class="controls">Steve Timm</div></div><div class="control-group"><label class="control-label">Ticket Links</label><div class="controls"></div></div>
    <div class="control-group">
        <label class="control-label">Ticket Type</label>
        <div class="controls">Problem/Request</div>
    </div>
    <div class="control-group">
        <label class="control-label">Priority</label>
        <div class="controls">Normal</div>
    </div>
    <div class="control-group">
        <label class="control-label">Status</label>
        <div class="controls">
Closed</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action</label>
        <div class="controls">ENG Action</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action Deadline</label>
        <div class="controls flag_red">2017-04-05</div>
    </div>

</div><!--span-->
<div class="span7">
    <legend>Assignees</legend>
        <br>

    <legend>Assignees</legend>
    TODO
    <br>

    <style>
legend.noborder {
border-bottom: none;
}
</style>

<div id="attachment-list"/>
<script>
$(function () {
    var first = true;
    $.getJSON("attachment/list/33249", function (files) {
        //console.dir(files);
        var html = "<table class=\"table table-condensed\">";
        $(files).each(function() {
            if(first) {
                first = false;
                html += "<legend class=\"noborder\">Attachmenets</legend>";
            }
            html += "<tr class=\"attachment\">";
            html += "<td><img src=\""+this.thumbnail_url+"\"/></td>";
            html += "<td><a href=\""+this.url+"\" target=\"_blank\">"+this.name+"</a></td>";
            html += "<td>"+bytesToSize(this.size, 1)+"</td>";
            html += "</tr>";
        });
        html += "</table>";
        $("#attachment-list").html(html);
    });
});

function download(url) {
    window.open(url, "_blank");
}
</script>


</div><!--span-->
</div><!--row-fluid-->


</form>

</div>
<div id="updates" style="clear: both;">
    <legend>Past Updates
    <div class="btn-toolbar pull-right toolbar">
        <div class="btn-group">
                <a class="btn btn-small" href="https://ticket.opensciencegrid.org/33249?sort=up&amp;"><i class="icon-arrow-up"></i> Sort</a>

        
        <a class="btn btn-small" href="https://ticket.opensciencegrid.org/33249?expandall=true&amp;">Expand Descriptions</a>        <a class="btn btn-small" target="_blank" href="mailto:osg@tick.globalnoc.iu.edu?subject=Open%20Science%20Grid%3A%20Need%20extra%20DN%26%2339%3Bs%20in%20the%20cert%20for%20osg%20VO%20voms-admin%20ISSUE%3D33249%20PROJ%3D71"><i class="icon-envelope"></i> Update w/Email</a>
        </div>
    </div><!--btn-toolbar-->
    </legend>

    <div class='update_description'><i onclick="document.location='33249#1491412033'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-04-05T17:07:13+00:00">Apr 5, 2017 05:07 PM UTC</time> by <b>echism</b><a class="anchor" name="1491412033">&nbsp;</a></div><pre>Closing as advised.</pre></div><div class='update_description'><i onclick="document.location='33249#1491251891'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-04-03T20:38:11+00:00">Apr 3, 2017 08:38 PM UTC</time> by <b>Steven Timm</b><a class="anchor" name="1491251891">&nbsp;</a></div><pre>yes, ok to close.  thank you.</pre></div><div class='update_description'><i onclick="document.location='33249#1491251731'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-04-03T20:35:31+00:00">Apr 3, 2017 08:35 PM UTC</time> by <b>echism</b><a class="anchor" name="1491251731">&nbsp;</a></div><pre>Should we close this?

Thanks</pre></div><div class='update_description'><i onclick="document.location='33249#1490996767'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-03-31T21:46:07+00:00">Mar 31, 2017 09:46 PM UTC</time> by <b>Brian Lin</b><a class="anchor" name="1490996767">&nbsp;</a></div><pre>Just a quick update&#58; we found a workaround that involved changing the hostcert CN to voms1.opensciencegrid.org (and SANs to voms.grid.iu.edu and voms2.opensciencegrid.org) and updated the uri in /etc/voms/osg/voms.conf to match the CN. This should work because voms1.opensciencegrid.org was in the previous vo-client&#39;s /etc/vomses and .lsc files.</pre></div><div class='update_description'><i onclick="document.location='33249#1490996695'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-03-31T21:44:55+00:00">Mar 31, 2017 09:44 PM UTC</time><a class="anchor" name="1490996695">&nbsp;</a></div><pre>Steve,

seems like OSG-SW guys with GOC managed to get fix by adding alternate DN... Hence, OSG VO sites don&#39;t have to do anything at this moment nor Factory machine doesn&#39;t need vo-client package upgrade. We will eventually do so along upgrading gWMS packages planned for the next week. Factory wasn&#39;t affected anyway since we do not generate any voms proxies there, just delegate from Frontend.

I skimmed through some OSG glideins and things look pretty normal.

Thanks,
Marian

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=zvada/CN=684832/CN=Marian Zvada</pre></div><div class='update_description'><i onclick="document.location='33249#1490984231'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-03-31T18:17:11+00:00">Mar 31, 2017 06:17 PM UTC</time> by <b>Steven Timm</b><a class="anchor" name="1490984231">&nbsp;</a></div><pre>I did see some jobs holding but I then went ahead and upgraded our ce&#39;s that needed the package immediately after that, and since that time OSG jobs@ FNAL have been fine.

Best thing to do at this phase I think is to have factory ops look and see if OSG vo glideins are holding elsewhere and if so, tell them to upgrade their VO package, which can be done with a simple yum update.

Do we have any word from factory ops on the state of the OSG VO glideins?

Steve</pre></div><div class='update_description'><i onclick="document.location='33249#1490982719'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-03-31T17:51:59+00:00">Mar 31, 2017 05:51 PM UTC</time> by <b>Brian Lin</b><a class="anchor" name="1490982719">&nbsp;</a></div><pre>Steve, I&#39;m a little confused. Earlier below you said you saw some held OSG jobs because of this transition, presumably because their VO attributes were issued by the new grid.iu.edu server and your CE didn&#39;t have the newest VO client that would allow it to verify those attributes. I&#39;m mainly worried that we didn&#39;t provide enough lead time between the vo-client release and implementing the DNS alias to allow for wide enough adoption of the new package, leading to widespread OSG pilot auth issues.

Scott, what do you think about reverting the DNS alias at IU that forwards voms.opensciencegrid.org to voms.grid.iu.edu?</pre></div><div class='update_description'><i onclick="document.location='33249#1490982201'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-03-31T17:43:21+00:00">Mar 31, 2017 05:43 PM UTC</time><a class="anchor" name="1490982201">&nbsp;</a></div><pre>The old Fermilab voms server is still up but it would take quite a bit of network magic on goc&#39;s end and on ours to revert because we would have to delete the aliases and
change them back to the real ip&#39;s they used to be.  The IP that used to be voms.opensciencegrid.org on our end has been deleted and it takes manual hackery on the part of our guys to make that happen.

In any case if you want to revert you would have to convince Scott Teige and not me because it&#39;s GOC&#39;s service now and he has that call.

OSG Vo jobs and credentials are getting into Fermilab ce&#39;s just fine, although not running because we are full .. are you having problems elsewhere?

Steve Timm

by /DC=org/DC=cilogon/C=US/O=Fermi National Accelerator Laboratory/OU=People/CN=Steven Timm/CN=UID&#58;timm</pre></div><div class='update_description'><i onclick="document.location='33249#1490980768'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-03-31T17:19:28+00:00">Mar 31, 2017 05:19 PM UTC</time> by <b>Brian Lin</b><a class="anchor" name="1490980768">&nbsp;</a></div><pre>Steve, is the Fermilab VOMS server still up? If so, can we revert the DNS alias so OSG jobs can still authenticate over the weekend?</pre></div><div class='update_description'><i onclick="document.location='33249#1490928789'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-03-31T02:53:09+00:00">Mar 31, 2017 02:53 AM UTC</time> by <b>Steven Timm</b><a class="anchor" name="1490928789">&nbsp;</a></div><pre>You need vo-client-72.  Right now you have vo-client-69

yum update vo-client

should get it.

Steve Timm</pre></div><div class='update_description'><i onclick="document.location='33249#1490928610'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-03-31T02:50:10+00:00">Mar 31, 2017 02:50 AM UTC</time> by <b>Steven Timm</b><a class="anchor" name="1490928610">&nbsp;</a></div><pre>All that should be necessary is to just send out a reply to the announcement of the new VO package that went out on Tuesday.  I only noticed it myself because I saw our own CE&#39;s holding jobs of the OSG VO.  I had thought of many consequences to the change, but not that consequence.

Steve Timm</pre></div><div class='update_description'><i onclick="document.location='33249#1490916329'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-03-30T23:25:29+00:00">Mar 30, 2017 11:25 PM UTC</time><a class="anchor" name="1490916329">&nbsp;</a></div><pre>Steve et al.,

So this sounds like someone should make an OSG-wide announcement if HTCondor-CEs will stop accepting new OSG glideins until they upgrade, no? Maybe someone already has?

Marty Kandes
UCSD Glidein Factory Operations

by /DC=org/DC=opensciencegrid/O=Open Science Grid/OU=People/CN=Marty Kandes 3049</pre></div><div class='update_description'><i onclick="document.location='33249#1490912478'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-03-30T22:21:18+00:00">Mar 30, 2017 10:21 PM UTC</time><a class="anchor" name="1490912478">&nbsp;</a></div><pre>Steve,

I couldn&#39;t parse in this thread what VO package you&#39;re referring to to upgrade? If I grep through &#34;vo&#34; on the Factory host I see only this installed&#58;

[1509] gfactory@gfactory-1 ~$ rpm -qa | grep vo
myproxy-voms-6.1.18-1.3.osg33.el6.x86_64
vo-client-69-1.osg33.el6.noarch
libvorbis-1.2.3-4.el6_2.1.x86_64
voms-2.0.12-3.3.osg33.el6.x86_64
voms-clients-cpp-2.0.12-3.3.osg33.el6.x86_64
voms-api-java-2.0.8-1.9.osg33.el6.noarch

Any advice is very welcome.

Thanks,
Marian
(gWMS Factory Ops)

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=zvada/CN=684832/CN=Marian Zvada</pre></div><div class='update_description'><i onclick="document.location='33249#1490907093'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-03-30T20:51:33+00:00">Mar 30, 2017 08:51 PM UTC</time> by <b>echism</b><a class="anchor" name="1490907093">&nbsp;</a></div><pre>Thank you for that insight, Steve! I didn&#39;t think of that.

Factory Ops and Mats, please be advised of the changes in this ticket.</pre></div><div class='update_description'><i onclick="document.location='33249#1490906470'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-03-30T20:41:10+00:00">Mar 30, 2017 08:41 PM UTC</time> by <b>Steven Timm</b><a class="anchor" name="1490906470">&nbsp;</a></div><pre>I would also give a heads-up to factory ops, and whoever runs the frontends through which the OSG vo runs, to make sure that they have the right version of the VO-package, otherwise things will break there.

Likewise for any sites running htcondor-ce&#39;s they will not recognize voms proxies issued by the

new OSG voms server until they have upgraded to the latest VO package.

Steve Timm</pre></div><div class='update_description'><i onclick="document.location='33249#1490906096'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-03-30T20:34:56+00:00">Mar 30, 2017 08:34 PM UTC</time> by <b>echism</b><a class="anchor" name="1490906096">&nbsp;</a></div><pre>Thanks Tom!</pre></div><div class='update_description'><i onclick="document.location='33249#1490814830'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-03-29T19:13:50+00:00">Mar 29, 2017 07:13 PM UTC</time><a class="anchor" name="1490814830">&nbsp;</a></div><pre>Yes I see the alternate DN&#39;s now, and I can also verify that our gums server gums1.fnal.gov can access the voms-admin server correctly at IU and do the user update.

I believe all is now good to go.

As discussed in our plan I will keep the one at Fermilab on standby for 1 week.

Steve Timm

by /DC=org/DC=cilogon/C=US/O=Fermi National Accelerator Laboratory/OU=People/CN=Steven Timm/CN=UID&#58;timm</pre></div><div class='update_description'><i onclick="document.location='33249#1490814828'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-03-29T19:13:48+00:00">Mar 29, 2017 07:13 PM UTC</time><a class="anchor" name="1490814828">&nbsp;</a></div><pre>Yes I see the alternate DN&#39;s now, and I can also verify that our gums server gums1.fnal.gov can access the voms-admin server correctly at IU and do the user update.

I believe all is now good to go.

As discussed in our plan I will keep the one at Fermilab on standby for 1 week.

Steve Timm

by /DC=org/DC=cilogon/C=US/O=Fermi National Accelerator Laboratory/OU=People/CN=Steven Timm/CN=UID&#58;timm</pre></div><div class='update_description'><i onclick="document.location='33249#1490813200'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-03-29T18:46:40+00:00">Mar 29, 2017 06:46 PM UTC</time> by <b>Thomas Lee</b><a class="anchor" name="1490813200">&nbsp;</a></div><pre>I have now obtained and installed a certificate that has SAN entries without the service prefix and restarted tomcat6. I am seeing the SAN entries when I connect to port 8443 with my browser. Please try it now.</pre></div><div class='update_description'><i onclick="document.location='33249#1490812748'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-03-29T18:39:08+00:00">Mar 29, 2017 06:39 PM UTC</time> by <b>Thomas Lee</b><a class="anchor" name="1490812748">&nbsp;</a></div><pre>I see your statement that the SAN entries should not have the service prefix. I will obtain a different certificate for which this is not the case.</pre></div><div class='update_description'><i onclick="document.location='33249#1490812613'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-03-29T18:36:53+00:00">Mar 29, 2017 06:36 PM UTC</time> by <b>Thomas Lee</b><a class="anchor" name="1490812613">&nbsp;</a></div><pre>I have just discovered that tomcat6 was misconfigured to use a certificate in a nonstandard location. I corrected this and restarted tomcat6.</pre></div><div class='update_description'><i onclick="document.location='33249#1490812151'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-03-29T18:29:11+00:00">Mar 29, 2017 06:29 PM UTC</time><a class="anchor" name="1490812151">&nbsp;</a></div><pre>Hi Thom
The alternate DN&#39;s should NOT have the service prefix.

This is what I see when I do &#34;openssl x509  -in &#60;certfile&#62; -noout -text
on the cert I downloaded off of <a href='https&#58;//voms.grid.iu.edu&#58;8443/voms/osg' target='_blank' rel='nofollow'>https&#58;//voms.grid.iu.edu&#58;8443/voms/osg</a>

timm@snowball ~]$ openssl x509 -in ./newosg3.pem -noout -subject
subject= /DC=org/DC=opensciencegrid/O=Open Science Grid/OU=Services/CN=http/voms.grid.iu.edu
[timm@snowball ~]$ openssl x509 -in ./newosg3.pem -noout -text
Certificate&#58;
Data&#58;
Version&#58; 3 (0x2)
Serial Number&#58; 4294973491 (0x100001833)
Signature Algorithm&#58; sha256WithRSAEncryption
Issuer&#58; DC=org, DC=cilogon, C=US, O=CILogon, CN=CILogon OSG CA 1
Validity
Not Before&#58; Mar 28 15&#58;04&#58;27 2016 GMT
Not After &#58; Apr 27 15&#58;09&#58;27 2017 GMT
Subject&#58; DC=org, DC=opensciencegrid, O=Open Science Grid, OU=Services, CN=http/voms.grid.iu.edu
Subject Public Key Info&#58;
Public Key Algorithm&#58; rsaEncryption
Public-Key&#58; (2048 bit)
Modulus&#58;
00&#58;cd&#58;39&#58;fe&#58;00&#58;f7&#58;94&#58;26&#58;b2&#58;78&#58;47&#58;ba&#58;92&#58;0e&#58;52&#58;
02&#58;a0&#58;59&#58;41&#58;41&#58;c6&#58;a2&#58;2e&#58;67&#58;e6&#58;e9&#58;ff&#58;26&#58;04&#58;c6&#58;
62&#58;b3&#58;e9&#58;0d&#58;50&#58;53&#58;49&#58;1e&#58;a0&#58;66&#58;dd&#58;3b&#58;a3&#58;2e&#58;ad&#58;
3d&#58;91&#58;7e&#58;19&#58;30&#58;64&#58;4e&#58;85&#58;67&#58;98&#58;5a&#58;86&#58;87&#58;3f&#58;3a&#58;
27&#58;1c&#58;aa&#58;60&#58;d4&#58;61&#58;4a&#58;53&#58;d7&#58;97&#58;99&#58;76&#58;ad&#58;57&#58;87&#58;
51&#58;d1&#58;c9&#58;62&#58;52&#58;82&#58;e8&#58;95&#58;e0&#58;75&#58;c8&#58;7b&#58;3a&#58;0c&#58;77&#58;
aa&#58;b5&#58;b9&#58;87&#58;ba&#58;b8&#58;13&#58;b6&#58;31&#58;f7&#58;5f&#58;c1&#58;7b&#58;4d&#58;32&#58;
68&#58;ab&#58;cd&#58;0d&#58;ff&#58;b1&#58;18&#58;00&#58;3a&#58;dc&#58;98&#58;1e&#58;2a&#58;9c&#58;ff&#58;
74&#58;e8&#58;0f&#58;43&#58;64&#58;27&#58;34&#58;37&#58;d5&#58;b8&#58;52&#58;07&#58;d9&#58;5b&#58;0c&#58;
2c&#58;8f&#58;ed&#58;a4&#58;cf&#58;a2&#58;46&#58;a5&#58;ca&#58;41&#58;ce&#58;13&#58;17&#58;94&#58;cb&#58;
92&#58;20&#58;46&#58;dc&#58;eb&#58;3e&#58;be&#58;46&#58;04&#58;72&#58;47&#58;8e&#58;e3&#58;4e&#58;c5&#58;
99&#58;b5&#58;27&#58;98&#58;df&#58;0b&#58;96&#58;5d&#58;28&#58;a2&#58;02&#58;ef&#58;bd&#58;14&#58;45&#58;
<div id='show_1021339342' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_1021339342'>ea&#58;a0&#58;55&#58;63&#58;79&#58;1e&#58;76&#58;13&#58;e2&#58;8f&#58;2c&#58;60&#58;fa&#58;ea&#58;25&#58;
cd&#58;93&#58;f8&#58;14&#58;30&#58;08&#58;8e&#58;02&#58;ca&#58;fc&#58;88&#58;86&#58;ae&#58;55&#58;a7&#58;
c0&#58;54&#58;64&#58;41&#58;ed&#58;a4&#58;b3&#58;c2&#58;6d&#58;8e&#58;be&#58;27&#58;2b&#58;34&#58;b3&#58;
11&#58;60&#58;34&#58;0c&#58;31&#58;41&#58;4c&#58;dc&#58;4b&#58;d9&#58;01&#58;22&#58;81&#58;dc&#58;6d&#58;
69&#58;6d&#58;d1&#58;31&#58;c1&#58;24&#58;8d&#58;f5&#58;c0&#58;18&#58;07&#58;10&#58;73&#58;7f&#58;c8&#58;
49&#58;29
Exponent&#58; 65537 (0x10001)
X509v3 extensions&#58;
X509v3 Basic Constraints&#58; critical
CA&#58;FALSE
X509v3 Key Usage&#58; critical
Digital Signature, Key Encipherment, Data Encipherment
X509v3 Certificate Policies&#58;
Policy&#58; 1.3.6.1.4.1.34998.1.6.1
Policy&#58; 1.2.840.113612.5.2.2.1

X509v3 CRL Distribution Points&#58;

Full Name&#58;
URI&#58;<a href='http&#58;//crl.cilogon.org/cilogon-osg.crl' target='_blank' rel='nofollow'>http&#58;//crl.cilogon.org/cilogon-osg.crl</a>

X509v3 Extended Key Usage&#58;
TLS Web Client Authentication, TLS Web Server Authentication
X509v3 Subject Alternative Name&#58;
DNS&#58;voms.grid.iu.edu, email&#58;thomlee@....
Signature Algorithm&#58; sha256WithRSAEncryption
77&#58;03&#58;20&#58;3f&#58;d8&#58;75&#58;89&#58;4d&#58;fb&#58;f2&#58;00&#58;43&#58;3f&#58;d8&#58;e0&#58;e5&#58;6b&#58;ca&#58;
8a&#58;48&#58;39&#58;5f&#58;4d&#58;29&#58;76&#58;43&#58;14&#58;cd&#58;36&#58;04&#58;b7&#58;0c&#58;ce&#58;1f&#58;46&#58;74&#58;
83&#58;e7&#58;5a&#58;d8&#58;e3&#58;e7&#58;6e&#58;40&#58;2d&#58;23&#58;11&#58;11&#58;43&#58;e6&#58;57&#58;a7&#58;af&#58;21&#58;
db&#58;0c&#58;81&#58;ac&#58;68&#58;af&#58;45&#58;e9&#58;f6&#58;b2&#58;b0&#58;21&#58;71&#58;b2&#58;6a&#58;42&#58;0c&#58;7e&#58;
ca&#58;78&#58;5c&#58;66&#58;50&#58;c7&#58;be&#58;10&#58;f0&#58;2a&#58;cf&#58;70&#58;17&#58;f0&#58;f7&#58;05&#58;7f&#58;11&#58;
d3&#58;ca&#58;e5&#58;ee&#58;05&#58;7b&#58;70&#58;67&#58;c1&#58;61&#58;dc&#58;9b&#58;f9&#58;04&#58;e8&#58;57&#58;47&#58;07&#58;
ef&#58;85&#58;e4&#58;82&#58;36&#58;c1&#58;cb&#58;b1&#58;5c&#58;64&#58;ba&#58;42&#58;6f&#58;f0&#58;8f&#58;dc&#58;6e&#58;b5&#58;
93&#58;2d&#58;f1&#58;c7&#58;22&#58;9c&#58;fd&#58;99&#58;bc&#58;62&#58;83&#58;d4&#58;e1&#58;67&#58;8f&#58;f1&#58;84&#58;6e&#58;
0b&#58;0a&#58;38&#58;e5&#58;e5&#58;11&#58;2a&#58;8b&#58;17&#58;e9&#58;d8&#58;15&#58;7b&#58;f5&#58;e3&#58;90&#58;52&#58;b3&#58;
5e&#58;84&#58;cc&#58;dd&#58;6a&#58;41&#58;9e&#58;4c&#58;ae&#58;49&#58;a2&#58;4a&#58;3d&#58;27&#58;01&#58;24&#58;29&#58;40&#58;
3b&#58;29&#58;ca&#58;89&#58;28&#58;07&#58;7e&#58;2a&#58;1e&#58;f7&#58;62&#58;f1&#58;df&#58;16&#58;01&#58;de&#58;00&#58;11&#58;
b7&#58;47&#58;80&#58;4d&#58;89&#58;0d&#58;83&#58;27&#58;e8&#58;53&#58;d0&#58;bc&#58;29&#58;01&#58;86&#58;a6&#58;b3&#58;1b&#58;
fb&#58;e1&#58;75&#58;f6&#58;8f&#58;08&#58;d2&#58;54&#58;2d&#58;c6&#58;7c&#58;31&#58;d8&#58;17&#58;5d&#58;33&#58;6d&#58;2d&#58;
53&#58;63&#58;35&#58;1a&#58;df&#58;c6&#58;6a&#58;aa&#58;b0&#58;77&#58;b5&#58;38&#58;c9&#58;f3&#58;f9&#58;a7&#58;84&#58;df&#58;
0b&#58;a6&#58;fb&#58;95

-----------
there&#39;s only one alternate DNS which is voms.grid.iu.edu
and the begin date is yesterday, not today, that&#39;s what makes me think it is old.

By comparison this is what I see when I do the cert off of our machine

[root@voms1 ~]# openssl x509 -in /etc/grid-security/http/httpcert.pem -noout -text
Certificate&#58;
Data&#58;
Version&#58; 3 (0x2)
Serial Number&#58; 4294979136 (0x100002e40)
Signature Algorithm&#58; sha256WithRSAEncryption
Issuer&#58; DC=org, DC=cilogon, C=US, O=CILogon, CN=CILogon OSG CA 1
Validity
Not Before&#58; Jun  9 15&#58;40&#58;40 2016 GMT
Not After &#58; Jul  9 15&#58;45&#58;40 2017 GMT
Subject&#58; DC=org, DC=opensciencegrid, O=Open Science Grid, OU=Services, CN=voms1.fnal.gov
Subject Public Key Info&#58;
Public Key Algorithm&#58; rsaEncryption
Public-Key&#58; (2048 bit)
Modulus&#58;
00&#58;f9&#58;6a&#58;98&#58;36&#58;f5&#58;e2&#58;b3&#58;ab&#58;89&#58;8c&#58;4d&#58;70&#58;90&#58;da&#58;
97&#58;95&#58;ee&#58;c8&#58;66&#58;9f&#58;77&#58;22&#58;f3&#58;b8&#58;14&#58;47&#58;1c&#58;ee&#58;78&#58;
26&#58;d7&#58;35&#58;2d&#58;ac&#58;fb&#58;7b&#58;63&#58;af&#58;aa&#58;1c&#58;87&#58;64&#58;f9&#58;04&#58;
d7&#58;2e&#58;b9&#58;6c&#58;51&#58;70&#58;c0&#58;07&#58;98&#58;b0&#58;15&#58;27&#58;b9&#58;b0&#58;c6&#58;
43&#58;96&#58;81&#58;63&#58;80&#58;7b&#58;91&#58;f1&#58;7b&#58;b8&#58;aa&#58;09&#58;1b&#58;ce&#58;d6&#58;
25&#58;e9&#58;26&#58;69&#58;aa&#58;ee&#58;5b&#58;0c&#58;37&#58;b3&#58;b3&#58;08&#58;e8&#58;6c&#58;14&#58;
8f&#58;a5&#58;5e&#58;c9&#58;c3&#58;7e&#58;d0&#58;f0&#58;af&#58;21&#58;ea&#58;6e&#58;ac&#58;1a&#58;0f&#58;
66&#58;43&#58;d5&#58;a8&#58;7c&#58;d9&#58;49&#58;c9&#58;80&#58;b5&#58;46&#58;b7&#58;d9&#58;d3&#58;e2&#58;
4c&#58;ca&#58;af&#58;f6&#58;27&#58;e2&#58;c4&#58;87&#58;a5&#58;ff&#58;5c&#58;42&#58;a1&#58;81&#58;4f&#58;
cd&#58;90&#58;38&#58;f5&#58;87&#58;ea&#58;6c&#58;59&#58;ba&#58;ec&#58;84&#58;7d&#58;fa&#58;e3&#58;23&#58;
98&#58;4b&#58;10&#58;e6&#58;18&#58;e5&#58;5e&#58;cd&#58;03&#58;b4&#58;21&#58;3d&#58;09&#58;3d&#58;72&#58;
2f&#58;f4&#58;99&#58;f8&#58;b9&#58;03&#58;f8&#58;56&#58;70&#58;9b&#58;02&#58;ad&#58;a5&#58;39&#58;be&#58;
18&#58;07&#58;1b&#58;63&#58;01&#58;75&#58;c3&#58;b5&#58;3b&#58;16&#58;3f&#58;bc&#58;1a&#58;ea&#58;04&#58;
61&#58;fd&#58;aa&#58;e3&#58;9f&#58;c4&#58;30&#58;e2&#58;86&#58;2f&#58;86&#58;67&#58;c2&#58;b9&#58;23&#58;
2d&#58;8e&#58;b8&#58;94&#58;36&#58;5c&#58;ac&#58;46&#58;91&#58;b1&#58;32&#58;a5&#58;ab&#58;d5&#58;b4&#58;
05&#58;be&#58;a0&#58;29&#58;93&#58;5c&#58;e7&#58;c0&#58;93&#58;d4&#58;5d&#58;20&#58;9d&#58;b8&#58;0d&#58;
28&#58;0b&#58;9b&#58;19&#58;36&#58;64&#58;1c&#58;af&#58;23&#58;7e&#58;82&#58;62&#58;0e&#58;89&#58;e7&#58;
80&#58;73
Exponent&#58; 65537 (0x10001)
X509v3 extensions&#58;
X509v3 Basic Constraints&#58; critical
CA&#58;FALSE
X509v3 Key Usage&#58; critical
Digital Signature, Key Encipherment, Data Encipherment
X509v3 Certificate Policies&#58;
Policy&#58; 1.3.6.1.4.1.34998.1.6.2
Policy&#58; 1.2.840.113612.5.2.2.1

X509v3 CRL Distribution Points&#58;

Full Name&#58;
URI&#58;<a href='http&#58;//crl.cilogon.org/cilogon-osg.crl' target='_blank' rel='nofollow'>http&#58;//crl.cilogon.org/cilogon-osg.crl</a>

X509v3 Extended Key Usage&#58;
TLS Web Client Authentication, TLS Web Server Authentication
X509v3 Subject Alternative Name&#58;
DNS&#58;voms1.fnal.gov, DNS&#58;voms.fnal.gov, DNS&#58;voms1.opensciencegrid.org, DNS&#58;voms.opensciencegrid.org, email&#58;merina@....
Signature Algorithm&#58; sha256WithRSAEncryption
8b&#58;24&#58;13&#58;50&#58;35&#58;a0&#58;71&#58;db&#58;d9&#58;54&#58;52&#58;48&#58;c1&#58;26&#58;a2&#58;33&#58;33&#58;c8&#58;
13&#58;fc&#58;5f&#58;ca&#58;ad&#58;82&#58;67&#58;b5&#58;5c&#58;99&#58;54&#58;39&#58;e4&#58;68&#58;ce&#58;4d&#58;e8&#58;fd&#58;
5b&#58;b7&#58;bd&#58;98&#58;47&#58;a2&#58;6d&#58;17&#58;91&#58;e1&#58;3f&#58;4a&#58;db&#58;c4&#58;db&#58;88&#58;72&#58;fa&#58;
69&#58;53&#58;fb&#58;fb&#58;81&#58;c7&#58;03&#58;02&#58;52&#58;53&#58;27&#58;02&#58;5e&#58;08&#58;ba&#58;f7&#58;9b&#58;ae&#58;
c9&#58;53&#58;88&#58;5b&#58;8f&#58;bf&#58;27&#58;93&#58;d8&#58;f1&#58;73&#58;45&#58;8a&#58;bd&#58;29&#58;69&#58;44&#58;6d&#58;
da&#58;fa&#58;dd&#58;3a&#58;d4&#58;31&#58;68&#58;c1&#58;be&#58;0f&#58;d6&#58;cf&#58;42&#58;b8&#58;53&#58;d2&#58;a3&#58;59&#58;
d1&#58;97&#58;63&#58;2c&#58;05&#58;23&#58;24&#58;92&#58;c7&#58;c4&#58;51&#58;f1&#58;22&#58;42&#58;e7&#58;86&#58;e4&#58;80&#58;
c0&#58;1c&#58;e5&#58;82&#58;58&#58;38&#58;03&#58;01&#58;a3&#58;6d&#58;ec&#58;3e&#58;bd&#58;2c&#58;13&#58;77&#58;7f&#58;7d&#58;
51&#58;53&#58;23&#58;07&#58;48&#58;25&#58;27&#58;09&#58;2d&#58;61&#58;09&#58;35&#58;16&#58;a5&#58;37&#58;c4&#58;e2&#58;55&#58;
9a&#58;7e&#58;c7&#58;4b&#58;d5&#58;96&#58;06&#58;ff&#58;71&#58;e1&#58;4f&#58;09&#58;a1&#58;f9&#58;75&#58;fe&#58;24&#58;99&#58;
f8&#58;ff&#58;fb&#58;ba&#58;4b&#58;23&#58;99&#58;c2&#58;2c&#58;74&#58;da&#58;44&#58;99&#58;e7&#58;97&#58;f4&#58;3d&#58;34&#58;
f4&#58;8d&#58;e5&#58;9d&#58;3c&#58;59&#58;d5&#58;ce&#58;d4&#58;da&#58;8f&#58;dc&#58;5a&#58;26&#58;97&#58;99&#58;0d&#58;f2&#58;
c7&#58;67&#58;0d&#58;0a&#58;a0&#58;51&#58;63&#58;33&#58;78&#58;65&#58;fb&#58;1b&#58;d9&#58;b2&#58;2c&#58;29&#58;9b&#58;ed&#58;
58&#58;68&#58;14&#58;be&#58;58&#58;ab&#58;e8&#58;ee&#58;6f&#58;d1&#58;7e&#58;66&#58;a3&#58;be&#58;a2&#58;a8&#58;38&#58;2e&#58;
94&#58;70&#58;03&#58;ef
------------

note the three alt DNS names.

Typically voms-admin and anything tomcat will use /etc/grid-security/http/httpcert.pem.
You can tell for sure by looking at /etc/tomcat6/server.xml to see

Steve Timm

by /DC=org/DC=cilogon/C=US/O=Fermi National Accelerator Laboratory/OU=People/CN=Steven Timm/CN=UID&#58;timm
</div><script type='text/javascript'>
        $('#show_1021339342').click(function() {
            $('#detail_1021339342').slideDown("normal");
            $('#show_1021339342').hide();
            $('#hide_1021339342').show();
        });
        $('#hide_1021339342').click(function() {
            $('#detail_1021339342').slideUp();
            $('#hide_1021339342').hide();
            $('#show_1021339342').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='33249#1490811602'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-03-29T18:20:02+00:00">Mar 29, 2017 06:20 PM UTC</time> by <b>Thomas Lee</b><a class="anchor" name="1490811602">&nbsp;</a></div><pre>I did in fact restart tomcat6. I am not sure why you wouldn&#39;t be seeing the new cert. Perhaps I didn&#39;t format the SAN entries correctly? Never having used a SAN entry with a service cert before, I don&#39;t know whether they should have the service prefix. In fact, I&#39;m not even sure that the service cert is necessary, since I&#39;m not familiar with the VOMS software. Could it just be configured to use the host certificate?</pre></div><div class='update_description'><i onclick="document.location='33249#1490811450'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-03-29T18:17:30+00:00">Mar 29, 2017 06:17 PM UTC</time><a class="anchor" name="1490811450">&nbsp;</a></div><pre>Tom, did you restart tomcat6 on the voms server? Otherwise the new cert doesn&#39;t take effect. I am still  seeing one with no alternate dns.

Steve Timm

by /DC=org/DC=cilogon/C=US/O=Fermi National Accelerator Laboratory/OU=People/CN=Steven Timm/CN=UID&#58;timm</pre></div><div class='update_description'><i onclick="document.location='33249#1490810966'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-03-29T18:09:26+00:00">Mar 29, 2017 06:09 PM UTC</time> by <b>Thomas Lee</b><a class="anchor" name="1490810966">&nbsp;</a></div><pre>Please try it now. There is a new certificate in place with http/voms.grid.iu.edu in its DN and http/voms.opensciencegrid.org, http/voms1.opensciencegrid.org, and http/voms2.opensciencegrid.org as alternate subjects.</pre></div><div class='update_description'><i onclick="document.location='33249#1490809767'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-03-29T17:49:27+00:00">Mar 29, 2017 05:49 PM UTC</time> by <b>Thomas Lee</b><a class="anchor" name="1490809767">&nbsp;</a></div><pre>Well, I obtained a new certificate for voms.grid.iu.edu that has those alternate subjects, but apparently there is also an http/voms.grid.iu.edu service certificate that tomcat uses separately from that. I will have to obtain a new one of those as well.</pre></div><div class='update_description'><i onclick="document.location='33249#1490809196'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-03-29T17:39:56+00:00">Mar 29, 2017 05:39 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1490809196">&nbsp;</a></div><pre>The aliases were changed such that voms.opensciencegrid.org now points to voms.grid.iu.edu today.
Although the interface is OK from the web site, the GUMS servers will still try to access it via
<a href='https&#58;//voms.opensciencegrid.org&#58;8443/voms/osg' target='_blank' rel='nofollow'>https&#58;//voms.opensciencegrid.org&#58;8443/voms/osg</a>

That SSL handshake will fail because the cert on port 8443 does not have the alternate DN&#39;s that are needed.
At a minimum it should have voms.opensciencegrid.org in it, ideally voms1.opensciencegrid.org and voms2.opensciencegrid.org as well.
Until this is done, all the GUMS servers around the OSG will not be able to update the membership of the OSG vo correctly, and thus any
new members will not be added. Likewise edg-mkgridmap will also fail.

Steve Timm

by /DC=org/DC=cilogon/C=US/O=Fermi National Accelerator Laboratory/OU=People/CN=Steven Timm/CN=UID&#58;timm</pre></div><legend>Similar Recent Tickets <small>modified within the last 30 days</small></legend><div id="similar_tickets"><p class="muted">No similar tickets found.</p></div>
</div>
<script type="text/javascript">
function reset_anchor() {
    $("#updates .selected").removeClass("selected");
    var urls = document.location.toString().split('#'); 
    var anchor = urls[1];
    if(anchor) {
        $("a[name='"+anchor+"']").parents(".update_description").addClass("selected");
    }
}
function submitspam(ticket_id) {
    myret = confirm("Would you like to close this ticket as a security ticket, and submit the ticket content to akismet?");
    if(myret == true) {
        $.ajax("viewer/processspam?id="+ticket_id).done(function() {
            window.location.reload();
        });
    }
}

$(function() {
    reset_anchor();
    var ADDITIONAL_COOKIE_NAME = 'gocticket';
    var options = { path: '/', expires: 365};

    if(window.opener && window.opener.name == "gocticket_list") {
        v = $.cookie("closewindow");
        if(!v) {
            $("#closewindow").attr("checked", "checked"); //on by default
        } else {
            if(v == "checked") {
                $("#closewindow").attr("checked", "checked");
            }
        }
        $("#closewindow").click(function() {
            $.cookie("closewindow", $(this).attr('checked'), options);
        });
    } else {
        $("#closewindow_area").hide();
    }
    function updateTimeago() {
        $("time").timeago();
        setTimeout(updateTimeago, 30*1000);
    }
    updateTimeago();
    $(".description").focus(expand_description);
});
</script>
<hr/>
<footer>
<p>GOC Ticket Version 2.2 | <a href="https://ticket.opensciencegrid.org/goc/submit?app_issue_check=on&amp;app_issue_type=goc&amp;app_goc_url=https%3A%2F%2Fticket.opensciencegrid.org%3A443%2F33249">Report Bugs</a>
 | <a href="https://github.com/opensciencegrid/operations/blob/master/docs/privacy.md">Privacy Policy</a>
</p>

<p> <img align="top" src="images/tag_orange.png"/> Copyright 2018 The Trustees of Indiana University - Developed for Open Science Grid</p>
</footer>


</div><!--container-fluid-->
<script src="https://ticket1.grid.iu.edu:8443/socket.io/socket.io.js"></script>
<script>
var chat = io.connect('https://ticket1.grid.iu.edu:8443');
chat.on('connect', function() {
    chat.emit('authenticate', {nodekey:'', ticketid: 33249});
});
chat.on('peers', function(peers) {
    $("#peers").html("");
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('peer_disconnect', function(pid) {
    $("#peer_"+pid).hide("slow");
});
chat.on('peer_connected', function(peers) {
    //expect only 1 peer connecting, but..
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('submit', function() {
    if(confirm("This ticket was updated. Do you want to refresh?")) {
        history.go(0);
    }
});

function addPeer(pid, peer) {
    var ipinfo = "";
    if(peer.ip != undefined) {
        ipinfo = "<span class=\"ip\">"+peer.ip+"</span>";
    }
    if(chat.io.engine.id == pid) {
        //don't display myself
        return;
    }
    var html = "<li class=\"new\" id=\"peer_"+pid+"\" class=\"peer\">"+peer.name+ipinfo+"</li>";
    $("#peers").prepend(html);
    $("#peers .new").animate({bottom: 0}, 1000, function() {$(this).removeClass("new")});
}

$(function() {
    $("#ticket_form").submit(function() {
        chat.emit('submit');
        return true;
    });
});
</script>
<script>
//used by searchbox
function parseValue(value) {
    var obj = new Object();
    var tokens = value.split("\t");
    obj.str = tokens[0];
    obj.count = tokens[1];
    return obj;
}

$(function() {
    //bootstrap-2.0.4 stuff
    $(".alert-message").alert();
    $(".dropdown-toggle").dropdown();
    $("span[rel='tooltip']").tooltip();
    $("a[rel=popover]").popover();

    //activate menu that user is currently on
    $("#menu_navigator").addClass("active"); 
    $("#submenu_").addClass("active"); 

    //translate zend validation error message to bootstrap
    $(".errors").addClass("alert").addClass("alert-error");

    //enable autocomplete for search box
    $("#search").autocomplete({
        source: function( request, response ) {
            $.ajax({
                url: "search/autocomplete",
                dataType: "text",
                data: {
                    //featureClass: "P",
                    //style: "full",
                    //maxRows: 12,
                    //name_startsWith: request.term
                    q: request.term
                },
                success: function( data ) {
                    response( $.map( data.split("\n"), function( item ) {
                        if(item == "") return null;
                        return {
                            value: item
                        }
                    }));
                }
            });
        },
        select: function(event, ui) {
            document.location = "search?q="+ui.item.value;
        }
    });
    
});
</script>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-69012-13");
pageTracker._trackPageview();
} catch(err) {}
</script>

</body>
