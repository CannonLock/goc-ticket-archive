<!DOCTYPE html>
<html lang="en">
  <head>
  <base href="/">
    <title>[35281] IceCube GPU jobs failing at Omaha/Crane</title>    <meta charset="utf-8" />
    <meta name="verify-v1" content="na5IcAJsZVOfEkboRxuIiZ1zpZgnZiWra+nKcS7nA/o=" />
    <meta name="google-site-verification" content="DLrk3ft4s8b-S2TloLCL2LD_t6wcTjgSluf5pmiu2kA" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />
    <link href="https://ticket.opensciencegrid.org/rss" rel="alternate" type="application/rss+xml" title="GOC Ticket Update feed" />

    <style type="text/css">
      body {
        padding-top: 50px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
     #search {
            width: 300px;
     }

    </style>

<script src="https://code.jquery.com/jquery-3.0.0.js"></script>
<script src="https://code.jquery.com/jquery-migrate-3.0.1.js"></script>

   <link href="//netdna.bootstrapcdn.com/bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet"/>
    <script src="//netdna.bootstrapcdn.com/bootstrap/2.3.2/js/bootstrap.min.js"></script>

    <link href="//netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"/>
    <link href="//ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/themes/smoothness/jquery-ui.min.css" rel="stylesheet"/>
 <script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>


    <link href="//cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/css/select2.min.css" rel="stylesheet" />
    <script src="//cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/js/select2.min.js"></script>

    <link href="css/ticket.css" rel="stylesheet" />
    <script src="lib/jquery.cookie.js"></script>

    <link href="images/tag_orange.png" rel="icon" type="image/png"/>
    <script src='https://www.google.com/recaptcha/api.js'></script>
  </head>

  <body>
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>

            <a class="brand" style="padding: 6px 0px 0px 6px;" href="http://opensciencegrid.org"><img src="https://ticket.opensciencegrid.org/images/osglogo.40x30.png"/></a>
            <ul class="nav">
                <li class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown">GOC Ticket <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    <li><a href="https://my.opensciencegrid.org">MyOSG</a></li>
                    <li><a href="https://oim.opensciencegrid.org">OIM</a></li>
                    <li class="active"><a href="index">Ticket</a></li>
	<li class="divider"></li>
	<li><a href="http://repo.grid.iu.edu">Repo</a></li>
	<li class="divider"></li>
	<li><a href="http://blogs.grid.iu.edu">Blog</a></li>
                    <li><a href="http://display.grid.iu.edu">Display</a></li>
                    <li><a href="http://osggoc.blogspot.com/">News</a></li>
                    </ul>
                </li>
            </ul>
            <ul class="nav pull-right">
                <li><a href="https://ticket.opensciencegrid.org/sso/">Login</a></li>            </ul>

            <div class="nav-collapse">
                <ul class="nav">
			 <li id="menu_submit"><a href="https://ticket.opensciencegrid.org/submit">Submit</a></li><li id="menu_view" class="dropdown"><a href="\#" class="dropdown-toggle" data-toggle="dropdown">View <b class="caret"></b></a><ul class="dropdown-menu"><li id="submenu_listopen"><a href="https://ticket.opensciencegrid.org/list/open">Open Tickets</a></li><li id="submenu_listrecentclose"><a href="https://ticket.opensciencegrid.org/list/recentclose">Recently Closed Tickets</a></li><li class="divider"></li><li id="submenu_alltickets"><a href="https://ticket.opensciencegrid.org/search?q=&amp;sort=id">All Tickets</a></li></ul></li>                </ul>

                <form class="navbar-search pull-right" action="viewer">
                    <input id="search" type="text" name="id" class="search-query span2" placeholder="Search Ticket" value=""/>
                </form>
            </div>
        </div>
      </div>
    </div>

<script type='text/javascript' src='lib/jquery.timeago.js'></script>
<script type='text/javascript' src='lib/byte2size.js'></script>
<style>
#updates .toolbar {
position: relative;
margin-top: 0px;
top: -10px;
font-weight: normal;
}
#updates a.anchor {
position: relative;
top: -50px;
}
#updates .selected pre {
animation:selected 2s;
animation-iteration-count: 2;
animation-direction: alternate;
-webkit-animation:selected 2s; 
-webkit-animation-iteration-count: 2;
-webkit-animation-direction: alternate;
box-shadow: inset 1px 1px 20px #9ad;
border: 1px solid #9ab;
margin: 5px 0px;
padding-left: 10px;
}
@keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ab;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
@-webkit-keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ad;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
#updates pre {
background-color: inherit;
line-height: 15px;
padding: 5px;
}
#updates .header {
color: #999;
}
#updates .update_history pre {
background-color: #eee;
color: #666;
font-size: 85%;
}
#updates .clickable {
cursor: pointer;
}
#updates .clickable:hover {
color: #D98719;
}
#updates .meta_information pre {
background-color: #fed;
}
#similar_tickets {
max-height: 300px;
overflow-y: auto;
pointer-events: none;
padding: 5px;
background-color: #f4f4f4;
}
.btn-toolbar {
margin-bottom: 0;
height: 30px;
}
#peers {
position: fixed;
bottom: 0px;
right: 0px;
z-index: 100;
list-style: none;
padding: 5px 0px 0px 5px;
margin: 0px;
background-color: white;
box-shadow: 0px 0px 10px white;
}
#peers li {
background-color: #ccc;
color: #000;
display: inline-block;
padding: 5px 10px;
margin-right: 5px;
position: relative;
}
/*
#peers li:hover {
background-color: #999;
cursor: pointer;
}
*/
#peers span.ip {
padding-left: 5px;
color: #666;
}
#peers .new {
bottom: -30px;
}
/*
#peers .me {
background-color: red;
}
*/
</style>

<div class="container-fluid">
<ul id="peers"></ul>
<div class="alert alert-danger"><a class="close" href="#" data-dismiss="alert">&times;</a>By the end of May 2018, the ticketing system at https://ticket.opensciencegrid.org will be retired and support will be provided at https://support.opensciencegrid.org. Throughout this transition the support email (help@opensciencegrid.org) will be available as a point of contact.<br><br>                                                   
                                                                                                                                                                                   
Please see the service migration page for details: https://opensciencegrid.github.io/technology/policy/service-migrations-spring-2018/#ticket</div><div id="presence" class="pull-right"></div><div class="ticketgui"><script type="text/javascript" src="https://ticket.opensciencegrid.org/lib/checktab.js"></script>

<script>
var expanded = false;
function expand_description() {
    var desc = $(".description");
    if(!expanded) {
        expanded = true;
        //expand to minheight
        var min = 250;
        if(desc.height() < min) {
            desc.animate({height: min}, 200);
        }
    }
}

$(document).ready(function() {
    $("input[name='nad']").datepicker({
        dateFormat: 'yy-mm-dd'
    });
});

</script>



<style>
.form-horizontal .control-label {
padding-top: inherit;
font-size:90%;
color:#666;
}
label {
margin-bottom: 0px;
}
.controls {
line-height: 18px;
}
</style>
<form class="form-horizontal" action="https://ticket.opensciencegrid.org/viewer/updatebasic?id=35281" method="post">
<div class="page-header">
    <h3><span class="muted">35281</span> / IceCube GPU jobs failing at Omaha/Crane</h3>
</div>

<div class="row-fluid">
<div class="span5">
    <legend>Contact</legend>
    <div class="control-group">
        <label class="control-label">Full Name</label>
        <div class="controls">Gonzalo Merino</div>
    </div>
    <div class="control-group">
        <label class="control-label">Email</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">Phone</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">CC</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>

    <legend>Details</legend>
    <div class="control-group"><label class="control-label">Resource Name</label><div class="controls">Crane-CE1</div></div><div class="control-group"><label class="control-label">Associated VO</label><div class="controls">IceCube</div></div><div class="control-group"><label class="control-label">Submitted Via</label><div class="controls">GOC Ticket/submit</div></div><div class="control-group"><label class="control-label">Submitter</label><div class="controls">Gonzalo Merino</div></div><div class="control-group"><label class="control-label">Support Center</label><div class="controls">IceCube</div></div><div class="control-group"><label class="control-label">Ticket Links</label><div class="controls"></div></div>
    <div class="control-group">
        <label class="control-label">Ticket Type</label>
        <div class="controls">Problem/Request</div>
    </div>
    <div class="control-group">
        <label class="control-label">Priority</label>
        <div class="controls">Normal</div>
    </div>
    <div class="control-group">
        <label class="control-label">Status</label>
        <div class="controls">
Closed</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action</label>
        <div class="controls">ENG Action</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action Deadline</label>
        <div class="controls flag_red">2017-11-29</div>
    </div>

</div><!--span-->
<div class="span7">
    <legend>Assignees</legend>
    <div class="assignee" style="width: 60%">CSC <span class="muted"> / OSG Support Centers</span></div><div class="assignee" style="width: 60%">I3_support <span class="muted"> / OSG Support Centers</span></div>    <br>

    <legend>Assignees</legend>
    TODO
    <br>

    <style>
legend.noborder {
border-bottom: none;
}
</style>

<div id="attachment-list"/>
<script>
$(function () {
    var first = true;
    $.getJSON("https://ticket.opensciencegrid.org/attachment/list?id=35281", function (files) {
        //console.dir(files);
        var html = "<table class=\"table table-condensed\">";
        $(files).each(function() {
            if(first) {
                first = false;
                html += "<legend class=\"noborder\">Attachmenets</legend>";
            }
            html += "<tr class=\"attachment\">";
            html += "<td><img src=\""+this.thumbnail_url+"\"/></td>";
            html += "<td><a href=\""+this.url+"\" target=\"_blank\">"+this.name+"</a></td>";
            html += "<td>"+bytesToSize(this.size, 1)+"</td>";
            html += "</tr>";
        });
        html += "</table>";
        $("#attachment-list").html(html);
    });
});

function download(url) {
    window.open(url, "_blank");
}
</script>


</div><!--span-->
</div><!--row-fluid-->


</form>

</div>
<div id="updates" style="clear: both;">
    <legend>Past Updates
    <div class="btn-toolbar pull-right toolbar">
        <div class="btn-group">
                <a class="btn btn-small" href="/35281?sort=up&"><i class="icon-arrow-up"></i> Sort</a>

        
        <a class="btn btn-small" href="/35281?expandall=true&">Expand Descriptions</a>        <a class="btn btn-small" target="_blank" href="mailto:osg@tick.globalnoc.iu.edu?subject=Open%20Science%20Grid%3A%20IceCube%20GPU%20jobs%20failing%20at%20Omaha%2FCrane%20ISSUE%3D35281%20PROJ%3D71"><i class="icon-envelope"></i> Update w/Email</a>
        </div>
    </div><!--btn-toolbar-->
    </legend>

    <div class='update_description'><i onclick="document.location='35281#1511981913'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-11-29T18:58:33+00:00">Nov 29, 2017 06:58 PM UTC</time> by <b>echism</b><a class="anchor" name="1511981913">&nbsp;</a></div><pre>closing as advised.</pre></div><div class='update_description'><i onclick="document.location='35281#1511820371'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-11-27T22:06:11+00:00">Nov 27, 2017 10:06 PM UTC</time> by <b>gonzalo.merino@....</b><a class="anchor" name="1511820371">&nbsp;</a></div><pre>Hello,

I think this ticket can be closed now. We have understood that the failures
we were seeing at Omaha were due to the fact that we were running inside
singularity.

Now people is looking to this and trying to use a Singularity image that
would work ok for our GPU jobs.

But this work is now decoupled from the issue that triggered this ticket,
so I suggest to close this one.

thanks,
Gonzalo

On Mon, Nov 27, 2017 at 10&#58;32 AM Open Science Grid FootPrints &#60;
osg@....&#62; wrote&#58;

<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='35281#1511800288'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-11-27T16:31:28+00:00">Nov 27, 2017 04:31 PM UTC</time> by <b>echism</b><a class="anchor" name="1511800288">&nbsp;</a></div><pre>Gonzalo,

Did anything come of the inquiry with the UW GlideinWMS admins?

Thanks</pre></div><div class='update_description'><i onclick="document.location='35281#1511311396'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-11-22T00:43:16+00:00">Nov 22, 2017 12:43 AM UTC</time><a class="anchor" name="1511311396">&nbsp;</a></div><pre>Hi.

Disabling singularity does work.  Our GPU job then properly detects the RHEL6 environment and completes successfully.

We will check with the UW GlideinWMS admins on the setup for SingularityAutoLoad.

thanks,
Gonzalo

by /DC=org/DC=opensciencegrid/O=Open Science Grid/OU=People/CN=Gonzalo Merino 1270</pre></div><div class='update_description'><i onclick="document.location='35281#1510948876'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-11-17T20:01:16+00:00">Nov 17, 2017 08:01 PM UTC</time><a class="anchor" name="1510948876">&nbsp;</a></div><pre>Hi.

Sorry for the latency.

Yes. We run them via the UW frontend. I will follow your suggestion and check with admins there, and also test to force disabling singularity.

thanks,

by /DC=org/DC=opensciencegrid/O=Open Science Grid/OU=People/CN=Gonzalo Merino 1270</pre></div><div class='update_description'><i onclick="document.location='35281#1510867793'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-11-16T21:29:53+00:00">Nov 16, 2017 09:29 PM UTC</time> by <b>echism</b><a class="anchor" name="1510867793">&nbsp;</a></div><pre>Gonzalo,

Can you update this ticket?

Thanks</pre></div><div class='update_description'><i onclick="document.location='35281#1510693632'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-11-14T21:07:12+00:00">Nov 14, 2017 09:07 PM UTC</time> by <b>Derek Weitzel</b><a class="anchor" name="1510693632">&nbsp;</a></div><pre>Interesting.  How are you submitting these jobs?  Are they going through the Wisconsin&#39;s GlideinWMS?  I think they may have just changed the configuration such that every job runs inside a singularity container.

You should check with the admins there.  But in the mean time, you can try setting&#58;
+SingularityAutoLoad = False

in your test jobs.</pre></div><div class='update_description'><i onclick="document.location='35281#1510356731'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-11-10T23:32:11+00:00">Nov 10, 2017 11:32 PM UTC</time> by <b>gonzalo.merino@....</b><a class="anchor" name="1510356731">&nbsp;</a></div><pre>Hi,

No, we don&#39;t run GPU jobs inside singularity containers. This was just my
last test, for me to try to understand what is the issue we see at
Omaha/Crane.

We normally run jobs without requiring Singularity, but from what I see in
my test jobs ran this way, the environment still shows as if this ran
inside a CentOS7 singularity container, and our OS detection script detects
RHEL7 indeed, and tries to use according binaries.

This is some of the environment I see in one job I run which does not
require Singularity whatsoever&#58;

HAS_SINGULARITY=1

OSG_SINGULARITY_AUTOLOAD=1

OSG_SINGULARITY_BIND_CVMFS=1

OSG_SINGULARITY_BIND_GPU_LIBS=1

OSG_SINGULARITY_EL7_PERCENT=100

OSG_SINGULARITY_IMAGE=/cvmfs/
singularity.opensciencegrid.org/.images/0a/b974c39653044581cc0ac224b8f544a896a728ac58296124168f9be3eb45f8

OSG_SINGULARITY_IMAGE_DEFAULT=/cvmfs/
singularity.opensciencegrid.org/opensciencegrid/osgvo-el7&#58;latest

OSG_SINGULARITY_IMAGE_HUMAN=/cvmfs/
singularity.opensciencegrid.org/opensciencegrid/osgvo-el7&#58;latest

OSG_SINGULARITY_OUTSIDE_PWD=/scratch/glide_M8VeBH/execute/dir_30073

<div id='show_721247054' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_721247054'>OSG_SINGULARITY_PATH=/usr/bin/singularity

OSG_SINGULARITY_REEXEC=1

OSG_SINGULARITY_VERSION=2.2.99
</div><script type='text/javascript'>
        $('#show_721247054').click(function() {
            $('#detail_721247054').slideDown("normal");
            $('#show_721247054').hide();
            $('#hide_721247054').show();
        });
        $('#hide_721247054').click(function() {
            $('#detail_721247054').slideUp();
            $('#hide_721247054').hide();
            $('#show_721247054').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='35281#1510339467'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-11-10T18:44:27+00:00">Nov 10, 2017 06:44 PM UTC</time> by <b>Derek Weitzel</b><a class="anchor" name="1510339467">&nbsp;</a></div><pre>Hi,

Do you always run inside singularity containers?  I know some singularity containers do not import the correct environment in order to use GPUs.

-Derek</pre></div><div class='update_description'><i onclick="document.location='35281#1510335132'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-11-10T17:32:12+00:00">Nov 10, 2017 05:32 PM UTC</time> by <b>gonzalo.merino@....</b><a class="anchor" name="1510335132">&nbsp;</a></div><pre>Hello,

I have tried to re-run the test job by asking for Singularity and using a
centos6 container, and I see the same error.

This job ran in node c0601.crane.hcc.unl.edu. I paste below some of the env
vars&#58;

HAS_CVMFS_singularity_opensciencegrid_org=True

HAS_SINGULARITY=1

OSG_SINGULARITY_AUTOLOAD=1

OSG_SINGULARITY_BIND_CVMFS=1

OSG_SINGULARITY_BIND_GPU_LIBS=1

OSG_SINGULARITY_EL7_PERCENT=100

OSG_SINGULARITY_IMAGE=/cvmfs/
singularity.opensciencegrid.org/.images/56/68590f3f324199563a07e9afcb2759abfa91555ba00037c3fdc1d6c1a5dad9

OSG_SINGULARITY_IMAGE_DEFAULT=/cvmfs/
singularity.opensciencegrid.org/opensciencegrid/osgvo-el7&#58;latest

OSG_SINGULARITY_IMAGE_HUMAN=/cvmfs/
singularity.opensciencegrid.org/opensciencegrid/osgvo&#58;el6

OSG_SINGULARITY_OUTSIDE_PWD=/scratch/glide_v3h8rZ/execute/dir_29596

OSG_SINGULARITY_PATH=/usr/bin/singularity

OSG_SINGULARITY_REEXEC=1

<div id='show_272441984' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_272441984'>OSG_SINGULARITY_VERSION=2.2.99

OpSysLongName=Singularity Container - CentOS 7

I also see these variables. I wonder if the GPUDetection sowing no GPUs
detected is expected, or if it could be pointing to some problem&#58;

GLIDECLIENT_Group=glowGPU

GLIDECLIENT_Name=chtc2.glowGPU

GLIDEIN_GPUS=1

GPUDetection=No GPUs detected

GPU_DEVICE_ORDINAL=1

OSG_MACHINE_GPUS=1

OSG_SINGULARITY_BIND_GPU_LIBS=1

SLURM_JOB_GPUS=1

Gonzalo
</div><script type='text/javascript'>
        $('#show_272441984').click(function() {
            $('#detail_272441984').slideDown("normal");
            $('#show_272441984').hide();
            $('#hide_272441984').show();
        });
        $('#hide_272441984').click(function() {
            $('#detail_272441984').slideUp();
            $('#hide_272441984').hide();
            $('#show_272441984').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='35281#1510232534'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-11-09T13:02:14+00:00">Nov 9, 2017 01:02 PM UTC</time> by <b>gonzalo.merino@....</b><a class="anchor" name="1510232534">&nbsp;</a></div><pre>Hi John,

The last test job I ran yesterday ran in node c0614.crane.hcc.unl.edu

The environment (see at the bottom of mail) shows some variables which seem
to indicate that the job is running inside a singularity container with
CentOS7. I actually tried to submit this job with &#34;Requirements =
HAS_SINGULARITY == TRUE&#34; following documentation here
<a href='https&#58;//support.opensciencegrid.org/support/solutions/articles/12000024676-docker-and-singularity-containers' target='_blank' rel='nofollow'>https&#58;//support.opensciencegrid.org/support/solutions/articles/12000024676-docker-and-singularity-containers</a>,
expecting that it would pick up centos6 container by default, which seems
did not happen. I will try to submit tests specifying centos6 as the
singularity container to be used and see what is the result.

thanks,
Gonzalo

OSG_NODE_VALIDATED=True

OSG_SINGULARITY_AUTOLOAD=1

OSG_SINGULARITY_BIND_CVMFS=1

OSG_SINGULARITY_BIND_GPU_LIBS=1

OSG_SINGULARITY_EL7_PERCENT=100

OSG_SINGULARITY_IMAGE=/cvmfs/
singularity.opensciencegrid.org/.images/0a/b974c39653044581cc0ac224b8f544a896a728ac58296124168f9be3eb45f8

OSG_SINGULARITY_IMAGE_DEFAULT=/cvmfs/
singularity.opensciencegrid.org/opensciencegrid/osgvo-el7&#58;latest

OSG_SINGULARITY_IMAGE_HUMAN=/cvmfs/
singularity.opensciencegrid.org/opensciencegrid/osgvo-el7&#58;latest

<div id='show_400166727' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_400166727'>OSG_SINGULARITY_OUTSIDE_PWD=/scratch/glide_FFUapF/execute/dir_22273

OSG_SINGULARITY_PATH=/usr/bin/singularity

OSG_SINGULARITY_REEXEC=1

OSG_SINGULARITY_VERSION=2.2.99

OSG_SITE_NAME=Crane-CE1

OSG_SQUID_LOCATION=proxy.pki.hcc.unl.edu&#58;3128

OSG_STORAGE_ELEMENT=True

OSG_WN_TMP=/tmp

OpSysAndVer=CentOS7

OpSysLongName=Singularity Container - CentOS 7

OpSysMajorVer=7

OpSysName=CentOS

OpSysShortName=CentOS

OpSysVer=700
</div><script type='text/javascript'>
        $('#show_400166727').click(function() {
            $('#detail_400166727').slideDown("normal");
            $('#show_400166727').hide();
            $('#hide_400166727').show();
        });
        $('#hide_400166727').click(function() {
            $('#detail_400166727').slideUp();
            $('#hide_400166727').hide();
            $('#show_400166727').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='35281#1510169234'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-11-08T19:27:14+00:00">Nov 8, 2017 07:27 PM UTC</time><a class="anchor" name="1510169234">&nbsp;</a></div><pre>Dear Gonzalo,

How is the OS detection done? The cluster is running EL 6.9

Regards,
John

[glow@....e ~]$ lsb_release -a
LSB Version&#58;	&#58;base-4.0-amd64&#58;base-4.0-noarch&#58;core-4.0-amd64&#58;core-4.0-noarch
Distributor ID&#58;	Scientific
Description&#58;	Scientific Linux release 6.9 (Carbon)
Release&#58;	6.9
Codename&#58;	Carbon

[glow@....e ~]$ cat /etc/redhat-release
Scientific Linux release 6.9 (Carbon)

by /DC=org/DC=opensciencegrid/O=Open Science Grid/OU=People/CN=John Thiltges 819</pre></div><div class='update_description'><i onclick="document.location='35281#1510160748'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-11-08T17:05:48+00:00">Nov 8, 2017 05:05 PM UTC</time><a class="anchor" name="1510160748">&nbsp;</a></div><pre>Adding David shultz to the cc

by /DC=org/DC=opensciencegrid/O=Open Science Grid/OU=People/CN=Gonzalo Merino 1270</pre></div><div class='update_description'><i onclick="document.location='35281#1510160714'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-11-08T17:05:14+00:00">Nov 8, 2017 05:05 PM UTC</time> by <b>gonzalo.merino@....</b><a class="anchor" name="1510160714">&nbsp;</a></div><pre>Hello,

Apologies for not having responded faster to this thread. Somehow, I missed
the notification.

This is an example command that fails for us in Crane GPU nodes (we detect
the nodes to have CentOS7, therefore the scripts attempt to run the RHEL_7
version of the software)&#58;

/cvmfs/
icecube.opensciencegrid.org/py2-v2/RHEL_7_x86_64/metaprojects/simulation/V05-00-07/env-shell.sh
/cvmfs/
icecube.opensciencegrid.org/py2-v2/RHEL_7_x86_64/metaprojects/simulation/V05-00-07/clsim/resources/scripts/benchmark.py
-n 100

And this one fails with the error we mentioned&#58;

Traceback (most recent call last)&#58;

File &#34;/cvmfs/
icecube.opensciencegrid.org/py2-v2/RHEL_7_x86_64/metaprojects/simulation/V05-00-07/clsim/resources/scripts/benchmark.py&#34;,
line 316, in &#60;module&#62;

tray.Execute()

File &#34;/cvmfs/
icecube.opensciencegrid.org/py2-v2/RHEL_7_x86_64/metaprojects/simulation/V05-00-07/lib/I3Tray.py&#34;,
line 234, in Execute

super(I3Tray, self).Execute()

RuntimeError&#58; You have to provide at least one OpenCL device using the
&#34;OpenCLDeviceList&#34; parameter. (in virtual void I3CLSimModule&#58;&#58;Configure())

just failed for me in the node c0607.crane.hcc.unl.edu
<div id='show_1467855089' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_1467855089'>
Your example though seems to show that the device is actually detected from
our environment... I am puzzled about that. I am adding David Schultz to
this thread to ask him for input on this.

<a href='https&#58;//ticket.opensciencegrid.org/35281' target='_blank' rel='nofollow'>https&#58;//ticket.opensciencegrid.org/35281</a>

thanks,

Gonzalo
</div><script type='text/javascript'>
        $('#show_1467855089').click(function() {
            $('#detail_1467855089').slideDown("normal");
            $('#show_1467855089').hide();
            $('#hide_1467855089').show();
        });
        $('#hide_1467855089').click(function() {
            $('#detail_1467855089').slideUp();
            $('#hide_1467855089').hide();
            $('#show_1467855089').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='35281#1510083302'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-11-07T19:35:02+00:00">Nov 7, 2017 07:35 PM UTC</time> by <b>echism</b><a class="anchor" name="1510083302">&nbsp;</a></div><pre>Gonzalo,

Please respond.

Thanks</pre></div><div class='update_description'><i onclick="document.location='35281#1509744941'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-11-03T21:35:41+00:00">Nov 3, 2017 09:35 PM UTC</time><a class="anchor" name="1509744941">&nbsp;</a></div><pre>Dear Gonzalo,

To my knowledge, there haven&#39;t been any recent driver or library updates for our GPU nodes.

I tried a simple OpenCL &#39;hello world&#39; and it ran OK. I also did a quick attempt with clsim python (below) and it did show devices. Can you suggest a quick test we could run to replicate the issue?

Regards,
John

[jthiltge@....e ~]$ srun -x c0614 --pty -p gpu --gres=gpu&#58;1 /bin/bash
srun&#58; job 10457832 queued and waiting for resources
srun&#58; job 10457832 has been allocated resources
[jthiltge@....e ~]$ cd /cvmfs/icecube.opensciencegrid.org/py2-v3/RHEL_6_x86_64/metaprojects/combo/stable/lib
[jthiltge@....e lib]$ LD_LIBRARY_PATH=/cvmfs/icecube.opensciencegrid.org/py2-v3/RHEL_6_x86_64/lib64 /cvmfs/icecube.opensciencegrid.org/py2-v3/RHEL_6_x86_64/bin/python
Python 2.7.13 (default, Apr 19 2017, 12&#58;31&#58;46)
[GCC 4.4.7 20120313 (Red Hat 4.4.7-3)] on linux2
Type &#34;help&#34;, &#34;copyright&#34;, &#34;credits&#34; or &#34;license&#34; for more information.
<font color='#7F7E6F'>&#62;&#62;&#62; from icecube import clsim</font>
<font color='#7F7E6F'>&#62;&#62;&#62; for device in clsim.I3CLSimOpenCLDevice.GetAllDevices()&#58;</font>
...     print device
...
[ I3CLSimOpenCLDevice platform &#58; NVIDIA CUDA
device &#58; Tesla P100-PCIE-12GB

cpu &#58; NO
gpu &#58; YES
maxComputeUnits &#58; 56
maxWorkItemSize &#58; 1024
maxWorkGroupSize &#58; 1024
maxClockFrequency &#58; 1328MHz
globalMemSize &#58; 12193.8MiB
maxConstantBufferSize &#58; 64kiB
localMemSize &#58; 48kiB
dedicatedLocalMem &#58; YES
errorCorrectionSupport &#58; YES
<div id='show_1012863750' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_1012863750'>available &#58; YES
vendor &#58; NVIDIA Corporation
driverVersion &#58; 375.66
deviceVersion &#58; OpenCL 1.2 CUDA
extensions &#58; cl_khr_global_int32_base_atomics cl_khr_global_int32_extended_atomics cl_khr_local_int32_base_atomics cl_khr_local_int32_extended_atomics cl_khr_fp64 cl_khr_byte_addressable_store cl_khr_icd cl_khr_gl_sharing cl_nv_compiler_options cl_nv_device_attribute_query cl_nv_pragma_unroll cl_nv_copy_opts cl_nv_create_buffer

useNativeMath &#58; NO
approximateNumberOfWorkItems &#58; 1024
]
<font color='#7F7E6F'>&#62;&#62;&#62;</font>

by /DC=org/DC=opensciencegrid/O=Open Science Grid/OU=People/CN=John Thiltges 819
</div><script type='text/javascript'>
        $('#show_1012863750').click(function() {
            $('#detail_1012863750').slideDown("normal");
            $('#show_1012863750').hide();
            $('#hide_1012863750').show();
        });
        $('#hide_1012863750').click(function() {
            $('#detail_1012863750').slideUp();
            $('#hide_1012863750').hide();
            $('#show_1012863750').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='35281#1509741906'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-11-03T20:45:06+00:00">Nov 3, 2017 08:45 PM UTC</time><a class="anchor" name="1509741906">&nbsp;</a></div><pre>I mentioned this to the HCC folk who mostly deal with this resource, and I guess we never updated the ticket. Unfortunately, my recollection of the conversation was that nobody had any immediate clue as to why this might be happening.

I&#39;ve added them all to the CC list, though given the time of day (and day of week) this might be on hold until next Monday.

by /DC=org/DC=opensciencegrid/O=Open Science Grid/OU=People/CN=Garhan Attebury 280</pre></div><div class='update_description'><i onclick="document.location='35281#1509734995'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-11-03T18:49:55+00:00">Nov 3, 2017 06:49 PM UTC</time> by <b>echism</b><a class="anchor" name="1509734995">&nbsp;</a></div><pre>Garhan,

Your thoughts?

Thanks</pre></div><div class='update_description'><i onclick="document.location='35281#1509558101'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-11-01T17:41:41+00:00">Nov 1, 2017 05:41 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1509558101">&nbsp;</a></div><pre>Hello,

Since around Oct 27, all our GPU jobs that try to run at Crane/Omaha seem to be failing. Our application complains about not being able to find a GPU device, with an error message like this one&#58;

RuntimeError&#58; You have to provide at least one OpenCL device using the &#34;OpenCLDeviceList&#34; parameter. (in virtual void I3CLSimModule&#58;&#58;Configure())

One example of one of those failing jobs, ran at node c0614.crane.hcc.unl.edu and had these env variables, to what it apparently seems an OK environment&#58;

GPU_DEVICE_ORDINAL=0
CUDA_VISIBLE_DEVICES=0
CUDADeviceName=Tesla K40m

do you know what could be causing these issues? Was there any change in the runtime environment made around Oct 27 that could be causing this?

thanks a lot,
Gonzalo

by /DC=org/DC=opensciencegrid/O=Open Science Grid/OU=People/CN=Gonzalo Merino 1270</pre></div><legend>Similar Recent Tickets <small>modified within the last 30 days</small></legend><div id="similar_tickets"><p class="muted">No similar tickets found.</p></div>
</div>
<script type="text/javascript">
function reset_anchor() {
    $("#updates .selected").removeClass("selected");
    var urls = document.location.toString().split('#'); 
    var anchor = urls[1];
    if(anchor) {
        $("a[name='"+anchor+"']").parents(".update_description").addClass("selected");
    }
}
function submitspam(ticket_id) {
    myret = confirm("Would you like to close this ticket as a security ticket, and submit the ticket content to akismet?");
    if(myret == true) {
        $.ajax("viewer/processspam?id="+ticket_id).done(function() {
            window.location.reload();
        });
    }
}

$(function() {
    reset_anchor();
    var ADDITIONAL_COOKIE_NAME = 'gocticket';
    var options = { path: '/', expires: 365};

    if(window.opener && window.opener.name == "gocticket_list") {
        v = $.cookie("closewindow");
        if(!v) {
            $("#closewindow").attr("checked", "checked"); //on by default
        } else {
            if(v == "checked") {
                $("#closewindow").attr("checked", "checked");
            }
        }
        $("#closewindow").click(function() {
            $.cookie("closewindow", $(this).attr('checked'), options);
        });
    } else {
        $("#closewindow_area").hide();
    }
    function updateTimeago() {
        $("time").timeago();
        setTimeout(updateTimeago, 30*1000);
    }
    updateTimeago();
    $(".description").focus(expand_description);
});
</script>
<hr/>
<footer>
<p>GOC Ticket Version 2.2 | <a href="https://ticket.opensciencegrid.org/goc/submit?app_issue_check=on&amp;app_issue_type=goc&amp;app_goc_url=https%3A%2F%2Fticket.opensciencegrid.org%3A443%2F35281">Report Bugs</a>
 | <a href="https://github.com/opensciencegrid/operations/blob/master/docs/privacy.md">Privacy Policy</a>
</p>

<p> <img align="top" src="/images/tag_orange.png"/> Copyright 2018 The Trustees of Indiana University - Developed for Open Science Grid</p>
</footer>


</div><!--container-fluid-->
<script src="https://ticket1.grid.iu.edu:8443/socket.io/socket.io.js"></script>
<script>
var chat = io.connect('https://ticket1.grid.iu.edu:8443');
chat.on('connect', function() {
    chat.emit('authenticate', {nodekey:'', ticketid: 35281});
});
chat.on('peers', function(peers) {
    $("#peers").html("");
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('peer_disconnect', function(pid) {
    $("#peer_"+pid).hide("slow");
});
chat.on('peer_connected', function(peers) {
    //expect only 1 peer connecting, but..
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('submit', function() {
    if(confirm("This ticket was updated. Do you want to refresh?")) {
        history.go(0);
    }
});

function addPeer(pid, peer) {
    var ipinfo = "";
    if(peer.ip != undefined) {
        ipinfo = "<span class=\"ip\">"+peer.ip+"</span>";
    }
    if(chat.io.engine.id == pid) {
        //don't display myself
        return;
    }
    var html = "<li class=\"new\" id=\"peer_"+pid+"\" class=\"peer\">"+peer.name+ipinfo+"</li>";
    $("#peers").prepend(html);
    $("#peers .new").animate({bottom: 0}, 1000, function() {$(this).removeClass("new")});
}

$(function() {
    $("#ticket_form").submit(function() {
        chat.emit('submit');
        return true;
    });
});
</script>
<script>
//used by searchbox
function parseValue(value) {
    var obj = new Object();
    var tokens = value.split("\t");
    obj.str = tokens[0];
    obj.count = tokens[1];
    return obj;
}

$(function() {
    //bootstrap-2.0.4 stuff
    $(".alert-message").alert();
    $(".dropdown-toggle").dropdown();
    $("span[rel='tooltip']").tooltip();
    $("a[rel=popover]").popover();

    //activate menu that user is currently on
    $("#menu_navigator").addClass("active"); 
    $("#submenu_").addClass("active"); 

    //translate zend validation error message to bootstrap
    $(".errors").addClass("alert").addClass("alert-error");

    //enable autocomplete for search box
    $("#search").autocomplete({
        source: function( request, response ) {
            $.ajax({
                url: "search/autocomplete",
                dataType: "text",
                data: {
                    //featureClass: "P",
                    //style: "full",
                    //maxRows: 12,
                    //name_startsWith: request.term
                    q: request.term
                },
                success: function( data ) {
                    response( $.map( data.split("\n"), function( item ) {
                        if(item == "") return null;
                        return {
                            value: item
                        }
                    }));
                }
            });
        },
        select: function(event, ui) {
            document.location = "search?q="+ui.item.value;
        }
    });
    
});
</script>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-69012-13");
pageTracker._trackPageview();
} catch(err) {}
</script>

</body>
