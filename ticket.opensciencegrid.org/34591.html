<!DOCTYPE html>
<html lang="en">
  <head>
  <base href="">
    <title>[34591] HTTPS-xrootd issue</title>    <meta charset="utf-8" />
    <meta name="verify-v1" content="na5IcAJsZVOfEkboRxuIiZ1zpZgnZiWra+nKcS7nA/o=" />
    <meta name="google-site-verification" content="DLrk3ft4s8b-S2TloLCL2LD_t6wcTjgSluf5pmiu2kA" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />
    <link href="https://ticket.opensciencegrid.org/rss" rel="alternate" type="application/rss+xml" title="GOC Ticket Update feed" />

    <style type="text/css">
      body {
        padding-top: 50px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
     #search {
            width: 300px;
     }

    </style>

<script src="https://code.jquery.com/jquery-3.0.0.js"></script>
<script src="https://code.jquery.com/jquery-migrate-3.0.1.js"></script>

   <link href="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet"/>
    <script src="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/js/bootstrap.min.js"></script>

    <link href="https://netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"/>
    <link href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/themes/smoothness/jquery-ui.min.css" rel="stylesheet"/>
 <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>


    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/js/select2.min.js"></script>

    <link href="css/ticket.css" rel="stylesheet" />
    <script src="lib/jquery.cookie.js"></script>

    <link href="images/tag_orange.png" rel="icon" type="image/png"/>
  </head>

  <body>
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>

            <a class="brand" style="padding: 6px 0px 0px 6px;" href="http://opensciencegrid.org"><img src="images/osglogo.40x30.png"/></a>
            <ul class="nav">
                <li class="dropdown"><a href="https://ticket.opensciencegrid.org/#" class="dropdown-toggle" data-toggle="dropdown">GOC Ticket <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    <li><a href="https://my.opensciencegrid.org">MyOSG</a></li>
                    <li><a href="https://oim.opensciencegrid.org">OIM</a></li>
                    <li class="active"><a href="https://ticket.opensciencegrid.org/index">Ticket</a></li>
	<li class="divider"></li>
	<li><a href="http://repo.grid.iu.edu">Repo</a></li>
	<li class="divider"></li>
	<li><a href="http://blogs.grid.iu.edu">Blog</a></li>
                    <li><a href="http://display.grid.iu.edu">Display</a></li>
                    <li><a href="http://osggoc.blogspot.com/">News</a></li>
                    </ul>
                </li>
            </ul>
            <ul class="nav pull-right">
                <li><a href="https://ticket.opensciencegrid.org/sso/">Login</a></li>            </ul>

            <div class="nav-collapse">
                <ul class="nav">
			 <li id="menu_submit"><a href="https://ticket.opensciencegrid.org/submit">Submit</a></li><li id="menu_view" class="dropdown"><a href="https://ticket.opensciencegrid.org/\#" class="dropdown-toggle" data-toggle="dropdown">View <b class="caret"></b></a><ul class="dropdown-menu"><li id="submenu_listopen"><a href="https://ticket.opensciencegrid.org/list/open">Open Tickets</a></li><li id="submenu_listrecentclose"><a href="https://ticket.opensciencegrid.org/list/recentclose">Recently Closed Tickets</a></li><li class="divider"></li><li id="submenu_alltickets"><a href="https://ticket.opensciencegrid.org/search?q=&amp;sort=id">All Tickets</a></li></ul></li>                </ul>

                <form class="navbar-search pull-right" action="https://ticket.opensciencegrid.org/viewer">
                    <input id="search" type="text" name="id" class="search-query span2" placeholder="Search Ticket" value=""/>
                </form>
            </div>
        </div>
      </div>
    </div>

<script type='text/javascript' src='lib/jquery.timeago.js'></script>
<script type='text/javascript' src='lib/byte2size.js'></script>
<style>
#updates .toolbar {
position: relative;
margin-top: 0px;
top: -10px;
font-weight: normal;
}
#updates a.anchor {
position: relative;
top: -50px;
}
#updates .selected pre {
animation:selected 2s;
animation-iteration-count: 2;
animation-direction: alternate;
-webkit-animation:selected 2s; 
-webkit-animation-iteration-count: 2;
-webkit-animation-direction: alternate;
box-shadow: inset 1px 1px 20px #9ad;
border: 1px solid #9ab;
margin: 5px 0px;
padding-left: 10px;
}
@keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ab;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
@-webkit-keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ad;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
#updates pre {
background-color: inherit;
line-height: 15px;
padding: 5px;
}
#updates .header {
color: #999;
}
#updates .update_history pre {
background-color: #eee;
color: #666;
font-size: 85%;
}
#updates .clickable {
cursor: pointer;
}
#updates .clickable:hover {
color: #D98719;
}
#updates .meta_information pre {
background-color: #fed;
}
#similar_tickets {
max-height: 300px;
overflow-y: auto;
pointer-events: none;
padding: 5px;
background-color: #f4f4f4;
}
.btn-toolbar {
margin-bottom: 0;
height: 30px;
}
#peers {
position: fixed;
bottom: 0px;
right: 0px;
z-index: 100;
list-style: none;
padding: 5px 0px 0px 5px;
margin: 0px;
background-color: white;
box-shadow: 0px 0px 10px white;
}
#peers li {
background-color: #ccc;
color: #000;
display: inline-block;
padding: 5px 10px;
margin-right: 5px;
position: relative;
}
/*
#peers li:hover {
background-color: #999;
cursor: pointer;
}
*/
#peers span.ip {
padding-left: 5px;
color: #666;
}
#peers .new {
bottom: -30px;
}
/*
#peers .me {
background-color: red;
}
*/
</style>

<div class="container-fluid">
<ul id="peers"></ul>
<div class="alert alert-danger"><a class="close" href="https://ticket.opensciencegrid.org/#" data-dismiss="alert">&times;</a>By the end of May 2018, the ticketing system at https://ticket.opensciencegrid.org will be retired and support will be provided at https://support.opensciencegrid.org. Throughout this transition the support email (help@opensciencegrid.org) will be available as a point of contact.<br><br>                                                   
                                                                                                                                                                                   
Please see the service migration page for details: https://opensciencegrid.github.io/technology/policy/service-migrations-spring-2018/#ticket</div><div id="presence" class="pull-right"></div><div class="ticketgui"><script type="text/javascript" src="lib/checktab.js"></script>

<script>
var expanded = false;
function expand_description() {
    var desc = $(".description");
    if(!expanded) {
        expanded = true;
        //expand to minheight
        var min = 250;
        if(desc.height() < min) {
            desc.animate({height: min}, 200);
        }
    }
}

$(document).ready(function() {
    $("input[name='nad']").datepicker({
        dateFormat: 'yy-mm-dd'
    });
});

</script>



<style>
.form-horizontal .control-label {
padding-top: inherit;
font-size:90%;
color:#666;
}
label {
margin-bottom: 0px;
}
.controls {
line-height: 18px;
}
</style>
<form class="form-horizontal" action="https://ticket.opensciencegrid.org/viewer/updatebasic?id=34591" method="post">
<div class="page-header">
    <h3><span class="muted">34591</span> / HTTPS-xrootd issue</h3>
</div>

<div class="row-fluid">
<div class="span5">
    <legend>Contact</legend>
    <div class="control-group">
        <label class="control-label">Full Name</label>
        <div class="controls">Bockjoo Kim</div>
    </div>
    <div class="control-group">
        <label class="control-label">Email</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">Phone</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">CC</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>

    <legend>Details</legend>
    <div class="control-group"><label class="control-label">Submitted Via</label><div class="controls">GOC Ticket/submit</div></div><div class="control-group"><label class="control-label">Submitter</label><div class="controls">Bockjoo Kim</div></div><div class="control-group"><label class="control-label">Ticket Links</label><div class="controls"></div></div>
    <div class="control-group">
        <label class="control-label">Ticket Type</label>
        <div class="controls">Problem/Request</div>
    </div>
    <div class="control-group">
        <label class="control-label">Priority</label>
        <div class="controls">Normal</div>
    </div>
    <div class="control-group">
        <label class="control-label">Status</label>
        <div class="controls">
Closed</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action</label>
        <div class="controls">ENG Action</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action Deadline</label>
        <div class="controls flag_red">2017-10-09</div>
    </div>

</div><!--span-->
<div class="span7">
    <legend>Assignees</legend>
    <div class="assignee" style="width: 60%">Software Support (Triage) <span class="muted"> / OSG Software Team</span></div><div class="assignee" style="width: 60%">Tim Theisen <span class="muted"> / OSG Software Team</span></div>    <br>

    <legend>Assignees</legend>
    TODO
    <br>

    <style>
legend.noborder {
border-bottom: none;
}
</style>

<div id="attachment-list"/>
<script>
$(function () {
    var first = true;
    $.getJSON("attachment/list/34591", function (files) {
        //console.dir(files);
        var html = "<table class=\"table table-condensed\">";
        $(files).each(function() {
            if(first) {
                first = false;
                html += "<legend class=\"noborder\">Attachmenets</legend>";
            }
            html += "<tr class=\"attachment\">";
            html += "<td><img src=\""+this.thumbnail_url+"\"/></td>";
            html += "<td><a href=\""+this.url+"\" target=\"_blank\">"+this.name+"</a></td>";
            html += "<td>"+bytesToSize(this.size, 1)+"</td>";
            html += "</tr>";
        });
        html += "</table>";
        $("#attachment-list").html(html);
    });
});

function download(url) {
    window.open(url, "_blank");
}
</script>


</div><!--span-->
</div><!--row-fluid-->


</form>

</div>
<div id="updates" style="clear: both;">
    <legend>Past Updates
    <div class="btn-toolbar pull-right toolbar">
        <div class="btn-group">
                <a class="btn btn-small" href="https://ticket.opensciencegrid.org/34591?sort=up&amp;"><i class="icon-arrow-up"></i> Sort</a>

        
        <a class="btn btn-small" href="https://ticket.opensciencegrid.org/34591?expandall=true&amp;">Expand Descriptions</a>        <a class="btn btn-small" target="_blank" href="mailto:osg@tick.globalnoc.iu.edu?subject=Open%20Science%20Grid%3A%20HTTPS-xrootd%20issue%20ISSUE%3D34591%20PROJ%3D71"><i class="icon-envelope"></i> Update w/Email</a>
        </div>
    </div><!--btn-toolbar-->
    </legend>

    <div class='update_description'><i onclick="document.location='34591#1507236717'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-10-05T20:51:57+00:00">Oct 5, 2017 08:51 PM UTC</time><a class="anchor" name="1507236717">&nbsp;</a></div><pre>I think this ticket can be closed.

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=cvuosalo/CN=708697/CN=Carl Vuosalo</pre></div><div class='update_description'><i onclick="document.location='34591#1507236669'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-10-05T20:51:09+00:00">Oct 5, 2017 08:51 PM UTC</time><a class="anchor" name="1507236669">&nbsp;</a></div><pre>At Wisconsin, we found that our public redirector was missing a package, vo-client. After installing that package, the problems I mentioned previously have gone away. It looks like XRootD over HTTPS would work for us, even with the restrictive authentication of  &#34;g /cms /store lr&#34;.

The remaining problem is that our data nodes are el6, and the latest OSG 3.3 for el6 does not fully support XRootD over HTTPS (the SSL handshake fails). When a new version of OSG 3.3 or 3.5 comes out with a fix for this problem, we can install it and try XRootD over HTTPS again.

---Carl

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=cvuosalo/CN=708697/CN=Carl Vuosalo</pre></div><div class='update_description'><i onclick="document.location='34591#1507224352'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-10-05T17:25:52+00:00">Oct 5, 2017 05:25 PM UTC</time> by <b>echism</b><a class="anchor" name="1507224352">&nbsp;</a></div><pre>Hey Brian,

We didn&#39;t get what you sent. Did you send an inline reply?

You have to mind that section that says &#34; When replying, type your text above this line. &#34;

Thanks</pre></div><div class='update_description'><i onclick="document.location='34591#1507078573'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-10-04T00:56:13+00:00">Oct 4, 2017 12:56 AM UTC</time> by <b>bbockelm</b><a class="anchor" name="1507078573">&nbsp;</a></div><pre>Sent from my iPhone

<font color='#7F7E6F'>&#62; On Oct 3, 2017, at 6&#58;16 PM, Open Science Grid FootPrints &#60;osg@....&#62; wrote&#58;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='34591#1507072617'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-10-03T23:16:57+00:00">Oct 3, 2017 11:16 PM UTC</time><a class="anchor" name="1507072617">&nbsp;</a></div><pre>Hi Brian and Marian,

I try to make an HTTPS request to our public redirector which runs el7&#58;

davix-get --debug <a href='https&#58;//pubxrootd.hep.wisc.edu&#58;1094//store/user/dan/test_file' target='_blank' rel='nofollow'>https&#58;//pubxrootd.hep.wisc.edu&#58;1094//store/user/dan/test_file</a> -E /tmp/x509up_u4072 --capath /etc/grid-security/certificates

The xrootd log on pubxrootd shows the following with &#34;g /cms /store lr&#34; in the Authfile&#58;

VOMS failure (14)&#58; Cannot verify AC signature!
INFO in AuthzFun&#58; Lookup with key /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=cvuosalo/CN=708697/CN=Carl Vuosalo&#58;&#58;
INFO in AuthzFun&#58; Using cached entity with username osg_cmsuser1924
171003 17&#58;56&#58;43 22541 XrootdBridge&#58; osg_cmsu.5&#58;46@gilia login as osg_cmsuser1924
171003 17&#58;56&#58;43 22541 acc_Audit&#58; http deny  osg_cmsuser1924@[&#58;&#58;ffff&#58;128.104.28.15] stat /store/user/dan/test_file
171003 17&#58;56&#58;43 22541 ofs_stat&#58; osg_cmsu.5&#58;46@gilia Unable to locate /store/user/dan/test_file; permission denied
171003 17&#58;56&#58;43 22541 osg_cmsu.5&#58;46@gilia XrootdResponse&#58; sending err 3010&#58; Unable to locate /store/user/dan/test_file; permission denied
140584415733504&#58;error&#58;0906D06C&#58;PEM routines&#58;PEM_read_bio&#58;no start line&#58;pem_lib.c&#58;707&#58;Expecting&#58; CERTIFICATE
140584415733504&#58;error&#58;0906D06C&#58;PEM routines&#58;PEM_read_bio&#58;no start line&#58;pem_lib.c&#58;707&#58;Expecting&#58; CERTIFICATE
171003 17&#58;56&#58;43 22541 XrootdXeq&#58; osg_cmsu.5&#58;46@gilia disc 0&#58;00&#58;00 (send failure)

while with &#34;u * /store lr&#34; in the Authfile, the following messages appear, and the redirector attempts to connect to a data node, which fails to respond successfully because it is el6&#58;

VOMS failure (14)&#58; Cannot verify AC signature!
INFO in AuthzFun&#58; Lookup with key /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=cvuosalo/CN=708697/CN=Carl Vuosalo&#58;&#58;
lcmaps[22884]     LOG_ERR&#58; 2017-10-03.23&#58;02&#58;37Z&#58; lcmaps_x509_to_voms_fqans()&#58; Warning&#58; VOMS Signature error making it an unverifiable VOMS extension&#58; Cannot verify AC signature!. Hint&#58; check the VOMS directory (default&#58; /etc/grid-security/vomsdir/) and the .lsc files. Also you could fall back on using installed VOMS host certificates. If the problem persists, contact the user. LCMAPS will ignore the VOMS extensions in the mapping sequence.
INFO in AuthzFun&#58; Got uid 21939
171003 18&#58;02&#58;37 23000 XrootdBridge&#58; osg_cmsu.4&#58;69@gilia login as osg_cmsuser1924
171003 18&#58;02&#58;37 23000 acc_Audit&#58; http grant  osg_cmsuser1924@[&#58;&#58;ffff&#58;128.104.28.15] stat /store/user/dan/test_file
171003 18&#58;02&#58;37 22919 Receive pubxrootd 24 bytes on 57343
171003 18&#58;02&#58;37 22919 Decode pubxrootd redirects osg_cmsu.4&#58;69@gilia to s17n08.hep.wisc.edu&#58;31094 /store/user/dan/test_file
171003 18&#58;02&#58;37 23000 osg_cmsu.4&#58;69@gilia XrootdProtocol&#58; redirecting to s17n08.hep.wisc.edu&#58;31094
171003 18&#58;02&#58;37 23000 XrootdXeq&#58; osg_cmsu.4&#58;69@gilia disc 0&#58;00&#58;00 (send failure)

An HTTPS request directly to an el7 data node works, but it looks like a request through the redirector will fail with &#34;g /cms /store lr&#34; in the Authfile.

---Carl
<div id='show_714844117' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_714844117'>
by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=cvuosalo/CN=708697/CN=Carl Vuosalo
</div><script type='text/javascript'>
        $('#show_714844117').click(function() {
            $('#detail_714844117').slideDown("normal");
            $('#show_714844117').hide();
            $('#hide_714844117').show();
        });
        $('#hide_714844117').click(function() {
            $('#detail_714844117').slideUp();
            $('#hide_714844117').hide();
            $('#show_714844117').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='34591#1507064350'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-10-03T20:59:10+00:00">Oct 3, 2017 08:59 PM UTC</time><a class="anchor" name="1507064350">&nbsp;</a></div><pre>Uh... &#34;u * /store lr&#34; provides anyone with (any) certificate to read all CMS files.  Pretty sure that we don&#39;t want ATLAS and LIGO users to read all CMS data.

There&#39;s a few different layers within Xrootd where &#34;g /cms /store lr&#34; could cause permission denied (either at the Xrootd level, the &#34;acc&#34;, or the HDFS plugin level, the &#34;oss&#34;).  Can you give a sample server-side log line?

With &#34;g /cms /store lr&#34;, HTTPS requests will only succeed with a VOMS proxy&#58; you may need to use &#34;gfal-copy&#34; for it to authenticate correctly.  &#34;curl&#34; might not work.

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=bbockelm/CN=659869/CN=Brian Paul Bockelman</pre></div><div class='update_description'><i onclick="document.location='34591#1507063896'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-10-03T20:51:36+00:00">Oct 3, 2017 08:51 PM UTC</time><a class="anchor" name="1507063896">&nbsp;</a></div><pre>Hi Carl,

&#34;g /cms /store lr&#34; gives permission to read data from /store by everyone in cms group. It&#39;s weird if that&#39;s causing https part nonfunctional, though. Do things work with &#34;g /cms /store lr&#34; if http is disabled?
I&#39;d suggest use &#34;u * /store lr&#34; which gives permission to everyone but read only from /store, is that not too permissive for you?

-Marian

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=zvada/CN=684832/CN=Marian Zvada</pre></div><div class='update_description'><i onclick="document.location='34591#1507056013'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-10-03T18:40:13+00:00">Oct 3, 2017 06:40 PM UTC</time><a class="anchor" name="1507056013">&nbsp;</a></div><pre>Hi Marian,

We have only one Authfile. It used to be &#34;u * / lr&#34;, which seems too permissive. I tried changing it to &#34;g /cms /store lr&#34;, but then HTTPS requests fail with &#34;permission denied&#34;. Our xrootd.cfg is attached.

---Carl

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=cvuosalo/CN=708697/CN=Carl Vuosalo</pre></div><div class='update_description'><i onclick="document.location='34591#1507051392'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-10-03T17:23:12+00:00">Oct 3, 2017 05:23 PM UTC</time> by <b>marian.zvada@....</b><a class="anchor" name="1507051392">&nbsp;</a></div><pre>Hi Carl,

<font color='#7F7E6F'>&#62; It would be helpful to get a clarification from Erik and Marian about</font>
<font color='#7F7E6F'>&#62; the correct contents of the Authfile</font>

it also sort of depends how you setup your mount points.

Can you share your server config perhaps and also Authfile? I remember
Authfile versus what all.export line in the server configs may cause
some issues or when Authfile is different between redirector and a
server. Is this a case?

Here what we&#39;ve configured at UNL, our Authfile is bit more complex due
other VOs accessing data via xrootd&#58;
<a href='http&#58;//t2.unl.edu/store/zvada/xrootd-configs/Authfile.unl' target='_blank' rel='nofollow'>http&#58;//t2.unl.edu/store/zvada/xrootd-configs/Authfile.unl</a>

Let me know if that helps or not.

Thanks,
Marian

On 10/3/17 10&#58;55 AM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='34591#1507046137'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-10-03T15:55:37+00:00">Oct 3, 2017 03:55 PM UTC</time><a class="anchor" name="1507046137">&nbsp;</a></div><pre>It would be helpful to get a clarification from Erik and Marian about the correct contents of the Authfile.

---Carl

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=cvuosalo/CN=708697/CN=Carl Vuosalo</pre></div><div class='update_description'><i onclick="document.location='34591#1507037906'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-10-03T13:38:26+00:00">Oct 3, 2017 01:38 PM UTC</time> by <b>echism</b><a class="anchor" name="1507037906">&nbsp;</a></div><pre>Software,

Is this still in progress? Carl&#39;s update confused the issue for me.

Thanks</pre></div><div class='update_description'><i onclick="document.location='34591#1506640872'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-09-28T23:21:12+00:00">Sep 28, 2017 11:21 PM UTC</time> by <b>Bockjoo Kim</b><a class="anchor" name="1506640872">&nbsp;</a></div><pre>We havd this in our Authfile&#58;

[root@xrootd2 ~]# cat /etc/xrootd/Authfile
u * /store lr

Bockjoo
On 09/28/2017 06&#58;08 PM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='34591#1506636478'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-09-28T22:07:58+00:00">Sep 28, 2017 10:07 PM UTC</time><a class="anchor" name="1506636478">&nbsp;</a></div><pre>At Wisconsin, we have now been able to get HTTPS requests to work on an el7 data node with the latest OSG 3.3 version. However, we are having trouble making HTTPS to work through our public redirector. When the Authfile has only the recommended line &#34;g /cms /store lr&#34;, then HTTPS requests receive &#34;permission denied&#34; and &#34;file not found&#34;. When we add the line &#34;u * / lr&#34; to the Authfile, the requests seem to go through but run into the problem that most of our data nodes are el6, and OSG 3.3 on el6 doesn&#39;t work for HTTPS requests.

When there is an OSG 3.3 update for el6 that works correctly for HTTPS requests, we can try again.

---Carl

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=cvuosalo/CN=708697/CN=Carl Vuosalo</pre></div><div class='update_description'><i onclick="document.location='34591#1506548712'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-09-27T21:45:12+00:00">Sep 27, 2017 09:45 PM UTC</time> by <b>Bockjoo Kim</b><a class="anchor" name="1506548712">&nbsp;</a></div><pre>&#39;yum update&#39; on the machine where there was the HTTPS-xrootd issue

solved the issue. Both 4.6.1-1 xrootd and 4.7.0 xrootd worked fine after
the entire &#39;yum update&#39; on the machine.

I guess &#39;yum update&#39; provides some conflict resolution for the machine.

Thanks,

Bockjoo

On 09/27/2017 04&#58;47 PM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='34591#1506545224'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-09-27T20:47:04+00:00">Sep 27, 2017 08:47 PM UTC</time> by <b>echism</b><a class="anchor" name="1506545224">&nbsp;</a></div><pre>I&#39;m confused about where we are in this ticket. Could anyone summarize where we&#39;re going from here? I had thought we more or less had it done but now I&#39;m not sure.

Thanks</pre></div><div class='update_description'><i onclick="document.location='34591#1506378198'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-09-25T22:23:18+00:00">Sep 25, 2017 10:23 PM UTC</time><a class="anchor" name="1506378198">&nbsp;</a></div><pre>At Wisconsin we tested XRootD over HTTPS again. We have used the latest OSG 3.3 release for el7. The OSG profile for our public redirector is attached.

The following davix-get command fails&#58;

davix-get --debug <a href='https&#58;//pubxrootd.hep.wisc.edu&#58;1094//store/user/dan/test_file' target='_blank' rel='nofollow'>https&#58;//pubxrootd.hep.wisc.edu&#58;1094//store/user/dan/test_file</a> -E /tmp/x509up_u4072 --capath /etc/grid-security/certificates

The failure message is&#58;

(Davix&#58;&#58;HttpRequest) Error&#58; Failure (Neon)&#58; Could not read status line&#58; Connection reset by peer after 3 attempts

---Carl

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=cvuosalo/CN=708697/CN=Carl Vuosalo</pre></div><div class='update_description'><i onclick="document.location='34591#1506133266'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-09-23T02:21:06+00:00">Sep 23, 2017 02:21 AM UTC</time><a class="anchor" name="1506133266">&nbsp;</a></div><pre>Adding Ajit from UW to this ticket also.

Any updates on Marian&#39;s last question?  Can we maybe attach the RPM versions from Wisconsin&#39;s Xrootd host here (and/or run osg-profile)?

Thanks!

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=bbockelm/CN=659869/CN=Brian Paul Bockelman</pre></div><div class='update_description'><i onclick="document.location='34591#1506013224'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-09-21T17:00:24+00:00">Sep 21, 2017 05:00 PM UTC</time> by <b>marian.zvada@....</b><a class="anchor" name="1506013224">&nbsp;</a></div><pre>Great! So was the yum update all that did the trick? I believe it&#39;s been
suggested earlier that &#34;yum update&#34; will be required, at least if you
gonna do node update to OSG3.4 release but with major update like to
xrootd 4.7.0 with lcmaps dependencies on OSG3.3 it certainly is must.

Anyway, good to know it works now and thanks for testing, Bockjoo!

Carl, can you try yum update on your SL7 host, too?

Thanks,
Marian

On 9/21/17 11&#58;24 AM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='34591#1506011050'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-09-21T16:24:10+00:00">Sep 21, 2017 04:24 PM UTC</time> by <b>Bockjoo Kim</b><a class="anchor" name="1506011050">&nbsp;</a></div><pre>After yum update

that updates the entire packages on the machine,

it works!

But I still don&#39;t understand why the checksums are different.

It works for me now.

Thanks,

Bockjoo

On 9/21/17 11&#58;36 AM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='34591#1506008171'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-09-21T15:36:11+00:00">Sep 21, 2017 03:36 PM UTC</time> by <b>marian.zvada@....</b><a class="anchor" name="1506008171">&nbsp;</a></div><pre>Bockjoo,

while trying to hack things may resolve issue at the time it won&#39;t fix
anything for you with coming updates on top it (maybe). It&#39;s never good
practice do what you do now, it&#39;ll mask many things and even more it&#39;ll
harder to debug for us.

That&#39;s why it was much better provide an osg-profile to compare things
thoroughly with the cleanly installed system where things work. The same
I wanted to do for SL7 install Carl did at Wisconsin claiming he has
errors, too.

Let us know what you find out, though.

Thanks,
Marian

On 9/21/17 10&#58;15 AM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='34591#1506006914'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-09-21T15:15:14+00:00">Sep 21, 2017 03:15 PM UTC</time> by <b>Bockjoo Kim</b><a class="anchor" name="1506006914">&nbsp;</a></div><pre>openssl diff was not the problem.

Bockjoo

On 9/21/17 11&#58;12 AM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='34591#1506006736'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-09-21T15:12:16+00:00">Sep 21, 2017 03:12 PM UTC</time> by <b>Bockjoo Kim</b><a class="anchor" name="1506006736">&nbsp;</a></div><pre>Replacing the shared libs in xrootd2 with those in archer did not stop
the error.

Kernel of the two machines is exactly same.

openssl is slightly different&#58;

openssl-1.0.1e-48.sl6_8.4.x86_64 ( xrootd2 )

openssl-1.0.1e-57.el6.x86_64 (archer)

I am updating it and trying it again.
Bockjoo

On 9/21/17 10&#58;57 AM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='34591#1506005833'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-09-21T14:57:13+00:00">Sep 21, 2017 02:57 PM UTC</time> by <b>Bockjoo Kim</b><a class="anchor" name="1506005833">&nbsp;</a></div><pre>I have updated my production xrootd redirector to 4.7.0, but I still
have the error&#58;

Client&#58;

[phedex@phedexb ~]$ xrdcp -d 1 -f
root&#58;//xrootd2.ihepa.ufl.edu//store/mc/test.root /dev/null
[9.107kB/9.107kB][100%][==================================================][9.10[9.107kB/9.107kB][100%][==================================================][9.107kB/s]

[phedex@phedexb ~]$ davix-get -E $X509_USER_PROXY --capath
/etc/grid-security/certificates
<a href='https&#58;//xrootd2.ihepa.ufl.edu&#58;1094//store/mc/test.root' target='_blank' rel='nofollow'>https&#58;//xrootd2.ihepa.ufl.edu&#58;1094//store/mc/test.root</a> ./test.root
(Davix&#58;&#58;HttpRequest) Error&#58; Failure (Neon)&#58; SSL handshake failed&#58; sslv3
alert certificate unknown after 3 attempts

Server&#58;

  err 40&#58;proxy certificates not allowed, please set the appropriate flag
140388976641792&#58;error&#58;140890B2&#58;SSL
routines&#58;SSL3_GET_CLIENT_CERTIFICATE&#58;no certificate returned&#58;s3_srvr.c&#58;3329&#58;
-Error with certificate at depth&#58; 0

However, the redirector I freshly installed earlier in time, there is no
such error.

I compared the shared libs between the working and non-working instances.

These are different&#58;

/usr/lib64/libXrdClient.so*
/usr/lib64/libXrdCl.so*
/usr/lib64/libXrdCmsTfc.so*
/usr/lib64/libXrdCrypto*
/usr/lib64/libXrdLcmaps*
/usr/lib64/libXrdUtils*
<div id='show_1380434157' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_1380434157'>/usr/lib64/libXrdXml*

For example,

[root@xrootd2 lib64]# rpm -qf /usr/lib64/libXrdCrypto* | sort -u
xrootd-libs-4.7.0-1.osg34.el6.x86_64
[root@xrootd2 lib64]#  cksum /usr/lib64/libXrdCrypto*
679344044 9072 /usr/lib64/libXrdCryptoLite.so.1
679344044 9072 /usr/lib64/libXrdCryptoLite.so.1.0.0
3828725223 93280 /usr/lib64/libXrdCrypto.so.1
3828725223 93280 /usr/lib64/libXrdCrypto.so.1.0.0
2025875257 168880 /usr/lib64/libXrdCryptossl-4.so

[root@archer lib64]# rpm -qf /usr/lib64/libXrdCrypto* | sort -u
xrootd-libs-4.7.0-1.osg34.el6.x86_64

[root@archer lib64]# cksum /usr/lib64/libXrdCrypto*
679344044 9072 /usr/lib64/libXrdCryptoLite.so.1
679344044 9072 /usr/lib64/libXrdCryptoLite.so.1.0.0
76283371 95960 /usr/lib64/libXrdCrypto.so.1
76283371 95960 /usr/lib64/libXrdCrypto.so.1.0.0
2025875257 168880 /usr/lib64/libXrdCryptossl-4.so

You can see they have exactly the same version, but the checksums are
different with libXrdCrypto.so.1.0.0.

xrootd2 is the production one that has the error and archer is the
previously/freshly installed redirector.

I will manually copy the shared libs from archer to xrootd2 to see if
that will work.

Bockjoo

On 9/20/17 5&#58;00 PM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font>
</div><script type='text/javascript'>
        $('#show_1380434157').click(function() {
            $('#detail_1380434157').slideDown("normal");
            $('#show_1380434157').hide();
            $('#hide_1380434157').show();
        });
        $('#hide_1380434157').click(function() {
            $('#detail_1380434157').slideUp();
            $('#hide_1380434157').hide();
            $('#show_1380434157').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='34591#1505941240'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-09-20T21:00:40+00:00">Sep 20, 2017 09:00 PM UTC</time> by <b>Bockjoo Kim</b><a class="anchor" name="1505941240">&nbsp;</a></div><pre>Carl tested it on Centos7, too.

I assumed he tested it on SL6.

I have not tested 4.7.0 on SL6 yet.

I will report back after testing it SL6.

Thanks,

Bockjoo

On 9/20/17 4&#58;45 PM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='34591#1505940312'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-09-20T20:45:12+00:00">Sep 20, 2017 08:45 PM UTC</time> by <b>Bockjoo Kim</b><a class="anchor" name="1505940312">&nbsp;</a></div><pre>I think you should contact xroot developer.

We mentioned the errors several times.

UNL has Centos7/RHEL7 as far as I know.

Bockjoo

On 9/20/17 4&#58;37 PM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='34591#1505939863'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-09-20T20:37:43+00:00">Sep 20, 2017 08:37 PM UTC</time><a class="anchor" name="1505939863">&nbsp;</a></div><pre>Bockjoo, Carl,

could you send us osg-profile of hosts where you have installed 4.7.0 and things are failing?
We need to investigate further what is wrong because at UNL we don&#39;t have such issues.

Currently, it&#39;s a mystery and I hope that osg-profile would tell us more.

Thanks,
Marian

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=zvada/CN=684832/CN=Marian Zvada</pre></div><div class='update_description'><i onclick="document.location='34591#1505917993'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-09-20T14:33:13+00:00">Sep 20, 2017 02:33 PM UTC</time> by <b>Bockjoo Kim</b><a class="anchor" name="1505917993">&nbsp;</a></div><pre>Yes. We are still waiting a fix for the issue in xrootd redirector.

4.7.0 did not fix the issue.

Thanks,

Bockjoo

On 09/20/2017 10&#58;17 AM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='34591#1505917025'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-09-20T14:17:05+00:00">Sep 20, 2017 02:17 PM UTC</time> by <b>echism</b><a class="anchor" name="1505917025">&nbsp;</a></div><pre>Is this still ongoing?

Thanks</pre></div><div class='update_description'><i onclick="document.location='34591#1505743611'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-09-18T14:06:51+00:00">Sep 18, 2017 02:06 PM UTC</time> by <b>echism</b><a class="anchor" name="1505743611">&nbsp;</a></div><pre>A lot of this discussion seems to be happening out of band. Are there any updates?

Thanks</pre></div><div class='update_description'><i onclick="document.location='34591#1505320393'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-09-13T16:33:13+00:00">Sep 13, 2017 04:33 PM UTC</time> by <b>Bockjoo Kim</b><a class="anchor" name="1505320393">&nbsp;</a></div><pre>I have the error&#58;

&#34;(Davix&#58;&#58;HttpRequest) Error&#58; Failure (Neon)&#58; Could not read status line&#58;
Connection reset by peer after 3 attempts&#34;

from the client side

and

&#34;pure virtual method called
terminate called without an active exception&#34;

in the xrootd log in the redirector. These are same errors that Carl at 
Wisconsin who

tried 4.7  and he said it did not work for him (See the email quote below).

I am copying to Carl (Wisconsin) in case he has any comment.

Thanks,

Bockjoo

P.S.&#58; email from Carl
&#34;
I did two tests on CentOS 7 on the target data node. First with XrootD
4.6.1 and xrootd-lcmaps-1.3.3 and then with XrootD 4.7.0 and
xrootd-lcmaps-1.3.4 -- the behavior was the same in both cases. When an
HTTPS request is made, there is no crash, but the request fails with&#58;

(Davix&#58;&#58;HttpRequest) Error&#58; Failure (Neon)&#58; Could not read status line&#58;
Connection reset by peer after 3 attempts

Note that the redirector is still XrootD 4.6.1.

<div id='show_159453863' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_159453863'>Concerning the crash under SL6 with XrootD 4.6.1 and
xrootd-lcmaps-1.2.1.1, a stack trace looks like this&#58;

#0  0x000000385f832495 in raise () from /lib64/libc.so.6
#1  0x000000385f833c75 in abort () from /lib64/libc.so.6
#2  0x00000038620bea8d in __gnu_cxx&#58;&#58;__verbose_terminate_handler() ()
from /usr/lib64/libstdc++.so.6
#3  0x00000038620bcbe6 in ?? () from /usr/lib64/libstdc++.so.6
#4  0x00000038620bcc13 in std&#58;&#58;terminate() () from /usr/lib64/libstdc++.so.6
#5  0x00000038620bd56f in __cxa_pure_virtual () from
/usr/lib64/libstdc++.so.6
#6  0x00007f300497fa67 in XrdHttpProtocol&#58;&#58;GetVOMSData(XrdLink*) () from
/usr/lib64/libXrdHttp-4.so
#7  0x00007f30049809a9 in XrdHttpProtocol&#58;&#58;Process(XrdLink*) () from
/usr/lib64/libXrdHttp-4.so
#8  0x00000036d066c829 in XrdLink&#58;&#58;DoIt() () from
/usr/lib64/libXrdUtils.so.2
#9  0x00000036d066f9bb in XrdScheduler&#58;&#58;Run() () from
/usr/lib64/libXrdUtils.so.2
#10 0x00000036d066fb09 in XrdStartWorking(void*) () from
/usr/lib64/libXrdUtils.so.2
#11 0x00000036d062b98f in XrdSysThread_Xeq () from
/usr/lib64/libXrdUtils.so.2
#12 0x0000003860007aa1 in start_thread () from /lib64/libpthread.so.0
#13 0x000000385f8e8bcd in clone () from /lib64/libc.so.6

The XrootD log shows&#58;

pure virtual method called
terminate called without an active exception

---Carl
&#34;
On 9/11/17 3&#58;16 PM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font>
</div><script type='text/javascript'>
        $('#show_159453863').click(function() {
            $('#detail_159453863').slideDown("normal");
            $('#show_159453863').hide();
            $('#hide_159453863').show();
        });
        $('#hide_159453863').click(function() {
            $('#detail_159453863').slideUp();
            $('#hide_159453863').hide();
            $('#show_159453863').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='34591#1505157380'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-09-11T19:16:20+00:00">Sep 11, 2017 07:16 PM UTC</time> by <b>Brian Lin</b><a class="anchor" name="1505157380">&nbsp;</a></div><pre>xrootd-4.7.0 is available in osg-testing for Bockjoo to try.</pre></div><div class='update_description'><i onclick="document.location='34591#1504800348'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-09-07T16:05:48+00:00">Sep 7, 2017 04:05 PM UTC</time> by <b>Kyle Gross</b><a class="anchor" name="1504800348">&nbsp;</a></div><pre>Marian,

Any updates for Bockjoo at this point?

-Kyle</pre></div><div class='update_description'><i onclick="document.location='34591#1504066614'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-08-30T04:16:54+00:00">Aug 30, 2017 04:16 AM UTC</time><a class="anchor" name="1504066614">&nbsp;</a></div><pre>Hi Edgar,

it&#39;s in development now with the exception we&#39;re having trouble with build for el6 in osg3.3. Follow up is in the SW-2874 if interested.

I don&#39;t recommend to Bockoo use this build from development yet, wait until we fix remaining issue and once promoted in *testing* for release it should be good candidate to deploy at FL.

I&#39;ll inform you Bockjoo in this ticket when we&#39;re ready.

Thanks,
Marian

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=zvada/CN=684832/CN=Marian Zvada</pre></div><div class='update_description'><i onclick="document.location='34591#1504024171'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-08-29T16:29:31+00:00">Aug 29, 2017 04:29 PM UTC</time><a class="anchor" name="1504024171">&nbsp;</a></div><pre>Hi Marian,

Please update the ticket when the new xrootd is avaialble in dev.

Thanks,

Edgar
OSG SOftware Support

by /DC=org/DC=opensciencegrid/O=Open Science Grid/OU=People/CN=Edgar Mauricio Fajardo Hernandez 2020</pre></div><div class='update_description'><i onclick="document.location='34591#1503661512'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-08-25T11:45:12+00:00">Aug 25, 2017 11:45 AM UTC</time> by <b>Bockjoo Kim</b><a class="anchor" name="1503661512">&nbsp;</a></div><pre>I forgot to mention that the HTTPS-xrootd worked

with the version 4.5 but then I got greedy and upgraded

the redirector to the xrootd version 4.6 because

I wanted to meet one of the USCMS T2 2017 milestones.

I am trying to downgrade to 4.5version ( the repo is OSG 3.4),

but it says &#34;Nothing to do&#34;. ( yum downgrade xrootd )

Anyway, if I can downgrade it, I can check the HTTPS-xrootd milestone, but

I have to uncheck the xrootd 4.6 milestone.

Thanks,

Bockjoo

On 8/24/17 6&#58;33 PM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='34591#1503613990'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-08-24T22:33:10+00:00">Aug 24, 2017 10:33 PM UTC</time> by <b>bockjoo@....</b><a class="anchor" name="1503613990">&nbsp;</a></div><pre>Hi Marian,

Yes, of course.

Thanks for the effort,

Bockjoo

On 08/24/2017 04&#58;55 PM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='34591#1503608118'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-08-24T20:55:18+00:00">Aug 24, 2017 08:55 PM UTC</time><a class="anchor" name="1503608118">&nbsp;</a></div><pre>I&#39;m working on to get xrootd 4.7.0 for september release which should be ready in development repo early next week. I&#39;d hope we can target this version in order to troubleshoot Bojckoo&#39;s issues further. When 4.7.0 is out I&#39;d encourage Bockjoo update and go from there since I&#39;m unable to recognize where his issues currently sit. Is this acceptable?

Thanks,
Marian

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=zvada/CN=684832/CN=Marian Zvada</pre></div><div class='update_description'><i onclick="document.location='34591#1503596280'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-08-24T17:38:00+00:00">Aug 24, 2017 05:38 PM UTC</time> by <b>Kyle Gross</b><a class="anchor" name="1503596280">&nbsp;</a></div><pre>Has there been any movement on this ticket?

-Kyle</pre></div><div class='update_description'><i onclick="document.location='34591#1503000912'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-08-17T20:15:12+00:00">Aug 17, 2017 08:15 PM UTC</time> by <b>Bockjoo Kim</b><a class="anchor" name="1503000912">&nbsp;</a></div><pre>I never tried the osg-testing repo.

This is the production redirector. I don&#39;t want to break the redirector.

I tried it now, but

[root@xrootd2 ~]# yum upgrade --enablerepo=osg-testing xrootd
Loaded plugins&#58; auto-update-debuginfo, priorities, refresh-packagekit,
security
...

No Packages marked for Update.

Thanks,

Bockjoo

On 8/17/2017 3&#58;39 PM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='34591#1502998775'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-08-17T19:39:35+00:00">Aug 17, 2017 07:39 PM UTC</time><a class="anchor" name="1502998775">&nbsp;</a></div><pre>Hi,

I thought this has been resolved via CMS-T2 list asking Florida update to rpms from osg-testing. I may be wrong, though.
Bockjoo, could you, please, confirm whether this is still an issue?

Thanks,
Marian

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=zvada/CN=684832/CN=Marian Zvada</pre></div><div class='update_description'><i onclick="document.location='34591#1502997805'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-08-17T19:23:25+00:00">Aug 17, 2017 07:23 PM UTC</time> by <b>Kyle Gross</b><a class="anchor" name="1502997805">&nbsp;</a></div><pre>Marian,

Have you been able to look into this, per Tim&#39;s request?

-Kyle</pre></div><div class='update_description'><i onclick="document.location='34591#1502207651'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-08-08T15:54:11+00:00">Aug 8, 2017 03:54 PM UTC</time> by <b>Tim Theisen</b><a class="anchor" name="1502207651">&nbsp;</a></div><pre>Marian,
Can you take a look at this?</pre></div><div class='update_description'><i onclick="document.location='34591#1502133310'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-08-07T19:15:10+00:00">Aug 7, 2017 07:15 PM UTC</time> by <b>Vince Neal</b><a class="anchor" name="1502133310">&nbsp;</a></div><pre>Hi,

I installed and configured HTTPS-xrootd from  the OSG 3.4 repo.

On the xrootd servers, there is no issue, but

on the xrootd redirector, I am seeing this error&#58;
davix-get -E $X509_USER_PROXY  --capath /etc/grid-security/certificates <a href='https&#58;//xrootd2.ihepa.ufl.edu&#58;1094//store/mc/test.root' target='_blank' rel='nofollow'>https&#58;//xrootd2.ihepa.ufl.edu&#58;1094//store/mc/test.root</a> ./test.root
(Davix&#58;&#58;HttpRequest) Error&#58; Failure (Neon)&#58; SSL handshake failed&#58; sslv3 alert certificate unknown after 3 attempts

$X509_USER_PROXY is created using the vomx-proxy-init.

However, if I use usercert.pem, it works with same complain about the certificate being faulty&#58;

[phedex@phedexb ~]$ davix-get -E $usercert --capath /etc/grid-security/certificates <a href='https&#58;//xrootd2.ihepa.ufl.edu&#58;1094//store/mc/test.root' target='_blank' rel='nofollow'>https&#58;//xrootd2.ihepa.ufl.edu&#58;1094//store/mc/test.root</a> ./test.root
(Davix&#58;&#58;OpenSSL) Error&#58; parse PEM private key failed /data1/phedex/.globus/usercert_2017_2018_PHEDEX.pem &#58; error&#58;0906D06C&#58;PEM routines&#58;PEM_read_bio&#58;no start line
(Davix&#58;&#58;OpenSSL) Error&#58; parse PEM private key failed /data1/phedex/.globus/usercert_2017_2018_PHEDEX.pem &#58; error&#58;0906D06C&#58;PEM routines&#58;PEM_read_bio&#58;no start line
Performing Read operation on&#58; <a href='https&#58;//cmsio2.rc.ufl.edu&#58;1094/store/mc/test.root' target='_blank' rel='nofollow'>https&#58;//cmsio2.rc.ufl.edu&#58;1094/store/mc/test.root</a>
[================] 100%     9326B/9326B 0B/s

Moreover, the second execution of the command makes the xrootd redirector crash&#58;

[phedex@phedexb ~]$ davix-get -E $usercert --capath /etc/grid-security/certificates <a href='https&#58;//xrootd2.ihepa.ufl.edu&#58;1094//store/mc/test.root' target='_blank' rel='nofollow'>https&#58;//xrootd2.ihepa.ufl.edu&#58;1094//store/mc/test.root</a> ./test.root
^C
[root@xrootd2 ~]# service xrootd status ; service cmsd status
[default] xrootd dead but pid file exists
[default] cmsd (pid  7833) is running...

( Aug  7 13&#58;58&#58;42 xrootd2 kernel&#58; xrootd[7871]&#58; segfault at 2346450 ip 0000000002346450 sp 00007f3823486b58 error 15 )

I guess there must be some mole in the shared libraries.

The dependent shared libraries of  /usr/lib64/libXrdHttp-4.so&#58;

[root@xrootd2 ~]# ldd  /usr/lib64/libXrdHttp-4.so
<div id='show_1417084042' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_1417084042'>linux-vdso.so.1 =&#62;  (0x00007ffce49f2000)
libXrdServer.so.2 =&#62; /usr/lib64/libXrdServer.so.2 (0x00007fd3988c2000)
libXrdUtils.so.2 =&#62; /usr/lib64/libXrdUtils.so.2 (0x00007fd398630000)
libXrdCrypto.so.1 =&#62; /usr/lib64/libXrdCrypto.so.1 (0x00007fd398412000)
libdl.so.2 =&#62; /lib64/libdl.so.2 (0x00007fd39820e000)
libpthread.so.0 =&#62; /lib64/libpthread.so.0 (0x00007fd397ff1000)
libssl.so.10 =&#62; /usr/lib64/libssl.so.10 (0x00007fd397d84000)
libcrypto.so.10 =&#62; /usr/lib64/libcrypto.so.10 (0x00007fd39799f000)
libstdc++.so.6 =&#62; /usr/lib64/libstdc++.so.6 (0x00007fd397699000)
libm.so.6 =&#62; /lib64/libm.so.6 (0x00007fd397414000)
libgcc_s.so.1 =&#62; /lib64/libgcc_s.so.1 (0x00007fd3971fe000)
libc.so.6 =&#62; /lib64/libc.so.6 (0x00007fd396e6a000)
librt.so.1 =&#62; /lib64/librt.so.1 (0x00007fd396c61000)
/lib64/ld-linux-x86-64.so.2 (0x0000003ee6e00000)
libgssapi_krb5.so.2 =&#62; /lib64/libgssapi_krb5.so.2 (0x00007fd396a1d000)
libkrb5.so.3 =&#62; /lib64/libkrb5.so.3 (0x00007fd396735000)
libcom_err.so.2 =&#62; /lib64/libcom_err.so.2 (0x00007fd396531000)
libk5crypto.so.3 =&#62; /lib64/libk5crypto.so.3 (0x00007fd396305000)
libz.so.1 =&#62; /lib64/libz.so.1 (0x00007fd3960ee000)
libkrb5support.so.0 =&#62; /lib64/libkrb5support.so.0 (0x00007fd395ee3000)
libkeyutils.so.1 =&#62; /lib64/libkeyutils.so.1 (0x00007fd395cdf000)
libresolv.so.2 =&#62; /lib64/libresolv.so.2 (0x00007fd395ac5000)
libselinux.so.1 =&#62; /lib64/libselinux.so.1 (0x00007fd3958a5000)

Is there a known bug with the libXrdHttp-4.so or something that can cause the issue?
Thanks,
Bockjoo

</div><script type='text/javascript'>
        $('#show_1417084042').click(function() {
            $('#detail_1417084042').slideDown("normal");
            $('#show_1417084042').hide();
            $('#hide_1417084042').show();
        });
        $('#hide_1417084042').click(function() {
            $('#detail_1417084042').slideUp();
            $('#hide_1417084042').hide();
            $('#show_1417084042').show();
        });
        </script></pre></div><legend>Similar Recent Tickets <small>modified within the last 30 days</small></legend><div id="similar_tickets"><p class="muted">No similar tickets found.</p></div>
</div>
<script type="text/javascript">
function reset_anchor() {
    $("#updates .selected").removeClass("selected");
    var urls = document.location.toString().split('#'); 
    var anchor = urls[1];
    if(anchor) {
        $("a[name='"+anchor+"']").parents(".update_description").addClass("selected");
    }
}
function submitspam(ticket_id) {
    myret = confirm("Would you like to close this ticket as a security ticket, and submit the ticket content to akismet?");
    if(myret == true) {
        $.ajax("viewer/processspam?id="+ticket_id).done(function() {
            window.location.reload();
        });
    }
}

$(function() {
    reset_anchor();
    var ADDITIONAL_COOKIE_NAME = 'gocticket';
    var options = { path: '/', expires: 365};

    if(window.opener && window.opener.name == "gocticket_list") {
        v = $.cookie("closewindow");
        if(!v) {
            $("#closewindow").attr("checked", "checked"); //on by default
        } else {
            if(v == "checked") {
                $("#closewindow").attr("checked", "checked");
            }
        }
        $("#closewindow").click(function() {
            $.cookie("closewindow", $(this).attr('checked'), options);
        });
    } else {
        $("#closewindow_area").hide();
    }
    function updateTimeago() {
        $("time").timeago();
        setTimeout(updateTimeago, 30*1000);
    }
    updateTimeago();
    $(".description").focus(expand_description);
});
</script>
<hr/>
<footer>
<p>GOC Ticket Version 2.2 | <a href="https://ticket.opensciencegrid.org/goc/submit?app_issue_check=on&amp;app_issue_type=goc&amp;app_goc_url=https%3A%2F%2Fticket.opensciencegrid.org%3A443%2F34591">Report Bugs</a>
 | <a href="https://github.com/opensciencegrid/operations/blob/master/docs/privacy.md">Privacy Policy</a>
</p>

<p> <img align="top" src="images/tag_orange.png"/> Copyright 2018 The Trustees of Indiana University - Developed for Open Science Grid</p>
</footer>


</div><!--container-fluid-->
<script src="https://ticket1.grid.iu.edu:8443/socket.io/socket.io.js"></script>
<script>
var chat = io.connect('https://ticket1.grid.iu.edu:8443');
chat.on('connect', function() {
    chat.emit('authenticate', {nodekey:'', ticketid: 34591});
});
chat.on('peers', function(peers) {
    $("#peers").html("");
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('peer_disconnect', function(pid) {
    $("#peer_"+pid).hide("slow");
});
chat.on('peer_connected', function(peers) {
    //expect only 1 peer connecting, but..
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('submit', function() {
    if(confirm("This ticket was updated. Do you want to refresh?")) {
        history.go(0);
    }
});

function addPeer(pid, peer) {
    var ipinfo = "";
    if(peer.ip != undefined) {
        ipinfo = "<span class=\"ip\">"+peer.ip+"</span>";
    }
    if(chat.io.engine.id == pid) {
        //don't display myself
        return;
    }
    var html = "<li class=\"new\" id=\"peer_"+pid+"\" class=\"peer\">"+peer.name+ipinfo+"</li>";
    $("#peers").prepend(html);
    $("#peers .new").animate({bottom: 0}, 1000, function() {$(this).removeClass("new")});
}

$(function() {
    $("#ticket_form").submit(function() {
        chat.emit('submit');
        return true;
    });
});
</script>
<script>
//used by searchbox
function parseValue(value) {
    var obj = new Object();
    var tokens = value.split("\t");
    obj.str = tokens[0];
    obj.count = tokens[1];
    return obj;
}

$(function() {
    //bootstrap-2.0.4 stuff
    $(".alert-message").alert();
    $(".dropdown-toggle").dropdown();
    $("span[rel='tooltip']").tooltip();
    $("a[rel=popover]").popover();

    //activate menu that user is currently on
    $("#menu_navigator").addClass("active"); 
    $("#submenu_").addClass("active"); 

    //translate zend validation error message to bootstrap
    $(".errors").addClass("alert").addClass("alert-error");

    //enable autocomplete for search box
    $("#search").autocomplete({
        source: function( request, response ) {
            $.ajax({
                url: "search/autocomplete",
                dataType: "text",
                data: {
                    //featureClass: "P",
                    //style: "full",
                    //maxRows: 12,
                    //name_startsWith: request.term
                    q: request.term
                },
                success: function( data ) {
                    response( $.map( data.split("\n"), function( item ) {
                        if(item == "") return null;
                        return {
                            value: item
                        }
                    }));
                }
            });
        },
        select: function(event, ui) {
            document.location = "search?q="+ui.item.value;
        }
    });
    
});
</script>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-69012-13");
pageTracker._trackPageview();
} catch(err) {}
</script>

</body>
