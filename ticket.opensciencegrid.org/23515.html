<!DOCTYPE html>
<html lang="en">
  <head>
  <base href="">
    <title>[23515] Issues with RSV update on OU_OSCER_ATLAS</title>    <meta charset="utf-8" />
    <meta name="verify-v1" content="na5IcAJsZVOfEkboRxuIiZ1zpZgnZiWra+nKcS7nA/o=" />
    <meta name="google-site-verification" content="DLrk3ft4s8b-S2TloLCL2LD_t6wcTjgSluf5pmiu2kA" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />
    <link href="https://ticket.opensciencegrid.org/rss" rel="alternate" type="application/rss+xml" title="GOC Ticket Update feed" />

    <style type="text/css">
      body {
        padding-top: 50px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
     #search {
            width: 300px;
     }

    </style>

<script src="https://code.jquery.com/jquery-3.0.0.js"></script>
<script src="https://code.jquery.com/jquery-migrate-3.0.1.js"></script>

   <link href="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet"/>
    <script src="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/js/bootstrap.min.js"></script>

    <link href="https://netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"/>
    <link href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/themes/smoothness/jquery-ui.min.css" rel="stylesheet"/>
 <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>


    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/js/select2.min.js"></script>

    <link href="css/ticket.css" rel="stylesheet" />
    <script src="lib/jquery.cookie.js"></script>

    <link href="images/tag_orange.png" rel="icon" type="image/png"/>
  </head>

  <body>
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>

            <a class="brand" style="padding: 6px 0px 0px 6px;" href="http://opensciencegrid.org"><img src="images/osglogo.40x30.png"/></a>
            <ul class="nav">
                <li class="dropdown"><a href="https://ticket.opensciencegrid.org/#" class="dropdown-toggle" data-toggle="dropdown">GOC Ticket <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    <li><a href="https://my.opensciencegrid.org">MyOSG</a></li>
                    <li><a href="https://oim.opensciencegrid.org">OIM</a></li>
                    <li class="active"><a href="https://ticket.opensciencegrid.org/index">Ticket</a></li>
	<li class="divider"></li>
	<li><a href="http://repo.grid.iu.edu">Repo</a></li>
	<li class="divider"></li>
	<li><a href="http://blogs.grid.iu.edu">Blog</a></li>
                    <li><a href="http://display.grid.iu.edu">Display</a></li>
                    <li><a href="http://osggoc.blogspot.com/">News</a></li>
                    </ul>
                </li>
            </ul>
            <ul class="nav pull-right">
                <li><a href="https://ticket.opensciencegrid.org/sso/">Login</a></li>            </ul>

            <div class="nav-collapse">
                <ul class="nav">
			 <li id="menu_submit"><a href="https://ticket.opensciencegrid.org/submit">Submit</a></li><li id="menu_view" class="dropdown"><a href="https://ticket.opensciencegrid.org/\#" class="dropdown-toggle" data-toggle="dropdown">View <b class="caret"></b></a><ul class="dropdown-menu"><li id="submenu_listopen"><a href="https://ticket.opensciencegrid.org/list/open">Open Tickets</a></li><li id="submenu_listrecentclose"><a href="https://ticket.opensciencegrid.org/list/recentclose">Recently Closed Tickets</a></li><li class="divider"></li><li id="submenu_alltickets"><a href="https://ticket.opensciencegrid.org/search?q=&amp;sort=id">All Tickets</a></li></ul></li>                </ul>

                <form class="navbar-search pull-right" action="https://ticket.opensciencegrid.org/viewer">
                    <input id="search" type="text" name="id" class="search-query span2" placeholder="Search Ticket" value=""/>
                </form>
            </div>
        </div>
      </div>
    </div>

<script type='text/javascript' src='lib/jquery.timeago.js'></script>
<script type='text/javascript' src='lib/byte2size.js'></script>
<style>
#updates .toolbar {
position: relative;
margin-top: 0px;
top: -10px;
font-weight: normal;
}
#updates a.anchor {
position: relative;
top: -50px;
}
#updates .selected pre {
animation:selected 2s;
animation-iteration-count: 2;
animation-direction: alternate;
-webkit-animation:selected 2s; 
-webkit-animation-iteration-count: 2;
-webkit-animation-direction: alternate;
box-shadow: inset 1px 1px 20px #9ad;
border: 1px solid #9ab;
margin: 5px 0px;
padding-left: 10px;
}
@keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ab;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
@-webkit-keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ad;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
#updates pre {
background-color: inherit;
line-height: 15px;
padding: 5px;
}
#updates .header {
color: #999;
}
#updates .update_history pre {
background-color: #eee;
color: #666;
font-size: 85%;
}
#updates .clickable {
cursor: pointer;
}
#updates .clickable:hover {
color: #D98719;
}
#updates .meta_information pre {
background-color: #fed;
}
#similar_tickets {
max-height: 300px;
overflow-y: auto;
pointer-events: none;
padding: 5px;
background-color: #f4f4f4;
}
.btn-toolbar {
margin-bottom: 0;
height: 30px;
}
#peers {
position: fixed;
bottom: 0px;
right: 0px;
z-index: 100;
list-style: none;
padding: 5px 0px 0px 5px;
margin: 0px;
background-color: white;
box-shadow: 0px 0px 10px white;
}
#peers li {
background-color: #ccc;
color: #000;
display: inline-block;
padding: 5px 10px;
margin-right: 5px;
position: relative;
}
/*
#peers li:hover {
background-color: #999;
cursor: pointer;
}
*/
#peers span.ip {
padding-left: 5px;
color: #666;
}
#peers .new {
bottom: -30px;
}
/*
#peers .me {
background-color: red;
}
*/
</style>

<div class="container-fluid">
<ul id="peers"></ul>
<div class="alert alert-danger"><a class="close" href="https://ticket.opensciencegrid.org/#" data-dismiss="alert">&times;</a>By the end of May 2018, the ticketing system at https://ticket.opensciencegrid.org will be retired and support will be provided at https://support.opensciencegrid.org. Throughout this transition the support email (help@opensciencegrid.org) will be available as a point of contact.<br><br>                                                   
                                                                                                                                                                                   
Please see the service migration page for details: https://opensciencegrid.github.io/technology/policy/service-migrations-spring-2018/#ticket</div><div id="presence" class="pull-right"></div><div class="ticketgui"><script type="text/javascript" src="lib/checktab.js"></script>

<script>
var expanded = false;
function expand_description() {
    var desc = $(".description");
    if(!expanded) {
        expanded = true;
        //expand to minheight
        var min = 250;
        if(desc.height() < min) {
            desc.animate({height: min}, 200);
        }
    }
}

$(document).ready(function() {
    $("input[name='nad']").datepicker({
        dateFormat: 'yy-mm-dd'
    });
});

</script>



<style>
.form-horizontal .control-label {
padding-top: inherit;
font-size:90%;
color:#666;
}
label {
margin-bottom: 0px;
}
.controls {
line-height: 18px;
}
</style>
<form class="form-horizontal" action="https://ticket.opensciencegrid.org/viewer/updatebasic?id=23515" method="post">
<div class="page-header">
    <h3><span class="muted">23515</span> / Issues with RSV update on OU_OSCER_ATLAS</h3>
</div>

<div class="row-fluid">
<div class="span5">
    <legend>Contact</legend>
    <div class="control-group">
        <label class="control-label">Full Name</label>
        <div class="controls">Horst Severini</div>
    </div>
    <div class="control-group">
        <label class="control-label">Email</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">Phone</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">CC</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>

    <legend>Details</legend>
    <div class="control-group"><label class="control-label">Resource Name</label><div class="controls">OU_OSCER_ATLAS</div></div><div class="control-group"><label class="control-label">Associated VO</label><div class="controls">DOSAR</div></div><div class="control-group"><label class="control-label">Submitted Via</label><div class="controls">GOC Ticket/submit</div></div><div class="control-group"><label class="control-label">Submitter</label><div class="controls">Horst Severini</div></div><div class="control-group"><label class="control-label">Support Center</label><div class="controls">USATLAS</div></div>
    <div class="control-group">
        <label class="control-label">Ticket Type</label>
        <div class="controls">Problem/Request</div>
    </div>
    <div class="control-group">
        <label class="control-label">Priority</label>
        <div class="controls">Normal</div>
    </div>
    <div class="control-group">
        <label class="control-label">Status</label>
        <div class="controls">
Closed</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action</label>
        <div class="controls">WIP</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action Deadline</label>
        <div class="controls flag_red">2014-12-19</div>
    </div>

</div><!--span-->
<div class="span7">
    <legend>Assignees</legend>
    <div class="assignee" style="width: 60%">USATLAS (BNL Prod)&nbsp;<a target="_blank" href="https://rt.racf.bnl.gov/rt/Ticket/Display.html?id=25004">25004</a> <span class="muted"> / Ticket Exchange</span></div><div class="assignee" style="width: 60%">Software Support (Triage) <span class="muted"> / OSG Software Team</span></div><div class="assignee" style="width: 60%">Matyas Selmeci <span class="muted"> / OSG Software Team</span></div>    <br>

    <legend>Assignees</legend>
    TODO
    <br>

    <style>
legend.noborder {
border-bottom: none;
}
</style>

<div id="attachment-list"/>
<script>
$(function () {
    var first = true;
    $.getJSON("attachment/list/23515", function (files) {
        //console.dir(files);
        var html = "<table class=\"table table-condensed\">";
        $(files).each(function() {
            if(first) {
                first = false;
                html += "<legend class=\"noborder\">Attachmenets</legend>";
            }
            html += "<tr class=\"attachment\">";
            html += "<td><img src=\""+this.thumbnail_url+"\"/></td>";
            html += "<td><a href=\""+this.url+"\" target=\"_blank\">"+this.name+"</a></td>";
            html += "<td>"+bytesToSize(this.size, 1)+"</td>";
            html += "</tr>";
        });
        html += "</table>";
        $("#attachment-list").html(html);
    });
});

function download(url) {
    window.open(url, "_blank");
}
</script>


</div><!--span-->
</div><!--row-fluid-->


</form>

</div>
<div id="updates" style="clear: both;">
    <legend>Past Updates
    <div class="btn-toolbar pull-right toolbar">
    </div><!--btn-toolbar-->
    </legend>

    <div class='update_description'><i onclick="document.location='23515#1419026450'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-12-19T22:00:50+00:00">Dec 19, 2014 10:00 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1419026450">&nbsp;</a></div><pre>Well,

I guess I&#39;ll go ahead and close this ticket from the BNL RT side -- just
because I can. &#58;)

Thanks again,
happy holidays,

Horst
-- by hs@.... at Fri Dec 19 22&#58;00&#58;28 UTC 2014

GOCTX Source&#58; BNL Ticket&#58; Queue=SWTier2 ID=25004</pre></div><div class='update_description'><i onclick="document.location='23515#1419021792'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-12-19T20:43:12+00:00">Dec 19, 2014 08:43 PM UTC</time> by <b>Horst Severini</b><a class="anchor" name="1419021792">&nbsp;</a></div><pre>Hi Mat,

yes, the error is still there on OU_OSCER_ATLAS&#58;

<a href='https&#58;//grid1.oscer.ou.edu/rsv/grid1.oscer.ou.edu.html#org.osg.certificates.crl-expiry' target='_blank' rel='nofollow'>https&#58;//grid1.oscer.ou.edu/rsv/grid1.oscer.ou.edu.html#org.osg.certificates.crl-expiry</a>

But wait -- I just figured out why. Apparently when the OSCER admins
updated the OSG stack last week, they must&#39;ve done so from a not
completely up-to-date mirror they&#39;re keeping somewhere, since we&#39;re now
running

osg-version-3.1.37-1.osg31.el6.noarch
rsv-3.7.16-1.osg31.el6.noarch
rsv-consumers-3.7.16-1.osg31.el6.noarch
rsv-core-3.7.16-1.osg31.el6.noarch
rsv-metrics-3.7.16-1.osg31.el6.noarch

and you said that this error wasn&#39;t fixed till rsv-metrics 3.7.19 in
osg-version 3.1.40. So that answers that mystery. &#58;)

I&#39;ll talk to them about that, but that&#39;s not an immediate issue as far
as I&#39;m concerned.

So I think you can close this ticket again now!

Thanks a lot,
have a great weekend,
and happy holidays,

Horst

On 12/19/2014 02&#58;24 PM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='23515#1419020677'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-12-19T20:24:37+00:00">Dec 19, 2014 08:24 PM UTC</time> by <b>Matyas Selmeci</b><a class="anchor" name="1419020677">&nbsp;</a></div><pre>Hi Horst,

I don&#39;t see &#39;unexpected error condition&#39; errors at those links anymore. As far as the CAs and CRLs being out of sync, I think that&#39;s an issue with those individual CAs -- AustrianGrid&#39;s broken for me too and HIAST (hashes bb01cea1 and 74c6eaeb) is very frequently down.

I&#39;ll get in touch with the security team about those -- maybe I can add some sort of ignore list for those RSV probes. For now you can ignore the errors.

-Mat</pre></div><div class='update_description'><i onclick="document.location='23515#1418924055'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-12-18T17:34:15+00:00">Dec 18, 2014 05:34 PM UTC</time> by <b>Horst Severini</b><a class="anchor" name="1418924055">&nbsp;</a></div><pre>Hi again,

I noticed that besides org.osg.certificates.crl-expiry still throwing
this &#39;unexpected error condition&#39;, org.osg.certificates.cacert-expiry
is now also CRITICAL with this error at

<a href='https&#58;//grid1.oscer.ou.edu/rsv/' target='_blank' rel='nofollow'>https&#58;//grid1.oscer.ou.edu/rsv/</a>

----
detailsData&#58; CRITICAL&#58; Some of the files in your installations are out of sync with the OSG distribution.
The CA that are out of sync are&#58; [&#39;AustrianGrid&#39;]
Please ensure that your CA update process (e.g. osg-update-certs or yum update) is configured and running
----

We do have the latest osg-ca-certs-updater-0.5-1.osg.el6.noarch installed
and running, though, so I&#39;m not sure why that isn&#39;t doing its job
and bringing everything in sync.

The same error or warning also happens on some of our other sites,
where we also have everything up to date and the updater running&#58;

<a href='https&#58;//osgitb1.nhn.ou.edu/rsv/' target='_blank' rel='nofollow'>https&#58;//osgitb1.nhn.ou.edu/rsv/</a>
<a href='https&#58;//lutgw1.lunet.edu/rsv/' target='_blank' rel='nofollow'>https&#58;//lutgw1.lunet.edu/rsv/</a>

The only one where it doesn&#39;t happen is here&#58;

<a href='https&#58;//ouhep0.nhn.ou.edu&#58;8443/rsv/' target='_blank' rel='nofollow'>https&#58;//ouhep0.nhn.ou.edu&#58;8443/rsv/</a>

And I have no idea what would be different there, since it was installed
and configured the same way as all the others. Any ideas?

Thanks a lot,

Horst

<div id='show_815604401' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_815604401'>Horst Severini &#60;hs@....&#62; wrote&#58;

<font color='#7F7E6F'>&#62; Hi Mat,</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; well, we did update to rsv-metrics-3.7.20 last week, yet we&#39;re still</font>
<font color='#7F7E6F'>&#62; seeing this &#39;unexpected error condition&#39; here&#58;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; <a href='https&#58;//grid1.oscer.ou.edu/rsv/' target='_blank' rel='nofollow'>https&#58;//grid1.oscer.ou.edu/rsv/</a></font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; So somehow the update doesn&#39;t seem to have taken effect, even though we</font>
<font color='#7F7E6F'>&#62; ran osg-configure and restarted both RSV and Condor-Cron. So I&#39;m not</font>
<font color='#7F7E6F'>&#62; sure what might be missing here. Can you tell use which part of the code</font>
<font color='#7F7E6F'>&#62; contains the fix? Then maybe we can figure out why it hasn&#39;t been updated.</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; I looked for .rpmnew files yesterday, but didn&#39;t find anything obvious.</font>
<font color='#7F7E6F'>&#62; Can&#39;t check right now, since the cluster is down for maintenance today,</font>
<font color='#7F7E6F'>&#62; so I can&#39;t log in. But if you tell me which file to look for, I&#39;ll do</font>
<font color='#7F7E6F'>&#62; that tonight or tomorrow!</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; Thanks a lot,</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; 	Horst</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; On 12/17/2014 02&#58;51 PM, Open Science Grid FootPrints wrote&#58;</font>
<font color='#7F7E6F'>&#62; &#62; [Duplicate message snipped]</font>
</div><script type='text/javascript'>
        $('#show_815604401').click(function() {
            $('#detail_815604401').slideDown("normal");
            $('#show_815604401').hide();
            $('#hide_815604401').show();
        });
        $('#hide_815604401').click(function() {
            $('#detail_815604401').slideUp();
            $('#hide_815604401').hide();
            $('#show_815604401').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='23515#1418850389'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-12-17T21:06:29+00:00">Dec 17, 2014 09:06 PM UTC</time> by <b>Horst Severini</b><a class="anchor" name="1418850389">&nbsp;</a></div><pre>Hi Mat,

well, we did update to rsv-metrics-3.7.20 last week, yet we&#39;re still
seeing this &#39;unexpected error condition&#39; here&#58;

<a href='https&#58;//grid1.oscer.ou.edu/rsv/' target='_blank' rel='nofollow'>https&#58;//grid1.oscer.ou.edu/rsv/</a>

So somehow the update doesn&#39;t seem to have taken effect, even though we
ran osg-configure and restarted both RSV and Condor-Cron. So I&#39;m not
sure what might be missing here. Can you tell use which part of the code
contains the fix? Then maybe we can figure out why it hasn&#39;t been updated.

I looked for .rpmnew files yesterday, but didn&#39;t find anything obvious.
Can&#39;t check right now, since the cluster is down for maintenance today,
so I can&#39;t log in. But if you tell me which file to look for, I&#39;ll do
that tonight or tomorrow!

Thanks a lot,

Horst

On 12/17/2014 02&#58;51 PM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='23515#1418849515'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-12-17T20:51:55+00:00">Dec 17, 2014 08:51 PM UTC</time> by <b>Matyas Selmeci</b><a class="anchor" name="1418849515">&nbsp;</a></div><pre>The CRL expiry probe issue was fixed in rsv-metrics 3.7.19, which was in the October releases (3.1.40 and 3.2.16) (<a href='https&#58;//jira.opensciencegrid.org/browse/SOFTWARE-1618' target='_blank' rel='nofollow'>https&#58;//jira.opensciencegrid.org/browse/SOFTWARE-1618</a>). The osg-configure changes were released in the 3.1.33 and 3.2.9 releases (<a href='https&#58;//jira.opensciencegrid.org/browse/SOFTWARE-1446' target='_blank' rel='nofollow'>https&#58;//jira.opensciencegrid.org/browse/SOFTWARE-1446</a>). I don&#39;t see anything in the release notes about making the manual changes (other than the usual &#34;look for .rpmnew and .rpmsave files after upgrade&#34; paragraph). I&#39;ll see where we can get this documented.

-Mat</pre></div><div class='update_description'><i onclick="document.location='23515#1418846051'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-12-17T19:54:11+00:00">Dec 17, 2014 07:54 PM UTC</time> by <b>Horst Severini</b><a class="anchor" name="1418846051">&nbsp;</a></div><pre>Hi Mat,

ah, I see -- so I guess there&#39;s just no way to update to this new
version (or whatever version it was which introduced the 10-gateway.ini
file, I can&#39;t remember now) without manual intervention? That&#39;s too bad,
but what can you do ...

Was there a special note sent out about this, or is it documented in
detail on the relevant TWiki page? I can&#39;t remember that now, either,
and I haven&#39;t looked too closely, since I now have a way around it, but
I think there should be something written somewhere to alert people that
manual intervention is required, because for most updates, it
*thankfully* isn&#39;t! &#58;)

I think Vince was talking more about my questions about the
org.osg.certificates.crl-expiry probe, by the way. ;)

Thanks a lot,

Horst

On 12/17/2014 11&#58;29 AM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='23515#1418837349'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-12-17T17:29:09+00:00">Dec 17, 2014 05:29 PM UTC</time> by <b>Matyas Selmeci</b><a class="anchor" name="1418837349">&nbsp;</a></div><pre>Hi Horst,

The majority of RSV probes are for either kind of gateway, but there are a
handful that are specific to one or the other.  The GRAM-specific probes are
turned on for the hosts in gram_ce_hosts (but only if gram_gateway_enabled is
True); the HTCondor-CE-specific probes are turned on for the hosts in
htcondor_ce_hosts (but only if htcondor_gateway_enabled in True).  I can&#39;t fill
in gram_ce_hosts or htcondor_ce_hosts from ce_hosts, because that might result
in GRAM-specific probes running against HTCondor-CE gateways (or vice versa),
leading to probe failures.

The probes that work for either gateway are enabled for hosts listed in
ce_hosts.  They are _not_ implicitly enabled for hosts listed in gram_ce_hosts
or htcondor_ce_hosts, though in retrospect, that may have been the wrong
design.  The default config ships with the line
ce_hosts = %(gram_ce_hosts)s,%(htcondor_ce_hosts)s
but of course that does not help for upgrades.

-Mat</pre></div><div class='update_description'><i onclick="document.location='23515#1418829834'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-12-17T15:23:54+00:00">Dec 17, 2014 03:23 PM UTC</time> by <b>Brian Lin</b><a class="anchor" name="1418829834">&nbsp;</a></div><pre>Mat, can you take a look at Horst&#39;s questions?</pre></div><div class='update_description'><i onclick="document.location='23515#1418772249'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-12-16T23:24:09+00:00">Dec 16, 2014 11:24 PM UTC</time> by <b>Horst Severini</b><a class="anchor" name="1418772249">&nbsp;</a></div><pre>Hi Vince,

yes, I saw the &#39;Gateway&#39; section, but that is turned on by default,
right? So are you saying that if we were going to disable
gram_gateway_enabled, then we wouldn&#39;t need to set gram_ce_hosts, and
having ce_hosts set -- as it has been -- would be enough to keep these
two probes enabled?

If that&#39;s true, than maybe this should come as disabled when
osg-configure-gateway is first installed during an update, such that the
update would be transparent to the user -- well, admin -- such that it
won&#39;t break an existing installation, and then when a site switches over
to the HTCondor-CE, they should enable that by hand, since that requires
a manual intervention, anyway? Or is it not that simple?

Thanks for adding the software team to the other issue!

Cheers,

Horst

On 12/16/2014 04&#58;37 PM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='23515#1418769754'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-12-16T22:42:34+00:00">Dec 16, 2014 10:42 PM UTC</time> by <b>Vince Neal</b><a class="anchor" name="1418769754">&nbsp;</a></div><pre>Software Team,

Host has a couple of questions below that I can&#39;t find an answer for that I&#39;m hoping you can assist with.
As always, your assistance is greatly appreciated.

I believe I have copy/paste/paraphrased accurately&#58;

~~~~~~~~~~
Also, I noticed that org.osg.certificates.crl-expiry still reports
&#39;Probe ended with unexpected error condition&#39;, which I thought
was fixed in the latest version -- at least it no longer shows up
in our other CEs with updated RSV RPMs, so why does it still show up here?
The others still show CRITICAL, like this one does, but that misleading
&#39;unexpected error condition&#39; is gone.

~~~~~~~~~
In what piece of code was this update done, and why didn&#39;t it get
propagated on this CE? Maybe it has something to do with an .rpmnew file
which has been written, but is not being used because the original one
is still being used?

I see /etc/rsv/rsv.conf.rpmnew, but that doesn&#39;t seem to contain anything
that isn&#39;t already in rsv.conf. Some place else may

Horst, please let me know if I missed anything.

Thanks!
Vince</pre></div><div class='update_description'><i onclick="document.location='23515#1418769456'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-12-16T22:37:36+00:00">Dec 16, 2014 10:37 PM UTC</time> by <b>Vince Neal</b><a class="anchor" name="1418769456">&nbsp;</a></div><pre>Awesome news!

From what I could find it appears that gram_ce_hosts is required to be set if gram_gateway_enabled in the Gateway configuration section is True&#58; (/etc/osg/config.d/30-rsv.ini.)
<a href='https&#58;//twiki.opensciencegrid.org/bin/view/Documentation/Release3/IniConfigurationOptions#RSV' target='_blank' rel='nofollow'>https&#58;//twiki.opensciencegrid.org/bin/view/Documentation/Release3/IniConfigurationOptions#RSV</a>

As for the specifics of the update and the issue with org.osg.certificates.crl-expiry I&#39;ll add the Software Team so they can assist.

Thanks!
Vince</pre></div><div class='update_description'><i onclick="document.location='23515#1418753352'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-12-16T18:09:12+00:00">Dec 16, 2014 06:09 PM UTC</time> by <b>Horst Severini</b><a class="anchor" name="1418753352">&nbsp;</a></div><pre>Hi Vince,

thanks for your pointers, I found a solution!
I still don&#39;t fully understand it, but at least I found a way around it,
and it works again now.

What I had to do was to add

gram_ce_hosts = %(localhost)s

to the RSV section in config.d, and then re-run osg-configure, and restart
the rsv and condor-cron services. Here&#39;s the output of rsv-control --verify
before and after&#58;

----
[hs@grid1 ~]$ sudo rsv-control --verify
Testing if Condor-Cron is running...
OK

Testing if metrics are running...
OK (12 running metrics)

Testing if consumers are running...
OK (2 running consumers)

Checking which consumers are configured...
The following consumers are enabled&#58; html-consumer gratia-consumer
----
[hs@grid1 ~]$ sudo rsv-control --verify
Testing if Condor-Cron is running...
OK

Testing if metrics are running...
OK (14 running metrics)

<div id='show_1702611729' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_1702611729'>Testing if consumers are running...
OK (2 running consumers)

Checking which consumers are configured...
The following consumers are enabled&#58; html-consumer gratia-consumer
----

The question is, why did that break during the update?
I guess gram_ce_hosts is a new variable which needs to be configured
by hand the first time around? Is there no way to automate that
based on ce_hosts?

Oh, and I still don&#39;t understand why the org.osg.certificates.crl-expiry probe
still reports the &#39;unexpected error condition&#39;. All our other updated CEs
don&#39;t show that anymore, they show instead this&#58;

----
detailsData&#58; CRITICAL&#58; 102 CRLs tested.
1 had not been updated for at least 72 hours;
2 CRLs have not been updated for at least 9 hours;
99 CRLs have been updated with the last 9 hours.
----

In what piece of code was this update done, and why didn&#39;t it get
propagated on this CE? Maybe it has something to do with an .rpmnew file
which has been written, but is not being used because the original one
is still being used?

I see /etc/rsv/rsv.conf.rpmnew, but that doesn&#39;t seem to contain anything
that isn&#39;t already in rsv.conf. Some place else maybe?

Thanks a lot,

Horst

Open Science Grid FootPrints &#60;osg@....&#62; wrote&#58;

<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font>
</div><script type='text/javascript'>
        $('#show_1702611729').click(function() {
            $('#detail_1702611729').slideDown("normal");
            $('#show_1702611729').hide();
            $('#hide_1702611729').show();
        });
        $('#hide_1702611729').click(function() {
            $('#detail_1702611729').slideUp();
            $('#hide_1702611729').hide();
            $('#show_1702611729').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='23515#1418749654'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-12-16T17:07:34+00:00">Dec 16, 2014 05:07 PM UTC</time> by <b>Vince Neal</b><a class="anchor" name="1418749654">&nbsp;</a></div><pre>Hi Horst,

Couple of documents regarding RSV configuration and RsvControl&#58;

<a href='https&#58;//twiki.opensciencegrid.org/bin/view/Documentation/Release3/InstallRSV' target='_blank' rel='nofollow'>https&#58;//twiki.opensciencegrid.org/bin/view/Documentation/Release3/InstallRSV</a>
<a href='https&#58;//twiki.opensciencegrid.org/bin/view/Documentation/Release3/ConfigureRsv' target='_blank' rel='nofollow'>https&#58;//twiki.opensciencegrid.org/bin/view/Documentation/Release3/ConfigureRsv</a>
<a href='https&#58;//twiki.opensciencegrid.org/bin/view/Documentation/Release3/RsvControl' target='_blank' rel='nofollow'>https&#58;//twiki.opensciencegrid.org/bin/view/Documentation/Release3/RsvControl</a>

Important file locations&#58;
<a href='https&#58;//twiki.opensciencegrid.org/bin/view/Documentation/Release3/InstallRSV#Important_files_locations' target='_blank' rel='nofollow'>https&#58;//twiki.opensciencegrid.org/bin/view/Documentation/Release3/InstallRSV#Important_files_locations</a>

Can you post the output of &#34;rsv-control --verify&#34;?

Thanks!
Vince</pre></div><div class='update_description'><i onclick="document.location='23515#1418748749'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-12-16T16:52:29+00:00">Dec 16, 2014 04:52 PM UTC</time> by <b>Vince Neal</b><a class="anchor" name="1418748749">&nbsp;</a></div><pre>Hi all,

we updated OU_OSCER_ATLAS (grid1.oscer.ou.edu) to the latest RSV version
on Saturday, rsv-3.7.16-1.osg31.el6, and now two metrics are no longer
enabled, and we&#39;re not sure why that happened.

<a href='https&#58;//grid1.oscer.ou.edu/rsv/' target='_blank' rel='nofollow'>https&#58;//grid1.oscer.ou.edu/rsv/</a>

shows org.osg.batch.jobmanagers-available and org.osg.globus.gram-authentication
as no longer running. Any ideas why/how that happened, and how to fix it?

As far as we know, we didn&#39;t change anything in the configuration,
but just updated the RPMs. Which config files do we need to look at
to track this down? Sorry, RSV is still pretty much a black box to me.
Most of the time it works fine, but when it doesn&#39;t, I&#39;m pretty much
lost. &#58;)

Also, I noticed that org.osg.certificates.crl-expiry still reports
&#39;Probe ended with unexpected error condition&#39;, which I thought
was fixed in the latest version -- at least it no longer shows up
in our other CEs with updated RSV RPMs, so why does it still show up here?
The others still show CRITICAL, like this one does, but that misleading
&#39;unexpected error condition&#39; is gone.

I restarted the services rsv and condor-cron several times, and ran
&#39;osg-configure -c&#39; and &#39;rsv-control --run --all-enabled&#39;, but that
didn&#39;t seem to change anything.

Thanks a lot,

Horst</pre></div>
</div>
<script type="text/javascript">
function reset_anchor() {
    $("#updates .selected").removeClass("selected");
    var urls = document.location.toString().split('#'); 
    var anchor = urls[1];
    if(anchor) {
        $("a[name='"+anchor+"']").parents(".update_description").addClass("selected");
    }
}
function submitspam(ticket_id) {
    myret = confirm("Would you like to close this ticket as a security ticket, and submit the ticket content to akismet?");
    if(myret == true) {
        $.ajax("viewer/processspam?id="+ticket_id).done(function() {
            window.location.reload();
        });
    }
}

$(function() {
    reset_anchor();
    var ADDITIONAL_COOKIE_NAME = 'gocticket';
    var options = { path: '/', expires: 365};

    if(window.opener && window.opener.name == "gocticket_list") {
        v = $.cookie("closewindow");
        if(!v) {
            $("#closewindow").attr("checked", "checked"); //on by default
        } else {
            if(v == "checked") {
                $("#closewindow").attr("checked", "checked");
            }
        }
        $("#closewindow").click(function() {
            $.cookie("closewindow", $(this).attr('checked'), options);
        });
    } else {
        $("#closewindow_area").hide();
    }
    function updateTimeago() {
        $("time").timeago();
        setTimeout(updateTimeago, 30*1000);
    }
    updateTimeago();
    $(".description").focus(expand_description);
});
</script>
<hr/>
<footer>
<p>GOC Ticket Version 2.2 | <a href="https://ticket.opensciencegrid.org/goc/submit?app_issue_check=on&amp;app_issue_type=goc&amp;app_goc_url=https%3A%2F%2Fticket.opensciencegrid.org%3A443%2F23515">Report Bugs</a>
 | <a href="https://github.com/opensciencegrid/operations/blob/master/docs/privacy.md">Privacy Policy</a>
</p>

<p> <img align="top" src="images/tag_orange.png"/> Copyright 2018 The Trustees of Indiana University - Developed for Open Science Grid</p>
</footer>


</div><!--container-fluid-->
<script>
//used by searchbox
function parseValue(value) {
    var obj = new Object();
    var tokens = value.split("\t");
    obj.str = tokens[0];
    obj.count = tokens[1];
    return obj;
}

$(function() {
    //bootstrap-2.0.4 stuff
    $(".alert-message").alert();
    $(".dropdown-toggle").dropdown();
    $("span[rel='tooltip']").tooltip();
    $("a[rel=popover]").popover();

    //activate menu that user is currently on
    $("#menu_navigator").addClass("active"); 
    $("#submenu_").addClass("active"); 

    //translate zend validation error message to bootstrap
    $(".errors").addClass("alert").addClass("alert-error");

    //enable autocomplete for search box
    $("#search").autocomplete({
        source: function( request, response ) {
            $.ajax({
                url: "search/autocomplete",
                dataType: "text",
                data: {
                    //featureClass: "P",
                    //style: "full",
                    //maxRows: 12,
                    //name_startsWith: request.term
                    q: request.term
                },
                success: function( data ) {
                    response( $.map( data.split("\n"), function( item ) {
                        if(item == "") return null;
                        return {
                            value: item
                        }
                    }));
                }
            });
        },
        select: function(event, ui) {
            document.location = "search?q="+ui.item.value;
        }
    });
    
});
</script>


</body>
