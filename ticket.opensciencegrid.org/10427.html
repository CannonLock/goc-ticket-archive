<!DOCTYPE html>
<html lang="en">
  <head>
  <base href="">
    <title>[10427] OSG cert-retrieve script&#58; scripted retrieval of certificates</title>    <meta charset="utf-8" />
    <meta name="verify-v1" content="na5IcAJsZVOfEkboRxuIiZ1zpZgnZiWra+nKcS7nA/o=" />
    <meta name="google-site-verification" content="DLrk3ft4s8b-S2TloLCL2LD_t6wcTjgSluf5pmiu2kA" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />
    <link href="https://ticket.opensciencegrid.org/rss" rel="alternate" type="application/rss+xml" title="GOC Ticket Update feed" />

    <style type="text/css">
      body {
        padding-top: 50px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
     #search {
            width: 300px;
     }

    </style>

<script src="https://code.jquery.com/jquery-3.0.0.js"></script>
<script src="https://code.jquery.com/jquery-migrate-3.0.1.js"></script>

   <link href="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet"/>
    <script src="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/js/bootstrap.min.js"></script>

    <link href="https://netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"/>
    <link href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/themes/smoothness/jquery-ui.min.css" rel="stylesheet"/>
 <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>


    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/js/select2.min.js"></script>

    <link href="css/ticket.css" rel="stylesheet" />
    <script src="lib/jquery.cookie.js"></script>

    <link href="images/tag_orange.png" rel="icon" type="image/png"/>
  </head>

  <body>
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>

            <a class="brand" style="padding: 6px 0px 0px 6px;" href="http://opensciencegrid.org"><img src="images/osglogo.40x30.png"/></a>
            <ul class="nav">
                <li class="dropdown"><a href="https://ticket.opensciencegrid.org/#" class="dropdown-toggle" data-toggle="dropdown">GOC Ticket <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    <li><a href="https://my.opensciencegrid.org">MyOSG</a></li>
                    <li><a href="https://oim.opensciencegrid.org">OIM</a></li>
                    <li class="active"><a href="https://ticket.opensciencegrid.org/index">Ticket</a></li>
	<li class="divider"></li>
	<li><a href="http://repo.grid.iu.edu">Repo</a></li>
	<li class="divider"></li>
	<li><a href="http://blogs.grid.iu.edu">Blog</a></li>
                    <li><a href="http://display.grid.iu.edu">Display</a></li>
                    <li><a href="http://osggoc.blogspot.com/">News</a></li>
                    </ul>
                </li>
            </ul>
            <ul class="nav pull-right">
                <li><a href="https://ticket.opensciencegrid.org/sso/">Login</a></li>            </ul>

            <div class="nav-collapse">
                <ul class="nav">
			 <li id="menu_submit"><a href="https://ticket.opensciencegrid.org/submit">Submit</a></li><li id="menu_view" class="dropdown"><a href="https://ticket.opensciencegrid.org/\#" class="dropdown-toggle" data-toggle="dropdown">View <b class="caret"></b></a><ul class="dropdown-menu"><li id="submenu_listopen"><a href="https://ticket.opensciencegrid.org/list/open">Open Tickets</a></li><li id="submenu_listrecentclose"><a href="https://ticket.opensciencegrid.org/list/recentclose">Recently Closed Tickets</a></li><li class="divider"></li><li id="submenu_alltickets"><a href="https://ticket.opensciencegrid.org/search?q=&amp;sort=id">All Tickets</a></li></ul></li>                </ul>

                <form class="navbar-search pull-right" action="https://ticket.opensciencegrid.org/viewer">
                    <input id="search" type="text" name="id" class="search-query span2" placeholder="Search Ticket" value=""/>
                </form>
            </div>
        </div>
      </div>
    </div>

<script type='text/javascript' src='lib/jquery.timeago.js'></script>
<script type='text/javascript' src='lib/byte2size.js'></script>
<style>
#updates .toolbar {
position: relative;
margin-top: 0px;
top: -10px;
font-weight: normal;
}
#updates a.anchor {
position: relative;
top: -50px;
}
#updates .selected pre {
animation:selected 2s;
animation-iteration-count: 2;
animation-direction: alternate;
-webkit-animation:selected 2s; 
-webkit-animation-iteration-count: 2;
-webkit-animation-direction: alternate;
box-shadow: inset 1px 1px 20px #9ad;
border: 1px solid #9ab;
margin: 5px 0px;
padding-left: 10px;
}
@keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ab;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
@-webkit-keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ad;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
#updates pre {
background-color: inherit;
line-height: 15px;
padding: 5px;
}
#updates .header {
color: #999;
}
#updates .update_history pre {
background-color: #eee;
color: #666;
font-size: 85%;
}
#updates .clickable {
cursor: pointer;
}
#updates .clickable:hover {
color: #D98719;
}
#updates .meta_information pre {
background-color: #fed;
}
#similar_tickets {
max-height: 300px;
overflow-y: auto;
pointer-events: none;
padding: 5px;
background-color: #f4f4f4;
}
.btn-toolbar {
margin-bottom: 0;
height: 30px;
}
#peers {
position: fixed;
bottom: 0px;
right: 0px;
z-index: 100;
list-style: none;
padding: 5px 0px 0px 5px;
margin: 0px;
background-color: white;
box-shadow: 0px 0px 10px white;
}
#peers li {
background-color: #ccc;
color: #000;
display: inline-block;
padding: 5px 10px;
margin-right: 5px;
position: relative;
}
/*
#peers li:hover {
background-color: #999;
cursor: pointer;
}
*/
#peers span.ip {
padding-left: 5px;
color: #666;
}
#peers .new {
bottom: -30px;
}
/*
#peers .me {
background-color: red;
}
*/
</style>

<div class="container-fluid">
<ul id="peers"></ul>
<div class="alert alert-danger"><a class="close" href="https://ticket.opensciencegrid.org/#" data-dismiss="alert">&times;</a>By the end of May 2018, the ticketing system at https://ticket.opensciencegrid.org will be retired and support will be provided at https://support.opensciencegrid.org. Throughout this transition the support email (help@opensciencegrid.org) will be available as a point of contact.<br><br>                                                   
                                                                                                                                                                                   
Please see the service migration page for details: https://opensciencegrid.github.io/technology/policy/service-migrations-spring-2018/#ticket</div><div id="presence" class="pull-right"></div><div class="ticketgui"><script type="text/javascript" src="lib/checktab.js"></script>

<script>
var expanded = false;
function expand_description() {
    var desc = $(".description");
    if(!expanded) {
        expanded = true;
        //expand to minheight
        var min = 250;
        if(desc.height() < min) {
            desc.animate({height: min}, 200);
        }
    }
}

$(document).ready(function() {
    $("input[name='nad']").datepicker({
        dateFormat: 'yy-mm-dd'
    });
});

</script>



<style>
.form-horizontal .control-label {
padding-top: inherit;
font-size:90%;
color:#666;
}
label {
margin-bottom: 0px;
}
.controls {
line-height: 18px;
}
</style>
<form class="form-horizontal" action="https://ticket.opensciencegrid.org/viewer/updatebasic?id=10427" method="post">
<div class="page-header">
    <h3><span class="muted">10427</span> / OSG cert-retrieve script&#58; scripted retrieval of certificates</h3>
</div>

<div class="row-fluid">
<div class="span5">
    <legend>Contact</legend>
    <div class="control-group">
        <label class="control-label">Full Name</label>
        <div class="controls">Ian Stokes-Rees</div>
    </div>
    <div class="control-group">
        <label class="control-label">Email</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">Phone</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">CC</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>

    <legend>Details</legend>
    
    <div class="control-group">
        <label class="control-label">Ticket Type</label>
        <div class="controls">Problem/Request</div>
    </div>
    <div class="control-group">
        <label class="control-label">Priority</label>
        <div class="controls">Normal</div>
    </div>
    <div class="control-group">
        <label class="control-label">Status</label>
        <div class="controls">
Closed</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action</label>
        <div class="controls">Check for updates from Ian</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action Deadline</label>
        <div class="controls flag_red">2011-11-14</div>
    </div>

</div><!--span-->
<div class="span7">
    <legend>Assignees</legend>
    <div class="assignee" style="width: 60%">OSG RA <span class="muted"> / OSG GOC Support Team</span></div><div class="assignee" style="width: 60%">Security Team <span class="muted"> / OSG Support Centers</span></div>    <br>

    <legend>Assignees</legend>
    TODO
    <br>

    <style>
legend.noborder {
border-bottom: none;
}
</style>

<div id="attachment-list"/>
<script>
$(function () {
    var first = true;
    $.getJSON("attachment/list/10427", function (files) {
        //console.dir(files);
        var html = "<table class=\"table table-condensed\">";
        $(files).each(function() {
            if(first) {
                first = false;
                html += "<legend class=\"noborder\">Attachmenets</legend>";
            }
            html += "<tr class=\"attachment\">";
            html += "<td><img src=\""+this.thumbnail_url+"\"/></td>";
            html += "<td><a href=\""+this.url+"\" target=\"_blank\">"+this.name+"</a></td>";
            html += "<td>"+bytesToSize(this.size, 1)+"</td>";
            html += "</tr>";
        });
        html += "</table>";
        $("#attachment-list").html(html);
    });
});

function download(url) {
    window.open(url, "_blank");
}
</script>


</div><!--span-->
</div><!--row-fluid-->


</form>

</div>
<div id="updates" style="clear: both;">
    <legend>Past Updates
    <div class="btn-toolbar pull-right toolbar">
        <div class="btn-group">
                <a class="btn btn-small" href="https://ticket.opensciencegrid.org/10427?sort=up&amp;"><i class="icon-arrow-up"></i> Sort</a>

        
        <a class="btn btn-small" href="https://ticket.opensciencegrid.org/10427?expandall=true&amp;">Expand Descriptions</a>        <a class="btn btn-small" target="_blank" href="mailto:osg@tick.globalnoc.iu.edu?subject=Open%20Science%20Grid%3A%20OSG%20cert-retrieve%20script%26%2358%3B%20scripted%20retrieval%20of%20certificates%20ISSUE%3D10427%20PROJ%3D71"><i class="icon-envelope"></i> Update w/Email</a>
        </div>
    </div><!--btn-toolbar-->
    </legend>

    <div class='update_description'><i onclick="document.location='10427#1321031445'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-11-11T17:10:45+00:00">Nov 11, 2011 05:10 PM UTC</time> by <b>Rob Quick</b><a class="anchor" name="1321031445">&nbsp;</a></div><pre>Since there is a software change and has an open RT Ticket. I&#39;m going to close this one, the problem should be tracked in VDT Ticket&#58; Queue=vdt-support ID=9442.</pre></div><div class='update_description'><i onclick="document.location='10427#1320673920'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-11-07T13:52:00+00:00">Nov 7, 2011 01:52 PM UTC</time> by <b>OSG RA</b><a class="anchor" name="1320673920">&nbsp;</a></div><pre>Are there any updates on this issue?

Please submit problems, requests, and questions at&#58;
<a href='https&#58;//ticket.grid.iu.edu/goc/open' target='_blank' rel='nofollow'>https&#58;//ticket.grid.iu.edu/goc/open</a>

Thank You,
OSG Grid Operations Center
goc@...., 317-278-9699
Visit the Open Science Grid Operations Page&#58;
<a href='http&#58;//osggoc.blogspot.com/' target='_blank' rel='nofollow'>http&#58;//osggoc.blogspot.com/</a></pre></div><div class='update_description'><i onclick="document.location='10427#1319379781'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-10-23T14:23:01+00:00">Oct 23, 2011 02:23 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1319379781">&nbsp;</a></div><pre>On Oct 21, 2011, at 1&#58;42 PM, via RT wrote&#58;
<font color='#7F7E6F'>&#62; Ian or Alain,</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; Any word on an updated version of the cert-retreive script? This issue</font>
<font color='#7F7E6F'>&#62; has been pending since May, is there anything we can do at Operations</font>
<font color='#7F7E6F'>&#62; to push this to resolution?</font>

Last I heard, Ian was offering patches. If that&#39;s likely, we&#39;ll continue waiting. If it&#39;s unlikely but it&#39;s still a problem, then we should add Anand Padmanabhan to the ticket. He now maintains the scripts, and they are owned by the Security Team.

-alain
------------------------------------
Alain Roy
VDT Support
vdt-support@....
<a href='http&#58;//vdt.cs.wisc.edu/support.html' target='_blank' rel='nofollow'>http&#58;//vdt.cs.wisc.edu/support.html</a>
-- by roy at Sun Oct 23 14&#58;22&#58;45 UTC 2011

GOCTX Source&#58; VDT Ticket&#58; Queue=vdt-support ID=9442</pre></div><div class='update_description'><i onclick="document.location='10427#1319139875'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-10-20T19:44:35+00:00">Oct 20, 2011 07:44 PM UTC</time> by <b>Rob Quick</b><a class="anchor" name="1319139875">&nbsp;</a></div><pre>Ian or Alain,

Any word on an updated version of the cert-retreive script? This issue has been pending since May, is there anything we can do at Operations to push this to resolution?

Rob</pre></div><div class='update_description'><i onclick="document.location='10427#1317834789'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-10-05T17:13:09+00:00">Oct 5, 2011 05:13 PM UTC</time> by <b>OSG RA</b><a class="anchor" name="1317834789">&nbsp;</a></div><pre>Greetings Ian,

Do you have anything new for us from your end on a working version?

Thanks,

-Alain Deximo</pre></div><div class='update_description'><i onclick="document.location='10427#1316621065'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-09-21T16:04:25+00:00">Sep 21, 2011 04:04 PM UTC</time> by <b>Ian Stokes-Rees</b><a class="anchor" name="1316621065">&nbsp;</a></div><pre>Sorry, no update yet.  I&#39;m working on this stuff now so will hopefully have something in the next week or two -- it is a small change, but of course I want to make sure I test it suitably.

Ian</pre></div><div class='update_description'><i onclick="document.location='10427#1314812121'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-08-31T17:35:21+00:00">Aug 31, 2011 05:35 PM UTC</time> by <b>OSG RA</b><a class="anchor" name="1314812121">&nbsp;</a></div><pre>Greetings Ian,

Do you have an update for us from your end on a working version?

Thanks,

-Alain Deximo</pre></div><div class='update_description'><i onclick="document.location='10427#1309233246'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-06-28T03:54:06+00:00">Jun 28, 2011 03:54 AM UTC</time> by <b>Ian Stokes-Rees</b><a class="anchor" name="1309233246">&nbsp;</a></div><pre>I&#39;m away 4 weeks over the summer and have 2 papers to finish, so the
timeline for a working version of this is probably not until August.

Ian

<font color='#7F7E6F'>&#62; If you give me a new version, we&#39;ll put it in a new release. What&#39;s the estimated time for an updated release?</font></pre></div><div class='update_description'><i onclick="document.location='10427#1309232421'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-06-28T03:40:21+00:00">Jun 28, 2011 03:40 AM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1309232421">&nbsp;</a></div><pre>On Jun 24, 2011, at 10&#58;43 AM, via RT wrote&#58;
<font color='#7F7E6F'>&#62; I am copying GOC so we can open a ticket to track this. I will need</font>
<font color='#7F7E6F'>&#62; Alain Roy&#39;s opinion on the process to accept new patches. I simply do</font>
<font color='#7F7E6F'>&#62; not know. I would be happy to review the patch and make a functionality</font>
<font color='#7F7E6F'>&#62; test. Alain will need more ITB and VTB tests.</font>

If you give me a new version, we&#39;ll put it in a new release. What&#39;s the estimated time for an updated release?

-alain
-- by roy at Tue Jun 28 03&#58;40&#58;00 UTC 2011

GOCTX Source&#58; VDT Ticket&#58; Queue=vdt-support ID=9442</pre></div><div class='update_description'><i onclick="document.location='10427#1308930137'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-06-24T15:42:17+00:00">Jun 24, 2011 03:42 PM UTC</time> by <b>Kyle Gross</b><a class="anchor" name="1308930137">&nbsp;</a></div><pre>I&#39;ve added the security team and VDT on this ticket per Mine&#39;s request.

-Kyle</pre></div><div class='update_description'><i onclick="document.location='10427#1308928507'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-06-24T15:15:07+00:00">Jun 24, 2011 03:15 PM UTC</time> by <b>Mine Altunay</b><a class="anchor" name="1308928507">&nbsp;</a></div><pre>Ian,
I am copying GOC so we can open a ticket to track this. I will need
Alain Roy&#39;s opinion on the process to accept new patches. I simply do
not know. I would be happy to review the patch and make a functionality
test. Alain will need more ITB and VTB tests.

GOC staff&#58; Can we please assign VDT and Security teams to this ticket
please?
Thank you
Mine
On 6/24/11 9&#58;48 AM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='10427#1308926907'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-06-24T14:48:27+00:00">Jun 24, 2011 02:48 PM UTC</time> by <b>Ian Stokes-Rees</b><a class="anchor" name="1308926907">&nbsp;</a></div><pre>I will need to modify cert-retrieve to make the --password option work.  What is the best route to get a patch submitted to someone so it can be reviewed and (hopefully) added to the VDT distributed script?

Thanks,

Ian</pre></div><div class='update_description'><i onclick="document.location='10427#1308921634'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-06-24T13:20:34+00:00">Jun 24, 2011 01:20 PM UTC</time> by <b>OSG RA</b><a class="anchor" name="1308921634">&nbsp;</a></div><pre>Ian,

Are you still having issues on your end?  If not, can we close out this ticket?

Thanks,

-Alain</pre></div><div class='update_description'><i onclick="document.location='10427#1307477178'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-06-07T20:06:18+00:00">Jun 7, 2011 08:06 PM UTC</time> by <b>Anand Padmanabhan</b><a class="anchor" name="1307477178">&nbsp;</a></div><pre>Hi Ian,

Sorry for the delayed response, I was out of office for a while and was assigned to look at this ticket just yesterday.

Anyway with regards to the question I believe that the &#34;feature&#34; (--password) in the script was some historical residue of an earlier script from someone else. I even checked with the last developer and he had no idea. So it looks like that is not working in the cert-retrieve script and I&#39;m not sure it was ever tested. I am surprised you found that option since it not even listed in help. In principle it is possible for openssl to be fed a password (or password file) and not prompt for a passphrase and enabling that feature would be nice but at present I dont think implementing it would be a high priority task.

Hope that helps.

Thanks
Anand</pre></div><div class='update_description'><i onclick="document.location='10427#1306955231'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-06-01T19:07:11+00:00">Jun 1, 2011 07:07 PM UTC</time> by <b>OSG RA</b><a class="anchor" name="1306955231">&nbsp;</a></div><pre>Can someone with security please address Ian&#39;s concerns/inquiry?

Thanks,

-Alain</pre></div><div class='update_description'><i onclick="document.location='10427#1305582050'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-05-16T21:40:50+00:00">May 16, 2011 09:40 PM UTC</time> by <b>Ian Stokes-Rees</b><a class="anchor" name="1305582050">&nbsp;</a></div><pre>OK, I&#39;ve figured out at least part of the problem&#58; the request ID is different from the retrieval ID.  The next challenge is that the cert-retrieve script does not provide inputs for private key passphrases or export passwords.  A trace is below.  Is there any alternative mechanism for cert retrieval that can be fully scripted, or do I just need to hack cert-retrieve on my own?

$ cert-retrieve                                               &#92;
--serialnum      56415                                      &#92;
--label          portal                                     &#92;
--dir            /p/home/portermahoney                      &#92;
--password       /p/home/portermahoney/.passwd              &#92;
--keyfile        /p/home/portermahoney/userkey.pem          &#92;
--p12            /p/home/portermahoney/usercred.p12

checking CertLib version, V2-7,  This is the latest version, released 18 May 2009.
using CA doegrids
Using URL <a href='https&#58;//pki1.doegrids.org/displayBySerial?op=displayBySerial&serialNumber=56415' target='_blank' rel='nofollow'>https&#58;//pki1.doegrids.org/displayBySerial?op=displayBySerial&serialNumber=56415</a>
Checking that the certificate and /p/home/portermahoney/userkey.pem match
writing RSA key
previous /p/home/portermahoney/usercert.pem exits
previous /p/home/portermahoney/userkey.pem exists
previous /p/home/portermahoney/userkey.pem and /p/home/portermahoney/usercert.pem exists, overwrite? (N,y)&#58; y
mv&#58; &#96;/p/home/portermahoney/userkey.pem&#39; and &#96;/p/home/portermahoney/userkey.pem&#39; are the same file
/p/home/portermahoney/usercert.pem and /p/home/portermahoney/userkey.pem now contain your new credential
Generating PKCS12 file
Enter pass phrase for /p/home/portermahoney/userkey.pem&#58;
Enter Export Password&#58;
Verifying - Enter Export Password&#58;
Your PKCS12 file /p/home/portermahoney/usercred.p12 credential with your certificate and
private key was generated.  For information on how to import it
into your favorite browser or email application
Google  import certificate &#60;application name&#62;
and you will get lots of examples.</pre></div><div class='update_description'><i onclick="document.location='10427#1305576648'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-05-16T20:10:48+00:00">May 16, 2011 08:10 PM UTC</time> by <b>Kyle Gross</b><a class="anchor" name="1305576648">&nbsp;</a></div><pre>cert-retrieve -h tells me to email Doug and osg-ra with questions about
the script, so here goes&#58;

I&#39;m working to establish a web-portal frontend for the process of user
account creation that simplifies life for regular users getting X.509
certs.  The problem I have is that&#58;

1. I would like to use the request ID to retrieve the cert, since this
ID is available when the request is submitted.  PROBLEMS&#58;
i) It sounds like an RA cert needs to be used to do this; and
ii) It isn&#39;t clear how to set HTTPS_CERT_FILE and HTTPS_KEY_FILE to
make this work.
iii) By forcing my passwordless proxy cert into
~/.globus/user{cert,key}.pem, I still get an error&#58;

$ cert-retrieve                                               &#92;
--reqid         &#96;cat .reqid&#96;                                &#92;
--label          portal                                     &#92;
--dir            /p/home/portermahoney                      &#92;
--password       /p/home/portermahoney/.passwd              &#92;
--keyfile        /p/home/portermahoney/portal_req.key.pem   &#92;
--p12            /p/home/portermahoney/usercred.p12

checking CertLib version, V2-7,  This is the latest version, released 18
May 2009.
using CA doegrids
Using URL <a href='https&#58;//pki1.doegrids.org/ca/processReq?seqNum=72351' target='_blank' rel='nofollow'>https&#58;//pki1.doegrids.org/ca/processReq?seqNum=72351</a>
response 404 Not found
Unable to retrieve certificate. Please check the certificate number.
The -reqid option is only for agent debugging and not for end users
you should use the -serialnum or -certnum options instead

And sure enough the URL
<a href='https&#58;//pki1.doegrids.org/ca/processReq?seqNum=72351' target='_blank' rel='nofollow'>https&#58;//pki1.doegrids.org/ca/processReq?seqNum=72351</a> doesn&#39;t work from
my browser either, where my RA cert should at least get me a bit further
<div id='show_1947133012' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_1947133012'>than a 404.

2. If I have to use the Serial Number, then it would be immensely
helpful if there was some signaling mechanism (email would work) whereby
newly issued certs had the notification email cc&#39;ed to the RA and VO
contacts.  We could then automate the retrieval of the cert on behalf of
the user, and continue (again, automatically) with the next step of
registering them into a VO.  In fact, it somewhat derails the entire
effort of doing the X.509 cert request behind the scenes if the user
gets an email from the CA telling them to retrieve a cert that they
don&#39;t have any capacity to retrieve.  Is there any way we can suppress this?

One consideration we&#39;ve had is to &#34;man in the middle&#34; OSG/X.509/CA
related emails by creating an account &#34;johndoe@....&#34; and then
procmailing the content appropriately.  This would mean that new account
requests from johndoe@.... into our portal system would show up
as X.509 cert requests from johndoe@...., and we&#39;d procmail any
correspondence relating to X.509 certs into our ticketing system or
automated response system (e.g. cert retrieval/renewal), and anything
else we&#39;d pass through to the user.

Your comments on how best to navigate this situation would be greatly
appreciated.

Regards,

Ian

</div><script type='text/javascript'>
        $('#show_1947133012').click(function() {
            $('#detail_1947133012').slideDown("normal");
            $('#show_1947133012').hide();
            $('#hide_1947133012').show();
        });
        $('#hide_1947133012').click(function() {
            $('#detail_1947133012').slideUp();
            $('#hide_1947133012').hide();
            $('#show_1947133012').show();
        });
        </script></pre></div><legend>Similar Recent Tickets <small>modified within the last 30 days</small></legend><div id="similar_tickets"><p class="muted">No similar tickets found.</p></div>
</div>
<script type="text/javascript">
function reset_anchor() {
    $("#updates .selected").removeClass("selected");
    var urls = document.location.toString().split('#'); 
    var anchor = urls[1];
    if(anchor) {
        $("a[name='"+anchor+"']").parents(".update_description").addClass("selected");
    }
}
function submitspam(ticket_id) {
    myret = confirm("Would you like to close this ticket as a security ticket, and submit the ticket content to akismet?");
    if(myret == true) {
        $.ajax("viewer/processspam?id="+ticket_id).done(function() {
            window.location.reload();
        });
    }
}

$(function() {
    reset_anchor();
    var ADDITIONAL_COOKIE_NAME = 'gocticket';
    var options = { path: '/', expires: 365};

    if(window.opener && window.opener.name == "gocticket_list") {
        v = $.cookie("closewindow");
        if(!v) {
            $("#closewindow").attr("checked", "checked"); //on by default
        } else {
            if(v == "checked") {
                $("#closewindow").attr("checked", "checked");
            }
        }
        $("#closewindow").click(function() {
            $.cookie("closewindow", $(this).attr('checked'), options);
        });
    } else {
        $("#closewindow_area").hide();
    }
    function updateTimeago() {
        $("time").timeago();
        setTimeout(updateTimeago, 30*1000);
    }
    updateTimeago();
    $(".description").focus(expand_description);
});
</script>
<hr/>
<footer>
<p>GOC Ticket Version 2.2 | <a href="https://ticket.opensciencegrid.org/goc/submit?app_issue_check=on&amp;app_issue_type=goc&amp;app_goc_url=https%3A%2F%2Fticket.opensciencegrid.org%3A443%2F10427">Report Bugs</a>
 | <a href="https://github.com/opensciencegrid/operations/blob/master/docs/privacy.md">Privacy Policy</a>
</p>

<p> <img align="top" src="images/tag_orange.png"/> Copyright 2018 The Trustees of Indiana University - Developed for Open Science Grid</p>
</footer>


</div><!--container-fluid-->
<script>
//used by searchbox
function parseValue(value) {
    var obj = new Object();
    var tokens = value.split("\t");
    obj.str = tokens[0];
    obj.count = tokens[1];
    return obj;
}

$(function() {
    //bootstrap-2.0.4 stuff
    $(".alert-message").alert();
    $(".dropdown-toggle").dropdown();
    $("span[rel='tooltip']").tooltip();
    $("a[rel=popover]").popover();

    //activate menu that user is currently on
    $("#menu_navigator").addClass("active"); 
    $("#submenu_").addClass("active"); 

    //translate zend validation error message to bootstrap
    $(".errors").addClass("alert").addClass("alert-error");

    //enable autocomplete for search box
    $("#search").autocomplete({
        source: function( request, response ) {
            $.ajax({
                url: "search/autocomplete",
                dataType: "text",
                data: {
                    //featureClass: "P",
                    //style: "full",
                    //maxRows: 12,
                    //name_startsWith: request.term
                    q: request.term
                },
                success: function( data ) {
                    response( $.map( data.split("\n"), function( item ) {
                        if(item == "") return null;
                        return {
                            value: item
                        }
                    }));
                }
            });
        },
        select: function(event, ui) {
            document.location = "search?q="+ui.item.value;
        }
    });
    
});
</script>


</body>
