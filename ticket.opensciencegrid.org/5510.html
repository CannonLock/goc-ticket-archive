<!DOCTYPE html>
<html lang="en">
  <head>
  <base href="">
    <title>[5510] RSV Gratia consumer errors</title>    <meta charset="utf-8" />
    <meta name="verify-v1" content="na5IcAJsZVOfEkboRxuIiZ1zpZgnZiWra+nKcS7nA/o=" />
    <meta name="google-site-verification" content="DLrk3ft4s8b-S2TloLCL2LD_t6wcTjgSluf5pmiu2kA" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />

    <style type="text/css">
      body {
        padding-top: 50px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
     #search {
            width: 300px;
     }

    </style>

<script src="https://code.jquery.com/jquery-3.0.0.js"></script>
<script src="https://code.jquery.com/jquery-migrate-3.0.1.js"></script>

   <link href="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet"/>
    <script src="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/js/bootstrap.min.js"></script>

    <link href="https://netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"/>
    <link href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/themes/smoothness/jquery-ui.min.css" rel="stylesheet"/>
 <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>


    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/js/select2.min.js"></script>

    <link href="css/ticket.css" rel="stylesheet" />
    <script src="lib/jquery.cookie.js"></script>

    <link href="images/tag_orange.png" rel="icon" type="image/png"/>
  </head>

  <body>
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>

            <a class="brand" style="padding: 6px 0px 0px 6px;" href="http://opensciencegrid.org"><img src="images/osglogo.40x30.png"/></a>
            <ul class="nav">
                <li class="dropdown"><a href="https://ticket.opensciencegrid.org/#" class="dropdown-toggle" data-toggle="dropdown">GOC Ticket <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    <li><a href="https://my.opensciencegrid.org">MyOSG</a></li>
                    <li><a href="https://oim.opensciencegrid.org">OIM</a></li>
                    <li class="active"><a href="https://ticket.opensciencegrid.org/index">Ticket</a></li>
	<li class="divider"></li>
	<li><a href="http://repo.grid.iu.edu">Repo</a></li>
	<li class="divider"></li>
	<li><a href="http://blogs.grid.iu.edu">Blog</a></li>
                    <li><a href="http://display.grid.iu.edu">Display</a></li>
                    <li><a href="http://osggoc.blogspot.com/">News</a></li>
                    </ul>
                </li>
            </ul>
            <ul class="nav pull-right">
                <li><a href="https://ticket.opensciencegrid.org/sso/">Login</a></li>            </ul>

            <div class="nav-collapse">
                <ul class="nav">
			 <li id="menu_submit"><a href="https://ticket.opensciencegrid.org/submit">Submit</a></li><li id="menu_view" class="dropdown"><a href="https://ticket.opensciencegrid.org/\#" class="dropdown-toggle" data-toggle="dropdown">View <b class="caret"></b></a><ul class="dropdown-menu"><li id="submenu_listopen"><a href="https://ticket.opensciencegrid.org/list/open">Open Tickets</a></li><li id="submenu_listrecentclose"><a href="https://ticket.opensciencegrid.org/list/recentclose">Recently Closed Tickets</a></li><li class="divider"></li><li id="submenu_alltickets"><a href="https://ticket.opensciencegrid.org/search?q=&amp;sort=id">All Tickets</a></li></ul></li>                </ul>

                <form class="navbar-search pull-right" action="https://ticket.opensciencegrid.org/viewer">
                    <input id="search" type="text" name="id" class="search-query span2" placeholder="Search Ticket" value=""/>
                </form>
            </div>
        </div>
      </div>
    </div>

<script type='text/javascript' src='lib/jquery.timeago.js'></script>
<script type='text/javascript' src='lib/byte2size.js'></script>
<style>
#updates .toolbar {
position: relative;
margin-top: 0px;
top: -10px;
font-weight: normal;
}
#updates a.anchor {
position: relative;
top: -50px;
}
#updates .selected pre {
animation:selected 2s;
animation-iteration-count: 2;
animation-direction: alternate;
-webkit-animation:selected 2s; 
-webkit-animation-iteration-count: 2;
-webkit-animation-direction: alternate;
box-shadow: inset 1px 1px 20px #9ad;
border: 1px solid #9ab;
margin: 5px 0px;
padding-left: 10px;
}
@keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ab;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
@-webkit-keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ad;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
#updates pre {
background-color: inherit;
line-height: 15px;
padding: 5px;
}
#updates .header {
color: #999;
}
#updates .update_history pre {
background-color: #eee;
color: #666;
font-size: 85%;
}
#updates .clickable {
cursor: pointer;
}
#updates .clickable:hover {
color: #D98719;
}
#updates .meta_information pre {
background-color: #fed;
}
#similar_tickets {
max-height: 300px;
overflow-y: auto;
pointer-events: none;
padding: 5px;
background-color: #f4f4f4;
}
.btn-toolbar {
margin-bottom: 0;
height: 30px;
}
#peers {
position: fixed;
bottom: 0px;
right: 0px;
z-index: 100;
list-style: none;
padding: 5px 0px 0px 5px;
margin: 0px;
background-color: white;
box-shadow: 0px 0px 10px white;
}
#peers li {
background-color: #ccc;
color: #000;
display: inline-block;
padding: 5px 10px;
margin-right: 5px;
position: relative;
}
/*
#peers li:hover {
background-color: #999;
cursor: pointer;
}
*/
#peers span.ip {
padding-left: 5px;
color: #666;
}
#peers .new {
bottom: -30px;
}
/*
#peers .me {
background-color: red;
}
*/
</style>

<div class="container-fluid">
<ul id="peers"></ul>
<div class="alert alert-danger"><a class="close" href="https://ticket.opensciencegrid.org/#" data-dismiss="alert">&times;</a>By the end of May 2018, the ticketing system at https://ticket.opensciencegrid.org will be retired and support will be provided at https://support.opensciencegrid.org. Throughout this transition the support email (help@opensciencegrid.org) will be available as a point of contact.<br><br>                                                   
                                                                                                                                                                                   
Please see the service migration page for details: https://opensciencegrid.github.io/technology/policy/service-migrations-spring-2018/#ticket</div><div id="presence" class="pull-right"></div><div class="ticketgui"><script type="text/javascript" src="lib/checktab.js"></script>

<script>
var expanded = false;
function expand_description() {
    var desc = $(".description");
    if(!expanded) {
        expanded = true;
        //expand to minheight
        var min = 250;
        if(desc.height() < min) {
            desc.animate({height: min}, 200);
        }
    }
}

$(document).ready(function() {
    $("input[name='nad']").datepicker({
        dateFormat: 'yy-mm-dd'
    });
});

</script>



<style>
.form-horizontal .control-label {
padding-top: inherit;
font-size:90%;
color:#666;
}
label {
margin-bottom: 0px;
}
.controls {
line-height: 18px;
}
</style>
<form class="form-horizontal" action="https://ticket.opensciencegrid.org/viewer/updatebasic?id=5510" method="post">
<div class="page-header">
    <h3><span class="muted">5510</span> / RSV Gratia consumer errors</h3>
</div>

<div class="row-fluid">
<div class="span5">
    <legend>Contact</legend>
    <div class="control-group">
        <label class="control-label">Full Name</label>
        <div class="controls">Anthony Tiradani</div>
    </div>
    <div class="control-group">
        <label class="control-label">Email</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">Phone</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">CC</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>

    <legend>Details</legend>
    
    <div class="control-group">
        <label class="control-label">Ticket Type</label>
        <div class="controls">Problem/Request</div>
    </div>
    <div class="control-group">
        <label class="control-label">Priority</label>
        <div class="controls">Normal</div>
    </div>
    <div class="control-group">
        <label class="control-label">Status</label>
        <div class="controls">
Closed</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action</label>
        <div class="controls">Fix released. VDT will release it later.</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action Deadline</label>
        <div class="controls flag_red">2008-10-14</div>
    </div>

</div><!--span-->
<div class="span7">
    <legend>Assignees</legend>
    <div class="assignee" style="width: 60%">RSV-Ops <span class="muted"> / OSG Support Centers</span></div>    <br>

    <legend>Assignees</legend>
    TODO
    <br>

    <style>
legend.noborder {
border-bottom: none;
}
</style>

<div id="attachment-list"/>
<script>
$(function () {
    var first = true;
    $.getJSON("attachment/list/5510", function (files) {
        //console.dir(files);
        var html = "<table class=\"table table-condensed\">";
        $(files).each(function() {
            if(first) {
                first = false;
                html += "<legend class=\"noborder\">Attachmenets</legend>";
            }
            html += "<tr class=\"attachment\">";
            html += "<td><img src=\""+this.thumbnail_url+"\"/></td>";
            html += "<td><a href=\""+this.url+"\" target=\"_blank\">"+this.name+"</a></td>";
            html += "<td>"+bytesToSize(this.size, 1)+"</td>";
            html += "</tr>";
        });
        html += "</table>";
        $("#attachment-list").html(html);
    });
});

function download(url) {
    window.open(url, "_blank");
}
</script>


</div><!--span-->
</div><!--row-fluid-->


</form>

</div>
<div id="updates" style="clear: both;">
    <legend>Past Updates
    <div class="btn-toolbar pull-right toolbar">
    </div><!--btn-toolbar-->
    </legend>

    <div class='update_description'><i onclick="document.location='5510#1224655510'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2008-10-22T06:05:10+00:00">Oct 22, 2008 06:05 AM UTC</time> by <b>mfedias@....</b><a class="anchor" name="1224655510">&nbsp;</a></div><pre>Hi Arvind,

thanks again. We just updated at SPRACE.
Cheers,

Marco

Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='5510#1224622680'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2008-10-21T20:58:00+00:00">Oct 21, 2008 08:58 PM UTC</time> by <b>Arvind Gopu</b><a class="anchor" name="1224622680">&nbsp;</a></div><pre>PreS&#58; Added Marco Dias to ticket&#39;s CC since he saw this problem on his SPRACE RSV
client as well.

Hi Tony,

Per our IM conversation, a fix to this problem has been released. Scot tells me that
he will not be able to release that fix via VDT in tomorrow&#39;s release since he has to
focus on another important task on hand. He thinks the VDT release *after* tomorrow&#39;s
will have the required fix for this problem.

If you or Terrence or Marco would like to upgrade your RSV probe perl module before
that release, then you can get it here&#58;

cd $VDT_LOCATION/osg-rsv/bin/probes
mv  OSG_RSV_Probe_Base.pm OSG_RSV_Probe_Base.pm-old
wget <a href='http&#58;//rsv.grid.iu.edu/downloads/pre-release/Probes-2.3.5/OSG_RSV_Probe_Base.pm' target='_blank' rel='nofollow'>http&#58;//rsv.grid.iu.edu/downloads/pre-release/Probes-2.3.5/OSG_RSV_Probe_Base.pm</a>

I am closing this GOC ticket per Tony&#39;s approval.

Cheers,
Arvind</pre></div><div class='update_description'><i onclick="document.location='5510#1223408770'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2008-10-07T19:46:10+00:00">Oct 7, 2008 07:46 PM UTC</time> by <b>Arvind Gopu</b><a class="anchor" name="1223408770">&nbsp;</a></div><pre>Scot is going to test a minor code change in the perl module on his EDU
CE, on which he&#39;s noticed the same issue crop up, to see if that
resolves the problem. We&#39;ll be in touch.

Cheers,
Arvind</pre></div><div class='update_description'><i onclick="document.location='5510#1223394910'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2008-10-07T15:55:10+00:00">Oct 7, 2008 03:55 PM UTC</time> by <b>Scott Kronenfeld</b><a class="anchor" name="1223394910">&nbsp;</a></div><pre>I have the same problem on my CE, OSG-EDU

On Tue, Oct 7, 2008 at 6&#58;07 AM, Open Science Grid FootPrints
&#60;osg@....&#62; wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='5510#1223377674'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2008-10-07T11:07:54+00:00">Oct 7, 2008 11:07 AM UTC</time> by <b>Arvind Gopu</b><a class="anchor" name="1223377674">&nbsp;</a></div><pre>It&#39;s not clear why new-lines (or ?) are being introduced into the gratia uploader
scripts&#39; filenames but Terrence Martin (added to CC list on this ticket) has also
seen this problem.

We need to investigate any common ties between Tony&#39;s CE and Terrence&#39;s CE -- Can you
guys send me the output of &#39;uname -a&#39;, perl version, and such?

It&#39;s not a readily reproducible problem, so I am having trouble looking for problems
in the perl debugger.

Thanks!
Arvind</pre></div><div class='update_description'><i onclick="document.location='5510#1221852429'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2008-09-19T19:27:09+00:00">Sep 19, 2008 07:27 PM UTC</time> by <b>Scott Kronenfeld</b><a class="anchor" name="1221852429">&nbsp;</a></div><pre>I figured out the problem.  The &#39;?&#39; marks in the file names are not
question marks, they&#39;re newlines.  The shell just displays them as
question marks.

When the gratia-script-consumer tries to move the files, the resulting
command line looks something like this&#58;

mv 2008-09-17T21&#58;06&#58;01Z
-osg-edu.cs.wisc.edu-org.osg.general.osg-version.27775.py DEST-DIRECTORY

Arvind, why are the probes sometimes creating these filenames with
newlines in them?

On Wed, Sep 17, 2008 at 3&#58;24 PM, Open Science Grid FootPrints
&#60;osg@....&#62; wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='5510#1221685212'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2008-09-17T21:00:12+00:00">Sep 17, 2008 09:00 PM UTC</time> by <b>Scott Kronenfeld</b><a class="anchor" name="1221685212">&nbsp;</a></div><pre>So glob in gratia-consumer should be picking up your filenames with
question marks in them fine.

Can you send me your gratia-script-consumer.out and .err from
$VDT_LOCATION/osg-rsv/logs/consumers?

Thanks

On Wed, Sep 17, 2008 at 3&#58;45 PM, Open Science Grid FootPrints
&#60;osg@....&#62; wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='5510#1221684310'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2008-09-17T20:45:10+00:00">Sep 17, 2008 08:45 PM UTC</time> by <b>Anthony Tiradani</b><a class="anchor" name="1221684310">&nbsp;</a></div><pre>Hello,

The output from the perl code is as follows&#58;

# perl /tmp/testglob.pl
tmp.10092/2008-07-23T19&#58;04&#58;07Z?-cmsosgce4.fnal.gov-org.osg.batch.jobmanagers-available.py
tmp.10092/2008-07-24T19&#58;04&#58;07Z-some-file-without-question-mark.py
tmp.10092/2008-07-24T19&#58;04&#58;07Z?-some-other-file-with-?-mark.py

Also, just in case it matters&#58;

# perl -v
This is perl, v5.8.5 built for i386-linux-thread-multi

This is on a 32-bit SL4 installation.

-
Anthony Tiradani
tiradani@....
+1 (630) 840-4479

On Wed, 2008-09-17 at 20&#58;24 +0000, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='5510#1221683050'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2008-09-17T20:24:10+00:00">Sep 17, 2008 08:24 PM UTC</time> by <b>Scott Kronenfeld</b><a class="anchor" name="1221683050">&nbsp;</a></div><pre>Hi Tony,
Further exploration.  When I run the script below on my system, I get
the expected results.  All the files are printed.  Can you please try
it out, to see if your perl has a problem with its glob function?

#!/usr/bin/env perl
use strict;
use warnings;

my $pid = $$;
system(&#34;mkdir tmp.$pid&#34;);
system(&#34;touch tmp.$pid/2008-07-23T19&#58;04&#58;07Z?-cmsosgce4.fnal.gov-org.osg.batch.jobmanagers-available.py&#34;);
system(&#34;touch tmp.$pid/2008-07-24T19&#58;04&#58;07Z?-some-other-file-with-?-mark.py&#34;);
system(&#34;touch tmp.$pid/2008-07-24T19&#58;04&#58;07Z-some-file-without-question-mark.py&#34;);

foreach my $file (glob(&#34;tmp.$pid/*&#34;)) {
print &#34;$file&#92;n&#34;;
}

On Tue, Sep 9, 2008 at 10&#58;31 AM, Scot Kronenfeld &#60;kronenfe@....&#62; wrote&#58;
<font color='#7F7E6F'>&#62; Hi Anthony,</font>
<font color='#7F7E6F'>&#62; I just tested locally, and the gratia consumer does not have a problem</font>
<font color='#7F7E6F'>&#62; with file names with question marks in them.  Something else is</font>
<font color='#7F7E6F'>&#62; happening that is causing the files to either not be executed, or not</font>
<font color='#7F7E6F'>&#62; be removed correctly.</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; Can you please send me the gratia-script-consumer.err and</font>
<font color='#7F7E6F'>&#62; gratia-script-consumer.out files (from</font>
<font color='#7F7E6F'>&#62; $VDT_LOCATION/osg-rsv/logs/consumers) so that I can debug further?</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; Also, please attach the output of these&#58;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; ls $VDT_LOCATION/osg-rsv/output/gratia</font>
<font color='#7F7E6F'>&#62; ls $VDT_LOCATION/osg-rsv/output/failed-gratia-scripts</font>
<font color='#7F7E6F'>&#62;</font>
<div id='show_767866711' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_767866711'><font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; Thanks,</font>
<font color='#7F7E6F'>&#62; scot</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; On Fri, Sep 5, 2008 at 2&#58;48 PM, Open Science Grid FootPrints</font>
<font color='#7F7E6F'>&#62; &#60;osg@....&#62; wrote&#58;</font>
<font color='#7F7E6F'>&#62;&#62; [Duplicate message snipped]</font>
</div><script type='text/javascript'>
        $('#show_767866711').click(function() {
            $('#detail_767866711').slideDown("normal");
            $('#show_767866711').hide();
            $('#hide_767866711').show();
        });
        $('#hide_767866711').click(function() {
            $('#detail_767866711').slideUp();
            $('#hide_767866711').hide();
            $('#show_767866711').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='5510#1221572171'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2008-09-16T13:36:11+00:00">Sep 16, 2008 01:36 PM UTC</time> by <b>Scott Kronenfeld</b><a class="anchor" name="1221572171">&nbsp;</a></div><pre>I haven&#39;t heard back from him with his log files (or if he did send
them, I missed that email).

On Tue, Sep 16, 2008 at 8&#58;23 AM, Open Science Grid FootPrints
&#60;osg@....&#62; wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='5510#1221571403'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2008-09-16T13:23:23+00:00">Sep 16, 2008 01:23 PM UTC</time> by <b>Arvind Gopu</b><a class="anchor" name="1221571403">&nbsp;</a></div><pre>Had a discussion with Tony yesterday -- he&#39;s going to add a periodic check on
filenames in the directory as a stop-gap solution. He also will let us know if he
finds out what corner-case, if any, causes the ? to be added to the python script
file name. Since it&#39;s an easily reproducible problem, resolution is going to be hard
to achieve.

Will keep this ticket open till Sep 30th .. BDII is getting higher priority right now
at the GOC end. Will keep discussing with Tony periodically.

Arvind</pre></div><div class='update_description'><i onclick="document.location='5510#1220974392'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2008-09-09T15:33:12+00:00">Sep 9, 2008 03:33 PM UTC</time> by <b>Scott Kronenfeld</b><a class="anchor" name="1220974392">&nbsp;</a></div><pre>Hi Anthony,
I just tested locally, and the gratia consumer does not have a problem
with file names with question marks in them.  Something else is
happening that is causing the files to either not be executed, or not
be removed correctly.

Can you please send me the gratia-script-consumer.err and
gratia-script-consumer.out files (from
$VDT_LOCATION/osg-rsv/logs/consumers) so that I can debug further?

Also, please attach the output of these&#58;

ls $VDT_LOCATION/osg-rsv/output/gratia
ls $VDT_LOCATION/osg-rsv/output/failed-gratia-scripts

Thanks,
scot

On Fri, Sep 5, 2008 at 2&#58;48 PM, Open Science Grid FootPrints
&#60;osg@....&#62; wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='5510#1220889069'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2008-09-08T15:51:09+00:00">Sep 8, 2008 03:51 PM UTC</time> by <b>Anthony Tiradani</b><a class="anchor" name="1220889069">&nbsp;</a></div><pre>After moving the files to the failed directory, Memory and CPU usage
dropped significantly.  However,  over the weekend files with the
question mark in their names began to pile up again, generating the
errors I originally reported.

-
Anthony Tiradani
tiradani@....
+1 (630) 840-4479

On Fri, 2008-09-05 at 19&#58;48 +0000, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='5510#1220644090'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2008-09-05T19:48:10+00:00">Sep 5, 2008 07:48 PM UTC</time> by <b>Anthony Tiradani</b><a class="anchor" name="1220644090">&nbsp;</a></div><pre>I talked with Arvind instead of replying directly to this email because
there are 286 files in the ../output/gratia directory.  I didn&#39;t want to
send all that output via email.  According to Arvind the high load is
likely because of the volume of files left in this directory.  The
timestamps for the files are from today all the way back to July 23.
The file names are formatted a little strangely.

Example&#58;

2008-07-23T19&#58;04&#58;07Z?-cmsosgce4.fnal.gov-org.osg.batch.jobmanagers-available.py

Notice the &#34;?&#34;.  Would this be causing parsing problems in the perl
scripts?  I was able to execute&#58;
mv
2008-07-23T19&#58;04&#58;07Z?-cmsosgce4.fnal.gov-org.osg.batch.jobmanagers-available.py ../failed-gratia-scripts/

successfully.

I have manually moved all the files to the failed directory to see if
the load will go down and if there are more files with a question mark
in their name that get &#34;stuck&#34;.

-
Anthony Tiradani
tiradani@....
+1 (630) 840-4479

On Fri, 2008-09-05 at 17&#58;30 +0000, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='5510#1220637969'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2008-09-05T18:06:09+00:00">Sep 5, 2008 06:06 PM UTC</time> by <b>Anthony Tiradani</b><a class="anchor" name="1220637969">&nbsp;</a></div><pre>Hello,

Our setup is a standalone RSV installation monitoring 3 of our
gatekeepers.  I performed a vdt-control --off then vdt-control --on.
The memory usage was drastically reduced afterwards, but is slowly
climbing again.

-
Anthony Tiradani
tiradani@....
+1 (630) 840-4479

On Fri, 2008-09-05 at 17&#58;48 +0000, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='5510#1220636890'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2008-09-05T17:48:10+00:00">Sep 5, 2008 05:48 PM UTC</time> by <b>Scott Kronenfeld</b><a class="anchor" name="1220636890">&nbsp;</a></div><pre>Hi Tony,
The consumers do run continuously (they are kept alive by Condor-Cron
in case of crash), and as such, I&#39;m not surprised that they eventually
accumulate too much memory.  However, I&#39;m surprised by the amount of
memory (afaik, we have not seen anyone else&#39;s consumers using 2GB
memory), and also, a restart should have fixed the problem.  Did you
restart the entire OSG-RSV service?

On Fri, Sep 5, 2008 at 12&#58;30 PM, Open Science Grid FootPrints
&#60;osg@....&#62; wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='5510#1220635820'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2008-09-05T17:30:20+00:00">Sep 5, 2008 05:30 PM UTC</time> by <b>Arvind Gopu</b><a class="anchor" name="1220635820">&nbsp;</a></div><pre>Added rsv-ops to ticket&#39;s assignees. Copying n pasting my initial response to Tony here&#58;

<font color='#7F7E6F'>&#62; We (USCMS T1) have recently started seeing strange errors in the</font>
<font color='#7F7E6F'>&#62; gratia-script-consumer.err log file.</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; mv&#58; missing file argument</font>
<font color='#7F7E6F'>&#62; Try &#96;mv --help&#39; for more information.</font>
<font color='#7F7E6F'>&#62; sh&#58; line 1&#58; -cmsosgce.fnal.gov-org.osg.certificates.cacert-expiry.py&#58;</font>
<font color='#7F7E6F'>&#62; command not found</font>
<font color='#7F7E6F'>&#62; sh&#58; /opt/rsv-2.0/osg-rsv/output/gratia/2008-09-05T06&#58;26&#58;06Z&#58; No such</font>
<font color='#7F7E6F'>&#62; file or directory</font>
<font color='#7F7E6F'>&#62; sh&#58; line 1&#58; -cmsosgce2.fnal.gov-org.osg.general.osg-version.py&#58; command</font>
<font color='#7F7E6F'>&#62; not found</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; The gratia consumer consumes about a GB of memory and consumes as much</font>
<font color='#7F7E6F'>&#62; CPU time as it is allowed to. This behavior persists even after a</font>
<font color='#7F7E6F'>&#62; restart. I have a couple questions about this.</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; 1. Are html-consumer and gratia-script-consumer supposed to run</font>
<font color='#7F7E6F'>&#62; continuously or are they triggered by condor-cron?</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;</font>

Hi Tony,

Even though I&#39;ve never understood the intricate details of the consumer,
I understand those consumer jobs run continuously while also watching
for the load average on the system. Perhaps Scot/Alain (Condor-cron
experts) expand on that.

<font color='#7F7E6F'>&#62; 2. How do I fix the above errors?</font>

However,
a) I&#39;ve never seen that error you&#39;ve listed. We need to
investigate... can you tell me what you find in&#58;
<div id='show_1317762484' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_1317762484'>/opt/rsv-2.0/osg-rsv/output/gratia/ .. also are there any files in
/opt/rsv-2.0/osg-rsv/output/failed-gratia-scripts/?

Cheers,
Arvind
</div><script type='text/javascript'>
        $('#show_1317762484').click(function() {
            $('#detail_1317762484').slideDown("normal");
            $('#show_1317762484').hide();
            $('#hide_1317762484').show();
        });
        $('#hide_1317762484').click(function() {
            $('#detail_1317762484').slideUp();
            $('#hide_1317762484').hide();
            $('#show_1317762484').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='5510#1220635630'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2008-09-05T17:27:10+00:00">Sep 5, 2008 05:27 PM UTC</time> by <b>Arvind Gopu</b><a class="anchor" name="1220635630">&nbsp;</a></div><pre><font color='#7F7E6F'>&#62; We (USCMS T1) have recently started seeing strange errors in the</font>
<font color='#7F7E6F'>&#62; gratia-script-consumer.err log file.</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; mv&#58; missing file argument</font>
<font color='#7F7E6F'>&#62; Try &#96;mv --help&#39; for more information.</font>
<font color='#7F7E6F'>&#62; sh&#58; line 1&#58; -cmsosgce.fnal.gov-org.osg.certificates.cacert-expiry.py&#58;</font>
<font color='#7F7E6F'>&#62; command not found</font>
<font color='#7F7E6F'>&#62; sh&#58; /opt/rsv-2.0/osg-rsv/output/gratia/2008-09-05T06&#58;26&#58;06Z&#58; No such</font>
<font color='#7F7E6F'>&#62; file or directory</font>
<font color='#7F7E6F'>&#62; sh&#58; line 1&#58; -cmsosgce2.fnal.gov-org.osg.general.osg-version.py&#58; command</font>
<font color='#7F7E6F'>&#62; not found</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; The gratia consumer consumes about a GB of memory and consumes as much</font>
<font color='#7F7E6F'>&#62; CPU time as it is allowed to.  This behavior persists even after a</font>
<font color='#7F7E6F'>&#62; restart.  I have a couple questions about this.</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; 1. Are html-consumer and gratia-script-consumer supposed to run</font>
<font color='#7F7E6F'>&#62; continuously or are they triggered by condor-cron?</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;</font>

Hi Tony,

Even though I&#39;ve never understood the intricate details of the consumer,
I understand those consumer jobs run continuously while also watching
for the load average on the system. Perhaps Scot/Alain (Condor-cron
experts) expand on that.

<font color='#7F7E6F'>&#62; 2. How do I fix the above errors?</font>
<font color='#7F7E6F'>&#62;</font>

However,
a) I&#39;ve never seen that error you&#39;ve listed. We need to
investigate... can you tell me what you find in&#58;
/opt/rsv-2.0/osg-rsv/output/gratia/ .. also are there any files in
<div id='show_1881428620' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_1881428620'>/opt/rsv-2.0/osg-rsv/output/failed-gratia-scripts/?

Cheers,
Arvind
</div><script type='text/javascript'>
        $('#show_1881428620').click(function() {
            $('#detail_1881428620').slideDown("normal");
            $('#show_1881428620').hide();
            $('#hide_1881428620').show();
        });
        $('#hide_1881428620').click(function() {
            $('#detail_1881428620').slideUp();
            $('#hide_1881428620').hide();
            $('#show_1881428620').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='5510#1220635346'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2008-09-05T17:22:26+00:00">Sep 5, 2008 05:22 PM UTC</time> by <b>echism</b><a class="anchor" name="1220635346">&nbsp;</a></div><pre>We (USCMS T1) have recently started seeing strange errors in the
gratia-script-consumer.err log file.

mv&#58; missing file argument
Try &#96;mv --help&#39; for more information.
sh&#58; line 1&#58; -cmsosgce.fnal.gov-org.osg.certificates.cacert-expiry.py&#58;
command not found
sh&#58; /opt/rsv-2.0/osg-rsv/output/gratia/2008-09-05T06&#58;26&#58;06Z&#58; No such
file or directory
sh&#58; line 1&#58; -cmsosgce2.fnal.gov-org.osg.general.osg-version.py&#58; command
not found

The gratia consumer consumes about a GB of memory and consumes as much
CPU time as it is allowed to.  This behavior persists even after a
restart.  I have a couple questions about this.

1. Are html-consumer and gratia-script-consumer supposed to run
continuously or are they triggered by condor-cron?

2. How do I fix the above errors?

Thank you,

-
Anthony Tiradani
tiradani@....
+1 (630) 840-4479</pre></div>
</div>
<script type="text/javascript">
function reset_anchor() {
    $("#updates .selected").removeClass("selected");
    var urls = document.location.toString().split('#'); 
    var anchor = urls[1];
    if(anchor) {
        $("a[name='"+anchor+"']").parents(".update_description").addClass("selected");
    }
}
function submitspam(ticket_id) {
    myret = confirm("Would you like to close this ticket as a security ticket, and submit the ticket content to akismet?");
    if(myret == true) {
        $.ajax("viewer/processspam?id="+ticket_id).done(function() {
            window.location.reload();
        });
    }
}

$(function() {
    reset_anchor();
    var ADDITIONAL_COOKIE_NAME = 'gocticket';
    var options = { path: '/', expires: 365};

    if(window.opener && window.opener.name == "gocticket_list") {
        v = $.cookie("closewindow");
        if(!v) {
            $("#closewindow").attr("checked", "checked"); //on by default
        } else {
            if(v == "checked") {
                $("#closewindow").attr("checked", "checked");
            }
        }
        $("#closewindow").click(function() {
            $.cookie("closewindow", $(this).attr('checked'), options);
        });
    } else {
        $("#closewindow_area").hide();
    }
    function updateTimeago() {
        $("time").timeago();
        setTimeout(updateTimeago, 30*1000);
    }
    updateTimeago();
    $(".description").focus(expand_description);
});
</script>
<hr/>
<footer>
<p>GOC Ticket Version 2.2 | <a href="https://ticket.opensciencegrid.org/goc/submit?app_issue_check=on&amp;app_issue_type=goc&amp;app_goc_url=https%3A%2F%2Fticket.opensciencegrid.org%3A443%2F5510">Report Bugs</a>
 | <a href="https://github.com/opensciencegrid/operations/blob/master/docs/privacy.md">Privacy Policy</a>
</p>

<p> <img align="top" src="images/tag_orange.png"/> Copyright 2018 The Trustees of Indiana University - Developed for Open Science Grid</p>
</footer>


</div><!--container-fluid-->
<script>
//used by searchbox
function parseValue(value) {
    var obj = new Object();
    var tokens = value.split("\t");
    obj.str = tokens[0];
    obj.count = tokens[1];
    return obj;
}

$(function() {
    //bootstrap-2.0.4 stuff
    $(".alert-message").alert();
    $(".dropdown-toggle").dropdown();
    $("span[rel='tooltip']").tooltip();
    $("a[rel=popover]").popover();

    //activate menu that user is currently on
    $("#menu_navigator").addClass("active"); 
    $("#submenu_").addClass("active"); 

    //translate zend validation error message to bootstrap
    $(".errors").addClass("alert").addClass("alert-error");

    //enable autocomplete for search box
    $("#search").autocomplete({
        source: function( request, response ) {
            $.ajax({
                url: "search/autocomplete",
                dataType: "text",
                data: {
                    //featureClass: "P",
                    //style: "full",
                    //maxRows: 12,
                    //name_startsWith: request.term
                    q: request.term
                },
                success: function( data ) {
                    response( $.map( data.split("\n"), function( item ) {
                        if(item == "") return null;
                        return {
                            value: item
                        }
                    }));
                }
            });
        },
        select: function(event, ui) {
            document.location = "search?q="+ui.item.value;
        }
    });
    
});
</script>


</body>
