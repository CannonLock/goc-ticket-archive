<!DOCTYPE html>
<html lang="en">
  <head>
  <base href="">
    <title>[31964] Inquiry - OSG Email Inquiry (CRITICAL&#58; too few perfsonar-raw-packet-loss-rate messages received by the netmon brokers)</title>    <meta charset="utf-8" />
    <meta name="verify-v1" content="na5IcAJsZVOfEkboRxuIiZ1zpZgnZiWra+nKcS7nA/o=" />
    <meta name="google-site-verification" content="DLrk3ft4s8b-S2TloLCL2LD_t6wcTjgSluf5pmiu2kA" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />
    <link href="https://ticket.opensciencegrid.org/rss" rel="alternate" type="application/rss+xml" title="GOC Ticket Update feed" />

    <style type="text/css">
      body {
        padding-top: 50px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
     #search {
            width: 300px;
     }

    </style>

<script src="https://code.jquery.com/jquery-3.0.0.js"></script>
<script src="https://code.jquery.com/jquery-migrate-3.0.1.js"></script>

   <link href="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet"/>
    <script src="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/js/bootstrap.min.js"></script>

    <link href="https://netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"/>
    <link href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/themes/smoothness/jquery-ui.min.css" rel="stylesheet"/>
 <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>


    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/js/select2.min.js"></script>

    <link href="css/ticket.css" rel="stylesheet" />
    <script src="lib/jquery.cookie.js"></script>

    <link href="images/tag_orange.png" rel="icon" type="image/png"/>
  </head>

  <body>
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>

            <a class="brand" style="padding: 6px 0px 0px 6px;" href="http://opensciencegrid.org"><img src="images/osglogo.40x30.png"/></a>
            <ul class="nav">
                <li class="dropdown"><a href="https://ticket.opensciencegrid.org/#" class="dropdown-toggle" data-toggle="dropdown">GOC Ticket <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    <li><a href="https://my.opensciencegrid.org">MyOSG</a></li>
                    <li><a href="https://oim.opensciencegrid.org">OIM</a></li>
                    <li class="active"><a href="https://ticket.opensciencegrid.org/index">Ticket</a></li>
	<li class="divider"></li>
	<li><a href="http://repo.grid.iu.edu">Repo</a></li>
	<li class="divider"></li>
	<li><a href="http://blogs.grid.iu.edu">Blog</a></li>
                    <li><a href="http://display.grid.iu.edu">Display</a></li>
                    <li><a href="http://osggoc.blogspot.com/">News</a></li>
                    </ul>
                </li>
            </ul>
            <ul class="nav pull-right">
                <li><a href="https://ticket.opensciencegrid.org/sso/">Login</a></li>            </ul>

            <div class="nav-collapse">
                <ul class="nav">
			 <li id="menu_submit"><a href="https://ticket.opensciencegrid.org/submit">Submit</a></li><li id="menu_view" class="dropdown"><a href="https://ticket.opensciencegrid.org/\#" class="dropdown-toggle" data-toggle="dropdown">View <b class="caret"></b></a><ul class="dropdown-menu"><li id="submenu_listopen"><a href="https://ticket.opensciencegrid.org/list/open">Open Tickets</a></li><li id="submenu_listrecentclose"><a href="https://ticket.opensciencegrid.org/list/recentclose">Recently Closed Tickets</a></li><li class="divider"></li><li id="submenu_alltickets"><a href="https://ticket.opensciencegrid.org/search?q=&amp;sort=id">All Tickets</a></li></ul></li>                </ul>

                <form class="navbar-search pull-right" action="https://ticket.opensciencegrid.org/viewer">
                    <input id="search" type="text" name="id" class="search-query span2" placeholder="Search Ticket" value=""/>
                </form>
            </div>
        </div>
      </div>
    </div>

<script type='text/javascript' src='lib/jquery.timeago.js'></script>
<script type='text/javascript' src='lib/byte2size.js'></script>
<style>
#updates .toolbar {
position: relative;
margin-top: 0px;
top: -10px;
font-weight: normal;
}
#updates a.anchor {
position: relative;
top: -50px;
}
#updates .selected pre {
animation:selected 2s;
animation-iteration-count: 2;
animation-direction: alternate;
-webkit-animation:selected 2s; 
-webkit-animation-iteration-count: 2;
-webkit-animation-direction: alternate;
box-shadow: inset 1px 1px 20px #9ad;
border: 1px solid #9ab;
margin: 5px 0px;
padding-left: 10px;
}
@keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ab;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
@-webkit-keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ad;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
#updates pre {
background-color: inherit;
line-height: 15px;
padding: 5px;
}
#updates .header {
color: #999;
}
#updates .update_history pre {
background-color: #eee;
color: #666;
font-size: 85%;
}
#updates .clickable {
cursor: pointer;
}
#updates .clickable:hover {
color: #D98719;
}
#updates .meta_information pre {
background-color: #fed;
}
#similar_tickets {
max-height: 300px;
overflow-y: auto;
pointer-events: none;
padding: 5px;
background-color: #f4f4f4;
}
.btn-toolbar {
margin-bottom: 0;
height: 30px;
}
#peers {
position: fixed;
bottom: 0px;
right: 0px;
z-index: 100;
list-style: none;
padding: 5px 0px 0px 5px;
margin: 0px;
background-color: white;
box-shadow: 0px 0px 10px white;
}
#peers li {
background-color: #ccc;
color: #000;
display: inline-block;
padding: 5px 10px;
margin-right: 5px;
position: relative;
}
/*
#peers li:hover {
background-color: #999;
cursor: pointer;
}
*/
#peers span.ip {
padding-left: 5px;
color: #666;
}
#peers .new {
bottom: -30px;
}
/*
#peers .me {
background-color: red;
}
*/
</style>

<div class="container-fluid">
<ul id="peers"></ul>
<div class="alert alert-danger"><a class="close" href="https://ticket.opensciencegrid.org/#" data-dismiss="alert">&times;</a>By the end of May 2018, the ticketing system at https://ticket.opensciencegrid.org will be retired and support will be provided at https://support.opensciencegrid.org. Throughout this transition the support email (help@opensciencegrid.org) will be available as a point of contact.<br><br>                                                   
                                                                                                                                                                                   
Please see the service migration page for details: https://opensciencegrid.github.io/technology/policy/service-migrations-spring-2018/#ticket</div><div id="presence" class="pull-right"></div><div class="ticketgui"><script type="text/javascript" src="lib/checktab.js"></script>

<script>
var expanded = false;
function expand_description() {
    var desc = $(".description");
    if(!expanded) {
        expanded = true;
        //expand to minheight
        var min = 250;
        if(desc.height() < min) {
            desc.animate({height: min}, 200);
        }
    }
}

$(document).ready(function() {
    $("input[name='nad']").datepicker({
        dateFormat: 'yy-mm-dd'
    });
});

</script>



<style>
.form-horizontal .control-label {
padding-top: inherit;
font-size:90%;
color:#666;
}
label {
margin-bottom: 0px;
}
.controls {
line-height: 18px;
}
</style>
<form class="form-horizontal" action="https://ticket.opensciencegrid.org/viewer/updatebasic?id=31964" method="post">
<div class="page-header">
    <h3><span class="muted">31964</span> / Inquiry - OSG Email Inquiry (CRITICAL&#58; too few perfsonar-raw-packet-loss-rate messages received by the netmon brokers)</h3>
</div>

<div class="row-fluid">
<div class="span5">
    <legend>Contact</legend>
    <div class="control-group">
        <label class="control-label">Full Name</label>
        <div class="controls">OSG GOC</div>
    </div>
    <div class="control-group">
        <label class="control-label">Email</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">Phone</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">CC</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>

    <legend>Details</legend>
    <div class="control-group"><label class="control-label">Ticket Links</label><div class="controls"></div></div>
    <div class="control-group">
        <label class="control-label">Ticket Type</label>
        <div class="controls">Problem/Request</div>
    </div>
    <div class="control-group">
        <label class="control-label">Priority</label>
        <div class="controls">Normal</div>
    </div>
    <div class="control-group">
        <label class="control-label">Status</label>
        <div class="controls">
Closed</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action</label>
        <div class="controls">Assess ticket/Determine NAI</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action Deadline</label>
        <div class="controls flag_red">2016-12-02</div>
    </div>

</div><!--span-->
<div class="span7">
    <legend>Assignees</legend>
        <br>

    <legend>Assignees</legend>
    TODO
    <br>

    <style>
legend.noborder {
border-bottom: none;
}
</style>

<div id="attachment-list"/>
<script>
$(function () {
    var first = true;
    $.getJSON("attachment/list/31964", function (files) {
        //console.dir(files);
        var html = "<table class=\"table table-condensed\">";
        $(files).each(function() {
            if(first) {
                first = false;
                html += "<legend class=\"noborder\">Attachmenets</legend>";
            }
            html += "<tr class=\"attachment\">";
            html += "<td><img src=\""+this.thumbnail_url+"\"/></td>";
            html += "<td><a href=\""+this.url+"\" target=\"_blank\">"+this.name+"</a></td>";
            html += "<td>"+bytesToSize(this.size, 1)+"</td>";
            html += "</tr>";
        });
        html += "</table>";
        $("#attachment-list").html(html);
    });
});

function download(url) {
    window.open(url, "_blank");
}
</script>


</div><!--span-->
</div><!--row-fluid-->


</form>

</div>
<div id="updates" style="clear: both;">
    <legend>Past Updates
    <div class="btn-toolbar pull-right toolbar">
        <div class="btn-group">
                <a class="btn btn-small" href="https://ticket.opensciencegrid.org/31964?sort=up&amp;"><i class="icon-arrow-up"></i> Sort</a>

        
        <a class="btn btn-small" href="https://ticket.opensciencegrid.org/31964?expandall=true&amp;">Expand Descriptions</a>        <a class="btn btn-small" target="_blank" href="mailto:osg@tick.globalnoc.iu.edu?subject=Open%20Science%20Grid%3A%20Inquiry%20-%20OSG%20Email%20Inquiry%20%28CRITICAL%26%2358%3B%20too%20few%20perfsonar-raw-packet-loss-rate%20messages%20received%20by%20the%20netmon%20brokers%29%20ISSUE%3D31964%20PROJ%3D71"><i class="icon-envelope"></i> Update w/Email</a>
        </div>
    </div><!--btn-toolbar-->
    </legend>

    <div class='update_description'><i onclick="document.location='31964#1480702286'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-12-02T18:11:26+00:00">Dec 2, 2016 06:11 PM UTC</time> by <b>Scott Teige</b><a class="anchor" name="1480702286">&nbsp;</a></div><pre>still running +2 hrs later. Resolving.</pre></div><div class='update_description'><i onclick="document.location='31964#1480697007'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-12-02T16:43:27+00:00">Dec 2, 2016 04:43 PM UTC</time><a class="anchor" name="1480697007">&nbsp;</a></div><pre>Hmm it could be that partition is running out of inode, Can you run

df -i

?

Thanks,

Edgar

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=Edgar Mauricio Fajardo Hernandez 2020</pre></div><div class='update_description'><i onclick="document.location='31964#1480696718'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-12-02T16:38:38+00:00">Dec 2, 2016 04:38 PM UTC</time><a class="anchor" name="1480696718">&nbsp;</a></div><pre>Thanks Scott,
Looks like it is working&#58;  <a href='https&#58;//psmad.grid.iu.edu/maddash-webui/' target='_blank' rel='nofollow'>https&#58;//psmad.grid.iu.edu/maddash-webui/</a>
If it still is running after lunch we can close this ticket now.   (Ticket was side-tracked by MaDDash)
Shawn

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=mckee/CN=500323/CN=Shawn Mc Kee</pre></div><div class='update_description'><i onclick="document.location='31964#1480689083'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-12-02T14:31:23+00:00">Dec 2, 2016 02:31 PM UTC</time><a class="anchor" name="1480689083">&nbsp;</a></div><pre>Thanks Andy,

I updated our &#34;Living Doc&#34; with this information&#58; <a href='https&#58;//docs.google.com/document/d/1l144BSo-88M0cLMMjKcKMIE-Q5s21X-w3lYl-0Pn_08/edit#' target='_blank' rel='nofollow'>https&#58;//docs.google.com/document/d/1l144BSo-88M0cLMMjKcKMIE-Q5s21X-w3lYl-0Pn_08/edit#</a>

Scott, can you verify the ownership is correct on /var/lib/maddash?    If it seems OK, please follow Andy&#39;s suggestion to stop MaDDash and clear the /var/lib/maddash/ directory via&#58;

rm -rf /var/lib/maddash/*

Then start MaDDash again.   Thanks,

Shawn

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=mckee/CN=500323/CN=Shawn Mc Kee</pre></div><div class='update_description'><i onclick="document.location='31964#1480688411'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-12-02T14:20:11+00:00">Dec 2, 2016 02:20 PM UTC</time> by <b>andy@....</b><a class="anchor" name="1480688411">&nbsp;</a></div><pre>That means it is having trouble accessing the embedded Derby database that
lives under &#34;/var/lib/maddash/“. One common cause is the disk being full,
but that’s not the only cause. Could also be file permissions on that
directory (should be owned be maddash user) as well.

If neither of those appear to be the issue, a fallback is to stop maddash,
run “rm -rf /var/lib/maddash/*” and start maddash again. That will rebuild
the database but you will lose the last 7 days of alert history. For
reference, the alert history is just whether a check returned
red/green/yellow/orange, etc. All your measurement data will be intact
since maddash does not store any of that information.

On December 2, 2016 at 8&#58;17&#58;04 AM, Open Science Grid FootPrints (
osg@....) wrote&#58;

[Duplicate message snipped]</pre></div><div class='update_description'><i onclick="document.location='31964#1480684591'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-12-02T13:16:31+00:00">Dec 2, 2016 01:16 PM UTC</time><a class="anchor" name="1480684591">&nbsp;</a></div><pre>Hi Scott,

This is very strange to me&#58;

&#34;The logs are not informative (at least not the ones I&#39;m looking at). For example
/var/log/maddash/maddash-server.netlogger.log contains this&#58;
...
level=INFO ts=2016-11-29T19&#58;05&#58;13.047695Z event=maddash.init.start guid=c2f84c6b-e4a2-4eb7-bf58-e90844ee0aca
level=ERROR ts=2016-11-29T19&#58;05&#58;50.105064Z event=maddash.init.end guid=c2f84c6b-e4a2-4eb7-bf58-e90844ee0aca status=-1 msg=&#34;Connections could not be acquired from the underlying database!&#34;

I see <a href='https&#58;//psmad.grid.iu.edu/maddash-webui/' target='_blank' rel='nofollow'>https&#58;//psmad.grid.iu.edu/maddash-webui/</a> is still down.

The monitoring at <a href='https&#58;//perfsonar-itb.grid.iu.edu/WLCGperfSONAR/check_mk/index.py?start_url=%2FWLCGperfSONAR%2Fcheck_mk%2Fview.py%3Fview_name%3Dhost%26host%3Dperfsonar2' target='_blank' rel='nofollow'>https&#58;//perfsonar-itb.grid.iu.edu/WLCGperfSONAR/check_mk/index.py?start_url=%2FWLCGperfSONAR%2Fcheck_mk%2Fview.py%3Fview_name%3Dhost%26host%3Dperfsonar2</a> shows all expected services except MaDDash are running correctly.

Andy, any idea on why MaDDash would run for a few minutes and then stop as above?

Shawn

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=mckee/CN=500323/CN=Shawn Mc Kee</pre></div><div class='update_description'><i onclick="document.location='31964#1480684589'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-12-02T13:16:29+00:00">Dec 2, 2016 01:16 PM UTC</time><a class="anchor" name="1480684589">&nbsp;</a></div><pre>Hi Scott,

This is very strange to me&#58;

&#34;The logs are not informative (at least not the ones I&#39;m looking at). For example
/var/log/maddash/maddash-server.netlogger.log contains this&#58;
...
level=INFO ts=2016-11-29T19&#58;05&#58;13.047695Z event=maddash.init.start guid=c2f84c6b-e4a2-4eb7-bf58-e90844ee0aca
level=ERROR ts=2016-11-29T19&#58;05&#58;50.105064Z event=maddash.init.end guid=c2f84c6b-e4a2-4eb7-bf58-e90844ee0aca status=-1 msg=&#34;Connections could not be acquired from the underlying database!&#34;

I see <a href='https&#58;//psmad.grid.iu.edu/maddash-webui/' target='_blank' rel='nofollow'>https&#58;//psmad.grid.iu.edu/maddash-webui/</a> is still down.

The monitoring at <a href='https&#58;//perfsonar-itb.grid.iu.edu/WLCGperfSONAR/check_mk/index.py?start_url=%2FWLCGperfSONAR%2Fcheck_mk%2Fview.py%3Fview_name%3Dhost%26host%3Dperfsonar2' target='_blank' rel='nofollow'>https&#58;//perfsonar-itb.grid.iu.edu/WLCGperfSONAR/check_mk/index.py?start_url=%2FWLCGperfSONAR%2Fcheck_mk%2Fview.py%3Fview_name%3Dhost%26host%3Dperfsonar2</a> shows all expected services except MaDDash are running correctly.

Andy, any idea on why MaDDash would run for a few minutes and then stop as above?

Shawn

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=mckee/CN=500323/CN=Shawn Mc Kee</pre></div><div class='update_description'><i onclick="document.location='31964#1480521249'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-11-30T15:54:09+00:00">Nov 30, 2016 03:54 PM UTC</time><a class="anchor" name="1480521249">&nbsp;</a></div><pre>We just discussed it with Shawn, I think we&#39;ll need to just check the size of the summary messages and if they&#39;re above say 30 MB, we log the event and drop them directly in the RSV collector. Looking in the files, all three cases are coming from two new boxes in the UK mesh introduced recently. We&#39;ll follow up to understand if they have changed their configuration in ways that would cause excessive summaries, but in general, we won&#39;t be able to avoid cases like this, therefore we will need to have a mechanism to protect operations.

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=mbabik/CN=555091/CN=Marian Babik</pre></div><div class='update_description'><i onclick="document.location='31964#1480454337'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-11-29T21:18:57+00:00">Nov 29, 2016 09:18 PM UTC</time><a class="anchor" name="1480454337">&nbsp;</a></div><pre>Thanks Scott,

I was able to look at them.

Marian,

They all look legit to me. Basically summary_data being just to big. I am not sure how you want to fix this?

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=Edgar Mauricio Fajardo Hernandez 2020</pre></div><div class='update_description'><i onclick="document.location='31964#1480452038'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-11-29T20:40:38+00:00">Nov 29, 2016 08:40 PM UTC</time> by <b>Scott Teige</b><a class="anchor" name="1480452038">&nbsp;</a></div><pre>Edgar, I&#39;ve changed the permissions, try again.

Shawn, I&#39;ve tried multiple service restarts, it will run for ~2 minutes then die leaving behind a pid file.
The logs are not informative (at least not the ones I&#39;m looking at). For example
/var/log/maddash/maddash-server.netlogger.log contains this&#58;
...
level=INFO ts=2016-11-29T19&#58;05&#58;13.047695Z event=maddash.init.start guid=c2f84c6b-e4a2-4eb7-bf58-e90844ee0aca
level=ERROR ts=2016-11-29T19&#58;05&#58;50.105064Z event=maddash.init.end guid=c2f84c6b-e4a2-4eb7-bf58-e90844ee0aca status=-1 msg=&#34;Connections could not be acquired from the underlying database!&#34;
...
(see below, about a day ago...)</pre></div><div class='update_description'><i onclick="document.location='31964#1480441107'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-11-29T17:38:27+00:00">Nov 29, 2016 05:38 PM UTC</time><a class="anchor" name="1480441107">&nbsp;</a></div><pre>Hi Scott,

AFAIK,

The maintenance is done, I still cannot read them&#58;

2016-11-29 17&#58;37&#58;21 UTC [emfajard@jump&#58;~]$ cat /net/nas01/Public/psds0/prolems
cat&#58; /net/nas01/Public/psds0/prolems&#58; Permission denied

Thanks,

Edgar

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=Edgar Mauricio Fajardo Hernandez 2020</pre></div><div class='update_description'><i onclick="document.location='31964#1480425362'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-11-29T13:16:02+00:00">Nov 29, 2016 01:16 PM UTC</time> by <b>Scott Teige</b><a class="anchor" name="1480425362">&nbsp;</a></div><pre><a href='http&#58;//osggoc.blogspot.com/2016/11/operations-emergency-maintenance.html' target='_blank' rel='nofollow'>http&#58;//osggoc.blogspot.com/2016/11/operations-emergency-maintenance.html</a></pre></div><div class='update_description'><i onclick="document.location='31964#1480360517'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-11-28T19:15:17+00:00">Nov 28, 2016 07:15 PM UTC</time><a class="anchor" name="1480360517">&nbsp;</a></div><pre>Hi Scott,

I tried looking at the files but I couldn&#39;t&#58;

cat /net/nas01/Public/psds0/prolems
cat&#58; /net/nas01/Public/psds0/prolems&#58; Stale file handle

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=Edgar Mauricio Fajardo Hernandez 2020</pre></div><div class='update_description'><i onclick="document.location='31964#1480357991'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-11-28T18:33:11+00:00">Nov 28, 2016 06:33 PM UTC</time> by <b>Shawn McKee</b><a class="anchor" name="1480357991">&nbsp;</a></div><pre>Thanks Scott,

Maybe the fix on the big files caused a problem with the database on psds0?
Can you try a&#58;

service maddash-server restart

Now?

Thanks,

Shawn

On Mon, Nov 28, 2016 at 10&#58;57 AM, Open Science Grid FootPrints &#60;
osg@....&#62; wrote&#58;

<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='31964#1480352010'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-11-28T16:53:30+00:00">Nov 28, 2016 04:53 PM UTC</time> by <b>Scott Teige</b><a class="anchor" name="1480352010">&nbsp;</a></div><pre>files larger than 10 MB are now automatically deleted once per hour at 40 minutes after the hour.
the simplevisor is restarted automatically at 45 minutes after every hour.

/etc/cron.d/bandaid is the crontab entry that handles this.</pre></div><div class='update_description'><i onclick="document.location='31964#1480348672'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-11-28T15:57:52+00:00">Nov 28, 2016 03:57 PM UTC</time> by <b>Scott Teige</b><a class="anchor" name="1480348672">&nbsp;</a></div><pre>saving them was a problem, I saved a few&#58;
# mv ./583acdcc/583acdd46b34a4 /net/nas01/Public/psds0/prolems
# mv ./583ad7e0/583ad7edb40fd8 /net/nas01/Public/psds0/prolems
# mv ./583ad948/583ad9588b112f /net/nas01/Public/psds0/prolems

then this&#58;
# find ./* -size +10M -delete

restarted simplevisor.

psds0 is showing a green light status at this time.

However...
<a href='https&#58;//perfsonar-itb.grid.iu.edu/WLCGperfSONAR/check_mk/view.py?view_name=aggr_single&aggr_name=Host%20perfsonar2' target='_blank' rel='nofollow'>https&#58;//perfsonar-itb.grid.iu.edu/WLCGperfSONAR/check_mk/view.py?view_name=aggr_single&aggr_name=Host%20perfsonar2</a>

I did this&#58;
# service maddash-server start

then found this in /var/log/maddash/maddash-server.netlogger.log &#58;
level=INFO ts=2016-11-28T15&#58;54&#58;09.967595Z event=maddash.init.start guid=be31892c-11c5-4204-8acb-c50edcca3a33
level=ERROR ts=2016-11-28T15&#58;54&#58;44.433115Z event=maddash.init.end guid=be31892c-11c5-4204-8acb-c50edcca3a33 status=-1 msg=&#34;Connections could not be acquired from the underlying database!&#34;</pre></div><div class='update_description'><i onclick="document.location='31964#1480343611'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-11-28T14:33:31+00:00">Nov 28, 2016 02:33 PM UTC</time><a class="anchor" name="1480343611">&nbsp;</a></div><pre>In case you could save the content of the 23 files larger than 100MB that would help us chase the bug. But if not, no problem.

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=mbabik/CN=555091/CN=Marian Babik</pre></div><div class='update_description'><i onclick="document.location='31964#1480343461'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-11-28T14:31:01+00:00">Nov 28, 2016 02:31 PM UTC</time><a class="anchor" name="1480343461">&nbsp;</a></div><pre>Please delete all files larger than 10MBs and restart the service (service simplevisor restart).

As a temporary measure, we&#39;ll probably need a regular cleanup (and regular restart of simplevisor) until the issue in the OSG collector is fixed.

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=mbabik/CN=555091/CN=Marian Babik</pre></div><div class='update_description'><i onclick="document.location='31964#1480343142'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-11-28T14:25:42+00:00">Nov 28, 2016 02:25 PM UTC</time> by <b>Scott Teige</b><a class="anchor" name="1480343142">&nbsp;</a></div><pre>/usr/local/rsv-perfsonar

contains 1.89 million files,
23 larger than 100 MB
113 larger than 10 MB
492 larger than 1 MB

How to proceed?</pre></div><div class='update_description'><i onclick="document.location='31964#1480342111'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-11-28T14:08:31+00:00">Nov 28, 2016 02:08 PM UTC</time><a class="anchor" name="1480342111">&nbsp;</a></div><pre>CERN message broker has been reporting attempts to send messages that are too big (&#62;100MB). This would explain why stompclt is failing as it could be essentially stuck on a single big message, unable to send it. Could you please check the file sizes in the stompclt cache directory /usr/local/ and check any files larger than 30MBs ?

If confirmed, this will require a follow up in the RSV collector as it&#39;s likely a bug.

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=mbabik/CN=555091/CN=Marian Babik</pre></div><div class='update_description'><i onclick="document.location='31964#1480338946'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-11-28T13:15:46+00:00">Nov 28, 2016 01:15 PM UTC</time> by <b>Scott Teige</b><a class="anchor" name="1480338946">&nbsp;</a></div><pre>psds0 and perfsonar2 have been failing since 24/Nov. Power cycling them then seemed to allow them to run until 27/Nov.
Power cycle was repeated 27/Nov, service failed again within minutes. Attempted service simplevisor start, initially
succeeded, simplevisor failed less than 3 minutes later.

publisher-simplevisor.log contains this for the relevant period&#58;

2016-11-28 13&#58;05&#58;32,137 simplevisor[2201793]&#58; [INFO] started
2016-11-28 13&#58;05&#58;32,341 simplevisor[2201793]&#58; [INFO] supervision cycle executed successfully in 0.204s&#58; 1 services OK, 0 services needed adjustment, 0 services failed adjustment
2016-11-28 13&#58;06&#58;02,633 simplevisor[2201793]&#58; [INFO] supervision cycle executed successfully in 0.254s&#58; 1 services OK, 0 services needed adjustment, 0 services failed adjustment
2016-11-28 13&#58;06&#58;32,929 simplevisor[2201793]&#58; [INFO] supervision cycle executed successfully in 0.253s&#58; 1 services OK, 0 services needed adjustment, 0 services failed adjustment
2016-11-28 13&#58;07&#58;28,970 simplevisor[2201793]&#58; [INFO] service dashb-test-mb stopped for cleaning with result&#58; (0, &#39;stompclt (pid 2201811) is being told to quit...&#92;nstompclt does not seem to be running anymore&#92;n&#39;, &#39;&#39;)
2016-11-28 13&#58;07&#58;29,273 simplevisor[2201793]&#58; [INFO] service dashb-test-mb started with result&#58; (0, &#39;stompclt (pid 2205779) started&#92;n&#39;, &#39;&#39;)
2016-11-28 13&#58;07&#58;29,274 simplevisor[2201793]&#58; [ERROR] perfsonar1 handled 4 adjustments in 12 supervision cycles
2016-11-28 13&#58;07&#58;29,274 simplevisor[2201793]&#58; [ERROR] perfsonar1 handled 4 adjustments in 12 supervision cycles
2016-11-28 13&#58;07&#58;43,429 simplevisor[2201793]&#58; [INFO] service dashb-test-mb found running, stopped with result&#58; (0, &#39;stompclt (pid 2205779) is being told to quit...&#92;nstompclt does not seem to be running anymore&#92;n&#39;, &#39;&#39;)
2016-11-28 13&#58;07&#58;43,429 simplevisor[2201793]&#58; [INFO] supervisor perfsonar1 stopped, starting it
2016-11-28 13&#58;07&#58;43,834 simplevisor[2201793]&#58; [INFO] service dashb-test-mb started with result&#58; (0, &#39;stompclt (pid 2206082) started&#92;n&#39;, &#39;&#39;)
2016-11-28 13&#58;07&#58;43,835 simplevisor[2201793]&#58; [ERROR] perfsonar-supervisor handled 4 adjustments in 12 supervision cycles
2016-11-28 13&#58;07&#58;43,835 simplevisor[2201793]&#58; [ERROR] perfsonar-supervisor handled 4 adjustments in 12 supervision cycles
2016-11-28 13&#58;07&#58;48,208 simplevisor[2201793]&#58; [INFO] service dashb-test-mb found running, stopped with result&#58; (0, &#39;stompclt (pid 2206082) is being told to quit...&#92;nstompclt does not seem to be running anymore&#92;n&#39;, &#39;&#39;)
2016-11-28 13&#58;07&#58;48,209 simplevisor[2201793]&#58; [ERROR] supervision interrupted/failed

Ideas?</pre></div><div class='update_description'><i onclick="document.location='31964#1480276477'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-11-27T19:54:37+00:00">Nov 27, 2016 07:54 PM UTC</time> by <b>Raynor Moore</b><a class="anchor" name="1480276477">&nbsp;</a></div><pre>From&#58; CERN Messaging Team &#60;mignr@....&#62;
To&#58; perfsonar-esmond-mq@....
cc&#58; CERN Messaging Team &#60;mig@....&#62;
Subject&#58; CRITICAL&#58; too few perfsonar-summary-packet-loss-rate messages received by the netmon brokers
Date-Sent&#58; Sunday, November 27, 2016 3&#58;08 PM +0100

There are too few (0 msg/sec) messages received by the netmon brokers
for your client perfsonar-summary-packet-loss-rate (/topic/perfsonar.summary.packet-loss-rate), see&#58;
<a href='https&#58;//mig-graphite.cern.ch/r/brkclt/received/perfsonar-summary-packet-loss-rate' target='_blank' rel='nofollow'>https&#58;//mig-graphite.cern.ch/r/brkclt/received/perfsonar-summary-packet-loss-rate</a>

Please make sure that your producers are working correctly.

Regards,

CERN Messaging Team - mig@.... - <a href='http&#58;//cern.ch/mig' target='_blank' rel='nofollow'>http&#58;//cern.ch/mig</a>

From&#58; CERN Messaging Team &#60;mignr@....&#62;
To&#58; perfsonar-esmond-mq@....
cc&#58; CERN Messaging Team &#60;mig@....&#62;
Subject&#58; CRITICAL&#58; too few perfsonar-raw-packet-loss-rate messages received by the netmon brokers
Date-Sent&#58; Sunday, November 27, 2016 3&#58;08 PM +0100

There are too few (0 msg/sec) messages received by the netmon brokers
for your client perfsonar-raw-packet-loss-rate (/topic/perfsonar.raw.packet-loss-rate), see&#58;
<a href='https&#58;//mig-graphite.cern.ch/r/brkclt/received/perfsonar-raw-packet-loss-rate' target='_blank' rel='nofollow'>https&#58;//mig-graphite.cern.ch/r/brkclt/received/perfsonar-raw-packet-loss-rate</a>

Please make sure that your producers are working correctly.

Regards,

CERN Messaging Team - mig@.... - <a href='http&#58;//cern.ch/mig' target='_blank' rel='nofollow'>http&#58;//cern.ch/mig</a></pre></div><legend>Similar Recent Tickets <small>modified within the last 30 days</small></legend><div id="similar_tickets"><p class="muted">No similar tickets found.</p></div>
</div>
<script type="text/javascript">
function reset_anchor() {
    $("#updates .selected").removeClass("selected");
    var urls = document.location.toString().split('#'); 
    var anchor = urls[1];
    if(anchor) {
        $("a[name='"+anchor+"']").parents(".update_description").addClass("selected");
    }
}
function submitspam(ticket_id) {
    myret = confirm("Would you like to close this ticket as a security ticket, and submit the ticket content to akismet?");
    if(myret == true) {
        $.ajax("viewer/processspam?id="+ticket_id).done(function() {
            window.location.reload();
        });
    }
}

$(function() {
    reset_anchor();
    var ADDITIONAL_COOKIE_NAME = 'gocticket';
    var options = { path: '/', expires: 365};

    if(window.opener && window.opener.name == "gocticket_list") {
        v = $.cookie("closewindow");
        if(!v) {
            $("#closewindow").attr("checked", "checked"); //on by default
        } else {
            if(v == "checked") {
                $("#closewindow").attr("checked", "checked");
            }
        }
        $("#closewindow").click(function() {
            $.cookie("closewindow", $(this).attr('checked'), options);
        });
    } else {
        $("#closewindow_area").hide();
    }
    function updateTimeago() {
        $("time").timeago();
        setTimeout(updateTimeago, 30*1000);
    }
    updateTimeago();
    $(".description").focus(expand_description);
});
</script>
<hr/>
<footer>
<p>GOC Ticket Version 2.2 | <a href="https://ticket.opensciencegrid.org/goc/submit?app_issue_check=on&amp;app_issue_type=goc&amp;app_goc_url=https%3A%2F%2Fticket.opensciencegrid.org%3A443%2F31964">Report Bugs</a>
 | <a href="https://github.com/opensciencegrid/operations/blob/master/docs/privacy.md">Privacy Policy</a>
</p>

<p> <img align="top" src="images/tag_orange.png"/> Copyright 2018 The Trustees of Indiana University - Developed for Open Science Grid</p>
</footer>


</div><!--container-fluid-->
<script>
//used by searchbox
function parseValue(value) {
    var obj = new Object();
    var tokens = value.split("\t");
    obj.str = tokens[0];
    obj.count = tokens[1];
    return obj;
}

$(function() {
    //bootstrap-2.0.4 stuff
    $(".alert-message").alert();
    $(".dropdown-toggle").dropdown();
    $("span[rel='tooltip']").tooltip();
    $("a[rel=popover]").popover();

    //activate menu that user is currently on
    $("#menu_navigator").addClass("active"); 
    $("#submenu_").addClass("active"); 

    //translate zend validation error message to bootstrap
    $(".errors").addClass("alert").addClass("alert-error");

    //enable autocomplete for search box
    $("#search").autocomplete({
        source: function( request, response ) {
            $.ajax({
                url: "search/autocomplete",
                dataType: "text",
                data: {
                    //featureClass: "P",
                    //style: "full",
                    //maxRows: 12,
                    //name_startsWith: request.term
                    q: request.term
                },
                success: function( data ) {
                    response( $.map( data.split("\n"), function( item ) {
                        if(item == "") return null;
                        return {
                            value: item
                        }
                    }));
                }
            });
        },
        select: function(event, ui) {
            document.location = "search?q="+ui.item.value;
        }
    });
    
});
</script>


</body>
