<!DOCTYPE html>
<html lang="en">
  <head>
  <base href="">
    <title>[20884] osg-configure Gratia module fails to parse configuration that used to work</title>    <meta charset="utf-8" />
    <meta name="verify-v1" content="na5IcAJsZVOfEkboRxuIiZ1zpZgnZiWra+nKcS7nA/o=" />
    <meta name="google-site-verification" content="DLrk3ft4s8b-S2TloLCL2LD_t6wcTjgSluf5pmiu2kA" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />
    <link href="https://ticket.opensciencegrid.org/rss" rel="alternate" type="application/rss+xml" title="GOC Ticket Update feed" />

    <style type="text/css">
      body {
        padding-top: 50px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
     #search {
            width: 300px;
     }

    </style>

<script src="https://code.jquery.com/jquery-3.0.0.js"></script>
<script src="https://code.jquery.com/jquery-migrate-3.0.1.js"></script>

   <link href="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet"/>
    <script src="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/js/bootstrap.min.js"></script>

    <link href="https://netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"/>
    <link href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/themes/smoothness/jquery-ui.min.css" rel="stylesheet"/>
 <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>


    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/js/select2.min.js"></script>

    <link href="css/ticket.css" rel="stylesheet" />
    <script src="lib/jquery.cookie.js"></script>

    <link href="images/tag_orange.png" rel="icon" type="image/png"/>
  </head>

  <body>
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>

            <a class="brand" style="padding: 6px 0px 0px 6px;" href="http://opensciencegrid.org"><img src="images/osglogo.40x30.png"/></a>
            <ul class="nav">
                <li class="dropdown"><a href="https://ticket.opensciencegrid.org/#" class="dropdown-toggle" data-toggle="dropdown">GOC Ticket <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    <li><a href="https://my.opensciencegrid.org">MyOSG</a></li>
                    <li><a href="https://oim.opensciencegrid.org">OIM</a></li>
                    <li class="active"><a href="https://ticket.opensciencegrid.org/index">Ticket</a></li>
	<li class="divider"></li>
	<li><a href="http://repo.grid.iu.edu">Repo</a></li>
	<li class="divider"></li>
	<li><a href="http://blogs.grid.iu.edu">Blog</a></li>
                    <li><a href="http://display.grid.iu.edu">Display</a></li>
                    <li><a href="http://osggoc.blogspot.com/">News</a></li>
                    </ul>
                </li>
            </ul>
            <ul class="nav pull-right">
                <li><a href="https://ticket.opensciencegrid.org/sso/">Login</a></li>            </ul>

            <div class="nav-collapse">
                <ul class="nav">
			 <li id="menu_submit"><a href="https://ticket.opensciencegrid.org/submit">Submit</a></li><li id="menu_view" class="dropdown"><a href="https://ticket.opensciencegrid.org/\#" class="dropdown-toggle" data-toggle="dropdown">View <b class="caret"></b></a><ul class="dropdown-menu"><li id="submenu_listopen"><a href="https://ticket.opensciencegrid.org/list/open">Open Tickets</a></li><li id="submenu_listrecentclose"><a href="https://ticket.opensciencegrid.org/list/recentclose">Recently Closed Tickets</a></li><li class="divider"></li><li id="submenu_alltickets"><a href="https://ticket.opensciencegrid.org/search?q=&amp;sort=id">All Tickets</a></li></ul></li>                </ul>

                <form class="navbar-search pull-right" action="https://ticket.opensciencegrid.org/viewer">
                    <input id="search" type="text" name="id" class="search-query span2" placeholder="Search Ticket" value=""/>
                </form>
            </div>
        </div>
      </div>
    </div>

<script type='text/javascript' src='lib/jquery.timeago.js'></script>
<script type='text/javascript' src='lib/byte2size.js'></script>
<style>
#updates .toolbar {
position: relative;
margin-top: 0px;
top: -10px;
font-weight: normal;
}
#updates a.anchor {
position: relative;
top: -50px;
}
#updates .selected pre {
animation:selected 2s;
animation-iteration-count: 2;
animation-direction: alternate;
-webkit-animation:selected 2s; 
-webkit-animation-iteration-count: 2;
-webkit-animation-direction: alternate;
box-shadow: inset 1px 1px 20px #9ad;
border: 1px solid #9ab;
margin: 5px 0px;
padding-left: 10px;
}
@keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ab;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
@-webkit-keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ad;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
#updates pre {
background-color: inherit;
line-height: 15px;
padding: 5px;
}
#updates .header {
color: #999;
}
#updates .update_history pre {
background-color: #eee;
color: #666;
font-size: 85%;
}
#updates .clickable {
cursor: pointer;
}
#updates .clickable:hover {
color: #D98719;
}
#updates .meta_information pre {
background-color: #fed;
}
#similar_tickets {
max-height: 300px;
overflow-y: auto;
pointer-events: none;
padding: 5px;
background-color: #f4f4f4;
}
.btn-toolbar {
margin-bottom: 0;
height: 30px;
}
#peers {
position: fixed;
bottom: 0px;
right: 0px;
z-index: 100;
list-style: none;
padding: 5px 0px 0px 5px;
margin: 0px;
background-color: white;
box-shadow: 0px 0px 10px white;
}
#peers li {
background-color: #ccc;
color: #000;
display: inline-block;
padding: 5px 10px;
margin-right: 5px;
position: relative;
}
/*
#peers li:hover {
background-color: #999;
cursor: pointer;
}
*/
#peers span.ip {
padding-left: 5px;
color: #666;
}
#peers .new {
bottom: -30px;
}
/*
#peers .me {
background-color: red;
}
*/
</style>

<div class="container-fluid">
<ul id="peers"></ul>
<div class="alert alert-danger"><a class="close" href="https://ticket.opensciencegrid.org/#" data-dismiss="alert">&times;</a>By the end of May 2018, the ticketing system at https://ticket.opensciencegrid.org will be retired and support will be provided at https://support.opensciencegrid.org. Throughout this transition the support email (help@opensciencegrid.org) will be available as a point of contact.<br><br>                                                   
                                                                                                                                                                                   
Please see the service migration page for details: https://opensciencegrid.github.io/technology/policy/service-migrations-spring-2018/#ticket</div><div id="presence" class="pull-right"></div><div class="ticketgui"><script type="text/javascript" src="lib/checktab.js"></script>

<script>
var expanded = false;
function expand_description() {
    var desc = $(".description");
    if(!expanded) {
        expanded = true;
        //expand to minheight
        var min = 250;
        if(desc.height() < min) {
            desc.animate({height: min}, 200);
        }
    }
}

$(document).ready(function() {
    $("input[name='nad']").datepicker({
        dateFormat: 'yy-mm-dd'
    });
});

</script>



<style>
.form-horizontal .control-label {
padding-top: inherit;
font-size:90%;
color:#666;
}
label {
margin-bottom: 0px;
}
.controls {
line-height: 18px;
}
</style>
<form class="form-horizontal" action="https://ticket.opensciencegrid.org/viewer/updatebasic?id=20884" method="post">
<div class="page-header">
    <h3><span class="muted">20884</span> / osg-configure Gratia module fails to parse configuration that used to work</h3>
</div>

<div class="row-fluid">
<div class="span5">
    <legend>Contact</legend>
    <div class="control-group">
        <label class="control-label">Full Name</label>
        <div class="controls">Samir Cury Siqueira</div>
    </div>
    <div class="control-group">
        <label class="control-label">Email</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">Phone</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">CC</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>

    <legend>Details</legend>
    <div class="control-group"><label class="control-label">Submitted Via</label><div class="controls">GOC Ticket/submit</div></div><div class="control-group"><label class="control-label">Submitter</label><div class="controls">Samir Cury Siqueira</div></div><div class="control-group"><label class="control-label">Support Center</label><div class="controls">GRATIA Ops</div></div>
    <div class="control-group">
        <label class="control-label">Ticket Type</label>
        <div class="controls">Problem/Request</div>
    </div>
    <div class="control-group">
        <label class="control-label">Priority</label>
        <div class="controls">Normal</div>
    </div>
    <div class="control-group">
        <label class="control-label">Status</label>
        <div class="controls">
Closed</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action</label>
        <div class="controls">Close ticket</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action Deadline</label>
        <div class="controls flag_red">2014-05-12</div>
    </div>

</div><!--span-->
<div class="span7">
    <legend>Assignees</legend>
    <div class="assignee" style="width: 60%">Software Support (Triage) <span class="muted"> / OSG Software Team</span></div><div class="assignee" style="width: 60%">Carl Edquist <span class="muted"> / OSG Software Team</span></div><div class="assignee" style="width: 60%">Matyas Selmeci <span class="muted"> / OSG Software Team</span></div>    <br>

    <legend>Assignees</legend>
    TODO
    <br>

    <style>
legend.noborder {
border-bottom: none;
}
</style>

<div id="attachment-list"/>
<script>
$(function () {
    var first = true;
    $.getJSON("attachment/list/20884", function (files) {
        //console.dir(files);
        var html = "<table class=\"table table-condensed\">";
        $(files).each(function() {
            if(first) {
                first = false;
                html += "<legend class=\"noborder\">Attachmenets</legend>";
            }
            html += "<tr class=\"attachment\">";
            html += "<td><img src=\""+this.thumbnail_url+"\"/></td>";
            html += "<td><a href=\""+this.url+"\" target=\"_blank\">"+this.name+"</a></td>";
            html += "<td>"+bytesToSize(this.size, 1)+"</td>";
            html += "</tr>";
        });
        html += "</table>";
        $("#attachment-list").html(html);
    });
});

function download(url) {
    window.open(url, "_blank");
}
</script>


</div><!--span-->
</div><!--row-fluid-->


</form>

</div>
<div id="updates" style="clear: both;">
    <legend>Past Updates
    <div class="btn-toolbar pull-right toolbar">
        <div class="btn-group">
                <a class="btn btn-small" href="https://ticket.opensciencegrid.org/20884?sort=up&amp;"><i class="icon-arrow-up"></i> Sort</a>

        
        <a class="btn btn-small" href="https://ticket.opensciencegrid.org/20884?expandall=true&amp;">Expand Descriptions</a>        <a class="btn btn-small" target="_blank" href="mailto:osg@tick.globalnoc.iu.edu?subject=Open%20Science%20Grid%3A%20osg-configure%20Gratia%20module%20fails%20to%20parse%20configuration%20that%20used%20to%20work%20ISSUE%3D20884%20PROJ%3D71"><i class="icon-envelope"></i> Update w/Email</a>
        </div>
    </div><!--btn-toolbar-->
    </legend>

    <div class='update_description'><i onclick="document.location='20884#1399589145'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-05-08T22:45:45+00:00">May 8, 2014 10:45 PM UTC</time> by <b>Matyas Selmeci</b><a class="anchor" name="1399589145">&nbsp;</a></div><pre>This isn&#39;t new. I think most people have &#34;condor_location = DEFAULT&#34; which would also work. I&#39;m updating both the error messages and the comments in the config file; I made the JIRA ticket <a href='https&#58;//jira.opensciencegrid.org/browse/SOFTWARE-1475' target='_blank' rel='nofollow'>https&#58;//jira.opensciencegrid.org/browse/SOFTWARE-1475</a> to keep track of that, and will close this one now.
-Mat</pre></div><div class='update_description'><i onclick="document.location='20884#1399588541'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-05-08T22:35:41+00:00">May 8, 2014 10:35 PM UTC</time><a class="anchor" name="1399588541">&nbsp;</a></div><pre>That was it &#58;

[root@ce-itb config.d]# osg-configure -v
Configuration verified successfully

Thanks a lot.

I don&#39;t know if I was the only affected site by it though. This seems like a change on how sites should configure these files. My production CEs are still configured with &#58;

; The condor_location setting should give the location of condor install directory
condor_location = /usr/bin

So maybe the best is to insert a protection in the code for this or to let people know that this changed. Regarding my issue it&#39;s solved so feel free to close the ticket.

Thanks,
Samir

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=samir/CN=695732/CN=Samir Cury Siqueira</pre></div><div class='update_description'><i onclick="document.location='20884#1399587277'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-05-08T22:14:37+00:00">May 8, 2014 10:14 PM UTC</time> by <b>Matyas Selmeci</b><a class="anchor" name="1399587277">&nbsp;</a></div><pre>Try setting &#34;condor_location = /usr&#34;
Looking at the code, it&#39;s trying to call $condor_location/bin/condor_config_val, so if condor_location is /usr/bin, it would be trying to call &#34;/usr/bin/bin/condor_config_val&#34;.
I&#39;ll fix the error message in the code to be more helpful.
-Mat</pre></div><div class='update_description'><i onclick="document.location='20884#1399587011'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-05-08T22:10:11+00:00">May 8, 2014 10:10 PM UTC</time><a class="anchor" name="1399587011">&nbsp;</a></div><pre>Hi Matias,

condor_location = /usr/bin

[root@ce-itb config.d]# ll /usr/bin | grep condor -c
40

Seems that all commands are there.

This is my condor_config &#58;

condor_config = /etc/condor/condor_config

I&#39;m not sure what you call condor_config_val -- how I&#39;m supposed to check it?

[root@ce-itb config.d]# env | grep -i condor
[root@ce-itb config.d]#

[root@ce-itb config.d]# echo $PATH
/usr/lib64/qt-3.3/bin&#58;/usr/local/sbin&#58;/usr/local/bin&#58;/sbin&#58;/bin&#58;/usr/sbin&#58;/usr/bin&#58;/root/bin

/usr/bin seems to be the condor binaries path, and is there.

Thanks,
Samir

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=samir/CN=695732/CN=Samir Cury Siqueira</pre></div><div class='update_description'><i onclick="document.location='20884#1399585701'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-05-08T21:48:21+00:00">May 8, 2014 09:48 PM UTC</time> by <b>Matyas Selmeci</b><a class="anchor" name="1399585701">&nbsp;</a></div><pre>Also, what&#39;s &#34;condor_location&#34; set to in 20-condor.ini ?
-Mat</pre></div><div class='update_description'><i onclick="document.location='20884#1399585274'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-05-08T21:41:14+00:00">May 8, 2014 09:41 PM UTC</time> by <b>Matyas Selmeci</b><a class="anchor" name="1399585274">&nbsp;</a></div><pre>Hi,
Can you make sure that wherever condor_config_val is is in $PATH when you run osg-configure?
-Mat</pre></div><div class='update_description'><i onclick="document.location='20884#1399572819'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-05-08T18:13:39+00:00">May 8, 2014 06:13 PM UTC</time><a class="anchor" name="1399572819">&nbsp;</a></div><pre>I understood from Matyas that it wouldn&#39;t help, but let&#39;s try &#58;

Updating&#58;
osg-configure                                           noarch                              1.0.54-3.osg32.el6                                osg-testing                              129 k
osg-configure-ce                                        noarch                              1.0.54-3.osg32.el6                                osg-testing                               16 k
osg-configure-cemon                                     noarch                              1.0.54-3.osg32.el6                                osg-testing                               13 k
osg-configure-condor                                    noarch                              1.0.54-3.osg32.el6                                osg-testing                               14 k
osg-configure-gip                                       noarch                              1.0.54-3.osg32.el6                                osg-testing                               16 k
osg-configure-gratia                                    noarch                              1.0.54-3.osg32.el6                                osg-testing                               14 k
osg-configure-infoservices                              noarch                              1.0.54-3.osg32.el6                                osg-testing                               14 k
osg-configure-managedfork                               noarch                              1.0.54-3.osg32.el6                                osg-testing                               14 k
osg-configure-misc                                      noarch                              1.0.54-3.osg32.el6                                osg-testing                               14 k
osg-configure-network                                   noarch                              1.0.54-3.osg32.el6                                osg-testing                               14 k
osg-configure-squid                                     noarch                              1.0.54-3.osg32.el6                                osg-testing                               14 k
Installing for dependencies&#58;
osg-configure-gateway                                   noarch                              1.0.54-3.osg32.el6                                osg-testing                               14 k

Nope &#58;

[root@ce-itb config.d]# osg-configure -v
Please contact the developer, an unknown error occurred
CRITICAL Unknown exception encountered while running&#58; [Errno 2] No such file or directory
Unknown exception encountered while running&#58; [Errno 2] No such file or directory
You may be able to get more details rerunning /usr/sbin/osg-configure with the -d option and/or by examining /var/log/osg/osg-configure.log

Let me know as soon as the code that fixes it is somewhere. it should be about copying the gratia module file over and trying.

Thanks,
Samir

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=samir/CN=695732/CN=Samir Cury Siqueira</pre></div><div class='update_description'><i onclick="document.location='20884#1399567903'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-05-08T16:51:43+00:00">May 8, 2014 04:51 PM UTC</time><a class="anchor" name="1399567903">&nbsp;</a></div><pre>Hi Samir,

have you tried the new version on the osg-testing repo?

Edgar
OSG Software Team

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=Edgar Mauricio Fajardo Hernandez 2020</pre></div><div class='update_description'><i onclick="document.location='20884#1399487068'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-05-07T18:24:28+00:00">May 7, 2014 06:24 PM UTC</time> by <b>Matyas Selmeci</b><a class="anchor" name="1399487068">&nbsp;</a></div><pre>Hi Samir,
The new version of osg-configure is available in the testing repositories so you can do &#34;yum upgrade --enablerepo=osg-testing osg-configure&#92;*&#34;, but the fix for your problem isn&#39;t in yet.
I&#39;ll get to work on it as soon as I can, and will try to find a workaround for you in the meantime.
-Mat</pre></div><div class='update_description'><i onclick="document.location='20884#1399483031'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-05-07T17:17:11+00:00">May 7, 2014 05:17 PM UTC</time><a class="anchor" name="1399483031">&nbsp;</a></div><pre>I see that there are some recent updates to OSG-configure. Any way that I could checkout and try the latest code, just in case this was already solved in earlier releases? I really would like to get this CE working ASAP.

Thanks,
Samir

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=samir/CN=695732/CN=Samir Cury Siqueira</pre></div><div class='update_description'><i onclick="document.location='20884#1399406035'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-05-06T19:53:55+00:00">May 6, 2014 07:53 PM UTC</time> by <b>Carl Edquist</b><a class="anchor" name="1399406035">&nbsp;</a></div><pre>Hi Samir, very sorry for the delay replying on this one...

This doesn&#39;t seem to be related to the recent gratia issues, my guess is it&#39;s specific to osg-configure; I&#39;m adding Mat since he works on that now.  But I&#39;ll see if I can reproduce also.

Mat, can you take a look?

Thanks!
Carl</pre></div><div class='update_description'><i onclick="document.location='20884#1399393769'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-05-06T16:29:29+00:00">May 6, 2014 04:29 PM UTC</time> by <b>Christopher Pipes</b><a class="anchor" name="1399393769">&nbsp;</a></div><pre>Software Team,

Do you have any updates on this?

thanks,
Chris</pre></div><div class='update_description'><i onclick="document.location='20884#1399051113'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-05-02T17:18:33+00:00">May 2, 2014 05:18 PM UTC</time> by <b>Christopher Pipes</b><a class="anchor" name="1399051113">&nbsp;</a></div><pre>Software Team,

Would this have had anything to do with the GRATIA issues we were having? Or is this something unrelated ? Also if this should be sent to the GRAITA team let me know and I will send it that way.

Thanks,
Chris</pre></div><div class='update_description'><i onclick="document.location='20884#1398875698'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-04-30T16:34:58+00:00">Apr 30, 2014 04:34 PM UTC</time><a class="anchor" name="1398875698">&nbsp;</a></div><pre>Hi,

I have a production CE upgrade on hold because of this, if it could get a bit more of attention - at least to the point of figuring out if the problem is my configuration or the parser code, it will help me to move forward.

In the meanwhile one of my CEs BDII publication is intermittent and CE High Availability is not guaranteed &#58;

<a href='https&#58;//ggus.eu/index.php?mode=ticket_info&ticket_id=103174' target='_blank' rel='nofollow'>https&#58;//ggus.eu/index.php?mode=ticket_info&ticket_id=103174</a>

Thanks,
Samir

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=samir/CN=695732/CN=Samir Cury Siqueira</pre></div><div class='update_description'><i onclick="document.location='20884#1398474314'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-04-26T01:05:14+00:00">Apr 26, 2014 01:05 AM UTC</time><a class="anchor" name="1398474314">&nbsp;</a></div><pre>Couldn&#39;t attach the files while creating the ticket. Here they are.

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=samir/CN=695732/CN=Samir Cury Siqueira</pre></div><div class='update_description'><i onclick="document.location='20884#1398474243'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-04-26T01:04:03+00:00">Apr 26, 2014 01:04 AM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1398474243">&nbsp;</a></div><pre>Dear OSG Software,

Unless I&#39;m missing something, we might have a bug in the Gratia module for osg-configure. If I use the same or similar configuration than in my production SL5/3.1 OSGCE osg-configure just crashes. Details in the thread &#34;osg-configure -v - &#34;file not found&#34;?&#34; in the osg-sites list.

It should be pretty straightforward to reproduce. I just did in a VM with the very same config file than in production. I spotted the bug in SL5/OSG3.2 but what we want to support is SL6/OSG 3.2.

Once a GRAM CE is setup through &#58; <a href='https&#58;//twiki.grid.iu.edu/bin/view/Documentation/Release3/InstallComputeElement' target='_blank' rel='nofollow'>https&#58;//twiki.grid.iu.edu/bin/view/Documentation/Release3/InstallComputeElement</a>

osg-configure -v will fail if Gratia reporting is turned on. The only potential point of failure that I found was this variable &#58;

probes = jobmanager&#58;gratia-osg-itb.opensciencegrid.org&#58;80

So I tried as you see (no variable, single probe to make it easier for parsing), 2 probes, 2 variables as I have in prod (see file). ITB and Prod values crash evenly. If &#58;

enabled = FALSE

Validation passes.

I also tested in a VM by tarballing the configuration I have in production (/etc/osg/config.d/), expanding it in the VM and running osg-configure -v -d with different setups. All of them crash and when I disable gratia they seem to go fine.

Please let me know. I&#39;m depending on this to upgrade a production CE. If it takes long I might have to proceed with the upgrade without Gratia reporting, if this makes it work and be deployed successfully. Of course we don&#39;t want to lose accounting.

I&#39;m attaching my ITB and Production configuraition files. Let me know if you need anything else.

Thanks,
Samir

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=samir/CN=695732/CN=Samir Cury Siqueira</pre></div><legend>Similar Recent Tickets <small>modified within the last 30 days</small></legend><div id="similar_tickets"><p class="muted">No similar tickets found.</p></div>
</div>
<script type="text/javascript">
function reset_anchor() {
    $("#updates .selected").removeClass("selected");
    var urls = document.location.toString().split('#'); 
    var anchor = urls[1];
    if(anchor) {
        $("a[name='"+anchor+"']").parents(".update_description").addClass("selected");
    }
}
function submitspam(ticket_id) {
    myret = confirm("Would you like to close this ticket as a security ticket, and submit the ticket content to akismet?");
    if(myret == true) {
        $.ajax("viewer/processspam?id="+ticket_id).done(function() {
            window.location.reload();
        });
    }
}

$(function() {
    reset_anchor();
    var ADDITIONAL_COOKIE_NAME = 'gocticket';
    var options = { path: '/', expires: 365};

    if(window.opener && window.opener.name == "gocticket_list") {
        v = $.cookie("closewindow");
        if(!v) {
            $("#closewindow").attr("checked", "checked"); //on by default
        } else {
            if(v == "checked") {
                $("#closewindow").attr("checked", "checked");
            }
        }
        $("#closewindow").click(function() {
            $.cookie("closewindow", $(this).attr('checked'), options);
        });
    } else {
        $("#closewindow_area").hide();
    }
    function updateTimeago() {
        $("time").timeago();
        setTimeout(updateTimeago, 30*1000);
    }
    updateTimeago();
    $(".description").focus(expand_description);
});
</script>
<hr/>
<footer>
<p>GOC Ticket Version 2.2 | <a href="https://ticket.opensciencegrid.org/goc/submit?app_issue_check=on&amp;app_issue_type=goc&amp;app_goc_url=https%3A%2F%2Fticket.opensciencegrid.org%3A443%2F20884">Report Bugs</a>
 | <a href="https://github.com/opensciencegrid/operations/blob/master/docs/privacy.md">Privacy Policy</a>
</p>

<p> <img align="top" src="images/tag_orange.png"/> Copyright 2018 The Trustees of Indiana University - Developed for Open Science Grid</p>
</footer>


</div><!--container-fluid-->
<script src="https://ticket1.grid.iu.edu:8443/socket.io/socket.io.js"></script>
<script>
var chat = io.connect('https://ticket1.grid.iu.edu:8443');
chat.on('connect', function() {
    chat.emit('authenticate', {nodekey:'', ticketid: 20884});
});
chat.on('peers', function(peers) {
    $("#peers").html("");
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('peer_disconnect', function(pid) {
    $("#peer_"+pid).hide("slow");
});
chat.on('peer_connected', function(peers) {
    //expect only 1 peer connecting, but..
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('submit', function() {
    if(confirm("This ticket was updated. Do you want to refresh?")) {
        history.go(0);
    }
});

function addPeer(pid, peer) {
    var ipinfo = "";
    if(peer.ip != undefined) {
        ipinfo = "<span class=\"ip\">"+peer.ip+"</span>";
    }
    if(chat.io.engine.id == pid) {
        //don't display myself
        return;
    }
    var html = "<li class=\"new\" id=\"peer_"+pid+"\" class=\"peer\">"+peer.name+ipinfo+"</li>";
    $("#peers").prepend(html);
    $("#peers .new").animate({bottom: 0}, 1000, function() {$(this).removeClass("new")});
}

$(function() {
    $("#ticket_form").submit(function() {
        chat.emit('submit');
        return true;
    });
});
</script>
<script>
//used by searchbox
function parseValue(value) {
    var obj = new Object();
    var tokens = value.split("\t");
    obj.str = tokens[0];
    obj.count = tokens[1];
    return obj;
}

$(function() {
    //bootstrap-2.0.4 stuff
    $(".alert-message").alert();
    $(".dropdown-toggle").dropdown();
    $("span[rel='tooltip']").tooltip();
    $("a[rel=popover]").popover();

    //activate menu that user is currently on
    $("#menu_navigator").addClass("active"); 
    $("#submenu_").addClass("active"); 

    //translate zend validation error message to bootstrap
    $(".errors").addClass("alert").addClass("alert-error");

    //enable autocomplete for search box
    $("#search").autocomplete({
        source: function( request, response ) {
            $.ajax({
                url: "search/autocomplete",
                dataType: "text",
                data: {
                    //featureClass: "P",
                    //style: "full",
                    //maxRows: 12,
                    //name_startsWith: request.term
                    q: request.term
                },
                success: function( data ) {
                    response( $.map( data.split("\n"), function( item ) {
                        if(item == "") return null;
                        return {
                            value: item
                        }
                    }));
                }
            });
        },
        select: function(event, ui) {
            document.location = "search?q="+ui.item.value;
        }
    });
    
});
</script>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-69012-13");
pageTracker._trackPageview();
} catch(err) {}
</script>

</body>
