<!DOCTYPE html>
<html lang="en">
  <head>
  <base href="">
    <title>[4271] dCache suspended transfers due to pools being unavailable</title>    <meta charset="utf-8" />
    <meta name="verify-v1" content="na5IcAJsZVOfEkboRxuIiZ1zpZgnZiWra+nKcS7nA/o=" />
    <meta name="google-site-verification" content="DLrk3ft4s8b-S2TloLCL2LD_t6wcTjgSluf5pmiu2kA" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />

    <style type="text/css">
      body {
        padding-top: 50px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
     #search {
            width: 300px;
     }

    </style>

<script src="https://code.jquery.com/jquery-3.0.0.js"></script>
<script src="https://code.jquery.com/jquery-migrate-3.0.1.js"></script>

   <link href="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet"/>
    <script src="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/js/bootstrap.min.js"></script>

    <link href="https://netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"/>
    <link href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/themes/smoothness/jquery-ui.min.css" rel="stylesheet"/>
 <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>


    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/js/select2.min.js"></script>

    <link href="css/ticket.css" rel="stylesheet" />
    <script src="lib/jquery.cookie.js"></script>

    <link href="images/tag_orange.png" rel="icon" type="image/png"/>
  </head>

  <body>
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>

            <a class="brand" style="padding: 6px 0px 0px 6px;" href="http://opensciencegrid.org"><img src="images/osglogo.40x30.png"/></a>
            <ul class="nav">
                <li class="dropdown"><a href="https://ticket.opensciencegrid.org/#" class="dropdown-toggle" data-toggle="dropdown">GOC Ticket <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    <li><a href="https://my.opensciencegrid.org">MyOSG</a></li>
                    <li><a href="https://oim.opensciencegrid.org">OIM</a></li>
                    <li class="active"><a href="https://ticket.opensciencegrid.org/index">Ticket</a></li>
	<li class="divider"></li>
	<li><a href="http://repo.grid.iu.edu">Repo</a></li>
	<li class="divider"></li>
	<li><a href="http://blogs.grid.iu.edu">Blog</a></li>
                    <li><a href="http://display.grid.iu.edu">Display</a></li>
                    <li><a href="http://osggoc.blogspot.com/">News</a></li>
                    </ul>
                </li>
            </ul>
            <ul class="nav pull-right">
                <li><a href="https://ticket.opensciencegrid.org/sso/">Login</a></li>            </ul>

            <div class="nav-collapse">
                <ul class="nav">
			 <li id="menu_submit"><a href="https://ticket.opensciencegrid.org/submit">Submit</a></li><li id="menu_view" class="dropdown"><a href="https://ticket.opensciencegrid.org/\#" class="dropdown-toggle" data-toggle="dropdown">View <b class="caret"></b></a><ul class="dropdown-menu"><li id="submenu_listopen"><a href="https://ticket.opensciencegrid.org/list/open">Open Tickets</a></li><li id="submenu_listrecentclose"><a href="https://ticket.opensciencegrid.org/list/recentclose">Recently Closed Tickets</a></li><li class="divider"></li><li id="submenu_alltickets"><a href="https://ticket.opensciencegrid.org/search?q=&amp;sort=id">All Tickets</a></li></ul></li>                </ul>

                <form class="navbar-search pull-right" action="https://ticket.opensciencegrid.org/viewer">
                    <input id="search" type="text" name="id" class="search-query span2" placeholder="Search Ticket" value=""/>
                </form>
            </div>
        </div>
      </div>
    </div>

<script type='text/javascript' src='lib/jquery.timeago.js'></script>
<script type='text/javascript' src='lib/byte2size.js'></script>
<style>
#updates .toolbar {
position: relative;
margin-top: 0px;
top: -10px;
font-weight: normal;
}
#updates a.anchor {
position: relative;
top: -50px;
}
#updates .selected pre {
animation:selected 2s;
animation-iteration-count: 2;
animation-direction: alternate;
-webkit-animation:selected 2s; 
-webkit-animation-iteration-count: 2;
-webkit-animation-direction: alternate;
box-shadow: inset 1px 1px 20px #9ad;
border: 1px solid #9ab;
margin: 5px 0px;
padding-left: 10px;
}
@keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ab;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
@-webkit-keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ad;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
#updates pre {
background-color: inherit;
line-height: 15px;
padding: 5px;
}
#updates .header {
color: #999;
}
#updates .update_history pre {
background-color: #eee;
color: #666;
font-size: 85%;
}
#updates .clickable {
cursor: pointer;
}
#updates .clickable:hover {
color: #D98719;
}
#updates .meta_information pre {
background-color: #fed;
}
#similar_tickets {
max-height: 300px;
overflow-y: auto;
pointer-events: none;
padding: 5px;
background-color: #f4f4f4;
}
.btn-toolbar {
margin-bottom: 0;
height: 30px;
}
#peers {
position: fixed;
bottom: 0px;
right: 0px;
z-index: 100;
list-style: none;
padding: 5px 0px 0px 5px;
margin: 0px;
background-color: white;
box-shadow: 0px 0px 10px white;
}
#peers li {
background-color: #ccc;
color: #000;
display: inline-block;
padding: 5px 10px;
margin-right: 5px;
position: relative;
}
/*
#peers li:hover {
background-color: #999;
cursor: pointer;
}
*/
#peers span.ip {
padding-left: 5px;
color: #666;
}
#peers .new {
bottom: -30px;
}
/*
#peers .me {
background-color: red;
}
*/
</style>

<div class="container-fluid">
<ul id="peers"></ul>
<div class="alert alert-danger"><a class="close" href="https://ticket.opensciencegrid.org/#" data-dismiss="alert">&times;</a>By the end of May 2018, the ticketing system at https://ticket.opensciencegrid.org will be retired and support will be provided at https://support.opensciencegrid.org. Throughout this transition the support email (help@opensciencegrid.org) will be available as a point of contact.<br><br>                                                   
                                                                                                                                                                                   
Please see the service migration page for details: https://opensciencegrid.github.io/technology/policy/service-migrations-spring-2018/#ticket</div><div id="presence" class="pull-right"></div><div class="ticketgui"><script type="text/javascript" src="lib/checktab.js"></script>

<script>
var expanded = false;
function expand_description() {
    var desc = $(".description");
    if(!expanded) {
        expanded = true;
        //expand to minheight
        var min = 250;
        if(desc.height() < min) {
            desc.animate({height: min}, 200);
        }
    }
}

$(document).ready(function() {
    $("input[name='nad']").datepicker({
        dateFormat: 'yy-mm-dd'
    });
});

</script>



<style>
.form-horizontal .control-label {
padding-top: inherit;
font-size:90%;
color:#666;
}
label {
margin-bottom: 0px;
}
.controls {
line-height: 18px;
}
</style>
<form class="form-horizontal" action="https://ticket.opensciencegrid.org/viewer/updatebasic?id=4271" method="post">
<div class="page-header">
    <h3><span class="muted">4271</span> / dCache suspended transfers due to pools being unavailable</h3>
</div>

<div class="row-fluid">
<div class="span5">
    <legend>Contact</legend>
    <div class="control-group">
        <label class="control-label">Full Name</label>
        <div class="controls">Neha Sharma</div>
    </div>
    <div class="control-group">
        <label class="control-label">Email</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">Phone</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">CC</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>

    <legend>Details</legend>
    
    <div class="control-group">
        <label class="control-label">Ticket Type</label>
        <div class="controls">Problem/Request</div>
    </div>
    <div class="control-group">
        <label class="control-label">Priority</label>
        <div class="controls">Normal</div>
    </div>
    <div class="control-group">
        <label class="control-label">Status</label>
        <div class="controls">
Closed</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action</label>
        <div class="controls">closed</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action Deadline</label>
        <div class="controls flag_red">2007-11-14</div>
    </div>

</div><!--span-->
<div class="span7">
    <legend>Assignees</legend>
    <div class="assignee" style="width: 60%">Neha Sharma <span class="muted"> / OSG Storage Team</span></div>    <br>

    <legend>Assignees</legend>
    TODO
    <br>

    <style>
legend.noborder {
border-bottom: none;
}
</style>

<div id="attachment-list"/>
<script>
$(function () {
    var first = true;
    $.getJSON("attachment/list/4271", function (files) {
        //console.dir(files);
        var html = "<table class=\"table table-condensed\">";
        $(files).each(function() {
            if(first) {
                first = false;
                html += "<legend class=\"noborder\">Attachmenets</legend>";
            }
            html += "<tr class=\"attachment\">";
            html += "<td><img src=\""+this.thumbnail_url+"\"/></td>";
            html += "<td><a href=\""+this.url+"\" target=\"_blank\">"+this.name+"</a></td>";
            html += "<td>"+bytesToSize(this.size, 1)+"</td>";
            html += "</tr>";
        });
        html += "</table>";
        $("#attachment-list").html(html);
    });
});

function download(url) {
    window.open(url, "_blank");
}
</script>


</div><!--span-->
</div><!--row-fluid-->


</form>

</div>
<div id="updates" style="clear: both;">
    <legend>Past Updates
    <div class="btn-toolbar pull-right toolbar">
    </div><!--btn-toolbar-->
    </legend>

    <div class='update_description'><i onclick="document.location='4271#1194986556'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2007-11-13T20:42:36+00:00">Nov 13, 2007 08:42 PM UTC</time> by <b>Neha Sharma</b><a class="anchor" name="1194986556">&nbsp;</a></div><pre>After increasing the timeout the probem is no longer seen. This ticket can be closed.</pre></div><div class='update_description'><i onclick="document.location='4271#1193852072'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2007-10-31T17:34:32+00:00">Oct 31, 2007 05:34 PM UTC</time> by <b>Neha Sharma</b><a class="anchor" name="1193852072">&nbsp;</a></div><pre>Jon suggested the user that problem could be due to pools busy handling the transfer
requests and not contacting the Pool Manager with in the time out period. So Pool
Manager thinks pools are not available. User has been asked to increase the time out
period and run a cron job that cleans up the suspended transfers.</pre></div><div class='update_description'><i onclick="document.location='4271#1193843630'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2007-10-31T15:13:50+00:00">Oct 31, 2007 03:13 PM UTC</time> by <b>Neha Sharma</b><a class="anchor" name="1193843630">&nbsp;</a></div><pre>Ilya Kravchenko wrote&#58;
Hi Ted,

We are having a problem with dCache at MIT. We are observing
frequent cases of suspended transfers according to PoolManager
&#34;rc ls&#34; command, for the reason &#34;PoolUnavailable&#34;. The rate
of this problem is ~10 new suspended transfers per hour. This makes
the problem rather urgent&#58; all such transfers are related to
analysis jobs of CMS users that are very interested in processing Monte Carlo
datasets right now.

All of our pools appear fine and healthy, always up. The transfers
themselves are dcap transfers from dCache pools to other nodes on
the internal Tier2 network. The suspended transfers are immediately
cleared by the &#34;rc retry &#60;pnfsid&#62;&#34; command that I execute by hand
from the admin interface.

We have seen this problem only rarely for a few files in the
past, but since last week the physics analysis activity has dramatically
increased at the MIT Tier2, and in addition I have added 300 more
condor batch slots, so I have that many more jobs running.

Can you help us to debug this problem? Below I list some relevant
debugging info.

Thank you,
Ilya
=======================================================

1. Similar behavior we observed when max movers in each pool
was too low (100). At present, max movers is 600 per pool,
and the active movers count is 50-70 (I have not seen it above 100).

2. At any given time we have about 1000-1200 active movers,
for about 600 condor processing jobs.
<div id='show_961918132' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_961918132'>
3. All stuck files are accessed via dcap.

4. From the dCacheDomain.log at the printout level 3, I see the
following message that appears to coincide with each new suspended transfer&#58;
10/29 09&#58;00&#58;13 Cell(PoolManager@dCacheDomain) &#58; Unexpected message class 9 class
diskCacheV111.vehicles.PoolCheckFileMessage from source =
[&#62;hibat0060_1@hibat0060Domain&#58;*@hibat0060Domain]

5. From the dCacheDomain.log at the printout level 5, here are
messages accompanying one example of suspended file&#58;

10/30 14&#58;16&#58;12 Cell(PoolManager@dCacheDomain) &#58; PFL [00010000000000000041D948] &#58;
calculateFileAvailableMatrix _acknowledgedPnfsPools &#58; []
10/30 14&#58;16&#58;12 Cell(PoolManager@dCacheDomain) &#58; PFL [00010000000000000041D948] &#58;
calculateFileAvailableMatrix &#58; db matrix[*,0] [hibat0059_1, hibat0060_1, hibat0050_1,
hibat0055_1, hibat0073_1, hibat0051_1, hibat0049_1, hibat0067_1, hibat0061_1,
hibat0058_1, hibat0006_1, hibat0052_1, hibat0048_1, hibat0069_1, hibat0070_1,
hibat0064_1, hibat0057_1, hibat0066_1, hibat0056_1, hibat0053_1, hibat0062_1,
hibat0054_1, hibat0071_1, hibat0063_1, hibat0005_1, hibat0072_1]
10/30 14&#58;16&#58;12 Cell(PoolManager@dCacheDomain) &#58; PFL [00010000000000000041D948] &#58;
calculateFileAvailableMatrix &#58; av matrix[*,0] []
10/30 14&#58;16&#58;12 Cell(PoolManager@dCacheDomain) &#58; 00010000000000000041D948 &#58;
askIfAvailable &#58; file not in pool at all
10/30 14&#58;16&#58;12 Cell(PoolManager@dCacheDomain) &#58; 00010000000000000041D948 &#58;
askIfAvailable &#58; Took  16432
10/30 14&#58;16&#58;12 Cell(PoolManager@dCacheDomain) &#58; 00010000000000000041D948 &#58;
StageEngine left with   &#58; Suspended  (Wait)
10/30 14&#58;16&#58;12 CellNucleus(PoolManager@dCacheDomain) &#58; addToEventQueue &#58; message
arrived &#58; &#60;CM&#58;
S=[&#62;hibat0060_1@hibat0060Domain&#58;*@hibat0060Domain];D=[*@dCacheDomain&#58;&#62;PoolManager@dCacheDomain&#58;*@dcap-t2srv0004Domain&#58;DCap-t2srv0004-unknown-222048@dcap-t2srv0004Domain];C=Stream;O=&#60;1193768172816&#58;415943&#62;;LO=&#60;1193767305006&#58;10907572&#62;&#62;
10/30 14&#58;16&#58;12 CellNucleus(PoolManager@dCacheDomain) &#58; messageThread &#58; MessageEvent
arrived
10/30 14&#58;16&#58;12 CellNucleus(PoolManager@dCacheDomain) &#58; messageThread &#58; delivering
message &#58; &#60;CM&#58;
S=[&#62;hibat0060_1@hibat0060Domain&#58;*@hibat0060Domain];D=[*@dCacheDomain&#58;&#62;PoolManager@dCacheDomain&#58;*@dcap-t2srv0004Domain&#58;DCap-t2srv0004-unknown-222048@dcap-t2srv0004Domain];C=diskCacheV111.vehicles.DoorTransferFinishedMessage;O=&#60;1193768172816&#58;415943&#62;;LO=&#60;1193767305006&#58;10907572&#62;&#62;
10/30 14&#58;16&#58;12 CellNucleus(PoolManager@dCacheDomain) &#58; messageThread &#58; delivering
message done &#58; &#60;CM&#58;
S=[&#62;hibat0060_1@hibat0060Domain&#58;*@hibat0060Domain];D=[*@dCacheDomain&#58;PoolManager@dCacheDomain&#58;&#62;*@dcap-t2srv0004Domain&#58;DCap-t2srv0004-unknown-222048@dcap-t2srv0004Domain];C=diskCacheV111.vehicles.DoorTransferFinishedMessage;O=&#60;1193768172816&#58;415943&#62;;LO=&#60;1193767305006&#58;10907572&#62;&#62;

6. From the dCache log file on the pool for the above example
at the printout level 3&#58;

10/30 14&#58;16&#58;13 Cell(hibat0060_1@hibat0060Domain) &#58; IO thread finished &#58;
Thread[IO-0-669700,5,hibat0060_1-threads]
10/30 14&#58;16&#58;13 Cell(hibat0060_1@hibat0060Domain) &#58; Sending reply
Pool=hibat0060_1;NOTAGS;;PnfsId=00010000000000000041D948;have=true;waiting=false
10/30 14&#58;16&#58;15 Cell(hibat0060_1@hibat0060Domain) &#58; (DCap_3_nio) (Transfer finished &#58;
54184566 bytes in 694 seconds)

(no more entries for this pnfsId)

7. PoolManager configuration, if it is relevant&#58;

(PoolManager) admin &#62; info
PoolManager V [$Id&#58; PoolManagerV5.java,v 1.32 2006/05/19 21&#58;38&#58;35
patrick Exp $]
SelectionUnit &#58; $Id&#58; PoolSelectionUnitV2.java,v 1.12.2.1 2006/09/07
12&#58;05&#58;05 patrick Exp $
Write Threads &#58; 0
Read  Threads &#58; 0
Pool Timeout &#58; 15
Decision &#58; space=1.0 cpu=1.0
Message counts
PoolUp &#58; 1808236
PoolDown &#58; 82
SelectReadPool &#58; 1044651
SelectWritePool &#58; 15874
Watchdog &#58; disabled
Restore Controller [$Revision&#58; 1.49.2.3 $]

Retry Timeout &#58; 900 seconds
Thread Controller &#58; Active threads &#58; 0/0/0
Maximum Retries &#58; 999
Pool Ping Timer &#58; 600 seconds
On Error &#58; suspend
Warning Path &#58; billing
Allow p2p &#58; on oncost=off fortransfer=off
Allow staging &#58; off
Allow stage on cost &#58; off
P2p Slope &#58; 0.0
P2p Max Copies &#58; 500
Cost Cuts &#58; idle=0.0,p2p=0.0,alert=0.0,halt=0.0,fallback=0.0
Restore Limit &#58; unlimited
Restore Exceeded &#58; 0
Allow same host p2p &#58; besteffort
Submodule &#58; CostModule (cm) &#58; diskCacheV111.poolManager.PoolOperator
Version &#58; $Id&#58; CostModuleV1.java,v 1.16.4.1 2006/08/18 06&#58;03&#58;57 patrick
Exp $
Debug   &#58; off
Update  &#58; on
Active  &#58; yes
Magic   &#58; yes

8. The suspended transfers happen to all pools from a certain
pool groups (where the dataset that is heavily used is stored).
To give an example of a typical load for a pool node (that also runs condor jobs)&#58;

[root@hibat0060 log]# vmstat 1
procs -----------memory---------- ---swap-- -----io---- --system-- ----cpu----
r  b   swpd   free   buff  cache   si   so    bi    bo   in    cs us sy id wa
10  0 1106804  30144   6700 1430336   63   88   438   131   13     8 54  8 34  4
7  0 1106804  29200   6708 1430328    0    0     0    84 1558  6701 68 32  0  0
9  0 1107168  35208   6704 1423332   36  364    36   492 1550  6703 68 32  0  0
10  0 1107168  34200   6704 1423332    0    0     0     0 1588  7193 65 35  0  0
8  0 1107168  32984   6704 1423332    0    0     0     0 1692  7897 60 40  0  0
13  0 1107168  30752   6704 1423328    4    0     4     0 1639  7669 62 38  0  0
10  0 1107168  30680   6704 1423328    0    0     0     0 1686  7936 59 41  0  0
5  0 1107168  29608   6720 1423312    0    0     0   156 1578  6671 67 33  0  0
5  0 1107880  36544   6720 1417828    0  712     0   712 1358  3293 87 13  0  0
4  0 1107880  33736   6720 1417820    8    0     8     0 1285  2515 89 11  0  0
4  0 1107880  31176   6720 1417820    0    0     0     0 1117    95 100  0  0  0
4  0 1107880  28936   6720 1417820    0    0     0     0 1097    84 100  0  0  0
12  0 1108160  32184   6668 1414236  108  280   812   544 1482  2049 92  8  0  0
9  0 1108160  31272   6704 1414320   16    0   160   152 2259  8323 65 35  0  0
10  0 1114064  35520   6688 1409996   16 5904 10864  5904 3153  8148 63 37  0  0
10  0 1114740  28800   6692 1419452   20  676 13344   676 3354  9314 57 43  0  0
13  0 1115392  31288   6676 1416944    0  652  4612   652 2271  8114 58 42  0  0
14  0 1116372  33416   6704 1415252    0 1116 10800  1224 2814  7132 64 37  0  0
10  1 1118012  31784   6740 1417904   12 1512 19428  1652 4664  8722 59 41  0  0
9  0 1118864  36696   6748 1413988    8  856  2948   964 2264  8452 60 40  0  0
5  0 1118864  30504   6756 1419080    0    0  5132     0 2039  5777 74 26  0  0
5  0 1122328  33376   6744 1415612    0 3464  4612  3464 1821  3077 87 14  0  0
4  0 1122328  31328   6752 1415552  120    0   120    64 1134   159 99  0  0  1
4  0 1122328  29024   6752 1415552    0    0     0     0 1125    95 99  0  0  0

and the load average is order of 8 for these nodes with 4 cores.
</div><script type='text/javascript'>
        $('#show_961918132').click(function() {
            $('#detail_961918132').slideDown("normal");
            $('#show_961918132').hide();
            $('#hide_961918132').show();
        });
        $('#hide_961918132').click(function() {
            $('#detail_961918132').slideUp();
            $('#hide_961918132').hide();
            $('#show_961918132').show();
        });
        </script></pre></div>
</div>
<script type="text/javascript">
function reset_anchor() {
    $("#updates .selected").removeClass("selected");
    var urls = document.location.toString().split('#'); 
    var anchor = urls[1];
    if(anchor) {
        $("a[name='"+anchor+"']").parents(".update_description").addClass("selected");
    }
}
function submitspam(ticket_id) {
    myret = confirm("Would you like to close this ticket as a security ticket, and submit the ticket content to akismet?");
    if(myret == true) {
        $.ajax("viewer/processspam?id="+ticket_id).done(function() {
            window.location.reload();
        });
    }
}

$(function() {
    reset_anchor();
    var ADDITIONAL_COOKIE_NAME = 'gocticket';
    var options = { path: '/', expires: 365};

    if(window.opener && window.opener.name == "gocticket_list") {
        v = $.cookie("closewindow");
        if(!v) {
            $("#closewindow").attr("checked", "checked"); //on by default
        } else {
            if(v == "checked") {
                $("#closewindow").attr("checked", "checked");
            }
        }
        $("#closewindow").click(function() {
            $.cookie("closewindow", $(this).attr('checked'), options);
        });
    } else {
        $("#closewindow_area").hide();
    }
    function updateTimeago() {
        $("time").timeago();
        setTimeout(updateTimeago, 30*1000);
    }
    updateTimeago();
    $(".description").focus(expand_description);
});
</script>
<hr/>
<footer>
<p>GOC Ticket Version 2.2 | <a href="https://ticket.opensciencegrid.org/goc/submit?app_issue_check=on&amp;app_issue_type=goc&amp;app_goc_url=https%3A%2F%2Fticket.opensciencegrid.org%3A443%2F4271">Report Bugs</a>
 | <a href="https://github.com/opensciencegrid/operations/blob/master/docs/privacy.md">Privacy Policy</a>
</p>

<p> <img align="top" src="images/tag_orange.png"/> Copyright 2018 The Trustees of Indiana University - Developed for Open Science Grid</p>
</footer>


</div><!--container-fluid-->
<script>
//used by searchbox
function parseValue(value) {
    var obj = new Object();
    var tokens = value.split("\t");
    obj.str = tokens[0];
    obj.count = tokens[1];
    return obj;
}

$(function() {
    //bootstrap-2.0.4 stuff
    $(".alert-message").alert();
    $(".dropdown-toggle").dropdown();
    $("span[rel='tooltip']").tooltip();
    $("a[rel=popover]").popover();

    //activate menu that user is currently on
    $("#menu_navigator").addClass("active"); 
    $("#submenu_").addClass("active"); 

    //translate zend validation error message to bootstrap
    $(".errors").addClass("alert").addClass("alert-error");

    //enable autocomplete for search box
    $("#search").autocomplete({
        source: function( request, response ) {
            $.ajax({
                url: "search/autocomplete",
                dataType: "text",
                data: {
                    //featureClass: "P",
                    //style: "full",
                    //maxRows: 12,
                    //name_startsWith: request.term
                    q: request.term
                },
                success: function( data ) {
                    response( $.map( data.split("\n"), function( item ) {
                        if(item == "") return null;
                        return {
                            value: item
                        }
                    }));
                }
            });
        },
        select: function(event, ui) {
            document.location = "search?q="+ui.item.value;
        }
    });
    
});
</script>


</body>
