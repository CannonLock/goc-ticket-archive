<!DOCTYPE html>
<html lang="en">
  <head>
  <base href="">
    <title>[6438] Fwd&#58; [IU-GOC] Summary of sonofsam incident, 2009/02/24</title>    <meta charset="utf-8" />
    <meta name="verify-v1" content="na5IcAJsZVOfEkboRxuIiZ1zpZgnZiWra+nKcS7nA/o=" />
    <meta name="google-site-verification" content="DLrk3ft4s8b-S2TloLCL2LD_t6wcTjgSluf5pmiu2kA" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />

    <style type="text/css">
      body {
        padding-top: 50px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
     #search {
            width: 300px;
     }

    </style>

<script src="https://code.jquery.com/jquery-3.0.0.js"></script>
<script src="https://code.jquery.com/jquery-migrate-3.0.1.js"></script>

   <link href="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet"/>
    <script src="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/js/bootstrap.min.js"></script>

    <link href="https://netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"/>
    <link href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/themes/smoothness/jquery-ui.min.css" rel="stylesheet"/>
 <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>


    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/js/select2.min.js"></script>

    <link href="css/ticket.css" rel="stylesheet" />
    <script src="lib/jquery.cookie.js"></script>

    <link href="images/tag_orange.png" rel="icon" type="image/png"/>
  </head>

  <body>
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>

            <a class="brand" style="padding: 6px 0px 0px 6px;" href="http://opensciencegrid.org"><img src="images/osglogo.40x30.png"/></a>
            <ul class="nav">
                <li class="dropdown"><a href="https://ticket.opensciencegrid.org/#" class="dropdown-toggle" data-toggle="dropdown">GOC Ticket <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    <li><a href="https://my.opensciencegrid.org">MyOSG</a></li>
                    <li><a href="https://oim.opensciencegrid.org">OIM</a></li>
                    <li class="active"><a href="https://ticket.opensciencegrid.org/index">Ticket</a></li>
	<li class="divider"></li>
	<li><a href="http://repo.grid.iu.edu">Repo</a></li>
	<li class="divider"></li>
	<li><a href="http://blogs.grid.iu.edu">Blog</a></li>
                    <li><a href="http://display.grid.iu.edu">Display</a></li>
                    <li><a href="http://osggoc.blogspot.com/">News</a></li>
                    </ul>
                </li>
            </ul>
            <ul class="nav pull-right">
                <li><a href="https://ticket.opensciencegrid.org/sso/">Login</a></li>            </ul>

            <div class="nav-collapse">
                <ul class="nav">
			 <li id="menu_submit"><a href="https://ticket.opensciencegrid.org/submit">Submit</a></li><li id="menu_view" class="dropdown"><a href="https://ticket.opensciencegrid.org/\#" class="dropdown-toggle" data-toggle="dropdown">View <b class="caret"></b></a><ul class="dropdown-menu"><li id="submenu_listopen"><a href="https://ticket.opensciencegrid.org/list/open">Open Tickets</a></li><li id="submenu_listrecentclose"><a href="https://ticket.opensciencegrid.org/list/recentclose">Recently Closed Tickets</a></li><li class="divider"></li><li id="submenu_alltickets"><a href="https://ticket.opensciencegrid.org/search?q=&amp;sort=id">All Tickets</a></li></ul></li>                </ul>

                <form class="navbar-search pull-right" action="https://ticket.opensciencegrid.org/viewer">
                    <input id="search" type="text" name="id" class="search-query span2" placeholder="Search Ticket" value=""/>
                </form>
            </div>
        </div>
      </div>
    </div>

<script type='text/javascript' src='lib/jquery.timeago.js'></script>
<script type='text/javascript' src='lib/byte2size.js'></script>
<style>
#updates .toolbar {
position: relative;
margin-top: 0px;
top: -10px;
font-weight: normal;
}
#updates a.anchor {
position: relative;
top: -50px;
}
#updates .selected pre {
animation:selected 2s;
animation-iteration-count: 2;
animation-direction: alternate;
-webkit-animation:selected 2s; 
-webkit-animation-iteration-count: 2;
-webkit-animation-direction: alternate;
box-shadow: inset 1px 1px 20px #9ad;
border: 1px solid #9ab;
margin: 5px 0px;
padding-left: 10px;
}
@keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ab;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
@-webkit-keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ad;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
#updates pre {
background-color: inherit;
line-height: 15px;
padding: 5px;
}
#updates .header {
color: #999;
}
#updates .update_history pre {
background-color: #eee;
color: #666;
font-size: 85%;
}
#updates .clickable {
cursor: pointer;
}
#updates .clickable:hover {
color: #D98719;
}
#updates .meta_information pre {
background-color: #fed;
}
#similar_tickets {
max-height: 300px;
overflow-y: auto;
pointer-events: none;
padding: 5px;
background-color: #f4f4f4;
}
.btn-toolbar {
margin-bottom: 0;
height: 30px;
}
#peers {
position: fixed;
bottom: 0px;
right: 0px;
z-index: 100;
list-style: none;
padding: 5px 0px 0px 5px;
margin: 0px;
background-color: white;
box-shadow: 0px 0px 10px white;
}
#peers li {
background-color: #ccc;
color: #000;
display: inline-block;
padding: 5px 10px;
margin-right: 5px;
position: relative;
}
/*
#peers li:hover {
background-color: #999;
cursor: pointer;
}
*/
#peers span.ip {
padding-left: 5px;
color: #666;
}
#peers .new {
bottom: -30px;
}
/*
#peers .me {
background-color: red;
}
*/
</style>

<div class="container-fluid">
<ul id="peers"></ul>
<div class="alert alert-danger"><a class="close" href="https://ticket.opensciencegrid.org/#" data-dismiss="alert">&times;</a>By the end of May 2018, the ticketing system at https://ticket.opensciencegrid.org will be retired and support will be provided at https://support.opensciencegrid.org. Throughout this transition the support email (help@opensciencegrid.org) will be available as a point of contact.<br><br>                                                   
                                                                                                                                                                                   
Please see the service migration page for details: https://opensciencegrid.github.io/technology/policy/service-migrations-spring-2018/#ticket</div><div id="presence" class="pull-right"></div><div class="ticketgui"><script type="text/javascript" src="lib/checktab.js"></script>

<script>
var expanded = false;
function expand_description() {
    var desc = $(".description");
    if(!expanded) {
        expanded = true;
        //expand to minheight
        var min = 250;
        if(desc.height() < min) {
            desc.animate({height: min}, 200);
        }
    }
}

$(document).ready(function() {
    $("input[name='nad']").datepicker({
        dateFormat: 'yy-mm-dd'
    });
});

</script>



<style>
.form-horizontal .control-label {
padding-top: inherit;
font-size:90%;
color:#666;
}
label {
margin-bottom: 0px;
}
.controls {
line-height: 18px;
}
</style>
<form class="form-horizontal" action="https://ticket.opensciencegrid.org/viewer/updatebasic?id=6438" method="post">
<div class="page-header">
    <h3><span class="muted">6438</span> / Fwd&#58; [IU-GOC] Summary of sonofsam incident, 2009/02/24</h3>
</div>

<div class="row-fluid">
<div class="span5">
    <legend>Contact</legend>
    <div class="control-group">
        <label class="control-label">Full Name</label>
        <div class="controls">Rob Quick</div>
    </div>
    <div class="control-group">
        <label class="control-label">Email</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">Phone</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">CC</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>

    <legend>Details</legend>
    
    <div class="control-group">
        <label class="control-label">Ticket Type</label>
        <div class="controls">Problem/Request</div>
    </div>
    <div class="control-group">
        <label class="control-label">Priority</label>
        <div class="controls">Normal</div>
    </div>
    <div class="control-group">
        <label class="control-label">Status</label>
        <div class="controls">
Closed</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action</label>
        <div class="controls">Check NAI and Status Fields</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action Deadline</label>
        <div class="controls flag_red">2009-03-03</div>
    </div>

</div><!--span-->
<div class="span7">
    <legend>Assignees</legend>
    <div class="assignee" style="width: 60%">Rob Quick <span class="muted"> / OSG GOC Management</span></div>    <br>

    <legend>Assignees</legend>
    TODO
    <br>

    <style>
legend.noborder {
border-bottom: none;
}
</style>

<div id="attachment-list"/>
<script>
$(function () {
    var first = true;
    $.getJSON("attachment/list/6438", function (files) {
        //console.dir(files);
        var html = "<table class=\"table table-condensed\">";
        $(files).each(function() {
            if(first) {
                first = false;
                html += "<legend class=\"noborder\">Attachmenets</legend>";
            }
            html += "<tr class=\"attachment\">";
            html += "<td><img src=\""+this.thumbnail_url+"\"/></td>";
            html += "<td><a href=\""+this.url+"\" target=\"_blank\">"+this.name+"</a></td>";
            html += "<td>"+bytesToSize(this.size, 1)+"</td>";
            html += "</tr>";
        });
        html += "</table>";
        $("#attachment-list").html(html);
    });
});

function download(url) {
    window.open(url, "_blank");
}
</script>


</div><!--span-->
</div><!--row-fluid-->


</form>

</div>
<div id="updates" style="clear: both;">
    <legend>Past Updates
    <div class="btn-toolbar pull-right toolbar">
    </div><!--btn-toolbar-->
    </legend>

    <div class='update_description'><i onclick="document.location='6438#1236102595'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2009-03-03T17:49:55+00:00">Mar 3, 2009 05:49 PM UTC</time> by <b>Arvind Gopu</b><a class="anchor" name="1236102595">&nbsp;</a></div><pre>Rob wants me to summarize how this outage affected the top level WLCG BDIIs to not
have OSG resource information&#58;

1) The OSG BDII was never broken in the course of this outage. LDAP information was
available with no interruption on both the OSG and WLCG-interop BDIIs running on
ports 2170 and 2180 respectively. Anyone who uses the OSG BDII server should not have
seen any outage.

2) The WLCG Top-level BDIIs lost OSG-interop resource information on them.

Reason&#58; They use a list of LDAP URIs for bootstrapping .. this list has been provided
historically via a webpage
<a href='https&#58;//oim.grid.iu.edu/pub/get_osg_interop_bdii_ldap_list.php' target='_blank' rel='nofollow'>https&#58;//oim.grid.iu.edu/pub/get_osg_interop_bdii_ldap_list.php</a>

Since OIM was down in the period of this outage, the WLCG top level BDIIs did not
have the above list, and consequently no OSG-interop resource information on them.

We have requested EGEE collaborators to use information available within our
WLCG-interop BDII (port 2180) for this bootstrapping so as to remove their dependency
on OIM.  EGEE can avoid needing
<a href='https&#58;//oim.grid.iu.edu/pub/get_osg_interop_bdii_ldap_list.php?format=plain-text' target='_blank' rel='nofollow'>https&#58;//oim.grid.iu.edu/pub/get_osg_interop_bdii_ldap_list.php?format=plain-text</a> with
the following for loop (or perhaps a cleaner version of it!)

for dn in &#96;ldapsearch -xLLL -p2180 -h is1.grid.iu.edu -b o=grid|grep &#34;dn&#58; Mds&#34; | grep
-v -i &#34;Mds-vo-name=local&#34; | cut -f2 -d=| cut -f1 -d,&#96;;
do
echo $dn &#39;ldap&#58;//is.grid.iu.edu&#58;2180/mds-vo-name=&#39;$dn&#39;,o=grid&#39;;
done

Once they put this fix in place, an OIM outage should not influence the functioning
of the top level WLCG BDIIs.

Cheers,
Arvind</pre></div><div class='update_description'><i onclick="document.location='6438#1236101660'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2009-03-03T17:34:20+00:00">Mar 3, 2009 05:34 PM UTC</time> by <b>Rob Quick</b><a class="anchor" name="1236101660">&nbsp;</a></div><pre>Asked Arvind to summarize the fix for this and close the ticket.</pre></div><div class='update_description'><i onclick="document.location='6438#1235612171'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2009-02-26T01:36:11+00:00">Feb 26, 2009 01:36 AM UTC</time> by <b>Rob Quick</b><a class="anchor" name="1235612171">&nbsp;</a></div><pre>Opening a ticket in the GOC FP.

Rob

Begin forwarded message&#58;

<font color='#7F7E6F'>&#62; From&#58; &#34;Lee, Thomas Jennings&#34; &#60;thomlee@....&#62;</font>
<font color='#7F7E6F'>&#62; Date&#58; February 24, 2009 2&#58;04&#58;43 PM EST</font>
<font color='#7F7E6F'>&#62; To&#58; &#34;IU-GOC-L@....&#34; &#60;IU-GOC-L@....&#62;</font>
<font color='#7F7E6F'>&#62; Subject&#58; [IU-GOC] Summary of sonofsam incident, 2009/02/24</font>
<font color='#7F7E6F'>&#62; Reply-To&#58; group list of IU GridOpsC &#60;IU-GOC-L@....&#62;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; Here&#39;s a summary of what I know about the sonofsam incident, so far.</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; *** From the report generated by Dell&#39;s DSET software&#58;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; 02/24/09  3&#58;52&#58;54&#58; MPT_ProcessIo Reply Fr e2 EVENT_NOTIFICATION</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; Tom says&#58; At 03&#58;52&#58;54 UTC, the RAID firmware began logging some</font>
<font color='#7F7E6F'>&#62; unusual stuff.  This may or may not be related to anything that</font>
<font color='#7F7E6F'>&#62; happened</font>
<font color='#7F7E6F'>&#62; afterwards, but on the off-chance that it is, I&#39;m mentioning it here.</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; *** From /var/log/messages on sonofsam&#58;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; ...</font>
<font color='#7F7E6F'>&#62; Feb 24 08&#58;36&#58;38 sonofsam kernel&#58; iptables_dropped&#58; IN=eth0 OUT=</font>
<font color='#7F7E6F'>&#62; MAC=00&#58;18&#58;8b&#58;39&#58;a0&#58;d7&#58;00&#58;d0&#58;05&#58;56&#58;a4&#58;00&#58;08&#58;00 SRC=201.234.29.253</font>
<font color='#7F7E6F'>&#62; DST=129.79.5.18 LEN=64 TOS=0x00 PREC=0x00 TTL=114 ID=13116</font>
<font color='#7F7E6F'>&#62; PROTO=ICMP TYPE=8 CODE=0 I</font>
<font color='#7F7E6F'>&#62; D=512 SEQ=7430</font>
<font color='#7F7E6F'>&#62; Feb 24 08&#58;39&#58;50 sonofsam kernel&#58; iptables_dropped&#58; IN=eth0 OUT=</font>
<font color='#7F7E6F'>&#62; MAC=00&#58;18&#58;8b&#58;39&#58;a0&#58;d7&#58;00&#58;d0&#58;05&#58;56&#58;a4&#58;00&#58;08&#58;00 SRC=201.234.29.253</font>
<font color='#7F7E6F'>&#62; DST=129.79.5.192 LEN=64 TOS=0x00 PREC=0x00 TTL=114 ID=14493</font>
<font color='#7F7E6F'>&#62; PROTO=ICMP TYPE=8 CODE=0</font>
<div id='show_1420582089' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_1420582089'><font color='#7F7E6F'>&#62; ID=512 SEQ=30983</font>
<font color='#7F7E6F'>&#62; Feb 24 10&#58;51&#58;44 sonofsam kernel&#58; iptables_dropped&#58; IN=eth0 OUT=</font>
<font color='#7F7E6F'>&#62; MAC=00&#58;18&#58;8b&#58;39&#58;a0&#58;d7&#58;00&#58;d0&#58;05&#58;56&#58;a4&#58;00&#58;08&#58;00 SRC=121.15.220.4</font>
<font color='#7F7E6F'>&#62; DST=129.79.5.18 LEN=40 TOS=0x00 PREC=0x00 TTL=109 ID=256 PROTO=TCP</font>
<font color='#7F7E6F'>&#62; SPT=6000 DPT=8080 WI</font>
<font color='#7F7E6F'>&#62; NDOW=16384 RES=0x00 SYN URGP=0</font>
<font color='#7F7E6F'>&#62; Feb 24 10&#58;51&#58;44 sonofsam kernel&#58; iptables_dropped&#58; IN=eth0 OUT=</font>
<font color='#7F7E6F'>&#62; MAC=00&#58;18&#58;8b&#58;39&#58;a0&#58;d7&#58;00&#58;d0&#58;05&#58;56&#58;a4&#58;00&#58;08&#58;00 SRC=121.15.220.4</font>
<font color='#7F7E6F'>&#62; DST=129.79.5.192 LEN=40 TOS=0x00 PREC=0x00 TTL=108 ID=256 PROTO=TCP</font>
<font color='#7F7E6F'>&#62; SPT=6000 DPT=8080 W</font>
<font color='#7F7E6F'>&#62; INDOW=16384 RES=0x00 SYN URGP=0</font>
<font color='#7F7E6F'>&#62; Feb 24 10&#58;59&#58;57 sonofsam kernel&#58; iptables_dropped&#58; IN=eth0 OUT=</font>
<font color='#7F7E6F'>&#62; MAC=ff&#58;ff&#58;ff&#58;ff&#58;ff&#58;ff&#58;00&#58;0c&#58;29&#58;69&#58;6f&#58;fc&#58;08&#58;00 SRC=129.79.5.64</font>
<font color='#7F7E6F'>&#62; DST=255.255.255.255 LEN=44 TOS=0x00 PREC=0x00 TTL=32 ID=5321</font>
<font color='#7F7E6F'>&#62; PROTO=UDP SPT=1041 DPT=3829</font>
<font color='#7F7E6F'>&#62; 3 LEN=24</font>
<font color='#7F7E6F'>&#62; Feb 24 10&#58;59&#58;57 sonofsam kernel&#58; iptables_dropped&#58; IN=eth0 OUT=</font>
<font color='#7F7E6F'>&#62; MAC=ff&#58;ff&#58;ff&#58;ff&#58;ff&#58;ff&#58;00&#58;0c&#58;29&#58;69&#58;6f&#58;fc&#58;08&#58;00 SRC=129.79.5.64</font>
<font color='#7F7E6F'>&#62; DST=255.255.255.255 LEN=44 TOS=0x00 PREC=0x00 TTL=32 ID=5322</font>
<font color='#7F7E6F'>&#62; PROTO=UDP SPT=1041 DPT=3829</font>
<font color='#7F7E6F'>&#62; 3 LEN=24</font>
<font color='#7F7E6F'>&#62; Feb 24 10&#58;59&#58;57 sonofsam kernel&#58; iptables_dropped&#58; IN=eth0 OUT=</font>
<font color='#7F7E6F'>&#62; MAC=ff&#58;ff&#58;ff&#58;ff&#58;ff&#58;ff&#58;00&#58;0c&#58;29&#58;69&#58;6f&#58;fc&#58;08&#58;00 SRC=129.79.5.64</font>
<font color='#7F7E6F'>&#62; DST=255.255.255.255 LEN=44 TOS=0x00 PREC=0x00 TTL=32 ID=5336</font>
<font color='#7F7E6F'>&#62; PROTO=UDP SPT=1041 DPT=3829</font>
<font color='#7F7E6F'>&#62; 3 LEN=24</font>
<font color='#7F7E6F'>&#62; Feb 24 10&#58;59&#58;57 sonofsam kernel&#58; iptables_dropped&#58; IN=eth0 OUT=</font>
<font color='#7F7E6F'>&#62; MAC=ff&#58;ff&#58;ff&#58;ff&#58;ff&#58;ff&#58;00&#58;0c&#58;29&#58;69&#58;6f&#58;fc&#58;08&#58;00 SRC=129.79.5.64</font>
<font color='#7F7E6F'>&#62; DST=255.255.255.255 LEN=44 TOS=0x00 PREC=0x00 TTL=32 ID=5337</font>
<font color='#7F7E6F'>&#62; PROTO=UDP SPT=1041 DPT=3829</font>
<font color='#7F7E6F'>&#62; 3 LEN=24</font>
<font color='#7F7E6F'>&#62; Feb 24 10&#58;59&#58;57 sonofsam kernel&#58; iptables_dropped&#58; IN=eth0 OUT=</font>
<font color='#7F7E6F'>&#62; MAC=ff&#58;ff&#58;ff&#58;ff&#58;ff&#58;ff&#58;00&#58;0c&#58;29&#58;69&#58;6f&#58;fc&#58;08&#58;00 SRC=129.79.5.64</font>
<font color='#7F7E6F'>&#62; DST=255.255.255.255 LEN=44 TOS=0x00 PREC=0x00 TTL=32 ID=5339</font>
<font color='#7F7E6F'>&#62; PROTO=UDP SPT=1041 DPT=3829</font>
<font color='#7F7E6F'>&#62; 3 LEN=24</font>
<font color='#7F7E6F'>&#62; Feb 24 10&#58;59&#58;57 sonofsam kernel&#58; iptables_dropped&#58; IN=eth0 OUT=</font>
<font color='#7F7E6F'>&#62; MAC=ff&#58;ff&#58;ff&#58;ff&#58;ff&#58;ff&#58;00&#58;0c&#58;29&#58;69&#58;6f&#58;fc&#58;08&#58;00 SRC=129.79.5.64</font>
<font color='#7F7E6F'>&#62; DST=255.255.255.255 LEN=44 TOS=0x00 PREC=0x00 TTL=32 ID=5340</font>
<font color='#7F7E6F'>&#62; PROTO=UDP SPT=1041 DPT=3829</font>
<font color='#7F7E6F'>&#62; 3 LEN=24</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; Tom says&#58; And then, silence.  What seems to have been appearing in /</font>
<font color='#7F7E6F'>&#62; var/log/messages has mainly been dropped broadcast packets.</font>
<font color='#7F7E6F'>&#62; I&#39;ve since</font>
<font color='#7F7E6F'>&#62; installed syslog-ng on sonofsam instead of sysklogd, directed the</font>
<font color='#7F7E6F'>&#62; firewall logs to a separate file, set iptables to drop broadcast</font>
<font color='#7F7E6F'>&#62; packets</font>
<font color='#7F7E6F'>&#62; without logging them, and set sonofsam to log remotely to dubois.</font>
<font color='#7F7E6F'>&#62; At any rate, there was nothing after 10&#58;59&#58;57 UTC</font>
<font color='#7F7E6F'>&#62; in /var/log/messages, which doesn&#39;t really tell us much.</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; *** From /var/log/secure on sonofsam&#58;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; ...</font>
<font color='#7F7E6F'>&#62; Feb 24 13&#58;58&#58;11 sonofsam sshd[32512]&#58; Connection closed by 64.57.25.18</font>
<font color='#7F7E6F'>&#62; Feb 24 13&#58;58&#58;12 sonofsam sshd[32514]&#58; Connection closed by</font>
<font color='#7F7E6F'>&#62; 149.165.129.24</font>
<font color='#7F7E6F'>&#62; Feb 24 13&#58;58&#58;37 sonofsam sshd[32522]&#58; Accepted publickey for</font>
<font color='#7F7E6F'>&#62; hayashis from 129.79.5.217 port 50342 ssh2</font>
<font color='#7F7E6F'>&#62; Feb 24 13&#58;58&#58;37 sonofsam sshd[32522]&#58; pam_unix(sshd&#58;session)&#58;</font>
<font color='#7F7E6F'>&#62; session opened for user hayashis by (uid=0)</font>
<font color='#7F7E6F'>&#62; Feb 24 13&#58;58&#58;37 sonofsam sshd[32522]&#58; pam_unix(sshd&#58;session)&#58;</font>
<font color='#7F7E6F'>&#62; session closed for user hayashis</font>
<font color='#7F7E6F'>&#62; Feb 24 13&#58;58&#58;52 sonofsam sshd[32549]&#58; Connection closed by</font>
<font color='#7F7E6F'>&#62; 149.165.129.24</font>
<font color='#7F7E6F'>&#62; Feb 24 13&#58;59&#58;12 sonofsam sshd[32712]&#58; Connection closed by</font>
<font color='#7F7E6F'>&#62; 149.165.129.24</font>
<font color='#7F7E6F'>&#62; Feb 24 13&#58;59&#58;37 sonofsam sshd[32716]&#58; Accepted publickey for</font>
<font color='#7F7E6F'>&#62; hayashis from 129.79.5.217 port 50347 ssh2</font>
<font color='#7F7E6F'>&#62; Feb 24 13&#58;59&#58;37 sonofsam sshd[32716]&#58; pam_unix(sshd&#58;session)&#58;</font>
<font color='#7F7E6F'>&#62; session opened for user hayashis by (uid=0)</font>
<font color='#7F7E6F'>&#62; Feb 24 13&#58;59&#58;38 sonofsam sshd[32716]&#58; pam_unix(sshd&#58;session)&#58;</font>
<font color='#7F7E6F'>&#62; session closed for user hayashis</font>
<font color='#7F7E6F'>&#62; Feb 24 13&#58;59&#58;53 sonofsam sshd[755]&#58; Connection closed by</font>
<font color='#7F7E6F'>&#62; 149.165.129.24</font>
<font color='#7F7E6F'>&#62; Feb 24 14&#58;00&#58;12 sonofsam sshd[1402]&#58; Connection closed by</font>
<font color='#7F7E6F'>&#62; 149.165.129.24</font>
<font color='#7F7E6F'>&#62; Feb 24 14&#58;00&#58;36 sonofsam sshd[1408]&#58; Accepted publickey for hayashis</font>
<font color='#7F7E6F'>&#62; from 129.79.5.217 port 50359 ssh2</font>
<font color='#7F7E6F'>&#62; Feb 24 14&#58;00&#58;36 sonofsam sshd[1408]&#58; pam_unix(sshd&#58;session)&#58; session</font>
<font color='#7F7E6F'>&#62; opened for user hayashis by (uid=0)</font>
<font color='#7F7E6F'>&#62; Feb 24 14&#58;00&#58;37 sonofsam sshd[1408]&#58; pam_unix(sshd&#58;session)&#58; session</font>
<font color='#7F7E6F'>&#62; closed for user hayashis</font>
<font color='#7F7E6F'>&#62; Feb 24 14&#58;00&#58;52 sonofsam sshd[1436]&#58; Connection closed by</font>
<font color='#7F7E6F'>&#62; 149.165.129.24</font>
<font color='#7F7E6F'>&#62; Feb 24 14&#58;01&#58;11 sonofsam sshd[1618]&#58; Connection closed by 64.57.25.18</font>
<font color='#7F7E6F'>&#62; Feb 24 14&#58;01&#58;12 sonofsam sshd[1620]&#58; Connection closed by</font>
<font color='#7F7E6F'>&#62; 149.165.129.24</font>
<font color='#7F7E6F'>&#62; Feb 24 14&#58;01&#58;36 sonofsam sshd[1624]&#58; Accepted publickey for hayashis</font>
<font color='#7F7E6F'>&#62; from 129.79.5.217 port 50363 ssh2</font>
<font color='#7F7E6F'>&#62; Feb 24 14&#58;01&#58;36 sonofsam sshd[1624]&#58; pam_unix(sshd&#58;session)&#58; session</font>
<font color='#7F7E6F'>&#62; opened for user hayashis by (uid=0)</font>
<font color='#7F7E6F'>&#62; Feb 24 14&#58;01&#58;37 sonofsam sshd[1624]&#58; pam_unix(sshd&#58;session)&#58; session</font>
<font color='#7F7E6F'>&#62; closed for user hayashis</font>
<font color='#7F7E6F'>&#62; Feb 24 14&#58;01&#58;53 sonofsam sshd[1649]&#58; Connection closed by</font>
<font color='#7F7E6F'>&#62; 149.165.129.24</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; Tom says&#58; And then, silence.  Evidently Soichi has some sort of</font>
<font color='#7F7E6F'>&#62; automated process that connects to sonofsam every minute, but after</font>
<font color='#7F7E6F'>&#62; 14&#58;01&#58;53 UTC</font>
<font color='#7F7E6F'>&#62; it either stopped working or at least the system stopped logging it.</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; *** From /var/log/crond on sonofsam&#58;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; ...</font>
<font color='#7F7E6F'>&#62; Feb 24 14&#58;00&#58;01 sonofsam crond[760]&#58; (root) CMD (/opt/share/munin/</font>
<font color='#7F7E6F'>&#62; plugins/ipmiget)</font>
<font color='#7F7E6F'>&#62; Feb 24 14&#58;00&#58;01 sonofsam crond[761]&#58; (root) CMD (/usr/lib/sa/sa1 1 1)</font>
<font color='#7F7E6F'>&#62; Feb 24 14&#58;00&#58;01 sonofsam crond[762]&#58; (hayashis) CMD (/usr/local/</font>
<font color='#7F7E6F'>&#62; rsvprocess/run_often.sh &#62;&#62; /usr/local/rsvprocess/log/run.log 2&#62;&1)</font>
<font color='#7F7E6F'>&#62; Feb 24 14&#58;01&#58;01 sonofsam crond[1442]&#58; (root) CMD (run-parts /etc/</font>
<font color='#7F7E6F'>&#62; cron.hourly)</font>
<font color='#7F7E6F'>&#62; Feb 24 14&#58;01&#58;01 sonofsam crond[1443]&#58; (root) CMD (/opt/share/munin/</font>
<font color='#7F7E6F'>&#62; plugins/ipmiget)</font>
<font color='#7F7E6F'>&#62; Feb 24 14&#58;01&#58;01 sonofsam crond[1444]&#58; (root) CMD (/opt/sbin/confsync-</font>
<font color='#7F7E6F'>&#62; rsync &#62; /dev/null)</font>
<font color='#7F7E6F'>&#62; Feb 24 14&#58;01&#58;01 sonofsam crond[1445]&#58; (hayashis) CMD (/usr/local/</font>
<font color='#7F7E6F'>&#62; rsvprocess/run_often.sh &#62;&#62; /usr/local/rsvprocess/log/run.log 2&#62;&1)</font>
<font color='#7F7E6F'>&#62; Feb 24 14&#58;02&#58;01 sonofsam crond[1655]&#58; (root) CMD (/opt/sbin/confsync-</font>
<font color='#7F7E6F'>&#62; install &#62; /dev/null)</font>
<font color='#7F7E6F'>&#62; Feb 24 14&#58;02&#58;01 sonofsam crond[1656]&#58; (root) CMD (/opt/share/munin/</font>
<font color='#7F7E6F'>&#62; plugins/ipmiget)</font>
<font color='#7F7E6F'>&#62; Feb 24 14&#58;02&#58;01 sonofsam crond[1657]&#58; (hayashis) CMD (/usr/local/</font>
<font color='#7F7E6F'>&#62; rsvprocess/run_often.sh &#62;&#62; /usr/local/rsvprocess/log/run.log 2&#62;&1)</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; Tom says&#58; And then, silence.  Cron jobs stopped logging after</font>
<font color='#7F7E6F'>&#62; 14&#58;02&#58;01 UTC.  They may have stopped running, too, but all I can say</font>
<font color='#7F7E6F'>&#62; for</font>
<font color='#7F7E6F'>&#62; certain is that</font>
<font color='#7F7E6F'>&#62; they stopped logging.</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; Elizabeth reports seeing Nagios warnings between 14&#58;02 and 14&#58;07,</font>
<font color='#7F7E6F'>&#62; and finally something at 14&#58;12 that was critical enough to contact</font>
<font color='#7F7E6F'>&#62; Arvind, who contacted me.  Neither Arvind nor I was able to connect</font>
<font color='#7F7E6F'>&#62; to sonofsam at this point, although Arvind had connected just</font>
<font color='#7F7E6F'>&#62; seconds before Elizabeth&#39;s call.</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; I estimate it was approximately 14&#58;35 when I arrived in the machine</font>
<font color='#7F7E6F'>&#62; room and attempted to access sonofsam with the keyboard and</font>
<font color='#7F7E6F'>&#62; monitor.  The system was completely unresponsive, there was an</font>
<font color='#7F7E6F'>&#62; &#34;E1810 HDD 3 Failure&#34; message on sonofsam&#39;s LCD display, and HDD 3&#39;s</font>
<font color='#7F7E6F'>&#62; amber light was flashing.  Unable to do anything else, I rebooted</font>
<font color='#7F7E6F'>&#62; the system with the power button and brought it back up, first into</font>
<font color='#7F7E6F'>&#62; single-user mode, then full multi-user mode at about 14&#58;44.</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; Oddly, munin-node never stopped responding, so there are no gaps in</font>
<font color='#7F7E6F'>&#62; the Munin data.  I&#39;m not certain how accurate it is during the time</font>
<font color='#7F7E6F'>&#62; of the incident, however.  I notice these things&#58;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; * The Gratia collector queue size graph that Arvind had me add last</font>
<font color='#7F7E6F'>&#62; week seems to indicate continued activity.  Processes in memory</font>
<font color='#7F7E6F'>&#62; don&#39;t seem to have been affected much.</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; * The IOStat graph shows the blocks read per second dropping to zero</font>
<font color='#7F7E6F'>&#62; and staying there for almost the entire time, with one spike of</font>
<font color='#7F7E6F'>&#62; activity.  The blocks written per second may have dropped too, but</font>
<font color='#7F7E6F'>&#62; it is difficult to distinguish from the normal very low level of</font>
<font color='#7F7E6F'>&#62; activity.</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; * The eth0 traffic graph shows little change, but the eth1 traffic</font>
<font color='#7F7E6F'>&#62; graph shows a minor drop in activity during the incident, with a spike</font>
<font color='#7F7E6F'>&#62; that seems to coincide with the IOStat spike (at approximately</font>
<font color='#7F7E6F'>&#62; 14&#58;25), then a huge spike just before 15&#58;00, which would be shortly</font>
<font color='#7F7E6F'>&#62; after</font>
<font color='#7F7E6F'>&#62; the reboot.</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; * The netstat graph shows a tiny spike in active and failed</font>
<font color='#7F7E6F'>&#62; connections just before 15&#58;00, and again this is right after the</font>
<font color='#7F7E6F'>&#62; reboot.</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; * The CPU usage and load average graphs show a huge drop in activity</font>
<font color='#7F7E6F'>&#62; during the incident, again with a spike at about 14&#58;25.</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; * The memory usage graph shows a leap in active memory usage and a</font>
<font color='#7F7E6F'>&#62; corresponding drop in inactive memory usage during the</font>
<font color='#7F7E6F'>&#62; incident, starting at approximately 14&#58;15.</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; * The inode table usage graph shows a steady increase during the</font>
<font color='#7F7E6F'>&#62; incident, though the increase is not large, relatively speaking.</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; At any rate, the reboot appears to have corrected the problem for</font>
<font color='#7F7E6F'>&#62; now.  As for what it was, that is difficult to say.  I have configured</font>
<font color='#7F7E6F'>&#62; sonofsam to send copies of all log messages to dubois so they can be</font>
<font color='#7F7E6F'>&#62; logged remotely.  The symptoms are consistent with the read-only</font>
<font color='#7F7E6F'>&#62; problems we have occasionally seen on bundy, dahmer and the VMs when</font>
<font color='#7F7E6F'>&#62; BDII is running.  This is difficult to confirm, however, because</font>
<font color='#7F7E6F'>&#62; of the lack of any evidence other than the lack of evidence itself.</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; I did contact Dell about the drive.  They had me completely</font>
<font color='#7F7E6F'>&#62; resynchronize that drive and run their DSET diagnostic software on</font>
<font color='#7F7E6F'>&#62; sonofsam, emailing them the report.  The verdict is that we need to</font>
<font color='#7F7E6F'>&#62; do some more firmware updates.  We recently updated the main</font>
<font color='#7F7E6F'>&#62; BIOS firmware and the PERC (RAID controller)&#39;s firmware, but there</font>
<font color='#7F7E6F'>&#62; is another update we need to do on the firmware of all the SAS</font>
<font color='#7F7E6F'>&#62; drives.  This will require downtime.  But I need to get together all</font>
<font color='#7F7E6F'>&#62; the firmware updates we need to do (there have been subsequent BIOS</font>
<font color='#7F7E6F'>&#62; and PERC updates) and test them on a non-production server first --</font>
<font color='#7F7E6F'>&#62; I nominate ruckus, since I&#39;ve moved everything it was doing to</font>
<font color='#7F7E6F'>&#62; dubois and was going to reinstall its OS anyway.  Anyway, it seems</font>
<font color='#7F7E6F'>&#62; very unlikely that the drive failure was the cause of all this, as the</font>
<font color='#7F7E6F'>&#62; failure of a single drive in a RAID 5 array causes very little</font>
<font color='#7F7E6F'>&#62; change in performance.  That is, the drive failure *itself* probably</font>
<font color='#7F7E6F'>&#62; did not</font>
<font color='#7F7E6F'>&#62; cause this, but the weirdness that started showing up in the RAID</font>
<font color='#7F7E6F'>&#62; controller log about 11 hours prior to the problem is very</font>
<font color='#7F7E6F'>&#62; suspicious and</font>
<font color='#7F7E6F'>&#62; is probably related to the needed firmware update.</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; I am still not certain precisely why this happened.  It is possible</font>
<font color='#7F7E6F'>&#62; that there was a problem with the memory usage, as sonofsam was one</font>
<font color='#7F7E6F'>&#62; of the machines that needed a PAE kernel in order to access all its</font>
<font color='#7F7E6F'>&#62; RAM.  (It is now running on a PAE kernel and can see all 8 GB.)  It is</font>
<font color='#7F7E6F'>&#62; also possible that the problem was related to the SAS update (or</font>
<font color='#7F7E6F'>&#62; rather, the lack thereof).  This seems very strange given that the</font>
<font color='#7F7E6F'>&#62; machine has been running for months without this happening.  In any</font>
<font color='#7F7E6F'>&#62; case, I recommend that we schedule some downtime for</font>
<font color='#7F7E6F'>&#62; sonofsam and all other production 2950s once I&#39;ve collected all the</font>
<font color='#7F7E6F'>&#62; updates and tested them on ruckus.  If the firmware is the culprit, we</font>
<font color='#7F7E6F'>&#62; probably have months before this happens again, but I&#39;d rather get</font>
<font color='#7F7E6F'>&#62; this worry laid to rest soon so I can get to other stuff I have to do.</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; So, in summary&#58;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; 1. sonofsam is back up and running</font>
<font color='#7F7E6F'>&#62; 2. the problem was probably either RAM related or connected with a</font>
<font color='#7F7E6F'>&#62; firmware update we haven&#39;t installed</font>
<font color='#7F7E6F'>&#62; 3. sonofsam is running on all 8 GB of RAM now, so if the problem was</font>
<font color='#7F7E6F'>&#62; memory related, it&#39;s probably fixed now</font>
<font color='#7F7E6F'>&#62; 4. sonofsam needs a firmware update; I will test it on ruckus once I</font>
<font color='#7F7E6F'>&#62; find all the downloads, then we can schedule some downtime</font>
<font color='#7F7E6F'>&#62; 5. sonofsam is remote logging now, so if this happens again we&#39;ll</font>
<font color='#7F7E6F'>&#62; have more information</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; --</font>
<font color='#7F7E6F'>&#62; Tom Lee</font>
<font color='#7F7E6F'>&#62; System Administrator, Grid Infrastructure</font>
<font color='#7F7E6F'>&#62;</font>
</div><script type='text/javascript'>
        $('#show_1420582089').click(function() {
            $('#detail_1420582089').slideDown("normal");
            $('#show_1420582089').hide();
            $('#hide_1420582089').show();
        });
        $('#hide_1420582089').click(function() {
            $('#detail_1420582089').slideUp();
            $('#hide_1420582089').hide();
            $('#show_1420582089').show();
        });
        </script></pre></div>
</div>
<script type="text/javascript">
function reset_anchor() {
    $("#updates .selected").removeClass("selected");
    var urls = document.location.toString().split('#'); 
    var anchor = urls[1];
    if(anchor) {
        $("a[name='"+anchor+"']").parents(".update_description").addClass("selected");
    }
}
function submitspam(ticket_id) {
    myret = confirm("Would you like to close this ticket as a security ticket, and submit the ticket content to akismet?");
    if(myret == true) {
        $.ajax("viewer/processspam?id="+ticket_id).done(function() {
            window.location.reload();
        });
    }
}

$(function() {
    reset_anchor();
    var ADDITIONAL_COOKIE_NAME = 'gocticket';
    var options = { path: '/', expires: 365};

    if(window.opener && window.opener.name == "gocticket_list") {
        v = $.cookie("closewindow");
        if(!v) {
            $("#closewindow").attr("checked", "checked"); //on by default
        } else {
            if(v == "checked") {
                $("#closewindow").attr("checked", "checked");
            }
        }
        $("#closewindow").click(function() {
            $.cookie("closewindow", $(this).attr('checked'), options);
        });
    } else {
        $("#closewindow_area").hide();
    }
    function updateTimeago() {
        $("time").timeago();
        setTimeout(updateTimeago, 30*1000);
    }
    updateTimeago();
    $(".description").focus(expand_description);
});
</script>
<hr/>
<footer>
<p>GOC Ticket Version 2.2 | <a href="https://ticket.opensciencegrid.org/goc/submit?app_issue_check=on&amp;app_issue_type=goc&amp;app_goc_url=https%3A%2F%2Fticket.opensciencegrid.org%3A443%2F6438">Report Bugs</a>
 | <a href="https://github.com/opensciencegrid/operations/blob/master/docs/privacy.md">Privacy Policy</a>
</p>

<p> <img align="top" src="images/tag_orange.png"/> Copyright 2018 The Trustees of Indiana University - Developed for Open Science Grid</p>
</footer>


</div><!--container-fluid-->
<script>
//used by searchbox
function parseValue(value) {
    var obj = new Object();
    var tokens = value.split("\t");
    obj.str = tokens[0];
    obj.count = tokens[1];
    return obj;
}

$(function() {
    //bootstrap-2.0.4 stuff
    $(".alert-message").alert();
    $(".dropdown-toggle").dropdown();
    $("span[rel='tooltip']").tooltip();
    $("a[rel=popover]").popover();

    //activate menu that user is currently on
    $("#menu_navigator").addClass("active"); 
    $("#submenu_").addClass("active"); 

    //translate zend validation error message to bootstrap
    $(".errors").addClass("alert").addClass("alert-error");

});
</script>


</body>
