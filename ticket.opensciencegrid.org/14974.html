<!DOCTYPE html>
<html lang="en">
  <head>
  <base href="">
    <title>[14974] CPU reporting for Purdue-Carter appears incorrect for 4/16-4/18/13</title>    <meta charset="utf-8" />
    <meta name="verify-v1" content="na5IcAJsZVOfEkboRxuIiZ1zpZgnZiWra+nKcS7nA/o=" />
    <meta name="google-site-verification" content="DLrk3ft4s8b-S2TloLCL2LD_t6wcTjgSluf5pmiu2kA" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />
    <link href="https://ticket.opensciencegrid.org/rss" rel="alternate" type="application/rss+xml" title="GOC Ticket Update feed" />

    <style type="text/css">
      body {
        padding-top: 50px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
     #search {
            width: 300px;
     }

    </style>

<script src="https://code.jquery.com/jquery-3.0.0.js"></script>
<script src="https://code.jquery.com/jquery-migrate-3.0.1.js"></script>

   <link href="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet"/>
    <script src="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/js/bootstrap.min.js"></script>

    <link href="https://netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"/>
    <link href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/themes/smoothness/jquery-ui.min.css" rel="stylesheet"/>
 <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>


    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/js/select2.min.js"></script>

    <link href="css/ticket.css" rel="stylesheet" />
    <script src="lib/jquery.cookie.js"></script>

    <link href="images/tag_orange.png" rel="icon" type="image/png"/>
  </head>

  <body>
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>

            <a class="brand" style="padding: 6px 0px 0px 6px;" href="http://opensciencegrid.org"><img src="images/osglogo.40x30.png"/></a>
            <ul class="nav">
                <li class="dropdown"><a href="https://ticket.opensciencegrid.org/#" class="dropdown-toggle" data-toggle="dropdown">GOC Ticket <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    <li><a href="https://my.opensciencegrid.org">MyOSG</a></li>
                    <li><a href="https://oim.opensciencegrid.org">OIM</a></li>
                    <li class="active"><a href="https://ticket.opensciencegrid.org/index">Ticket</a></li>
	<li class="divider"></li>
	<li><a href="http://repo.grid.iu.edu">Repo</a></li>
	<li class="divider"></li>
	<li><a href="http://blogs.grid.iu.edu">Blog</a></li>
                    <li><a href="http://display.grid.iu.edu">Display</a></li>
                    <li><a href="http://osggoc.blogspot.com/">News</a></li>
                    </ul>
                </li>
            </ul>
            <ul class="nav pull-right">
                <li><a href="https://ticket.opensciencegrid.org/sso/">Login</a></li>            </ul>

            <div class="nav-collapse">
                <ul class="nav">
			 <li id="menu_submit"><a href="https://ticket.opensciencegrid.org/submit">Submit</a></li><li id="menu_view" class="dropdown"><a href="https://ticket.opensciencegrid.org/\#" class="dropdown-toggle" data-toggle="dropdown">View <b class="caret"></b></a><ul class="dropdown-menu"><li id="submenu_listopen"><a href="https://ticket.opensciencegrid.org/list/open">Open Tickets</a></li><li id="submenu_listrecentclose"><a href="https://ticket.opensciencegrid.org/list/recentclose">Recently Closed Tickets</a></li><li class="divider"></li><li id="submenu_alltickets"><a href="https://ticket.opensciencegrid.org/search?q=&amp;sort=id">All Tickets</a></li></ul></li>                </ul>

                <form class="navbar-search pull-right" action="https://ticket.opensciencegrid.org/viewer">
                    <input id="search" type="text" name="id" class="search-query span2" placeholder="Search Ticket" value=""/>
                </form>
            </div>
        </div>
      </div>
    </div>

<script type='text/javascript' src='lib/jquery.timeago.js'></script>
<script type='text/javascript' src='lib/byte2size.js'></script>
<style>
#updates .toolbar {
position: relative;
margin-top: 0px;
top: -10px;
font-weight: normal;
}
#updates a.anchor {
position: relative;
top: -50px;
}
#updates .selected pre {
animation:selected 2s;
animation-iteration-count: 2;
animation-direction: alternate;
-webkit-animation:selected 2s; 
-webkit-animation-iteration-count: 2;
-webkit-animation-direction: alternate;
box-shadow: inset 1px 1px 20px #9ad;
border: 1px solid #9ab;
margin: 5px 0px;
padding-left: 10px;
}
@keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ab;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
@-webkit-keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ad;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
#updates pre {
background-color: inherit;
line-height: 15px;
padding: 5px;
}
#updates .header {
color: #999;
}
#updates .update_history pre {
background-color: #eee;
color: #666;
font-size: 85%;
}
#updates .clickable {
cursor: pointer;
}
#updates .clickable:hover {
color: #D98719;
}
#updates .meta_information pre {
background-color: #fed;
}
#similar_tickets {
max-height: 300px;
overflow-y: auto;
pointer-events: none;
padding: 5px;
background-color: #f4f4f4;
}
.btn-toolbar {
margin-bottom: 0;
height: 30px;
}
#peers {
position: fixed;
bottom: 0px;
right: 0px;
z-index: 100;
list-style: none;
padding: 5px 0px 0px 5px;
margin: 0px;
background-color: white;
box-shadow: 0px 0px 10px white;
}
#peers li {
background-color: #ccc;
color: #000;
display: inline-block;
padding: 5px 10px;
margin-right: 5px;
position: relative;
}
/*
#peers li:hover {
background-color: #999;
cursor: pointer;
}
*/
#peers span.ip {
padding-left: 5px;
color: #666;
}
#peers .new {
bottom: -30px;
}
/*
#peers .me {
background-color: red;
}
*/
</style>

<div class="container-fluid">
<ul id="peers"></ul>
<div class="alert alert-danger"><a class="close" href="https://ticket.opensciencegrid.org/#" data-dismiss="alert">&times;</a>By the end of May 2018, the ticketing system at https://ticket.opensciencegrid.org will be retired and support will be provided at https://support.opensciencegrid.org. Throughout this transition the support email (help@opensciencegrid.org) will be available as a point of contact.<br><br>                                                   
                                                                                                                                                                                   
Please see the service migration page for details: https://opensciencegrid.github.io/technology/policy/service-migrations-spring-2018/#ticket</div><div id="presence" class="pull-right"></div><div class="ticketgui"><script type="text/javascript" src="lib/checktab.js"></script>

<script>
var expanded = false;
function expand_description() {
    var desc = $(".description");
    if(!expanded) {
        expanded = true;
        //expand to minheight
        var min = 250;
        if(desc.height() < min) {
            desc.animate({height: min}, 200);
        }
    }
}

$(document).ready(function() {
    $("input[name='nad']").datepicker({
        dateFormat: 'yy-mm-dd'
    });
});

</script>



<style>
.form-horizontal .control-label {
padding-top: inherit;
font-size:90%;
color:#666;
}
label {
margin-bottom: 0px;
}
.controls {
line-height: 18px;
}
</style>
<form class="form-horizontal" action="https://ticket.opensciencegrid.org/viewer/updatebasic?id=14974" method="post">
<div class="page-header">
    <h3><span class="muted">14974</span> / CPU reporting for Purdue-Carter appears incorrect for 4/16-4/18/13</h3>
</div>

<div class="row-fluid">
<div class="span5">
    <legend>Contact</legend>
    <div class="control-group">
        <label class="control-label">Full Name</label>
        <div class="controls">John Weigand</div>
    </div>
    <div class="control-group">
        <label class="control-label">Email</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">Phone</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">CC</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>

    <legend>Details</legend>
    <div class="control-group"><label class="control-label">Resource Name</label><div class="controls">Purdue-Carter</div></div><div class="control-group"><label class="control-label">Associated VO</label><div class="controls">CMS</div></div><div class="control-group"><label class="control-label">Submitted Via</label><div class="controls">GOC Ticket/submit</div></div><div class="control-group"><label class="control-label">Submitter</label><div class="controls">John Weigand</div></div><div class="control-group"><label class="control-label">Support Center</label><div class="controls">USCMS_Tier2</div></div>
    <div class="control-group">
        <label class="control-label">Ticket Type</label>
        <div class="controls">Problem/Request</div>
    </div>
    <div class="control-group">
        <label class="control-label">Priority</label>
        <div class="controls">Normal</div>
    </div>
    <div class="control-group">
        <label class="control-label">Status</label>
        <div class="controls">
Closed</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action</label>
        <div class="controls">ENG Action</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action Deadline</label>
        <div class="controls flag_red">2013-05-08</div>
    </div>

</div><!--span-->
<div class="span7">
    <legend>Assignees</legend>
    <div class="assignee" style="width: 60%">USCMS Tier 2 <span class="muted"> / OSG Support Centers</span></div>    <br>

    <legend>Assignees</legend>
    TODO
    <br>

    <style>
legend.noborder {
border-bottom: none;
}
</style>

<div id="attachment-list"/>
<script>
$(function () {
    var first = true;
    $.getJSON("attachment/list/14974", function (files) {
        //console.dir(files);
        var html = "<table class=\"table table-condensed\">";
        $(files).each(function() {
            if(first) {
                first = false;
                html += "<legend class=\"noborder\">Attachmenets</legend>";
            }
            html += "<tr class=\"attachment\">";
            html += "<td><img src=\""+this.thumbnail_url+"\"/></td>";
            html += "<td><a href=\""+this.url+"\" target=\"_blank\">"+this.name+"</a></td>";
            html += "<td>"+bytesToSize(this.size, 1)+"</td>";
            html += "</tr>";
        });
        html += "</table>";
        $("#attachment-list").html(html);
    });
});

function download(url) {
    window.open(url, "_blank");
}
</script>


</div><!--span-->
</div><!--row-fluid-->


</form>

</div>
<div id="updates" style="clear: both;">
    <legend>Past Updates
    <div class="btn-toolbar pull-right toolbar">
        <div class="btn-group">
                <a class="btn btn-small" href="https://ticket.opensciencegrid.org/14974?sort=up&amp;"><i class="icon-arrow-up"></i> Sort</a>

        
        <a class="btn btn-small" href="https://ticket.opensciencegrid.org/14974?expandall=true&amp;">Expand Descriptions</a>        <a class="btn btn-small" target="_blank" href="mailto:osg@tick.globalnoc.iu.edu?subject=Open%20Science%20Grid%3A%20CPU%20reporting%20for%20Purdue-Carter%20appears%20incorrect%20for%204%2F16-4%2F18%2F13%20ISSUE%3D14974%20PROJ%3D71"><i class="icon-envelope"></i> Update w/Email</a>
        </div>
    </div><!--btn-toolbar-->
    </legend>

    <div class='update_description'><i onclick="document.location='14974#1367848570'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-05-06T13:56:10+00:00">May 6, 2013 01:56 PM UTC</time><a class="anchor" name="1367848570">&nbsp;</a></div><pre>The numbers look good.
This ticket can be closed.

As a last note, JIRA ticket 1032 <a href='https&#58;//jira.opensciencegrid.org/browse/SOFTWARE-1032' target='_blank' rel='nofollow'>https&#58;//jira.opensciencegrid.org/browse/SOFTWARE-1032</a>
has been taken out to address this PBS reporting issue as it has affected several other
PBS resources.  Since these other resources were non-WLCG reporting there was no
immediate need to correct this data and will be addressed in separate tickets.

Thanks
John Weigand

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=John Weigand 144</pre></div><div class='update_description'><i onclick="document.location='14974#1367617044'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-05-03T21:37:24+00:00">May 3, 2013 09:37 PM UTC</time><a class="anchor" name="1367617044">&nbsp;</a></div><pre>mysql&#62; select WallDuration, CpuUserDuration, CpuSystemDuration from JobUsageRecord where dbid in (1031067248 ,1031067252 ,1031336930 ,1031336908 ,1031336915 ,1031336919 ,1031186132 ,1031156881 ,1031336912 ,1032179726 ,1032686463);+--------------+-----------------+-------------------+
| WallDuration | CpuUserDuration | CpuSystemDuration |
+--------------+-----------------+-------------------+
|          957 |     86061704801 |                 0 |
|          827 |    286380359155 |                 0 |
|         1411 |     36435898092 |                 0 |
|         2052 |     74537699527 |                 0 |
|           72 |     22572362832 |                 0 |
|           73 |     41003512247 |                 0 |
|           72 |     30889545362 |                 0 |
|           60 |     12286333522 |                 0 |
|           75 |    203347355543 |                 0 |
|           17 |     25822834243 |                 0 |
|          419 |    331663628844 |                 0 |
+--------------+-----------------+-------------------+
11 rows in set (0.00 sec)

mysql&#62; select WallDuration, CpuUserDuration, CpuSystemDuration from JobUsageRecord where dbid in (1031056669, 1031067248 ,1031067252 ,1031336930 ,1031336908 ,1031336915 ,1031336919 ,1031186132 ,1031156881 ,1031336912 ,1032179726 ,1032686463);
+--------------+-----------------+-------------------+
| WallDuration | CpuUserDuration | CpuSystemDuration |
+--------------+-----------------+-------------------+
|          634 |     94222952935 |                 0 |
|          957 |     86061704801 |                 0 |
|          827 |    286380359155 |                 0 |
|         1411 |     36435898092 |                 0 |
|         2052 |     74537699527 |                 0 |
|           72 |     22572362832 |                 0 |
|           73 |     41003512247 |                 0 |
|           72 |     30889545362 |                 0 |
|           60 |     12286333522 |                 0 |
|           75 |    203347355543 |                 0 |
|           17 |     25822834243 |                 0 |
|          419 |    331663628844 |                 0 |
+--------------+-----------------+-------------------+
12 rows in set (0.00 sec)
<div id='show_1658508096' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_1658508096'>
mysql&#62; update JobUsageRecord set WallDuration=0,CpuUserDuration=0,CpuSystemDuration=0 where dbid in (1031056669, 1031067248 ,1031067252 ,1031336930 ,1031336908 ,1031336915 ,1031336919 ,1031186132 ,1031156881 ,1031336912 ,1032179726 ,1032686463);
Query OK, 12 rows affected (0.00 sec)
Rows matched&#58; 12  Changed&#58; 12  Warnings&#58; 0

mysql&#62; select WallDuration, CpuUserDuration, CpuSystemDuration from JobUsageRecord where dbid in (1031056669, 1031067248 ,1031067252 ,1031336930 ,1031336908 ,1031336915 ,1031336919 ,1031186132 ,1031156881 ,1031336912 ,1032179726 ,1032686463);
+--------------+-----------------+-------------------+
| WallDuration | CpuUserDuration | CpuSystemDuration |
+--------------+-----------------+-------------------+
|            0 |               0 |                 0 |
|            0 |               0 |                 0 |
|            0 |               0 |                 0 |
|            0 |               0 |                 0 |
|            0 |               0 |                 0 |
|            0 |               0 |                 0 |
|            0 |               0 |                 0 |
|            0 |               0 |                 0 |
|            0 |               0 |                 0 |
|            0 |               0 |                 0 |
|            0 |               0 |                 0 |
|            0 |               0 |                 0 |
+--------------+-----------------+-------------------+
12 rows in set (0.00 sec)

mysql&#62;

Done
Purdue-carter graph shoulld look OK again.

Please open new tickets for the other ones that are bad.

Steve Timm

by /DC=org/DC=doegrids/OU=People/CN=Steven Timm 74183
</div><script type='text/javascript'>
        $('#show_1658508096').click(function() {
            $('#detail_1658508096').slideDown("normal");
            $('#show_1658508096').hide();
            $('#hide_1658508096').show();
        });
        $('#hide_1658508096').click(function() {
            $('#detail_1658508096').slideUp();
            $('#hide_1658508096').hide();
            $('#show_1658508096').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='14974#1367616832'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-05-03T21:33:52+00:00">May 3, 2013 09:33 PM UTC</time><a class="anchor" name="1367616832">&nbsp;</a></div><pre>Loaded new del_JUR_from_summary procedure into all gratia databases.
mysql&#62; &#92;. /root/bin/purdue_carter_dbid_edit.sql
Query OK, 0 rows affected (0.45 sec)

Query OK, 0 rows affected (0.08 sec)

Query OK, 0 rows affected (0.00 sec)

Query OK, 0 rows affected (0.18 sec)

Query OK, 0 rows affected (0.00 sec)

Query OK, 0 rows affected (0.00 sec)

Query OK, 0 rows affected (0.03 sec)

Query OK, 0 rows affected (0.16 sec)

Query OK, 0 rows affected (0.11 sec)

Query OK, 0 rows affected (0.05 sec)

Query OK, 0 rows affected (0.19 sec)

Query OK, 0 rows affected (0.18 sec)

mysql&#62; SELECT Site.SiteName AS SiteName, date_format(EndTime,&#34;%Y-%m-%d&#34;) as Month, Sum(NJobs) as Jobs, Round(Sum(CpuUserDuration+CpuSystemDuration)/3600) as CpuHrs, Round(Sum(WallDuration)/3600) as WallHrs from Site, Probe, MasterSummaryData Main where Site.SiteName in (&#34;Purdue-Carter&#34;) and Site.siteid = Probe.siteid and Probe.ProbeName  = Main.ProbeName and Main.EndTime&#62;= @start and Main.EndTime&#60;= @end and Main.ResourceType=&#39;batch&#39; group by SiteName, Month;
+---------------+------------+------+--------+---------+
| SiteName      | Month      | Jobs | CpuHrs | WallHrs |
+---------------+------------+------+--------+---------+
| Purdue-Carter | 2013-04-14 | 5429 |   6743 |   18107 |
| Purdue-Carter | 2013-04-15 | 3742 |   4773 |    8260 |
| Purdue-Carter | 2013-04-16 |  525 |    720 |    3361 |
| Purdue-Carter | 2013-04-17 |  977 |   1881 |    2519 |
| Purdue-Carter | 2013-04-18 | 3029 |  16492 |   21944 |
<div id='show_1031071559' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_1031071559'>| Purdue-Carter | 2013-04-19 | 1746 |  12592 |   14854 |
| Purdue-Carter | 2013-04-20 | 2872 |  32400 |   33657 |
+---------------+------------+------+--------+---------+
7 rows in set (2.27 sec)

by /DC=org/DC=doegrids/OU=People/CN=Steven Timm 74183
</div><script type='text/javascript'>
        $('#show_1031071559').click(function() {
            $('#detail_1031071559').slideDown("normal");
            $('#show_1031071559').hide();
            $('#hide_1031071559').show();
        });
        $('#hide_1031071559').click(function() {
            $('#detail_1031071559').slideUp();
            $('#hide_1031071559').hide();
            $('#show_1031071559').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='14974#1367593692'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-05-03T15:08:12+00:00">May 3, 2013 03:08 PM UTC</time><a class="anchor" name="1367593692">&nbsp;</a></div><pre>Steve,

I have fixed the del_JUR_from_summary procedure.
You will have to reload it.

Then
1. repeat your procedure calls
call del_JUR_from_summary(1031067248);
call del_JUR_from_summary(1031067252);
call del_JUR_from_summary(1031336930);
call del_JUR_from_summary(1031336908);
call del_JUR_from_summary(1031336915);
call del_JUR_from_summary(1031336919);
call del_JUR_from_summary(1031186132);
call del_JUR_from_summary(1031156881);
call del_JUR_from_summary(1031336912);
call del_JUR_from_summary(1032179726);
call del_JUR_from_summary(1032686463);

2. query the MasterSummaryData table to verify
set @start =&#39;2013-04-14 00&#58;00&#58;00&#39;;
set @end   =&#39;2013-04-20 00&#58;00&#58;00&#39;;
SELECT
Site.SiteName AS SiteName,
date_format(EndTime,&#34;%Y-%m-%d&#34;) as Month,
Sum(NJobs) as Jobs,
Round(Sum(CpuUserDuration+CpuSystemDuration)/3600) as CpuHrs,
Round(Sum(WallDuration)/3600) as WallHrs
from
Site, Probe, MasterSummaryData Main
where
Site.SiteName in (&#34;Purdue-Carter&#34;)
and Site.siteid = Probe.siteid
and Probe.ProbeName  = Main.ProbeName
and Main.StartTime &#62;= @start
<div id='show_1469340469' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_1469340469'>and Main.EndTime   &#60; @end
and Main.ResourceType = &#34;Batch&#34;
group by SiteName, Month
;

3. update the JobUsageRecord
select WallDuration, CpuUserDuration, CpuSystemDuration
from JobUsageRecord
where dbid in (1031067248 ,1031067252 ,1031336930 ,1031336908 ,1031336915 ,1031336919 ,1031186132 ,1031156881 ,1031336912 ,1032179726 ,1032686463)

update JobUsageRecord
set WallDuration=0, CpuUserDuration=0, CpuSystemDuration=0
where dbid in (1031067248 ,1031067252 ,1031336930 ,1031336908 ,1031336915 ,1031336919 ,1031186132 ,1031156881 ,1031336912 ,1032179726 ,1032686463)

select WallDuration, CpuUserDuration, CpuSystemDuration  where
from JobUsageRecord
where dbid in (1031067248 ,1031067252 ,1031336930 ,1031336908 ,1031336915 ,1031336919 ,1031186132 ,1031156881 ,1031336912 ,1032179726 ,1032686463)

Advise when you want to do this.

John Weigand

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=John Weigand 144
</div><script type='text/javascript'>
        $('#show_1469340469').click(function() {
            $('#detail_1469340469').slideDown("normal");
            $('#show_1469340469').hide();
            $('#hide_1469340469').show();
        });
        $('#hide_1469340469').click(function() {
            $('#detail_1469340469').slideUp();
            $('#hide_1469340469').hide();
            $('#show_1469340469').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='14974#1367530561'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-05-02T21:36:01+00:00">May 2, 2013 09:36 PM UTC</time><a class="anchor" name="1367530561">&nbsp;</a></div><pre>It appears that the del_JUR_from_summary procedure did NOT work.
The summary table remains unchanged still showing a ridiculous amount of CPU.
Have to figure out what the warning was and why the procedure didn&#39;t work.

by /DC=org/DC=doegrids/OU=People/CN=Steven Timm 74183</pre></div><div class='update_description'><i onclick="document.location='14974#1367529942'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-05-02T21:25:42+00:00">May 2, 2013 09:25 PM UTC</time><a class="anchor" name="1367529942">&nbsp;</a></div><pre>Step 1&#58;

mysql&#62; &#92;. /root/bin/purdue_carter_dbid_edit.sql
Query OK, 1 row affected, 1 warning (0.75 sec)

Query OK, 1 row affected, 1 warning (0.26 sec)

Query OK, 1 row affected, 1 warning (0.20 sec)

Query OK, 1 row affected, 1 warning (0.26 sec)

Query OK, 1 row affected, 1 warning (0.20 sec)

Query OK, 1 row affected, 1 warning (0.11 sec)

Query OK, 1 row affected, 1 warning (0.08 sec)

Query OK, 1 row affected, 1 warning (0.44 sec)

Query OK, 1 row affected, 1 warning (0.31 sec)

Query OK, 1 row affected, 1 warning (0.15 sec)

Query OK, 1 row affected, 1 warning (0.26 sec)

Query OK, 1 row affected, 1 warning (0.51 sec)

Now verify to see if the summary record has been adjusted.

by /DC=org/DC=doegrids/OU=People/CN=Steven Timm 74183</pre></div><div class='update_description'><i onclick="document.location='14974#1367527281'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-05-02T20:41:21+00:00">May 2, 2013 08:41 PM UTC</time><a class="anchor" name="1367527281">&nbsp;</a></div><pre>Steve,

I think the procedure should be modified slightly due to the nature of del_JUR_from_summary procedure.

As we both know, it makes the proper adjustments to the summary table as IF the JUR record were
actually deleted BUT does not really delete the JUR due to all the complications with foreign keys.
So, if it accidentally gets run twice, we will drive all the summary tables terribly negative.

So, what we should do is&#58;
1. Run the del_JUR_from_summary for each dbid as you show
2. verify the summary table numbers have been adjusted
3. update the individual UR records for the 2 CPU and 1 Wall time values setting them to zero.

There are several (maybe many) other PBS JUR records that came up for extreme numbers like
Purdue on other sites and when we go to analyze them these 10 will not show up again and
accidentally get re-processed.  Correcting that situation would be nasty.... real nasty

I can provide you the commands for updating the 3 columns in the JUR tomorrow.

Sound good

John Weigand

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=John Weigand 144</pre></div><div class='update_description'><i onclick="document.location='14974#1367522767'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-05-02T19:26:07+00:00">May 2, 2013 07:26 PM UTC</time><a class="anchor" name="1367522767">&nbsp;</a></div><pre>call del_JUR_from_summary(1031056669);
call del_JUR_from_summary(1031067248);
call del_JUR_from_summary(1031067252);
call del_JUR_from_summary(1031336930);
call del_JUR_from_summary(1031336908);
call del_JUR_from_summary(1031336915);
call del_JUR_from_summary(1031336919);
call del_JUR_from_summary(1031186132);
call del_JUR_from_summary(1031156881);
call del_JUR_from_summary(1031336912);
call del_JUR_from_summary(1032179726);
call del_JUR_from_summary(1032686463);

Will execute this sql statement to remove the cpu time from summary table for these 12 records.
unless there is any objection.

by /DC=org/DC=doegrids/OU=People/CN=Steven Timm 74183</pre></div><div class='update_description'><i onclick="document.location='14974#1367522263'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-05-02T19:17:43+00:00">May 2, 2013 07:17 PM UTC</time><a class="anchor" name="1367522263">&nbsp;</a></div><pre>Ah, and now I see that John would like me to approve the deletion of the records.  Sure, I will approve -- it is best that we transmit the most accurate information, even if some modifications are required to original results.  Best wishes.

Ken

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=bloom/CN=474417/CN=Kenneth Bloom</pre></div><div class='update_description'><i onclick="document.location='14974#1367522040'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-05-02T19:14:00+00:00">May 2, 2013 07:14 PM UTC</time><a class="anchor" name="1367522040">&nbsp;</a></div><pre>I&#39;m added; I&#39;ve been getting notices for much of the day....

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=bloom/CN=474417/CN=Kenneth Bloom</pre></div><div class='update_description'><i onclick="document.location='14974#1367518699'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-05-02T18:18:19+00:00">May 2, 2013 06:18 PM UTC</time><a class="anchor" name="1367518699">&nbsp;</a></div><pre>Trying again to add Ken... it does not appear to take it

John weigand

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=John Weigand 144</pre></div><div class='update_description'><i onclick="document.location='14974#1367518629'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-05-02T18:17:09+00:00">May 2, 2013 06:17 PM UTC</time><a class="anchor" name="1367518629">&nbsp;</a></div><pre>Adding Ken Bloom

John Weigand

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=John Weigand 144</pre></div><div class='update_description'><i onclick="document.location='14974#1367517594'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-05-02T17:59:54+00:00">May 2, 2013 05:59 PM UTC</time><a class="anchor" name="1367517594">&nbsp;</a></div><pre>I hate to interrupt the debugging of the probe
BUT  the immediate need is
I need to know if I can delete those 12 records from Gratia.

John Weigand

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=John Weigand 144</pre></div><div class='update_description'><i onclick="document.location='14974#1367517078'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-05-02T17:51:18+00:00">May 2, 2013 05:51 PM UTC</time><a class="anchor" name="1367517078">&nbsp;</a></div><pre>Hi Tanya,

I reported this to Purdue-Carter torque sys admin ( carter is community cluster and &#34;cms&#34; is only one queue of the cluster ).
He mentioned that torque on carter had a bug related to clock&#58; &#34;We had a bug on carter for a day or two that caused the clocks to think they were going faster than they actually were. It&#39;s probably a result of that bug...&#34; , he said )

Let me know if you need more information or if I can do anything to make it fixed?

Regards,
-Majid

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=Majid Arabgol 1040</pre></div><div class='update_description'><i onclick="document.location='14974#1367515460'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-05-02T17:24:20+00:00">May 2, 2013 05:24 PM UTC</time> by <b>Tanya Levshina</b><a class="anchor" name="1367515460">&nbsp;</a></div><pre>Hi,
I am looking for a specific job in the log&#58;
4/18/2013 12&#58;09&#58;03;0100;PBS_Server.48144;Job;1865133.carter-adm.rcac.purdue.edu;enqueuing into cms, state 1 hop 1
04/18/2013 12&#58;09&#58;03;0008;PBS_Server.48144;Job;req_commit;job_id&#58; 1865133.carter-adm.rcac.purdue.edu
04/18/2013 12&#58;09&#58;19;0008;PBS_Server.48108;Job;1865133.carter-adm.rcac.purdue.edu;Job Run at request of root@....
04/18/2013 12&#58;09&#58;20;0008;PBS_Server.48108;Job;1865133.carter-adm.rcac.purdue.edu;Not sending email&#58; job requested no e-mail
04/18/2013 12&#58;16&#58;18;0008;PBS_Server.48308;Job;1865133.carter-adm.rcac.purdue.edu;Not sending email&#58; job requested no e-mail
04/18/2013 12&#58;16&#58;18;0010;PBS_Server.48308;Job;1865133.carter-adm.rcac.purdue.edu;Exit_status=0 resources_used.cput=92128785&#58;47&#58;24 resources_used.mem=71536kb resources_used.vmem=1931456kb resources_used.walltime=00&#58;06&#58;59
04/18/2013 12&#58;16&#58;18;0008;PBS_Server.48304;Job;1865133.carter-adm.rcac.purdue.edu;on_job_exit valid pjob&#58; 1865133.carter-adm.rcac.purdue.edu (substate=50)
04/18/2013 12&#58;16&#58;35;0100;PBS_Server.48539;Job;1865133.carter-adm.rcac.purdue.edu;dequeuing from cms, state COMPLETE

See cput=92128785&#58;47&#58;24

Compare with the &#34;normal&#34; job &#58;
grep 1862754 pbs-log/20130418
04/18/2013 09&#58;27&#58;27;0100;PBS_Server.48301;Job;1862754.carter-adm.rcac.purdue.edu;enqueuing into cms, state 1 hop 1
04/18/2013 09&#58;27&#58;27;0008;PBS_Server.48301;Job;req_commit;job_id&#58; 1862754.carter-adm.rcac.purdue.edu
04/18/2013 09&#58;30&#58;43;0008;PBS_Server.48555;Job;1862754.carter-adm.rcac.purdue.edu;Job Run at request of root@....
04/18/2013 09&#58;30&#58;44;0008;PBS_Server.48555;Job;1862754.carter-adm.rcac.purdue.edu;Not sending email&#58; job requested no e-mail
04/18/2013 23&#58;43&#58;35;0008;PBS_Server.48167;Job;1862754.carter-adm.rcac.purdue.edu;Not sending email&#58; job requested no e-mail
04/18/2013 23&#58;43&#58;35;0010;PBS_Server.48167;Job;1862754.carter-adm.rcac.purdue.edu;Exit_status=0 resources_used.cput=11&#58;21&#58;51 resources_used.mem=785808kb resources_used.vmem=1343996kb resources_used.walltime=14&#58;12&#58;52
04/18/2013 23&#58;43&#58;35;0008;PBS_Server.48666;Job;1862754.carter-adm.rcac.purdue.edu;on_job_exit valid pjob&#58; 1862754.carter-adm.rcac.purdue.edu (substate=50)
04/18/2013 23&#58;43&#58;54;0100;PBS_Server.48293;Job;1862754.carter-adm.rcac.purdue.edu;dequeuing from cms, state COMPLETE

So, gratia probe is reporting correctly but do you have any idea why pbs reports such unreasonable number?
Thanks,
Tanya</pre></div><div class='update_description'><i onclick="document.location='14974#1367515020'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-05-02T17:17:00+00:00">May 2, 2013 05:17 PM UTC</time><a class="anchor" name="1367515020">&nbsp;</a></div><pre>John, Tanya,

Your welcome!
If you think gratia or/and pbs accounting logs are useful. I can attach them too.

Regards,
-Majid

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=Majid Arabgol 1040</pre></div><div class='update_description'><i onclick="document.location='14974#1367512910'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-05-02T16:41:50+00:00">May 2, 2013 04:41 PM UTC</time> by <b>Tanya Levshina</b><a class="anchor" name="1367512910">&nbsp;</a></div><pre>It looks like Suchandra was not assigned in this ticket.</pre></div><div class='update_description'><i onclick="document.location='14974#1367512827'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-05-02T16:40:27+00:00">May 2, 2013 04:40 PM UTC</time> by <b>Tanya Levshina</b><a class="anchor" name="1367512827">&nbsp;</a></div><pre>Thank you for logs!
I&#39;ve created JIRA ticket <a href='https&#58;//jira.opensciencegrid.org/browse/SOFTWARE-1032' target='_blank' rel='nofollow'>https&#58;//jira.opensciencegrid.org/browse/SOFTWARE-1032</a>  assigned to Suchandra.
Unfortunately Purdue is not only PBS site that reports wrong cpu usage from time to time.
We will update this ticket as soon as we have more info.

Thanks,
Tanya</pre></div><div class='update_description'><i onclick="document.location='14974#1367511166'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-05-02T16:12:46+00:00">May 2, 2013 04:12 PM UTC</time><a class="anchor" name="1367511166">&nbsp;</a></div><pre>Majid / Ken

The important thing is that we be able to delete those 12 records in Gratia so
that a more normal accounting of Purdue-Carter usage gets sent to WLCG for
MOU purposes.   Changing what they publish after the fact is not an easy task
on their end.

I have found other sites with PBS probes having the same issue but they do not
affect WLCG MOU for those sites.  In all cases, it does not appear to be a
consistent issue with the data from PBS.

The PBS logs will be helpful, I hope.  Thanks for attaching them.

John Weigand

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=John Weigand 144</pre></div><div class='update_description'><i onclick="document.location='14974#1367509735'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-05-02T15:48:55+00:00">May 2, 2013 03:48 PM UTC</time><a class="anchor" name="1367509735">&nbsp;</a></div><pre>Dear John, Tanya,

What happend on April the 16th and 17th &#58;
We scheduled downtime for our cluster including Purdue-Carter on April 17th, but we stopped cms queue  on torque in Purdue-Carter about 6&#58;00PM on the 16th ( not to accept more jobs ), after maintenance done  on April the 17th, we put back the cms queue  at about   10&#58;30AM. I dont know if this caused the problem.

I attached pbs logs for  the three  days, if you need more  logs, let me know.

Thank you

Regards,
-Majid

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=Majid Arabgol 1040</pre></div><div class='update_description'><i onclick="document.location='14974#1367504844'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-05-02T14:27:24+00:00">May 2, 2013 02:27 PM UTC</time> by <b>Tanya Levshina</b><a class="anchor" name="1367504844">&nbsp;</a></div><pre>Hi,
There is either some bug in gratia pbs probe or some new format in pbs logs that produces very strange results.
For example for the record (check CPU vs WallDuration)&#58;
select CommonName, CpuUserDuration,CpuSystemDuration,Njobs,WallDuration,Status,ProbeName from JobUsageRecord j, JobUsageRecord_Meta m where j.dbid=m.dbid and j.dbid=1032686463;
+----------------------------------------------------+---------------------+------------------------+-------+--------------+--------+-------------------------------------+
| CommonName                                                  | CpuUserDuration | CpuSystemDuration | Njobs | WallDuration | Status | ProbeName                              |
+----------------------------------------------------+---------------------+------------------------+-------+--------------+--------+-------------------------------------+
| /CN=asciaba/CN=430796/CN=Andrea Sciaba |    331663628844 |                                 0 |     1    |              419 |     0      | pbs&#58;carter-osg.rcac.purdue.edu |
+-----------------------------------------------------+--------------------+----------------+-------+-------+--------------+-----------------------------------------------+
1 row in set (0.00 sec)

Can we get pbs log? Can sys admin respond ASAP?
Thanks,
Tanya</pre></div><div class='update_description'><i onclick="document.location='14974#1367501620'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-05-02T13:33:40+00:00">May 2, 2013 01:33 PM UTC</time><a class="anchor" name="1367501620">&nbsp;</a></div><pre>I think I found the problem but have no idea the cause.

Did you all have any problems over that period (4/16-18) with
glideinwms pilot jobs running amuck?

I am seeing in Gratia about 12 individual jobs that exceeded 100 hours of CPU.
The CPU cycles make no sense.

| dbid       | CommonName                                            | Start_Time | End_Time   | CpuSysHrs | CpuUserHrs | WallHrs |
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
| 1031056669 | /CN=uscmspilot/cmssrv119.fnal.gov        | 2013-04-16 | 2013-04-16 |         0 |   26173042 |       0 |
| 1031067248 | /CN=uscmspilot/cmssrv119.fnal.gov        | 2013-04-16 | 2013-04-16 |         0 |   23906029 |       0 |
| 1031067252 | /CN=uscmspilot/cmssrv119.fnal.gov        | 2013-04-16 | 2013-04-16 |         0 |   79550100 |       0 |
| 1031336930 | /CN=uscmspilot05/glidein-1.t2.ucsd.edu | 2013-04-16 | 2013-04-16 |         0 |   56485377 |       0 |
| 1031336908 | /CN=uscmspilot05/glidein-1.t2.ucsd.edu | 2013-04-16 | 2013-04-16 |         0 |    6270101 |       0 |
| 1031336915 | /CN=uscmspilot05/glidein-1.t2.ucsd.edu | 2013-04-16 | 2013-04-16 |         0 |    8580429 |       0 |
| 1031336919 | /CN=uscmspilot06/glidein-1.t2.ucsd.edu | 2013-04-16 | 2013-04-16 |         0 |    3412870 |       0 |
| 1031186132 | /CN=uscmspilot48/glidein-1.t2.ucsd.edu | 2013-04-16 | 2013-04-16 |         0 |   20704917 |       1 |
| 1031156881 | /CN=uscmspilot48/glidein-1.t2.ucsd.edu | 2013-04-16 | 2013-04-16 |         0 |   10121083 |       0 |
| 1031336912 | /CN=uscmspilot50/glidein-1.t2.ucsd.edu | 2013-04-16 | 2013-04-16 |         0 |   11389865 |       0 |
| 1032179726 | /CN=uscmspilot09/glidein-1.t2.ucsd.edu | 2013-04-17 | 2013-04-17 |         0 |    7173010 |       0 |
| 1032686463 | /CN=asciaba/CN=430796/CN=Andrea Sciaba | 2013-04-18 | 2013-04-18 |         0 |   92128786 |       0 |

I am cc&#39;ing gratia-operations on this ticket just to give them a &#34;heads-up&#34;
on some fixes to Gratia data that may have to be made to delete these records.

I would like you permission to proceed in deleting these records from Gratia.
And if you have any insight into how these values got in there, it would be appreciated.

We need to resolve this pretty quick as 5/6 is when LCG accounting pulls down the numbers for MOU reporting.

John Weigand

ps.. this is what your accounting data for this year looks like in EGI.....
<a href='http&#58;//accounting.egi.eu/tier2.php?ExecutingSite=Purdue-Carter&feder_path=1.33.10.1&query=sumcpu&startYear=2013&startMonth=1&endYear=2013&endMonth=5&yRange=SITE&xRange=DATE&voGroup=lhc&chart=GRBAR&scale=LIN&localJobs=onlygridjobs' target='_blank' rel='nofollow'>http&#58;//accounting.egi.eu/tier2.php?ExecutingSite=Purdue-Carter&feder_path=1.33.10.1&query=sumcpu&startYear=2013&startMonth=1&endYear=2013&endMonth=5&yRange=SITE&xRange=DATE&voGroup=lhc&chart=GRBAR&scale=LIN&localJobs=onlygridjobs</a>
<div id='show_258853379' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_258853379'>
by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=John Weigand 144
</div><script type='text/javascript'>
        $('#show_258853379').click(function() {
            $('#detail_258853379').slideDown("normal");
            $('#show_258853379').hide();
            $('#hide_258853379').show();
        });
        $('#hide_258853379').click(function() {
            $('#detail_258853379').slideUp();
            $('#hide_258853379').hide();
            $('#show_258853379').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='14974#1367437212'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-05-01T19:40:12+00:00">May 1, 2013 07:40 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1367437212">&nbsp;</a></div><pre>The CPU hours reported to Gratia for the 3 day period of 4/16-4/18/13 appears
to be seriously incorrect.

+---------------+------------+------+-----------+--------+
| SiteName      | Month      | Jobs | SumCPU    | SumWCT |
+---------------+------------+------+-----------+--------+
| Purdue-Carter | 2013-04-14 | 5429 |      6743 |  18107 |
| Purdue-Carter | 2013-04-15 | 3742 |      4773 |   8260 |
| Purdue-Carter | 2013-04-16 |  535 | 246594532 |   3362 |
| Purdue-Carter | 2013-04-17 |  978 |   7174891 |   2519 |
| Purdue-Carter | 2013-04-18 | 3030 |  92145278 |  21944 |
| Purdue-Carter | 2013-04-19 | 1746 |     12592 |  14854 |
+---------------+------------+------+-----------+--------+

I am guessing it might have been a pbs probe issue during that period.
Maybe not.
These numbers are going to look a  little odd in the April MOU reports from WLCG.
Do you (Purdue-Carter) have any idea what might have happened during that period?

John Weigand

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=John Weigand 144</pre></div><legend>Similar Recent Tickets <small>modified within the last 30 days</small></legend><div id="similar_tickets"><p class="muted">No similar tickets found.</p></div>
</div>
<script type="text/javascript">
function reset_anchor() {
    $("#updates .selected").removeClass("selected");
    var urls = document.location.toString().split('#'); 
    var anchor = urls[1];
    if(anchor) {
        $("a[name='"+anchor+"']").parents(".update_description").addClass("selected");
    }
}
function submitspam(ticket_id) {
    myret = confirm("Would you like to close this ticket as a security ticket, and submit the ticket content to akismet?");
    if(myret == true) {
        $.ajax("viewer/processspam?id="+ticket_id).done(function() {
            window.location.reload();
        });
    }
}

$(function() {
    reset_anchor();
    var ADDITIONAL_COOKIE_NAME = 'gocticket';
    var options = { path: '/', expires: 365};

    if(window.opener && window.opener.name == "gocticket_list") {
        v = $.cookie("closewindow");
        if(!v) {
            $("#closewindow").attr("checked", "checked"); //on by default
        } else {
            if(v == "checked") {
                $("#closewindow").attr("checked", "checked");
            }
        }
        $("#closewindow").click(function() {
            $.cookie("closewindow", $(this).attr('checked'), options);
        });
    } else {
        $("#closewindow_area").hide();
    }
    function updateTimeago() {
        $("time").timeago();
        setTimeout(updateTimeago, 30*1000);
    }
    updateTimeago();
    $(".description").focus(expand_description);
});
</script>
<hr/>
<footer>
<p>GOC Ticket Version 2.2 | <a href="https://ticket.opensciencegrid.org/goc/submit?app_issue_check=on&amp;app_issue_type=goc&amp;app_goc_url=https%3A%2F%2Fticket.opensciencegrid.org%3A443%2F14974">Report Bugs</a>
 | <a href="https://github.com/opensciencegrid/operations/blob/master/docs/privacy.md">Privacy Policy</a>
</p>

<p> <img align="top" src="images/tag_orange.png"/> Copyright 2018 The Trustees of Indiana University - Developed for Open Science Grid</p>
</footer>


</div><!--container-fluid-->
<script>
//used by searchbox
function parseValue(value) {
    var obj = new Object();
    var tokens = value.split("\t");
    obj.str = tokens[0];
    obj.count = tokens[1];
    return obj;
}

$(function() {
    //bootstrap-2.0.4 stuff
    $(".alert-message").alert();
    $(".dropdown-toggle").dropdown();
    $("span[rel='tooltip']").tooltip();
    $("a[rel=popover]").popover();

    //activate menu that user is currently on
    $("#menu_navigator").addClass("active"); 
    $("#submenu_").addClass("active"); 

    //translate zend validation error message to bootstrap
    $(".errors").addClass("alert").addClass("alert-error");

    //enable autocomplete for search box
    $("#search").autocomplete({
        source: function( request, response ) {
            $.ajax({
                url: "search/autocomplete",
                dataType: "text",
                data: {
                    //featureClass: "P",
                    //style: "full",
                    //maxRows: 12,
                    //name_startsWith: request.term
                    q: request.term
                },
                success: function( data ) {
                    response( $.map( data.split("\n"), function( item ) {
                        if(item == "") return null;
                        return {
                            value: item
                        }
                    }));
                }
            });
        },
        select: function(event, ui) {
            document.location = "search?q="+ui.item.value;
        }
    });
    
});
</script>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-69012-13");
pageTracker._trackPageview();
} catch(err) {}
</script>

</body>
