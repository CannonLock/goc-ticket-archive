<!DOCTYPE html>
<html lang="en">
  <head>
  <base href="">
    <title>[2031] #1674&#58; (VDT Ticket) Grid-monitor job-manager killing speed?</title>    <meta charset="utf-8" />
    <meta name="verify-v1" content="na5IcAJsZVOfEkboRxuIiZ1zpZgnZiWra+nKcS7nA/o=" />
    <meta name="google-site-verification" content="DLrk3ft4s8b-S2TloLCL2LD_t6wcTjgSluf5pmiu2kA" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />
    <link href="https://ticket.opensciencegrid.org/rss" rel="alternate" type="application/rss+xml" title="GOC Ticket Update feed" />

    <style type="text/css">
      body {
        padding-top: 50px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
     #search {
            width: 300px;
     }

    </style>

<script src="https://code.jquery.com/jquery-3.0.0.js"></script>
<script src="https://code.jquery.com/jquery-migrate-3.0.1.js"></script>

   <link href="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet"/>
    <script src="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/js/bootstrap.min.js"></script>

    <link href="https://netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"/>
    <link href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/themes/smoothness/jquery-ui.min.css" rel="stylesheet"/>
 <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>


    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/js/select2.min.js"></script>

    <link href="css/ticket.css" rel="stylesheet" />
    <script src="lib/jquery.cookie.js"></script>

    <link href="images/tag_orange.png" rel="icon" type="image/png"/>
  </head>

  <body>
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>

            <a class="brand" style="padding: 6px 0px 0px 6px;" href="http://opensciencegrid.org"><img src="images/osglogo.40x30.png"/></a>
            <ul class="nav">
                <li class="dropdown"><a href="https://ticket.opensciencegrid.org/#" class="dropdown-toggle" data-toggle="dropdown">GOC Ticket <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    <li><a href="https://my.opensciencegrid.org">MyOSG</a></li>
                    <li><a href="https://oim.opensciencegrid.org">OIM</a></li>
                    <li class="active"><a href="https://ticket.opensciencegrid.org/index">Ticket</a></li>
	<li class="divider"></li>
	<li><a href="http://repo.grid.iu.edu">Repo</a></li>
	<li class="divider"></li>
	<li><a href="http://blogs.grid.iu.edu">Blog</a></li>
                    <li><a href="http://display.grid.iu.edu">Display</a></li>
                    <li><a href="http://osggoc.blogspot.com/">News</a></li>
                    </ul>
                </li>
            </ul>
            <ul class="nav pull-right">
                <li><a href="https://ticket.opensciencegrid.org/sso/">Login</a></li>            </ul>

            <div class="nav-collapse">
                <ul class="nav">
			 <li id="menu_submit"><a href="https://ticket.opensciencegrid.org/submit">Submit</a></li><li id="menu_view" class="dropdown"><a href="https://ticket.opensciencegrid.org/\#" class="dropdown-toggle" data-toggle="dropdown">View <b class="caret"></b></a><ul class="dropdown-menu"><li id="submenu_listopen"><a href="https://ticket.opensciencegrid.org/list/open">Open Tickets</a></li><li id="submenu_listrecentclose"><a href="https://ticket.opensciencegrid.org/list/recentclose">Recently Closed Tickets</a></li><li class="divider"></li><li id="submenu_alltickets"><a href="https://ticket.opensciencegrid.org/search?q=&amp;sort=id">All Tickets</a></li></ul></li>                </ul>

                <form class="navbar-search pull-right" action="https://ticket.opensciencegrid.org/viewer">
                    <input id="search" type="text" name="id" class="search-query span2" placeholder="Search Ticket" value=""/>
                </form>
            </div>
        </div>
      </div>
    </div>

<script type='text/javascript' src='lib/jquery.timeago.js'></script>
<script type='text/javascript' src='lib/byte2size.js'></script>
<style>
#updates .toolbar {
position: relative;
margin-top: 0px;
top: -10px;
font-weight: normal;
}
#updates a.anchor {
position: relative;
top: -50px;
}
#updates .selected pre {
animation:selected 2s;
animation-iteration-count: 2;
animation-direction: alternate;
-webkit-animation:selected 2s; 
-webkit-animation-iteration-count: 2;
-webkit-animation-direction: alternate;
box-shadow: inset 1px 1px 20px #9ad;
border: 1px solid #9ab;
margin: 5px 0px;
padding-left: 10px;
}
@keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ab;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
@-webkit-keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ad;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
#updates pre {
background-color: inherit;
line-height: 15px;
padding: 5px;
}
#updates .header {
color: #999;
}
#updates .update_history pre {
background-color: #eee;
color: #666;
font-size: 85%;
}
#updates .clickable {
cursor: pointer;
}
#updates .clickable:hover {
color: #D98719;
}
#updates .meta_information pre {
background-color: #fed;
}
#similar_tickets {
max-height: 300px;
overflow-y: auto;
pointer-events: none;
padding: 5px;
background-color: #f4f4f4;
}
.btn-toolbar {
margin-bottom: 0;
height: 30px;
}
#peers {
position: fixed;
bottom: 0px;
right: 0px;
z-index: 100;
list-style: none;
padding: 5px 0px 0px 5px;
margin: 0px;
background-color: white;
box-shadow: 0px 0px 10px white;
}
#peers li {
background-color: #ccc;
color: #000;
display: inline-block;
padding: 5px 10px;
margin-right: 5px;
position: relative;
}
/*
#peers li:hover {
background-color: #999;
cursor: pointer;
}
*/
#peers span.ip {
padding-left: 5px;
color: #666;
}
#peers .new {
bottom: -30px;
}
/*
#peers .me {
background-color: red;
}
*/
</style>

<div class="container-fluid">
<ul id="peers"></ul>
<div class="alert alert-danger"><a class="close" href="https://ticket.opensciencegrid.org/#" data-dismiss="alert">&times;</a>By the end of May 2018, the ticketing system at https://ticket.opensciencegrid.org will be retired and support will be provided at https://support.opensciencegrid.org. Throughout this transition the support email (help@opensciencegrid.org) will be available as a point of contact.<br><br>                                                   
                                                                                                                                                                                   
Please see the service migration page for details: https://opensciencegrid.github.io/technology/policy/service-migrations-spring-2018/#ticket</div><div id="presence" class="pull-right"></div><div class="ticketgui"><script type="text/javascript" src="lib/checktab.js"></script>

<script>
var expanded = false;
function expand_description() {
    var desc = $(".description");
    if(!expanded) {
        expanded = true;
        //expand to minheight
        var min = 250;
        if(desc.height() < min) {
            desc.animate({height: min}, 200);
        }
    }
}

$(document).ready(function() {
    $("input[name='nad']").datepicker({
        dateFormat: 'yy-mm-dd'
    });
});

</script>



<style>
.form-horizontal .control-label {
padding-top: inherit;
font-size:90%;
color:#666;
}
label {
margin-bottom: 0px;
}
.controls {
line-height: 18px;
}
</style>
<form class="form-horizontal" action="https://ticket.opensciencegrid.org/viewer/updatebasic?id=2031" method="post">
<div class="page-header">
    <h3><span class="muted">2031</span> / #1674&#58; (VDT Ticket) Grid-monitor job-manager killing speed?</h3>
</div>

<div class="row-fluid">
<div class="span5">
    <legend>Contact</legend>
    <div class="control-group">
        <label class="control-label">Full Name</label>
        <div class="controls">Terrence Martin</div>
    </div>
    <div class="control-group">
        <label class="control-label">Email</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">Phone</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">CC</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>

    <legend>Details</legend>
    
    <div class="control-group">
        <label class="control-label">Ticket Type</label>
        <div class="controls">Problem/Request</div>
    </div>
    <div class="control-group">
        <label class="control-label">Priority</label>
        <div class="controls">Normal</div>
    </div>
    <div class="control-group">
        <label class="control-label">Status</label>
        <div class="controls">
Closed</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action</label>
        <div class="controls">John to review ticket</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action Deadline</label>
        <div class="controls flag_red">2006-09-15</div>
    </div>

</div><!--span-->
<div class="span7">
    <legend>Assignees</legend>
        <br>

    <legend>Assignees</legend>
    TODO
    <br>

    <style>
legend.noborder {
border-bottom: none;
}
</style>

<div id="attachment-list"/>
<script>
$(function () {
    var first = true;
    $.getJSON("attachment/list/2031", function (files) {
        //console.dir(files);
        var html = "<table class=\"table table-condensed\">";
        $(files).each(function() {
            if(first) {
                first = false;
                html += "<legend class=\"noborder\">Attachmenets</legend>";
            }
            html += "<tr class=\"attachment\">";
            html += "<td><img src=\""+this.thumbnail_url+"\"/></td>";
            html += "<td><a href=\""+this.url+"\" target=\"_blank\">"+this.name+"</a></td>";
            html += "<td>"+bytesToSize(this.size, 1)+"</td>";
            html += "</tr>";
        });
        html += "</table>";
        $("#attachment-list").html(html);
    });
});

function download(url) {
    window.open(url, "_blank");
}
</script>


</div><!--span-->
</div><!--row-fluid-->


</form>

</div>
<div id="updates" style="clear: both;">
    <legend>Past Updates
    <div class="btn-toolbar pull-right toolbar">
        <div class="btn-group">
                <a class="btn btn-small" href="https://ticket.opensciencegrid.org/2031?sort=up&amp;"><i class="icon-arrow-up"></i> Sort</a>

        
        <a class="btn btn-small" href="https://ticket.opensciencegrid.org/2031?expandall=true&amp;">Expand Descriptions</a>        <a class="btn btn-small" target="_blank" href="mailto:osg@tick.globalnoc.iu.edu?subject=Open%20Science%20Grid%3A%20%231674%26%2358%3B%20%28VDT%20Ticket%29%20Grid-monitor%20job-manager%20killing%20speed%3F%20ISSUE%3D2031%20PROJ%3D71"><i class="icon-envelope"></i> Update w/Email</a>
        </div>
    </div><!--btn-toolbar-->
    </legend>

    <div class='update_description'><i onclick="document.location='2031#1158263855'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2006-09-14T19:57:35+00:00">Sep 14, 2006 07:57 PM UTC</time> by <b>John Rosheck</b><a class="anchor" name="1158263855">&nbsp;</a></div><pre>Date&#58; Thu, 14 Sep 2006 09&#58;42&#58;26 -0700
From&#58; Terrence Martin &#60;tmartin@....&#62;
To&#58; jrosheck@....
Subject&#58; Re&#58; Grid-monitor job-manager killing speed? ISSUE=2031 PROJ=71

I honestly do not remember. Go ahead and close the ticket if you opened
one. Alain&#39;s information was informative in understanding more about the
condor-g internals.

Terrence

jrosheck@.... wrote&#58;
<font color='#7F7E6F'>&#62; But did you ever see that message from Alain? - it is quite old and from</font>
<font color='#7F7E6F'>&#62; what you are saying, it doesn&#39;t sound like you did.  Is that the case?</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; Thanks,</font>
<font color='#7F7E6F'>&#62; John</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; On Wed, 13 Sep 2006, Terrence Martin wrote&#58;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;&#62; Honestly I would have to retest with 6.7.18. We found other limits in</font>
<font color='#7F7E6F'>&#62;&#62; condor as far as patterns that caused unecessary load or job failures.</font>
<font color='#7F7E6F'>&#62;&#62; Eventually we will get back to testing from the submitter again though</font>
<font color='#7F7E6F'>&#62;&#62; and will see if this is better. Good to know something improved though. &#58;)</font>
<font color='#7F7E6F'>&#62;&#62;</font>
<font color='#7F7E6F'>&#62;&#62; Thanks,</font>
<font color='#7F7E6F'>&#62;&#62;</font>
<font color='#7F7E6F'>&#62;&#62; Terrence</font>
<font color='#7F7E6F'>&#62;&#62;</font>
<font color='#7F7E6F'>&#62;&#62;</font>
<font color='#7F7E6F'>&#62;&#62; jrosheck@.... wrote&#58;</font>
<font color='#7F7E6F'>&#62;&#62;</font>
<font color='#7F7E6F'>&#62;&#62;&#62; Hello,</font>
<font color='#7F7E6F'>&#62;&#62;&#62;</font>
<div id='show_1876103175' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_1876103175'><font color='#7F7E6F'>&#62;&#62;&#62; While looking through the ticket it occurred to me that maybe you didn&#39;t</font>
<font color='#7F7E6F'>&#62;&#62;&#62; get Alain&#39;s email - I&#39;ve attached it at the end.  It looked rather</font>
<font color='#7F7E6F'>&#62;&#62;&#62; extensive to me but I know almost nothing about Condor.</font>
<font color='#7F7E6F'>&#62;&#62;&#62;</font>
</div><script type='text/javascript'>
        $('#show_1876103175').click(function() {
            $('#detail_1876103175').slideDown("normal");
            $('#show_1876103175').hide();
            $('#hide_1876103175').show();
        });
        $('#hide_1876103175').click(function() {
            $('#detail_1876103175').slideUp();
            $('#hide_1876103175').hide();
            $('#show_1876103175').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='2031#1158180058'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2006-09-13T20:40:58+00:00">Sep 13, 2006 08:40 PM UTC</time> by <b>John Rosheck</b><a class="anchor" name="1158180058">&nbsp;</a></div><pre>I emailed Terrance the contents of what Alain wrote about the problem.  I&#39;m wondering
if he ever saw it and
if he hadn&#39;t, why?</pre></div><div class='update_description'><i onclick="document.location='2031#1157638924'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2006-09-07T14:22:04+00:00">Sep 7, 2006 02:22 PM UTC</time> by <b>John Rosheck</b><a class="anchor" name="1157638924">&nbsp;</a></div><pre>This should probably be brought up in the ops meeting since I&#39;m not sure how to proceed.</pre></div><div class='update_description'><i onclick="document.location='2031#1157045627'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2006-08-31T17:33:47+00:00">Aug 31, 2006 05:33 PM UTC</time> by <b>John Rosheck</b><a class="anchor" name="1157045627">&nbsp;</a></div><pre>Date&#58; Thu, 31 Aug 2006 10&#58;13&#58;31 -0700
From&#58; Terrence Martin &#60;tmartin@....&#62;
To&#58; jrosheck@....
Subject&#58; Re&#58; Grid-monitor job-manager killing speed? ISSUE=2031 PROJ=71

jrosheck@.... wrote&#58;
<font color='#7F7E6F'>&#62; [snipped]</font>
<font color='#7F7E6F'>&#62;</font>
I am not sure if there was a resolution or not, I would have to retest
but I do not recall getting any code or configuration suggestions. It
seemed at the time I think that load on the submitter could make the
culling of processes slower and thus increase load on the CE. We
discovered these issues among others related to scalability testing of
the CE in OSG.

Terrence</pre></div><div class='update_description'><i onclick="document.location='2031#1157040667'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2006-08-31T16:11:07+00:00">Aug 31, 2006 04:11 PM UTC</time> by <b>John Rosheck</b><a class="anchor" name="1157040667">&nbsp;</a></div><pre>Date&#58; Thu, 31 Aug 2006 12&#58;10&#58;03 -0400 (EDT)
From&#58; jrosheck@....
To&#58; Terrence Martin &#60;tmartin@....&#62;
Subject&#58; Re&#58; Grid-monitor job-manager killing speed? ISSUE=2031 PROJ=71

Hello,

I found this sitting in my ticket queue waiting on the VDT -- for several
months now.  I followed up on the original VDT ticket and it was closed.
Has the issue summarized below been resolved to your satisfaction?  Please
let me know.

Thanks!
John

Summary of Problem&#58;

While testing 0.4.1 CE at UCSD Terrence noticed the gridmonitor can slow
killing off job-managers. He
had around 600-700 jobs running through osg-gw-3.t2.ucsd.edu and around
400 job-managers running.
The jobs in question are fairly short lived, 10-15 minutes and do nothing
but sleep.So what&#39;s the
criteria that the grid-monitor uses for cleaning up the excess
job-managers? Is there a maximum rate
it will clean up new jobs? How long after a job is submitted does it take
the grid-monitor to kill off?</pre></div><div class='update_description'><i onclick="document.location='2031#1149780011'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2006-06-08T15:20:11+00:00">Jun 8, 2006 03:20 PM UTC</time> by <b>VDT</b><a class="anchor" name="1149780011">&nbsp;</a></div><pre>Sorry for the slow response on this. Whether or not Terrence wants a
ticket, we&#39;re happy to answer the question.

I talked to Jaime Frey, who is &#34;Mr. Condor-G&#34;, and he was able to
provide a lot of answers.

Are you the person submitting the jobs? What version of Condor-G is
being used to submit them? If it&#39;s Condor from OSG 0.4.1, it will be
Condor 6.7.18. The version matters, as we&#39;ll see below.

<font color='#7F7E6F'>&#62; I have currently around 600-700 jobs running</font>
<font color='#7F7E6F'>&#62; through osg-gw-3.t2.ucsd.edu and have around 400 job-managers running.</font>
<font color='#7F7E6F'>&#62; The jobs in question are fairly short lived, I think 10-15 minutes and</font>
<font color='#7F7E6F'>&#62; do nothing but sleep.</font>

If you are using Condor-G 6.7.17 or later, I would not expect to see 400
job managers. There is a new parameter in 6.7.17 called
GRIDMANAGER_MAX_JOBMANAGERS_PER_RESOURCE that will limit the number of
job managers started per user that submits them. It defaults to 15, so a
single user should not see more than 15 job managers at once. If you
have 26 or more users, you might still see 400 job managers. Of course,
you could change that parameters, but most people probably aren&#39;t yet
aware of it, because it&#39;s only documneted deep in the Condor version
history.

If you are using Condor-G before 6.7.17, you can see more lots of job
managers at once, particularly if the jobs are submitted close to each
other in time.

<font color='#7F7E6F'>&#62; Could anyone comment on exactly the criteria that the grid-monitor</font>
<font color='#7F7E6F'>&#62; uses for cleaning up the excess job-managers.</font>

Let me clarify what happens&#58; the grid-monitor does not kill off any job
managers, but the submit side of Condor-G kills them off. (Specifically
the &#34;gridmanager&#34; program running on the submit host.) That doesn&#39;t
<div id='show_1707078287' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_1707078287'>affect your questions below, but I want to make sure it&#39;s clear.

<font color='#7F7E6F'>&#62; Like for example is there a</font>
<font color='#7F7E6F'>&#62; maximum rate it will clean up new jobs?</font>

Nope--when it&#39;s time to kill of job managers, it should happen as
quickly as the submit node can do it. If the submit node is really busy
for some reason (either due to Condor or another reason) it might go
slowly, but there is no limit built into Condor.

<font color='#7F7E6F'>&#62; How long after a job is</font>
<font color='#7F7E6F'>&#62; submitted does it take the grid-monitor to kill off that jobs</font>
<font color='#7F7E6F'>&#62; job-manager?</font>

The files for the job must be staged first, because the job manager is
involved in the staging. Then the grid monitor must report some sort of
success before the job manager is killed off.

<font color='#7F7E6F'>&#62; Is the ability of a single grid-monitor to kill off</font>
<font color='#7F7E6F'>&#62; job-managers hampered by a lot of jobs running under one user? That is</font>
<font color='#7F7E6F'>&#62; if each user has one grid monitor would 6 users, and therefore 6 grid</font>
<font color='#7F7E6F'>&#62; monitors fair better in terms of cleaning things up than say a single</font>
<font color='#7F7E6F'>&#62; users grid monitor that has to prune 600 jobs?</font>

We don&#39;t believe so.

<font color='#7F7E6F'>&#62; Also what are the situations that the grid-monitor should be best at</font>
<font color='#7F7E6F'>&#62; and what would you expect it to be worst at? For example if I submit 100</font>
<font color='#7F7E6F'>&#62; jobs at once does the grid-monitor deal with that better than 100 jobs</font>
<font color='#7F7E6F'>&#62; over 100 seconds?</font>

Because the job manager is needed at the beginning of a job (to stage
file in) and after it completes (to stage files out), the grid monitor
is most effective when jobs are short running. In your scenario (100 at
once, or 100 over 100 seconds), we&#39;re not aware of any significant
difference.

Also note that the user has to turn on the grid monitor and turn off
streaming for the grid monitor to be used.

My best guess is that you&#39;re using an older version of Condor-G, and
submitted a lot of jobs in a short interval. The job managers do create
a lot of load&#58; 400 job managers is known to be a large load on the
gatekeeper. I suspect that if you use a newer version of Condor-G, life
will be better.

If you&#39;re still experiencing problems or if you are using a newer
version of Condor-G, we can investigate further.

Thanks,
-alain
</div><script type='text/javascript'>
        $('#show_1707078287').click(function() {
            $('#detail_1707078287').slideDown("normal");
            $('#show_1707078287').hide();
            $('#hide_1707078287').show();
        });
        $('#hide_1707078287').click(function() {
            $('#detail_1707078287').slideUp();
            $('#hide_1707078287').hide();
            $('#show_1707078287').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='2031#1148413820'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2006-05-23T19:50:20+00:00">May 23, 2006 07:50 PM UTC</time> by <b>Tim Silvers</b><a class="anchor" name="1148413820">&nbsp;</a></div><pre>Leigh requested the ticket be opened, so please ignore my previous comment to closet the ticket.

Summary of problem&#58;

While testing 0.4.1 CE at UCSD Terrence noticed the gridmonitor can slow killing off job-managers. He
had around 600-700 jobs running through osg-gw-3.t2.ucsd.edu and around 400 job-managers running.
The jobs in question are fairly short lived, 10-15 minutes and do nothing but sleep.So what&#39;s the
criteria that the grid-monitor uses for cleaning up the excess job-managers? Is there a maximum rate
it will clean up new jobs? How long after a job is submitted does it take the grid-monitor to kill off?
See full description for full details. Waiting for VDT response.</pre></div><div class='update_description'><i onclick="document.location='2031#1148314709'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2006-05-22T16:18:29+00:00">May 22, 2006 04:18 PM UTC</time> by <b>Tim Silvers</b><a class="anchor" name="1148314709">&nbsp;</a></div><pre>The email was sent to osg-general (Community Support), so no ticket was necessary.</pre></div><div class='update_description'><i onclick="document.location='2031#1148314634'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2006-05-22T16:17:14+00:00">May 22, 2006 04:17 PM UTC</time> by <b>Tim Silvers</b><a class="anchor" name="1148314634">&nbsp;</a></div><pre>Closing ticket.</pre></div><div class='update_description'><i onclick="document.location='2031#1148069288'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2006-05-19T20:08:08+00:00">May 19, 2006 08:08 PM UTC</time> by <b>Terrence Martin</b><a class="anchor" name="1148069288">&nbsp;</a></div><pre>Well I was not specifically looking for a ticket as I am not sure if it
is a bug or a feature. &#58;) I was just looking for some more background to
help explain what we are seeing and if anyone else had seen certain
patterns of submission that the grid-monitor had trouble with. I do not
expect to see what we saw with our CE to be typical for production in
the short term anyway based on our current experience.

Terrence

Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='2031#1148067615'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2006-05-19T19:40:15+00:00">May 19, 2006 07:40 PM UTC</time> by <b>OSG RA</b><a class="anchor" name="1148067615">&nbsp;</a></div><pre>From&#58; leighg@....
To&#58; goc@....
Subject&#58; [tmartin@....&#58; Grid-monitor job-manager killing speed?]
Date-Sent&#58; Friday, May 19, 2006 3&#58;12 PM -0400

Please make a ticket on this issue.

Thanks.
leigh
----- Forwarded message from Terrence Martin &#60;tmartin@....&#62; -----

Date&#58; Fri, 19 May 2006 11&#58;56&#58;53 -0700
From&#58; Terrence Martin &#60;tmartin@....&#62;
Subject&#58; Grid-monitor job-manager killing speed?
To&#58; OSG Operations &#60;osg-operations@....&#62;,
osg-int osg &#60;osg-int@....&#62;
Precedence&#58; list
User-Agent&#58; Thunderbird 1.5 (X11/20051025)
X-Spam-Checker-Version&#58; SpamAssassin 3.1.0 (2005-09-13) on hepa1.fnal.gov
X-Spam-Level&#58;
X-Spam-ListServ-Level&#58;
X-Spam-Status&#58; No,
score=-2.6 required=5.0 tests=BAYES_00 autolearn=ham
version=3.1.0
List-Owner&#58; &#60;mailto&#58;OSG-INT-request@....&#62;
List-Subscribe&#58; &#60;mailto&#58;OSG-INT-subscribe-request@....&#62;
List-Unsubscribe&#58; &#60;mailto&#58;OSG-INT-unsubscribe-request@....&#62;
List-Archive&#58; &#60;<a href='http&#58;//listserv.fnal.gov/scripts/wa.exe?LIST=OSG-INT&#62' target='_blank' rel='nofollow'>http&#58;//listserv.fnal.gov/scripts/wa.exe?LIST=OSG-INT&#62</a>;
List-Help&#58; &#60;<a href='http&#58;//listserv.fnal.gov/scripts/wa.exe?LIST=OSG-INT&#62' target='_blank' rel='nofollow'>http&#58;//listserv.fnal.gov/scripts/wa.exe?LIST=OSG-INT&#62</a>;,
&#60;mailto&#58;LISTSERV@....?body=INFO OSG-INT&#62;

So we are testing out this new 0.4.1 CE at UCSD and I noticed something
that I have before as well, that the gridmonitor can be a bit lazy at
killing off job-managers. I have currently around 600-700 jobs running
through osg-gw-3.t2.ucsd.edu and have around 400 job-managers running.
<div id='show_1614211466' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_1614211466'>The jobs in question are fairly short lived, I think 10-15 minutes and
do nothing but sleep.

Could anyone comment on exactly the criteria that the grid-monitor uses
for cleaning up the excess job-managers. Like for example is there a
maximum rate it will clean up new jobs? How long after a job is
submitted does it take the grid-monitor to kill off that jobs
job-manager? Is the ability of a single grid-monitor to kill off
job-managers hampered by a lot of jobs running under one user? That is
if each user has one grid monitor would 6 users, and therefore 6 grid
monitors fair better in terms of cleaning things up than say a single
users grid monitor that has to prune 600 jobs?

Also what are the situations that the grid-monitor should be best at and
what would you expect it to be worst at? For example if I submit 100
jobs at once does the grid-monitor deal with that better than 100 jobs
over 100 seconds?

I can delve into the code but I figured I would ask. &#58;)

Terrence

----- End forwarded message -----
</div><script type='text/javascript'>
        $('#show_1614211466').click(function() {
            $('#detail_1614211466').slideDown("normal");
            $('#show_1614211466').hide();
            $('#hide_1614211466').show();
        });
        $('#hide_1614211466').click(function() {
            $('#detail_1614211466').slideUp();
            $('#hide_1614211466').hide();
            $('#show_1614211466').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='2031#1148067539'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2006-05-19T19:38:59+00:00">May 19, 2006 07:38 PM UTC</time> by <b>OSG RA</b><a class="anchor" name="1148067539">&nbsp;</a></div><pre>From&#58; Terrence Martin &#60;tmartin@....&#62;
To&#58; OSG Operations &#60;osg-operations@....&#62;,
osg-int osg &#60;osg-int@....&#62;
Subject&#58; Grid-monitor job-manager killing speed?
Date-Sent&#58; Friday, May 19, 2006 11&#58;56 AM -0700

So we are testing out this new 0.4.1 CE at UCSD and I noticed something that I have
before as well, that the gridmonitor can be a bit lazy at killing off job-managers. I
have currently around 600-700 jobs running through osg-gw-3.t2.ucsd.edu and have
around 400 job-managers running. The jobs in question are fairly short lived, I think
10-15 minutes and do nothing but sleep.

Could anyone comment on exactly the criteria that the grid-monitor uses for cleaning
up the excess job-managers. Like for example is there a maximum rate it will clean up
new jobs? How long after a job is submitted does it take the grid-monitor to kill off
that jobs job-manager? Is the ability of a single grid-monitor to kill off
job-managers hampered by a lot of jobs running under one user? That is if each user
has one grid monitor would 6 users, and therefore 6 grid monitors fair better in
terms of cleaning things up than say a single users grid monitor that has to prune
600 jobs?

Also what are the situations that the grid-monitor should be best at and what would
you expect it to be worst at? For example if I submit 100 jobs at once does the
grid-monitor deal with that better than 100 jobs over 100 seconds?

I can delve into the code but I figured I would ask. &#58;)

Terrence</pre></div><legend>Similar Recent Tickets <small>modified within the last 30 days</small></legend><div id="similar_tickets"><p class="muted">No similar tickets found.</p></div>
</div>
<script type="text/javascript">
function reset_anchor() {
    $("#updates .selected").removeClass("selected");
    var urls = document.location.toString().split('#'); 
    var anchor = urls[1];
    if(anchor) {
        $("a[name='"+anchor+"']").parents(".update_description").addClass("selected");
    }
}
function submitspam(ticket_id) {
    myret = confirm("Would you like to close this ticket as a security ticket, and submit the ticket content to akismet?");
    if(myret == true) {
        $.ajax("viewer/processspam?id="+ticket_id).done(function() {
            window.location.reload();
        });
    }
}

$(function() {
    reset_anchor();
    var ADDITIONAL_COOKIE_NAME = 'gocticket';
    var options = { path: '/', expires: 365};

    if(window.opener && window.opener.name == "gocticket_list") {
        v = $.cookie("closewindow");
        if(!v) {
            $("#closewindow").attr("checked", "checked"); //on by default
        } else {
            if(v == "checked") {
                $("#closewindow").attr("checked", "checked");
            }
        }
        $("#closewindow").click(function() {
            $.cookie("closewindow", $(this).attr('checked'), options);
        });
    } else {
        $("#closewindow_area").hide();
    }
    function updateTimeago() {
        $("time").timeago();
        setTimeout(updateTimeago, 30*1000);
    }
    updateTimeago();
    $(".description").focus(expand_description);
});
</script>
<hr/>
<footer>
<p>GOC Ticket Version 2.2 | <a href="https://ticket.opensciencegrid.org/goc/submit?app_issue_check=on&amp;app_issue_type=goc&amp;app_goc_url=https%3A%2F%2Fticket.opensciencegrid.org%3A443%2F2031">Report Bugs</a>
 | <a href="https://github.com/opensciencegrid/operations/blob/master/docs/privacy.md">Privacy Policy</a>
</p>

<p> <img align="top" src="images/tag_orange.png"/> Copyright 2018 The Trustees of Indiana University - Developed for Open Science Grid</p>
</footer>


</div><!--container-fluid-->
<script>
var chat = io.connect('https://ticket1.grid.iu.edu:8443');
chat.on('connect', function() {
    chat.emit('authenticate', {nodekey:'', ticketid: 2031});
});
chat.on('peers', function(peers) {
    $("#peers").html("");
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('peer_disconnect', function(pid) {
    $("#peer_"+pid).hide("slow");
});
chat.on('peer_connected', function(peers) {
    //expect only 1 peer connecting, but..
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('submit', function() {
    if(confirm("This ticket was updated. Do you want to refresh?")) {
        history.go(0);
    }
});

function addPeer(pid, peer) {
    var ipinfo = "";
    if(peer.ip != undefined) {
        ipinfo = "<span class=\"ip\">"+peer.ip+"</span>";
    }
    if(chat.io.engine.id == pid) {
        //don't display myself
        return;
    }
    var html = "<li class=\"new\" id=\"peer_"+pid+"\" class=\"peer\">"+peer.name+ipinfo+"</li>";
    $("#peers").prepend(html);
    $("#peers .new").animate({bottom: 0}, 1000, function() {$(this).removeClass("new")});
}

$(function() {
    $("#ticket_form").submit(function() {
        chat.emit('submit');
        return true;
    });
});
</script>
<script>
//used by searchbox
function parseValue(value) {
    var obj = new Object();
    var tokens = value.split("\t");
    obj.str = tokens[0];
    obj.count = tokens[1];
    return obj;
}

$(function() {
    //bootstrap-2.0.4 stuff
    $(".alert-message").alert();
    $(".dropdown-toggle").dropdown();
    $("span[rel='tooltip']").tooltip();
    $("a[rel=popover]").popover();

    //activate menu that user is currently on
    $("#menu_navigator").addClass("active"); 
    $("#submenu_").addClass("active"); 

    //translate zend validation error message to bootstrap
    $(".errors").addClass("alert").addClass("alert-error");

    //enable autocomplete for search box
    $("#search").autocomplete({
        source: function( request, response ) {
            $.ajax({
                url: "search/autocomplete",
                dataType: "text",
                data: {
                    //featureClass: "P",
                    //style: "full",
                    //maxRows: 12,
                    //name_startsWith: request.term
                    q: request.term
                },
                success: function( data ) {
                    response( $.map( data.split("\n"), function( item ) {
                        if(item == "") return null;
                        return {
                            value: item
                        }
                    }));
                }
            });
        },
        select: function(event, ui) {
            document.location = "search?q="+ui.item.value;
        }
    });
    
});
</script>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-69012-13");
pageTracker._trackPageview();
} catch(err) {}
</script>

</body>
