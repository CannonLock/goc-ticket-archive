<!DOCTYPE html>
<html lang="en">
  <head>
  <base href="">
    <title>[4227] dCache srm.batch ignoring the gplazma parameters</title>    <meta charset="utf-8" />
    <meta name="verify-v1" content="na5IcAJsZVOfEkboRxuIiZ1zpZgnZiWra+nKcS7nA/o=" />
    <meta name="google-site-verification" content="DLrk3ft4s8b-S2TloLCL2LD_t6wcTjgSluf5pmiu2kA" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />

    <style type="text/css">
      body {
        padding-top: 50px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
     #search {
            width: 300px;
     }

    </style>

<script src="https://code.jquery.com/jquery-3.0.0.js"></script>
<script src="https://code.jquery.com/jquery-migrate-3.0.1.js"></script>

   <link href="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet"/>
    <script src="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/js/bootstrap.min.js"></script>

    <link href="https://netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"/>
    <link href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/themes/smoothness/jquery-ui.min.css" rel="stylesheet"/>
 <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>


    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/js/select2.min.js"></script>

    <link href="css/ticket.css" rel="stylesheet" />
    <script src="lib/jquery.cookie.js"></script>

    <link href="images/tag_orange.png" rel="icon" type="image/png"/>
  </head>

  <body>
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>

            <a class="brand" style="padding: 6px 0px 0px 6px;" href="http://opensciencegrid.org"><img src="images/osglogo.40x30.png"/></a>
            <ul class="nav">
                <li class="dropdown"><a href="https://ticket.opensciencegrid.org/#" class="dropdown-toggle" data-toggle="dropdown">GOC Ticket <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    <li><a href="https://my.opensciencegrid.org">MyOSG</a></li>
                    <li><a href="https://oim.opensciencegrid.org">OIM</a></li>
                    <li class="active"><a href="https://ticket.opensciencegrid.org/index">Ticket</a></li>
	<li class="divider"></li>
	<li><a href="http://repo.grid.iu.edu">Repo</a></li>
	<li class="divider"></li>
	<li><a href="http://blogs.grid.iu.edu">Blog</a></li>
                    <li><a href="http://display.grid.iu.edu">Display</a></li>
                    <li><a href="http://osggoc.blogspot.com/">News</a></li>
                    </ul>
                </li>
            </ul>
            <ul class="nav pull-right">
                <li><a href="https://ticket.opensciencegrid.org/sso/">Login</a></li>            </ul>

            <div class="nav-collapse">
                <ul class="nav">
			 <li id="menu_submit"><a href="https://ticket.opensciencegrid.org/submit">Submit</a></li><li id="menu_view" class="dropdown"><a href="https://ticket.opensciencegrid.org/\#" class="dropdown-toggle" data-toggle="dropdown">View <b class="caret"></b></a><ul class="dropdown-menu"><li id="submenu_listopen"><a href="https://ticket.opensciencegrid.org/list/open">Open Tickets</a></li><li id="submenu_listrecentclose"><a href="https://ticket.opensciencegrid.org/list/recentclose">Recently Closed Tickets</a></li><li class="divider"></li><li id="submenu_alltickets"><a href="https://ticket.opensciencegrid.org/search?q=&amp;sort=id">All Tickets</a></li></ul></li>                </ul>

                <form class="navbar-search pull-right" action="https://ticket.opensciencegrid.org/viewer">
                    <input id="search" type="text" name="id" class="search-query span2" placeholder="Search Ticket" value=""/>
                </form>
            </div>
        </div>
      </div>
    </div>

<script type='text/javascript' src='lib/jquery.timeago.js'></script>
<script type='text/javascript' src='lib/byte2size.js'></script>
<style>
#updates .toolbar {
position: relative;
margin-top: 0px;
top: -10px;
font-weight: normal;
}
#updates a.anchor {
position: relative;
top: -50px;
}
#updates .selected pre {
animation:selected 2s;
animation-iteration-count: 2;
animation-direction: alternate;
-webkit-animation:selected 2s; 
-webkit-animation-iteration-count: 2;
-webkit-animation-direction: alternate;
box-shadow: inset 1px 1px 20px #9ad;
border: 1px solid #9ab;
margin: 5px 0px;
padding-left: 10px;
}
@keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ab;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
@-webkit-keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ad;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
#updates pre {
background-color: inherit;
line-height: 15px;
padding: 5px;
}
#updates .header {
color: #999;
}
#updates .update_history pre {
background-color: #eee;
color: #666;
font-size: 85%;
}
#updates .clickable {
cursor: pointer;
}
#updates .clickable:hover {
color: #D98719;
}
#updates .meta_information pre {
background-color: #fed;
}
#similar_tickets {
max-height: 300px;
overflow-y: auto;
pointer-events: none;
padding: 5px;
background-color: #f4f4f4;
}
.btn-toolbar {
margin-bottom: 0;
height: 30px;
}
#peers {
position: fixed;
bottom: 0px;
right: 0px;
z-index: 100;
list-style: none;
padding: 5px 0px 0px 5px;
margin: 0px;
background-color: white;
box-shadow: 0px 0px 10px white;
}
#peers li {
background-color: #ccc;
color: #000;
display: inline-block;
padding: 5px 10px;
margin-right: 5px;
position: relative;
}
/*
#peers li:hover {
background-color: #999;
cursor: pointer;
}
*/
#peers span.ip {
padding-left: 5px;
color: #666;
}
#peers .new {
bottom: -30px;
}
/*
#peers .me {
background-color: red;
}
*/
</style>

<div class="container-fluid">
<ul id="peers"></ul>
<div class="alert alert-danger"><a class="close" href="https://ticket.opensciencegrid.org/#" data-dismiss="alert">&times;</a>By the end of May 2018, the ticketing system at https://ticket.opensciencegrid.org will be retired and support will be provided at https://support.opensciencegrid.org. Throughout this transition the support email (help@opensciencegrid.org) will be available as a point of contact.<br><br>                                                   
                                                                                                                                                                                   
Please see the service migration page for details: https://opensciencegrid.github.io/technology/policy/service-migrations-spring-2018/#ticket</div><div id="presence" class="pull-right"></div><div class="ticketgui"><script type="text/javascript" src="lib/checktab.js"></script>

<script>
var expanded = false;
function expand_description() {
    var desc = $(".description");
    if(!expanded) {
        expanded = true;
        //expand to minheight
        var min = 250;
        if(desc.height() < min) {
            desc.animate({height: min}, 200);
        }
    }
}

$(document).ready(function() {
    $("input[name='nad']").datepicker({
        dateFormat: 'yy-mm-dd'
    });
});

</script>



<style>
.form-horizontal .control-label {
padding-top: inherit;
font-size:90%;
color:#666;
}
label {
margin-bottom: 0px;
}
.controls {
line-height: 18px;
}
</style>
<form class="form-horizontal" action="https://ticket.opensciencegrid.org/viewer/updatebasic?id=4227" method="post">
<div class="page-header">
    <h3><span class="muted">4227</span> / dCache srm.batch ignoring the gplazma parameters</h3>
</div>

<div class="row-fluid">
<div class="span5">
    <legend>Contact</legend>
    <div class="control-group">
        <label class="control-label">Full Name</label>
        <div class="controls">Neha Sharma</div>
    </div>
    <div class="control-group">
        <label class="control-label">Email</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">Phone</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">CC</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>

    <legend>Details</legend>
    
    <div class="control-group">
        <label class="control-label">Ticket Type</label>
        <div class="controls">Problem/Request</div>
    </div>
    <div class="control-group">
        <label class="control-label">Priority</label>
        <div class="controls">Normal</div>
    </div>
    <div class="control-group">
        <label class="control-label">Status</label>
        <div class="controls">
Closed</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action</label>
        <div class="controls">Still no response from user</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action Deadline</label>
        <div class="controls flag_red">2008-01-30</div>
    </div>

</div><!--span-->
<div class="span7">
    <legend>Assignees</legend>
    <div class="assignee" style="width: 60%">Rob Quick <span class="muted"> / OSG GOC Management</span></div><div class="assignee" style="width: 60%">Neha Sharma <span class="muted"> / OSG Storage Team</span></div>    <br>

    <legend>Assignees</legend>
    TODO
    <br>

    <style>
legend.noborder {
border-bottom: none;
}
</style>

<div id="attachment-list"/>
<script>
$(function () {
    var first = true;
    $.getJSON("attachment/list/4227", function (files) {
        //console.dir(files);
        var html = "<table class=\"table table-condensed\">";
        $(files).each(function() {
            if(first) {
                first = false;
                html += "<legend class=\"noborder\">Attachmenets</legend>";
            }
            html += "<tr class=\"attachment\">";
            html += "<td><img src=\""+this.thumbnail_url+"\"/></td>";
            html += "<td><a href=\""+this.url+"\" target=\"_blank\">"+this.name+"</a></td>";
            html += "<td>"+bytesToSize(this.size, 1)+"</td>";
            html += "</tr>";
        });
        html += "</table>";
        $("#attachment-list").html(html);
    });
});

function download(url) {
    window.open(url, "_blank");
}
</script>


</div><!--span-->
</div><!--row-fluid-->


</form>

</div>
<div id="updates" style="clear: both;">
    <legend>Past Updates
    <div class="btn-toolbar pull-right toolbar">
    </div><!--btn-toolbar-->
    </legend>

    <div class='update_description'><i onclick="document.location='4227#1201125726'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2008-01-23T22:02:06+00:00">Jan 23, 2008 10:02 PM UTC</time> by <b>Neha Sharma</b><a class="anchor" name="1201125726">&nbsp;</a></div><pre>I have tested this, and it does not occur in dCache 1.8. You can close this ticket.

Ted</pre></div><div class='update_description'><i onclick="document.location='4227#1201110635'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2008-01-23T17:50:35+00:00">Jan 23, 2008 05:50 PM UTC</time> by <b>Neha Sharma</b><a class="anchor" name="1201110635">&nbsp;</a></div><pre>No update from user. I sent a reminder email

-Neha</pre></div><div class='update_description'><i onclick="document.location='4227#1200499059'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2008-01-16T15:57:39+00:00">Jan 16, 2008 03:57 PM UTC</time> by <b>Neha Sharma</b><a class="anchor" name="1200499059">&nbsp;</a></div><pre>No update from user. I sent a reminder email

-Neha</pre></div><div class='update_description'><i onclick="document.location='4227#1198863397'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2007-12-28T17:36:37+00:00">Dec 28, 2007 05:36 PM UTC</time> by <b>Neha Sharma</b><a class="anchor" name="1198863397">&nbsp;</a></div><pre>Not heard any update from user</pre></div><div class='update_description'><i onclick="document.location='4227#1198091846'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2007-12-19T19:17:26+00:00">Dec 19, 2007 07:17 PM UTC</time> by <b>Neha Sharma</b><a class="anchor" name="1198091846">&nbsp;</a></div><pre>No update on this from user.</pre></div><div class='update_description'><i onclick="document.location='4227#1196874586'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2007-12-05T17:09:46+00:00">Dec 5, 2007 05:09 PM UTC</time> by <b>Neha Sharma</b><a class="anchor" name="1196874586">&nbsp;</a></div><pre>Not heard any update from user.</pre></div><div class='update_description'><i onclick="document.location='4227#1196414698'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2007-11-30T09:24:58+00:00">Nov 30, 2007 09:24 AM UTC</time> by <b>Rob Quick</b><a class="anchor" name="1196414698">&nbsp;</a></div><pre>This seems to be non-urgent. I will follow up when I return from vacation.</pre></div><div class='update_description'><i onclick="document.location='4227#1196178188'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2007-11-27T15:43:08+00:00">Nov 27, 2007 03:43 PM UTC</time> by <b>Neha Sharma</b><a class="anchor" name="1196178188">&nbsp;</a></div><pre>Hi Rob

I contacted Ted yesterday about this ticket as he is supposed to
reproduce the problem. There is no update from him so far on this.

-Neha
On Nov 27, 2007, at 4&#58;20 AM, Open Science Grid FootPrints wrote&#58;

<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='4227#1196178138'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2007-11-27T15:42:18+00:00">Nov 27, 2007 03:42 PM UTC</time> by <b>Neha Sharma</b><a class="anchor" name="1196178138">&nbsp;</a></div><pre>Contacted Ted for any update on whether he was able to reproduce the problem or not</pre></div><div class='update_description'><i onclick="document.location='4227#1196158815'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2007-11-27T10:20:15+00:00">Nov 27, 2007 10:20 AM UTC</time> by <b>Rob Quick</b><a class="anchor" name="1196158815">&nbsp;</a></div><pre>Neha is there any movement on this issue? Can I close the ticket?

Thanks,
Rob</pre></div><div class='update_description'><i onclick="document.location='4227#1193075541'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2007-10-22T17:52:21+00:00">Oct 22, 2007 05:52 PM UTC</time> by <b>Thomas Wang</b><a class="anchor" name="1193075541">&nbsp;</a></div><pre>this ticket was reopened by neha, but the GOC assignee was removed..
as discussed on the Ops call.  a GOC team members should be assigned to every ticket so that the ticket will not
become stale or forgotten.

reassigning Ops Workgroup (original person that was RR&#39;d to the ticket)
--tom</pre></div><div class='update_description'><i onclick="document.location='4227#1192724648'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2007-10-18T16:24:08+00:00">Oct 18, 2007 04:24 PM UTC</time> by <b>Neha Sharma</b><a class="anchor" name="1192724648">&nbsp;</a></div><pre>Ted noticed another parameter in srm.batch being ignored. Timur and Dmitry have been
informed.</pre></div><div class='update_description'><i onclick="document.location='4227#1192633507'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2007-10-17T15:05:07+00:00">Oct 17, 2007 03:05 PM UTC</time> by <b>Neha Sharma</b><a class="anchor" name="1192633507">&nbsp;</a></div><pre>A ticket has been created with DESY dCache support (#2124)</pre></div><div class='update_description'><i onclick="document.location='4227#1192633274'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2007-10-17T15:01:14+00:00">Oct 17, 2007 03:01 PM UTC</time> by <b>Neha Sharma</b><a class="anchor" name="1192633274">&nbsp;</a></div><pre>Instead of using

set context -c useGPlazmaAuthorizationModule    false
set context -c useGPlazmaAuthorizationCell      true

in srm.batch, go further down in the file to where these variables are used, and put
in the literal &#34;true&#34; and &#34;false&#34; values. I remember having to do that on my test
setup at one time.

It will be necessary to restart srm. You should see lines in the srm log about
sending and receiving messages to/from the gPlazma cell. In the gPlazma log, you will
only see messages for denied or failed authorizations unless you increase the log
level. You can change &#34;set printout&#34; from 2 to 3 in gPlazma&#39;s batch file and restart
the cell, or you can ssh into the cell and run &#34;set LogLevel info&#34;, in which case you
don&#39;t have to restart the gPlazma cell.

The ID 95738097 may have been a typo in the email - it only has 8 digits
instead of the usual 9 or 10. In any case, if gPlazma is printing the
authRequestID&#39;s you should see them in the srm or gridftpdoor logs as well.

Ted

Marcel Schroers via RT wrote&#58;
&#60;URL&#58; <a href='http&#58;//www.dcache.org/rt/Ticket/Display.html?id=2124' target='_blank' rel='nofollow'>http&#58;//www.dcache.org/rt/Ticket/Display.html?id=2124</a> &#62;

Hi Ted,

First thanks for your reply.

ok, I finally found the gPlazma logs on our dgrid-store1
machine (which is the admin node, our &#34;entry-point&#34; for
the GRID is a physically different machine named &#34;grid-se&#34;).

Unfortunatly I can&#39;t find the authRequestID 95738097 in the
logs neither on dgrid-store1 nor on grid-se.
<div id='show_1635649120' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_1635649120'>There are many other ID&#39;s in the log (as example I paste
some here)&#58;
---
10/10 10&#58;23&#58;51,074 GPLAZMALiteVORoleAuthzPlugin&#58; authRequestID
321008222 as&#58; *
10/10 10&#58;23&#58;51 Cell(gPlazma@gPlazma-dgrid-store1Domain) &#58;
authRequestID 321008222 AuthorizationService - Exception&#58; diskCa
cheV111.services.authorization.AuthorizationServiceException&#58;
Permission Denied.
10/10 10&#58;23&#58;51,479 GPLAZMALiteVORoleAuthzPlugin&#58; authRequestID
1209542317 Cannot determine Username from Subject DN + Grid
Vo Role
10/10 10&#58;23&#58;51,479 GPLAZMALiteVORoleAuthzPlugin&#58; authRequestID
1209542317 as&#58; *
10/10 10&#58;23&#58;51 Cell(gPlazma@gPlazma-dgrid-store1Domain) &#58;
authRequestID 1209542317 AuthorizationService - Exception&#58; diskC
acheV111.services.authorization.AuthorizationServiceException&#58;
Permission Denied.
10/10 10&#58;23&#58;57,753 GPLAZMALiteVORoleAuthzPlugin&#58; authRequestID
223771058 Cannot determine Username from Subject DN + Grid
Vo Role
10/10 10&#58;23&#58;57,753 GPLAZMALiteVORoleAuthzPlugin&#58; authRequestID
223771058 as&#58; *
10/10 10&#58;23&#58;57 Cell(gPlazma@gPlazma-dgrid-store1Domain) &#58;
authRequestID 223771058 AuthorizationService - Exception&#58; diskCa
cheV111.services.authorization.AuthorizationServiceException&#58;
Permission Denied.
10/10 10&#58;23&#58;59,212 GPLAZMALiteVORoleAuthzPlugin&#58; authRequestID
1291835193 Cannot determine Username from Subject DN + Grid
Vo Role
10/10 10&#58;23&#58;59,212 GPLAZMALiteVORoleAuthzPlugin&#58; authRequestID
1291835193 as&#58; *
10/10 10&#58;23&#58;59 Cell(gPlazma@gPlazma-dgrid-store1Domain) &#58;
authRequestID 1291835193 AuthorizationService - Exception&#58; diskC
acheV111.services.authorization.AuthorizationServiceException&#58;
Permission Denied.
---

If I take a authRequestID from the log an grep for it on both machine
nothing is found
(beside the logfile where I found the ID&#58; &#34;gPlazma-dgrid-
store1Domain.log&#34;).

Any suggestions what to do next?

cheers,
marcel

Am 09.10.2007 um 16&#58;48 schrieb Ted Hesselroth via RT&#58;

Could you check the gPlazma log for that transfer to see if it was
handled by the gPlazma cell? Look for the authRequestID 95738097 to
correlate it to what was seen in the srm log. Are srm and gPlazma
running on the same node? If not, can you compare dcache.kpwd between
the two nodes?

I still suspect that the gPlazma cell is not being called, because the
exceptions being thrown are coming from gPlazma modules, such as
GPLAZMALiteVORoleAuthzPlugin. Thus the actual failure could be
occurring
because the authorization files are not fully set up on the srm node.

Ted
</div><script type='text/javascript'>
        $('#show_1635649120').click(function() {
            $('#detail_1635649120').slideDown("normal");
            $('#show_1635649120').hide();
            $('#hide_1635649120').show();
        });
        $('#hide_1635649120').click(function() {
            $('#detail_1635649120').slideUp();
            $('#hide_1635649120').hide();
            $('#show_1635649120').show();
        });
        </script></pre></div>
</div>
<script type="text/javascript">
function reset_anchor() {
    $("#updates .selected").removeClass("selected");
    var urls = document.location.toString().split('#'); 
    var anchor = urls[1];
    if(anchor) {
        $("a[name='"+anchor+"']").parents(".update_description").addClass("selected");
    }
}
function submitspam(ticket_id) {
    myret = confirm("Would you like to close this ticket as a security ticket, and submit the ticket content to akismet?");
    if(myret == true) {
        $.ajax("viewer/processspam?id="+ticket_id).done(function() {
            window.location.reload();
        });
    }
}

$(function() {
    reset_anchor();
    var ADDITIONAL_COOKIE_NAME = 'gocticket';
    var options = { path: '/', expires: 365};

    if(window.opener && window.opener.name == "gocticket_list") {
        v = $.cookie("closewindow");
        if(!v) {
            $("#closewindow").attr("checked", "checked"); //on by default
        } else {
            if(v == "checked") {
                $("#closewindow").attr("checked", "checked");
            }
        }
        $("#closewindow").click(function() {
            $.cookie("closewindow", $(this).attr('checked'), options);
        });
    } else {
        $("#closewindow_area").hide();
    }
    function updateTimeago() {
        $("time").timeago();
        setTimeout(updateTimeago, 30*1000);
    }
    updateTimeago();
    $(".description").focus(expand_description);
});
</script>
<hr/>
<footer>
<p>GOC Ticket Version 2.2 | <a href="https://ticket.opensciencegrid.org/goc/submit?app_issue_check=on&amp;app_issue_type=goc&amp;app_goc_url=https%3A%2F%2Fticket.opensciencegrid.org%3A443%2F4227">Report Bugs</a>
 | <a href="https://github.com/opensciencegrid/operations/blob/master/docs/privacy.md">Privacy Policy</a>
</p>

<p> <img align="top" src="images/tag_orange.png"/> Copyright 2018 The Trustees of Indiana University - Developed for Open Science Grid</p>
</footer>


</div><!--container-fluid-->
<script>
//used by searchbox
function parseValue(value) {
    var obj = new Object();
    var tokens = value.split("\t");
    obj.str = tokens[0];
    obj.count = tokens[1];
    return obj;
}

$(function() {
    //bootstrap-2.0.4 stuff
    $(".alert-message").alert();
    $(".dropdown-toggle").dropdown();
    $("span[rel='tooltip']").tooltip();
    $("a[rel=popover]").popover();

    //activate menu that user is currently on
    $("#menu_navigator").addClass("active"); 
    $("#submenu_").addClass("active"); 

    //translate zend validation error message to bootstrap
    $(".errors").addClass("alert").addClass("alert-error");

    //enable autocomplete for search box
    $("#search").autocomplete({
        source: function( request, response ) {
            $.ajax({
                url: "search/autocomplete",
                dataType: "text",
                data: {
                    //featureClass: "P",
                    //style: "full",
                    //maxRows: 12,
                    //name_startsWith: request.term
                    q: request.term
                },
                success: function( data ) {
                    response( $.map( data.split("\n"), function( item ) {
                        if(item == "") return null;
                        return {
                            value: item
                        }
                    }));
                }
            });
        },
        select: function(event, ui) {
            document.location = "search?q="+ui.item.value;
        }
    });
    
});
</script>


</body>
