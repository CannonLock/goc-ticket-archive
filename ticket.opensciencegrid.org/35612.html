<!DOCTYPE html>
<html lang="en">
  <head>
  <base href="">
    <title>[35612] OSG - Certificate Issue</title>    <meta charset="utf-8" />
    <meta name="verify-v1" content="na5IcAJsZVOfEkboRxuIiZ1zpZgnZiWra+nKcS7nA/o=" />
    <meta name="google-site-verification" content="DLrk3ft4s8b-S2TloLCL2LD_t6wcTjgSluf5pmiu2kA" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />
    <link href="https://ticket.opensciencegrid.org/rss" rel="alternate" type="application/rss+xml" title="GOC Ticket Update feed" />

    <style type="text/css">
      body {
        padding-top: 50px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
     #search {
            width: 300px;
     }

    </style>

<script src="https://code.jquery.com/jquery-3.0.0.js"></script>
<script src="https://code.jquery.com/jquery-migrate-3.0.1.js"></script>

   <link href="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet"/>
    <script src="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/js/bootstrap.min.js"></script>

    <link href="https://netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"/>
    <link href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/themes/smoothness/jquery-ui.min.css" rel="stylesheet"/>
 <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>


    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/js/select2.min.js"></script>

    <link href="css/ticket.css" rel="stylesheet" />
    <script src="lib/jquery.cookie.js"></script>

    <link href="images/tag_orange.png" rel="icon" type="image/png"/>
  </head>

  <body>
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>

            <a class="brand" style="padding: 6px 0px 0px 6px;" href="http://opensciencegrid.org"><img src="images/osglogo.40x30.png"/></a>
            <ul class="nav">
                <li class="dropdown"><a href="https://ticket.opensciencegrid.org/#" class="dropdown-toggle" data-toggle="dropdown">GOC Ticket <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    <li><a href="https://my.opensciencegrid.org">MyOSG</a></li>
                    <li><a href="https://oim.opensciencegrid.org">OIM</a></li>
                    <li class="active"><a href="https://ticket.opensciencegrid.org/index">Ticket</a></li>
	<li class="divider"></li>
	<li><a href="http://repo.grid.iu.edu">Repo</a></li>
	<li class="divider"></li>
	<li><a href="http://blogs.grid.iu.edu">Blog</a></li>
                    <li><a href="http://display.grid.iu.edu">Display</a></li>
                    <li><a href="http://osggoc.blogspot.com/">News</a></li>
                    </ul>
                </li>
            </ul>
            <ul class="nav pull-right">
                <li><a href="https://ticket.opensciencegrid.org/sso/">Login</a></li>            </ul>

            <div class="nav-collapse">
                <ul class="nav">
			 <li id="menu_submit"><a href="https://ticket.opensciencegrid.org/submit">Submit</a></li><li id="menu_view" class="dropdown"><a href="https://ticket.opensciencegrid.org/\#" class="dropdown-toggle" data-toggle="dropdown">View <b class="caret"></b></a><ul class="dropdown-menu"><li id="submenu_listopen"><a href="https://ticket.opensciencegrid.org/list/open">Open Tickets</a></li><li id="submenu_listrecentclose"><a href="https://ticket.opensciencegrid.org/list/recentclose">Recently Closed Tickets</a></li><li class="divider"></li><li id="submenu_alltickets"><a href="https://ticket.opensciencegrid.org/search?q=&amp;sort=id">All Tickets</a></li></ul></li>                </ul>

                <form class="navbar-search pull-right" action="https://ticket.opensciencegrid.org/viewer">
                    <input id="search" type="text" name="id" class="search-query span2" placeholder="Search Ticket" value=""/>
                </form>
            </div>
        </div>
      </div>
    </div>

<script type='text/javascript' src='lib/jquery.timeago.js'></script>
<script type='text/javascript' src='lib/byte2size.js'></script>
<style>
#updates .toolbar {
position: relative;
margin-top: 0px;
top: -10px;
font-weight: normal;
}
#updates a.anchor {
position: relative;
top: -50px;
}
#updates .selected pre {
animation:selected 2s;
animation-iteration-count: 2;
animation-direction: alternate;
-webkit-animation:selected 2s; 
-webkit-animation-iteration-count: 2;
-webkit-animation-direction: alternate;
box-shadow: inset 1px 1px 20px #9ad;
border: 1px solid #9ab;
margin: 5px 0px;
padding-left: 10px;
}
@keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ab;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
@-webkit-keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ad;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
#updates pre {
background-color: inherit;
line-height: 15px;
padding: 5px;
}
#updates .header {
color: #999;
}
#updates .update_history pre {
background-color: #eee;
color: #666;
font-size: 85%;
}
#updates .clickable {
cursor: pointer;
}
#updates .clickable:hover {
color: #D98719;
}
#updates .meta_information pre {
background-color: #fed;
}
#similar_tickets {
max-height: 300px;
overflow-y: auto;
pointer-events: none;
padding: 5px;
background-color: #f4f4f4;
}
.btn-toolbar {
margin-bottom: 0;
height: 30px;
}
#peers {
position: fixed;
bottom: 0px;
right: 0px;
z-index: 100;
list-style: none;
padding: 5px 0px 0px 5px;
margin: 0px;
background-color: white;
box-shadow: 0px 0px 10px white;
}
#peers li {
background-color: #ccc;
color: #000;
display: inline-block;
padding: 5px 10px;
margin-right: 5px;
position: relative;
}
/*
#peers li:hover {
background-color: #999;
cursor: pointer;
}
*/
#peers span.ip {
padding-left: 5px;
color: #666;
}
#peers .new {
bottom: -30px;
}
/*
#peers .me {
background-color: red;
}
*/
</style>

<div class="container-fluid">
<ul id="peers"></ul>
<div class="alert alert-danger"><a class="close" href="https://ticket.opensciencegrid.org/#" data-dismiss="alert">&times;</a>By the end of May 2018, the ticketing system at https://ticket.opensciencegrid.org will be retired and support will be provided at https://support.opensciencegrid.org. Throughout this transition the support email (help@opensciencegrid.org) will be available as a point of contact.<br><br>                                                   
                                                                                                                                                                                   
Please see the service migration page for details: https://opensciencegrid.github.io/technology/policy/service-migrations-spring-2018/#ticket</div><div id="presence" class="pull-right"></div><div class="ticketgui"><script type="text/javascript" src="lib/checktab.js"></script>

<script>
var expanded = false;
function expand_description() {
    var desc = $(".description");
    if(!expanded) {
        expanded = true;
        //expand to minheight
        var min = 250;
        if(desc.height() < min) {
            desc.animate({height: min}, 200);
        }
    }
}

$(document).ready(function() {
    $("input[name='nad']").datepicker({
        dateFormat: 'yy-mm-dd'
    });
});

</script>



<style>
.form-horizontal .control-label {
padding-top: inherit;
font-size:90%;
color:#666;
}
label {
margin-bottom: 0px;
}
.controls {
line-height: 18px;
}
</style>
<form class="form-horizontal" action="https://ticket.opensciencegrid.org/viewer/updatebasic?id=35612" method="post">
<div class="page-header">
    <h3><span class="muted">35612</span> / OSG - Certificate Issue</h3>
</div>

<div class="row-fluid">
<div class="span5">
    <legend>Contact</legend>
    <div class="control-group">
        <label class="control-label">Full Name</label>
        <div class="controls">Horst Severini</div>
    </div>
    <div class="control-group">
        <label class="control-label">Email</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">Phone</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">CC</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>

    <legend>Details</legend>
    <div class="control-group"><label class="control-label">Ticket Links</label><div class="controls"></div></div>
    <div class="control-group">
        <label class="control-label">Ticket Type</label>
        <div class="controls">Problem/Request</div>
    </div>
    <div class="control-group">
        <label class="control-label">Priority</label>
        <div class="controls">Normal</div>
    </div>
    <div class="control-group">
        <label class="control-label">Status</label>
        <div class="controls">
Closed</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action</label>
        <div class="controls">Eng review</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action Deadline</label>
        <div class="controls flag_red">2017-12-27</div>
    </div>

</div><!--span-->
<div class="span7">
    <legend>Assignees</legend>
    <div class="assignee" style="width: 60%">Kyle Gross <span class="muted"> / OSG GOC Support Team</span></div><div class="assignee" style="width: 60%">Sarah Schmiechen <span class="muted"> / OSG GOC Support Team</span></div><div class="assignee" style="width: 60%">Sarah Schmiechen <span class="muted"> / OSG Operations Infrastructure</span></div><div class="assignee" style="width: 60%">Software Support (Triage) <span class="muted"> / OSG Software Team</span></div><div class="assignee" style="width: 60%">Brian Lin <span class="muted"> / OSG Software Team</span></div>    <br>

    <legend>Assignees</legend>
    TODO
    <br>

    <style>
legend.noborder {
border-bottom: none;
}
</style>

<div id="attachment-list"/>
<script>
$(function () {
    var first = true;
    $.getJSON("attachment/list/35612", function (files) {
        //console.dir(files);
        var html = "<table class=\"table table-condensed\">";
        $(files).each(function() {
            if(first) {
                first = false;
                html += "<legend class=\"noborder\">Attachmenets</legend>";
            }
            html += "<tr class=\"attachment\">";
            html += "<td><img src=\""+this.thumbnail_url+"\"/></td>";
            html += "<td><a href=\""+this.url+"\" target=\"_blank\">"+this.name+"</a></td>";
            html += "<td>"+bytesToSize(this.size, 1)+"</td>";
            html += "</tr>";
        });
        html += "</table>";
        $("#attachment-list").html(html);
    });
});

function download(url) {
    window.open(url, "_blank");
}
</script>


</div><!--span-->
</div><!--row-fluid-->


</form>

</div>
<div id="updates" style="clear: both;">
    <legend>Past Updates
    <div class="btn-toolbar pull-right toolbar">
        <div class="btn-group">
                <a class="btn btn-small" href="https://ticket.opensciencegrid.org/35612?sort=up&amp;"><i class="icon-arrow-up"></i> Sort</a>

        
        <a class="btn btn-small" href="https://ticket.opensciencegrid.org/35612?expandall=true&amp;">Expand Descriptions</a>        <a class="btn btn-small" target="_blank" href="mailto:osg@tick.globalnoc.iu.edu?subject=Open%20Science%20Grid%3A%20OSG%20-%20Certificate%20Issue%20ISSUE%3D35612%20PROJ%3D71"><i class="icon-envelope"></i> Update w/Email</a>
        </div>
    </div><!--btn-toolbar-->
    </legend>

    <div class='update_description'><i onclick="document.location='35612#1513958892'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-12-22T16:08:12+00:00">Dec 22, 2017 04:08 PM UTC</time> by <b>Brian Lin</b><a class="anchor" name="1513958892">&nbsp;</a></div><pre>Horst,

I&#39;ll have to double-check this but you should be able to revoke the certificate that gets created when testing the tool and continue to use the one you just got from the web UI. We&#39;ll sort this out after the holidays and deal with it in the JIRA ticket. Closing this ticket, enjoy your holidays!

- Brian</pre></div><div class='update_description'><i onclick="document.location='35612#1513956432'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-12-22T15:27:12+00:00">Dec 22, 2017 03:27 PM UTC</time> by <b>Horst Severini</b><a class="anchor" name="1513956432">&nbsp;</a></div><pre>Hi Brian,

sorry to hear that, hope you&#39;re feeling better!

Sure, we can close this ticket and track the issue in JIRA.
I&#39;d be happy to help test -- but I&#39;d need some guidance as to how
to do that without getting me another user cert that I don&#39;t need
in the process ... &#58;)

Thanks,
happy holidays all,

Horst</pre></div><div class='update_description'><i onclick="document.location='35612#1513955531'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-12-22T15:12:11+00:00">Dec 22, 2017 03:12 PM UTC</time> by <b>Brian Lin</b><a class="anchor" name="1513955531">&nbsp;</a></div><pre>Hi,

I am out of the office until January 3, 2018. For OSG software related matters, you can contact the software team at osg-software@..... If your matter is urgent, please contact goc@.....

Cheers,

Brian</pre></div><div class='update_description'><i onclick="document.location='35612#1513955394'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-12-22T15:09:54+00:00">Dec 22, 2017 03:09 PM UTC</time> by <b>Brian Lin</b><a class="anchor" name="1513955394">&nbsp;</a></div><pre>Ugh, sorry Horst, I had a fix ready for you but I&#39;ve been out sick the past couple of days. I&#39;m glad you were able to renew your cert via the web interface. Do you mind if we close this GOC ticket in favor of the JIRA ticket mentioned below? I&#39;ve gotten to the bottom of all the user-cert-renew bugs and should have a fixed version in the January release.

Thanks,
Brian</pre></div><div class='update_description'><i onclick="document.location='35612#1513792452'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-12-20T17:54:12+00:00">Dec 20, 2017 05:54 PM UTC</time> by <b>Horst Severini</b><a class="anchor" name="1513792452">&nbsp;</a></div><pre>I went ahead and renewed in the web interface.

Cheers,

Horst</pre></div><div class='update_description'><i onclick="document.location='35612#1513774631'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-12-20T12:57:11+00:00">Dec 20, 2017 12:57 PM UTC</time> by <b>Horst Severini</b><a class="anchor" name="1513774631">&nbsp;</a></div><pre>Hi Brian,

any update on this &#39;unknown certificate&#39; issue? If not, then I guess
I&#39;ll renew my user cert through the web interface, being as how
it&#39;ll expire tomorrow. &#58;)

Thanks a lot,

Horst</pre></div><div class='update_description'><i onclick="document.location='35612#1513357874'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-12-15T17:11:14+00:00">Dec 15, 2017 05:11 PM UTC</time> by <b>Horst Severini</b><a class="anchor" name="1513357874">&nbsp;</a></div><pre>Thanks Brian!

I assume the last time I used this was a year ago. ;)

If we can&#39;t get this to work by the 19th or 20th, I guess I&#39;ll have to
fall back to the web interface ... &#58;)

Thanks,

Horst</pre></div><div class='update_description'><i onclick="document.location='35612#1513354528'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-12-15T16:15:28+00:00">Dec 15, 2017 04:15 PM UTC</time> by <b>Brian Lin</b><a class="anchor" name="1513354528">&nbsp;</a></div><pre>Horst,

Just curious, when was the last time you used this successfully?

Thanks,
Brian</pre></div><div class='update_description'><i onclick="document.location='35612#1513354508'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-12-15T16:15:08+00:00">Dec 15, 2017 04:15 PM UTC</time> by <b>Brian Lin</b><a class="anchor" name="1513354508">&nbsp;</a></div><pre>Horst,

I&#39;m seeing the same error on my side and we&#39;re looking into it.

- Brian</pre></div><div class='update_description'><i onclick="document.location='35612#1513348692'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-12-15T14:38:12+00:00">Dec 15, 2017 02:38 PM UTC</time> by <b>Horst Severini</b><a class="anchor" name="1513348692">&nbsp;</a></div><pre>Hi again,

just as an extra test, I tried to do this against the test server, with

osg-user-cert-renew -T -c $HOME/.globus/usercert.pem -k $HOME/.globus/userkey.pem

but I&#39;m getting the same error&#58;

Connecting to server to renew certificate...
================================================================================
The request has failed for the following reason&#58; No such user certificate
request ID or serial IDStatus &#58; FAILED

Any ideas what&#39;s going on there?

Thanks,

Horst

Horst Severini &#60;hs@....&#62; wrote&#58;

<font color='#7F7E6F'>&#62; Hi Brian,</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; hmm, I just tried this with specifying cert and key directly,</font>
<font color='#7F7E6F'>&#62; but now I&#39;m getting a different error&#58;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; ----</font>
<font color='#7F7E6F'>&#62; osg-user-cert-renew -c $HOME/.globus/usercert.pem -k $HOME/.globus/userkey.pem</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; [the options are -c/-k or --cert/--pkey, by the way, not -cert/-key &#58;) ]</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; Using timeout of 5 minutes</font>
<font color='#7F7E6F'>&#62; Please enter the pass phrase for &#39;/home/hs/.globus/userkey.pem&#39;&#58;</font>
<font color='#7F7E6F'>&#62; Enter password to encrypt new PKCS12 file&#58;</font>
<font color='#7F7E6F'>&#62; Verifying - Enter password to encrypt new PKCS12 file&#58;</font>
<div id='show_909171027' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_909171027'><font color='#7F7E6F'>&#62; Connecting to server to renew certificate...</font>
<font color='#7F7E6F'>&#62; ================================================================================</font>
<font color='#7F7E6F'>&#62; The request has failed for the following reason&#58; No such user certificate</font>
<font color='#7F7E6F'>&#62; request ID or serial IDStatus &#58; FAILED</font>
<font color='#7F7E6F'>&#62; ----</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; What does that mean, no such user certificate? I clearly have one,</font>
<font color='#7F7E6F'>&#62; and it&#39;s still valid till the 21st&#58;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; ----</font>
<font color='#7F7E6F'>&#62; [hs@osgitb1 osg]$ openssl x509 -in ~/.globus/usercert.pem -noout -subject -enddate</font>
<font color='#7F7E6F'>&#62; subject= /DC=org/DC=opensciencegrid/O=Open Science Grid/OU=People/CN=Horst Severini 27</font>
<font color='#7F7E6F'>&#62; notAfter=Dec 21 20&#58;23&#58;43 2017 GMT</font>
<font color='#7F7E6F'>&#62; ----</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; Any ideas how to get around that?</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; Thanks a lot,</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; 	Horst</font>
</div><script type='text/javascript'>
        $('#show_909171027').click(function() {
            $('#detail_909171027').slideDown("normal");
            $('#show_909171027').hide();
            $('#hide_909171027').show();
        });
        $('#hide_909171027').click(function() {
            $('#detail_909171027').slideUp();
            $('#hide_909171027').hide();
            $('#show_909171027').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='35612#1513290191'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-12-14T22:23:11+00:00">Dec 14, 2017 10:23 PM UTC</time> by <b>Horst Severini</b><a class="anchor" name="1513290191">&nbsp;</a></div><pre>Hi Brian,

hmm, I just tried this with specifying cert and key directly,
but now I&#39;m getting a different error&#58;

----
osg-user-cert-renew -c $HOME/.globus/usercert.pem -k $HOME/.globus/userkey.pem

[the options are -c/-k or --cert/--pkey, by the way, not -cert/-key &#58;) ]

Using timeout of 5 minutes
Please enter the pass phrase for &#39;/home/hs/.globus/userkey.pem&#39;&#58;
Enter password to encrypt new PKCS12 file&#58;
Verifying - Enter password to encrypt new PKCS12 file&#58;
Connecting to server to renew certificate...
================================================================================
The request has failed for the following reason&#58; No such user certificate
request ID or serial IDStatus &#58; FAILED
----

What does that mean, no such user certificate? I clearly have one,
and it&#39;s still valid till the 21st&#58;

----
[hs@osgitb1 osg]$ openssl x509 -in ~/.globus/usercert.pem -noout -subject -enddate
subject= /DC=org/DC=opensciencegrid/O=Open Science Grid/OU=People/CN=Horst Severini 27
notAfter=Dec 21 20&#58;23&#58;43 2017 GMT
----

Any ideas how to get around that?

Thanks a lot,

Horst</pre></div><div class='update_description'><i onclick="document.location='35612#1513183812'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-12-13T16:50:12+00:00">Dec 13, 2017 04:50 PM UTC</time> by <b>Brian Lin</b><a class="anchor" name="1513183812">&nbsp;</a></div><pre>Yup, that&#39;s correct

On 12/13/2017 10&#58;38 AM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='35612#1513183092'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-12-13T16:38:12+00:00">Dec 13, 2017 04:38 PM UTC</time> by <b>Horst Severini</b><a class="anchor" name="1513183092">&nbsp;</a></div><pre>Hi Brian,

okay, sure, I an do that. So the -cert and -key are referring to the
full path of the current cert and key -- i.e., $HOME/.globus/user*.pem --
and not the new one (newcert/key), right?

Thanks,

Horst</pre></div><div class='update_description'><i onclick="document.location='35612#1513181832'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-12-13T16:17:12+00:00">Dec 13, 2017 04:17 PM UTC</time> by <b>Brian Lin</b><a class="anchor" name="1513181832">&nbsp;</a></div><pre>Horst,

I don&#39;t think I&#39;ll be able to get it done before your cert expires &#58;(.
Could you work around it in the meantime by explicitly setting -cert and
-key in the call to osg-user-cert-renew?

Thanks,
Brian</pre></div><div class='update_description'><i onclick="document.location='35612#1513180931'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-12-13T16:02:11+00:00">Dec 13, 2017 04:02 PM UTC</time> by <b>Horst Severini</b><a class="anchor" name="1513180931">&nbsp;</a></div><pre>Hi Brian,

right -- I used that env var myself later in my script&#58;

CR=/usr/bin/osg-user-cert-renew
NEWCRED=$HOME/.globus/newcred.p12

$CR

openssl pkcs12 -in $NEWCRED -clcerts -nokeys -out $HOME/.globus/newcert.pem
openssl pkcs12 -in $NEWCRED -nocerts -out $HOME/.globus/newkey.pem

Sorry for the confusion. &#58;)

Let me know when a test version of this fixed code is available in
osg-testing, I&#39;d love to try it for my user cert renewal. ;)

Thanks a lot,

Horst</pre></div><div class='update_description'><i onclick="document.location='35612#1513179672'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-12-13T15:41:12+00:00">Dec 13, 2017 03:41 PM UTC</time> by <b>Brian Lin</b><a class="anchor" name="1513179672">&nbsp;</a></div><pre>Oh one other thing, I don&#39;t recall ever seeing anything about an env var
&#34;NEWCERT&#34; for specifying the user cert output in the PKI tools. You can
change the output dir with --directory, though.

- Brian</pre></div><div class='update_description'><i onclick="document.location='35612#1513171390'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-12-13T13:23:10+00:00">Dec 13, 2017 01:23 PM UTC</time> by <b>Horst Severini</b><a class="anchor" name="1513171390">&nbsp;</a></div><pre>Hi Brian,

I just tested osg-gridadmin-cert-request from osg-testing (osg34.el6)
with an rsv service cert (from the -T testing server), and that worked fine.

I now also understand Steve&#39;s comment about _ vs. - yesterday. &#58;)

Thanks,

Horst</pre></div><div class='update_description'><i onclick="document.location='35612#1513113972'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-12-12T21:26:12+00:00">Dec 12, 2017 09:26 PM UTC</time> by <b>Horst Severini</b><a class="anchor" name="1513113972">&nbsp;</a></div><pre>Hi Brian,

sounds good! I can follow the JIRA ticket, sure. I can wait a little while
before I need to renew my user cert (12/21), so ideally I can do that
then by testing your fix. &#58;)

I&#39;ll see if I can test the service cert fix tomorrow as well.

Thanks a lot,
good night (I&#39;m at CERN),

Horst</pre></div><div class='update_description'><i onclick="document.location='35612#1513112045'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-12-12T20:54:05+00:00">Dec 12, 2017 08:54 PM UTC</time> by <b>Brian Lin</b><a class="anchor" name="1513112045">&nbsp;</a></div><pre>Horst,

I&#39;ve found the user cert renew bug (<a href='https&#58;//jira.opensciencegrid.org/browse/SOFTWARE-3061' target='_blank' rel='nofollow'>https&#58;//jira.opensciencegrid.org/browse/SOFTWARE-3061</a>) and it&#39;s targeted for the January release. In the meantime, you can work around this by specifying the &#39;--cert&#39; and &#39;--key&#39; explicitly. Do you mind following work progress in the JIRA ticket? If not, I&#39;ll close this ticket.

Oh and to answer your question from one of your earlier e-mails&#58; You can use the certs you got from OIM-ITB in production.

- Brian</pre></div><div class='update_description'><i onclick="document.location='35612#1513111631'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-12-12T20:47:11+00:00">Dec 12, 2017 08:47 PM UTC</time> by <b>Horst Severini</b><a class="anchor" name="1513111631">&nbsp;</a></div><pre>Thanks Brian!

If you need additional information, let me know. I can also give you login
access to OUHEP_ITB if you need that to replicate the issue.

Horst</pre></div><div class='update_description'><i onclick="document.location='35612#1513109279'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-12-12T20:07:59+00:00">Dec 12, 2017 08:07 PM UTC</time> by <b>Brian Lin</b><a class="anchor" name="1513109279">&nbsp;</a></div><pre>Horst,

The service certificate issue is fixed in osg-pki-tools-2.1.2-1, which is currently available in osg-testing. I&#39;ll start looking into the osg-user-cert-renew issue.

- Brian</pre></div><div class='update_description'><i onclick="document.location='35612#1513108961'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-12-12T20:02:41+00:00">Dec 12, 2017 08:02 PM UTC</time> by <b>Kyle Gross</b><a class="anchor" name="1513108961">&nbsp;</a></div><pre>I cannot replicate this personally, Horst.

I&#39;ve added the software team for this.

-Kyle</pre></div><div class='update_description'><i onclick="document.location='35612#1513068254'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-12-12T08:44:14+00:00">Dec 12, 2017 08:44 AM UTC</time> by <b>Horst Severini</b><a class="anchor" name="1513068254">&nbsp;</a></div><pre>Hi again,

has anyone had a chance to look at this? I&#39;d like to renew my user cert
some time soon, to have some overlap before the old one expires,
and I&#39;d really like to do this with the osg-pki-tool command line tools,
in order to make sure they are working properly again.

Any ideas what changed in there which could be causing these python
exceptions for both service and user cert renewals?

Thanks,

Horst</pre></div><div class='update_description'><i onclick="document.location='35612#1512773155'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-12-08T22:45:55+00:00">Dec 8, 2017 10:45 PM UTC</time> by <b>Matt Robertson</b><a class="anchor" name="1512773155">&nbsp;</a></div><pre>Subject&#58; Re&#58; problem getting services certificate with latest osg-pki-tool
osg-gridadmin-cert-request
Date&#58; Fri, 8 Dec 2017 16&#58;15&#58;03 -0600
From&#58; Horst Severini &#60;hs@....&#62;
To&#58; OSG- Grid Operations Center &#60;goc@....&#62;
CC&#58; Horst Severini &#60;hs@....&#62;

Hi again,

I just tried to renew my user cert with osg-user-cert-renew, and that doesn&#39;t seem to
be working anymore, either.

I ran these commands&#58;

NEWCRED=$HOME/.globus/newcred.p12
/usr/bin/osg-user-cert-renew

and got the following output&#58;

----
Using timeout of 5 minutes
Please enter the pass phrase for &#39;/home/hs/.globus/userkey.pem&#39;&#58;
Traceback (most recent call last)&#58;
File &#34;/usr/bin/osg-user-cert-renew&#34;, line 310, in &#60;module&#62;
arguments = extract_info(**arguments)
File &#34;/usr/bin/osg-user-cert-renew&#34;, line 297, in extract_info
x509 = M2Crypto.X509.load_cert(arguments[&#39;usercert&#39;])
File &#34;/usr/lib64/python2.6/site-packages/M2Crypto/X509.py&#34;, line 609, in load_cert
bio = BIO.openfile(file)
File &#34;/usr/lib64/python2.6/site-packages/M2Crypto/BIO.py&#34;, line 186, in openfile
return File(open(filename, mode))
TypeError&#58; coercing to Unicode&#58; need string or buffer, NoneType found

Uncaught Exception &#58; Please report the bug to goc@.....
----
<div id='show_56652206' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_56652206'>
I think it would be good if someone opened a ticket on this, since something doesn&#39;t
seem to be working right with osg-pki-tools-2.0.0-1.osg34.el6.

Thanks,
have a good weekend,

Host

On 12/08/2017 02&#58;23 PM, Horst Severini wrote&#58;
<font color='#7F7E6F'>&#62; Hi again,</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; well, I was able to work around this by copying the host cert to</font>
<font color='#7F7E6F'>&#62; httpcert and rsvcert, so I&#39;m able to continue -- but I&#39;d still like to</font>
<font color='#7F7E6F'>&#62; know why this syntax &#39;-H rsv/ouhep0.nhn.ou.edu&#39; doesn&#39;t seem to work</font>
<font color='#7F7E6F'>&#62; anymore.</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; Also, the last few host certs I got myself only generated 2 emails per</font>
<font color='#7F7E6F'>&#62; cert instead of 5, and one of them contains this warning&#58;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; [META Information]</font>
<font color='#7F7E6F'>&#62; Couldn&#39;t add assignee adeximo since it doesn&#39;t exist on FP yet.. (Please</font>
<font color='#7F7E6F'>&#62; sync!)</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; And they&#39;re now coming from osg_dev / ticket-itb rather than the</font>
<font color='#7F7E6F'>&#62; production server. Compare one of yesterday&#39;s tickets and one of today&#39;s&#58;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; <a href='35594.html' target='_blank' rel='nofollow'>https&#58;//ticket.opensciencegrid.org/35594</a></font>
<font color='#7F7E6F'>&#62; <a href='https&#58;//ticket-itb.grid.iu.edu/goc/6675' target='_blank' rel='nofollow'>https&#58;//ticket-itb.grid.iu.edu/goc/6675</a></font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; Oh wait -- I just realized that I accidentally used the -T flag on</font>
<font color='#7F7E6F'>&#62; today&#39;s requests, since I played around with those yesterday. Sorry!</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; Can I use these test ones in production, or should I re-request them</font>
<font color='#7F7E6F'>&#62; again from the production server?</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; Just as a test, I tried to request an rsv service cert with -T as well,</font>
<font color='#7F7E6F'>&#62; and that failed the same way. Which is probably not too surprising,</font>
<font color='#7F7E6F'>&#62; since it looks like that error comes from the local</font>
<font color='#7F7E6F'>&#62; osg-gridadmin-cert-request python script ...</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; Thanks a lot,</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;      Horst</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; On 12/07/2017 05&#58;27 PM, Horst Severini wrote&#58;</font>
<font color='#7F7E6F'>&#62;&#62; Hi all,</font>
<font color='#7F7E6F'>&#62;&#62;</font>
<font color='#7F7E6F'>&#62;&#62; I just tried to renew some host and service certificates for OU, and</font>
<font color='#7F7E6F'>&#62;&#62; I&#39;m having problems with the service certificates, so I was wondering</font>
<font color='#7F7E6F'>&#62;&#62; if something changed in the accepted syntax with</font>
<font color='#7F7E6F'>&#62;&#62; osg-gridadmin-cert-request lately?</font>
<font color='#7F7E6F'>&#62;&#62;</font>
<font color='#7F7E6F'>&#62;&#62; I&#39;m using osg-pki-tools-2.0.0-1.osg34.el6.noarch on a RedHat 6.9 machine.</font>
<font color='#7F7E6F'>&#62;&#62;</font>
<font color='#7F7E6F'>&#62;&#62; I used to use the following syntax (in my wrapper script</font>
<font color='#7F7E6F'>&#62;&#62; osg-gridadmin-cert-request.sh) for requests&#58;</font>
<font color='#7F7E6F'>&#62;&#62;</font>
<font color='#7F7E6F'>&#62;&#62; osg-gridadmin-cert-request -H ouhep0.nhn.ou.edu</font>
<font color='#7F7E6F'>&#62;&#62; osg-gridadmin-cert-request -H rsv/ouhep0.nhn.ou.edu</font>
<font color='#7F7E6F'>&#62;&#62;</font>
<font color='#7F7E6F'>&#62;&#62; The former still works, but the latter is now returning the following</font>
<font color='#7F7E6F'>&#62;&#62; error&#58;</font>
<font color='#7F7E6F'>&#62;&#62;</font>
<font color='#7F7E6F'>&#62;&#62; ----</font>
<font color='#7F7E6F'>&#62;&#62; [hs@osgitb1 osg]$ ./osg-gridadmin-cert-request.sh rsv/ouhep0.nhn.ou.edu</font>
<font color='#7F7E6F'>&#62;&#62; Using timeout of 5 minutes</font>
<font color='#7F7E6F'>&#62;&#62; Please enter the pass phrase for &#39;/home/hs/.globus/userkey.pem&#39;&#58;</font>
<font color='#7F7E6F'>&#62;&#62; Beginning request process...</font>
<font color='#7F7E6F'>&#62;&#62; Writing key(s) to .</font>
<font color='#7F7E6F'>&#62;&#62; Traceback (most recent call last)&#58;</font>
<font color='#7F7E6F'>&#62;&#62;    File &#34;/usr/bin/osg-gridadmin-cert-request&#34;, line 287, in &#60;module&#62;</font>
<font color='#7F7E6F'>&#62;&#62;      cert.write_pkey()</font>
<font color='#7F7E6F'>&#62;&#62;    File &#34;/usr/lib/python2.6/site-packages/osgpkitools/OSGPKIUtils.py&#34;,</font>
<font color='#7F7E6F'>&#62;&#62; line 412, in write_pkey</font>
<font color='#7F7E6F'>&#62;&#62;      self.keypair.save_key(filename, cipher=None)</font>
<font color='#7F7E6F'>&#62;&#62;    File &#34;/usr/lib64/python2.6/site-packages/M2Crypto/RSA.py&#34;, line</font>
<font color='#7F7E6F'>&#62;&#62; 109, in save_key</font>
<font color='#7F7E6F'>&#62;&#62;      bio = BIO.openfile(file, &#39;wb&#39;)</font>
<font color='#7F7E6F'>&#62;&#62;    File &#34;/usr/lib64/python2.6/site-packages/M2Crypto/BIO.py&#34;, line</font>
<font color='#7F7E6F'>&#62;&#62; 186, in openfile</font>
<font color='#7F7E6F'>&#62;&#62;      return File(open(filename, mode))</font>
<font color='#7F7E6F'>&#62;&#62; IOError&#58; [Errno 2] No such file or directory&#58;</font>
<font color='#7F7E6F'>&#62;&#62; &#39;./rsv/ouhep0.nhn.ou.edu-key.pem&#39;</font>
<font color='#7F7E6F'>&#62;&#62;</font>
<font color='#7F7E6F'>&#62;&#62; Uncaught Exception &#58; Please report the bug to goc@.....</font>
<font color='#7F7E6F'>&#62;&#62; ----</font>
<font color='#7F7E6F'>&#62;&#62;</font>
<font color='#7F7E6F'>&#62;&#62; Is this &#39;-H service/hostname&#39; syntax no longer valid? If so, what</font>
<font color='#7F7E6F'>&#62;&#62; should I be using now? The --help doesn&#39;t specify.</font>
<font color='#7F7E6F'>&#62;&#62;</font>
<font color='#7F7E6F'>&#62;&#62; I think the last time I used this, we were still running osg-3.3. Is</font>
<font color='#7F7E6F'>&#62;&#62; there a difference in osg-3.4?</font>
<font color='#7F7E6F'>&#62;&#62;</font>
<font color='#7F7E6F'>&#62;&#62; Thanks,</font>
<font color='#7F7E6F'>&#62;&#62;</font>
<font color='#7F7E6F'>&#62;&#62;      Horst</font>
<font color='#7F7E6F'>&#62;&#62;</font>
<font color='#7F7E6F'>&#62;</font>
</div><script type='text/javascript'>
        $('#show_56652206').click(function() {
            $('#detail_56652206').slideDown("normal");
            $('#show_56652206').hide();
            $('#hide_56652206').show();
        });
        $('#hide_56652206').click(function() {
            $('#detail_56652206').slideUp();
            $('#hide_56652206').hide();
            $('#show_56652206').show();
        });
        </script></pre></div><legend>Similar Recent Tickets <small>modified within the last 30 days</small></legend><div id="similar_tickets"><p class="muted">No similar tickets found.</p></div>
</div>
<script type="text/javascript">
function reset_anchor() {
    $("#updates .selected").removeClass("selected");
    var urls = document.location.toString().split('#'); 
    var anchor = urls[1];
    if(anchor) {
        $("a[name='"+anchor+"']").parents(".update_description").addClass("selected");
    }
}
function submitspam(ticket_id) {
    myret = confirm("Would you like to close this ticket as a security ticket, and submit the ticket content to akismet?");
    if(myret == true) {
        $.ajax("viewer/processspam?id="+ticket_id).done(function() {
            window.location.reload();
        });
    }
}

$(function() {
    reset_anchor();
    var ADDITIONAL_COOKIE_NAME = 'gocticket';
    var options = { path: '/', expires: 365};

    if(window.opener && window.opener.name == "gocticket_list") {
        v = $.cookie("closewindow");
        if(!v) {
            $("#closewindow").attr("checked", "checked"); //on by default
        } else {
            if(v == "checked") {
                $("#closewindow").attr("checked", "checked");
            }
        }
        $("#closewindow").click(function() {
            $.cookie("closewindow", $(this).attr('checked'), options);
        });
    } else {
        $("#closewindow_area").hide();
    }
    function updateTimeago() {
        $("time").timeago();
        setTimeout(updateTimeago, 30*1000);
    }
    updateTimeago();
    $(".description").focus(expand_description);
});
</script>
<hr/>
<footer>
<p>GOC Ticket Version 2.2 | <a href="https://ticket.opensciencegrid.org/goc/submit?app_issue_check=on&amp;app_issue_type=goc&amp;app_goc_url=https%3A%2F%2Fticket.opensciencegrid.org%3A443%2F35612">Report Bugs</a>
 | <a href="https://github.com/opensciencegrid/operations/blob/master/docs/privacy.md">Privacy Policy</a>
</p>

<p> <img align="top" src="images/tag_orange.png"/> Copyright 2018 The Trustees of Indiana University - Developed for Open Science Grid</p>
</footer>


</div><!--container-fluid-->
<script>
var chat = io.connect('https://ticket1.grid.iu.edu:8443');
chat.on('connect', function() {
    chat.emit('authenticate', {nodekey:'', ticketid: 35612});
});
chat.on('peers', function(peers) {
    $("#peers").html("");
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('peer_disconnect', function(pid) {
    $("#peer_"+pid).hide("slow");
});
chat.on('peer_connected', function(peers) {
    //expect only 1 peer connecting, but..
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('submit', function() {
    if(confirm("This ticket was updated. Do you want to refresh?")) {
        history.go(0);
    }
});

function addPeer(pid, peer) {
    var ipinfo = "";
    if(peer.ip != undefined) {
        ipinfo = "<span class=\"ip\">"+peer.ip+"</span>";
    }
    if(chat.io.engine.id == pid) {
        //don't display myself
        return;
    }
    var html = "<li class=\"new\" id=\"peer_"+pid+"\" class=\"peer\">"+peer.name+ipinfo+"</li>";
    $("#peers").prepend(html);
    $("#peers .new").animate({bottom: 0}, 1000, function() {$(this).removeClass("new")});
}

$(function() {
    $("#ticket_form").submit(function() {
        chat.emit('submit');
        return true;
    });
});
</script>
<script>
//used by searchbox
function parseValue(value) {
    var obj = new Object();
    var tokens = value.split("\t");
    obj.str = tokens[0];
    obj.count = tokens[1];
    return obj;
}

$(function() {
    //bootstrap-2.0.4 stuff
    $(".alert-message").alert();
    $(".dropdown-toggle").dropdown();
    $("span[rel='tooltip']").tooltip();
    $("a[rel=popover]").popover();

    //activate menu that user is currently on
    $("#menu_navigator").addClass("active"); 
    $("#submenu_").addClass("active"); 

    //translate zend validation error message to bootstrap
    $(".errors").addClass("alert").addClass("alert-error");

    //enable autocomplete for search box
    $("#search").autocomplete({
        source: function( request, response ) {
            $.ajax({
                url: "search/autocomplete",
                dataType: "text",
                data: {
                    //featureClass: "P",
                    //style: "full",
                    //maxRows: 12,
                    //name_startsWith: request.term
                    q: request.term
                },
                success: function( data ) {
                    response( $.map( data.split("\n"), function( item ) {
                        if(item == "") return null;
                        return {
                            value: item
                        }
                    }));
                }
            });
        },
        select: function(event, ui) {
            document.location = "search?q="+ui.item.value;
        }
    });
    
});
</script>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-69012-13");
pageTracker._trackPageview();
} catch(err) {}
</script>

</body>
