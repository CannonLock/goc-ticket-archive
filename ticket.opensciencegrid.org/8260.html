<!DOCTYPE html>
<html lang="en">
  <head>
  <base href="">
    <title>[8260] OSG Storage&#58; dCache&#58; Data collected by InfoProvider is not accurate</title>    <meta charset="utf-8" />
    <meta name="verify-v1" content="na5IcAJsZVOfEkboRxuIiZ1zpZgnZiWra+nKcS7nA/o=" />
    <meta name="google-site-verification" content="DLrk3ft4s8b-S2TloLCL2LD_t6wcTjgSluf5pmiu2kA" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />
    <link href="https://ticket.opensciencegrid.org/rss" rel="alternate" type="application/rss+xml" title="GOC Ticket Update feed" />

    <style type="text/css">
      body {
        padding-top: 50px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
     #search {
            width: 300px;
     }

    </style>

<script src="https://code.jquery.com/jquery-3.0.0.js"></script>
<script src="https://code.jquery.com/jquery-migrate-3.0.1.js"></script>

   <link href="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet"/>
    <script src="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/js/bootstrap.min.js"></script>

    <link href="https://netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"/>
    <link href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/themes/smoothness/jquery-ui.min.css" rel="stylesheet"/>
 <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>


    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/js/select2.min.js"></script>

    <link href="css/ticket.css" rel="stylesheet" />
    <script src="lib/jquery.cookie.js"></script>

    <link href="images/tag_orange.png" rel="icon" type="image/png"/>
  </head>

  <body>
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>

            <a class="brand" style="padding: 6px 0px 0px 6px;" href="http://opensciencegrid.org"><img src="images/osglogo.40x30.png"/></a>
            <ul class="nav">
                <li class="dropdown"><a href="https://ticket.opensciencegrid.org/#" class="dropdown-toggle" data-toggle="dropdown">GOC Ticket <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    <li><a href="https://my.opensciencegrid.org">MyOSG</a></li>
                    <li><a href="https://oim.opensciencegrid.org">OIM</a></li>
                    <li class="active"><a href="https://ticket.opensciencegrid.org/index">Ticket</a></li>
	<li class="divider"></li>
	<li><a href="http://repo.grid.iu.edu">Repo</a></li>
	<li class="divider"></li>
	<li><a href="http://blogs.grid.iu.edu">Blog</a></li>
                    <li><a href="http://display.grid.iu.edu">Display</a></li>
                    <li><a href="http://osggoc.blogspot.com/">News</a></li>
                    </ul>
                </li>
            </ul>
            <ul class="nav pull-right">
                <li><a href="https://ticket.opensciencegrid.org/sso/">Login</a></li>            </ul>

            <div class="nav-collapse">
                <ul class="nav">
			 <li id="menu_submit"><a href="https://ticket.opensciencegrid.org/submit">Submit</a></li><li id="menu_view" class="dropdown"><a href="https://ticket.opensciencegrid.org/\#" class="dropdown-toggle" data-toggle="dropdown">View <b class="caret"></b></a><ul class="dropdown-menu"><li id="submenu_listopen"><a href="https://ticket.opensciencegrid.org/list/open">Open Tickets</a></li><li id="submenu_listrecentclose"><a href="https://ticket.opensciencegrid.org/list/recentclose">Recently Closed Tickets</a></li><li class="divider"></li><li id="submenu_alltickets"><a href="https://ticket.opensciencegrid.org/search?q=&amp;sort=id">All Tickets</a></li></ul></li>                </ul>

                <form class="navbar-search pull-right" action="https://ticket.opensciencegrid.org/viewer">
                    <input id="search" type="text" name="id" class="search-query span2" placeholder="Search Ticket" value=""/>
                </form>
            </div>
        </div>
      </div>
    </div>

<script type='text/javascript' src='lib/jquery.timeago.js'></script>
<script type='text/javascript' src='lib/byte2size.js'></script>
<style>
#updates .toolbar {
position: relative;
margin-top: 0px;
top: -10px;
font-weight: normal;
}
#updates a.anchor {
position: relative;
top: -50px;
}
#updates .selected pre {
animation:selected 2s;
animation-iteration-count: 2;
animation-direction: alternate;
-webkit-animation:selected 2s; 
-webkit-animation-iteration-count: 2;
-webkit-animation-direction: alternate;
box-shadow: inset 1px 1px 20px #9ad;
border: 1px solid #9ab;
margin: 5px 0px;
padding-left: 10px;
}
@keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ab;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
@-webkit-keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ad;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
#updates pre {
background-color: inherit;
line-height: 15px;
padding: 5px;
}
#updates .header {
color: #999;
}
#updates .update_history pre {
background-color: #eee;
color: #666;
font-size: 85%;
}
#updates .clickable {
cursor: pointer;
}
#updates .clickable:hover {
color: #D98719;
}
#updates .meta_information pre {
background-color: #fed;
}
#similar_tickets {
max-height: 300px;
overflow-y: auto;
pointer-events: none;
padding: 5px;
background-color: #f4f4f4;
}
.btn-toolbar {
margin-bottom: 0;
height: 30px;
}
#peers {
position: fixed;
bottom: 0px;
right: 0px;
z-index: 100;
list-style: none;
padding: 5px 0px 0px 5px;
margin: 0px;
background-color: white;
box-shadow: 0px 0px 10px white;
}
#peers li {
background-color: #ccc;
color: #000;
display: inline-block;
padding: 5px 10px;
margin-right: 5px;
position: relative;
}
/*
#peers li:hover {
background-color: #999;
cursor: pointer;
}
*/
#peers span.ip {
padding-left: 5px;
color: #666;
}
#peers .new {
bottom: -30px;
}
/*
#peers .me {
background-color: red;
}
*/
</style>

<div class="container-fluid">
<ul id="peers"></ul>
<div class="alert alert-danger"><a class="close" href="https://ticket.opensciencegrid.org/#" data-dismiss="alert">&times;</a>By the end of May 2018, the ticketing system at https://ticket.opensciencegrid.org will be retired and support will be provided at https://support.opensciencegrid.org. Throughout this transition the support email (help@opensciencegrid.org) will be available as a point of contact.<br><br>                                                   
                                                                                                                                                                                   
Please see the service migration page for details: https://opensciencegrid.github.io/technology/policy/service-migrations-spring-2018/#ticket</div><div id="presence" class="pull-right"></div><div class="ticketgui"><script type="text/javascript" src="lib/checktab.js"></script>

<script>
var expanded = false;
function expand_description() {
    var desc = $(".description");
    if(!expanded) {
        expanded = true;
        //expand to minheight
        var min = 250;
        if(desc.height() < min) {
            desc.animate({height: min}, 200);
        }
    }
}

$(document).ready(function() {
    $("input[name='nad']").datepicker({
        dateFormat: 'yy-mm-dd'
    });
});

</script>



<style>
.form-horizontal .control-label {
padding-top: inherit;
font-size:90%;
color:#666;
}
label {
margin-bottom: 0px;
}
.controls {
line-height: 18px;
}
</style>
<form class="form-horizontal" action="https://ticket.opensciencegrid.org/viewer/updatebasic?id=8260" method="post">
<div class="page-header">
    <h3><span class="muted">8260</span> / OSG Storage&#58; dCache&#58; Data collected by InfoProvider is not accurate</h3>
</div>

<div class="row-fluid">
<div class="span5">
    <legend>Contact</legend>
    <div class="control-group">
        <label class="control-label">Full Name</label>
        <div class="controls">tony tiradani</div>
    </div>
    <div class="control-group">
        <label class="control-label">Email</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">Phone</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">CC</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>

    <legend>Details</legend>
    
    <div class="control-group">
        <label class="control-label">Ticket Type</label>
        <div class="controls">Problem/Request</div>
    </div>
    <div class="control-group">
        <label class="control-label">Priority</label>
        <div class="controls">Normal</div>
    </div>
    <div class="control-group">
        <label class="control-label">Status</label>
        <div class="controls">
Closed</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action</label>
        <div class="controls"></div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action Deadline</label>
        <div class="controls flag_red">2010-04-14</div>
    </div>

</div><!--span-->
<div class="span7">
    <legend>Assignees</legend>
    <div class="assignee" style="width: 60%">Neha Sharma <span class="muted"> / OSG Storage Team</span></div>    <br>

    <legend>Assignees</legend>
    TODO
    <br>

    <style>
legend.noborder {
border-bottom: none;
}
</style>

<div id="attachment-list"/>
<script>
$(function () {
    var first = true;
    $.getJSON("attachment/list/8260", function (files) {
        //console.dir(files);
        var html = "<table class=\"table table-condensed\">";
        $(files).each(function() {
            if(first) {
                first = false;
                html += "<legend class=\"noborder\">Attachmenets</legend>";
            }
            html += "<tr class=\"attachment\">";
            html += "<td><img src=\""+this.thumbnail_url+"\"/></td>";
            html += "<td><a href=\""+this.url+"\" target=\"_blank\">"+this.name+"</a></td>";
            html += "<td>"+bytesToSize(this.size, 1)+"</td>";
            html += "</tr>";
        });
        html += "</table>";
        $("#attachment-list").html(html);
    });
});

function download(url) {
    window.open(url, "_blank");
}
</script>


</div><!--span-->
</div><!--row-fluid-->


</form>

</div>
<div id="updates" style="clear: both;">
    <legend>Past Updates
    <div class="btn-toolbar pull-right toolbar">
    </div><!--btn-toolbar-->
    </legend>

    <div class='update_description'><i onclick="document.location='8260#1271884372'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2010-04-21T21:12:52+00:00">Apr 21, 2010 09:12 PM UTC</time> by <b>Neha Sharma</b><a class="anchor" name="1271884372">&nbsp;</a></div><pre>Begin forwarded message&#58;

From&#58; Paul Millar via RT &#60;support@....&#62;
Date&#58; April 15, 2010 8&#58;18&#58;30 AM CDT
To&#58; neha@....
Subject&#58; [www.dcache.org #5559] Possible Bug in new Info Service
Reply-To&#58; support@....

On Wed Apr 14 22&#58;39&#58;44 2010, neha wrote&#58;
From the sanity check&#58;

linkgroup.used = sum(reservation.used)

So the actual used space isn&#39;t reflected here?

&#34;Actual used space&#34; is not a dCache term&#58; can you explain what you mean by this
phrase? Can you also explain why you feel that sum(reservations.used) isn&#39;t the
&#34;actual used space&#34;?

[..] Why does linkgroup.reserved match reservation.free?

[slight correction&#58; linkgroup.reserved is the sum of all reservation.free for
all reservations in this linkgroup.]

This is per-definition&#58; see below for details.

What is supposed to show?

The assertion &#34;linkgroup.used = sum(reservation.used)&#34; is true in theory, but
is maintained in the info service. The space-manager does not provide a metric
linkgroup.used to the info-service; instead, the info provider calculates this
value internally.

This support ticket was created with the title &#34;Possible Bug in new Info
Service&#34;. The above test was to demonstrate that this is false&#58; there may be a
<div id='show_245909551' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_245909551'>problem, but it isn&#39;t with the info service. Rather, the info service was
instrumental in allowing a problem elsewhere to be discovered.

Shouldn&#39;t linkgroup.reserved *be* the sum of the reservations or at least
reservation.total?

No, but you&#39;re close&#58; it&#39;s actually sum(reservation.free), not
sum(reservation.total). Think of it this way&#58;

Each byte accessible via a LinkGroup is in one of three states&#58;
USED, RESERVED and AVAILABLE

So the total capacity of a linkgroup is always&#58;
Total = Size_USED + Size_RESERVED + Size_AVAILABLE

Initially, all the capacity of a link-group is in state AVAILABLE. When a
reservation, of size x, is created then
Size_AVAILABLE decreases by x
Size_RESERVED increases by x

When dCache receives y bytes, as someone is uploading a file into a reservation
within a linkgroup then&#58;
Size_RESERVED decreases by y
Size_USED increases by y

As a short-hand, we define bytes to be in state FREE if they are either
RESERVED or AVAILABLE, so
Size_FREE = Size_RESERVED + Size_AVAILABLE
and
Total = Size_USED + Size_FREE

From the definition of Size_FREE, you see that it will only decrease when bytes
are actually written into dCache, it&#39;s a metric describing storage capacity of
dCache pools in a linkgroup, independent of how storage capacity is divided up
into reservations.

As to why there are these checks for &#34;obvious&#34; numbers; well, of course we can
make assertions that certain numbers have certain well-defined relationships.
The point here is to prove that the actually numbers being reported follow the
rules.

(If you think this is trivial, it isn&#39;t ... and be very glad you don&#39;t know the
work going on in the background to gather this information from a distributed
system and present a self-consistent fashion.)

However, the point is that they are following the rules .. or at least, they
seem to. If they are not then please submit the data demonstrating the
mis-match so we can diagnose the problem and fix it.

linkgroup.total = linkgroup.used + linkgroup.free

Does this mean [...]

No, the above equation is a simple statement from the definitions above&#58; you
cannot deduce anything from it.

Does this mean that linkgroup.total can be greater than the actual
physical space?

The term &#34;actual physical space&#34; isn&#39;t a dCache term so I&#39;m guessing you mean
the total storage capacity of the pools accessible via the linkgroup. If so,
then no, you&#39;re wrong&#58; the linkgroup total should always reflect this total
storage capacity of the pools; however, there may be some latency between
changes to the available pools and space-manager updating the linkgroup.total.

What can happen is a pool is disabled (or crashes, or ...) and is no longer
available for storing data. This reduces the Total size, since pools are no
longer available. Since SpaceManager doesn&#39;t know which files are stored on
disabled/off-line pools, it assumes that all the files are still accessible (so
Size_USED remains the same) and Size_FREE will decrease. Since the reservations
remain unchanged, Size_RESERVED metric doesn&#39;t change and Size_AVAILABLE
decreases. If, with pools being disabled, there is insufficient capacity to
satisfy Size_RESERVED (storage capacity allocated to reservations but not yet
used) then Size_AVAILABLE will become negative. This indicates over-commitment
of reservations within the link-group.

However, the linkgroup&#39;s total size should always reflect the total storage
capacity of all the pools accessible through the linkgroup (modulo some update
latency).

Cheers,

Paul.
</div><script type='text/javascript'>
        $('#show_245909551').click(function() {
            $('#detail_245909551').slideDown("normal");
            $('#show_245909551').hide();
            $('#hide_245909551').show();
        });
        $('#hide_245909551').click(function() {
            $('#detail_245909551').slideUp();
            $('#hide_245909551').hide();
            $('#show_245909551').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='8260#1269637506'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2010-03-26T21:05:06+00:00">Mar 26, 2010 09:05 PM UTC</time> by <b>Neha Sharma</b><a class="anchor" name="1269637506">&nbsp;</a></div><pre>Yes.

I will update this coming wednesday (thats when I usually update all
my tickets)

thanks
-neha
On Mar 26, 2010, at 1&#58;20 PM, Open Science Grid FootPrints wrote&#58;

<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='8260#1269627645'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2010-03-26T18:20:45+00:00">Mar 26, 2010 06:20 PM UTC</time> by <b>Rob Quick</b><a class="anchor" name="1269627645">&nbsp;</a></div><pre>Neha,

Has there been any update to this issue?

Thanks,
Rob</pre></div><div class='update_description'><i onclick="document.location='8260#1268858848'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2010-03-17T20:47:28+00:00">Mar 17, 2010 08:47 PM UTC</time> by <b>Neha Sharma</b><a class="anchor" name="1268858848">&nbsp;</a></div><pre>Info service as running on dCache SE at Purdue
(dcache.rcac.purdue.edu) which is a CMS T2, has following 2 problems -

1) There is no way to tell which links belong to a particular link group
2) The numbers reported are completely inconsistent (one of them is
negative)
Since in this case, there is only one link group and only one link
group, shouldn&#39;t the numbers match?

Relevant XML file
++++++++++++++

&#60;linkgroups&#62;
&#60;linkgroup lgid=&#34;0&#34;&#62;
&#60;metric name=&#34;id&#34; type=&#34;string&#34;&#62;0&#60;/metric&#62;
&#60;access-latency&#62;
&#60;metric name=&#34;onlineAllowed&#34; type=&#34;boolean&#34;&#62;true&#60;/metric&#62;
&#60;metric name=&#34;nearlineAllowed&#34; type=&#34;boolean&#34;&#62;true&#60;/metric&#62;
&#60;/access-latency&#62;
&#60;metric name=&#34;name&#34;
type=&#34;string&#34;&#62;OSG_Opportunistic_Pools-link-group&#60;/metric&#62;
&#60;lastUpdated&#62;
&#60;metric name=&#34;ISO-8601&#34; type=&#34;string&#34;&#62;2010-03-15T18&#58;06Z&#60;/metric&#62;
&#60;metric name=&#34;simple&#34; type=&#34;string&#34;&#62;Mar 15, 14&#58;06&#58;29 EDT&#60;/
metric&#62;
&#60;metric name=&#34;unix&#34; type=&#34;integer&#34;&#62;1268676389&#60;/metric&#62;
&#60;/lastUpdated&#62;
&#60;retention-policy&#62;
&#60;metric name=&#34;custodialAllowed&#34; type=&#34;boolean&#34;&#62;true&#60;/metric&#62;
&#60;metric name=&#34;outputAllowed&#34; type=&#34;boolean&#34;&#62;false&#60;/metric&#62;
&#60;metric name=&#34;replicaAllowed&#34; type=&#34;boolean&#34;&#62;true&#60;/metric&#62;
&#60;/retention-policy&#62;
&#60;space&#62;
&#60;metric name=&#34;total&#34; type=&#34;integer&#34;&#62;4213397725723&#60;/metric&#62;
&#60;metric name=&#34;free&#34; type=&#34;integer&#34;&#62;3563312719567&#60;/metric&#62;
<div id='show_493298368' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_493298368'>&#60;metric name=&#34;available&#34; type=&#34;integer&#34;&#62;4670409304922&#60;/metric&#62;
&#60;metric name=&#34;used&#34; type=&#34;integer&#34;&#62;650085006156&#60;/metric&#62;
&#60;metric name=&#34;reserved&#34; type=&#34;integer&#34;&#62;-1107096585355&#60;/metric&#62;
&#60;/space&#62;
&#60;authorisation&#62;
&#60;authorised name=&#34;*&#58;*&#34;&#62;
&#60;metric name=&#34;FQAN&#34; type=&#34;string&#34;&#62;*&#60;/metric&#62;
&#60;metric name=&#34;role&#34; type=&#34;string&#34;&#62;*&#60;/metric&#62;
&#60;metric name=&#34;group&#34; type=&#34;string&#34;&#62;*&#60;/metric&#62;
&#60;/authorised&#62;
&#60;/authorisation&#62;
&#60;reservations&#62;
&#60;reservationref reservation-id=&#34;10010&#34;/&#62;
&#60;/reservations&#62;
&#60;/linkgroup&#62;
&#60;/linkgroups&#62;

and

&#60;link name=&#34;OSG_Opportunistic_Pools-link&#34;&#62;
&#60;prefs&#62;
&#60;metric name=&#34;cache&#34; type=&#34;integer&#34;&#62;10&#60;/metric&#62;
&#60;metric name=&#34;write&#34; type=&#34;integer&#34;&#62;10&#60;/metric&#62;
&#60;metric name=&#34;read&#34; type=&#34;integer&#34;&#62;10&#60;/metric&#62;
&#60;metric name=&#34;p2p&#34; type=&#34;integer&#34;&#62;-1&#60;/metric&#62;
&#60;/prefs&#62;
&#60;unitgroups&#62;
&#60;unitgroupref name=&#34;world-net&#34;/&#62;
&#60;unitgroupref name=&#34;opportunistic-store&#34;/&#62;
&#60;unitgroupref name=&#34;any-protocol&#34;/&#62;
&#60;/unitgroups&#62;
&#60;space&#62;
&#60;metric name=&#34;total&#34; type=&#34;integer&#34;&#62;5594194903040&#60;/metric&#62;
&#60;metric name=&#34;free&#34; type=&#34;integer&#34;&#62;3123687272605&#60;/metric&#62;
&#60;metric name=&#34;removable&#34; type=&#34;integer&#34;&#62;439625446962&#60;/metric&#62;
&#60;metric name=&#34;precious&#34; type=&#34;integer&#34;&#62;1380389472090&#60;/metric&#62;
&#60;metric name=&#34;used&#34; type=&#34;integer&#34;&#62;2470507630435&#60;/metric&#62;
&#60;/space&#62;
&#60;pools&#62;
&#60;poolref name=&#34;higgs_2&#34;/&#62;
&#60;poolref name=&#34;higgs_1&#34;/&#62;
&#60;/pools&#62;
&#60;metric name=&#34;selection&#34;
type=&#34;string&#34;&#62;OSG_Opportunistic-section&#60;/metric&#62;
&#60;units&#62;
&#60;protocol&#62;
&#60;unitref name=&#34;*/*&#34;/&#62;
&#60;/protocol&#62;
&#60;store&#62;
&#60;unitref name=&#34;opportunistic&#58;opensciencegrid@osm&#34;/&#62;
&#60;/store&#62;
&#60;net&#62;
&#60;unitref name=&#34;0.0.0.0/0.0.0.0&#34;/&#62;
&#60;/net&#62;
&#60;/units&#62;
&#60;poolgroups&#62;
&#60;poolgroupref name=&#34;OSG_Opportunistic_Pools&#34;/&#62;
&#60;/poolgroups&#62;
&#60;/link&#62;

Relevant poolmanager config
+++++++++++++++++++++++
psu create linkGroup OSG_Opportunistic_Pools-link-group
...
psu addto linkGroup OSG_Opportunistic_Pools-link-group
OSG_Opportunistic_Pools-link

Is this a bug in the new info service?
Thanks
-Neha
</div><script type='text/javascript'>
        $('#show_493298368').click(function() {
            $('#detail_493298368').slideDown("normal");
            $('#show_493298368').hide();
            $('#hide_493298368').show();
        });
        $('#hide_493298368').click(function() {
            $('#detail_493298368').slideUp();
            $('#hide_493298368').hide();
            $('#show_493298368').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='8260#1268853507'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2010-03-17T19:18:27+00:00">Mar 17, 2010 07:18 PM UTC</time> by <b>Neha Sharma</b><a class="anchor" name="1268853507">&nbsp;</a></div><pre>Tony

Can you provide me the name of this CMS-T2 and the contact person&#39; s email and also forward me any relevant emails about this problem?
Before creating the ticket with desy, I would first like to confirm that they are not running both services, which would result in double reporting..

Thanks
-Neha

On Mar 17, 2010, at 2&#58;00 PM, Anthony Tiradani wrote&#58;

Hi Neha,

I am a developer of OSG GIP.  The reason for the bug report is that the
XML that is returned from dcache is inconsistent. I am not sure what the
source of the quote you gave me or what GIP it is referring to.  If you
have time later this afternoon, I can show you what I am referring to.
I am tracking down a problem in storage reporting for one of the CMS-T2s.

Thanks,

Anthony Tiradani
tiradani@....
+1 630 840 4479

On 03/17/2010 01&#58;55 PM, Neha Sharma wrote&#58;
Tony

Are you sure you are using the new &#34;info service&#34; and not the old &#34;info
provider&#34;?
following could be happening if you are -

&#34;Sites that were previously using the old (Java-based) info provider
should ensure that they no longer use it.  This is because, if so
configured, GIP will attempt to use information from both the (new)
info-based info provider and the Java-based info provider and merge
<div id='show_2085870616' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_2085870616'>the results.  This will likely lead to a confusing description of
dCache, which may prevent clients from working correctly.&#34;

you can find out if you are using the old one by reading the
documentation in  /opt/d-cache/share/doc/README-GLUE file

let me know
-Neha

On Mar 17, 2010, at 10&#58;47 AM, Anthony Tiradani wrote&#58;

Hi Neha,

I talked to Ted earlier and he told me to email you and ask you to file
a dcache bug ticket for this.  Please let me know if you need more
information.

The setup&#58;

One link (OSG_Opportunistic_Pools-link) has been setup with 2 pools in
it.  One linkgroup (OSG_Opportunistic_Pools-link-group) has been setup
with the OSG_Opportunistic_Pools-link link in it.  There are no other
links in the linkgroup.  There are no other link groups.

There are other links and many other pools.

The problem&#58;

The space numbers reported in the infoProvider xml do not even come
close to matching between the linkgroup and the link.  They are off by
about 32%.  Compounding the problem (at least for debugging) is the fact
that there appears to be no correlation in the xml between linkgroups
and links.  The reserved space number is showing a rather large negative
number as well.  I suspect that there is a bug in the infoprovider.

Example xml&#58;

&#60;linkgroups&#62;
&#60;linkgroup lgid=&#34;0&#34;&#62;
&#60;metric name=&#34;id&#34; type=&#34;string&#34;&#62;0&#60;/metric&#62;
&#60;access-latency&#62;
&#60;metric name=&#34;onlineAllowed&#34; type=&#34;boolean&#34;&#62;true&#60;/metric&#62;
&#60;metric name=&#34;nearlineAllowed&#34; type=&#34;boolean&#34;&#62;true&#60;/metric&#62;
&#60;/access-latency&#62;
&#60;metric name=&#34;name&#34;
type=&#34;string&#34;&#62;OSG_Opportunistic_Pools-link-group&#60;/metric&#62;
&#60;lastUpdated&#62;
&#60;metric name=&#34;ISO-8601&#34; type=&#34;string&#34;&#62;2010-03-15T18&#58;06Z&#60;/metric&#62;
&#60;metric name=&#34;simple&#34; type=&#34;string&#34;&#62;Mar 15, 14&#58;06&#58;29 EDT&#60;/metric&#62;
&#60;metric name=&#34;unix&#34; type=&#34;integer&#34;&#62;1268676389&#60;/metric&#62;
&#60;/lastUpdated&#62;
&#60;retention-policy&#62;
&#60;metric name=&#34;custodialAllowed&#34; type=&#34;boolean&#34;&#62;true&#60;/metric&#62;
&#60;metric name=&#34;outputAllowed&#34; type=&#34;boolean&#34;&#62;false&#60;/metric&#62;
&#60;metric name=&#34;replicaAllowed&#34; type=&#34;boolean&#34;&#62;true&#60;/metric&#62;
&#60;/retention-policy&#62;
&#60;space&#62;
&#60;metric name=&#34;total&#34; type=&#34;integer&#34;&#62;4213397725723&#60;/metric&#62;
&#60;metric name=&#34;free&#34; type=&#34;integer&#34;&#62;3563312719567&#60;/metric&#62;
&#60;metric name=&#34;available&#34; type=&#34;integer&#34;&#62;4670409304922&#60;/metric&#62;
&#60;metric name=&#34;used&#34; type=&#34;integer&#34;&#62;650085006156&#60;/metric&#62;
&#60;metric name=&#34;reserved&#34; type=&#34;integer&#34;&#62;-1107096585355&#60;/metric&#62;
&#60;/space&#62;
&#60;authorisation&#62;
&#60;authorised name=&#34;*&#58;*&#34;&#62;
&#60;metric name=&#34;FQAN&#34; type=&#34;string&#34;&#62;*&#60;/metric&#62;
&#60;metric name=&#34;role&#34; type=&#34;string&#34;&#62;*&#60;/metric&#62;
&#60;metric name=&#34;group&#34; type=&#34;string&#34;&#62;*&#60;/metric&#62;
&#60;/authorised&#62;
&#60;/authorisation&#62;
&#60;reservations&#62;
&#60;reservationref reservation-id=&#34;10010&#34;/&#62;
&#60;/reservations&#62;
&#60;/linkgroup&#62;
&#60;/linkgroups&#62;

and

&#60;link name=&#34;OSG_Opportunistic_Pools-link&#34;&#62;
&#60;prefs&#62;
&#60;metric name=&#34;cache&#34; type=&#34;integer&#34;&#62;10&#60;/metric&#62;
&#60;metric name=&#34;write&#34; type=&#34;integer&#34;&#62;10&#60;/metric&#62;
&#60;metric name=&#34;read&#34; type=&#34;integer&#34;&#62;10&#60;/metric&#62;
&#60;metric name=&#34;p2p&#34; type=&#34;integer&#34;&#62;-1&#60;/metric&#62;
&#60;/prefs&#62;
&#60;unitgroups&#62;
&#60;unitgroupref name=&#34;world-net&#34;/&#62;
&#60;unitgroupref name=&#34;opportunistic-store&#34;/&#62;
&#60;unitgroupref name=&#34;any-protocol&#34;/&#62;
&#60;/unitgroups&#62;
&#60;space&#62;
&#60;metric name=&#34;total&#34; type=&#34;integer&#34;&#62;5594194903040&#60;/metric&#62;
&#60;metric name=&#34;free&#34; type=&#34;integer&#34;&#62;3123687272605&#60;/metric&#62;
&#60;metric name=&#34;removable&#34; type=&#34;integer&#34;&#62;439625446962&#60;/metric&#62;
&#60;metric name=&#34;precious&#34; type=&#34;integer&#34;&#62;1380389472090&#60;/metric&#62;
&#60;metric name=&#34;used&#34; type=&#34;integer&#34;&#62;2470507630435&#60;/metric&#62;
&#60;/space&#62;
&#60;pools&#62;
&#60;poolref name=&#34;higgs_2&#34;/&#62;
&#60;poolref name=&#34;higgs_1&#34;/&#62;
&#60;/pools&#62;
&#60;metric name=&#34;selection&#34;
type=&#34;string&#34;&#62;OSG_Opportunistic-section&#60;/metric&#62;
&#60;units&#62;
&#60;protocol&#62;
&#60;unitref name=&#34;*/*&#34;/&#62;
&#60;/protocol&#62;
&#60;store&#62;
&#60;unitref name=&#34;opportunistic&#58;opensciencegrid@osm&#34;/&#62;
&#60;/store&#62;
&#60;net&#62;
&#60;unitref name=&#34;0.0.0.0/0.0.0.0&#34;/&#62;
&#60;/net&#62;
&#60;/units&#62;
&#60;poolgroups&#62;
&#60;poolgroupref name=&#34;OSG_Opportunistic_Pools&#34;/&#62;
&#60;/poolgroups&#62;
&#60;/link&#62;

Relevant poolmanager config&#58;

psu create linkGroup OSG_Opportunistic_Pools-link-group
...
psu addto linkGroup OSG_Opportunistic_Pools-link-group
OSG_Opportunistic_Pools-link

No other links are added to the linkgroup.

--
Anthony Tiradani
tiradani@....
+1 630 840 4479
</div><script type='text/javascript'>
        $('#show_2085870616').click(function() {
            $('#detail_2085870616').slideDown("normal");
            $('#show_2085870616').hide();
            $('#hide_2085870616').show();
        });
        $('#hide_2085870616').click(function() {
            $('#detail_2085870616').slideUp();
            $('#hide_2085870616').hide();
            $('#show_2085870616').show();
        });
        </script></pre></div>
</div>
<script type="text/javascript">
function reset_anchor() {
    $("#updates .selected").removeClass("selected");
    var urls = document.location.toString().split('#'); 
    var anchor = urls[1];
    if(anchor) {
        $("a[name='"+anchor+"']").parents(".update_description").addClass("selected");
    }
}
function submitspam(ticket_id) {
    myret = confirm("Would you like to close this ticket as a security ticket, and submit the ticket content to akismet?");
    if(myret == true) {
        $.ajax("viewer/processspam?id="+ticket_id).done(function() {
            window.location.reload();
        });
    }
}

$(function() {
    reset_anchor();
    var ADDITIONAL_COOKIE_NAME = 'gocticket';
    var options = { path: '/', expires: 365};

    if(window.opener && window.opener.name == "gocticket_list") {
        v = $.cookie("closewindow");
        if(!v) {
            $("#closewindow").attr("checked", "checked"); //on by default
        } else {
            if(v == "checked") {
                $("#closewindow").attr("checked", "checked");
            }
        }
        $("#closewindow").click(function() {
            $.cookie("closewindow", $(this).attr('checked'), options);
        });
    } else {
        $("#closewindow_area").hide();
    }
    function updateTimeago() {
        $("time").timeago();
        setTimeout(updateTimeago, 30*1000);
    }
    updateTimeago();
    $(".description").focus(expand_description);
});
</script>
<hr/>
<footer>
<p>GOC Ticket Version 2.2 | <a href="https://ticket.opensciencegrid.org/goc/submit?app_issue_check=on&amp;app_issue_type=goc&amp;app_goc_url=https%3A%2F%2Fticket.opensciencegrid.org%3A443%2F8260">Report Bugs</a>
 | <a href="https://github.com/opensciencegrid/operations/blob/master/docs/privacy.md">Privacy Policy</a>
</p>

<p> <img align="top" src="images/tag_orange.png"/> Copyright 2018 The Trustees of Indiana University - Developed for Open Science Grid</p>
</footer>


</div><!--container-fluid-->
<script>
//used by searchbox
function parseValue(value) {
    var obj = new Object();
    var tokens = value.split("\t");
    obj.str = tokens[0];
    obj.count = tokens[1];
    return obj;
}

$(function() {
    //bootstrap-2.0.4 stuff
    $(".alert-message").alert();
    $(".dropdown-toggle").dropdown();
    $("span[rel='tooltip']").tooltip();
    $("a[rel=popover]").popover();

    //activate menu that user is currently on
    $("#menu_navigator").addClass("active"); 
    $("#submenu_").addClass("active"); 

    //translate zend validation error message to bootstrap
    $(".errors").addClass("alert").addClass("alert-error");

    //enable autocomplete for search box
    $("#search").autocomplete({
        source: function( request, response ) {
            $.ajax({
                url: "search/autocomplete",
                dataType: "text",
                data: {
                    //featureClass: "P",
                    //style: "full",
                    //maxRows: 12,
                    //name_startsWith: request.term
                    q: request.term
                },
                success: function( data ) {
                    response( $.map( data.split("\n"), function( item ) {
                        if(item == "") return null;
                        return {
                            value: item
                        }
                    }));
                }
            });
        },
        select: function(event, ui) {
            document.location = "search?q="+ui.item.value;
        }
    });
    
});
</script>


</body>
