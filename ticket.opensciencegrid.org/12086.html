<!DOCTYPE html>
<html lang="en">
  <head>
  <base href="">
    <title>[12086] lots of failing gluex jobs on FNAL_FERMIGRID</title>    <meta charset="utf-8" />
    <meta name="verify-v1" content="na5IcAJsZVOfEkboRxuIiZ1zpZgnZiWra+nKcS7nA/o=" />
    <meta name="google-site-verification" content="DLrk3ft4s8b-S2TloLCL2LD_t6wcTjgSluf5pmiu2kA" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />
    <link href="https://ticket.opensciencegrid.org/rss" rel="alternate" type="application/rss+xml" title="GOC Ticket Update feed" />

    <style type="text/css">
      body {
        padding-top: 50px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
     #search {
            width: 300px;
     }

    </style>

<script src="https://code.jquery.com/jquery-3.0.0.js"></script>
<script src="https://code.jquery.com/jquery-migrate-3.0.1.js"></script>

   <link href="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet"/>
    <script src="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/js/bootstrap.min.js"></script>

    <link href="https://netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"/>
    <link href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/themes/smoothness/jquery-ui.min.css" rel="stylesheet"/>
 <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>


    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/js/select2.min.js"></script>

    <link href="css/ticket.css" rel="stylesheet" />
    <script src="lib/jquery.cookie.js"></script>

    <link href="images/tag_orange.png" rel="icon" type="image/png"/>
  </head>

  <body>
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>

            <a class="brand" style="padding: 6px 0px 0px 6px;" href="http://opensciencegrid.org"><img src="images/osglogo.40x30.png"/></a>
            <ul class="nav">
                <li class="dropdown"><a href="https://ticket.opensciencegrid.org/#" class="dropdown-toggle" data-toggle="dropdown">GOC Ticket <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    <li><a href="https://my.opensciencegrid.org">MyOSG</a></li>
                    <li><a href="https://oim.opensciencegrid.org">OIM</a></li>
                    <li class="active"><a href="https://ticket.opensciencegrid.org/index">Ticket</a></li>
	<li class="divider"></li>
	<li><a href="http://repo.grid.iu.edu">Repo</a></li>
	<li class="divider"></li>
	<li><a href="http://blogs.grid.iu.edu">Blog</a></li>
                    <li><a href="http://display.grid.iu.edu">Display</a></li>
                    <li><a href="http://osggoc.blogspot.com/">News</a></li>
                    </ul>
                </li>
            </ul>
            <ul class="nav pull-right">
                <li><a href="https://ticket.opensciencegrid.org/sso/">Login</a></li>            </ul>

            <div class="nav-collapse">
                <ul class="nav">
			 <li id="menu_submit"><a href="https://ticket.opensciencegrid.org/submit">Submit</a></li><li id="menu_view" class="dropdown"><a href="https://ticket.opensciencegrid.org/\#" class="dropdown-toggle" data-toggle="dropdown">View <b class="caret"></b></a><ul class="dropdown-menu"><li id="submenu_listopen"><a href="https://ticket.opensciencegrid.org/list/open">Open Tickets</a></li><li id="submenu_listrecentclose"><a href="https://ticket.opensciencegrid.org/list/recentclose">Recently Closed Tickets</a></li><li class="divider"></li><li id="submenu_alltickets"><a href="https://ticket.opensciencegrid.org/search?q=&amp;sort=id">All Tickets</a></li></ul></li>                </ul>

                <form class="navbar-search pull-right" action="https://ticket.opensciencegrid.org/viewer">
                    <input id="search" type="text" name="id" class="search-query span2" placeholder="Search Ticket" value=""/>
                </form>
            </div>
        </div>
      </div>
    </div>

<script type='text/javascript' src='lib/jquery.timeago.js'></script>
<script type='text/javascript' src='lib/byte2size.js'></script>
<style>
#updates .toolbar {
position: relative;
margin-top: 0px;
top: -10px;
font-weight: normal;
}
#updates a.anchor {
position: relative;
top: -50px;
}
#updates .selected pre {
animation:selected 2s;
animation-iteration-count: 2;
animation-direction: alternate;
-webkit-animation:selected 2s; 
-webkit-animation-iteration-count: 2;
-webkit-animation-direction: alternate;
box-shadow: inset 1px 1px 20px #9ad;
border: 1px solid #9ab;
margin: 5px 0px;
padding-left: 10px;
}
@keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ab;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
@-webkit-keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ad;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
#updates pre {
background-color: inherit;
line-height: 15px;
padding: 5px;
}
#updates .header {
color: #999;
}
#updates .update_history pre {
background-color: #eee;
color: #666;
font-size: 85%;
}
#updates .clickable {
cursor: pointer;
}
#updates .clickable:hover {
color: #D98719;
}
#updates .meta_information pre {
background-color: #fed;
}
#similar_tickets {
max-height: 300px;
overflow-y: auto;
pointer-events: none;
padding: 5px;
background-color: #f4f4f4;
}
.btn-toolbar {
margin-bottom: 0;
height: 30px;
}
#peers {
position: fixed;
bottom: 0px;
right: 0px;
z-index: 100;
list-style: none;
padding: 5px 0px 0px 5px;
margin: 0px;
background-color: white;
box-shadow: 0px 0px 10px white;
}
#peers li {
background-color: #ccc;
color: #000;
display: inline-block;
padding: 5px 10px;
margin-right: 5px;
position: relative;
}
/*
#peers li:hover {
background-color: #999;
cursor: pointer;
}
*/
#peers span.ip {
padding-left: 5px;
color: #666;
}
#peers .new {
bottom: -30px;
}
/*
#peers .me {
background-color: red;
}
*/
</style>

<div class="container-fluid">
<ul id="peers"></ul>
<div class="alert alert-danger"><a class="close" href="https://ticket.opensciencegrid.org/#" data-dismiss="alert">&times;</a>By the end of May 2018, the ticketing system at https://ticket.opensciencegrid.org will be retired and support will be provided at https://support.opensciencegrid.org. Throughout this transition the support email (help@opensciencegrid.org) will be available as a point of contact.<br><br>                                                   
                                                                                                                                                                                   
Please see the service migration page for details: https://opensciencegrid.github.io/technology/policy/service-migrations-spring-2018/#ticket</div><div id="presence" class="pull-right"></div><div class="ticketgui"><script type="text/javascript" src="lib/checktab.js"></script>

<script>
var expanded = false;
function expand_description() {
    var desc = $(".description");
    if(!expanded) {
        expanded = true;
        //expand to minheight
        var min = 250;
        if(desc.height() < min) {
            desc.animate({height: min}, 200);
        }
    }
}

$(document).ready(function() {
    $("input[name='nad']").datepicker({
        dateFormat: 'yy-mm-dd'
    });
});

</script>



<style>
.form-horizontal .control-label {
padding-top: inherit;
font-size:90%;
color:#666;
}
label {
margin-bottom: 0px;
}
.controls {
line-height: 18px;
}
</style>
<form class="form-horizontal" action="https://ticket.opensciencegrid.org/viewer/updatebasic?id=12086" method="post">
<div class="page-header">
    <h3><span class="muted">12086</span> / lots of failing gluex jobs on FNAL_FERMIGRID</h3>
</div>

<div class="row-fluid">
<div class="span5">
    <legend>Contact</legend>
    <div class="control-group">
        <label class="control-label">Full Name</label>
        <div class="controls">Steve Timm</div>
    </div>
    <div class="control-group">
        <label class="control-label">Email</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">Phone</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">CC</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>

    <legend>Details</legend>
    <div class="control-group"><label class="control-label">Associated VO</label><div class="controls">Gluex</div></div><div class="control-group"><label class="control-label">Submitted Via</label><div class="controls">GOC Ticket/submit</div></div><div class="control-group"><label class="control-label">Submitter</label><div class="controls">Steve Timm</div></div><div class="control-group"><label class="control-label">Support Center</label><div class="controls">GLUEX</div></div>
    <div class="control-group">
        <label class="control-label">Ticket Type</label>
        <div class="controls">Problem/Request</div>
    </div>
    <div class="control-group">
        <label class="control-label">Priority</label>
        <div class="controls">Normal</div>
    </div>
    <div class="control-group">
        <label class="control-label">Status</label>
        <div class="controls">
Closed</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action</label>
        <div class="controls">ping/check on this</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action Deadline</label>
        <div class="controls flag_red">2012-06-14</div>
    </div>

</div><!--span-->
<div class="span7">
    <legend>Assignees</legend>
    <div class="assignee" style="width: 60%">GLUEX <span class="muted"> / OSG Support Centers</span></div>    <br>

    <legend>Assignees</legend>
    TODO
    <br>

    <style>
legend.noborder {
border-bottom: none;
}
</style>

<div id="attachment-list"/>
<script>
$(function () {
    var first = true;
    $.getJSON("attachment/list/12086", function (files) {
        //console.dir(files);
        var html = "<table class=\"table table-condensed\">";
        $(files).each(function() {
            if(first) {
                first = false;
                html += "<legend class=\"noborder\">Attachmenets</legend>";
            }
            html += "<tr class=\"attachment\">";
            html += "<td><img src=\""+this.thumbnail_url+"\"/></td>";
            html += "<td><a href=\""+this.url+"\" target=\"_blank\">"+this.name+"</a></td>";
            html += "<td>"+bytesToSize(this.size, 1)+"</td>";
            html += "</tr>";
        });
        html += "</table>";
        $("#attachment-list").html(html);
    });
});

function download(url) {
    window.open(url, "_blank");
}
</script>


</div><!--span-->
</div><!--row-fluid-->


</form>

</div>
<div id="updates" style="clear: both;">
    <legend>Past Updates
    <div class="btn-toolbar pull-right toolbar">
        <div class="btn-group">
                <a class="btn btn-small" href="https://ticket.opensciencegrid.org/12086?sort=up&amp;"><i class="icon-arrow-up"></i> Sort</a>

        
        <a class="btn btn-small" href="https://ticket.opensciencegrid.org/12086?expandall=true&amp;">Expand Descriptions</a>        <a class="btn btn-small" target="_blank" href="mailto:osg@tick.globalnoc.iu.edu?subject=Open%20Science%20Grid%3A%20lots%20of%20failing%20gluex%20jobs%20on%20FNAL_FERMIGRID%20ISSUE%3D12086%20PROJ%3D71"><i class="icon-envelope"></i> Update w/Email</a>
        </div>
    </div><!--btn-toolbar-->
    </legend>

    <div class='update_description'><i onclick="document.location='12086#1339438498'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-06-11T18:14:58+00:00">Jun 11, 2012 06:14 PM UTC</time><a class="anchor" name="1339438498">&nbsp;</a></div><pre>Yes,

Please close since I opened it on behalf of Richard and it appears they worked everything out.

Thanks,
Jeff

-- by Jeffrey Michael Dost</pre></div><div class='update_description'><i onclick="document.location='12086#1339427293'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-06-11T15:08:13+00:00">Jun 11, 2012 03:08 PM UTC</time> by <b>GLUEX</b><a class="anchor" name="1339427293">&nbsp;</a></div><pre>Elizabeth,

Yes, thanks.

-Richard J.

On 6/11/2012 10&#58;06 AM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='12086#1339423610'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-06-11T14:06:50+00:00">Jun 11, 2012 02:06 PM UTC</time> by <b>echism</b><a class="anchor" name="1339423610">&nbsp;</a></div><pre>Jeff,

Steve Timm says you requested this ticket. May I close it?

Thank you,
Elizabeth</pre></div><div class='update_description'><i onclick="document.location='12086#1338669847'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-06-02T20:44:07+00:00">Jun 2, 2012 08:44 PM UTC</time> by <b>Steven Timm</b><a class="anchor" name="1338669847">&nbsp;</a></div><pre>OK--as far as FermiGrid is concerned it is OK to close the ticket, but Jeff Dost from the glide in factory should sign off on resolution too since he is the requester of the ticket.

Steve Timm</pre></div><div class='update_description'><i onclick="document.location='12086#1338632587'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-06-02T10:23:07+00:00">Jun 2, 2012 10:23 AM UTC</time> by <b>GLUEX</b><a class="anchor" name="1338632587">&nbsp;</a></div><pre>Elizabeth,

Production is now underway using the new offsite access model through the local squid proxy on each site.  Things seem to be going much more smoothly now for our jobs at Fermilab and elsewhere.  Thanks to Steve for suggesting this.

-Richard J.

On 6/1/2012 1&#58;57 PM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='12086#1338573446'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-06-01T17:57:26+00:00">Jun 1, 2012 05:57 PM UTC</time> by <b>echism</b><a class="anchor" name="1338573446">&nbsp;</a></div><pre>Hi Richard,

When you get a chance let us know how the new squid setup is going.

Thank you,
Elizabeth</pre></div><div class='update_description'><i onclick="document.location='12086#1337619009'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-05-21T16:50:09+00:00">May 21, 2012 04:50 PM UTC</time> by <b>GLUEX</b><a class="anchor" name="1337619009">&nbsp;</a></div><pre>Elizabeth,

I am away on travel until May 28.  I will get back on this issue upon my return.  Meanwhile, we will hold off on submission of more glideins until we implement Steve&#39;s suggestion to reduce offsite traffic using the local squid provided by the site.

-Richard J.

On 5/21/2012 10&#58;59 AM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='12086#1337612346'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-05-21T14:59:06+00:00">May 21, 2012 02:59 PM UTC</time> by <b>Steven Timm</b><a class="anchor" name="1337612346">&nbsp;</a></div><pre>I will be on business travel from May 20-26 2012. I will have access to email during this time but only limited time to reply.  For issues related to FermiGrid or FermiCloud please contact the Service Desk at <a href='http&#58;//servicedesk.fnal.gov' target='_blank' rel='nofollow'>http&#58;//servicedesk.fnal.gov</a> or at extension 2345.

Steve Timm</pre></div><div class='update_description'><i onclick="document.location='12086#1337612175'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-05-21T14:56:15+00:00">May 21, 2012 02:56 PM UTC</time> by <b>echism</b><a class="anchor" name="1337612175">&nbsp;</a></div><pre>Hi Steve,

Please send an update when you get a chance. The last inquiry was about the FNAL firewall.

Thank you,
Elizabeth</pre></div><div class='update_description'><i onclick="document.location='12086#1337096291'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-05-15T15:38:11+00:00">May 15, 2012 03:38 PM UTC</time> by <b>GLUEX</b><a class="anchor" name="1337096291">&nbsp;</a></div><pre>Steve,

After carrying out some tests on running jobs on the fermilab site, we now believe that the blockages are happening on the fermilab firewall rather than on our site.  Here is a report from my student Igor Senderovich who studied it yesterday.

Hi Richard,

After gathering some more network connection data from Fermilab, I am
beginning to doubt that it is a UConn firewall issue.

I sent 1000 jobs with a script to traceroute to zeus, gryphn, grinch,
gluskap, and then engineering, main uconn web servers and google.com as
well as ping all these machines. The results are here&#58;
<a href='http&#58;//zeus.phys.uconn.edu/' target='_blank' rel='nofollow'>http&#58;//zeus.phys.uconn.edu/</a>~senderovich/tmp/testFNAL
&#60;<a href='http&#58;//zeus.phys.uconn.edu/%7Esenderovich/tmp/testFNAL&#62' target='_blank' rel='nofollow'>http&#58;//zeus.phys.uconn.edu/%7Esenderovich/tmp/testFNAL&#62</a>;

In this run, it seemed that all was fine for the first set of jobs and
then suddenly reaching gryphn/zeus became a problem (just look at output
file size vs time stamp first to see the pattern.) But when it starts
failing, traceroute doesn&#39;t stop at UConn&#39;s door - it can&#39;t leave
Fermilab. Now, I am not sure if it is a periodic failure on their end or
if there is some FermiLab policy that after so many hits to an outside
server per given time, that outgoing connection is blocked, perhaps
safeguarding FNAL clusters from being abused for staging an attack. I am
running some more tests to see a pattern when access gets shut off.

-Igor

Steve, can you comment on this?

-Richard Jones

On 5/14/2012 11&#58;29 AM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='12086#1337009349'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-05-14T15:29:09+00:00">May 14, 2012 03:29 PM UTC</time> by <b>GLUEX</b><a class="anchor" name="1337009349">&nbsp;</a></div><pre>Steve, Elizabeth,

The problem cropped up again on the weekend, for a different reason.  We are working on resolving it right now.

-Richard J.

On 5/14/2012 11&#58;23 AM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='12086#1337008988'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-05-14T15:23:08+00:00">May 14, 2012 03:23 PM UTC</time> by <b>echism</b><a class="anchor" name="1337008988">&nbsp;</a></div><pre>Steve,

Have you had success with wget on UConn since being whitelisted?

Thank you,
Elizabeth</pre></div><div class='update_description'><i onclick="document.location='12086#1336594807'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-05-09T20:20:07+00:00">May 9, 2012 08:20 PM UTC</time> by <b>GLUEX</b><a class="anchor" name="1336594807">&nbsp;</a></div><pre>Steve,

I have worked with our netops to track down this problem.  We found that the host zeus.phys.uconn.edu was not whitelisted by network security, so the flood of connections from Fermilab over the weekend tripped a firewall DOS rule, and cut us off from you.  We have updated the whitelist with the names of all servers that our jobs might want to reach, and relaunched a new bunch of glidein jobs.  Please let us know if there are any repeats of the earlier problems.

thanks for the heads-up,
-Richard Jones

On 5/7/2012 2&#58;41 PM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='12086#1336430287'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-05-07T22:38:07+00:00">May 7, 2012 10:38 PM UTC</time> by <b>GLUEX</b><a class="anchor" name="1336430287">&nbsp;</a></div><pre>Steve,

As I read my algorithm, I believe that all of those looping wgets are just requesting permission to install.  You should be able to see that in the url, a parameter ?request_to_install=1 encoded into the url.  I looked over the weekend and I see more than 5000 successful wget&#39;s received from 131.225.xxx addresses, all of them successful (http status 200).  If we are getting blocked, I will contact our netops for if these requests are tripping a tripwire in the firewall.  Can you definitely see timeouts from your end?

I cannot comment on how much useful work was accomplished until my student who submitted the jobs returns tomorrow, but I would tend to believe the cputime estimate you observed.

-Richard J.

On 5/7/2012 2&#58;41 PM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='12086#1336416067'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-05-07T18:41:07+00:00">May 7, 2012 06:41 PM UTC</time> by <b>Steven Timm</b><a class="anchor" name="1336416067">&nbsp;</a></div><pre>Richard, the problem is that it seems that these wgets for the most part are never succeeding, your jobs are just looping and
Retrying the first wget for the setup script, and failing.
Do your logs show that you&#39;ve gotten any useful work done at FNAL_FERMIGRID since Sat. May 5?  I don&#39;t see how you could.  Of the 1000 jobs that you had running this morning the cpu load was identically zero for all of them. That&#39;s why I wondered that our autoblocker might have blocked your site.
But that seems not to be the case, i.e. I can still get to the url you are fetching with a web browser.

But something is very wrong.  Do you see any queries coming into your web server from 131.225.*?  Are they successful?

Steve Timm</pre></div><div class='update_description'><i onclick="document.location='12086#1336415530'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-05-07T18:32:10+00:00">May 7, 2012 06:32 PM UTC</time> by <b>GLUEX</b><a class="anchor" name="1336415530">&nbsp;</a></div><pre>Steve,

These wgets are part of the job environment verification process used in our software stack.  Some of these can be cached by Squid, and some cannot.  Each software element that is needed by a job is configured by the following 2-step procedure.

1. Wget a short shell script &#34;setup.sh&#34; specific to that package, which knows how to search the local job site environment for a pre-installed copy of the package.  If found, it configures several environment variables relevant to that package and returns 0.
2. If step 1 returns non-zero, issue a wget request to the central VO job software server for permission to chosen to install the software component on the local site.  If granted (eg., the first requester) go ahead and download the tarballs and installation scripts, and install the package in the $OSG_APP area on the local site.   If permission is denied (eg. another worker on the site is already granted permission to install) sleep for X seconds and then rerun the setup.sh script to see if the installation has completed.  If not, repeat step 2.

So you can see that (apart from the one-time download of the small setup.sh script) most of the wgets are permission requests, looking for a few-byte response string.  These are state-checking requests, and cannot be cached.

Is this procedure leading to wasteful use of the resources on your site?  If so, can you suggest how the procedure might be improved?

-Richard Jones

On 5/7/2012 10&#58;33 AM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='12086#1336401180'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-05-07T14:33:00+00:00">May 7, 2012 02:33 PM UTC</time><a class="anchor" name="1336401180">&nbsp;</a></div><pre>It appears that the web URL which was failing on Saturday when I opened this ticket, is once
again accessible.  But there is very heavy load and most of the
wgets are not successful and are still timing out.  Any job like this which is wgetting the same URL for thousands of
jobs should be using Squid, and as far as I can tell it is still not doing that.  Almost all of the gluex jobs on
our site are still  using almost no CPU and are stuck in wget&#39;s which appear to be timing out and not getting their files.

-- by Steve Timm</pre></div><div class='update_description'><i onclick="document.location='12086#1336185265'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2012-05-05T02:34:25+00:00">May 5, 2012 02:34 AM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1336185265">&nbsp;</a></div><pre>[by Steve Timm]

We are seeing a lot of gluex jobs, about 1000, running on FNAL_FERMIGRID
right now. Almost all of them are idle cpu-wise, trying to do the following
WGET.

root     28628 28546  0 21&#58;27 pts/1    00&#58;00&#58;00 grep wget
[root@fcdfcaf1560 glide_V10412]# cd /tmp
n/1.0/setupaf1560 tmp]# wget <a href='http&#58;//zeus.phys.uconn.edu/prod/scripts/package/cp' target='_blank' rel='nofollow'>http&#58;//zeus.phys.uconn.edu/prod/scripts/package/cp</a>
--2012-05-04 21&#58;28&#58;07--  <a href='http&#58;//zeus.phys.uconn.edu/prod/scripts/package/cpan/1p' target='_blank' rel='nofollow'>http&#58;//zeus.phys.uconn.edu/prod/scripts/package/cpan/1p</a>
Resolving zeus.phys.uconn.edu... 137.99.19.79
Connecting to zeus.phys.uconn.edu|137.99.19.79|&#58;80...
[root@fcdfcaf1560 tmp]# ps -ef |grep strace
root     28487 27349  0 21&#58;26 pts/0    00&#58;00&#58;00 strace -p 22236
root     28709 28546  0 21&#58;28 pts/1    00&#58;00&#58;00 grep strace
[root@fcdfcaf1560 tmp]# kill -9 28487
[root@fcdfcaf1560 tmp]# telnet 137.99.19.79 80
Trying 137.99.19.79...
telnet&#58; connect to address 137.99.19.79&#58; No route to host

It&#39;s very likely that since your jobs are doing 1000 simultaneous wgets to this
host without using the squid proxy, our on-site auto-blocker has blocked
traffic to that web server.

Steve Timm</pre></div><legend>Similar Recent Tickets <small>modified within the last 30 days</small></legend><div id="similar_tickets"><p class="muted">No similar tickets found.</p></div>
</div>
<script type="text/javascript">
function reset_anchor() {
    $("#updates .selected").removeClass("selected");
    var urls = document.location.toString().split('#'); 
    var anchor = urls[1];
    if(anchor) {
        $("a[name='"+anchor+"']").parents(".update_description").addClass("selected");
    }
}
function submitspam(ticket_id) {
    myret = confirm("Would you like to close this ticket as a security ticket, and submit the ticket content to akismet?");
    if(myret == true) {
        $.ajax("viewer/processspam?id="+ticket_id).done(function() {
            window.location.reload();
        });
    }
}

$(function() {
    reset_anchor();
    var ADDITIONAL_COOKIE_NAME = 'gocticket';
    var options = { path: '/', expires: 365};

    if(window.opener && window.opener.name == "gocticket_list") {
        v = $.cookie("closewindow");
        if(!v) {
            $("#closewindow").attr("checked", "checked"); //on by default
        } else {
            if(v == "checked") {
                $("#closewindow").attr("checked", "checked");
            }
        }
        $("#closewindow").click(function() {
            $.cookie("closewindow", $(this).attr('checked'), options);
        });
    } else {
        $("#closewindow_area").hide();
    }
    function updateTimeago() {
        $("time").timeago();
        setTimeout(updateTimeago, 30*1000);
    }
    updateTimeago();
    $(".description").focus(expand_description);
});
</script>
<hr/>
<footer>
<p>GOC Ticket Version 2.2 | <a href="https://ticket.opensciencegrid.org/goc/submit?app_issue_check=on&amp;app_issue_type=goc&amp;app_goc_url=https%3A%2F%2Fticket.opensciencegrid.org%3A443%2F12086">Report Bugs</a>
 | <a href="https://github.com/opensciencegrid/operations/blob/master/docs/privacy.md">Privacy Policy</a>
</p>

<p> <img align="top" src="images/tag_orange.png"/> Copyright 2018 The Trustees of Indiana University - Developed for Open Science Grid</p>
</footer>


</div><!--container-fluid-->
<script>
var chat = io.connect('https://ticket1.grid.iu.edu:8443');
chat.on('connect', function() {
    chat.emit('authenticate', {nodekey:'', ticketid: 12086});
});
chat.on('peers', function(peers) {
    $("#peers").html("");
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('peer_disconnect', function(pid) {
    $("#peer_"+pid).hide("slow");
});
chat.on('peer_connected', function(peers) {
    //expect only 1 peer connecting, but..
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('submit', function() {
    if(confirm("This ticket was updated. Do you want to refresh?")) {
        history.go(0);
    }
});

function addPeer(pid, peer) {
    var ipinfo = "";
    if(peer.ip != undefined) {
        ipinfo = "<span class=\"ip\">"+peer.ip+"</span>";
    }
    if(chat.io.engine.id == pid) {
        //don't display myself
        return;
    }
    var html = "<li class=\"new\" id=\"peer_"+pid+"\" class=\"peer\">"+peer.name+ipinfo+"</li>";
    $("#peers").prepend(html);
    $("#peers .new").animate({bottom: 0}, 1000, function() {$(this).removeClass("new")});
}

$(function() {
    $("#ticket_form").submit(function() {
        chat.emit('submit');
        return true;
    });
});
</script>
<script>
//used by searchbox
function parseValue(value) {
    var obj = new Object();
    var tokens = value.split("\t");
    obj.str = tokens[0];
    obj.count = tokens[1];
    return obj;
}

$(function() {
    //bootstrap-2.0.4 stuff
    $(".alert-message").alert();
    $(".dropdown-toggle").dropdown();
    $("span[rel='tooltip']").tooltip();
    $("a[rel=popover]").popover();

    //activate menu that user is currently on
    $("#menu_navigator").addClass("active"); 
    $("#submenu_").addClass("active"); 

    //translate zend validation error message to bootstrap
    $(".errors").addClass("alert").addClass("alert-error");

    //enable autocomplete for search box
    $("#search").autocomplete({
        source: function( request, response ) {
            $.ajax({
                url: "search/autocomplete",
                dataType: "text",
                data: {
                    //featureClass: "P",
                    //style: "full",
                    //maxRows: 12,
                    //name_startsWith: request.term
                    q: request.term
                },
                success: function( data ) {
                    response( $.map( data.split("\n"), function( item ) {
                        if(item == "") return null;
                        return {
                            value: item
                        }
                    }));
                }
            });
        },
        select: function(event, ui) {
            document.location = "search?q="+ui.item.value;
        }
    });
    
});
</script>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-69012-13");
pageTracker._trackPageview();
} catch(err) {}
</script>

</body>
