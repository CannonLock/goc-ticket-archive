<!DOCTYPE html>
<html lang="en">
  <head>
  <base href="">
    <title>[23057] Software not being published in OASIS</title>    <meta charset="utf-8" />
    <meta name="verify-v1" content="na5IcAJsZVOfEkboRxuIiZ1zpZgnZiWra+nKcS7nA/o=" />
    <meta name="google-site-verification" content="DLrk3ft4s8b-S2TloLCL2LD_t6wcTjgSluf5pmiu2kA" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />

    <style type="text/css">
      body {
        padding-top: 50px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
     #search {
            width: 300px;
     }

    </style>

<script src="https://code.jquery.com/jquery-3.0.0.js"></script>
<script src="https://code.jquery.com/jquery-migrate-3.0.1.js"></script>

   <link href="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet"/>
    <script src="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/js/bootstrap.min.js"></script>

    <link href="https://netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"/>
    <link href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/themes/smoothness/jquery-ui.min.css" rel="stylesheet"/>
 <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>


    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/js/select2.min.js"></script>

    <link href="css/ticket.css" rel="stylesheet" />
    <script src="lib/jquery.cookie.js"></script>

    <link href="images/tag_orange.png" rel="icon" type="image/png"/>
  </head>

  <body>
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>

            <a class="brand" style="padding: 6px 0px 0px 6px;" href="http://opensciencegrid.org"><img src="images/osglogo.40x30.png"/></a>
            <ul class="nav">
                <li class="dropdown"><a href="https://ticket.opensciencegrid.org/#" class="dropdown-toggle" data-toggle="dropdown">GOC Ticket <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    <li><a href="https://my.opensciencegrid.org">MyOSG</a></li>
                    <li><a href="https://oim.opensciencegrid.org">OIM</a></li>
                    <li class="active"><a href="https://ticket.opensciencegrid.org/index">Ticket</a></li>
	<li class="divider"></li>
	<li><a href="http://repo.grid.iu.edu">Repo</a></li>
	<li class="divider"></li>
	<li><a href="http://blogs.grid.iu.edu">Blog</a></li>
                    <li><a href="http://display.grid.iu.edu">Display</a></li>
                    <li><a href="http://osggoc.blogspot.com/">News</a></li>
                    </ul>
                </li>
            </ul>
            <ul class="nav pull-right">
                <li><a href="https://ticket.opensciencegrid.org/sso/">Login</a></li>            </ul>

            <div class="nav-collapse">
                <ul class="nav">
			 <li id="menu_submit"><a href="https://ticket.opensciencegrid.org/submit">Submit</a></li><li id="menu_view" class="dropdown"><a href="https://ticket.opensciencegrid.org/\#" class="dropdown-toggle" data-toggle="dropdown">View <b class="caret"></b></a><ul class="dropdown-menu"><li id="submenu_listopen"><a href="https://ticket.opensciencegrid.org/list/open">Open Tickets</a></li><li id="submenu_listrecentclose"><a href="https://ticket.opensciencegrid.org/list/recentclose">Recently Closed Tickets</a></li><li class="divider"></li><li id="submenu_alltickets"><a href="https://ticket.opensciencegrid.org/search?q=&amp;sort=id">All Tickets</a></li></ul></li>                </ul>

                <form class="navbar-search pull-right" action="https://ticket.opensciencegrid.org/viewer">
                    <input id="search" type="text" name="id" class="search-query span2" placeholder="Search Ticket" value=""/>
                </form>
            </div>
        </div>
      </div>
    </div>

<script type='text/javascript' src='lib/jquery.timeago.js'></script>
<script type='text/javascript' src='lib/byte2size.js'></script>
<style>
#updates .toolbar {
position: relative;
margin-top: 0px;
top: -10px;
font-weight: normal;
}
#updates a.anchor {
position: relative;
top: -50px;
}
#updates .selected pre {
animation:selected 2s;
animation-iteration-count: 2;
animation-direction: alternate;
-webkit-animation:selected 2s; 
-webkit-animation-iteration-count: 2;
-webkit-animation-direction: alternate;
box-shadow: inset 1px 1px 20px #9ad;
border: 1px solid #9ab;
margin: 5px 0px;
padding-left: 10px;
}
@keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ab;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
@-webkit-keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ad;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
#updates pre {
background-color: inherit;
line-height: 15px;
padding: 5px;
}
#updates .header {
color: #999;
}
#updates .update_history pre {
background-color: #eee;
color: #666;
font-size: 85%;
}
#updates .clickable {
cursor: pointer;
}
#updates .clickable:hover {
color: #D98719;
}
#updates .meta_information pre {
background-color: #fed;
}
#similar_tickets {
max-height: 300px;
overflow-y: auto;
pointer-events: none;
padding: 5px;
background-color: #f4f4f4;
}
.btn-toolbar {
margin-bottom: 0;
height: 30px;
}
#peers {
position: fixed;
bottom: 0px;
right: 0px;
z-index: 100;
list-style: none;
padding: 5px 0px 0px 5px;
margin: 0px;
background-color: white;
box-shadow: 0px 0px 10px white;
}
#peers li {
background-color: #ccc;
color: #000;
display: inline-block;
padding: 5px 10px;
margin-right: 5px;
position: relative;
}
/*
#peers li:hover {
background-color: #999;
cursor: pointer;
}
*/
#peers span.ip {
padding-left: 5px;
color: #666;
}
#peers .new {
bottom: -30px;
}
/*
#peers .me {
background-color: red;
}
*/
</style>

<div class="container-fluid">
<ul id="peers"></ul>
<div class="alert alert-danger"><a class="close" href="https://ticket.opensciencegrid.org/#" data-dismiss="alert">&times;</a>By the end of May 2018, the ticketing system at https://ticket.opensciencegrid.org will be retired and support will be provided at https://support.opensciencegrid.org. Throughout this transition the support email (help@opensciencegrid.org) will be available as a point of contact.<br><br>                                                   
                                                                                                                                                                                   
Please see the service migration page for details: https://opensciencegrid.github.io/technology/policy/service-migrations-spring-2018/#ticket</div><div id="presence" class="pull-right"></div><div class="ticketgui"><script type="text/javascript" src="lib/checktab.js"></script>

<script>
var expanded = false;
function expand_description() {
    var desc = $(".description");
    if(!expanded) {
        expanded = true;
        //expand to minheight
        var min = 250;
        if(desc.height() < min) {
            desc.animate({height: min}, 200);
        }
    }
}

$(document).ready(function() {
    $("input[name='nad']").datepicker({
        dateFormat: 'yy-mm-dd'
    });
});

</script>



<style>
.form-horizontal .control-label {
padding-top: inherit;
font-size:90%;
color:#666;
}
label {
margin-bottom: 0px;
}
.controls {
line-height: 18px;
}
</style>
<form class="form-horizontal" action="https://ticket.opensciencegrid.org/viewer/updatebasic?id=23057" method="post">
<div class="page-header">
    <h3><span class="muted">23057</span> / Software not being published in OASIS</h3>
</div>

<div class="row-fluid">
<div class="span5">
    <legend>Contact</legend>
    <div class="control-group">
        <label class="control-label">Full Name</label>
        <div class="controls">Suchandra Thapa</div>
    </div>
    <div class="control-group">
        <label class="control-label">Email</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">Phone</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">CC</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>

    <legend>Details</legend>
    <div class="control-group"><label class="control-label">Submitted Via</label><div class="controls">GOC Ticket/submit</div></div><div class="control-group"><label class="control-label">Submitter</label><div class="controls">Suchandra Thapa</div></div>
    <div class="control-group">
        <label class="control-label">Ticket Type</label>
        <div class="controls">Problem/Request</div>
    </div>
    <div class="control-group">
        <label class="control-label">Priority</label>
        <div class="controls">Normal</div>
    </div>
    <div class="control-group">
        <label class="control-label">Status</label>
        <div class="controls">
Closed</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action</label>
        <div class="controls">ENG Action</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action Deadline</label>
        <div class="controls flag_red">2014-11-03</div>
    </div>

</div><!--span-->
<div class="span7">
    <legend>Assignees</legend>
    <div class="assignee" style="width: 60%">Scott Teige <span class="muted"> / OSG Operations Infrastructure</span></div>    <br>

    <legend>Assignees</legend>
    TODO
    <br>

    <style>
legend.noborder {
border-bottom: none;
}
</style>

<div id="attachment-list"/>
<script>
$(function () {
    var first = true;
    $.getJSON("attachment/list/23057", function (files) {
        //console.dir(files);
        var html = "<table class=\"table table-condensed\">";
        $(files).each(function() {
            if(first) {
                first = false;
                html += "<legend class=\"noborder\">Attachmenets</legend>";
            }
            html += "<tr class=\"attachment\">";
            html += "<td><img src=\""+this.thumbnail_url+"\"/></td>";
            html += "<td><a href=\""+this.url+"\" target=\"_blank\">"+this.name+"</a></td>";
            html += "<td>"+bytesToSize(this.size, 1)+"</td>";
            html += "</tr>";
        });
        html += "</table>";
        $("#attachment-list").html(html);
    });
});

function download(url) {
    window.open(url, "_blank");
}
</script>


</div><!--span-->
</div><!--row-fluid-->


</form>

</div>
<div id="updates" style="clear: both;">
    <legend>Past Updates
    <div class="btn-toolbar pull-right toolbar">
    </div><!--btn-toolbar-->
    </legend>

    <div class='update_description'><i onclick="document.location='23057#1415649136'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-11-10T19:52:16+00:00">Nov 10, 2014 07:52 PM UTC</time> by <b>Scott Teige</b><a class="anchor" name="1415649136">&nbsp;</a></div><pre>I&#39;m seeing content in udunits and expat. Resolving this ticket. Please let me know if you encounter further problems.</pre></div><div class='update_description'><i onclick="document.location='23057#1415291700'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-11-06T16:35:00+00:00">Nov 6, 2014 04:35 PM UTC</time> by <b>Scott Teige</b><a class="anchor" name="1415291700">&nbsp;</a></div><pre>I&#39;ve done the mv --&#62;/tmp --&#62; back where it was. The update is now in progress.
I&#39;ll check that it worked then do .../expat too.

Sorry for the trouble, a longer term solution is in the works.

S</pre></div><div class='update_description'><i onclick="document.location='23057#1415049177'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-11-03T21:12:57+00:00">Nov 3, 2014 09:12 PM UTC</time> by <b>Suchandra Thapa</b><a class="anchor" name="1415049177">&nbsp;</a></div><pre>There&#39;s a workaround where if you move the directory somewhere else (e.g. /tmp) publish and then move them back and then publish again, the directories get published correctly.  I can do this but I can wait if you want to have something around so that you can investigate further.

Suchandra</pre></div><div class='update_description'><i onclick="document.location='23057#1415049048'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-11-03T21:10:48+00:00">Nov 3, 2014 09:10 PM UTC</time> by <b>Scott Teige</b><a class="anchor" name="1415049048">&nbsp;</a></div><pre>I agree, they are not there and updates after this happened are just fine. I&#39;ll verify this tomorrow and take steps to correct it then if it persists.
Sorry for the inconvenience</pre></div><div class='update_description'><i onclick="document.location='23057#1415043352'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-11-03T19:35:52+00:00">Nov 3, 2014 07:35 PM UTC</time><a class="anchor" name="1415043352">&nbsp;</a></div><pre>This was my response in the thread&#58;
-----------------------------------------

Date&#58; Fri, 31 Oct 2014 20&#58;09&#58;43 -0500
From&#58; Dave Dykstra &#60;dwd@....&#62;

The way that cvmfs 2.0 works is that any changes made to
/srv/cvmfs/oasis.opensciencegrid/shadow (which is also mounted at
/cvmfs/oasis.opensciencegrid.org) are tracked by redirfs. Scott&#39;s
script rsyncs from /net/nas01/Public/ouser.&#60;vo&#62; to there, but if
the files are already there, rsync won&#39;t change anything.  So first
please check to see if the files are already there.  Also since
there&#39;s no error messages in the oasis log, check for errors in
/var/log/messages just in case.  Also make sure the cvmfsd service
is running with &#39;service cvmfsd status&#39;.

Also, /srv/cvmfs/oasis.opensciencegrid.org/ctrl contains &#34;fschanges&#34;
files for each publish operation.  That might give us a hint about what
it thought changed if you match them up with the times that
osg-oasis-update ran.

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=Dave Dykstra 508</pre></div><div class='update_description'><i onclick="document.location='23057#1415038689'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-11-03T18:18:09+00:00">Nov 3, 2014 06:18 PM UTC</time> by <b>Suchandra Thapa</b><a class="anchor" name="1415038689">&nbsp;</a></div><pre>OASIS is not publishing directories with the correct permissions.    There&#39;s an email thread regarding this, here&#39;s the thread so far&#58;

Suchandra&#58;

The issue where directories don&#39;t seem to be published from OASIS despite having the correct permissions appears to be back.  Currently /net/nas01/Public/ouser.osg/modules/udunits and /net/nas01/Public/ouser.osg/modules/expat appear to show this behaviour.  Any ideas why this is occurring?

Soichi&#58;
(Scott is out this afternoon, so I am trying to respond to this)

Suchandra,

I just ran osg-batch-update and monitored oasis_update.log on the oasis server. As far as I can tell, everything went accordingly. Scott&#39;s script copied the /modules/udunits/2.2.17 and ran various oasis publish commands.

I see no error messages.

Wed Oct 29 21&#58;50&#58;48 UTC 2014 starting expand_oasis_dirtab
Auto-creating nested catalogs...
Wed Oct 29 21&#58;51&#58;52 UTC 2014 finished expand_oasis_dirtab
Wed Oct 29 21&#58;51&#58;52 UTC 2014 starting cvmfs_server publish
Locking down /cvmfs/oasis.opensciencegrid.org[  OK  ]
Waiting for pending operations on /cvmfs/oasis.opensciencegrid.org[  OK  ]
Waiting for pending messages in call buffer[  OK  ]
Stopping journal writer[  OK  ]
Attaching /srv/cvmfs/oasis.opensciencegrid.org/pub/catalogs/.cvmfscatalog.working
Parsing file system change log... 21 lines
Loading required file catalogs...
Attaching /srv/cvmfs/oasis.opensciencegrid.org/pub/catalogs/osg/.cvmfscatalog.working
Post-processing file system change log...
Step 1 - Deleting obsolete file and directory entries (2 entries)&#58; .
Step 2 - Inserting new directories and symlinks (0 entries)&#58;
Step 3 - Updating touched directories (2 entries)&#58; .
Step 4 - Building file list (2 entries)&#58; .
Step 5 - Compressing and calculating content hashes using 16 threads (2 files)&#58; .
Step 6 - Updating file catalogs (2 files)&#58; .
Commit changes to catalogs...
<div id='show_134289293' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_134289293'>Creating catalog snapshot at /cvmfs/oasis.opensciencegrid.org/osg
Creating catalog snapshot at /cvmfs/oasis.opensciencegrid.org
Flushing file system change log[  OK  ]
Resuming journal writer[  OK  ]
Open up /cvmfs/oasis.opensciencegrid.org[  OK  ]
Signing /srv/cvmfs/oasis.opensciencegrid.org/pub/catalogs/osg/.cvmfscatalog
Signing /srv/cvmfs/oasis.opensciencegrid.org/pub/catalogs/.cvmfscatalog
Wed Oct 29 21&#58;52&#58;10 UTC 2014 finished cvmfs_server publish

However, I am not seeing /modules/udunits/2.2.17 directory on my newly loaded oasis mount directory.

2014-10-29 22&#58;06&#58;40 UTC [hayashis@wn1&#58;/cvmfs/oasis.opensciencegrid.org/osg/modules/udunits]$ ls -la
total 9
drwxr-xr-x 1 cvmfs cvmfs 4096 Oct 27 20&#58;23 .
drwxrwxr-x 1 cvmfs cvmfs 4096 Oct 28 21&#58;15 ..

Scott should confirm this, but I believe this is an issue with OASIS itself, and it is somehow not seeing your 2.2.17 directory and properly publishing it.

Scott, who does the upstream support on OASIS now?

Dave Dykstra&#58;
The way that cvmfs 2.0 works is that any changes made to
/srv/cvmfs/oasis.opensciencegrid/shadow (which is also mounted at
/cvmfs/oasis.opensciencegrid.org) are tracked by redirfs. Scott&#39;s
script rsyncs from /net/nas01/Public/ouser.&#60;vo&#62; to there, but if
the files are already there, rsync won&#39;t change anything.  So first
please check to see if the files are already there.  Also since
there&#39;s no error messages in the oasis log, check for errors in
/var/log/messages just in case.  Also make sure the cvmfsd service
is running with &#39;service cvmfsd status&#39;.

Also, /srv/cvmfs/oasis.opensciencegrid.org/ctrl contains &#34;fschanges&#34;
files for each publish operation.  That might give us a hint about what
it thought changed if you match them up with the times that
osg-oasis-update ran.

</div><script type='text/javascript'>
        $('#show_134289293').click(function() {
            $('#detail_134289293').slideDown("normal");
            $('#show_134289293').hide();
            $('#hide_134289293').show();
        });
        $('#hide_134289293').click(function() {
            $('#detail_134289293').slideUp();
            $('#hide_134289293').hide();
            $('#show_134289293').show();
        });
        </script></pre></div>
</div>
<script type="text/javascript">
function reset_anchor() {
    $("#updates .selected").removeClass("selected");
    var urls = document.location.toString().split('#'); 
    var anchor = urls[1];
    if(anchor) {
        $("a[name='"+anchor+"']").parents(".update_description").addClass("selected");
    }
}
function submitspam(ticket_id) {
    myret = confirm("Would you like to close this ticket as a security ticket, and submit the ticket content to akismet?");
    if(myret == true) {
        $.ajax("viewer/processspam?id="+ticket_id).done(function() {
            window.location.reload();
        });
    }
}

$(function() {
    reset_anchor();
    var ADDITIONAL_COOKIE_NAME = 'gocticket';
    var options = { path: '/', expires: 365};

    if(window.opener && window.opener.name == "gocticket_list") {
        v = $.cookie("closewindow");
        if(!v) {
            $("#closewindow").attr("checked", "checked"); //on by default
        } else {
            if(v == "checked") {
                $("#closewindow").attr("checked", "checked");
            }
        }
        $("#closewindow").click(function() {
            $.cookie("closewindow", $(this).attr('checked'), options);
        });
    } else {
        $("#closewindow_area").hide();
    }
    function updateTimeago() {
        $("time").timeago();
        setTimeout(updateTimeago, 30*1000);
    }
    updateTimeago();
    $(".description").focus(expand_description);
});
</script>
<hr/>
<footer>
<p>GOC Ticket Version 2.2 | <a href="https://ticket.opensciencegrid.org/goc/submit?app_issue_check=on&amp;app_issue_type=goc&amp;app_goc_url=https%3A%2F%2Fticket.opensciencegrid.org%3A443%2F23057">Report Bugs</a>
 | <a href="https://github.com/opensciencegrid/operations/blob/master/docs/privacy.md">Privacy Policy</a>
</p>

<p> <img align="top" src="images/tag_orange.png"/> Copyright 2018 The Trustees of Indiana University - Developed for Open Science Grid</p>
</footer>


</div><!--container-fluid-->
<script>
//used by searchbox
function parseValue(value) {
    var obj = new Object();
    var tokens = value.split("\t");
    obj.str = tokens[0];
    obj.count = tokens[1];
    return obj;
}

$(function() {
    //bootstrap-2.0.4 stuff
    $(".alert-message").alert();
    $(".dropdown-toggle").dropdown();
    $("span[rel='tooltip']").tooltip();
    $("a[rel=popover]").popover();

    //activate menu that user is currently on
    $("#menu_navigator").addClass("active"); 
    $("#submenu_").addClass("active"); 

    //translate zend validation error message to bootstrap
    $(".errors").addClass("alert").addClass("alert-error");

    //enable autocomplete for search box
    $("#search").autocomplete({
        source: function( request, response ) {
            $.ajax({
                url: "search/autocomplete",
                dataType: "text",
                data: {
                    //featureClass: "P",
                    //style: "full",
                    //maxRows: 12,
                    //name_startsWith: request.term
                    q: request.term
                },
                success: function( data ) {
                    response( $.map( data.split("\n"), function( item ) {
                        if(item == "") return null;
                        return {
                            value: item
                        }
                    }));
                }
            });
        },
        select: function(event, ui) {
            document.location = "search?q="+ui.item.value;
        }
    });
    
});
</script>


</body>
