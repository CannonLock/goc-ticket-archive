<!DOCTYPE html>
<html lang="en">
  <head>
  <base href="">
    <title>[7913] Help! Some production CEs stopped reporting to a functional CEMon collector</title>    <meta charset="utf-8" />
    <meta name="verify-v1" content="na5IcAJsZVOfEkboRxuIiZ1zpZgnZiWra+nKcS7nA/o=" />
    <meta name="google-site-verification" content="DLrk3ft4s8b-S2TloLCL2LD_t6wcTjgSluf5pmiu2kA" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />
    <link href="https://ticket.opensciencegrid.org/rss" rel="alternate" type="application/rss+xml" title="GOC Ticket Update feed" />

    <style type="text/css">
      body {
        padding-top: 50px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
     #search {
            width: 300px;
     }

    </style>

<script src="https://code.jquery.com/jquery-3.0.0.js"></script>
<script src="https://code.jquery.com/jquery-migrate-3.0.1.js"></script>

   <link href="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet"/>
    <script src="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/js/bootstrap.min.js"></script>

    <link href="https://netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"/>
    <link href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/themes/smoothness/jquery-ui.min.css" rel="stylesheet"/>
 <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>


    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/js/select2.min.js"></script>

    <link href="css/ticket.css" rel="stylesheet" />
    <script src="lib/jquery.cookie.js"></script>

    <link href="images/tag_orange.png" rel="icon" type="image/png"/>
  </head>

  <body>
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>

            <a class="brand" style="padding: 6px 0px 0px 6px;" href="http://opensciencegrid.org"><img src="images/osglogo.40x30.png"/></a>
            <ul class="nav">
                <li class="dropdown"><a href="https://ticket.opensciencegrid.org/#" class="dropdown-toggle" data-toggle="dropdown">GOC Ticket <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    <li><a href="https://my.opensciencegrid.org">MyOSG</a></li>
                    <li><a href="https://oim.opensciencegrid.org">OIM</a></li>
                    <li class="active"><a href="https://ticket.opensciencegrid.org/index">Ticket</a></li>
	<li class="divider"></li>
	<li><a href="http://repo.grid.iu.edu">Repo</a></li>
	<li class="divider"></li>
	<li><a href="http://blogs.grid.iu.edu">Blog</a></li>
                    <li><a href="http://display.grid.iu.edu">Display</a></li>
                    <li><a href="http://osggoc.blogspot.com/">News</a></li>
                    </ul>
                </li>
            </ul>
            <ul class="nav pull-right">
                <li><a href="https://ticket.opensciencegrid.org/sso/">Login</a></li>            </ul>

            <div class="nav-collapse">
                <ul class="nav">
			 <li id="menu_submit"><a href="https://ticket.opensciencegrid.org/submit">Submit</a></li><li id="menu_view" class="dropdown"><a href="https://ticket.opensciencegrid.org/\#" class="dropdown-toggle" data-toggle="dropdown">View <b class="caret"></b></a><ul class="dropdown-menu"><li id="submenu_listopen"><a href="https://ticket.opensciencegrid.org/list/open">Open Tickets</a></li><li id="submenu_listrecentclose"><a href="https://ticket.opensciencegrid.org/list/recentclose">Recently Closed Tickets</a></li><li class="divider"></li><li id="submenu_alltickets"><a href="https://ticket.opensciencegrid.org/search?q=&amp;sort=id">All Tickets</a></li></ul></li>                </ul>

                <form class="navbar-search pull-right" action="https://ticket.opensciencegrid.org/viewer">
                    <input id="search" type="text" name="id" class="search-query span2" placeholder="Search Ticket" value=""/>
                </form>
            </div>
        </div>
      </div>
    </div>

<script type='text/javascript' src='lib/jquery.timeago.js'></script>
<script type='text/javascript' src='lib/byte2size.js'></script>
<style>
#updates .toolbar {
position: relative;
margin-top: 0px;
top: -10px;
font-weight: normal;
}
#updates a.anchor {
position: relative;
top: -50px;
}
#updates .selected pre {
animation:selected 2s;
animation-iteration-count: 2;
animation-direction: alternate;
-webkit-animation:selected 2s; 
-webkit-animation-iteration-count: 2;
-webkit-animation-direction: alternate;
box-shadow: inset 1px 1px 20px #9ad;
border: 1px solid #9ab;
margin: 5px 0px;
padding-left: 10px;
}
@keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ab;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
@-webkit-keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ad;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
#updates pre {
background-color: inherit;
line-height: 15px;
padding: 5px;
}
#updates .header {
color: #999;
}
#updates .update_history pre {
background-color: #eee;
color: #666;
font-size: 85%;
}
#updates .clickable {
cursor: pointer;
}
#updates .clickable:hover {
color: #D98719;
}
#updates .meta_information pre {
background-color: #fed;
}
#similar_tickets {
max-height: 300px;
overflow-y: auto;
pointer-events: none;
padding: 5px;
background-color: #f4f4f4;
}
.btn-toolbar {
margin-bottom: 0;
height: 30px;
}
#peers {
position: fixed;
bottom: 0px;
right: 0px;
z-index: 100;
list-style: none;
padding: 5px 0px 0px 5px;
margin: 0px;
background-color: white;
box-shadow: 0px 0px 10px white;
}
#peers li {
background-color: #ccc;
color: #000;
display: inline-block;
padding: 5px 10px;
margin-right: 5px;
position: relative;
}
/*
#peers li:hover {
background-color: #999;
cursor: pointer;
}
*/
#peers span.ip {
padding-left: 5px;
color: #666;
}
#peers .new {
bottom: -30px;
}
/*
#peers .me {
background-color: red;
}
*/
</style>

<div class="container-fluid">
<ul id="peers"></ul>
<div class="alert alert-danger"><a class="close" href="https://ticket.opensciencegrid.org/#" data-dismiss="alert">&times;</a>By the end of May 2018, the ticketing system at https://ticket.opensciencegrid.org will be retired and support will be provided at https://support.opensciencegrid.org. Throughout this transition the support email (help@opensciencegrid.org) will be available as a point of contact.<br><br>                                                   
                                                                                                                                                                                   
Please see the service migration page for details: https://opensciencegrid.github.io/technology/policy/service-migrations-spring-2018/#ticket</div><div id="presence" class="pull-right"></div><div class="ticketgui"><script type="text/javascript" src="lib/checktab.js"></script>

<script>
var expanded = false;
function expand_description() {
    var desc = $(".description");
    if(!expanded) {
        expanded = true;
        //expand to minheight
        var min = 250;
        if(desc.height() < min) {
            desc.animate({height: min}, 200);
        }
    }
}

$(document).ready(function() {
    $("input[name='nad']").datepicker({
        dateFormat: 'yy-mm-dd'
    });
});

</script>



<style>
.form-horizontal .control-label {
padding-top: inherit;
font-size:90%;
color:#666;
}
label {
margin-bottom: 0px;
}
.controls {
line-height: 18px;
}
</style>
<form class="form-horizontal" action="https://ticket.opensciencegrid.org/viewer/updatebasic?id=7913" method="post">
<div class="page-header">
    <h3><span class="muted">7913</span> / Help! Some production CEs stopped reporting to a functional CEMon collector</h3>
</div>

<div class="row-fluid">
<div class="span5">
    <legend>Contact</legend>
    <div class="control-group">
        <label class="control-label">Full Name</label>
        <div class="controls">OSG-GOC 0</div>
    </div>
    <div class="control-group">
        <label class="control-label">Email</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">Phone</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">CC</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>

    <legend>Details</legend>
    
    <div class="control-group">
        <label class="control-label">Ticket Type</label>
        <div class="controls">Problem/Request</div>
    </div>
    <div class="control-group">
        <label class="control-label">Priority</label>
        <div class="controls">Normal</div>
    </div>
    <div class="control-group">
        <label class="control-label">Status</label>
        <div class="controls">
Closed</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action</label>
        <div class="controls">ENG Action</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action Deadline</label>
        <div class="controls flag_red">2010-01-27</div>
    </div>

</div><!--span-->
<div class="span7">
    <legend>Assignees</legend>
    <div class="assignee" style="width: 60%">Thomas Lee <span class="muted"> / OSG Operations Infrastructure</span></div><div class="assignee" style="width: 60%">ReSS <span class="muted"> / OSG Support Centers</span></div><div class="assignee" style="width: 60%">Rob Quick <span class="muted"> / OSG GOC Management</span></div>    <br>

    <legend>Assignees</legend>
    TODO
    <br>

    <style>
legend.noborder {
border-bottom: none;
}
</style>

<div id="attachment-list"/>
<script>
$(function () {
    var first = true;
    $.getJSON("attachment/list/7913", function (files) {
        //console.dir(files);
        var html = "<table class=\"table table-condensed\">";
        $(files).each(function() {
            if(first) {
                first = false;
                html += "<legend class=\"noborder\">Attachmenets</legend>";
            }
            html += "<tr class=\"attachment\">";
            html += "<td><img src=\""+this.thumbnail_url+"\"/></td>";
            html += "<td><a href=\""+this.url+"\" target=\"_blank\">"+this.name+"</a></td>";
            html += "<td>"+bytesToSize(this.size, 1)+"</td>";
            html += "</tr>";
        });
        html += "</table>";
        $("#attachment-list").html(html);
    });
});

function download(url) {
    window.open(url, "_blank");
}
</script>


</div><!--span-->
</div><!--row-fluid-->


</form>

</div>
<div id="updates" style="clear: both;">
    <legend>Past Updates
    <div class="btn-toolbar pull-right toolbar">
        <div class="btn-group">
                <a class="btn btn-small" href="https://ticket.opensciencegrid.org/7913?sort=up&amp;"><i class="icon-arrow-up"></i> Sort</a>

        
        <a class="btn btn-small" href="https://ticket.opensciencegrid.org/7913?expandall=true&amp;">Expand Descriptions</a>        <a class="btn btn-small" target="_blank" href="mailto:osg@tick.globalnoc.iu.edu?subject=Open%20Science%20Grid%3A%20Help%21%20Some%20production%20CEs%20stopped%20reporting%20to%20a%20functional%20CEMon%20collector%20ISSUE%3D7913%20PROJ%3D71"><i class="icon-envelope"></i> Update w/Email</a>
        </div>
    </div><!--btn-toolbar-->
    </legend>

    <div class='update_description'><i onclick="document.location='7913#1264432276'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2010-01-25T15:11:16+00:00">Jan 25, 2010 03:11 PM UTC</time> by <b>Arvind Gopu</b><a class="anchor" name="1264432276">&nbsp;</a></div><pre>Thanks Parag, for the update as well as the excellent and thorough investigation into this issue!

We will close this ticket now, and will await to hear about the update to the CEMon client - please keep us posted on testing, and when it&#39;s ready to be deployed via VDT, etc.

Cheers,
-ag</pre></div><div class='update_description'><i onclick="document.location='7913#1264090986'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2010-01-21T16:23:06+00:00">Jan 21, 2010 04:23 PM UTC</time> by <b>Parag Mhashilkar</b><a class="anchor" name="1264090986">&nbsp;</a></div><pre>From my perspective we can close it. Since we will get a fix in cemon it
should prevent such issues in future. Also we do not have enough log
samples to conclude the arch issue. It may not be worth spending any
time on it apart from for educational purposes.

--
Thanks & Regards
=============================================================
Parag Mhashilkar
Fermi National Accelerator Laboratory, MS 120
Wilson & Kirk Road, Batavia, IL - 60510.

Location&#58; Wilson Hall, WH863
Phone&#58; +1 (630) 840-6530
Fax&#58; +1 (630) 840-2783
Email&#58; parag@....
=============================================================

On Thu, 2010-01-21 at 16&#58;05 +0000, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='7913#1264089906'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2010-01-21T16:05:06+00:00">Jan 21, 2010 04:05 PM UTC</time> by <b>Arvind Gopu</b><a class="anchor" name="1264089906">&nbsp;</a></div><pre><font color='#7F7E6F'>&#62; Luigi (one of the cemon developers) has accepted this request. We should</font>
<font color='#7F7E6F'>&#62; get new release soon. From few options suggested he accepted to -</font>
<font color='#7F7E6F'>&#62;</font>

Excellent news! Let us know when the new release is ready, and we will
test it on the ITB server before deploying on the production server.

So, is there any other angle we are going to pursue on this ticket or is
it safe to close it?

-ag</pre></div><div class='update_description'><i onclick="document.location='7913#1264089546'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2010-01-21T15:59:06+00:00">Jan 21, 2010 03:59 PM UTC</time> by <b>Parag Mhashilkar</b><a class="anchor" name="1264089546">&nbsp;</a></div><pre>Hi Arvind,

Luigi (one of the cemon developers) has accepted this request. We should
get new release soon. From few options suggested he accepted to -

--------
Is it possible to change cemon behavior and have it use different
threads even for same policy rate?
What I am suggesting is one of the following options -
[...]
- Make it configurable, so that if a subscription is critical then you
can configure it to run as an independent thread. If not configured this
way it can share same thread, thus exhibiting behavior as we see now.
This gives more flexibility to the users and keeps the default behavior.
[...]
--------

--
Thanks & Regards
=============================================================
Parag Mhashilkar
Fermi National Accelerator Laboratory, MS 120
Wilson & Kirk Road, Batavia, IL - 60510.

Location&#58; Wilson Hall, WH863
Phone&#58; +1 (630) 840-6530
Fax&#58; +1 (630) 840-2783
Email&#58; parag@....
=============================================================

On Wed, 2010-01-20 at 16&#58;31 +0000, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='7913#1264005067'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2010-01-20T16:31:07+00:00">Jan 20, 2010 04:31 PM UTC</time> by <b>Arvind Gopu</b><a class="anchor" name="1264005067">&nbsp;</a></div><pre>Ok, thanks Parag. Let us know, I will ping you sometime next week if I don&#39;t hear back by then. --ag</pre></div><div class='update_description'><i onclick="document.location='7913#1263583268'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2010-01-15T19:21:08+00:00">Jan 15, 2010 07:21 PM UTC</time> by <b>Parag Mhashilkar</b><a class="anchor" name="1263583268">&nbsp;</a></div><pre>Hi Arvind,

I haven&#39;t heard back from the CEMon developers regarding the 32 v/s 64
bit arch differences.

As far as changes to policy rate is concerned, I used to talk to VDT
whenever any changes were required to CEMon or its config.

Yes it seems a bit hacky and is just a work around. Let me see if I can
get the cemon folks to put a patch in that does it the right way.

--
Thanks & Regards
=============================================================
Parag Mhashilkar
Fermi National Accelerator Laboratory, MS 120
Wilson & Kirk Road, Batavia, IL - 60510.

Location&#58; Wilson Hall, WH863
Phone&#58; +1 (630) 840-6530
Fax&#58; +1 (630) 840-2783
Email&#58; parag@....
=============================================================

On Fri, 2010-01-15 at 18&#58;14 +0000, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='7913#1263579274'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2010-01-15T18:14:34+00:00">Jan 15, 2010 06:14 PM UTC</time> by <b>Arvind Gopu</b><a class="anchor" name="1263579274">&nbsp;</a></div><pre>Parag,

Have you heard back from the CEMon developers? If you have confirmed your suspicions/inferences, then I will skip the part where we ask for more 32-bit logs, etc. (so as to avoid decreasing the signal to noise ratio of the ticket)

<font color='#7F7E6F'>&#62; Change frequencies to get around the problem</font>

1) Should we proceed with this measure? Would Suchandra/configure-osg folks be the right person to contact?

2) Additionally, I feel that this fix while effective is a bit hacky, and depends on admins not to change the frequency by hand to identical values. A better long term fix in my opinion would be to get the CEMon developers to tweak the program to use one thread per subscription, and *not* club subscriptions of similar frequency in one thread, is this feasiable? What are your thoughts, Parag?

Cheers,
-ag</pre></div><div class='update_description'><i onclick="document.location='7913#1262980387'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2010-01-08T19:53:07+00:00">Jan 8, 2010 07:53 PM UTC</time> by <b>Parag Mhashilkar</b><a class="anchor" name="1262980387">&nbsp;</a></div><pre>Hmm, it was the machine where I have running globus-job-run that was
causing the problem. I have attached the script to gather uname info
from the gatekeeper machines. So far, I could only get this for
following sites with my proxy. For others, I was either not
authenticated or there was some other issue.

QUERING ... belhaven-1.renci.org
belhaven-1.renci.org &#58; Linux belhaven-1 2.6.26-2-686 #1 SMP Wed Nov 4
20&#58;45&#58;37 UTC 2009 i686 GNU/Linux
QUERING ... condor1.oscer.ou.edu
condor1.oscer.ou.edu &#58; Linux condor1.oscer.ou.edu 2.6.18-164.2.1.el5PAE
#1 SMP Mon Sep 21 04&#58;45&#58;05 EDT 2009 i686 i686 i386 GNU/Linux
QUERING ... condor.oscer.ou.edu
condor.oscer.ou.edu &#58; Linux condor.oscer.ou.edu 2.6.18-164.el5PAE #1 SMP
Tue Aug 18 15&#58;59&#58;11 EDT 2009 i686 i686 i386 GNU/Linux
QUERING ... fermigridosg1.fnal.gov
fermigridosg1.fnal.gov &#58; Linux fg1x1.fnal.gov 2.6.18-164.6.1.el5xen #1
SMP Tue Nov 3 23&#58;55&#58;34 EST 2009 i686 i686 i386 GNU/Linux
QUERING ... gridgk01.racf.bnl.gov
gridgk01.racf.bnl.gov &#58; Linux gridgk01.racf.bnl.gov 2.6.9-89.0.15.ELsmp
#1 SMP Sat Oct 10 05&#58;59&#58;16 EDT 2009 i686 i686 i386 GNU/Linux
QUERING ... gridgk02.racf.bnl.gov
gridgk02.racf.bnl.gov &#58; Linux gridgk02.racf.bnl.gov 2.6.9-89.0.15.ELsmp
#1 SMP Sat Oct 10 05&#58;59&#58;16 EDT 2009 i686 i686 i386 GNU/Linux
QUERING ... iut2-grid6.iu.edu
iut2-grid6.iu.edu &#58; Linux iut2-grid6 2.6.9-89.0.16.EL.cernsmp #1 SMP Wed
Nov 4 09&#58;12&#58;48 CET 2009 i686 athlon i386 GNU/Linux
QUERING ... osg1.loni.org
osg1.loni.org &#58; Linux osg1.loni.org 2.6.9-89.0.11.ELsmp #1 SMP Mon Aug
31 11&#58;01&#58;10 EDT 2009 i686 i686 i386 GNU/Linux
QUERING ... osg-ce.sprace.org.br
osg-ce.sprace.org.br &#58; Linux osg-ce.sprace.org.br
2.6.9-89.0.11.ELhugemem #1 SMP Tue Sep 15 14&#58;16&#58;55 CDT 2009 i686 i686
i386 GNU/Linux
QUERING ... ouhep00.nhn.ou.edu
<div id='show_1599511290' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_1599511290'>ouhep00.nhn.ou.edu &#58; Linux ouhep00.nhn.ou.edu 2.6.18-164.9.1.el5PAE #1
SMP Wed Dec 9 03&#58;46&#58;34 EST 2009 i686 i686 i386 GNU/Linux
QUERING ... ouhep0.nhn.ou.edu
ouhep0.nhn.ou.edu &#58; Linux ouhep0.nhn.ou.edu 2.6.18-164.9.1.el5PAE #1 SMP
Wed Dec 9 03&#58;46&#58;34 EST 2009 i686 i686 i386 GNU/Linux
QUERING ... ouhep1.nhn.ou.edu
ouhep1.nhn.ou.edu &#58; Linux ouhep1.nhn.ou.edu 2.6.18-164.9.1.el5PAE #1 SMP
Wed Dec 9 03&#58;46&#58;34 EST 2009 i686 i686 i386 GNU/Linux

--
Thanks & Regards
=============================================================
Parag Mhashilkar
Fermi National Accelerator Laboratory, MS 120
Wilson & Kirk Road, Batavia, IL - 60510.

Location&#58; Wilson Hall, WH863
Phone&#58; +1 (630) 840-6530
Fax&#58; +1 (630) 840-2783
Email&#58; parag@....
=============================================================

On Fri, 2010-01-08 at 19&#58;20 +0000, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font>
</div><script type='text/javascript'>
        $('#show_1599511290').click(function() {
            $('#detail_1599511290').slideDown("normal");
            $('#show_1599511290').hide();
            $('#hide_1599511290').show();
        });
        $('#hide_1599511290').click(function() {
            $('#detail_1599511290').slideUp();
            $('#hide_1599511290').hide();
            $('#show_1599511290').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='7913#1262978406'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2010-01-08T19:20:06+00:00">Jan 8, 2010 07:20 PM UTC</time> by <b>Parag Mhashilkar</b><a class="anchor" name="1262978406">&nbsp;</a></div><pre>Hi Arvind,

I was waiting for more info from the CEMon developers to send this out.

So far I know with almost 100% confidence level why some of the sites
stopped reporting to is1. CEmon configuration has two interesting
parameters notificationtimeout_sec and policy rate which I listed in my
findings earlier. The defaults are 120 sec and 300 sec respectively.
Notification timeout is for http timeout. However, it is possible that
ce&#39;s which stopped reporting to is1 and is2 got beyond the http
connection, got their connection established and got stuck after that.
So the subscription thread never terminated. But what actually stopped
the ces from reporting was the policy rate and how cemon treats policy
rate. CEmon groups subscriptions based on policy rates. ie. subscription
to is1 and is2 which both have policy rate = 300 will be processed by
one thread while subscription for ress with policy rate = 600 is
processed by another thread. So clearly if the thread got blocked with
is2 and never terminated, subscription for is1 never got a chance to be
advertised until the thread was killed/terminated. This also explains
why fg1x1 for which connection to is2 timed out periodically kept on
advertising to is1 while others didn&#39;t. That&#39;s 50% of the mystery. Other
50% is to understand why the connection from some ce&#39;s didn&#39;t terminate
and this is where arch could be possibility. Another possible scenario
could be that the is2 server accepted connection while it was still
trashing but after a while it just became unstable and didn&#39;t accept
more connections. And fg1x1 is just one such ce where the connection was
outright rejected. But again it&#39;s not easy to conclude without enough
log samples and until cemon developers say something more about it. I
will update the ticket with the info as soon as I have it.

To avoid this is1 blocking on is2 issue, if subscriptions to is1 and is2
run with different policy rates they should not be grouped together in
same thread. Is it a reasonable to cemon configuration in future vdt
releases?

<div id='show_251124407' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_251124407'>It will definitely help to get some logs from 32 bit CEs. As far as
getting a list of possible ces. I was trying to cookup a script that
gets the list of jobmanager contact string from ress and tries to run a
globus-job-run for command /bin/uname using fork jobmanager. But that
didn&#39;t go very well. Are there any rsv or any accounting scripts that
run on ce node? If so is it easy to get hold of their logs/info and
extract arch specific info if available?

--
Thanks & Regards
=============================================================
Parag Mhashilkar
Fermi National Accelerator Laboratory, MS 120
Wilson & Kirk Road, Batavia, IL - 60510.

Location&#58; Wilson Hall, WH863
Phone&#58; +1 (630) 840-6530
Fax&#58; +1 (630) 840-2783
Email&#58; parag@....
=============================================================

On Fri, 2010-01-08 at 16&#58;12 +0000, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font>
</div><script type='text/javascript'>
        $('#show_251124407').click(function() {
            $('#detail_251124407').slideDown("normal");
            $('#show_251124407').hide();
            $('#hide_251124407').show();
        });
        $('#hide_251124407').click(function() {
            $('#detail_251124407').slideUp();
            $('#hide_251124407').hide();
            $('#show_251124407').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='7913#1262967137'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2010-01-08T16:12:17+00:00">Jan 8, 2010 04:12 PM UTC</time> by <b>Arvind Gopu</b><a class="anchor" name="1262967137">&nbsp;</a></div><pre>Parag,

Would you like us to request logs from one or more admins running a 32-bit CE? We will be happy to try ... though we may need help identifying a couple of the sites.

Thanks!
-ag</pre></div><div class='update_description'><i onclick="document.location='7913#1262793609'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2010-01-06T16:00:09+00:00">Jan 6, 2010 04:00 PM UTC</time> by <b>Parag Mhashilkar</b><a class="anchor" name="1262793609">&nbsp;</a></div><pre>Hi Xin, thanks for the logs. Unfortunately tomcat was restarted just
around the time the problem started so this may not be the best logs to
conclude much. But here is a snapshot for what happened from the
logs ...

CEMON RESTARTED&#58; Yes around same time as the problem started occuring
Also CE in eastern timezone
notificationTimeout_sec=&#34;120&#34; (?)
policy rate=&#34;300&#34; (?)
UNAME&#58;Linux gridgk01.racf.bnl.gov 2.6.9-89.0.15.ELsmp #1 SMP Sat Oct 10
05&#58;59&#58;16 EDT 2009 i686 i686 i386 GNU/Linux

REPORT TO&#58; <a href='http&#58;//is2.grid.iu.edu&#58;14001' target='_blank' rel='nofollow'>http&#58;//is2.grid.iu.edu&#58;14001</a>
FIRST ERROR MSG AT&#58; 28 Dec 2009 20&#58;03&#58;07,824
PERIODIC RETRY DURING D/W TIME&#58; EVERY ~5 min from last reported failure
TIMEOUT in Sec&#58; varies from &#62;120 sec
NEXT SUCCESSFUL ATTEMPT&#58; 29 Dec 2009 11&#58;38&#58;18,180

REPORT TO&#58; <a href='http&#58;//is1.grid.iu.edu&#58;14001' target='_blank' rel='nofollow'>http&#58;//is1.grid.iu.edu&#58;14001</a>
PERIODIC REPORTING&#58; EVERY ~5 min from failure to report to is2 with no
errors

--
Thanks & Regards
=============================================================
Parag Mhashilkar
Fermi National Accelerator Laboratory, MS 120
Wilson & Kirk Road, Batavia, IL - 60510.

Location&#58; Wilson Hall, WH863
Phone&#58; +1 (630) 840-6530
Fax&#58; +1 (630) 840-2783
Email&#58; parag@....
=============================================================

<div id='show_623437410' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_623437410'>On Wed, 2010-01-06 at 15&#58;45 +0000, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font>
</div><script type='text/javascript'>
        $('#show_623437410').click(function() {
            $('#detail_623437410').slideDown("normal");
            $('#show_623437410').hide();
            $('#hide_623437410').show();
        });
        $('#hide_623437410').click(function() {
            $('#detail_623437410').slideUp();
            $('#hide_623437410').hide();
            $('#show_623437410').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='7913#1262792706'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2010-01-06T15:45:06+00:00">Jan 6, 2010 03:45 PM UTC</time> by <b>Xin zhao</b><a class="anchor" name="1262792706">&nbsp;</a></div><pre>Hi Parag,

BNL_ATLAS_1 CE runs 32bit OS,

# uname -a
Linux gridgk01.racf.bnl.gov 2.6.9-89.0.15.ELsmp #1 SMP Sat Oct 10
05&#58;59&#58;16 EDT 2009 i686 i686 i386 GNU/Linux

I put the cemon log in this URL&#58;

<a href='http&#58;//www.usatlas.bnl.gov/' target='_blank' rel='nofollow'>http&#58;//www.usatlas.bnl.gov/</a>~xinzhao/dbg/glite-ce-monitor.log.1

Cheers,
Xin

On Wed, 2010-01-06 at 07&#58;52, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='7913#1262782353'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2010-01-06T12:52:33+00:00">Jan 6, 2010 12:52 PM UTC</time> by <b>Arvind Gopu</b><a class="anchor" name="1262782353">&nbsp;</a></div><pre>Thanks, Parag, for the thorough investigation! Wow, I&#39;d not have thought about the architecture till much later if I&#39;d investigated, glad you caught that parameter.

Do any of the admins on this ticket have a i686 architecture CE? If so, can you please share CEMon client logs with Parag for Dec 29th? If not, I can ask around elsewhere.

-ag</pre></div><div class='update_description'><i onclick="document.location='7913#1262733666'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2010-01-05T23:21:06+00:00">Jan 5, 2010 11:21 PM UTC</time> by <b>Parag Mhashilkar</b><a class="anchor" name="1262733666">&nbsp;</a></div><pre>I have attached snapshot of what was available from cemon logs from
FNAL_FERMIGRID, FNAL_GPGRID_1 and cmsosgece2

I have already mailed cemon developers some questions which might help
clarify few things. Meanwhile, only correlation I could derive from the
logs from 3 sites is that issue could be related to apis that cemon
maybe using and their behavior on i686 and x86_64 java builds

For ce that run on i686 arch, ce kept on retrying to talk to is2 every 5
mins from its last noted failure. It was successful in reporting to is1
every 5 min from the failure it had reporting to is2

For ces that run on x86_64, cemon completely stopped reporting to bdii
and there is no reference of it attempting to talk to is1/is2 between
the downtime. But some how situation cleared out for cmsosgce2 when the
tomcat was restarted. While it cleared out for gpgrid when both the bdii
servers were restored.

I could derive only so much from the logs available to me. I will need
few log files from ces that have 32 bit arch/java, to confirm my
suspicion

--
Thanks & Regards
=============================================================
Parag Mhashilkar
Fermi National Accelerator Laboratory, MS 120
Wilson & Kirk Road, Batavia, IL - 60510.

Location&#58; Wilson Hall, WH863
Phone&#58; +1 (630) 840-6530
Fax&#58; +1 (630) 840-2783
Email&#58; parag@....
=============================================================

<div id='show_772218318' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_772218318'>On Mon, 2010-01-04 at 19&#58;41 +0000, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font>
</div><script type='text/javascript'>
        $('#show_772218318').click(function() {
            $('#detail_772218318').slideDown("normal");
            $('#show_772218318').hide();
            $('#hide_772218318').show();
        });
        $('#hide_772218318').click(function() {
            $('#detail_772218318').slideUp();
            $('#hide_772218318').hide();
            $('#show_772218318').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='7913#1262634065'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2010-01-04T19:41:05+00:00">Jan 4, 2010 07:41 PM UTC</time> by <b>Steven Timm</b><a class="anchor" name="1262634065">&nbsp;</a></div><pre>Parag has login at Fermilab to the two systems in question,
fg1x1.fnal.gov (a.k.a. fermigridosg1 a.k.a. FNAL_FERMIGRID) which
reported timeouts talking to is2.grid.iu.edu,
and fnpc3x1.fnal.gov (a.k.a. fnpcosg1 a.k.a FNAL_GPGRID_1) which
mysteriously stopped trying to talk to either BDII during
the whole course of the outage.

Both of the systems recovered to normal operations without
any intervention on our part.

Steve Timm

On Mon, 4 Jan 2010, Open Science Grid FootPrints wrote&#58;

<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='7913#1262633641'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2010-01-04T19:34:01+00:00">Jan 4, 2010 07:34 PM UTC</time> by <b>Arvind Gopu</b><a class="anchor" name="1262633641">&nbsp;</a></div><pre>Parag/Tanya [via ReSS-Ops assignment on the ticket],

I believe you are aware of the context based on your conversations with Burt but I will quickly restate here for your convenience&#58;

1) Between Dec 29 00&#58;01 UTC and a timestamp when an individual admin restarted the CEMon client on their end, a small number of CEs stopped reporting data to our functional CEMon collector (is1.grid.iu.edu)
- The problem is confounded further by the fact that our second CEMon collector was completely brought down to its knees by a load spike around the same starting timestamp but I&#39;d like to first get help from you re&#58; is1 before we look into is2&#39;s problems. For the record, is2 was offline from DNS roundrobin, and therefore the outage did not affect end-users insofar as the BDII&#39;s availability is concerned.

2) Steve Timm reported on the Operations call that his CEMon client error&#39;ed out in reporting to is1&#39;s collector [while it timed out to is2&#39;s collector, as we would expect]
- Xin Zhua and Jon Bakken reported the same problem via two tickets 7895 and 7896 respectively

Can you please take a look at our collector logs and see if you see any errors/warnings around that time frame? I&#39;ve dumped them here for both our servers&#58; <a href='https&#58;//dev.grid.iu.edu/' target='_blank' rel='nofollow'>https&#58;//dev.grid.iu.edu/</a>~agopu/tmp/bdii-logs/ ... Again, we are initially most interested in knowing what happened to the reporting (From those CEs) to is1&#39;s collector.

Jon, Steve, Xin, can you please publish your CEMon client logs somewhere Parag can get it ... for that timeframe if you still have them around?

Thanks! Btw, Parag, let me know if you would like me to call and explain this whole deal.

Cheers,
-ag

Ticket-meta&#58;
I added Jon Bakken, Steve Timm, Xin Zhua (admins of CEs that also misbehaved), and Burt, Tony (GIP experts).</pre></div><div class='update_description'><i onclick="document.location='7913#1262633242'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2010-01-04T19:27:22+00:00">Jan 4, 2010 07:27 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1262633242">&nbsp;</a></div><pre>Ticket stub - will update in a second.</pre></div><legend>Similar Recent Tickets <small>modified within the last 30 days</small></legend><div id="similar_tickets"><p class="muted">No similar tickets found.</p></div>
</div>
<script type="text/javascript">
function reset_anchor() {
    $("#updates .selected").removeClass("selected");
    var urls = document.location.toString().split('#'); 
    var anchor = urls[1];
    if(anchor) {
        $("a[name='"+anchor+"']").parents(".update_description").addClass("selected");
    }
}
function submitspam(ticket_id) {
    myret = confirm("Would you like to close this ticket as a security ticket, and submit the ticket content to akismet?");
    if(myret == true) {
        $.ajax("viewer/processspam?id="+ticket_id).done(function() {
            window.location.reload();
        });
    }
}

$(function() {
    reset_anchor();
    var ADDITIONAL_COOKIE_NAME = 'gocticket';
    var options = { path: '/', expires: 365};

    if(window.opener && window.opener.name == "gocticket_list") {
        v = $.cookie("closewindow");
        if(!v) {
            $("#closewindow").attr("checked", "checked"); //on by default
        } else {
            if(v == "checked") {
                $("#closewindow").attr("checked", "checked");
            }
        }
        $("#closewindow").click(function() {
            $.cookie("closewindow", $(this).attr('checked'), options);
        });
    } else {
        $("#closewindow_area").hide();
    }
    function updateTimeago() {
        $("time").timeago();
        setTimeout(updateTimeago, 30*1000);
    }
    updateTimeago();
    $(".description").focus(expand_description);
});
</script>
<hr/>
<footer>
<p>GOC Ticket Version 2.2 | <a href="https://ticket.opensciencegrid.org/goc/submit?app_issue_check=on&amp;app_issue_type=goc&amp;app_goc_url=https%3A%2F%2Fticket.opensciencegrid.org%3A443%2F7913">Report Bugs</a>
 | <a href="https://github.com/opensciencegrid/operations/blob/master/docs/privacy.md">Privacy Policy</a>
</p>

<p> <img align="top" src="images/tag_orange.png"/> Copyright 2018 The Trustees of Indiana University - Developed for Open Science Grid</p>
</footer>


</div><!--container-fluid-->
<script src="https://ticket1.grid.iu.edu:8443/socket.io/socket.io.js"></script>
<script>
var chat = io.connect('https://ticket1.grid.iu.edu:8443');
chat.on('connect', function() {
    chat.emit('authenticate', {nodekey:'', ticketid: 7913});
});
chat.on('peers', function(peers) {
    $("#peers").html("");
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('peer_disconnect', function(pid) {
    $("#peer_"+pid).hide("slow");
});
chat.on('peer_connected', function(peers) {
    //expect only 1 peer connecting, but..
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('submit', function() {
    if(confirm("This ticket was updated. Do you want to refresh?")) {
        history.go(0);
    }
});

function addPeer(pid, peer) {
    var ipinfo = "";
    if(peer.ip != undefined) {
        ipinfo = "<span class=\"ip\">"+peer.ip+"</span>";
    }
    if(chat.io.engine.id == pid) {
        //don't display myself
        return;
    }
    var html = "<li class=\"new\" id=\"peer_"+pid+"\" class=\"peer\">"+peer.name+ipinfo+"</li>";
    $("#peers").prepend(html);
    $("#peers .new").animate({bottom: 0}, 1000, function() {$(this).removeClass("new")});
}

$(function() {
    $("#ticket_form").submit(function() {
        chat.emit('submit');
        return true;
    });
});
</script>
<script>
//used by searchbox
function parseValue(value) {
    var obj = new Object();
    var tokens = value.split("\t");
    obj.str = tokens[0];
    obj.count = tokens[1];
    return obj;
}

$(function() {
    //bootstrap-2.0.4 stuff
    $(".alert-message").alert();
    $(".dropdown-toggle").dropdown();
    $("span[rel='tooltip']").tooltip();
    $("a[rel=popover]").popover();

    //activate menu that user is currently on
    $("#menu_navigator").addClass("active"); 
    $("#submenu_").addClass("active"); 

    //translate zend validation error message to bootstrap
    $(".errors").addClass("alert").addClass("alert-error");

    //enable autocomplete for search box
    $("#search").autocomplete({
        source: function( request, response ) {
            $.ajax({
                url: "search/autocomplete",
                dataType: "text",
                data: {
                    //featureClass: "P",
                    //style: "full",
                    //maxRows: 12,
                    //name_startsWith: request.term
                    q: request.term
                },
                success: function( data ) {
                    response( $.map( data.split("\n"), function( item ) {
                        if(item == "") return null;
                        return {
                            value: item
                        }
                    }));
                }
            });
        },
        select: function(event, ui) {
            document.location = "search?q="+ui.item.value;
        }
    });
    
});
</script>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-69012-13");
pageTracker._trackPageview();
} catch(err) {}
</script>

</body>
