<!DOCTYPE html>
<html lang="en">
  <head>
  <base href="">
    <title>[31224] Gratia catch-up for NET2_HU after Harvard switched to HTCONDOR-CE</title>    <meta charset="utf-8" />
    <meta name="verify-v1" content="na5IcAJsZVOfEkboRxuIiZ1zpZgnZiWra+nKcS7nA/o=" />
    <meta name="google-site-verification" content="DLrk3ft4s8b-S2TloLCL2LD_t6wcTjgSluf5pmiu2kA" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />
    <link href="https://ticket.opensciencegrid.org/rss" rel="alternate" type="application/rss+xml" title="GOC Ticket Update feed" />

    <style type="text/css">
      body {
        padding-top: 50px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
     #search {
            width: 300px;
     }

    </style>

<script src="https://code.jquery.com/jquery-3.0.0.js"></script>
<script src="https://code.jquery.com/jquery-migrate-3.0.1.js"></script>

   <link href="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet"/>
    <script src="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/js/bootstrap.min.js"></script>

    <link href="https://netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"/>
    <link href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/themes/smoothness/jquery-ui.min.css" rel="stylesheet"/>
 <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>


    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/js/select2.min.js"></script>

    <link href="css/ticket.css" rel="stylesheet" />
    <script src="lib/jquery.cookie.js"></script>

    <link href="images/tag_orange.png" rel="icon" type="image/png"/>
    <script src='https://www.google.com/recaptcha/api.js'></script>
  </head>

  <body>
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>

            <a class="brand" style="padding: 6px 0px 0px 6px;" href="http://opensciencegrid.org"><img src="images/osglogo.40x30.png"/></a>
            <ul class="nav">
                <li class="dropdown"><a href="https://ticket.opensciencegrid.org/#" class="dropdown-toggle" data-toggle="dropdown">GOC Ticket <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    <li><a href="https://my.opensciencegrid.org">MyOSG</a></li>
                    <li><a href="https://oim.opensciencegrid.org">OIM</a></li>
                    <li class="active"><a href="https://ticket.opensciencegrid.org/index">Ticket</a></li>
	<li class="divider"></li>
	<li><a href="http://repo.grid.iu.edu">Repo</a></li>
	<li class="divider"></li>
	<li><a href="http://blogs.grid.iu.edu">Blog</a></li>
                    <li><a href="http://display.grid.iu.edu">Display</a></li>
                    <li><a href="http://osggoc.blogspot.com/">News</a></li>
                    </ul>
                </li>
            </ul>
            <ul class="nav pull-right">
                <li><a href="https://ticket.opensciencegrid.org/sso/">Login</a></li>            </ul>

            <div class="nav-collapse">
                <ul class="nav">
			 <li id="menu_submit"><a href="https://ticket.opensciencegrid.org/submit">Submit</a></li><li id="menu_view" class="dropdown"><a href="https://ticket.opensciencegrid.org/\#" class="dropdown-toggle" data-toggle="dropdown">View <b class="caret"></b></a><ul class="dropdown-menu"><li id="submenu_listopen"><a href="https://ticket.opensciencegrid.org/list/open">Open Tickets</a></li><li id="submenu_listrecentclose"><a href="https://ticket.opensciencegrid.org/list/recentclose">Recently Closed Tickets</a></li><li class="divider"></li><li id="submenu_alltickets"><a href="https://ticket.opensciencegrid.org/search?q=&amp;sort=id">All Tickets</a></li></ul></li>                </ul>

                <form class="navbar-search pull-right" action="https://ticket.opensciencegrid.org/viewer">
                    <input id="search" type="text" name="id" class="search-query span2" placeholder="Search Ticket" value=""/>
                </form>
            </div>
        </div>
      </div>
    </div>

<script type='text/javascript' src='lib/jquery.timeago.js'></script>
<script type='text/javascript' src='lib/byte2size.js'></script>
<style>
#updates .toolbar {
position: relative;
margin-top: 0px;
top: -10px;
font-weight: normal;
}
#updates a.anchor {
position: relative;
top: -50px;
}
#updates .selected pre {
animation:selected 2s;
animation-iteration-count: 2;
animation-direction: alternate;
-webkit-animation:selected 2s; 
-webkit-animation-iteration-count: 2;
-webkit-animation-direction: alternate;
box-shadow: inset 1px 1px 20px #9ad;
border: 1px solid #9ab;
margin: 5px 0px;
padding-left: 10px;
}
@keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ab;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
@-webkit-keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ad;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
#updates pre {
background-color: inherit;
line-height: 15px;
padding: 5px;
}
#updates .header {
color: #999;
}
#updates .update_history pre {
background-color: #eee;
color: #666;
font-size: 85%;
}
#updates .clickable {
cursor: pointer;
}
#updates .clickable:hover {
color: #D98719;
}
#updates .meta_information pre {
background-color: #fed;
}
#similar_tickets {
max-height: 300px;
overflow-y: auto;
pointer-events: none;
padding: 5px;
background-color: #f4f4f4;
}
.btn-toolbar {
margin-bottom: 0;
height: 30px;
}
#peers {
position: fixed;
bottom: 0px;
right: 0px;
z-index: 100;
list-style: none;
padding: 5px 0px 0px 5px;
margin: 0px;
background-color: white;
box-shadow: 0px 0px 10px white;
}
#peers li {
background-color: #ccc;
color: #000;
display: inline-block;
padding: 5px 10px;
margin-right: 5px;
position: relative;
}
/*
#peers li:hover {
background-color: #999;
cursor: pointer;
}
*/
#peers span.ip {
padding-left: 5px;
color: #666;
}
#peers .new {
bottom: -30px;
}
/*
#peers .me {
background-color: red;
}
*/
</style>

<div class="container-fluid">
<ul id="peers"></ul>
<div class="alert alert-danger"><a class="close" href="https://ticket.opensciencegrid.org/#" data-dismiss="alert">&times;</a>By the end of May 2018, the ticketing system at https://ticket.opensciencegrid.org will be retired and support will be provided at https://support.opensciencegrid.org. Throughout this transition the support email (help@opensciencegrid.org) will be available as a point of contact.<br><br>                                                   
                                                                                                                                                                                   
Please see the service migration page for details: https://opensciencegrid.github.io/technology/policy/service-migrations-spring-2018/#ticket</div><div id="presence" class="pull-right"></div><div class="ticketgui"><script type="text/javascript" src="lib/checktab.js"></script>

<script>
var expanded = false;
function expand_description() {
    var desc = $(".description");
    if(!expanded) {
        expanded = true;
        //expand to minheight
        var min = 250;
        if(desc.height() < min) {
            desc.animate({height: min}, 200);
        }
    }
}

$(document).ready(function() {
    $("input[name='nad']").datepicker({
        dateFormat: 'yy-mm-dd'
    });
});

</script>



<style>
.form-horizontal .control-label {
padding-top: inherit;
font-size:90%;
color:#666;
}
label {
margin-bottom: 0px;
}
.controls {
line-height: 18px;
}
</style>
<form class="form-horizontal" action="https://ticket.opensciencegrid.org/viewer/updatebasic?id=31224" method="post">
<div class="page-header">
    <h3><span class="muted">31224</span> / Gratia catch-up for NET2_HU after Harvard switched to HTCONDOR-CE</h3>
</div>

<div class="row-fluid">
<div class="span5">
    <legend>Contact</legend>
    <div class="control-group">
        <label class="control-label">Full Name</label>
        <div class="controls">Saul Youssef</div>
    </div>
    <div class="control-group">
        <label class="control-label">Email</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">Phone</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">CC</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>

    <legend>Details</legend>
    <div class="control-group"><label class="control-label">Resource Name</label><div class="controls">NET2_HU</div></div><div class="control-group"><label class="control-label">Associated VO</label><div class="controls">ATLAS</div></div><div class="control-group"><label class="control-label">Submitted Via</label><div class="controls">GOC Ticket/submit</div></div><div class="control-group"><label class="control-label">Submitter</label><div class="controls">Saul Youssef</div></div><div class="control-group"><label class="control-label">Support Center</label><div class="controls">USATLAS</div></div><div class="control-group"><label class="control-label">Ticket Links</label><div class="controls"></div></div>
    <div class="control-group">
        <label class="control-label">Ticket Type</label>
        <div class="controls">Problem/Request</div>
    </div>
    <div class="control-group">
        <label class="control-label">Priority</label>
        <div class="controls">Normal</div>
    </div>
    <div class="control-group">
        <label class="control-label">Status</label>
        <div class="controls">
Closed</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action</label>
        <div class="controls">Software Triage</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action Deadline</label>
        <div class="controls flag_red">2016-09-21</div>
    </div>

</div><!--span-->
<div class="span7">
    <legend>Assignees</legend>
    <div class="assignee" style="width: 60%">USATLAS (BNL Prod)&nbsp;<a target="_blank" href="https://rt.racf.bnl.gov/rt/Ticket/Display.html?id=26449">26449</a> <span class="muted"> / Ticket Exchange</span></div><div class="assignee" style="width: 60%">Software Support (Triage) <span class="muted"> / OSG Software Team</span></div><div class="assignee" style="width: 60%">Carl Edquist <span class="muted"> / OSG Software Team</span></div>    <br>

    <legend>Assignees</legend>
    TODO
    <br>

    <style>
legend.noborder {
border-bottom: none;
}
</style>

<div id="attachment-list"/>
<script>
$(function () {
    var first = true;
    $.getJSON("https://ticket.opensciencegrid.org/attachment/list?id=31224", function (files) {
        //console.dir(files);
        var html = "<table class=\"table table-condensed\">";
        $(files).each(function() {
            if(first) {
                first = false;
                html += "<legend class=\"noborder\">Attachmenets</legend>";
            }
            html += "<tr class=\"attachment\">";
            html += "<td><img src="https://ticket.opensciencegrid.org/\&quot;&quot;+this.thumbnail_url+&quot;\&quot;/"></td>";
            html += "<td><a href="https://ticket.opensciencegrid.org/\&quot;&quot;+this.url+&quot;\&quot;" target=\"_blank\">"+this.name+"</a></td>";
            html += "<td>"+bytesToSize(this.size, 1)+"</td>";
            html += "</tr>";
        });
        html += "</table>";
        $("#attachment-list").html(html);
    });
});

function download(url) {
    window.open(url, "_blank");
}
</script>


</div><!--span-->
</div><!--row-fluid-->


</form>

</div>
<div id="updates" style="clear: both;">
    <legend>Past Updates
    <div class="btn-toolbar pull-right toolbar">
        <div class="btn-group">
                <a class="btn btn-small" href="https://ticket.opensciencegrid.org/31224?sort=up&amp;"><i class="icon-arrow-up"></i> Sort</a>

        
        <a class="btn btn-small" href="https://ticket.opensciencegrid.org/31224?expandall=true&amp;">Expand Descriptions</a>        <a class="btn btn-small" target="_blank" href="mailto:osg@tick.globalnoc.iu.edu?subject=Open%20Science%20Grid%3A%20Gratia%20catch-up%20for%20NET2_HU%20after%20Harvard%20switched%20to%20HTCONDOR-CE%20ISSUE%3D31224%20PROJ%3D71"><i class="icon-envelope"></i> Update w/Email</a>
        </div>
    </div><!--btn-toolbar-->
    </legend>

    <div class='update_description'><i onclick="document.location='31224#1474469859'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-09-21T14:57:39+00:00">Sep 21, 2016 02:57 PM UTC</time> by <b>Christopher Pipes</b><a class="anchor" name="1474469859">&nbsp;</a></div><pre>Thank you for informing us that this issue has been resolved. I will close this ticket.  Please submit problems, requests, and questions at&#58; <a href='https&#58;//ticket.grid.iu.edu/goc/open' target='_blank' rel='nofollow'>https&#58;//ticket.grid.iu.edu/goc/open</a> OSG Grid Operations Center goc@...., 317-278-9699 Visit the OSG Operations Page&#58; <a href='http&#58;//osggoc.blogspot.com/' target='_blank' rel='nofollow'>http&#58;//osggoc.blogspot.com/</a></pre></div><div class='update_description'><i onclick="document.location='31224#1474465321'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-09-21T13:42:01+00:00">Sep 21, 2016 01:42 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1474465321">&nbsp;</a></div><pre>Thanks to Carl or whoever did the fix. There are still some gaps in August
where we were running, but since all the recent results seem to be fine, I&#39;d
suggest that we declare victory. I&#39;ve asked WLCG to pull the new data and
recompute the contribution from HU_ATLAS_Tier2 for August.

Thanks everyone for the help, especially Horst.

- Saul, Augustine, Scott

On Tue Sep 20 16&#58;32&#58;37 2016, youssef@.... wrote&#58;
<font color='#7F7E6F'>&#62; On Tue Sep 20 11&#58;17&#58;11 2016, osg-goc-rest wrote&#58;</font>
<font color='#7F7E6F'>&#62; &#62; Carl, could you take a look at this ticket and check out things on</font>
<font color='#7F7E6F'>&#62; the</font>
<font color='#7F7E6F'>&#62; &#62; server side to see if we&#39;re receiving records?</font>
<font color='#7F7E6F'>&#62; &#62;</font>
<font color='#7F7E6F'>&#62; &#62; Thanks,</font>
<font color='#7F7E6F'>&#62; &#62; Brian</font>
<font color='#7F7E6F'>&#62; &#62; -- by Brian Lin at Tue Sep 20 15&#58;16&#58;45 UTC 2016</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; It looks like at least part of the accounting has reached OSG.</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; <a href='http&#58;//gratiaweb.grid.iu.edu/gratia/site?starttime=2016-07-' target='_blank' rel='nofollow'>http&#58;//gratiaweb.grid.iu.edu/gratia/site?starttime=2016-07-</a></font>
<font color='#7F7E6F'>&#62; 06+20%3A27%3A35&endtime=2016-09-</font>
<font color='#7F7E6F'>&#62;</font>
20+20%3A27%3A35&span=86400&relativetime=absolute&facility=%5ENET2_HU%24&exclude-
<font color='#7F7E6F'>&#62; facility=&vo=&exclude-vo=&user=&exclude-dn=</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; Yay.</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; - Saul</font>
-- by youssef@.... at Wed Sep 21 13&#58;41&#58;51 UTC 2016

GOCTX Source&#58; BNL Ticket&#58; Queue=NETier2 ID=26449</pre></div><div class='update_description'><i onclick="document.location='31224#1474403567'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-09-20T20:32:47+00:00">Sep 20, 2016 08:32 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1474403567">&nbsp;</a></div><pre>On Tue Sep 20 11&#58;17&#58;11 2016, osg-goc-rest wrote&#58;
<font color='#7F7E6F'>&#62; Carl, could you take a look at this ticket and check out things on the</font>
<font color='#7F7E6F'>&#62; server side to see if we&#39;re receiving records?</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; Thanks,</font>
<font color='#7F7E6F'>&#62; Brian</font>
<font color='#7F7E6F'>&#62; -- by Brian Lin at Tue Sep 20 15&#58;16&#58;45 UTC 2016</font>

It looks like at least part of the accounting has reached OSG.

<a href='http&#58;//gratiaweb.grid.iu.edu/gratia/site?starttime=2016-07-06+20%3A27%3A35&endtime=2016-09-20+20%3A27%3A35&span=86400&relativetime=absolute&facility=%5ENET2_HU%24&exclude-facility=&vo=&exclude-vo=&user=&exclude-dn=' target='_blank' rel='nofollow'>http&#58;//gratiaweb.grid.iu.edu/gratia/site?starttime=2016-07-06+20%3A27%3A35&endtime=2016-09-20+20%3A27%3A35&span=86400&relativetime=absolute&facility=%5ENET2_HU%24&exclude-facility=&vo=&exclude-vo=&user=&exclude-dn=</a>

Yay.

- Saul
-- by youssef@.... at Tue Sep 20 20&#58;32&#58;37 UTC 2016

GOCTX Source&#58; BNL Ticket&#58; Queue=NETier2 ID=26449</pre></div><div class='update_description'><i onclick="document.location='31224#1474384605'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-09-20T15:16:45+00:00">Sep 20, 2016 03:16 PM UTC</time> by <b>Brian Lin</b><a class="anchor" name="1474384605">&nbsp;</a></div><pre>Carl, could you take a look at this ticket and check out things on the server side to see if we&#39;re receiving records?

Thanks,
Brian</pre></div><div class='update_description'><i onclick="document.location='31224#1474311609'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-09-19T19:00:09+00:00">Sep 19, 2016 07:00 PM UTC</time> by <b>Christopher Pipes</b><a class="anchor" name="1474311609">&nbsp;</a></div><pre>Hello Everyone,

Does anyone have a status update for this? Is this working as expected now or is there still more work that needs to be finished first?

Thanks,
Chris</pre></div><div class='update_description'><i onclick="document.location='31224#1474311411'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-09-19T18:56:51+00:00">Sep 19, 2016 06:56 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1474311411">&nbsp;</a></div><pre>Hi Scott,

I think the important number here should be

new records sent successfully&#58; 24

and maybe

records reprocessed successfully&#58; 99

I don&#39;t understand why that information isn&#39;t showing up here, though&#58;

<a href='http&#58;//gratiaweb.grid.iu.edu/gratia/site?facility=NET2_HU' target='_blank' rel='nofollow'>http&#58;//gratiaweb.grid.iu.edu/gratia/site?facility=NET2_HU</a>

Every time we had problems with our Gratia in the past, the new sent
records did show up there.

Can Gratia experts please have a look on the server to see whether
these
new sent records are actually arriving on the server side?

Thanks,

Horst

-- by hs@.... at Mon Sep 19 18&#58;56&#58;40 UTC 2016

GOCTX Source&#58; BNL Ticket&#58; Queue=NETier2 ID=26449</pre></div><div class='update_description'><i onclick="document.location='31224#1474310798'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-09-19T18:46:38+00:00">Sep 19, 2016 06:46 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1474310798">&nbsp;</a></div><pre>I do see a lot of these in the /var/log/gratia/

14&#58;42&#58;02 EDT Gratia&#58; Creating a UsageRecord 2016-09-19T18&#58;42&#58;02Z
14&#58;42&#58;02 EDT Gratia&#58;
***********************************************************
14&#58;42&#58;02 EDT Gratia&#58; ERROR&#58; unable to find valid certinfo file for job
67030087
14&#58;42&#58;02 EDT Gratia&#58; Info&#58; suppressing record with GlobalJobId
slurm&#58;holy-slurm02/3306/slurm/odyssey.67030087 due to unknown or null
VOName, will be quarantined in /var/lib/gratia/data/quarantine
14&#58;42&#58;02 EDT Gratia&#58; OK&#58; No unsuppressed usage records in this packet&#58;
not sending
14&#58;42&#58;02 EDT Gratia&#58;
***********************************************************

Here is an example of the execution summary&#58;

00&#58;18&#58;51 EDT Gratia&#58; End of execution summary&#58; new records sent
successfully&#58; 24
00&#58;18&#58;51 EDT Gratia&#58;                           new records suppressed&#58;
17528
00&#58;18&#58;51 EDT Gratia&#58;                           new records failed&#58; 99
00&#58;18&#58;51 EDT Gratia&#58;                           records reprocessed
successfully&#58; 99
00&#58;18&#58;51 EDT Gratia&#58;                           reprocessed records
failed&#58; 1
00&#58;18&#58;51 EDT Gratia&#58;                           handshake records sent
successfully&#58; 1
00&#58;18&#58;51 EDT Gratia&#58;                           handshake records
failed&#58; 0
00&#58;18&#58;51 EDT Gratia&#58;                           bundle of records sent
successfully&#58; 2
00&#58;18&#58;51 EDT Gratia&#58;                           bundle of records
failed&#58; 1
00&#58;18&#58;51 EDT Gratia&#58;                           outstanding records&#58;
<div id='show_1434357752' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_1434357752'>100
00&#58;18&#58;51 EDT Gratia&#58;                           outstanding staged
records&#58; 0
00&#58;18&#58;51 EDT Gratia&#58;                           outstanding records tar
files&#58; 0
00&#58;18&#58;51 EDT Gratia&#58; End-of-execution disconnect ���

The values for the various states are all over the place when I look
throughout the day.  Sometime all 0.

~Scott
==================================
Dr. Scott Yockel | Senior Team Lead of HPC
FAS Research Computing | Harvard University
38 Oxford Street Cambridge, MA
Office&#58; 211A | Phone&#58; 617-496-7468
==================================

<font color='#7F7E6F'>&#62; On Sep 19, 2016, at 2&#58;30 PM, OSG GOC TX via RT &#60;RT-RACF@....&#62;</font>
wrote&#58;
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;    Ticket ID&#58; [rt.racf.bnl.gov #26449]</font>
<font color='#7F7E6F'>&#62;   Requestors&#58; tx+rtbnlprod_fp71@....</font>
<font color='#7F7E6F'>&#62;        Queue&#58; NETier2</font>
<font color='#7F7E6F'>&#62;        Owner&#58; Saul Youssef</font>
<font color='#7F7E6F'>&#62;       Status&#58; open</font>
<font color='#7F7E6F'>&#62;     Priority&#58; Low</font>
<font color='#7F7E6F'>&#62;  Transaction&#58; Correspondence added by osg-goc-rest</font>
<font color='#7F7E6F'>&#62;      Subject&#58; Gratia catch-up for NET2_HU after Harvard switched to</font>
HTCONDOR-CE
<font color='#7F7E6F'>&#62;           OSG GOC Ticket&#58; 31224</font>
&#60;<a href='https&#58;//ticket.grid.iu.edu/goc/viewer?id=31224&#62' target='_blank' rel='nofollow'>https&#58;//ticket.grid.iu.edu/goc/viewer?id=31224&#62</a>;
<font color='#7F7E6F'>&#62;      Resource Group Name&#58; HU_ATLAS_Tier2</font>
<font color='#7F7E6F'>&#62;                  VO Name&#58; ATLAS</font>
<font color='#7F7E6F'>&#62;            Resource Name&#58; NET2_HU</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; Hi Saul,</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; I&#39;ve been looking here&#58;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; <a href='http&#58;//gratiaweb.grid.iu.edu/gratia/site?facility=OU_OSCER_ATLAS' target='_blank' rel='nofollow'>http&#58;//gratiaweb.grid.iu.edu/gratia/site?facility=OU_OSCER_ATLAS</a></font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; But I&#39;m pretty sure that that&#39;s displaying the same data as your</font>
myosg
<font color='#7F7E6F'>&#62; link, so I don&#39;t think that&#39;ll help you much.</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; RIght, here&#39;s the corresponding link&#58;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; <a href='http&#58;//gratiaweb.grid.iu.edu/gratia/site?starttime=2016-06-' target='_blank' rel='nofollow'>http&#58;//gratiaweb.grid.iu.edu/gratia/site?starttime=2016-06-</a></font>
<font color='#7F7E6F'>&#62; 23+18%3A24%3A14&endtime=2016-09-</font>
<font color='#7F7E6F'>&#62;</font>
19+18%3A24%3A14&span=86400&relativetime=absolute&facility=^NET2_HU%24&exclude-
<font color='#7F7E6F'>&#62; facility=&vo=&exclude-vo=&user=&exclude-dn=</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; So it looks like HU reported until July 20 or so, and then around</font>
<font color='#7F7E6F'>&#62; August 15 for two days, and then nothing again.</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; Cheers,</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;     Horst</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=Horst</font>
<font color='#7F7E6F'>&#62; Severini 27</font>
<font color='#7F7E6F'>&#62;  -- by goc at Mon Sep 19 18&#58;29&#58;45 UTC 2016</font>

-- by syockel@.... at Mon Sep 19 18&#58;46&#58;12 UTC 2016

GOCTX Source&#58; BNL Ticket&#58; Queue=NETier2 ID=26449
</div><script type='text/javascript'>
        $('#show_1434357752').click(function() {
            $('#detail_1434357752').slideDown("normal");
            $('#show_1434357752').hide();
            $('#hide_1434357752').show();
        });
        $('#hide_1434357752').click(function() {
            $('#detail_1434357752').slideUp();
            $('#hide_1434357752').hide();
            $('#show_1434357752').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='31224#1474309785'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-09-19T18:29:45+00:00">Sep 19, 2016 06:29 PM UTC</time><a class="anchor" name="1474309785">&nbsp;</a></div><pre>Hi Saul,

I&#39;ve been looking here&#58;

<a href='http&#58;//gratiaweb.grid.iu.edu/gratia/site?facility=OU_OSCER_ATLAS' target='_blank' rel='nofollow'>http&#58;//gratiaweb.grid.iu.edu/gratia/site?facility=OU_OSCER_ATLAS</a>

But I&#39;m pretty sure that that&#39;s displaying the same data as your myosg link, so I don&#39;t think that&#39;ll help you much.

RIght, here&#39;s the corresponding link&#58;

<a href='http&#58;//gratiaweb.grid.iu.edu/gratia/site?starttime=2016-06-23+18%3A24%3A14&endtime=2016-09-19+18%3A24%3A14&span=86400&relativetime=absolute&facility=' target='_blank' rel='nofollow'>http&#58;//gratiaweb.grid.iu.edu/gratia/site?starttime=2016-06-23+18%3A24%3A14&endtime=2016-09-19+18%3A24%3A14&span=86400&relativetime=absolute&facility=</a>^NET2_HU%24&exclude-facility=&vo=&exclude-vo=&user=&exclude-dn=

So it looks like HU reported until July 20 or so, and then around August 15 for two days, and then nothing again.

Cheers,

Horst

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=Horst Severini 27</pre></div><div class='update_description'><i onclick="document.location='31224#1474307652'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-09-19T17:54:12+00:00">Sep 19, 2016 05:54 PM UTC</time> by <b>Saul Youssef</b><a class="anchor" name="1474307652">&nbsp;</a></div><pre>Hi Horst,

I&#39;m still seeing nothing in the accounting portal&#58;

<a href='https&#58;//myosg.grid.iu.edu/rgaccount/index?summary_attrs_showservice=on&summary_attrs_showrsvstatus=on&summary_attrs_showfqdn=on&gip_status_attrs_showtestresults=on&downtime_attrs_showpast=&account_type=daily_hours_byvo&ce_account_type=gip_vo&se_account_type=vo_transfer_volume&bdiitree_type=total_jobs&bdii_object=service&bdii_server=is-osg&start_type=specific&start_date=06%2F23%2F2016&end_type=now&end_date=09%2F23%2F2013&facility=on&facility_sel%5B%5D=10053&gridtype=on&gridtype_1=on&active=on&active_value=1&disable_value=1' target='_blank' rel='nofollow'>https&#58;//myosg.grid.iu.edu/rgaccount/index?summary_attrs_showservice=on&summary_attrs_showrsvstatus=on&summary_attrs_showfqdn=on&gip_status_attrs_showtestresults=on&downtime_attrs_showpast=&account_type=daily_hours_byvo&ce_account_type=gip_vo&se_account_type=vo_transfer_volume&bdiitree_type=total_jobs&bdii_object=service&bdii_server=is-osg&start_type=specific&start_date=06%2F23%2F2016&end_type=now&end_date=09%2F23%2F2013&facility=on&facility_sel%5B%5D=10053&gridtype=on&gridtype_1=on&active=on&active_value=1&disable_value=1</a>

Is that where you are looking for OU data?

- Saul

On Mon, Sep 19, 2016 at 12&#58;47 PM, Open Science Grid FootPrints &#60;
osg@....&#62; wrote&#58;

<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='31224#1474303741'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-09-19T16:49:01+00:00">Sep 19, 2016 04:49 PM UTC</time><a class="anchor" name="1474303741">&nbsp;</a></div><pre>I meant to say a scheduled site wide power outage at Fermilab, sorry.

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=Horst Severini 27</pre></div><div class='update_description'><i onclick="document.location='31224#1474303659'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-09-19T16:47:39+00:00">Sep 19, 2016 04:47 PM UTC</time><a class="anchor" name="1474303659">&nbsp;</a></div><pre>Hi Saul,

the Gratia collectors were down this weekend because of a site wide power outage. But now things are moving again, and I can see new data appearing for the OU sites. Are you still not seeing any new data for HU?

Cheers,

Horst

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=Horst Severini 27</pre></div><div class='update_description'><i onclick="document.location='31224#1474300475'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-09-19T15:54:35+00:00">Sep 19, 2016 03:54 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1474300475">&nbsp;</a></div><pre>Hi Scott, OSG

Something seems to still be broken. A couple of days of Gratia data did show up
at the OSG end, but only a couple of days (Harvard has been running steadily
for all of August, for instance).

<a href='http&#58;//egg.bu.edu/NET2%7binf&#58' target='_blank' rel='nofollow'>http&#58;//egg.bu.edu/NET2%7binf&#58</a>;NET2%7d/gadget&#58;Studies/section&#58;report/2016-09/HU_gratia_broken/

Can you confirm that nothing is broken in the local Gratia logs? Can we detect
a problem at the OSG end?

OSG guys&#58; I&#39;m also having trouble seeing what&#39;s going on via the Gratia
accounting portal. (see item #3 at the above web site). Is there a way to get
at the data behind the plots more directly?

- Saul

On Thu Sep 15 15&#58;10&#58;12 2016, osg-goc-rest wrote&#58;
<font color='#7F7E6F'>&#62; I think after adding the grant to the db for net2 that it is working.</font>
<font color='#7F7E6F'>&#62; Just tested like we did yesterday with the ProbeConfig in</font>
<font color='#7F7E6F'>&#62; /usr/share/gratia/slurm and then launching ./slurm_meter -v -f</font>
<font color='#7F7E6F'>&#62; ./ProbeConfig.</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; This no longer yields the Python traceback to the slurm values that</font>
<font color='#7F7E6F'>&#62; were set. It also it connecting to the slurmDB.</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; Now I???ll add this config to the /etc/osg/config.d/20-slurm.ini and</font>
<font color='#7F7E6F'>&#62; enable the cron job for slurm, but leave the pbs-lfs not running.</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; I???ll sync up with Augustine later to make sure I???ve done this all</font>
<font color='#7F7E6F'>&#62; right.</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; 13&#58;22&#58;07 EDT Gratia&#58;</font>
<font color='#7F7E6F'>&#62; ***********************************************************</font>
<font color='#7F7E6F'>&#62; 13&#58;22&#58;07 EDT Gratia&#58; Removing log files older than 31 days from</font>
<div id='show_1852256882' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_1852256882'><font color='#7F7E6F'>&#62; /var/log/gratia</font>
<font color='#7F7E6F'>&#62; 13&#58;22&#58;07 EDT Gratia&#58; /var/log/gratia uses 0.158% and there is 49% free</font>
<font color='#7F7E6F'>&#62; 13&#58;22&#58;07 EDT Gratia&#58; Removing incomplete data files older than 31 days</font>
<font color='#7F7E6F'>&#62; from /var/lib/gratia/data/</font>
<font color='#7F7E6F'>&#62; 13&#58;22&#58;07 EDT Gratia&#58; /var/lib/gratia/data uses 0.003% and there is 37%</font>
<font color='#7F7E6F'>&#62; free</font>
<font color='#7F7E6F'>&#62; 13&#58;22&#58;08 EDT Gratia&#58; Removing quarantines data files older than 31</font>
<font color='#7F7E6F'>&#62; days from /var/lib/gratia/data/quarantine</font>
<font color='#7F7E6F'>&#62; 13&#58;22&#58;08 EDT Gratia&#58; Removing quarantines data files older than 31</font>
<font color='#7F7E6F'>&#62; days from</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; /var/lib/gratia/data/quarantine/subdir.pbs_net2.rc.fas.harvard.edu_gratia-</font>
<font color='#7F7E6F'>&#62; osg-prod.opensciencegrid.org_80</font>
<font color='#7F7E6F'>&#62; 13&#58;22&#58;08 EDT Gratia&#58;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; /var/lib/gratia/data/quarantine/subdir.pbs_net2.rc.fas.harvard.edu_gratia-</font>
<font color='#7F7E6F'>&#62; osg-prod.opensciencegrid.org_80 uses 0% and there is 37% free</font>
<font color='#7F7E6F'>&#62; 13&#58;22&#58;08 EDT Gratia&#58; Removing quarantines data files older than 31</font>
<font color='#7F7E6F'>&#62; days from</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; /var/lib/gratia/data/quarantine/subdir.lsf_net2.rc.fas.harvard.edu_gratia-</font>
<font color='#7F7E6F'>&#62; osg-prod.opensciencegrid.org_80</font>
<font color='#7F7E6F'>&#62; 13&#58;22&#58;08 EDT Gratia&#58; Removing quarantines data files older than 31</font>
<font color='#7F7E6F'>&#62; days from /var/lib/gratia/data/quarantine/subdir.gridftp-</font>
<font color='#7F7E6F'>&#62; transfer_net2.rc.fas.harvard.edu_gratia-osg-</font>
<font color='#7F7E6F'>&#62; transfer.opensciencegrid.org_80</font>
<font color='#7F7E6F'>&#62; 13&#58;22&#58;08 EDT Gratia&#58; Removing quarantines data files older than 31</font>
<font color='#7F7E6F'>&#62; days from</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; /var/lib/gratia/data/quarantine/subdir.slurm_net2.rc.fas.harvard.edu_gratia-</font>
<font color='#7F7E6F'>&#62; osg-prod.opensciencegrid.org_80</font>
<font color='#7F7E6F'>&#62; 13&#58;22&#58;08 EDT Gratia&#58;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; /var/lib/gratia/data/quarantine/subdir.slurm_net2.rc.fas.harvard.edu_gratia-</font>
<font color='#7F7E6F'>&#62; osg-prod.opensciencegrid.org_80 uses 0.003% and there is 37% free</font>
<font color='#7F7E6F'>&#62; 13&#58;22&#58;08 EDT Gratia&#58; End of execution summary&#58; new records sent</font>
<font color='#7F7E6F'>&#62; successfully&#58; 39</font>
<font color='#7F7E6F'>&#62; 13&#58;22&#58;08 EDT Gratia&#58; new records suppressed&#58;</font>
<font color='#7F7E6F'>&#62; 4612</font>
<font color='#7F7E6F'>&#62; 13&#58;22&#58;08 EDT Gratia&#58; new records failed&#58; 0</font>
<font color='#7F7E6F'>&#62; 13&#58;22&#58;08 EDT Gratia&#58; records reprocessed</font>
<font color='#7F7E6F'>&#62; successfully&#58; 0</font>
<font color='#7F7E6F'>&#62; 13&#58;22&#58;08 EDT Gratia&#58; reprocessed records</font>
<font color='#7F7E6F'>&#62; failed&#58; 0</font>
<font color='#7F7E6F'>&#62; 13&#58;22&#58;08 EDT Gratia&#58; handshake records sent</font>
<font color='#7F7E6F'>&#62; successfully&#58; 1</font>
<font color='#7F7E6F'>&#62; 13&#58;22&#58;08 EDT Gratia&#58; handshake records</font>
<font color='#7F7E6F'>&#62; failed&#58; 0</font>
<font color='#7F7E6F'>&#62; 13&#58;22&#58;08 EDT Gratia&#58; bundle of records sent</font>
<font color='#7F7E6F'>&#62; successfully&#58; 1</font>
<font color='#7F7E6F'>&#62; 13&#58;22&#58;08 EDT Gratia&#58; bundle of records</font>
<font color='#7F7E6F'>&#62; failed&#58; 0</font>
<font color='#7F7E6F'>&#62; 13&#58;22&#58;08 EDT Gratia&#58; outstanding records&#58; 0</font>
<font color='#7F7E6F'>&#62; 13&#58;22&#58;08 EDT Gratia&#58; outstanding staged</font>
<font color='#7F7E6F'>&#62; records&#58; 0</font>
<font color='#7F7E6F'>&#62; 13&#58;22&#58;08 EDT Gratia&#58; outstanding records tar</font>
<font color='#7F7E6F'>&#62; files&#58; 0</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; ==================================</font>
<font color='#7F7E6F'>&#62; Dr. Scott Yockel | Senior Team Lead of HPC</font>
<font color='#7F7E6F'>&#62; FAS Research Computing | Harvard University</font>
<font color='#7F7E6F'>&#62; 38 Oxford Street Cambridge, MA</font>
<font color='#7F7E6F'>&#62; Office&#58; 211A | Phone&#58; 617-496-7468</font>
<font color='#7F7E6F'>&#62; ==================================</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; &#62; On Sep 15, 2016, at 10&#58;08 AM, Horst Severini &#60;hs@....&#62; wrote&#58;</font>
<font color='#7F7E6F'>&#62; &#62;</font>
<font color='#7F7E6F'>&#62; &#62; Hi Saul,</font>
<font color='#7F7E6F'>&#62; &#62;</font>
<font color='#7F7E6F'>&#62; &#62; I think you&#39;re missing some slurm config info. This is what we have&#58;</font>
<font color='#7F7E6F'>&#62; &#62;</font>
<font color='#7F7E6F'>&#62; &#62; ----</font>
<font color='#7F7E6F'>&#62; &#62; slurm_location = /usr</font>
<font color='#7F7E6F'>&#62; &#62; job_contact = %(localhost)s/jobmanager-pbs</font>
<font color='#7F7E6F'>&#62; &#62; util_contact = %(localhost)s/jobmanager</font>
<font color='#7F7E6F'>&#62; &#62; db_host = odin.oscer.ou.edu &#60;<a href='http&#58;//odin.oscer.ou.edu/&#62' target='_blank' rel='nofollow'>http&#58;//odin.oscer.ou.edu/&#62</a>;</font>
<font color='#7F7E6F'>&#62; &#62; db_port = 3306</font>
<font color='#7F7E6F'>&#62; &#62; db_user = gratia</font>
<font color='#7F7E6F'>&#62; &#62; db_pass = /etc/gratia/slurm/pwfile</font>
<font color='#7F7E6F'>&#62; &#62; db_name = slurm_acct_db</font>
<font color='#7F7E6F'>&#62; &#62; slurm_cluster = schooner</font>
<font color='#7F7E6F'>&#62; &#62; ----</font>
<font color='#7F7E6F'>&#62; &#62;</font>
<font color='#7F7E6F'>&#62; &#62; That is then translated by &#39;osg-configure -c&#39; into</font>
<font color='#7F7E6F'>&#62; /etc/gratia/slurm/ProbeConfig as this&#58;</font>
<font color='#7F7E6F'>&#62; &#62;</font>
<font color='#7F7E6F'>&#62; &#62; ----</font>
<font color='#7F7E6F'>&#62; &#62; SlurmDbHost=&#34;odin.oscer.ou.edu &#60;<a href='http&#58;//odin.oscer.ou.edu/&#62' target='_blank' rel='nofollow'>http&#58;//odin.oscer.ou.edu/&#62</a>;&#34;</font>
<font color='#7F7E6F'>&#62; &#62; SlurmDbPort=&#34;3306&#34;</font>
<font color='#7F7E6F'>&#62; &#62; SlurmDbUser=&#34;gratia&#34;</font>
<font color='#7F7E6F'>&#62; &#62; SlurmDbPasswordFile=&#34;/etc/gratia/slurm/pwfile&#34;</font>
<font color='#7F7E6F'>&#62; &#62; SlurmDbName=&#34;slurm_acct_db&#34;</font>
<font color='#7F7E6F'>&#62; &#62; SlurmCluster=&#34;schooner&#34;</font>
<font color='#7F7E6F'>&#62; &#62; SlurmLocation=&#34;/usr&#34;</font>
<font color='#7F7E6F'>&#62; &#62; ----</font>
<font color='#7F7E6F'>&#62; &#62;</font>
<font color='#7F7E6F'>&#62; &#62; So I think you need to look at your slurm DB host and make sure it&#39;s</font>
<font color='#7F7E6F'>&#62; accessible from the CE frontend with config info similar to the above.</font>
<font color='#7F7E6F'>&#62; We had to open the firewall on odin&#58;3306, and we had to create a</font>
<font color='#7F7E6F'>&#62; special read-only db user named gratia, with the password for that</font>
<font color='#7F7E6F'>&#62; being stored read-protected (to only the gratia user) in</font>
<font color='#7F7E6F'>&#62; etc/gratia/slurm/pwfile .</font>
<font color='#7F7E6F'>&#62; &#62;</font>
<font color='#7F7E6F'>&#62; &#62; Cheers,</font>
<font color='#7F7E6F'>&#62; &#62;</font>
<font color='#7F7E6F'>&#62; &#62; Horst</font>
<font color='#7F7E6F'>&#62; &#62;</font>
<font color='#7F7E6F'>&#62; &#62; On 9/15/16 8&#58;36 AM, Saul Youssef wrote&#58;</font>
<font color='#7F7E6F'>&#62; &#62;&#62;</font>
<font color='#7F7E6F'>&#62; &#62;&#62; Hi Chris,</font>
<font color='#7F7E6F'>&#62; &#62;&#62;</font>
<font color='#7F7E6F'>&#62; &#62;&#62; Meet Scott from Harvard (admin of the Harvard CE) and</font>
<font color='#7F7E6F'>&#62; Augustine,</font>
<font color='#7F7E6F'>&#62; &#62;&#62; who you probably know. I&#39;m also cc-ing Horst who has just gone</font>
<font color='#7F7E6F'>&#62; through</font>
<font color='#7F7E6F'>&#62; &#62;&#62; this and has sent us some notes.</font>
<font color='#7F7E6F'>&#62; &#62;&#62;</font>
<font color='#7F7E6F'>&#62; &#62;&#62; I&#39;ve attached the output of osg-system-profiler on Scott&#39;s</font>
<font color='#7F7E6F'>&#62; machine.</font>
<font color='#7F7E6F'>&#62; &#62;&#62;</font>
<font color='#7F7E6F'>&#62; &#62;&#62; Yesterday afternoon, Scott, Augustine and I got together and</font>
<font color='#7F7E6F'>&#62; made</font>
<font color='#7F7E6F'>&#62; &#62;&#62; some progress. Scott sees the Gratia cron trying and failing to</font>
<font color='#7F7E6F'>&#62; access</font>
<font color='#7F7E6F'>&#62; &#62;&#62; the SLURM db rather than by using the sacct command.</font>
<font color='#7F7E6F'>&#62; &#62;&#62;</font>
<font color='#7F7E6F'>&#62; &#62;&#62; Scott is trying to arrange for the database access to work,</font>
<font color='#7F7E6F'>&#62; but</font>
<font color='#7F7E6F'>&#62; &#62;&#62; if there is an option that uses sacct instead that would probably</font>
<font color='#7F7E6F'>&#62; be</font>
<font color='#7F7E6F'>&#62; &#62;&#62; better. We don&#39;t see instructions for using sacct in the</font>
<font color='#7F7E6F'>&#62; &#62;&#62; documentation. Horst&#39;s configs of from&#58; /etc/osg/config.d/20-</font>
<font color='#7F7E6F'>&#62; slurm.ini</font>
<font color='#7F7E6F'>&#62; &#62;&#62;</font>
<font color='#7F7E6F'>&#62; &#62;&#62; slurm_location = /usr</font>
<font color='#7F7E6F'>&#62; &#62;&#62; job_contact = net2.rc.fas.harvard.edu/jobmanager-pbs</font>
<font color='#7F7E6F'>&#62; &#62;&#62; &#60;<a href='http&#58;//net2.rc.fas.harvard.edu/jobmanager-pbs' target='_blank' rel='nofollow'>http&#58;//net2.rc.fas.harvard.edu/jobmanager-pbs</a></font>
<font color='#7F7E6F'>&#62; &#60;<a href='http&#58;//net2.rc.fas.harvard.edu/jobmanager-pbs&#62' target='_blank' rel='nofollow'>http&#58;//net2.rc.fas.harvard.edu/jobmanager-pbs&#62</a>;&#62;</font>
<font color='#7F7E6F'>&#62; &#62;&#62; util_contact = net2.rc.fas.harvard.edu/jobmanager</font>
<font color='#7F7E6F'>&#62; &#60;<a href='http&#58;//net2.rc.fas.harvard.edu/jobmanager&#62' target='_blank' rel='nofollow'>http&#58;//net2.rc.fas.harvard.edu/jobmanager&#62</a>;</font>
<font color='#7F7E6F'>&#62; &#62;&#62; &#60;<a href='http&#58;//net2.rc.fas.harvard.edu/jobmanager' target='_blank' rel='nofollow'>http&#58;//net2.rc.fas.harvard.edu/jobmanager</a></font>
<font color='#7F7E6F'>&#62; &#60;<a href='http&#58;//net2.rc.fas.harvard.edu/jobmanager&#62' target='_blank' rel='nofollow'>http&#58;//net2.rc.fas.harvard.edu/jobmanager&#62</a>;&#62;</font>
<font color='#7F7E6F'>&#62; &#62;&#62; db_host = UNAVAILABLE</font>
<font color='#7F7E6F'>&#62; &#62;&#62; db_port = UNAVAILABLE</font>
<font color='#7F7E6F'>&#62; &#62;&#62; db_user = UNAVAILABLE</font>
<font color='#7F7E6F'>&#62; &#62;&#62; db_pass = UNAVAILABLE</font>
<font color='#7F7E6F'>&#62; &#62;&#62; db_name = UNAVAILABLE</font>
<font color='#7F7E6F'>&#62; &#62;&#62; slurm_cluster = UNAVAILABLE</font>
<font color='#7F7E6F'>&#62; &#62;&#62;</font>
<font color='#7F7E6F'>&#62; &#62;&#62; Imply that this should work somehow, but we&#39;re not sure if we&#39;re</font>
<font color='#7F7E6F'>&#62; &#62;&#62; configured correctly for that.</font>
<font color='#7F7E6F'>&#62; &#62;&#62;</font>
<font color='#7F7E6F'>&#62; &#62;&#62; - Saul</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; -- by syockel@.... at Thu Sep 15 17&#58;29&#58;33 UTC 2016</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; GOCTX Source&#58; BNL Ticket&#58; Queue=NETier2 ID=26449</font>
<font color='#7F7E6F'>&#62; -- by OSG-GOC at Thu Sep 15 17&#58;29&#58;52 UTC 2016</font>
-- by youssef@.... at Mon Sep 19 15&#58;54&#58;16 UTC 2016

GOCTX Source&#58; BNL Ticket&#58; Queue=NETier2 ID=26449
</div><script type='text/javascript'>
        $('#show_1852256882').click(function() {
            $('#detail_1852256882').slideDown("normal");
            $('#show_1852256882').hide();
            $('#hide_1852256882').show();
        });
        $('#hide_1852256882').click(function() {
            $('#detail_1852256882').slideUp();
            $('#hide_1852256882').hide();
            $('#show_1852256882').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='31224#1473960592'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-09-15T17:29:52+00:00">Sep 15, 2016 05:29 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1473960592">&nbsp;</a></div><pre>I think after adding the grant to the db for net2 that it is working.
Just tested like we did yesterday with the ProbeConfig in
/usr/share/gratia/slurm and then launching ./slurm_meter -v -f
./ProbeConfig.

This no longer yields the Python traceback to the slurm values that
were set.  It also it connecting to the slurmDB.

Now I���ll add this config to the /etc/osg/config.d/20-slurm.ini and
enable the cron job for slurm, but leave the pbs-lfs not running.

I���ll sync up with Augustine later to make sure I���ve done this all
right.

13&#58;22&#58;07 EDT Gratia&#58;
***********************************************************
13&#58;22&#58;07 EDT Gratia&#58; Removing log files older than 31 days from
/var/log/gratia
13&#58;22&#58;07 EDT Gratia&#58; /var/log/gratia uses 0.158% and there is 49% free
13&#58;22&#58;07 EDT Gratia&#58; Removing incomplete data files older than 31 days
from /var/lib/gratia/data/
13&#58;22&#58;07 EDT Gratia&#58; /var/lib/gratia/data uses 0.003% and there is 37%
free
13&#58;22&#58;08 EDT Gratia&#58; Removing quarantines data files older than 31
days from /var/lib/gratia/data/quarantine
13&#58;22&#58;08 EDT Gratia&#58; Removing quarantines data files older than 31
days from
/var/lib/gratia/data/quarantine/subdir.pbs_net2.rc.fas.harvard.edu_gratia-
osg-prod.opensciencegrid.org_80
13&#58;22&#58;08 EDT Gratia&#58;
/var/lib/gratia/data/quarantine/subdir.pbs_net2.rc.fas.harvard.edu_gratia-
osg-prod.opensciencegrid.org_80 uses 0% and there is 37% free
13&#58;22&#58;08 EDT Gratia&#58; Removing quarantines data files older than 31
days from
/var/lib/gratia/data/quarantine/subdir.lsf_net2.rc.fas.harvard.edu_gratia-
<div id='show_604915333' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_604915333'>osg-prod.opensciencegrid.org_80
13&#58;22&#58;08 EDT Gratia&#58; Removing quarantines data files older than 31
days from /var/lib/gratia/data/quarantine/subdir.gridftp-
transfer_net2.rc.fas.harvard.edu_gratia-osg-
transfer.opensciencegrid.org_80
13&#58;22&#58;08 EDT Gratia&#58; Removing quarantines data files older than 31
days from
/var/lib/gratia/data/quarantine/subdir.slurm_net2.rc.fas.harvard.edu_gratia-
osg-prod.opensciencegrid.org_80
13&#58;22&#58;08 EDT Gratia&#58;
/var/lib/gratia/data/quarantine/subdir.slurm_net2.rc.fas.harvard.edu_gratia-
osg-prod.opensciencegrid.org_80 uses 0.003% and there is 37% free
13&#58;22&#58;08 EDT Gratia&#58; End of execution summary&#58; new records sent
successfully&#58; 39
13&#58;22&#58;08 EDT Gratia&#58;                           new records suppressed&#58;
4612
13&#58;22&#58;08 EDT Gratia&#58;                           new records failed&#58; 0
13&#58;22&#58;08 EDT Gratia&#58;                           records reprocessed
successfully&#58; 0
13&#58;22&#58;08 EDT Gratia&#58;                           reprocessed records
failed&#58; 0
13&#58;22&#58;08 EDT Gratia&#58;                           handshake records sent
successfully&#58; 1
13&#58;22&#58;08 EDT Gratia&#58;                           handshake records
failed&#58; 0
13&#58;22&#58;08 EDT Gratia&#58;                           bundle of records sent
successfully&#58; 1
13&#58;22&#58;08 EDT Gratia&#58;                           bundle of records
failed&#58; 0
13&#58;22&#58;08 EDT Gratia&#58;                           outstanding records&#58; 0
13&#58;22&#58;08 EDT Gratia&#58;                           outstanding staged
records&#58; 0
13&#58;22&#58;08 EDT Gratia&#58;                           outstanding records tar
files&#58; 0

==================================
Dr. Scott Yockel | Senior Team Lead of HPC
FAS Research Computing | Harvard University
38 Oxford Street Cambridge, MA
Office&#58; 211A | Phone&#58; 617-496-7468
==================================

<font color='#7F7E6F'>&#62; On Sep 15, 2016, at 10&#58;08 AM, Horst Severini &#60;hs@....&#62; wrote&#58;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; Hi Saul,</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; I think you&#39;re missing some slurm config info. This is what we have&#58;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; ----</font>
<font color='#7F7E6F'>&#62; slurm_location = /usr</font>
<font color='#7F7E6F'>&#62; job_contact = %(localhost)s/jobmanager-pbs</font>
<font color='#7F7E6F'>&#62; util_contact = %(localhost)s/jobmanager</font>
<font color='#7F7E6F'>&#62; db_host = odin.oscer.ou.edu &#60;<a href='http&#58;//odin.oscer.ou.edu/&#62' target='_blank' rel='nofollow'>http&#58;//odin.oscer.ou.edu/&#62</a>;</font>
<font color='#7F7E6F'>&#62; db_port = 3306</font>
<font color='#7F7E6F'>&#62; db_user = gratia</font>
<font color='#7F7E6F'>&#62; db_pass = /etc/gratia/slurm/pwfile</font>
<font color='#7F7E6F'>&#62; db_name = slurm_acct_db</font>
<font color='#7F7E6F'>&#62; slurm_cluster = schooner</font>
<font color='#7F7E6F'>&#62; ----</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; That is then translated by &#39;osg-configure -c&#39; into</font>
/etc/gratia/slurm/ProbeConfig as this&#58;
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; ----</font>
<font color='#7F7E6F'>&#62;    SlurmDbHost=&#34;odin.oscer.ou.edu &#60;<a href='http&#58;//odin.oscer.ou.edu/&#62' target='_blank' rel='nofollow'>http&#58;//odin.oscer.ou.edu/&#62</a>;&#34;</font>
<font color='#7F7E6F'>&#62;    SlurmDbPort=&#34;3306&#34;</font>
<font color='#7F7E6F'>&#62;    SlurmDbUser=&#34;gratia&#34;</font>
<font color='#7F7E6F'>&#62;    SlurmDbPasswordFile=&#34;/etc/gratia/slurm/pwfile&#34;</font>
<font color='#7F7E6F'>&#62;    SlurmDbName=&#34;slurm_acct_db&#34;</font>
<font color='#7F7E6F'>&#62;    SlurmCluster=&#34;schooner&#34;</font>
<font color='#7F7E6F'>&#62;    SlurmLocation=&#34;/usr&#34;</font>
<font color='#7F7E6F'>&#62; ----</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; So I think you need to look at your slurm DB host and make sure it&#39;s</font>
accessible from the CE frontend with config info similar to the above.
We had to open the firewall on odin&#58;3306, and we had to create a
special read-only db user named gratia, with the password for that
being stored read-protected (to only the gratia user) in
etc/gratia/slurm/pwfile .
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; Cheers,</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; 	Horst</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; On 9/15/16 8&#58;36 AM, Saul Youssef wrote&#58;</font>
<font color='#7F7E6F'>&#62;&#62;</font>
<font color='#7F7E6F'>&#62;&#62; Hi Chris,</font>
<font color='#7F7E6F'>&#62;&#62;</font>
<font color='#7F7E6F'>&#62;&#62;      Meet Scott from Harvard (admin of the Harvard CE) and</font>
Augustine,
<font color='#7F7E6F'>&#62;&#62; who you probably know.  I&#39;m also cc-ing Horst who has just gone</font>
through
<font color='#7F7E6F'>&#62;&#62; this and has sent us some notes.</font>
<font color='#7F7E6F'>&#62;&#62;</font>
<font color='#7F7E6F'>&#62;&#62;      I&#39;ve attached the output of osg-system-profiler on Scott&#39;s</font>
machine.
<font color='#7F7E6F'>&#62;&#62;</font>
<font color='#7F7E6F'>&#62;&#62;      Yesterday afternoon, Scott, Augustine and I got together and</font>
made
<font color='#7F7E6F'>&#62;&#62; some progress.  Scott sees the Gratia cron trying and failing to</font>
access
<font color='#7F7E6F'>&#62;&#62; the SLURM db rather than by using the sacct command.</font>
<font color='#7F7E6F'>&#62;&#62;</font>
<font color='#7F7E6F'>&#62;&#62;       Scott is trying to arrange for the database access to work,</font>
but
<font color='#7F7E6F'>&#62;&#62; if there is an option that uses sacct instead that would probably</font>
be
<font color='#7F7E6F'>&#62;&#62; better.  We don&#39;t see instructions for using sacct in the</font>
<font color='#7F7E6F'>&#62;&#62; documentation.  Horst&#39;s configs of from&#58; /etc/osg/config.d/20-</font>
slurm.ini
<font color='#7F7E6F'>&#62;&#62;</font>
<font color='#7F7E6F'>&#62;&#62; slurm_location = /usr</font>
<font color='#7F7E6F'>&#62;&#62; job_contact = net2.rc.fas.harvard.edu/jobmanager-pbs</font>
<font color='#7F7E6F'>&#62;&#62; &#60;<a href='http&#58;//net2.rc.fas.harvard.edu/jobmanager-pbs' target='_blank' rel='nofollow'>http&#58;//net2.rc.fas.harvard.edu/jobmanager-pbs</a></font>
&#60;<a href='http&#58;//net2.rc.fas.harvard.edu/jobmanager-pbs&#62' target='_blank' rel='nofollow'>http&#58;//net2.rc.fas.harvard.edu/jobmanager-pbs&#62</a>;&#62;
<font color='#7F7E6F'>&#62;&#62; util_contact = net2.rc.fas.harvard.edu/jobmanager</font>
&#60;<a href='http&#58;//net2.rc.fas.harvard.edu/jobmanager&#62' target='_blank' rel='nofollow'>http&#58;//net2.rc.fas.harvard.edu/jobmanager&#62</a>;
<font color='#7F7E6F'>&#62;&#62; &#60;<a href='http&#58;//net2.rc.fas.harvard.edu/jobmanager' target='_blank' rel='nofollow'>http&#58;//net2.rc.fas.harvard.edu/jobmanager</a></font>
&#60;<a href='http&#58;//net2.rc.fas.harvard.edu/jobmanager&#62' target='_blank' rel='nofollow'>http&#58;//net2.rc.fas.harvard.edu/jobmanager&#62</a>;&#62;
<font color='#7F7E6F'>&#62;&#62; db_host = UNAVAILABLE</font>
<font color='#7F7E6F'>&#62;&#62; db_port = UNAVAILABLE</font>
<font color='#7F7E6F'>&#62;&#62; db_user = UNAVAILABLE</font>
<font color='#7F7E6F'>&#62;&#62; db_pass = UNAVAILABLE</font>
<font color='#7F7E6F'>&#62;&#62; db_name = UNAVAILABLE</font>
<font color='#7F7E6F'>&#62;&#62; slurm_cluster = UNAVAILABLE</font>
<font color='#7F7E6F'>&#62;&#62;</font>
<font color='#7F7E6F'>&#62;&#62; Imply that this should work somehow, but we&#39;re not sure if we&#39;re</font>
<font color='#7F7E6F'>&#62;&#62; configured correctly for that.</font>
<font color='#7F7E6F'>&#62;&#62;</font>
<font color='#7F7E6F'>&#62;&#62; - Saul</font>

-- by syockel@.... at Thu Sep 15 17&#58;29&#58;33 UTC 2016

GOCTX Source&#58; BNL Ticket&#58; Queue=NETier2 ID=26449
</div><script type='text/javascript'>
        $('#show_604915333').click(function() {
            $('#detail_604915333').slideDown("normal");
            $('#show_604915333').hide();
            $('#hide_604915333').show();
        });
        $('#hide_604915333').click(function() {
            $('#detail_604915333').slideUp();
            $('#hide_604915333').hide();
            $('#show_604915333').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='31224#1473948654'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-09-15T14:10:54+00:00">Sep 15, 2016 02:10 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1473948654">&nbsp;</a></div><pre>Hi Saul,

I think you&#39;re missing some slurm config info. This is what we have&#58;

----
slurm_location = /usr
job_contact = %(localhost)s/jobmanager-pbs
util_contact = %(localhost)s/jobmanager
db_host = odin.oscer.ou.edu
db_port = 3306
db_user = gratia
db_pass = /etc/gratia/slurm/pwfile
db_name = slurm_acct_db
slurm_cluster = schooner
----

That is then translated by &#39;osg-configure -c&#39; into
/etc/gratia/slurm/ProbeConfig as this&#58;

----
SlurmDbHost=&#34;odin.oscer.ou.edu&#34;
SlurmDbPort=&#34;3306&#34;
SlurmDbUser=&#34;gratia&#34;
SlurmDbPasswordFile=&#34;/etc/gratia/slurm/pwfile&#34;
SlurmDbName=&#34;slurm_acct_db&#34;
SlurmCluster=&#34;schooner&#34;
SlurmLocation=&#34;/usr&#34;
----

So I think you need to look at your slurm DB host and make sure it&#39;s
accessible from the CE frontend with config info similar to the above.
We had to open the firewall on odin&#58;3306, and we had to create a
special
read-only db user named gratia, with the password for that being
stored
<div id='show_793813324' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_793813324'>read-protected (to only the gratia user) in etc/gratia/slurm/pwfile .

Cheers,

Horst

On 9/15/16 8&#58;36 AM, Saul Youssef wrote&#58;
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; Hi Chris,</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;       Meet Scott from Harvard (admin of the Harvard CE) and</font>
Augustine,
<font color='#7F7E6F'>&#62; who you probably know.  I&#39;m also cc-ing Horst who has just gone</font>
through
<font color='#7F7E6F'>&#62; this and has sent us some notes.</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;       I&#39;ve attached the output of osg-system-profiler on Scott&#39;s</font>
machine.
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;       Yesterday afternoon, Scott, Augustine and I got together and</font>
made
<font color='#7F7E6F'>&#62; some progress.  Scott sees the Gratia cron trying and failing to</font>
access
<font color='#7F7E6F'>&#62; the SLURM db rather than by using the sacct command.</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;        Scott is trying to arrange for the database access to work,</font>
but
<font color='#7F7E6F'>&#62; if there is an option that uses sacct instead that would probably be</font>
<font color='#7F7E6F'>&#62; better.  We don&#39;t see instructions for using sacct in the</font>
<font color='#7F7E6F'>&#62; documentation.  Horst&#39;s configs of from&#58; /etc/osg/config.d/20-</font>
slurm.ini
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; slurm_location = /usr</font>
<font color='#7F7E6F'>&#62; job_contact = net2.rc.fas.harvard.edu/jobmanager-pbs</font>
<font color='#7F7E6F'>&#62; &#60;<a href='http&#58;//net2.rc.fas.harvard.edu/jobmanager-pbs&#62' target='_blank' rel='nofollow'>http&#58;//net2.rc.fas.harvard.edu/jobmanager-pbs&#62</a>;</font>
<font color='#7F7E6F'>&#62; util_contact = net2.rc.fas.harvard.edu/jobmanager</font>
<font color='#7F7E6F'>&#62; &#60;<a href='http&#58;//net2.rc.fas.harvard.edu/jobmanager&#62' target='_blank' rel='nofollow'>http&#58;//net2.rc.fas.harvard.edu/jobmanager&#62</a>;</font>
<font color='#7F7E6F'>&#62; db_host = UNAVAILABLE</font>
<font color='#7F7E6F'>&#62; db_port = UNAVAILABLE</font>
<font color='#7F7E6F'>&#62; db_user = UNAVAILABLE</font>
<font color='#7F7E6F'>&#62; db_pass = UNAVAILABLE</font>
<font color='#7F7E6F'>&#62; db_name = UNAVAILABLE</font>
<font color='#7F7E6F'>&#62; slurm_cluster = UNAVAILABLE</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; Imply that this should work somehow, but we&#39;re not sure if we&#39;re</font>
<font color='#7F7E6F'>&#62; configured correctly for that.</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; - Saul</font>
<font color='#7F7E6F'>&#62;</font>

-- by hs@.... at Thu Sep 15 14&#58;10&#58;15 UTC 2016

GOCTX Source&#58; BNL Ticket&#58; Queue=NETier2 ID=26449
</div><script type='text/javascript'>
        $('#show_793813324').click(function() {
            $('#detail_793813324').slideDown("normal");
            $('#show_793813324').hide();
            $('#hide_793813324').show();
        });
        $('#hide_793813324').click(function() {
            $('#detail_793813324').slideUp();
            $('#hide_793813324').hide();
            $('#show_793813324').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='31224#1473946672'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-09-15T13:37:52+00:00">Sep 15, 2016 01:37 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1473946672">&nbsp;</a></div><pre>Hi Chris,

Meet Scott from Harvard (admin of the Harvard CE) and Augustine,
who
you probably know.  I&#39;m also cc-ing Horst who has just gone through
this
and has sent us some notes.

I&#39;ve attached the output of osg-system-profiler on Scott&#39;s
machine.

Yesterday afternoon, Scott, Augustine and I got together and
made
some progress.  Scott sees the Gratia cron trying and failing to
access the
SLURM db rather than by using the sacct command.

Scott is trying to arrange for the database access to work, but
if
there is an option that uses sacct instead that would probably be
better.
We don&#39;t see instructions for using sacct in the documentation.
Horst&#39;s
configs of from&#58; /etc/osg/config.d/20-slurm.ini

slurm_location = /usr
job_contact = net2.rc.fas.harvard.edu/jobmanager-pbs
util_contact = net2.rc.fas.harvard.edu/jobmanager
db_host = UNAVAILABLE
db_port = UNAVAILABLE
db_user = UNAVAILABLE
db_pass = UNAVAILABLE
db_name = UNAVAILABLE
slurm_cluster = UNAVAILABLE

<div id='show_584363327' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_584363327'>Imply that this should work somehow, but we&#39;re not sure if we&#39;re
configured
correctly for that.

- Saul

On Thu, Sep 15, 2016 at 8&#58;50 AM, OSG GOC TX via RT &#60;RT-RACF@....&#62;
wrote&#58;

<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;   *Ticket URL&#58;*</font>
<a href='https&#58;//rt.racf.bnl.gov/rt/Ticket/Display.html?id=26449' target='_blank' rel='nofollow'>https&#58;//rt.racf.bnl.gov/rt/Ticket/Display.html?id=26449</a>
<font color='#7F7E6F'>&#62;   *Requestors&#58;* tx+rtbnlprod_fp71@....</font>
<font color='#7F7E6F'>&#62;          *Ccs&#58;* (None)</font>
<font color='#7F7E6F'>&#62;        *Queue&#58;* NETier2</font>
<font color='#7F7E6F'>&#62;        *Owner&#58;* Saul Youssef</font>
<font color='#7F7E6F'>&#62;       *Status&#58;* *new*</font>
<font color='#7F7E6F'>&#62;     *Priority&#58;* *Low*</font>
<font color='#7F7E6F'>&#62;  *Transaction&#58;* Correspondence added by osg-goc-rest</font>
<font color='#7F7E6F'>&#62;      *Subject&#58;* Gratia catch-up for NET2_HU after Harvard switched</font>
to HTCONDOR-CE
<font color='#7F7E6F'>&#62;           *OSG GOC Ticket&#58;* 31224</font>
&#60;<a href='https&#58;//ticket.grid.iu.edu/goc/viewer?id=31224&#62' target='_blank' rel='nofollow'>https&#58;//ticket.grid.iu.edu/goc/viewer?id=31224&#62</a>;
<font color='#7F7E6F'>&#62;      *Resource Group Name&#58;* HU_ATLAS_Tier2</font>
<font color='#7F7E6F'>&#62;                  *VO Name&#58;* ATLAS</font>
<font color='#7F7E6F'>&#62;            *Resource Name&#58;* NET2_HU</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; ------------------------------</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; Hi Saul,</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; Can you run the osg system profiler and attach the output to the</font>
<font color='#7F7E6F'>&#62; ticket?</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; Thanks,</font>
<font color='#7F7E6F'>&#62; Chris</font>
<font color='#7F7E6F'>&#62;  -- by Christopher Pipes at Thu Sep 15 12&#58;49&#58;58 UTC 2016</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;</font>

--
Saul Youssef
Research Associate Professor
Department of Physics
Boston University
590 Commonwealth Avenue
Boston, MA 02215
youssef@....
<a href='http&#58;//physics.bu.edu/' target='_blank' rel='nofollow'>http&#58;//physics.bu.edu/</a>~youssef
-- by youssef@.... at Thu Sep 15 13&#58;37&#58;15 UTC 2016

GOCTX Source&#58; BNL Ticket&#58; Queue=NETier2 ID=26449
</div><script type='text/javascript'>
        $('#show_584363327').click(function() {
            $('#detail_584363327').slideDown("normal");
            $('#show_584363327').hide();
            $('#hide_584363327').show();
        });
        $('#hide_584363327').click(function() {
            $('#detail_584363327').slideUp();
            $('#hide_584363327').hide();
            $('#show_584363327').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='31224#1473943798'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-09-15T12:49:58+00:00">Sep 15, 2016 12:49 PM UTC</time> by <b>Christopher Pipes</b><a class="anchor" name="1473943798">&nbsp;</a></div><pre>Hi Saul,

Can you run the osg system profiler and attach the output to the ticket?

Thanks,
Chris</pre></div><div class='update_description'><i onclick="document.location='31224#1473800332'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-09-13T20:58:52+00:00">Sep 13, 2016 08:58 PM UTC</time> by <b>Christopher Pipes</b><a class="anchor" name="1473800332">&nbsp;</a></div><pre>I&#39;m adding the software team on this. I spoke with Vince and he said that this ticket <a href='https&#58;//ticket.grid.iu.edu/30868' target='_blank' rel='nofollow'>https&#58;//ticket.grid.iu.edu/30868</a> is similar to the issue we are seeing here. Brian and Carl were working on that.</pre></div><div class='update_description'><i onclick="document.location='31224#1473799630'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-09-13T20:47:10+00:00">Sep 13, 2016 08:47 PM UTC</time> by <b>Saul Youssef</b><a class="anchor" name="1473799630">&nbsp;</a></div><pre>Hi,

We got some hints from Horst also since he&#39;s running SLURM and also
ran into some problems.   I&#39;ll put his message here for reference.

- Saul

=====================

Hi Saul,

oh, I might be able to help with that. We had issues with
HTCondor-CE/SLURM&#39;s Gratia as well. You&#39;re using SLURM there as well, right?

The were several problems. One was that we hadn&#39;t put the correct info into
the [SLURM] section of config.ini, and that caused
/etc/gratia/slurm/ProbeConfig to be broken. Here&#39;s what we have now&#58;

slurm_location = /usr
job_contact = %(localhost)s/jobmanager-pbs
util_contact = %(localhost)s/jobmanager
db_host = odin.oscer.ou.edu
db_port = 3306
db_user = gratia
db_pass = /etc/gratia/slurm/pwfile
db_name = slurm_acct_db
slurm_cluster = schooner

And then we need the attached SlurmProbe patch, which you may already have,
but just in case.

And finally, since EL7 uses a tmpfs for /var/lock/, we have to re-create
/var/lock/gratia/ after every reboot, since that&#39;s part of the
gratia-probe-common RPM, so gratia expects it to stay there. That may not
affect you, since I don&#39;t think you&#39;ve moved to EL7 yet, right?
<div id='show_1156841444' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_1156841444'>
Once you&#39;ve patched all of that, run this by hand as root&#58;

/usr/share/gratia/slurm/slurm_meter

That will tell you if it actually runs or errors out. Errors from there
never make it back to the gratia log files, so you have no idea what&#39;s
going on otherwise. They&#39;re currently working on fixing this, after I&#39;ve
bugged them often enough. &#58;)

Hope this helps,

Horst

On Tue, Sep 13, 2016 at 4&#58;29 PM, Open Science Grid FootPrints &#60;
osg@....&#62; wrote&#58;

<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font>
</div><script type='text/javascript'>
        $('#show_1156841444').click(function() {
            $('#detail_1156841444').slideDown("normal");
            $('#show_1156841444').hide();
            $('#hide_1156841444').show();
        });
        $('#hide_1156841444').click(function() {
            $('#detail_1156841444').slideUp();
            $('#hide_1156841444').hide();
            $('#show_1156841444').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='31224#1473798549'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2016-09-13T20:29:09+00:00">Sep 13, 2016 08:29 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1473798549">&nbsp;</a></div><pre>Greetings,

After Harvard switched to HTCONDOR-CE in July, Gratia hasn&#39;t been updating for the site NET2_HU.  You can confirm this by looking at

<a href='http&#58;//gratiaweb.grid.iu.edu/gratia/bysite?starttime=2016-01-30+19%3A59%3A15&endtime=2016-09-13+19%3A59%3A15&span=604800&relativetime=absolute&facility=NET2_HU&exclude-facility=&vo=&exclude-vo=&user=&exclude-dn=' target='_blank' rel='nofollow'>http&#58;//gratiaweb.grid.iu.edu/gratia/bysite?starttime=2016-01-30+19%3A59%3A15&endtime=2016-09-13+19%3A59%3A15&span=604800&relativetime=absolute&facility=NET2_HU&exclude-facility=&vo=&exclude-vo=&user=&exclude-dn=</a>

Could we have a consult about how to catch up on July and August?  We have all the condor logs for the missing period (gratia has also been running the whole time).  I suspect that the problem is just the line

batch = pbs

in 30-gip.ini needs to be changed.  Can you help with instructions about how to switch Gratia to absorbing the condor-ce logs and how to catch up with the accounting?

Thanks,

Saul, Dan and Augustine  for NET2/ATLAS

by Saul Youssef (guest)</pre></div><legend>Similar Recent Tickets <small>modified within the last 30 days</small></legend><div id="similar_tickets"><p class="muted">No similar tickets found.</p></div>
</div>
<script type="text/javascript">
function reset_anchor() {
    $("#updates .selected").removeClass("selected");
    var urls = document.location.toString().split('#'); 
    var anchor = urls[1];
    if(anchor) {
        $("a[name='"+anchor+"']").parents(".update_description").addClass("selected");
    }
}
function submitspam(ticket_id) {
    myret = confirm("Would you like to close this ticket as a security ticket, and submit the ticket content to akismet?");
    if(myret == true) {
        $.ajax("viewer/processspam?id="+ticket_id).done(function() {
            window.location.reload();
        });
    }
}

$(function() {
    reset_anchor();
    var ADDITIONAL_COOKIE_NAME = 'gocticket';
    var options = { path: '/', expires: 365};

    if(window.opener && window.opener.name == "gocticket_list") {
        v = $.cookie("closewindow");
        if(!v) {
            $("#closewindow").attr("checked", "checked"); //on by default
        } else {
            if(v == "checked") {
                $("#closewindow").attr("checked", "checked");
            }
        }
        $("#closewindow").click(function() {
            $.cookie("closewindow", $(this).attr('checked'), options);
        });
    } else {
        $("#closewindow_area").hide();
    }
    function updateTimeago() {
        $("time").timeago();
        setTimeout(updateTimeago, 30*1000);
    }
    updateTimeago();
    $(".description").focus(expand_description);
});
</script>
<hr/>
<footer>
<p>GOC Ticket Version 2.2 | <a href="https://ticket.opensciencegrid.org/goc/submit?app_issue_check=on&amp;app_issue_type=goc&amp;app_goc_url=https%3A%2F%2Fticket.opensciencegrid.org%3A443%2F31224">Report Bugs</a>
 | <a href="https://github.com/opensciencegrid/operations/blob/master/docs/privacy.md">Privacy Policy</a>
</p>

<p> <img align="top" src="images/tag_orange.png"/> Copyright 2018 The Trustees of Indiana University - Developed for Open Science Grid</p>
</footer>


</div><!--container-fluid-->
<script src="https://ticket1.grid.iu.edu:8443/socket.io/socket.io.js"></script>
<script>
var chat = io.connect('https://ticket1.grid.iu.edu:8443');
chat.on('connect', function() {
    chat.emit('authenticate', {nodekey:'', ticketid: 31224});
});
chat.on('peers', function(peers) {
    $("#peers").html("");
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('peer_disconnect', function(pid) {
    $("#peer_"+pid).hide("slow");
});
chat.on('peer_connected', function(peers) {
    //expect only 1 peer connecting, but..
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('submit', function() {
    if(confirm("This ticket was updated. Do you want to refresh?")) {
        history.go(0);
    }
});

function addPeer(pid, peer) {
    var ipinfo = "";
    if(peer.ip != undefined) {
        ipinfo = "<span class=\"ip\">"+peer.ip+"</span>";
    }
    if(chat.io.engine.id == pid) {
        //don't display myself
        return;
    }
    var html = "<li class=\"new\" id=\"peer_"+pid+"\" class=\"peer\">"+peer.name+ipinfo+"</li>";
    $("#peers").prepend(html);
    $("#peers .new").animate({bottom: 0}, 1000, function() {$(this).removeClass("new")});
}

$(function() {
    $("#ticket_form").submit(function() {
        chat.emit('submit');
        return true;
    });
});
</script>
<script>
//used by searchbox
function parseValue(value) {
    var obj = new Object();
    var tokens = value.split("\t");
    obj.str = tokens[0];
    obj.count = tokens[1];
    return obj;
}

$(function() {
    //bootstrap-2.0.4 stuff
    $(".alert-message").alert();
    $(".dropdown-toggle").dropdown();
    $("span[rel='tooltip']").tooltip();
    $("a[rel=popover]").popover();

    //activate menu that user is currently on
    $("#menu_navigator").addClass("active"); 
    $("#submenu_").addClass("active"); 

    //translate zend validation error message to bootstrap
    $(".errors").addClass("alert").addClass("alert-error");

    //enable autocomplete for search box
    $("#search").autocomplete({
        source: function( request, response ) {
            $.ajax({
                url: "search/autocomplete",
                dataType: "text",
                data: {
                    //featureClass: "P",
                    //style: "full",
                    //maxRows: 12,
                    //name_startsWith: request.term
                    q: request.term
                },
                success: function( data ) {
                    response( $.map( data.split("\n"), function( item ) {
                        if(item == "") return null;
                        return {
                            value: item
                        }
                    }));
                }
            });
        },
        select: function(event, ui) {
            document.location = "search?q="+ui.item.value;
        }
    });
    
});
</script>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-69012-13");
pageTracker._trackPageview();
} catch(err) {}
</script>

</body>
