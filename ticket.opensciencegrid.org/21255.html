<!DOCTYPE html>
<html lang="en">
  <head>
  <base href="">
    <title>[21255] RSV SRM probe uses srm-copy which consistently fails against dcache 2.2</title>    <meta charset="utf-8" />
    <meta name="verify-v1" content="na5IcAJsZVOfEkboRxuIiZ1zpZgnZiWra+nKcS7nA/o=" />
    <meta name="google-site-verification" content="DLrk3ft4s8b-S2TloLCL2LD_t6wcTjgSluf5pmiu2kA" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />
    <link href="https://ticket.opensciencegrid.org/rss" rel="alternate" type="application/rss+xml" title="GOC Ticket Update feed" />

    <style type="text/css">
      body {
        padding-top: 50px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
     #search {
            width: 300px;
     }

    </style>

<script src="https://code.jquery.com/jquery-3.0.0.js"></script>
<script src="https://code.jquery.com/jquery-migrate-3.0.1.js"></script>

   <link href="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet"/>
    <script src="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/js/bootstrap.min.js"></script>

    <link href="https://netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"/>
    <link href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/themes/smoothness/jquery-ui.min.css" rel="stylesheet"/>
 <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>


    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/js/select2.min.js"></script>

    <link href="css/ticket.css" rel="stylesheet" />
    <script src="lib/jquery.cookie.js"></script>

    <link href="images/tag_orange.png" rel="icon" type="image/png"/>
    <script src='https://www.google.com/recaptcha/api.js'></script>
  </head>

  <body>
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>

            <a class="brand" style="padding: 6px 0px 0px 6px;" href="http://opensciencegrid.org"><img src="images/osglogo.40x30.png"/></a>
            <ul class="nav">
                <li class="dropdown"><a href="https://ticket.opensciencegrid.org/#" class="dropdown-toggle" data-toggle="dropdown">GOC Ticket <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    <li><a href="https://my.opensciencegrid.org">MyOSG</a></li>
                    <li><a href="https://oim.opensciencegrid.org">OIM</a></li>
                    <li class="active"><a href="https://ticket.opensciencegrid.org/index">Ticket</a></li>
	<li class="divider"></li>
	<li><a href="http://repo.grid.iu.edu">Repo</a></li>
	<li class="divider"></li>
	<li><a href="http://blogs.grid.iu.edu">Blog</a></li>
                    <li><a href="http://display.grid.iu.edu">Display</a></li>
                    <li><a href="http://osggoc.blogspot.com/">News</a></li>
                    </ul>
                </li>
            </ul>
            <ul class="nav pull-right">
                <li><a href="https://ticket.opensciencegrid.org/sso/">Login</a></li>            </ul>

            <div class="nav-collapse">
                <ul class="nav">
			 <li id="menu_submit"><a href="https://ticket.opensciencegrid.org/submit">Submit</a></li><li id="menu_view" class="dropdown"><a href="https://ticket.opensciencegrid.org/\#" class="dropdown-toggle" data-toggle="dropdown">View <b class="caret"></b></a><ul class="dropdown-menu"><li id="submenu_listopen"><a href="https://ticket.opensciencegrid.org/list/open">Open Tickets</a></li><li id="submenu_listrecentclose"><a href="https://ticket.opensciencegrid.org/list/recentclose">Recently Closed Tickets</a></li><li class="divider"></li><li id="submenu_alltickets"><a href="https://ticket.opensciencegrid.org/search?q=&amp;sort=id">All Tickets</a></li></ul></li>                </ul>

                <form class="navbar-search pull-right" action="https://ticket.opensciencegrid.org/viewer">
                    <input id="search" type="text" name="id" class="search-query span2" placeholder="Search Ticket" value=""/>
                </form>
            </div>
        </div>
      </div>
    </div>

<script type='text/javascript' src='lib/jquery.timeago.js'></script>
<script type='text/javascript' src='lib/byte2size.js'></script>
<style>
#updates .toolbar {
position: relative;
margin-top: 0px;
top: -10px;
font-weight: normal;
}
#updates a.anchor {
position: relative;
top: -50px;
}
#updates .selected pre {
animation:selected 2s;
animation-iteration-count: 2;
animation-direction: alternate;
-webkit-animation:selected 2s; 
-webkit-animation-iteration-count: 2;
-webkit-animation-direction: alternate;
box-shadow: inset 1px 1px 20px #9ad;
border: 1px solid #9ab;
margin: 5px 0px;
padding-left: 10px;
}
@keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ab;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
@-webkit-keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ad;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
#updates pre {
background-color: inherit;
line-height: 15px;
padding: 5px;
}
#updates .header {
color: #999;
}
#updates .update_history pre {
background-color: #eee;
color: #666;
font-size: 85%;
}
#updates .clickable {
cursor: pointer;
}
#updates .clickable:hover {
color: #D98719;
}
#updates .meta_information pre {
background-color: #fed;
}
#similar_tickets {
max-height: 300px;
overflow-y: auto;
pointer-events: none;
padding: 5px;
background-color: #f4f4f4;
}
.btn-toolbar {
margin-bottom: 0;
height: 30px;
}
#peers {
position: fixed;
bottom: 0px;
right: 0px;
z-index: 100;
list-style: none;
padding: 5px 0px 0px 5px;
margin: 0px;
background-color: white;
box-shadow: 0px 0px 10px white;
}
#peers li {
background-color: #ccc;
color: #000;
display: inline-block;
padding: 5px 10px;
margin-right: 5px;
position: relative;
}
/*
#peers li:hover {
background-color: #999;
cursor: pointer;
}
*/
#peers span.ip {
padding-left: 5px;
color: #666;
}
#peers .new {
bottom: -30px;
}
/*
#peers .me {
background-color: red;
}
*/
</style>

<div class="container-fluid">
<ul id="peers"></ul>
<div class="alert alert-danger"><a class="close" href="https://ticket.opensciencegrid.org/#" data-dismiss="alert">&times;</a>By the end of May 2018, the ticketing system at https://ticket.opensciencegrid.org will be retired and support will be provided at https://support.opensciencegrid.org. Throughout this transition the support email (help@opensciencegrid.org) will be available as a point of contact.<br><br>                                                   
                                                                                                                                                                                   
Please see the service migration page for details: https://opensciencegrid.github.io/technology/policy/service-migrations-spring-2018/#ticket</div><div id="presence" class="pull-right"></div><div class="ticketgui"><script type="text/javascript" src="lib/checktab.js"></script>

<script>
var expanded = false;
function expand_description() {
    var desc = $(".description");
    if(!expanded) {
        expanded = true;
        //expand to minheight
        var min = 250;
        if(desc.height() < min) {
            desc.animate({height: min}, 200);
        }
    }
}

$(document).ready(function() {
    $("input[name='nad']").datepicker({
        dateFormat: 'yy-mm-dd'
    });
});

</script>



<style>
.form-horizontal .control-label {
padding-top: inherit;
font-size:90%;
color:#666;
}
label {
margin-bottom: 0px;
}
.controls {
line-height: 18px;
}
</style>
<form class="form-horizontal" action="https://ticket.opensciencegrid.org/viewer/updatebasic?id=21255" method="post">
<div class="page-header">
    <h3><span class="muted">21255</span> / RSV SRM probe uses srm-copy which consistently fails against dcache 2.2</h3>
</div>

<div class="row-fluid">
<div class="span5">
    <legend>Contact</legend>
    <div class="control-group">
        <label class="control-label">Full Name</label>
        <div class="controls">Anthony Tiradani</div>
    </div>
    <div class="control-group">
        <label class="control-label">Email</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">Phone</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">CC</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>

    <legend>Details</legend>
    <div class="control-group"><label class="control-label">Resource Name</label><div class="controls">USCMS-FNAL-WC1-SE</div></div><div class="control-group"><label class="control-label">Associated VO</label><div class="controls">CMS</div></div><div class="control-group"><label class="control-label">Submitted Via</label><div class="controls">GOC Ticket/submit</div></div><div class="control-group"><label class="control-label">Submitter</label><div class="controls">Anthony Tiradani</div></div><div class="control-group"><label class="control-label">Support Center</label><div class="controls">USCMS</div></div><div class="control-group"><label class="control-label">Ticket Links</label><div class="controls"></div></div>
    <div class="control-group">
        <label class="control-label">Ticket Type</label>
        <div class="controls">Problem/Request</div>
    </div>
    <div class="control-group">
        <label class="control-label">Priority</label>
        <div class="controls">Normal</div>
    </div>
    <div class="control-group">
        <label class="control-label">Status</label>
        <div class="controls">
Closed</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action</label>
        <div class="controls">ENG Action</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action Deadline</label>
        <div class="controls flag_red">2015-04-28</div>
    </div>

</div><!--span-->
<div class="span7">
    <legend>Assignees</legend>
    <div class="assignee" style="width: 60%">Software Support (Triage) <span class="muted"> / OSG Software Team</span></div><div class="assignee" style="width: 60%">Carl Edquist <span class="muted"> / OSG Software Team</span></div>    <br>

    <legend>Assignees</legend>
    TODO
    <br>

    <style>
legend.noborder {
border-bottom: none;
}
</style>

<div id="attachment-list"/>
<script>
$(function () {
    var first = true;
    $.getJSON("attachment/list/21255", function (files) {
        //console.dir(files);
        var html = "<table class=\"table table-condensed\">";
        $(files).each(function() {
            if(first) {
                first = false;
                html += "<legend class=\"noborder\">Attachmenets</legend>";
            }
            html += "<tr class=\"attachment\">";
            html += "<td><img src="\&quot;&quot;+this.thumbnail_url+&quot;\&quot;/"></td>";
            html += "<td><a href="\&quot;&quot;+this.url+&quot;\&quot;" target=\"_blank\">"+this.name+"</a></td>";
            html += "<td>"+bytesToSize(this.size, 1)+"</td>";
            html += "</tr>";
        });
        html += "</table>";
        $("#attachment-list").html(html);
    });
});

function download(url) {
    window.open(url, "_blank");
}
</script>


</div><!--span-->
</div><!--row-fluid-->


</form>

</div>
<div id="updates" style="clear: both;">
    <legend>Past Updates
    <div class="btn-toolbar pull-right toolbar">
        <div class="btn-group">
                <a class="btn btn-small" href="https://ticket.opensciencegrid.org/21255?sort=up&amp;"><i class="icon-arrow-up"></i> Sort</a>

        
        <a class="btn btn-small" href="https://ticket.opensciencegrid.org/21255?expandall=true&amp;">Expand Descriptions</a>        <a class="btn btn-small" target="_blank" href="mailto:osg@tick.globalnoc.iu.edu?subject=Open%20Science%20Grid%3A%20RSV%20SRM%20probe%20uses%20srm-copy%20which%20consistently%20fails%20against%20dcache%202.2%20ISSUE%3D21255%20PROJ%3D71"><i class="icon-envelope"></i> Update w/Email</a>
        </div>
    </div><!--btn-toolbar-->
    </legend>

    <div class='update_description'><i onclick="document.location='21255#1430241465'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-04-28T17:17:45+00:00">Apr 28, 2015 05:17 PM UTC</time> by <b>Carl Edquist</b><a class="anchor" name="1430241465">&nbsp;</a></div><pre>Just a couple notes for future reference.

The RSV fix in <a href='https&#58;//jira.opensciencegrid.org/browse/SOFTWARE-1888' target='_blank' rel='nofollow'>https&#58;//jira.opensciencegrid.org/browse/SOFTWARE-1888</a> is scheduled for the May release.  This will use gfal-copy (from gfal2-util) instead of srm-copy (from bestman2-client), and that is the recommended solution for anyone that runs into this issue.

The workaround solution mentioned earlier (install globus-gass-copy-progs and configure GUCPath=/usr/bin/globus-url-copy in /etc/bestman2/conf/srmclient.conf) should also work if you want/need to continue using srm-copy.  We may make that configuration the default for bestman2-client for a future OSG release, probably June (see <a href='https&#58;//jira.opensciencegrid.org/browse/SOFTWARE-1889' target='_blank' rel='nofollow'>https&#58;//jira.opensciencegrid.org/browse/SOFTWARE-1889</a>).  But again, the recommended solution is to switch over to the gfal2 tools.

Carl</pre></div><div class='update_description'><i onclick="document.location='21255#1430240838'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-04-28T17:07:18+00:00">Apr 28, 2015 05:07 PM UTC</time><a class="anchor" name="1430240838">&nbsp;</a></div><pre>Since now this is tracked in jira for June&#39;s release. I am closing this ticket.

Cheers,

Edgar
OSG Software Support

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=Edgar Mauricio Fajardo Hernandez 2020</pre></div><div class='update_description'><i onclick="document.location='21255#1429898465'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-04-24T18:01:05+00:00">Apr 24, 2015 06:01 PM UTC</time> by <b>Christopher Pipes</b><a class="anchor" name="1429898465">&nbsp;</a></div><pre>Hey All,

So is it ok to close this since it seems like we are tracking this fix in jira or do you want to keep this open?

Thanks,
Chris</pre></div><div class='update_description'><i onclick="document.location='21255#1429736779'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-04-22T21:06:19+00:00">Apr 22, 2015 09:06 PM UTC</time> by <b>Anthony Tiradani</b><a class="anchor" name="1429736779">&nbsp;</a></div><pre>Sounds good!

Thanks,

Anthony Tiradani</pre></div><div class='update_description'><i onclick="document.location='21255#1429735526'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-04-22T20:45:26+00:00">Apr 22, 2015 08:45 PM UTC</time> by <b>Carl Edquist</b><a class="anchor" name="1429735526">&nbsp;</a></div><pre>So far my tests are showing that gfal-copy (from gfal2-util) works as a drop in replacement for srm-copy (from bestman2-client), against the same dcache 2.2 server as before.

We&#39;ll try to get this updated in RSV for the May release (SOFTWARE-1888).

Carl</pre></div><div class='update_description'><i onclick="document.location='21255#1429731038'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-04-22T19:30:38+00:00">Apr 22, 2015 07:30 PM UTC</time> by <b>Tim Cartwright</b><a class="anchor" name="1429731038">&nbsp;</a></div><pre>Ah, I get your point ... duh on my part. Yes, this seems like a very reasonable thing to start in OSG 3.2 and propagate forward to OSG 3.3, good call. That is, assuming that the SRM probe is just a client call (or two) that tests connectivity to an SRM-based server, in which case it should not really matter which client we use.

<a href='https&#58;//jira.opensciencegrid.org/browse/SOFTWARE-1888' target='_blank' rel='nofollow'>https&#58;//jira.opensciencegrid.org/browse/SOFTWARE-1888</a></pre></div><div class='update_description'><i onclick="document.location='21255#1429729466'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-04-22T19:04:26+00:00">Apr 22, 2015 07:04 PM UTC</time> by <b>Anthony Tiradani</b><a class="anchor" name="1429729466">&nbsp;</a></div><pre>Hi Tim,

I guess my point is that the RSV probe is coded to use the BestMan2 client.  The gfal2 srm client is already shipped today in OSG 3.2, right?  So, instead of the dcache client, then could the probe be changed to use the gfal2 client within an OSG 3.2 release?

Thanks,

Anthony Tiradani</pre></div><div class='update_description'><i onclick="document.location='21255#1429729114'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-04-22T18:58:34+00:00">Apr 22, 2015 06:58 PM UTC</time> by <b>Tim Cartwright</b><a class="anchor" name="1429729114">&nbsp;</a></div><pre>Tony&#58;

As highlighted in one of Brian B.’s (many) AHM talks, the current plan is to consolidate down to the gfal2 SRM client only. So for OSG 3.3, we plan to ship no other SRM client (and actually, gfal2 comes from EPEL), so the probe will have to move in that direction.

— Tim</pre></div><div class='update_description'><i onclick="document.location='21255#1429720727'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-04-22T16:38:47+00:00">Apr 22, 2015 04:38 PM UTC</time> by <b>Christopher Pipes</b><a class="anchor" name="1429720727">&nbsp;</a></div><pre>I have pinged Tony on this. He will update later.</pre></div><div class='update_description'><i onclick="document.location='21255#1429720682'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-04-22T16:38:02+00:00">Apr 22, 2015 04:38 PM UTC</time> by <b>Anthony Tiradani</b><a class="anchor" name="1429720682">&nbsp;</a></div><pre>Hi Carl,

To my knowledge, the only place this causes problems for the Tier-1 is in the RSV probes.  I will try to test this work around soon.

However, given the apparent lack of upstream support (upstream to you) on both the bestman2 and globus fronts, maybe the SRM probe should be converted to using the dcache client instead?

Thanks,

Anthony Tiradani</pre></div><div class='update_description'><i onclick="document.location='21255#1429231627'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-04-17T00:47:07+00:00">Apr 17, 2015 12:47 AM UTC</time> by <b>Carl Edquist</b><a class="anchor" name="1429231627">&nbsp;</a></div><pre>Hi all,

Sorry for the long silence on this ticket.

I think there was some confusion in this ticket about globus-url-copy -- the problem happens when srm-copy from bestman2-client uses its default/internal srm copy implementation (from the MySRMFileTransfer class, when the -gucpath and -gurlcopy are NOT used).  But using the globus-url-copy from globus-gass-copy-progs is the workaround that fixes it.  So there is no problem to report to globus about globus-url-copy.

Based on the stack traces in earlier comments, the problem might be in bestman2-client itself or it might be in jglobus.  We can contact globus to see if they have any insight, but I haven&#39;t seen any clear indication that the problem is with jglobus.  The only thing that is apparent is that the client gets a 426 &#34;Connection refused&#34; error which is not handled specially in either jglobus or the bestman2 client code.  I don&#39;t know why it always works in globus-url-copy.

Anyway, my current recommendation to any sites that are running bestman2-client against a dcache server is to&#58;
1. install globus-gass-copy-progs (for /usr/bin/globus-url-copy)
2. add the line&#58; GUCPath=/usr/bin/globus-url-copy to /etc/bestman2/conf/srmclient.conf

From what I can tell this has the same effect as specifying &#34;-gucpath /usr/bin/globus-url-copy&#34; on the command line.

Tony, maybe you&#39;ve been doing this already, but otherwise if you get to try it, let me know if it works for you.

In a future OSG release of bestman2 we may make packaging changes to make this the default.  The downside is it would force installing globus-gass-copy-progs and all its dependencies for *all* bestman2-client installations and use globus-url-copy for all srm file transfers (including non-dcache).

I&#39;ve also written up the details of the issue for Tim C -- we&#39;ll be discussing how to proceed with the bestman2 packaging defaults, and whether to pursue looking into the jglobus aspect of the failures with the globus team.

Thanks,
Carl</pre></div><div class='update_description'><i onclick="document.location='21255#1429044304'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-04-14T20:45:04+00:00">Apr 14, 2015 08:45 PM UTC</time> by <b>Kyle Gross</b><a class="anchor" name="1429044304">&nbsp;</a></div><pre>Edgar,

Has anything been done with this ticket?  Was it handled outside of this ticket?

-Kyle</pre></div><div class='update_description'><i onclick="document.location='21255#1424710751'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-02-23T16:59:11+00:00">Feb 23, 2015 04:59 PM UTC</time><a class="anchor" name="1424710751">&nbsp;</a></div><pre>Carl,

Have u had any time to look into this?

Edgar

OSG Software Support

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=Edgar Mauricio Fajardo Hernandez 2020</pre></div><div class='update_description'><i onclick="document.location='21255#1420486689'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-01-05T19:38:09+00:00">Jan 5, 2015 07:38 PM UTC</time><a class="anchor" name="1420486689">&nbsp;</a></div><pre>Hi Carl,

I am not sure where to go on in this issue? U need more time to look into the code?

Edgar Fajardo
OSG Software Team

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=Edgar Mauricio Fajardo Hernandez 2020</pre></div><div class='update_description'><i onclick="document.location='21255#1418923565'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-12-18T17:26:05+00:00">Dec 18, 2014 05:26 PM UTC</time> by <b>Brian Lin</b><a class="anchor" name="1418923565">&nbsp;</a></div><pre>Carl&#58; Would a bug report to globus be appropriate?</pre></div><div class='update_description'><i onclick="document.location='21255#1416434684'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-11-19T22:04:44+00:00">Nov 19, 2014 10:04 PM UTC</time> by <b>Soichi Hayashi</b><a class="anchor" name="1416434684">&nbsp;</a></div><pre>Carl, would you like to volunteer submitting the bug report at globus.atlassian.net (if that&#39;s the right thing to do)? I think you can better summarize this issue..</pre></div><div class='update_description'><i onclick="document.location='21255#1415998410'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-11-14T20:53:30+00:00">Nov 14, 2014 08:53 PM UTC</time> by <b>Christopher Pipes</b><a class="anchor" name="1415998410">&nbsp;</a></div><pre>Hello All,

Does anyone on have any new information on this issue?
Thanks,
Chris</pre></div><div class='update_description'><i onclick="document.location='21255#1414011850'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-10-22T21:04:10+00:00">Oct 22, 2014 09:04 PM UTC</time> by <b>Soichi Hayashi</b><a class="anchor" name="1414011850">&nbsp;</a></div><pre>So, if this issue really has to be fixed within globus-url-copy, has it been reported to globus yet? (guessing they still supports globus-url-copy?)

By quickly searching for globus-url-copy related issues in Globus (<a href='https&#58;//globus.atlassian.net/browse/GRIDFTP-71?jql=text%20' target='_blank' rel='nofollow'>https&#58;//globus.atlassian.net/browse/GRIDFTP-71?jql=text%20</a>~%20%22globus-url-copy%22) I didn&#39;t seem to find similar / related issue, but I might have missed it.</pre></div><div class='update_description'><i onclick="document.location='21255#1412611798'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-10-06T16:09:58+00:00">Oct 6, 2014 04:09 PM UTC</time> by <b>Carl Edquist</b><a class="anchor" name="1412611798">&nbsp;</a></div><pre>We could do that but I don&#39;t think it answers the core problem. From what I was seeing the failures happened intermittently even with globus-url-copy / globus-gass-copy-progs installed.  Using -gucpath /usr/bin/globus-url-copy explicitly did work around the problem, but I think it&#39;s intended to be optional to install it.

So we could update RSV both to require globus-gass-copy-progs and change the command line globus-url-copy to avoid the RSV errors for now, but it doesn&#39;t address why the failures still happen with the default globus-url-copy...

Carl</pre></div><div class='update_description'><i onclick="document.location='21255#1412185958'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-10-01T17:52:38+00:00">Oct 1, 2014 05:52 PM UTC</time><a class="anchor" name="1412185958">&nbsp;</a></div><pre>Hi Carl,

If the RSV probe needs srm-copy it makes sense, would this be fixed by RSV to require&#58; globus-gass-copy-progs package?

Cheers,

Edgar
OSG Software

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=Edgar Mauricio Fajardo Hernandez 2020</pre></div><div class='update_description'><i onclick="document.location='21255#1410880429'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-09-16T15:13:49+00:00">Sep 16, 2014 03:13 PM UTC</time> by <b>Carl Edquist</b><a class="anchor" name="1410880429">&nbsp;</a></div><pre>Sorry I have neglected this ticket for a long time...

The last I worked on it, I was definitely able to reproduce (inconsistently) the same failures Tony was reporting, but I didn&#39;t track down the source of the problem (if it was a bug) in the software, or why passing -gucpath /usr/bin/globus-url-copy appeared to fix it.

I would like to offer to effectively make &#34;-gucpath /usr/bin/globus-url-copy&#34; the default in srm-copy (in bestman2-client), except that globus-url-copy comes from the globus-gass-copy-progs package, which is not a required dependency for bestman2-client installs.

I am not sure what to recommend at this point, but I can pick up on trying to find exactly where the problem is happening in the software.

Carl</pre></div><div class='update_description'><i onclick="document.location='21255#1410816045'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-09-15T21:20:45+00:00">Sep 15, 2014 09:20 PM UTC</time> by <b>Kyle Gross</b><a class="anchor" name="1410816045">&nbsp;</a></div><pre>Are there any updates from teams outside of FNAL?

-Kyle</pre></div><div class='update_description'><i onclick="document.location='21255#1410546589'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-09-12T18:29:49+00:00">Sep 12, 2014 06:29 PM UTC</time> by <b>Anthony Tiradani</b><a class="anchor" name="1410546589">&nbsp;</a></div><pre>I believe that there is nothing more for us to do from the FNAL side?  Has there been any progress in fixing this?

Thanks,

Anthony Tiradani</pre></div><div class='update_description'><i onclick="document.location='21255#1409159135'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-08-27T17:05:35+00:00">Aug 27, 2014 05:05 PM UTC</time> by <b>Scott Teige</b><a class="anchor" name="1409159135">&nbsp;</a></div><pre>waiting for reply, extending NAD</pre></div><div class='update_description'><i onclick="document.location='21255#1408045197'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-08-14T19:39:57+00:00">Aug 14, 2014 07:39 PM UTC</time> by <b>Soichi Hayashi</b><a class="anchor" name="1408045197">&nbsp;</a></div><pre>Sorry, I forgot to answer this
<font color='#7F7E6F'>&#62; Also, what are the extensions on your proxy?</font>

As far as I know, I have no extensions with my certificate.

2014-08-14 19&#58;38&#58;37 UTC [hayashis@soichi6]$ grid-proxy-info -all
subject  &#58; /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=Soichi Hayashi 238/CN=1159696279
issuer   &#58; /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=Soichi Hayashi 238
identity &#58; /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=Soichi Hayashi 238
type     &#58; RFC 3820 compliant impersonation proxy
strength &#58; 1024 bits
path     &#58; /tmp/x509up_u740536
timeleft &#58; 11&#58;59&#58;13

Is this what you are asking?</pre></div><div class='update_description'><i onclick="document.location='21255#1408044826'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-08-14T19:33:46+00:00">Aug 14, 2014 07:33 PM UTC</time> by <b>Soichi Hayashi</b><a class="anchor" name="1408044826">&nbsp;</a></div><pre>Now I am seeing a very similar (or exactly the same) error message that Tony has reported 2 month ago. I am using bestman2-client 2.3.0 (18.osg32.el6).

$ srm-copy &#39;file&#58;///etc/issue&#39; &#39;<a href='srm&#58;//cmssrm.fnal.gov&#58;8443/srm/managerv2?SFN=/11/TEST/soichi.test&#39' target='_blank' rel='nofollow'>srm&#58;//cmssrm.fnal.gov&#58;8443/srm/managerv2?SFN=/11/TEST/soichi.test&#39</a>;
srm-copy   2.2.2.3.0  Wed Nov  7 16&#58;03&#58;09 CST 2012

BeStMan and SRM-Clients Copyright(c) 2007-2012,
Lawrence Berkeley National Laboratory. All rights reserved.
Support at SRM@.... and documents at <a href='http&#58;//sdm.lbl.gov/bestman' target='_blank' rel='nofollow'>http&#58;//sdm.lbl.gov/bestman</a>
OSG Support at osg-software@.... and
documentation at <a href='https&#58;//www.opensciencegrid.org/bin/view/Documentation/Release3/' target='_blank' rel='nofollow'>https&#58;//www.opensciencegrid.org/bin/view/Documentation/Release3/</a>

SRM-CLIENT&#58; Thu Aug 14 19&#58;30&#58;56 UTC 2014 Connecting to httpg&#58;//cmssrm.fnal.gov&#58;8443/srm/managerv2

SRM-CLIENT&#58; Thu Aug 14 19&#58;30&#58;56 UTC 2014 Calling SrmPrepareToPutRequest now ...
request.token= -2139039797
Request.status=SRM_SUCCESS
explanation= at Thu Aug 14 14&#58;31&#58;03 CDT 2014 state Pending &#58; created

SRM-CLIENT&#58; RequestFileStatus for SURL=file&#58;///etc/issue is Ready.
SRM-CLIENT&#58; received TURL=<a href='gsiftp&#58;//cmsstor134.fnal.gov&#58;2811/WAX/11/TEST/soichi.test' target='_blank' rel='nofollow'>gsiftp&#58;//cmsstor134.fnal.gov&#58;2811/WAX/11/TEST/soichi.test</a>

SRM-CLIENT&#58; Thu Aug 14 19&#58;31&#58;05 UTC 2014 start file transfer
SRM-CLIENT&#58;Source=file&#58;////etc/issue
SRM-CLIENT&#58;Target=<a href='gsiftp&#58;//cmsstor134.fnal.gov&#58;2811/WAX/11/TEST/soichi.test' target='_blank' rel='nofollow'>gsiftp&#58;//cmsstor134.fnal.gov&#58;2811/WAX/11/TEST/soichi.test</a>
org.globus.ftp.exception.ServerException&#58; Server refused performing the request. Custom message&#58; Server reported transfer failure (error code 1) [Nested exception message&#58;  Custom message&#58; Unexpected reply&#58; 426 Transfer failed due to unexpected exception&#58; java.net.ConnectException&#58; Connection refused] [Nested exception is org.globus.ftp.exception.UnexpectedReplyCodeException&#58;  Custom message&#58; Unexpected reply&#58; 426 Transfer failed due to unexpected exception&#58; java.net.ConnectException&#58; Connection refused]
org.globus.ftp.exception.ServerException&#58; Server refused performing the request. Custom message&#58; Server reported transfer failure (error code 1) [Nested exception message&#58;  Custom message&#58; Unexpected reply&#58; 426 Transfer failed due to unexpected exception&#58; java.net.ConnectException&#58; Connection refused].  Nested exception is org.globus.ftp.exception.UnexpectedReplyCodeException&#58;  Custom message&#58; Unexpected reply&#58; 426 Transfer failed due to unexpected exception&#58; java.net.ConnectException&#58; Connection refused
at org.globus.ftp.vanilla.TransferMonitor.run(TransferMonitor.java&#58;182)
at org.globus.ftp.vanilla.TransferMonitor.start(TransferMonitor.java&#58;109)
at org.globus.ftp.FTPClient.transferRunSingleThread(FTPClient.java&#58;1488)
at org.globus.ftp.FTPClient.put(FTPClient.java&#58;1310)
at org.globus.ftp.FTPClient.put(FTPClient.java&#58;1284)
at gov.lbl.srm.client.transfer.globus.SRMGridFTP.put(SRMGridFTP.java&#58;1010)
at gov.lbl.srm.client.transfer.globus.SRMGridFTP.transferSync(SRMGridFTP.java&#58;562)
at gov.lbl.srm.client.transfer.globus.SRMFileTransfer.transferSync(SRMFileTransfer.java&#58;270)
at gov.lbl.srm.client.transfer.globus.SRMFileTransfer.run(SRMFileTransfer.java&#58;217)
<div id='show_196452284' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_196452284'>SRM-CLIENT&#58; Thu Aug 14 19&#58;31&#58;12 UTC 2014 gsiftp transfer failed and error occured

SRM-CLIENT&#58; Retrying now again file 0 in 60 seconds for 1 times.
</div><script type='text/javascript'>
        $('#show_196452284').click(function() {
            $('#detail_196452284').slideDown("normal");
            $('#show_196452284').hide();
            $('#hide_196452284').show();
        });
        $('#hide_196452284').click(function() {
            $('#detail_196452284').slideUp();
            $('#hide_196452284').hide();
            $('#show_196452284').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='21255#1408037531'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-08-14T17:32:11+00:00">Aug 14, 2014 05:32 PM UTC</time> by <b>catalind@....</b><a class="anchor" name="1408037531">&nbsp;</a></div><pre>Hi

How about now? Also, what are the extensions on your proxy?

On Aug 14, 2014, at 12&#58;24 PM, Open Science Grid FootPrints &#60;osg@....&#60;mailto&#58;osg@....&#62;&#62; wrote&#58;

[Duplicate message snipped]</pre></div><div class='update_description'><i onclick="document.location='21255#1408037078'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-08-14T17:24:38+00:00">Aug 14, 2014 05:24 PM UTC</time> by <b>Soichi Hayashi</b><a class="anchor" name="1408037078">&nbsp;</a></div><pre>Sorry, I just saw your update you made 28 days ago
<font color='#7F7E6F'>&#62; Could you please try within 1 hour and let us know if you still fail the authorization?</font>

28 days is a bit longer than 1 hour.. but I just re-run the command and I am seeing the same error message.

$ srm-copy &#39;file&#58;///etc/issue&#39; &#39;<a href='srm&#58;//cmssrm.fnal.gov&#58;8443/srm/managerv2?SFN=/11/TEST/soichi.test&#39' target='_blank' rel='nofollow'>srm&#58;//cmssrm.fnal.gov&#58;8443/srm/managerv2?SFN=/11/TEST/soichi.test&#39</a>;
<font color='#7F7E6F'>&#62; Request.status=SRM_FAILURE</font>
<font color='#7F7E6F'>&#62; explanation= at Thu Aug 14 12&#58;22&#58;52 CDT 2014 state Failed &#58;  at Thu Aug 14 12&#58;22&#58;52 CDT 2014 state Pending &#58; created</font>
<font color='#7F7E6F'>&#62; RequestFileStatus#-2139044115 failed with error&#58;[  at Thu Aug 14 12&#58;22&#58;52 CDT 2014 state Failed &#58; user has no permission to create file /pnfs/fs/usr/cms/WAX/11/TEST]</font></pre></div><div class='update_description'><i onclick="document.location='21255#1407450493'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-08-07T22:28:13+00:00">Aug 7, 2014 10:28 PM UTC</time> by <b>Carl Edquist</b><a class="anchor" name="1407450493">&nbsp;</a></div><pre>Soichi, were you able to get anywhere with the test access?

Carl</pre></div><div class='update_description'><i onclick="document.location='21255#1405616180'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-07-17T16:56:20+00:00">Jul 17, 2014 04:56 PM UTC</time> by <b>catalind@....</b><a class="anchor" name="1405616180">&nbsp;</a></div><pre>Hi,
I added a special mapping for your username&#58;

+&#34;/DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=Soichi Hayashi 238&#34;

Could you please try within 1 hour and let us know if you still fail the authorization?

On Jul 17, 2014, at 11&#58;39 AM, Open Science Grid FootPrints &#60;osg@....&#60;mailto&#58;osg@....&#62;&#62; wrote&#58;

[Duplicate message snipped]</pre></div><div class='update_description'><i onclick="document.location='21255#1405615186'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-07-17T16:39:46+00:00">Jul 17, 2014 04:39 PM UTC</time> by <b>Soichi Hayashi</b><a class="anchor" name="1405615186">&nbsp;</a></div><pre>Anything new with this issue? I tried to recreate the issue, but I am seeing &#34;user has no permission&#34; error *as expected*..

<font color='#7F7E6F'>&#62; $ srm-copy &#39;file&#58;///etc/issue&#39; &#39;<a href='srm&#58;//cmssrm.fnal.gov&#58;8443/srm/managerv2?SFN=/11/TEST/soichi.test&#39' target='_blank' rel='nofollow'>srm&#58;//cmssrm.fnal.gov&#58;8443/srm/managerv2?SFN=/11/TEST/soichi.test&#39</a>;</font>
<font color='#7F7E6F'>&#62; ..</font>
<font color='#7F7E6F'>&#62; Request.status=SRM_FAILURE</font>
<font color='#7F7E6F'>&#62; explanation= at Thu Jul 17 11&#58;33&#58;02 CDT 2014 state Failed &#58;  at Thu Jul 17 11&#58;33&#58;02 CDT 2014 state Pending &#58; created</font>
<font color='#7F7E6F'>&#62; RequestFileStatus#-2140683870 failed with error&#58;[  at Thu Jul 17 11&#58;33&#58;02 CDT 2014 state Failed &#58; user has no permission to create file /pnfs/fs/usr/cms/WAX/11/TEST]</font>

Tony, can you give me an access to some test directory? My DN is &#34;/DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=Soichi Hayashi 238&#34;</pre></div><div class='update_description'><i onclick="document.location='21255#1404254579'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-07-01T22:42:59+00:00">Jul 1, 2014 10:42 PM UTC</time> by <b>Carl Edquist</b><a class="anchor" name="1404254579">&nbsp;</a></div><pre>Taking a look at the sources, this is a bit confusing...  Turns out it is a long story...

So, -gucpath and -gurlcopy (apparently synonymous) will set gucScriptPath, if a path is specified, otherwise (if the option is used and no path is specified), then SRM_HOME/bin/g-urlcopy.sh is used instead, if the property &#34;SRM.HOME&#34; is defined.  This wasn&#39;t getting used for us though, as we didn&#39;t specify those options at all before.  Also, &#34;g-urlcopy.sh&#34; doesn&#39;t actually get packaged with the osg bestman2 (nor does any other package provide it).  I do see a g-urlcopy.sh.in in the bestman2 sources, but it is just a wrapper around /usr/bin/globus-url-copy (for setting environment variables).  But I was getting the mixed successes/failures without /usr/bin/globus-url-copy installed at all, so again it&#39;s not using that or the wrapper script.

There are also apparently two bestman2 config settings, &#34;GUCPath&#34; and &#34;GURLCopy&#34;, which will get used if nothing is specified on the command line.  But I don&#39;t see any default value for these in any config files that we ship.

If nothing gets set in any of the above for a &#34;guc&#34; (glubus url copy script), which appears to be the default case, then it uses instead of the MySRMFileTransfer class instead of the GUCScriptFileTransfer class ... apparently an internal implementation?  Anyway, it looks like by default it does not use an external program.

Carl</pre></div><div class='update_description'><i onclick="document.location='21255#1404229062'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-07-01T15:37:42+00:00">Jul 1, 2014 03:37 PM UTC</time> by <b>Carl Edquist</b><a class="anchor" name="1404229062">&nbsp;</a></div><pre>Interesting!

I&#39;ll see if I can determine what gets used by default, if not /usr/bin/globus-url-copy

Thanks!
Carl</pre></div><div class='update_description'><i onclick="document.location='21255#1403900607'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-06-27T20:23:27+00:00">Jun 27, 2014 08:23 PM UTC</time> by <b>Anthony Tiradani</b><a class="anchor" name="1403900607">&nbsp;</a></div><pre>Hi Carl,

Our dcache admins showed me something interesting today.

The following command ALWAYS succeeds (on an SLF6 node with nearly the latest OSG version)&#58;

srm-copy &#39;file&#58;///etc/issue&#39; &#39;<a href='srm&#58;//cmssrm.fnal.gov&#58;8443/srm/managerv2?SFN=/11/store/unmerged/SAM/storage-probe-test-file.1400879129.17059-test123&#39' target='_blank' rel='nofollow'>srm&#58;//cmssrm.fnal.gov&#58;8443/srm/managerv2?SFN=/11/store/unmerged/SAM/storage-probe-test-file.1400879129.17059-test123&#39</a>; -gucpath /usr/bin/globus-url-copy

whereas&#58;

srm-copy &#39;file&#58;///etc/issue&#39; &#39;<a href='srm&#58;//cmssrm.fnal.gov&#58;8443/srm/managerv2?SFN=/11/store/unmerged/SAM/storage-probe-test-file.1400879129.17059-test1234&#39' target='_blank' rel='nofollow'>srm&#58;//cmssrm.fnal.gov&#58;8443/srm/managerv2?SFN=/11/store/unmerged/SAM/storage-probe-test-file.1400879129.17059-test1234&#39</a>;

doesn&#39;t.

Note the -gucpath /usr/bin/globus-url-copy argument.  This apparently tells srm-copy to use the version of globus-url-copy installed via the globus rpms.  If you don&#39;t specify that, what is srm-copy using?

The nodes are not being overloaded so I do not believe that that is the problem.

Thanks,

Tony</pre></div><div class='update_description'><i onclick="document.location='21255#1403884949'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-06-27T16:02:29+00:00">Jun 27, 2014 04:02 PM UTC</time> by <b>Carl Edquist</b><a class="anchor" name="1403884949">&nbsp;</a></div><pre>Sorry for the slow updates on this...

So, I was looking more into the failures --

<font color='#7F7E6F'>&#62; message&#58; Unexpected reply&#58; 426 Transfer failed due to unexpected exception&#58; java.net.ConnectException&#58; Connection refused</font>

the actual error is &#34;Connection refused&#34;, and given that the failures (at least for me) were intermittent, sometimes failing and sometimes succeeding, I wonder if the server is either overloaded or only configured to accept a very small number of connections at once?

Also, the stack trace shows that the exception happened inside of one of the jglobus libraries, rather than in something specific to bestman&#58;

this is from jglobus/gridftp-2.0.6.jar (from jglobus-2.0.6-3)
<font color='#7F7E6F'>&#62; at org.globus.ftp.vanilla.TransferMonitor.run(TransferMonitor.java&#58;182)</font>
<font color='#7F7E6F'>&#62; at org.globus.ftp.vanilla.TransferMonitor.start(TransferMonitor.java&#58;109)</font>
<font color='#7F7E6F'>&#62; at org.globus.ftp.FTPClient.transferRunSingleThread(FTPClient.java&#58;1488)</font>
<font color='#7F7E6F'>&#62; at org.globus.ftp.FTPClient.put(FTPClient.java&#58;1310)</font>
<font color='#7F7E6F'>&#62; at org.globus.ftp.FTPClient.put(FTPClient.java&#58;1284)</font>

and this is where the bestman2 stuff starts (bestman2/bestman2-client.jar, from bestman2-client-libs-2.3.0-17)
<font color='#7F7E6F'>&#62; at gov.lbl.srm.client.transfer.globus.SRMGridFTP.put(SRMGridFTP.java&#58;1010)</font>
<font color='#7F7E6F'>&#62; at gov.lbl.srm.client.transfer.globus.SRMGridFTP.transferSync(SRMGridFTP.java&#58;562)</font>
<font color='#7F7E6F'>&#62; at gov.lbl.srm.client.transfer.globus.SRMFileTransfer.transferSync(SRMFileTransfer.java&#58;270)</font>
<font color='#7F7E6F'>&#62; at gov.lbl.srm.client.transfer.globus.SRMFileTransfer.run(SRMFileTransfer.java&#58;217)</font>

So... if it turns out that the &#34;Connection refused&#34; errors are not just due to server load or configuration, maybe the problem is in jglobus?

Carl</pre></div><div class='update_description'><i onclick="document.location='21255#1403798215'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-06-26T15:56:55+00:00">Jun 26, 2014 03:56 PM UTC</time><a class="anchor" name="1403798215">&nbsp;</a></div><pre>Hi Carl,

Have you done any more debugging on this side?

Edgar
OSG Software Supoprt

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=Edgar Mauricio Fajardo Hernandez 2020</pre></div><div class='update_description'><i onclick="document.location='21255#1403636704'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-06-24T19:05:04+00:00">Jun 24, 2014 07:05 PM UTC</time> by <b>Anthony Tiradani</b><a class="anchor" name="1403636704">&nbsp;</a></div><pre>Hi Carl,

According to our dcache admins, all nodes have the same version of all the software that you listed.

Thanks,

Anthony Tiradani</pre></div><div class='update_description'><i onclick="document.location='21255#1403538789'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-06-23T15:53:09+00:00">Jun 23, 2014 03:53 PM UTC</time><a class="anchor" name="1403538789">&nbsp;</a></div><pre>Hi Tony,

Are there any differences between the versions of dcache, jdk, jglobus between&#58;

cmssrm.fnal.gov

and

cmssrmdisk.fnal.gov

?

Carl,

Did you have any luck setting up your dcache instance?

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=Edgar Mauricio Fajardo Hernandez 2020</pre></div><div class='update_description'><i onclick="document.location='21255#1403035674'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-06-17T20:07:54+00:00">Jun 17, 2014 08:07 PM UTC</time> by <b>Carl Edquist</b><a class="anchor" name="1403035674">&nbsp;</a></div><pre>Actually, what I noticed with the -debug option was only true for me the first handful of runs, but after that I saw both successes and failures both with and without -debug.  So, that doesn&#39;t seem to be related.

I noticed that each run would pick a different target host (where in Tony&#39;s error message it says &#34;&#60;fqdn snipped&#62;&#34;).  I tried several runs to see if the failures were specific to certain hosts, but for some hosts (eg, cmsstor223) I saw both successes and failures.  So it doesn&#39;t appear to be specific to the host either.

Carl</pre></div><div class='update_description'><i onclick="document.location='21255#1403032477'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-06-17T19:14:37+00:00">Jun 17, 2014 07:14 PM UTC</time> by <b>Carl Edquist</b><a class="anchor" name="1403032477">&nbsp;</a></div><pre>What&#39;s strange is srm-copy consistently fails (with the java error Tony reported), unless I give the -debug option, and then it consistently succeeds...

Carl</pre></div><div class='update_description'><i onclick="document.location='21255#1403031887'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-06-17T19:04:47+00:00">Jun 17, 2014 07:04 PM UTC</time> by <b>Carl Edquist</b><a class="anchor" name="1403031887">&nbsp;</a></div><pre>Tony,

I don&#39;t know if any changes were made on the cmssrmdisk.fnal.gov end today, but I just tried again and now I am getting the same error you reported..!  So at least I&#39;m able to reproduce it now.  I&#39;m going to try to dig further into it...

Thanks,
Carl</pre></div><div class='update_description'><i onclick="document.location='21255#1403021891'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-06-17T16:18:11+00:00">Jun 17, 2014 04:18 PM UTC</time> by <b>Carl Edquist</b><a class="anchor" name="1403021891">&nbsp;</a></div><pre>Thanks Tony,

I get SRM_AUTHORIZATION_FAILURE &#58; &#34;user has no permission to create file /dcache/uscmsdisk/store/LocalTests&#34; when I try to do an srm-copy ... I&#39;m attaching my log for running&#58;

srm-copy  file&#58;///tmp/test.txt &#39;<a href='srm&#58;//cmssrmdisk.fnal.gov&#58;8443/srm/managerv2?SFN=/dcache/uscmsdisk/store/LocalTests/test.txt&#39' target='_blank' rel='nofollow'>srm&#58;//cmssrmdisk.fnal.gov&#58;8443/srm/managerv2?SFN=/dcache/uscmsdisk/store/LocalTests/test.txt&#39</a>; -debug &&#62; srm-copy-debug.log

Maybe it the permissions aren&#39;t right?

I can do an srm-ls without any problems though&#58;

srm-ls &#39;<a href='srm&#58;//cmssrmdisk.fnal.gov&#58;8443/srm/managerv2?SFN=/dcache/uscmsdisk/store/LocalTests/&#39' target='_blank' rel='nofollow'>srm&#58;//cmssrmdisk.fnal.gov&#58;8443/srm/managerv2?SFN=/dcache/uscmsdisk/store/LocalTests/&#39</a>;

I&#39;m going to try to get input from Matyas also...

Carl</pre></div><div class='update_description'><i onclick="document.location='21255#1402948367'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-06-16T19:52:47+00:00">Jun 16, 2014 07:52 PM UTC</time> by <b>Anthony Tiradani</b><a class="anchor" name="1402948367">&nbsp;</a></div><pre>Hi Carl,

You&#39;ve been mapped now.  You can try writing to /dcache/uscmsdisk/store/LocalTests on cmssrmdisk.

Thanks,

Tony</pre></div><div class='update_description'><i onclick="document.location='21255#1402937414'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-06-16T16:50:14+00:00">Jun 16, 2014 04:50 PM UTC</time> by <b>Carl Edquist</b><a class="anchor" name="1402937414">&nbsp;</a></div><pre>Sure, it&#39;s

/DC=gov/DC=fnal/O=Fermilab/OU=People/CN=Carl C. Edquist/CN=UID&#58;edquist

Thanks!
Carl</pre></div><div class='update_description'><i onclick="document.location='21255#1402936718'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-06-16T16:38:38+00:00">Jun 16, 2014 04:38 PM UTC</time> by <b>Anthony Tiradani</b><a class="anchor" name="1402936718">&nbsp;</a></div><pre>Hi Carl,

Can I have your DN?  We will need that to grant you access.

Thanks,

Tony</pre></div><div class='update_description'><i onclick="document.location='21255#1402921280'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-06-16T12:21:20+00:00">Jun 16, 2014 12:21 PM UTC</time> by <b>Carl Edquist</b><a class="anchor" name="1402921280">&nbsp;</a></div><pre>Tony, did you happen to hear anything back from the dcache admins about access to cmssrm.fnal.gov?

Thanks,
Carl</pre></div><div class='update_description'><i onclick="document.location='21255#1401987490'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-06-05T16:58:10+00:00">Jun 5, 2014 04:58 PM UTC</time> by <b>Carl Edquist</b><a class="anchor" name="1401987490">&nbsp;</a></div><pre>Thanks Tony!

I don&#39;t see anything suspicious with the java versions, so that doesn&#39;t seem to be an issue.

Carl</pre></div><div class='update_description'><i onclick="document.location='21255#1401987201'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-06-05T16:53:21+00:00">Jun 5, 2014 04:53 PM UTC</time> by <b>Anthony Tiradani</b><a class="anchor" name="1401987201">&nbsp;</a></div><pre>Hi Carl,

I&#39;ll talk to our dcache admins to see what can be done to grant you access.  To answer your other questions&#58;

# javac -version
javac 1.7.0_55
# rpm -qa | egrep &#39;jdk|java&#39;
java-1.7.0-openjdk-1.7.0.55-2.4.7.1.el6_5.x86_64
osg-java7-devel-compat-openjdk-1.0-1.osg32.el6.noarch
java-1.7.0-openjdk-devel-1.7.0.55-2.4.7.1.el6_5.x86_64
glite-security-util-java-2.8.0-3.2.osg.el6.noarch
osg-java7-compat-openjdk-1.0-1.osg32.el6.noarch
java_cup-0.10k-5.el6.x86_64
voms-api-java-2.0.8-1.5.osg.el6.noarch
osg-java7-compat-1.0-1.osg32.el6.noarch
tzdata-java-2014b-1.el6.noarch
java-1.5.0-gcj-1.5.0.0-29.1.el6.x86_64
osg-java7-devel-compat-1.0-1.osg32.el6.noarch

Thanks,

Tony</pre></div><div class='update_description'><i onclick="document.location='21255#1401986949'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-06-05T16:49:09+00:00">Jun 5, 2014 04:49 PM UTC</time> by <b>Carl Edquist</b><a class="anchor" name="1401986949">&nbsp;</a></div><pre>By the way, sorry Tony for the slow progress with this one -- I&#39;ve been working on setting up a dCache server instance to test against to reproduce the failure ... Unfortunately it&#39;s a bit of a shot in the dark without any dCache server documentation on our end.  I am apparently still missing something to get my dcache server to listen on the 8443 srm port (as I see that your srm-copy command is connecting to cmssrm.fnal.gov&#58;8443) ... Anyway, I&#39;m working on it.

Otherwise, is there a path somewhere on cmssrm.fnal.gov that I can do a test write to?  I tried a srm-copy but got access errors.  However, I *am* able to do srm-ls against that server without any of the errors you were seeing... (I&#39;m using bestman2-client-2.3.0-17.osg32.el6)

As far as the java versions are concerned, for completeness you could also check the output of&#58;

javac -version
rpm -qa | egrep &#39;jdk|java&#39;

since in theory bestman2-client-libs requires java7-devel.

Carl</pre></div><div class='update_description'><i onclick="document.location='21255#1401982605'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-06-05T15:36:45+00:00">Jun 5, 2014 03:36 PM UTC</time> by <b>Soichi Hayashi</b><a class="anchor" name="1401982605">&nbsp;</a></div><pre>Brian,

Thank you for troubleshooting this issue. Do you have any further comments / suggestion for troubleshooting this issue?</pre></div><div class='update_description'><i onclick="document.location='21255#1401380086'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-05-29T16:14:46+00:00">May 29, 2014 04:14 PM UTC</time> by <b>Anthony Tiradani</b><a class="anchor" name="1401380086">&nbsp;</a></div><pre>Hi Brian,

# java -version
java version &#34;1.7.0_55&#34;
OpenJDK Runtime Environment (rhel-2.4.7.1.el6_5-x86_64 u55-b13)
OpenJDK 64-Bit Server VM (build 24.51-b03, mixed mode)

# rpm -qa | grep jglobus
cog-jglobus-axis-1.8.0-7.osg.el6.noarch
jglobus-2.0.6-3.osg.el6.noarch

Tony</pre></div><div class='update_description'><i onclick="document.location='21255#1401379797'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-05-29T16:09:57+00:00">May 29, 2014 04:09 PM UTC</time><a class="anchor" name="1401379797">&nbsp;</a></div><pre>Hi,

Check the jglobus version as the stack trace ends in jglobus code.

Also - what JDK are you using?  Can you verify it is openjdk7?

Brian

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=Brian Bockelman</pre></div><div class='update_description'><i onclick="document.location='21255#1401377808'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-05-29T15:36:48+00:00">May 29, 2014 03:36 PM UTC</time> by <b>Carl Edquist</b><a class="anchor" name="1401377808">&nbsp;</a></div><pre>Ok, so in theory it shouldn&#39;t be a sha2 issue.

I&#39;ll see if I can reproduce the failure...

Carl</pre></div><div class='update_description'><i onclick="document.location='21255#1401315313'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-05-28T22:15:13+00:00">May 28, 2014 10:15 PM UTC</time> by <b>Anthony Tiradani</b><a class="anchor" name="1401315313">&nbsp;</a></div><pre>Hi Carl,

We are running 2.2.23.

Thanks,

Anthony Tiradani</pre></div><div class='update_description'><i onclick="document.location='21255#1401314285'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-05-28T21:58:05+00:00">May 28, 2014 09:58 PM UTC</time> by <b>Carl Edquist</b><a class="anchor" name="1401314285">&nbsp;</a></div><pre>Hi Tony,

I asked Neha about this, and she said the official word from the dCache developers was that SHA2 support was backported to 2.2. &#58; since 2.2.17.

Just to rule out SHA2 issues, can you confirm what version of dcache 2.2.x you are running?

I&#39;ll also see about setting up a dcache server to try to reproduce the failures...

Thanks!
Carl</pre></div><div class='update_description'><i onclick="document.location='21255#1401288683'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-05-28T14:51:23+00:00">May 28, 2014 02:51 PM UTC</time> by <b>Tim Cartwright</b><a class="anchor" name="1401288683">&nbsp;</a></div><pre>I was expecting this ticket, so I already grabbed it and assigned it to Carl.</pre></div><div class='update_description'><i onclick="document.location='21255#1401288274'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-05-28T14:44:34+00:00">May 28, 2014 02:44 PM UTC</time> by <b>Anthony Tiradani</b><a class="anchor" name="1401288274">&nbsp;</a></div><pre>srm-copy is used by the RSV SRM probes.  srm-copy fails when run against dcache 2.2.  However, lcg-cp and srmcp work fine.  We are using the following RPMs for the bestman client&#58;

bestman2-client-2.3.0-17.osg32.el6.noarch
bestman2-client-libs-2.3.0-17.osg32.el6.noarch
bestman2-common-libs-2.3.0-17.osg32.el6.noarch

The probe output is&#58;

metricName&#58; org.osg.srm.srmcp-readwrite
metricType&#58; status
timestamp&#58; 2014-05-28 07&#58;31&#58;23 CDT
metricStatus&#58; CRITICAL
serviceType&#58; OSG-SRM
serviceURI&#58; cmssrm.fnal.gov&#58;8443
gatheredAt&#58; cmssrv205.fnal.gov
summaryData&#58; CRITICAL
detailsData&#58; Failed to transfer file to remote server.
Command&#58; srm-copy &#39;file&#58;///usr/share/rsv/probe-helper-files/storage-probe-test-file&#39; &#39;<a href='srm&#58;//cmssrm.fnal.gov&#58;8443/srm/managerv2?SFN=/11/store/unmerged/SAM/storage-probe-test-file.1401280081.23378&#39' target='_blank' rel='nofollow'>srm&#58;//cmssrm.fnal.gov&#58;8443/srm/managerv2?SFN=/11/store/unmerged/SAM/storage-probe-test-file.1401280081.23378&#39</a>; -parallelism 4 2&#62;&1
Output from srm-copy&#58;
srm-copy   2.2.2.3.0  Wed Nov  7 16&#58;03&#58;09 CST 2012

BeStMan and SRM-Clients Copyright(c) 2007-2012,
Lawrence Berkeley National Laboratory. All rights reserved.
Support at SRM@.... and documents at <a href='http&#58;//sdm.lbl.gov/bestman' target='_blank' rel='nofollow'>http&#58;//sdm.lbl.gov/bestman</a>
OSG Support at osg-software@.... and
documentation at <a href='https&#58;//www.opensciencegrid.org/bin/view/Documentation/Release3/' target='_blank' rel='nofollow'>https&#58;//www.opensciencegrid.org/bin/view/Documentation/Release3/</a>

SRM-CLIENT&#58; Wed May 28 07&#58;28&#58;02 CDT 2014 Connecting to httpg&#58;//cmssrm.fnal.gov&#58;8443/srm/managerv2

SRM-CLIENT&#58; Wed May 28 07&#58;28&#58;02 CDT 2014 Calling SrmPrepareToPutRequest now ...
request.token= -2146754029
Request.status=SRM_SUCCESS
explanation= at Wed May 28 07&#58;28&#58;07 CDT 2014 state Pending &#58; created

SRM-CLIENT&#58; RequestFileStatus for SURL=file&#58;///usr/share/rsv/probe-helper-files/storage-probe-test-file is Ready.
<div id='show_346305120' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_346305120'>SRM-CLIENT&#58; received TURL=gsiftp&#58;//&#60;fqdn snipped&#62;&#58;2811/WAX/11/store/unmerged/SAM/storage-probe-test-file.1401280081.23378

SRM-CLIENT&#58; Wed May 28 07&#58;28&#58;11 CDT 2014 start file transfer
SRM-CLIENT&#58;Source=file&#58;////usr/share/rsv/probe-helper-files/storage-probe-test-file
SRM-CLIENT&#58;Target=gsiftp&#58;//&#60;fqdn snipped&#62;&#58;2811/WAX/11/store/unmerged/SAM/storage-probe-test-file.1401280081.23378
org.globus.ftp.exception.ServerException&#58; Server refused performing the request. Custom message&#58; Server reported transfer failure (error code 1) [Nested exception message&#58;  Custom message&#58; Unexpected reply&#58; 426 Transfer failed due to unexpected exception&#58; java.net.ConnectException&#58; Connection refused] [Nested exception is org.globus.ftp.exception.UnexpectedReplyCodeException&#58;  Custom message&#58; Unexpected reply&#58; 426 Transfer failed due to unexpected exception&#58; java.net.ConnectException&#58; Connection refused]
org.globus.ftp.exception.ServerException&#58; Server refused performing the request. Custom message&#58; Server reported transfer failure (error code 1) [Nested exception message&#58;  Custom message&#58; Unexpected reply&#58; 426 Transfer failed due to unexpected exception&#58; java.net.ConnectException&#58; Connection refused].  Nested exception is org.globus.ftp.exception.UnexpectedReplyCodeException&#58;  Custom message&#58; Unexpected reply&#58; 426 Transfer failed due to unexpected exception&#58; java.net.ConnectException&#58; Connection refused
at org.globus.ftp.vanilla.TransferMonitor.run(TransferMonitor.java&#58;182)
at org.globus.ftp.vanilla.TransferMonitor.start(TransferMonitor.java&#58;109)
at org.globus.ftp.FTPClient.transferRunSingleThread(FTPClient.java&#58;1488)
at org.globus.ftp.FTPClient.put(FTPClient.java&#58;1310)
at org.globus.ftp.FTPClient.put(FTPClient.java&#58;1284)
at gov.lbl.srm.client.transfer.globus.SRMGridFTP.put(SRMGridFTP.java&#58;1010)
at gov.lbl.srm.client.transfer.globus.SRMGridFTP.transferSync(SRMGridFTP.java&#58;562)
at gov.lbl.srm.client.transfer.globus.SRMFileTransfer.transferSync(SRMFileTransfer.java&#58;270)
at gov.lbl.srm.client.transfer.globus.SRMFileTransfer.run(SRMFileTransfer.java&#58;217)
SRM-CLIENT&#58; Wed May 28 07&#58;28&#58;12 CDT 2014 gsiftp transfer failed and error occured

SRM-CLIENT&#58; Retrying now again file 0 in 60 seconds for 1 times.

</div><script type='text/javascript'>
        $('#show_346305120').click(function() {
            $('#detail_346305120').slideDown("normal");
            $('#show_346305120').hide();
            $('#hide_346305120').show();
        });
        $('#hide_346305120').click(function() {
            $('#detail_346305120').slideUp();
            $('#hide_346305120').hide();
            $('#show_346305120').show();
        });
        </script></pre></div><legend>Similar Recent Tickets <small>modified within the last 30 days</small></legend><div id="similar_tickets"><p class="muted">No similar tickets found.</p></div>
</div>
<script type="text/javascript">
function reset_anchor() {
    $("#updates .selected").removeClass("selected");
    var urls = document.location.toString().split('#'); 
    var anchor = urls[1];
    if(anchor) {
        $("a[name='"+anchor+"']").parents(".update_description").addClass("selected");
    }
}
function submitspam(ticket_id) {
    myret = confirm("Would you like to close this ticket as a security ticket, and submit the ticket content to akismet?");
    if(myret == true) {
        $.ajax("viewer/processspam?id="+ticket_id).done(function() {
            window.location.reload();
        });
    }
}

$(function() {
    reset_anchor();
    var ADDITIONAL_COOKIE_NAME = 'gocticket';
    var options = { path: '/', expires: 365};

    if(window.opener && window.opener.name == "gocticket_list") {
        v = $.cookie("closewindow");
        if(!v) {
            $("#closewindow").attr("checked", "checked"); //on by default
        } else {
            if(v == "checked") {
                $("#closewindow").attr("checked", "checked");
            }
        }
        $("#closewindow").click(function() {
            $.cookie("closewindow", $(this).attr('checked'), options);
        });
    } else {
        $("#closewindow_area").hide();
    }
    function updateTimeago() {
        $("time").timeago();
        setTimeout(updateTimeago, 30*1000);
    }
    updateTimeago();
    $(".description").focus(expand_description);
});
</script>
<hr/>
<footer>
<p>GOC Ticket Version 2.2 | <a href="https://ticket.opensciencegrid.org/goc/submit?app_issue_check=on&amp;app_issue_type=goc&amp;app_goc_url=https%3A%2F%2Fticket.opensciencegrid.org%3A443%2F21255">Report Bugs</a>
 | <a href="https://github.com/opensciencegrid/operations/blob/master/docs/privacy.md">Privacy Policy</a>
</p>

<p> <img align="top" src="images/tag_orange.png"/> Copyright 2018 The Trustees of Indiana University - Developed for Open Science Grid</p>
</footer>


</div><!--container-fluid-->
<script src="https://ticket1.grid.iu.edu:8443/socket.io/socket.io.js"></script>
<script>
var chat = io.connect('https://ticket1.grid.iu.edu:8443');
chat.on('connect', function() {
    chat.emit('authenticate', {nodekey:'', ticketid: 21255});
});
chat.on('peers', function(peers) {
    $("#peers").html("");
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('peer_disconnect', function(pid) {
    $("#peer_"+pid).hide("slow");
});
chat.on('peer_connected', function(peers) {
    //expect only 1 peer connecting, but..
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('submit', function() {
    if(confirm("This ticket was updated. Do you want to refresh?")) {
        history.go(0);
    }
});

function addPeer(pid, peer) {
    var ipinfo = "";
    if(peer.ip != undefined) {
        ipinfo = "<span class=\"ip\">"+peer.ip+"</span>";
    }
    if(chat.io.engine.id == pid) {
        //don't display myself
        return;
    }
    var html = "<li class=\"new\" id=\"peer_"+pid+"\" class=\"peer\">"+peer.name+ipinfo+"</li>";
    $("#peers").prepend(html);
    $("#peers .new").animate({bottom: 0}, 1000, function() {$(this).removeClass("new")});
}

$(function() {
    $("#ticket_form").submit(function() {
        chat.emit('submit');
        return true;
    });
});
</script>
<script>
//used by searchbox
function parseValue(value) {
    var obj = new Object();
    var tokens = value.split("\t");
    obj.str = tokens[0];
    obj.count = tokens[1];
    return obj;
}

$(function() {
    //bootstrap-2.0.4 stuff
    $(".alert-message").alert();
    $(".dropdown-toggle").dropdown();
    $("span[rel='tooltip']").tooltip();
    $("a[rel=popover]").popover();

    //activate menu that user is currently on
    $("#menu_navigator").addClass("active"); 
    $("#submenu_").addClass("active"); 

    //translate zend validation error message to bootstrap
    $(".errors").addClass("alert").addClass("alert-error");

    //enable autocomplete for search box
    $("#search").autocomplete({
        source: function( request, response ) {
            $.ajax({
                url: "search/autocomplete",
                dataType: "text",
                data: {
                    //featureClass: "P",
                    //style: "full",
                    //maxRows: 12,
                    //name_startsWith: request.term
                    q: request.term
                },
                success: function( data ) {
                    response( $.map( data.split("\n"), function( item ) {
                        if(item == "") return null;
                        return {
                            value: item
                        }
                    }));
                }
            });
        },
        select: function(event, ui) {
            document.location = "search?q="+ui.item.value;
        }
    });
    
});
</script>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-69012-13");
pageTracker._trackPageview();
} catch(err) {}
</script>

</body>
