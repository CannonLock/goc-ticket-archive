<!DOCTYPE html>
<html lang="en">
  <head>
  <base href="">
    <title>[16061] condor problems</title>    <meta charset="utf-8" />
    <meta name="verify-v1" content="na5IcAJsZVOfEkboRxuIiZ1zpZgnZiWra+nKcS7nA/o=" />
    <meta name="google-site-verification" content="DLrk3ft4s8b-S2TloLCL2LD_t6wcTjgSluf5pmiu2kA" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />
    <link href="https://ticket.opensciencegrid.org/rss" rel="alternate" type="application/rss+xml" title="GOC Ticket Update feed" />

    <style type="text/css">
      body {
        padding-top: 50px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
     #search {
            width: 300px;
     }

    </style>

<script src="https://code.jquery.com/jquery-3.0.0.js"></script>
<script src="https://code.jquery.com/jquery-migrate-3.0.1.js"></script>

   <link href="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet"/>
    <script src="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/js/bootstrap.min.js"></script>

    <link href="https://netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"/>
    <link href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/themes/smoothness/jquery-ui.min.css" rel="stylesheet"/>
 <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>


    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/js/select2.min.js"></script>

    <link href="css/ticket.css" rel="stylesheet" />
    <script src="lib/jquery.cookie.js"></script>

    <link href="images/tag_orange.png" rel="icon" type="image/png"/>
  </head>

  <body>
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>

            <a class="brand" style="padding: 6px 0px 0px 6px;" href="http://opensciencegrid.org"><img src="images/osglogo.40x30.png"/></a>
            <ul class="nav">
                <li class="dropdown"><a href="https://ticket.opensciencegrid.org/#" class="dropdown-toggle" data-toggle="dropdown">GOC Ticket <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    <li><a href="https://my.opensciencegrid.org">MyOSG</a></li>
                    <li><a href="https://oim.opensciencegrid.org">OIM</a></li>
                    <li class="active"><a href="https://ticket.opensciencegrid.org/index">Ticket</a></li>
	<li class="divider"></li>
	<li><a href="http://repo.grid.iu.edu">Repo</a></li>
	<li class="divider"></li>
	<li><a href="http://blogs.grid.iu.edu">Blog</a></li>
                    <li><a href="http://display.grid.iu.edu">Display</a></li>
                    <li><a href="http://osggoc.blogspot.com/">News</a></li>
                    </ul>
                </li>
            </ul>
            <ul class="nav pull-right">
                <li><a href="https://ticket.opensciencegrid.org/sso/">Login</a></li>            </ul>

            <div class="nav-collapse">
                <ul class="nav">
			 <li id="menu_submit"><a href="https://ticket.opensciencegrid.org/submit">Submit</a></li><li id="menu_view" class="dropdown"><a href="https://ticket.opensciencegrid.org/\#" class="dropdown-toggle" data-toggle="dropdown">View <b class="caret"></b></a><ul class="dropdown-menu"><li id="submenu_listopen"><a href="https://ticket.opensciencegrid.org/list/open">Open Tickets</a></li><li id="submenu_listrecentclose"><a href="https://ticket.opensciencegrid.org/list/recentclose">Recently Closed Tickets</a></li><li class="divider"></li><li id="submenu_alltickets"><a href="https://ticket.opensciencegrid.org/search?q=&amp;sort=id">All Tickets</a></li></ul></li>                </ul>

                <form class="navbar-search pull-right" action="https://ticket.opensciencegrid.org/viewer">
                    <input id="search" type="text" name="id" class="search-query span2" placeholder="Search Ticket" value=""/>
                </form>
            </div>
        </div>
      </div>
    </div>

<script type='text/javascript' src='lib/jquery.timeago.js'></script>
<script type='text/javascript' src='lib/byte2size.js'></script>
<style>
#updates .toolbar {
position: relative;
margin-top: 0px;
top: -10px;
font-weight: normal;
}
#updates a.anchor {
position: relative;
top: -50px;
}
#updates .selected pre {
animation:selected 2s;
animation-iteration-count: 2;
animation-direction: alternate;
-webkit-animation:selected 2s; 
-webkit-animation-iteration-count: 2;
-webkit-animation-direction: alternate;
box-shadow: inset 1px 1px 20px #9ad;
border: 1px solid #9ab;
margin: 5px 0px;
padding-left: 10px;
}
@keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ab;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
@-webkit-keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ad;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
#updates pre {
background-color: inherit;
line-height: 15px;
padding: 5px;
}
#updates .header {
color: #999;
}
#updates .update_history pre {
background-color: #eee;
color: #666;
font-size: 85%;
}
#updates .clickable {
cursor: pointer;
}
#updates .clickable:hover {
color: #D98719;
}
#updates .meta_information pre {
background-color: #fed;
}
#similar_tickets {
max-height: 300px;
overflow-y: auto;
pointer-events: none;
padding: 5px;
background-color: #f4f4f4;
}
.btn-toolbar {
margin-bottom: 0;
height: 30px;
}
#peers {
position: fixed;
bottom: 0px;
right: 0px;
z-index: 100;
list-style: none;
padding: 5px 0px 0px 5px;
margin: 0px;
background-color: white;
box-shadow: 0px 0px 10px white;
}
#peers li {
background-color: #ccc;
color: #000;
display: inline-block;
padding: 5px 10px;
margin-right: 5px;
position: relative;
}
/*
#peers li:hover {
background-color: #999;
cursor: pointer;
}
*/
#peers span.ip {
padding-left: 5px;
color: #666;
}
#peers .new {
bottom: -30px;
}
/*
#peers .me {
background-color: red;
}
*/
</style>

<div class="container-fluid">
<ul id="peers"></ul>
<div class="alert alert-danger"><a class="close" href="https://ticket.opensciencegrid.org/#" data-dismiss="alert">&times;</a>By the end of May 2018, the ticketing system at https://ticket.opensciencegrid.org will be retired and support will be provided at https://support.opensciencegrid.org. Throughout this transition the support email (help@opensciencegrid.org) will be available as a point of contact.<br><br>                                                   
                                                                                                                                                                                   
Please see the service migration page for details: https://opensciencegrid.github.io/technology/policy/service-migrations-spring-2018/#ticket</div><div id="presence" class="pull-right"></div><div class="ticketgui"><script type="text/javascript" src="lib/checktab.js"></script>

<script>
var expanded = false;
function expand_description() {
    var desc = $(".description");
    if(!expanded) {
        expanded = true;
        //expand to minheight
        var min = 250;
        if(desc.height() < min) {
            desc.animate({height: min}, 200);
        }
    }
}

$(document).ready(function() {
    $("input[name='nad']").datepicker({
        dateFormat: 'yy-mm-dd'
    });
});

</script>



<style>
.form-horizontal .control-label {
padding-top: inherit;
font-size:90%;
color:#666;
}
label {
margin-bottom: 0px;
}
.controls {
line-height: 18px;
}
</style>
<form class="form-horizontal" action="https://ticket.opensciencegrid.org/viewer/updatebasic?id=16061" method="post">
<div class="page-header">
    <h3><span class="muted">16061</span> / condor problems</h3>
</div>

<div class="row-fluid">
<div class="span5">
    <legend>Contact</legend>
    <div class="control-group">
        <label class="control-label">Full Name</label>
        <div class="controls">Michael Gallant</div>
    </div>
    <div class="control-group">
        <label class="control-label">Email</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">Phone</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">CC</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>

    <legend>Details</legend>
    <div class="control-group"><label class="control-label">Submitted Via</label><div class="controls">GOC Ticket/submit</div></div><div class="control-group"><label class="control-label">Submitter</label><div class="controls">Michael Gallant</div></div>
    <div class="control-group">
        <label class="control-label">Ticket Type</label>
        <div class="controls">Problem/Request</div>
    </div>
    <div class="control-group">
        <label class="control-label">Priority</label>
        <div class="controls">Normal</div>
    </div>
    <div class="control-group">
        <label class="control-label">Status</label>
        <div class="controls">
Closed</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action</label>
        <div class="controls">ENG Action</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action Deadline</label>
        <div class="controls flag_red">2013-10-09</div>
    </div>

</div><!--span-->
<div class="span7">
    <legend>Assignees</legend>
    <div class="assignee" style="width: 60%">Software Support (Triage) <span class="muted"> / OSG Software Team</span></div><div class="assignee" style="width: 60%">Brian Lin <span class="muted"> / OSG Software Team</span></div>    <br>

    <legend>Assignees</legend>
    TODO
    <br>

    <style>
legend.noborder {
border-bottom: none;
}
</style>

<div id="attachment-list"/>
<script>
$(function () {
    var first = true;
    $.getJSON("attachment/list/16061", function (files) {
        //console.dir(files);
        var html = "<table class=\"table table-condensed\">";
        $(files).each(function() {
            if(first) {
                first = false;
                html += "<legend class=\"noborder\">Attachmenets</legend>";
            }
            html += "<tr class=\"attachment\">";
            html += "<td><img src=\""+this.thumbnail_url+"\"/></td>";
            html += "<td><a href=\""+this.url+"\" target=\"_blank\">"+this.name+"</a></td>";
            html += "<td>"+bytesToSize(this.size, 1)+"</td>";
            html += "</tr>";
        });
        html += "</table>";
        $("#attachment-list").html(html);
    });
});

function download(url) {
    window.open(url, "_blank");
}
</script>


</div><!--span-->
</div><!--row-fluid-->


</form>

</div>
<div id="updates" style="clear: both;">
    <legend>Past Updates
    <div class="btn-toolbar pull-right toolbar">
        <div class="btn-group">
                <a class="btn btn-small" href="https://ticket.opensciencegrid.org/16061?sort=up&amp;"><i class="icon-arrow-up"></i> Sort</a>

        
        <a class="btn btn-small" href="https://ticket.opensciencegrid.org/16061?expandall=true&amp;">Expand Descriptions</a>        <a class="btn btn-small" target="_blank" href="mailto:osg@tick.globalnoc.iu.edu?subject=Open%20Science%20Grid%3A%20condor%20problems%20ISSUE%3D16061%20PROJ%3D71"><i class="icon-envelope"></i> Update w/Email</a>
        </div>
    </div><!--btn-toolbar-->
    </legend>

    <div class='update_description'><i onclick="document.location='16061#1380917931'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-10-04T20:18:51+00:00">Oct 4, 2013 08:18 PM UTC</time> by <b>Tim Cartwright</b><a class="anchor" name="1380917931">&nbsp;</a></div><pre>Seeing no objections, I am closing the ticket. It can always be re-opened, if necessary.</pre></div><div class='update_description'><i onclick="document.location='16061#1380913931'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-10-04T19:12:11+00:00">Oct 4, 2013 07:12 PM UTC</time> by <b>gallantm@....</b><a class="anchor" name="1380913931">&nbsp;</a></div><pre>Ok, thank you very much.......

Regards,
Mike
On Oct 4, 2013, at 3&#58;04 PM, Open Science Grid FootPrints wrote&#58;

<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='16061#1380913485'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-10-04T19:04:45+00:00">Oct 4, 2013 07:04 PM UTC</time> by <b>Brian Lin</b><a class="anchor" name="1380913485">&nbsp;</a></div><pre>As long as both of you are satisfied, I think this ticket can be closed.</pre></div><div class='update_description'><i onclick="document.location='16061#1380747444'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-10-02T20:57:24+00:00">Oct 2, 2013 08:57 PM UTC</time> by <b>echism</b><a class="anchor" name="1380747444">&nbsp;</a></div><pre>My update never made it into this ticket, but my test job did sail right through quite a while ago. Does anyone else wish to test?

Thank you,
Elizabeth</pre></div><div class='update_description'><i onclick="document.location='16061#1379023230'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-09-12T22:00:30+00:00">Sep 12, 2013 10:00 PM UTC</time> by <b>Brian Lin</b><a class="anchor" name="1379023230">&nbsp;</a></div><pre>Elizabeth&#58; Any luck running a test job?</pre></div><div class='update_description'><i onclick="document.location='16061#1378224902'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-09-03T16:15:02+00:00">Sep 3, 2013 04:15 PM UTC</time> by <b>Brian Lin</b><a class="anchor" name="1378224902">&nbsp;</a></div><pre>Elizabeth,

Have you had the chance to run a test job?

- Brian</pre></div><div class='update_description'><i onclick="document.location='16061#1377096605'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-08-21T14:50:05+00:00">Aug 21, 2013 02:50 PM UTC</time><a class="anchor" name="1377096605">&nbsp;</a></div><pre>ok, completed.  I just need someone from the outside to test a job against it.

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=Michael Gallant 933</pre></div><div class='update_description'><i onclick="document.location='16061#1377094886'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-08-21T14:21:26+00:00">Aug 21, 2013 02:21 PM UTC</time> by <b>Brian Lin</b><a class="anchor" name="1377094886">&nbsp;</a></div><pre>Mike&#58; Just add the line

GLOBUS_TCP_PORT_RANGE=47100,47199

into that file.</pre></div><div class='update_description'><i onclick="document.location='16061#1377093371'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-08-21T13:56:11+00:00">Aug 21, 2013 01:56 PM UTC</time><a class="anchor" name="1377093371">&nbsp;</a></div><pre>I checked the /etc/sysconfig/globus-gatekeeper and found&#58;
export GLOBUS_TCP_SOURCE_RANGE=47100,47199

Is this correct?

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=Michael Gallant 933</pre></div><div class='update_description'><i onclick="document.location='16061#1377031198'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-08-20T20:39:58+00:00">Aug 20, 2013 08:39 PM UTC</time> by <b>echism</b><a class="anchor" name="1377031198">&nbsp;</a></div><pre>Brian,

You&#39;re right! Sorry, I thought it was in there for some reason. Mike, let me know when it&#39;s in there and I&#39;ll retest.

Thank you,
Elizabeth</pre></div><div class='update_description'><i onclick="document.location='16061#1376428382'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-08-13T21:13:02+00:00">Aug 13, 2013 09:13 PM UTC</time> by <b>Brian Lin</b><a class="anchor" name="1376428382">&nbsp;</a></div><pre>Elizabeth,

GLOBUS_TCP_PORT_RANGE isn&#39;t set in the &#39;globus-gatekeeper&#39; config at all, so maybe that was the oversight here? As I understand it, the GLOBUS_TCP_PORT_RANGE sets the ephemeral incoming ports that are listened on and since it isn&#39;t set right now, it will land on a random ephemeral port and iptables will drop it since it likely wouldn&#39;t fall into its accepted ports/port range.

When you say you see your job landing on a specific port, where do you see this, on the CE itself or a worker node?

- Brian</pre></div><div class='update_description'><i onclick="document.location='16061#1376424549'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-08-13T20:09:09+00:00">Aug 13, 2013 08:09 PM UTC</time> by <b>echism</b><a class="anchor" name="1376424549">&nbsp;</a></div><pre>Hi Brian,

We typically do a contiguous range of ports for both values in my
experience. That&#39;s what I&#39;ve always recommended and what I&#39;ve always
seen, but we can do it differently. However, the problem is that the job
does not use the specified ports. It uses a port that is closed. Perhaps
I don&#39;t understand, could you take one more pass at explaining it?

thank you,
Elizabeth

On 08/13/2013 03&#58;34 PM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='16061#1376422498'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-08-13T19:34:58+00:00">Aug 13, 2013 07:34 PM UTC</time> by <b>Brian Lin</b><a class="anchor" name="1376422498">&nbsp;</a></div><pre>Michael/Elizabeth,

If I understand your situation correctly, you have a range of ports that you would like your gatekeeper to listen for jobs on, right? According to this documentation (<a href='http&#58;//www.globus.org/toolkit/docs/4.2/4.2.0/data/gridftp/admin/gridftp-admin-config-security.html#gridftp-security-firewalls' target='_blank' rel='nofollow'>http&#58;//www.globus.org/toolkit/docs/4.2/4.2.0/data/gridftp/admin/gridftp-admin-config-security.html#gridftp-security-firewalls</a>), you should set GLOBUS_TCP_PORT_RANGE in &#39;globus-gatekeeper&#39;, not GLOBUS_TCP_SOURCE_RANGE. The former is for opening incoming ports and the latter is for outgoing ports.

- Brian</pre></div><div class='update_description'><i onclick="document.location='16061#1376409988'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-08-13T16:06:28+00:00">Aug 13, 2013 04:06 PM UTC</time> by <b>echism</b><a class="anchor" name="1376409988">&nbsp;</a></div><pre>Hey software team,

This is a gentle reminder that the files you requested are available.

Thanks!
Elizabeth</pre></div><div class='update_description'><i onclick="document.location='16061#1376060465'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-08-09T15:01:05+00:00">Aug 9, 2013 03:01 PM UTC</time><a class="anchor" name="1376060465">&nbsp;</a></div><pre>I have added the globus-gatekeeper and iptables files.  Elizabeth and I didn&#39;t file much in the firewall logs (and it generates a lot of logs)l but didn&#39;t look like it was using the correct ports.

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=Michael Gallant 933</pre></div><div class='update_description'><i onclick="document.location='16061#1375112347'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-07-29T15:39:07+00:00">Jul 29, 2013 03:39 PM UTC</time> by <b>Brian Lin</b><a class="anchor" name="1375112347">&nbsp;</a></div><pre>Could you attach the &#39;/etc/sysconfig/globus-gatekeeper&#39;, the iptables config and the output from osg-system-profiler? How have you guys configured the globus firewall? In which firewall logs are you seeing these errors/ports in?</pre></div><div class='update_description'><i onclick="document.location='16061#1374268330'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-07-19T21:12:10+00:00">Jul 19, 2013 09:12 PM UTC</time> by <b>echism</b><a class="anchor" name="1374268330">&nbsp;</a></div><pre>Brian,

Specifically, commands submitted with globus-job-run such as hostname,
date, env and such all work.

Using a condor submit file and an executable (full of the same commands
working through globus-job-run) fails with a globus error 79 and
generates entries in the firewall logs as I described.

I tried to correct the port in the configs I could find, to see if the
jobs will run when they use the right port using an obscure-ish -addr
flag I found in some random condor documentation. Bash didn&#39;t like the
syntax and the script didn&#39;t like escape characters, but I did actually
get it to run eventually, but it simply did not work. Mike, all the
ports in the expected range seem to me to be refusing connections now.

Thank you,
Elizabeth

On 07/19/2013 11&#58;59 AM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='16061#1374249566'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-07-19T15:59:26+00:00">Jul 19, 2013 03:59 PM UTC</time> by <b>Brian Lin</b><a class="anchor" name="1374249566">&nbsp;</a></div><pre>Elizabeth&#58; could you provide us more details on the exact commands you ran?

Michael&#58; Could you give us the output of osg-system-profiler?

Thanks,
Brian</pre></div><div class='update_description'><i onclick="document.location='16061#1374160961'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-07-18T15:22:41+00:00">Jul 18, 2013 03:22 PM UTC</time> by <b>echism</b><a class="anchor" name="1374160961">&nbsp;</a></div><pre>I forgot to mention&#58; globus firewall is also set.

Thank you,
Elizabeth</pre></div><div class='update_description'><i onclick="document.location='16061#1374160900'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-07-18T15:21:40+00:00">Jul 18, 2013 03:21 PM UTC</time> by <b>echism</b><a class="anchor" name="1374160900">&nbsp;</a></div><pre>Hello all,

Mike is seeing some unusual occurrences with his condor CE, ILS_Compute. Globus tcp port/source ranges are set, complementary rules are in iptables, gatekeeper and condor have been restarted, and yet condor jobs are hitting strange ports that aren&#39;t open (49371 for my last job). On the submission (my) end I tried changing the out_highport and lowport paramaters and it didn&#39;t seem to do anything, the port number isn&#39;t within what I have set for my globus ranges either, and for some reason I keep hitting this exact same port. I also tried condor_submit -addr with the address and port specified, but that didn&#39;t work at all... bash hated the syntax and using an escape character made condor_submit complain. No condor_submit jobs are getting through, fork jobs are sailing through without a problem, please advise.

Thank you,
Elizabeth</pre></div><legend>Similar Recent Tickets <small>modified within the last 30 days</small></legend><div id="similar_tickets"><p class="muted">No similar tickets found.</p></div>
</div>
<script type="text/javascript">
function reset_anchor() {
    $("#updates .selected").removeClass("selected");
    var urls = document.location.toString().split('#'); 
    var anchor = urls[1];
    if(anchor) {
        $("a[name='"+anchor+"']").parents(".update_description").addClass("selected");
    }
}
function submitspam(ticket_id) {
    myret = confirm("Would you like to close this ticket as a security ticket, and submit the ticket content to akismet?");
    if(myret == true) {
        $.ajax("viewer/processspam?id="+ticket_id).done(function() {
            window.location.reload();
        });
    }
}

$(function() {
    reset_anchor();
    var ADDITIONAL_COOKIE_NAME = 'gocticket';
    var options = { path: '/', expires: 365};

    if(window.opener && window.opener.name == "gocticket_list") {
        v = $.cookie("closewindow");
        if(!v) {
            $("#closewindow").attr("checked", "checked"); //on by default
        } else {
            if(v == "checked") {
                $("#closewindow").attr("checked", "checked");
            }
        }
        $("#closewindow").click(function() {
            $.cookie("closewindow", $(this).attr('checked'), options);
        });
    } else {
        $("#closewindow_area").hide();
    }
    function updateTimeago() {
        $("time").timeago();
        setTimeout(updateTimeago, 30*1000);
    }
    updateTimeago();
    $(".description").focus(expand_description);
});
</script>
<hr/>
<footer>
<p>GOC Ticket Version 2.2 | <a href="https://ticket.opensciencegrid.org/goc/submit?app_issue_check=on&amp;app_issue_type=goc&amp;app_goc_url=https%3A%2F%2Fticket.opensciencegrid.org%3A443%2F16061">Report Bugs</a>
 | <a href="https://github.com/opensciencegrid/operations/blob/master/docs/privacy.md">Privacy Policy</a>
</p>

<p> <img align="top" src="images/tag_orange.png"/> Copyright 2018 The Trustees of Indiana University - Developed for Open Science Grid</p>
</footer>


</div><!--container-fluid-->
<script src="https://ticket1.grid.iu.edu:8443/socket.io/socket.io.js"></script>
<script>
var chat = io.connect('https://ticket1.grid.iu.edu:8443');
chat.on('connect', function() {
    chat.emit('authenticate', {nodekey:'', ticketid: 16061});
});
chat.on('peers', function(peers) {
    $("#peers").html("");
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('peer_disconnect', function(pid) {
    $("#peer_"+pid).hide("slow");
});
chat.on('peer_connected', function(peers) {
    //expect only 1 peer connecting, but..
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('submit', function() {
    if(confirm("This ticket was updated. Do you want to refresh?")) {
        history.go(0);
    }
});

function addPeer(pid, peer) {
    var ipinfo = "";
    if(peer.ip != undefined) {
        ipinfo = "<span class=\"ip\">"+peer.ip+"</span>";
    }
    if(chat.io.engine.id == pid) {
        //don't display myself
        return;
    }
    var html = "<li class=\"new\" id=\"peer_"+pid+"\" class=\"peer\">"+peer.name+ipinfo+"</li>";
    $("#peers").prepend(html);
    $("#peers .new").animate({bottom: 0}, 1000, function() {$(this).removeClass("new")});
}

$(function() {
    $("#ticket_form").submit(function() {
        chat.emit('submit');
        return true;
    });
});
</script>
<script>
//used by searchbox
function parseValue(value) {
    var obj = new Object();
    var tokens = value.split("\t");
    obj.str = tokens[0];
    obj.count = tokens[1];
    return obj;
}

$(function() {
    //bootstrap-2.0.4 stuff
    $(".alert-message").alert();
    $(".dropdown-toggle").dropdown();
    $("span[rel='tooltip']").tooltip();
    $("a[rel=popover]").popover();

    //activate menu that user is currently on
    $("#menu_navigator").addClass("active"); 
    $("#submenu_").addClass("active"); 

    //translate zend validation error message to bootstrap
    $(".errors").addClass("alert").addClass("alert-error");

    //enable autocomplete for search box
    $("#search").autocomplete({
        source: function( request, response ) {
            $.ajax({
                url: "search/autocomplete",
                dataType: "text",
                data: {
                    //featureClass: "P",
                    //style: "full",
                    //maxRows: 12,
                    //name_startsWith: request.term
                    q: request.term
                },
                success: function( data ) {
                    response( $.map( data.split("\n"), function( item ) {
                        if(item == "") return null;
                        return {
                            value: item
                        }
                    }));
                }
            });
        },
        select: function(event, ui) {
            document.location = "search?q="+ui.item.value;
        }
    });
    
});
</script>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-69012-13");
pageTracker._trackPageview();
} catch(err) {}
</script>

</body>
