<!DOCTYPE html>
<html lang="en">
  <head>
  <base href="">
    <title>[32676] ITB RabbitMQ server down</title>    <meta charset="utf-8" />
    <meta name="verify-v1" content="na5IcAJsZVOfEkboRxuIiZ1zpZgnZiWra+nKcS7nA/o=" />
    <meta name="google-site-verification" content="DLrk3ft4s8b-S2TloLCL2LD_t6wcTjgSluf5pmiu2kA" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />
    <meta name="robots" content="noindex, nofollow" />

    <style type="text/css">
      body {
        padding-top: 50px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
     #search {
            width: 300px;
     }

    </style>

<script src="https://code.jquery.com/jquery-3.0.0.js"></script>
<script src="https://code.jquery.com/jquery-migrate-3.0.1.js"></script>

   <link href="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet"/>
    <script src="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/js/bootstrap.min.js"></script>

    <link href="https://netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"/>
    <link href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/themes/smoothness/jquery-ui.min.css" rel="stylesheet"/>
 <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>


    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/js/select2.min.js"></script>

    <link href="css/ticket.css" rel="stylesheet" />
    <script src="lib/jquery.cookie.js"></script>

    <link href="images/tag_orange.png" rel="icon" type="image/png"/>
  </head>

  <body>
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>

            <a class="brand" style="padding: 6px 0px 0px 6px;" href="http://opensciencegrid.org"><img src="images/osglogo.40x30.png"/></a>
            <ul class="nav">
                <li class="dropdown"><a href="https://ticket.opensciencegrid.org/#" class="dropdown-toggle" data-toggle="dropdown">GOC Ticket <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    <li><a href="https://my.opensciencegrid.org">MyOSG</a></li>
                    <li><a href="https://oim.opensciencegrid.org">OIM</a></li>
                    <li class="active"><a href="https://ticket.opensciencegrid.org/index">Ticket</a></li>
	<li class="divider"></li>
	<li><a href="http://repo.grid.iu.edu">Repo</a></li>
	<li class="divider"></li>
	<li><a href="http://blogs.grid.iu.edu">Blog</a></li>
                    <li><a href="http://display.grid.iu.edu">Display</a></li>
                    <li><a href="http://osggoc.blogspot.com/">News</a></li>
                    </ul>
                </li>
            </ul>
            <ul class="nav pull-right">
                <li><a href="https://ticket.opensciencegrid.org/sso/">Login</a></li>            </ul>

            <div class="nav-collapse">
                <ul class="nav">
			 <li id="menu_submit"><a href="https://ticket.opensciencegrid.org/submit">Submit</a></li><li id="menu_view" class="dropdown"><a href="https://ticket.opensciencegrid.org/\#" class="dropdown-toggle" data-toggle="dropdown">View <b class="caret"></b></a><ul class="dropdown-menu"><li id="submenu_listopen"><a href="https://ticket.opensciencegrid.org/list/open">Open Tickets</a></li><li id="submenu_listrecentclose"><a href="https://ticket.opensciencegrid.org/list/recentclose">Recently Closed Tickets</a></li><li class="divider"></li><li id="submenu_alltickets"><a href="https://ticket.opensciencegrid.org/search?q=&amp;sort=id">All Tickets</a></li></ul></li>                </ul>

                <form class="navbar-search pull-right" action="https://ticket.opensciencegrid.org/viewer">
                    <input id="search" type="text" name="id" class="search-query span2" placeholder="Search Ticket" value=""/>
                </form>
            </div>
        </div>
      </div>
    </div>

<script type='text/javascript' src='lib/jquery.timeago.js'></script>
<script type='text/javascript' src='lib/byte2size.js'></script>
<style>
#updates .toolbar {
position: relative;
margin-top: 0px;
top: -10px;
font-weight: normal;
}
#updates a.anchor {
position: relative;
top: -50px;
}
#updates .selected pre {
animation:selected 2s;
animation-iteration-count: 2;
animation-direction: alternate;
-webkit-animation:selected 2s; 
-webkit-animation-iteration-count: 2;
-webkit-animation-direction: alternate;
box-shadow: inset 1px 1px 20px #9ad;
border: 1px solid #9ab;
margin: 5px 0px;
padding-left: 10px;
}
@keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ab;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
@-webkit-keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ad;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
#updates pre {
background-color: inherit;
line-height: 15px;
padding: 5px;
}
#updates .header {
color: #999;
}
#updates .update_history pre {
background-color: #eee;
color: #666;
font-size: 85%;
}
#updates .clickable {
cursor: pointer;
}
#updates .clickable:hover {
color: #D98719;
}
#updates .meta_information pre {
background-color: #fed;
}
#similar_tickets {
max-height: 300px;
overflow-y: auto;
pointer-events: none;
padding: 5px;
background-color: #f4f4f4;
}
.btn-toolbar {
margin-bottom: 0;
height: 30px;
}
#peers {
position: fixed;
bottom: 0px;
right: 0px;
z-index: 100;
list-style: none;
padding: 5px 0px 0px 5px;
margin: 0px;
background-color: white;
box-shadow: 0px 0px 10px white;
}
#peers li {
background-color: #ccc;
color: #000;
display: inline-block;
padding: 5px 10px;
margin-right: 5px;
position: relative;
}
/*
#peers li:hover {
background-color: #999;
cursor: pointer;
}
*/
#peers span.ip {
padding-left: 5px;
color: #666;
}
#peers .new {
bottom: -30px;
}
/*
#peers .me {
background-color: red;
}
*/
</style>

<div class="container-fluid">
<ul id="peers"></ul>
<div class="alert alert-danger"><a class="close" href="https://ticket.opensciencegrid.org/#" data-dismiss="alert">&times;</a>By the end of May 2018, the ticketing system at https://ticket.opensciencegrid.org will be retired and support will be provided at https://support.opensciencegrid.org. Throughout this transition the support email (help@opensciencegrid.org) will be available as a point of contact.<br><br>                                                   
                                                                                                                                                                                   
Please see the service migration page for details: https://opensciencegrid.github.io/technology/policy/service-migrations-spring-2018/#ticket</div><div id="presence" class="pull-right"></div><div class="ticketgui"><script type="text/javascript" src="lib/checktab.js"></script>

<script>
var expanded = false;
function expand_description() {
    var desc = $(".description");
    if(!expanded) {
        expanded = true;
        //expand to minheight
        var min = 250;
        if(desc.height() < min) {
            desc.animate({height: min}, 200);
        }
    }
}

$(document).ready(function() {
    $("input[name='nad']").datepicker({
        dateFormat: 'yy-mm-dd'
    });
});

</script>



<style>
.form-horizontal .control-label {
padding-top: inherit;
font-size:90%;
color:#666;
}
label {
margin-bottom: 0px;
}
.controls {
line-height: 18px;
}
</style>
<form class="form-horizontal" action="https://ticket.opensciencegrid.org/viewer/updatebasic?id=32676" method="post">
<div class="page-header">
    <h3><span class="muted">32676</span> / ITB RabbitMQ server down</h3>
</div>

<div class="row-fluid">
<div class="span5">
    <legend>Contact</legend>
    <div class="control-group">
        <label class="control-label">Full Name</label>
        <div class="controls">Kevin Retzke</div>
    </div>
    <div class="control-group">
        <label class="control-label">Email</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">Phone</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">CC</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>

    <legend>Details</legend>
    <div class="control-group"><label class="control-label">Submitted Via</label><div class="controls">GOC Ticket/submit</div></div><div class="control-group"><label class="control-label">Submitter</label><div class="controls">Kevin Retzke</div></div><div class="control-group"><label class="control-label">Ticket Links</label><div class="controls"></div></div>
    <div class="control-group">
        <label class="control-label">Ticket Type</label>
        <div class="controls">Problem/Request</div>
    </div>
    <div class="control-group">
        <label class="control-label">Priority</label>
        <div class="controls">Normal</div>
    </div>
    <div class="control-group">
        <label class="control-label">Status</label>
        <div class="controls">
Closed</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action</label>
        <div class="controls">Check for update</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action Deadline</label>
        <div class="controls flag_red">2017-04-18</div>
    </div>

</div><!--span-->
<div class="span7">
    <legend>Assignees</legend>
    <div class="assignee" style="width: 60%">Kyle Gross <span class="muted"> / OSG GOC Support Team</span></div>    <br>

    <legend>Assignees</legend>
    TODO
    <br>

    <style>
legend.noborder {
border-bottom: none;
}
</style>

<div id="attachment-list"/>
<script>
$(function () {
    var first = true;
    $.getJSON("attachment/list/32676", function (files) {
        //console.dir(files);
        var html = "<table class=\"table table-condensed\">";
        $(files).each(function() {
            if(first) {
                first = false;
                html += "<legend class=\"noborder\">Attachmenets</legend>";
            }
            html += "<tr class=\"attachment\">";
            html += "<td><img src=\""+this.thumbnail_url+"\"/></td>";
            html += "<td><a href=\""+this.url+"\" target=\"_blank\">"+this.name+"</a></td>";
            html += "<td>"+bytesToSize(this.size, 1)+"</td>";
            html += "</tr>";
        });
        html += "</table>";
        $("#attachment-list").html(html);
    });
});

function download(url) {
    window.open(url, "_blank");
}
</script>


</div><!--span-->
</div><!--row-fluid-->


</form>

</div>
<div id="updates" style="clear: both;">
    <legend>Past Updates
    <div class="btn-toolbar pull-right toolbar">
    </div><!--btn-toolbar-->
    </legend>

    <div class='update_description'><i onclick="document.location='32676#1488487361'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-03-02T20:42:41+00:00">Mar 2, 2017 08:42 PM UTC</time> by <b>Marina Krenz</b><a class="anchor" name="1488487361">&nbsp;</a></div><pre>Kevin,
I have restarted rabbitMQ, it cleared the messages.

Let me know what settings would work the best for you.

I will get in touch with the administrator of another queue to see what is going on there.</pre></div><div class='update_description'><i onclick="document.location='32676#1488471758'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-03-02T16:22:38+00:00">Mar 2, 2017 04:22 PM UTC</time><a class="anchor" name="1488471758">&nbsp;</a></div><pre>Hi Marina,
So if I understand the TTL setting correctly, any messages that have been in a queue longer than 60 seconds will be deleted? I&#39;m not sure it&#39;s working, the server has been blocked again since 18&#58;00. Also,we really don&#39;t want to lose accounting records, so I don&#39;t like that policy being applied to gracc queues. On the other hand, I don&#39;t like the thought of gracc stopping all traffic through the broker because a service is down...

So I think we (the gracc team) need to figure out what the response time to a gracc service outage should be, how many records would accumulate in that time, and how much disk space they would need, to make sure we don&#39;t block the service. Of course that doesn&#39;t help if someone else is blocking it...

Thanks,
Kevin

by /DC=org/DC=opensciencegrid/O=Open Science Grid/OU=People/CN=Kevin Retzke 3130</pre></div><div class='update_description'><i onclick="document.location='32676#1488402984'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-03-01T21:16:24+00:00">Mar 1, 2017 09:16 PM UTC</time> by <b>Marina Krenz</b><a class="anchor" name="1488402984">&nbsp;</a></div><pre>Kevin
There were transient messages that were all sitting in /usr/local/. So I applied the rules below, so those unacknowledged messages are not just sitting there anymore.

rabbitmqctl set_policy TTL &#34;.*&#34; &#39;{&#34;message-ttl&#34;&#58;60000}&#39; --apply-to queues
rabbitmqctl set_policy expiry &#34;.*&#34; &#39;{&#34;expires&#34;&#58;900000}&#39; --apply-to queues

Right now there should be enough space if you would like to resume.

Let me know if the policy needs any adjustments.
Thank you</pre></div><div class='update_description'><i onclick="document.location='32676#1488231848'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-02-27T21:44:08+00:00">Feb 27, 2017 09:44 PM UTC</time> by <b>Marina Krenz</b><a class="anchor" name="1488231848">&nbsp;</a></div><pre>Kevin,
I will take a look. As far as I know they were done with testing.</pre></div><div class='update_description'><i onclick="document.location='32676#1488221850'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-02-27T18:57:30+00:00">Feb 27, 2017 06:57 PM UTC</time><a class="anchor" name="1488221850">&nbsp;</a></div><pre>Hi Marina,

Since Friday the ITB server has been blocked due to a low disk alarm; this time it actually wasn&#39;t GRACC (I think), looks like something on the osg-nma vhost?

by /DC=org/DC=opensciencegrid/O=Open Science Grid/OU=People/CN=Kevin Retzke 3130</pre></div><div class='update_description'><i onclick="document.location='32676#1487615530'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-02-20T18:32:10+00:00">Feb 20, 2017 06:32 PM UTC</time><a class="anchor" name="1487615530">&nbsp;</a></div><pre>Yep, that worked, thanks!

by /DC=org/DC=opensciencegrid/O=Open Science Grid/OU=People/CN=Kevin Retzke 3130</pre></div><div class='update_description'><i onclick="document.location='32676#1487615407'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-02-20T18:30:07+00:00">Feb 20, 2017 06:30 PM UTC</time> by <b>Marina Krenz</b><a class="anchor" name="1487615407">&nbsp;</a></div><pre>Kevin,
I restarted the production rabbitMQ server. Please try again.</pre></div><div class='update_description'><i onclick="document.location='32676#1487614745'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-02-20T18:19:05+00:00">Feb 20, 2017 06:19 PM UTC</time><a class="anchor" name="1487614745">&nbsp;</a></div><pre>Thanks Marina.

I&#39;m getting an i/o error connecting to production. Trying with openssl s_client it sends a handshake but gets no response [1].
Yes, please reset the gratiav2 password on ITB.

Thanks,
Kevin

[1]
openssl s_client -connect event.grid.iu.edu&#58;5671 -debug
CONNECTED(00000003)
write to 0x7f8d83700000 [0x7f8d85000000] (318 bytes =&#62; 318 (0x13E))
0000 - 16 03 01 01 39 01 00 01-35 03 03 d4 46 7d 61 f0   ....9...5...F}a.
0010 - aa 51 16 3e 0b 72 8e 66-fb 59 dd e2 0e de 5d b9   .Q.&#62;.r.f.Y....].
0020 - 4c f5 3b 8b a7 95 09 95-bd 24 2c 00 00 b6 c0 30   L.;......$,....0
0030 - c0 2c c0 28 c0 24 c0 14-c0 0a 00 a5 00 a3 00 a1   .,.(.$..........
0040 - 00 9f 00 6b 00 6a 00 69-00 68 00 39 00 38 00 37   ...k.j.i.h.9.8.7
0050 - 00 36 00 88 00 87 00 86-00 85 c0 32 c0 2e c0 2a   .6.........2...*
0060 - c0 26 c0 0f c0 05 00 9d-00 3d 00 35 00 84 c0 2f   .&.......=.5.../
0070 - c0 2b c0 27 c0 23 c0 13-c0 09 00 a4 00 a2 00 a0   .+.&#39;.#..........
0080 - 00 9e 00 67 00 40 00 3f-00 3e 00 33 00 32 00 31   ...g.@.?.&#62;.3.2.1
0090 - 00 30 00 9a 00 99 00 98-00 97 00 45 00 44 00 43   .0.........E.D.C
00a0 - 00 42 c0 31 c0 2d c0 29-c0 25 c0 0e c0 04 00 9c   .B.1.-.).%......
00b0 - 00 3c 00 2f 00 96 00 41-00 07 c0 11 c0 07 c0 0c   .&#60;./...A........
00c0 - c0 02 00 05 00 04 c0 12-c0 08 00 16 00 13 00 10   ................
00d0 - 00 0d c0 0d c0 03 00 0a-00 15 00 12 00 0f 00 0c   ................
00e0 - 00 09 00 ff 02 01 00 00-55 00 0b 00 04 03 00 01   ........U.......
00f0 - 02 00 0a 00 1c 00 1a 00-17 00 19 00 1c 00 1b 00   ................
0100 - 18 00 1a 00 16 00 0e 00-0d 00 0b 00 0c 00 09 00   ................
0110 - 0a 00 23 00 00 00 0d 00-20 00 1e 06 01 06 02 06   ..#..... .......
0120 - 03 05 01 05 02 05 03 04-01 04 02 04 03 03 01 03   ................
0130 - 02 03 03 02 01 02 02 02-03 00 0f 00 01 01         ..............
read from 0x7f8d83700000 [0x7f8d85005600] (7 bytes =&#62; -1 (0xFFFFFFFFFFFFFFFF))
write&#58;errno=60
---
<div id='show_765711519' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_765711519'>no peer certificate available
---
No client certificate CA names sent
---
SSL handshake has read 0 bytes and written 318 bytes
---
New, (NONE), Cipher is (NONE)
Secure Renegotiation IS NOT supported
Compression&#58; NONE
Expansion&#58; NONE
No ALPN negotiated
SSL-Session&#58;
Protocol  &#58; TLSv1.2
Cipher    &#58; 0000
Session-ID&#58;
Session-ID-ctx&#58;
Master-Key&#58;
Key-Arg   &#58; None
PSK identity&#58; None
PSK identity hint&#58; None
SRP username&#58; None
Start Time&#58; 1487614561
Timeout   &#58; 300 (sec)
Verify return code&#58; 0 (ok)
---

by /DC=org/DC=opensciencegrid/O=Open Science Grid/OU=People/CN=Kevin Retzke 3130
</div><script type='text/javascript'>
        $('#show_765711519').click(function() {
            $('#detail_765711519').slideDown("normal");
            $('#show_765711519').hide();
            $('#hide_765711519').show();
        });
        $('#hide_765711519').click(function() {
            $('#detail_765711519').slideUp();
            $('#hide_765711519').hide();
            $('#show_765711519').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='32676#1487612711'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-02-20T17:45:11+00:00">Feb 20, 2017 05:45 PM UTC</time> by <b>Marina Krenz</b><a class="anchor" name="1487612711">&nbsp;</a></div><pre>Kevin,
Yes I saw production went down last week. Both production and ITB should be available right now. I have added configuration for disk space management and the logging (it should log only errors not the connections). I had to reinitiate the database and reenter all the hosts/users/pws. The only one I see that has issues logging is gratiav2. I can reset the pwd.  I don&#39;t see any other users generating error, at least right now.

Let me know if you are still having any trouble.
Thanks</pre></div><div class='update_description'><i onclick="document.location='32676#1487611908'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-02-20T17:31:48+00:00">Feb 20, 2017 05:31 PM UTC</time><a class="anchor" name="1487611908">&nbsp;</a></div><pre>Hi Marina,

So it looks like you&#39;re working on fixing the production server after GRACC managed to crash that too (really sorry about that, we were watching it and things looked ok, but then it got backed up overnight).
Please let me know what the status is when you have a chance, and if there&#39;s anything I can do to help you.

Thanks,
Kevin

by /DC=org/DC=opensciencegrid/O=Open Science Grid/OU=People/CN=Kevin Retzke 3130</pre></div><div class='update_description'><i onclick="document.location='32676#1487194530'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-02-15T21:35:30+00:00">Feb 15, 2017 09:35 PM UTC</time><a class="anchor" name="1487194530">&nbsp;</a></div><pre>Hi Marina,

Thanks for looking into it and restarting the server (and sorry for crashing it!). Adding more disk space is probably a good thing and would give us a bigger buffer, but may still lead to a crash if we fill that buffer. We had almost five million messages in the queue yesterday, and I&#39;m not entirely sure we really want room for more... I&#39;d rather rely on RabbitMQ&#39;s flow control putting backpressure upstream at that point.

It might be a good idea to increase the disk low watermark, the RabbitMQ docs suggest setting it to the amount of memory on the machine&#58;  <a href='https&#58;//www.rabbitmq.com/disk-alarms.html' target='_blank' rel='nofollow'>https&#58;//www.rabbitmq.com/disk-alarms.html</a>

Thanks,
Kevin

by /DC=org/DC=opensciencegrid/O=Open Science Grid/OU=People/CN=Kevin Retzke 3130</pre></div><div class='update_description'><i onclick="document.location='32676#1487191459'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-02-15T20:44:19+00:00">Feb 15, 2017 08:44 PM UTC</time> by <b>Marina Krenz</b><a class="anchor" name="1487191459">&nbsp;</a></div><pre>Kevin,
I believe the  server crashed due to the overflow in the /var directory, this is where rabbitmq files are located, including the crush dump file and the logs.
I had to remove the contents of the folder and restart the rabbitmq, it recreated all the necessary files. I have readded your usernames and the vhost. Let me know if you have any issues.
As of right now I asked our system administrator to add just a couple of extra GBs of space so I can keep an eye on the system and verify the cause of the problem. We can definitely add more space to the itb instance. Should the same changes be applied to the production?</pre></div><div class='update_description'><i onclick="document.location='32676#1487173568'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-02-15T15:46:08+00:00">Feb 15, 2017 03:46 PM UTC</time> by <b>Derek Weitzel</b><a class="anchor" name="1487173568">&nbsp;</a></div><pre>Hi Marina,

I believe this instance is a VM?  If so, we would like to request it to be resized.  We would like more RAM and disk allocated to this VM.  Appropriate values could be 2GB of memory and ~50-100GB of disk.

Kevin - Please speak up if you would like more resources than this.

Thanks,
-Derek</pre></div><div class='update_description'><i onclick="document.location='32676#1487167671'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-02-15T14:07:51+00:00">Feb 15, 2017 02:07 PM UTC</time> by <b>Marina Krenz</b><a class="anchor" name="1487167671">&nbsp;</a></div><pre>Kevin,
I will take a look.
Will keep you posted.</pre></div><div class='update_description'><i onclick="document.location='32676#1487112520'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-02-14T22:48:40+00:00">Feb 14, 2017 10:48 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1487112520">&nbsp;</a></div><pre>Hi Marina/GOC,

It appears that we (GRACC) have crashed the ITB RabbitMQ server [1]. We were running a summarization campaign, which was pushing records into the queue faster than we could pull them out. RabbitMQ seemed to be handling it fine, putting in flow control and capping the queue size [2], but after about a half hour of that it crashed. What can we do to prevent this in the future?

Thanks,
Kevin

[1]
Got response code 500 with body {&#34;error&#34;&#58;&#34;Internal Server Error&#34;,&#34;reason&#34;&#58;&#34;{error,badarg,&#92;n [{ets,lookup,[rabbit_user,&#60;&#60;&#92;&#34;gratiav2&#92;&#34;&#62;&#62;],[]},&#92;n {rabbit_misc,dirty_read,1,[{file,&#92;&#34;src/rabbit_misc.erl&#92;&#34;},{line,386}]},&#92;n {rabbit_auth_backend_internal,internal_check_user_login,2,&#92;n [{file,&#92;&#34;src/rabbit_auth_backend_internal.erl&#92;&#34;},{line,121}]},&#92;n {rabbit_access_control,try_authenticate,3,&#92;n [{file,&#92;&#34;src/rabbit_access_control.erl&#92;&#34;},{line,88}]},&#92;n {rabbit_access_control,&#39;-check_user_login/2-fun-0-&#39;,4,&#92;n [{file,&#92;&#34;src/rabbit_access_control.erl&#92;&#34;},{line,74}]},&#92;n {lists,foldl,3,[{file,&#92;&#34;lists.erl&#92;&#34;},{line,1263}]},&#92;n {rabbit_mgmt_util,is_authorized,6,&#92;n [{file,&#92;&#34;src/rabbit_mgmt_util.erl&#92;&#34;},{line,134}]},&#92;n {webmachine_resource,resource_call,3,&#92;n [{file,&#92;&#34;src/webmachine_resource.erl&#92;&#34;},{line,186}]}]}&#92;n&#34;}

[2]
<a href='https&#58;//gracc.opensciencegrid.org/dashboard/db/gracc-monitor-transfer?from=1487104299083&to=1487110223125' target='_blank' rel='nofollow'>https&#58;//gracc.opensciencegrid.org/dashboard/db/gracc-monitor-transfer?from=1487104299083&to=1487110223125</a> (see &#34;queue depth&#34; graph under &#34;summary records&#34;)

by /DC=org/DC=opensciencegrid/O=Open Science Grid/OU=People/CN=Kevin Retzke 3130</pre></div>
</div>
<script type="text/javascript">
function reset_anchor() {
    $("#updates .selected").removeClass("selected");
    var urls = document.location.toString().split('#'); 
    var anchor = urls[1];
    if(anchor) {
        $("a[name='"+anchor+"']").parents(".update_description").addClass("selected");
    }
}
function submitspam(ticket_id) {
    myret = confirm("Would you like to close this ticket as a security ticket, and submit the ticket content to akismet?");
    if(myret == true) {
        $.ajax("viewer/processspam?id="+ticket_id).done(function() {
            window.location.reload();
        });
    }
}

$(function() {
    reset_anchor();
    var ADDITIONAL_COOKIE_NAME = 'gocticket';
    var options = { path: '/', expires: 365};

    if(window.opener && window.opener.name == "gocticket_list") {
        v = $.cookie("closewindow");
        if(!v) {
            $("#closewindow").attr("checked", "checked"); //on by default
        } else {
            if(v == "checked") {
                $("#closewindow").attr("checked", "checked");
            }
        }
        $("#closewindow").click(function() {
            $.cookie("closewindow", $(this).attr('checked'), options);
        });
    } else {
        $("#closewindow_area").hide();
    }
    function updateTimeago() {
        $("time").timeago();
        setTimeout(updateTimeago, 30*1000);
    }
    updateTimeago();
    $(".description").focus(expand_description);
});
</script>
<hr/>
<footer>
<p>GOC Ticket Version 2.2 | <a href="https://ticket.opensciencegrid.org/goc/submit?app_issue_check=on&amp;app_issue_type=goc&amp;app_goc_url=https%3A%2F%2Fticket.opensciencegrid.org%3A443%2F32676">Report Bugs</a>
 | <a href="https://github.com/opensciencegrid/operations/blob/master/docs/privacy.md">Privacy Policy</a>
</p>

<p> <img align="top" src="images/tag_orange.png"/> Copyright 2018 The Trustees of Indiana University - Developed for Open Science Grid</p>
</footer>


</div><!--container-fluid-->
<script>
//used by searchbox
function parseValue(value) {
    var obj = new Object();
    var tokens = value.split("\t");
    obj.str = tokens[0];
    obj.count = tokens[1];
    return obj;
}

$(function() {
    //bootstrap-2.0.4 stuff
    $(".alert-message").alert();
    $(".dropdown-toggle").dropdown();
    $("span[rel='tooltip']").tooltip();
    $("a[rel=popover]").popover();

    //activate menu that user is currently on
    $("#menu_navigator").addClass("active"); 
    $("#submenu_").addClass("active"); 

    //translate zend validation error message to bootstrap
    $(".errors").addClass("alert").addClass("alert-error");

});
</script>


</body>
