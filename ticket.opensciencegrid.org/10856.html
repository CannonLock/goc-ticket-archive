<!DOCTYPE html>
<html lang="en">
  <head>
  <base href="">
    <title>[10856] Many transfer errors from T0 to AGLT2_CALIBDISK and the transfer efficiency is only 6%</title>    <meta charset="utf-8" />
    <meta name="verify-v1" content="na5IcAJsZVOfEkboRxuIiZ1zpZgnZiWra+nKcS7nA/o=" />
    <meta name="google-site-verification" content="DLrk3ft4s8b-S2TloLCL2LD_t6wcTjgSluf5pmiu2kA" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />
    <link href="https://ticket.opensciencegrid.org/rss" rel="alternate" type="application/rss+xml" title="GOC Ticket Update feed" />

    <style type="text/css">
      body {
        padding-top: 50px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
     #search {
            width: 300px;
     }

    </style>

<script src="https://code.jquery.com/jquery-3.0.0.js"></script>
<script src="https://code.jquery.com/jquery-migrate-3.0.1.js"></script>

   <link href="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet"/>
    <script src="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/js/bootstrap.min.js"></script>

    <link href="https://netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"/>
    <link href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/themes/smoothness/jquery-ui.min.css" rel="stylesheet"/>
 <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>


    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/js/select2.min.js"></script>

    <link href="css/ticket.css" rel="stylesheet" />
    <script src="lib/jquery.cookie.js"></script>

    <link href="images/tag_orange.png" rel="icon" type="image/png"/>
    <script src='https://www.google.com/recaptcha/api.js'></script>
  </head>

  <body>
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>

            <a class="brand" style="padding: 6px 0px 0px 6px;" href="http://opensciencegrid.org"><img src="images/osglogo.40x30.png"/></a>
            <ul class="nav">
                <li class="dropdown"><a href="https://ticket.opensciencegrid.org/#" class="dropdown-toggle" data-toggle="dropdown">GOC Ticket <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    <li><a href="https://my.opensciencegrid.org">MyOSG</a></li>
                    <li><a href="https://oim.opensciencegrid.org">OIM</a></li>
                    <li class="active"><a href="https://ticket.opensciencegrid.org/index">Ticket</a></li>
	<li class="divider"></li>
	<li><a href="http://repo.grid.iu.edu">Repo</a></li>
	<li class="divider"></li>
	<li><a href="http://blogs.grid.iu.edu">Blog</a></li>
                    <li><a href="http://display.grid.iu.edu">Display</a></li>
                    <li><a href="http://osggoc.blogspot.com/">News</a></li>
                    </ul>
                </li>
            </ul>
            <ul class="nav pull-right">
                <li><a href="https://ticket.opensciencegrid.org/sso/">Login</a></li>            </ul>

            <div class="nav-collapse">
                <ul class="nav">
			 <li id="menu_submit"><a href="https://ticket.opensciencegrid.org/submit">Submit</a></li><li id="menu_view" class="dropdown"><a href="https://ticket.opensciencegrid.org/\#" class="dropdown-toggle" data-toggle="dropdown">View <b class="caret"></b></a><ul class="dropdown-menu"><li id="submenu_listopen"><a href="https://ticket.opensciencegrid.org/list/open">Open Tickets</a></li><li id="submenu_listrecentclose"><a href="https://ticket.opensciencegrid.org/list/recentclose">Recently Closed Tickets</a></li><li class="divider"></li><li id="submenu_alltickets"><a href="https://ticket.opensciencegrid.org/search?q=&amp;sort=id">All Tickets</a></li></ul></li>                </ul>

                <form class="navbar-search pull-right" action="https://ticket.opensciencegrid.org/viewer">
                    <input id="search" type="text" name="id" class="search-query span2" placeholder="Search Ticket" value=""/>
                </form>
            </div>
        </div>
      </div>
    </div>

<script type='text/javascript' src='lib/jquery.timeago.js'></script>
<script type='text/javascript' src='lib/byte2size.js'></script>
<style>
#updates .toolbar {
position: relative;
margin-top: 0px;
top: -10px;
font-weight: normal;
}
#updates a.anchor {
position: relative;
top: -50px;
}
#updates .selected pre {
animation:selected 2s;
animation-iteration-count: 2;
animation-direction: alternate;
-webkit-animation:selected 2s; 
-webkit-animation-iteration-count: 2;
-webkit-animation-direction: alternate;
box-shadow: inset 1px 1px 20px #9ad;
border: 1px solid #9ab;
margin: 5px 0px;
padding-left: 10px;
}
@keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ab;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
@-webkit-keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ad;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
#updates pre {
background-color: inherit;
line-height: 15px;
padding: 5px;
}
#updates .header {
color: #999;
}
#updates .update_history pre {
background-color: #eee;
color: #666;
font-size: 85%;
}
#updates .clickable {
cursor: pointer;
}
#updates .clickable:hover {
color: #D98719;
}
#updates .meta_information pre {
background-color: #fed;
}
#similar_tickets {
max-height: 300px;
overflow-y: auto;
pointer-events: none;
padding: 5px;
background-color: #f4f4f4;
}
.btn-toolbar {
margin-bottom: 0;
height: 30px;
}
#peers {
position: fixed;
bottom: 0px;
right: 0px;
z-index: 100;
list-style: none;
padding: 5px 0px 0px 5px;
margin: 0px;
background-color: white;
box-shadow: 0px 0px 10px white;
}
#peers li {
background-color: #ccc;
color: #000;
display: inline-block;
padding: 5px 10px;
margin-right: 5px;
position: relative;
}
/*
#peers li:hover {
background-color: #999;
cursor: pointer;
}
*/
#peers span.ip {
padding-left: 5px;
color: #666;
}
#peers .new {
bottom: -30px;
}
/*
#peers .me {
background-color: red;
}
*/
</style>

<div class="container-fluid">
<ul id="peers"></ul>
<div class="alert alert-danger"><a class="close" href="https://ticket.opensciencegrid.org/#" data-dismiss="alert">&times;</a>By the end of May 2018, the ticketing system at https://ticket.opensciencegrid.org will be retired and support will be provided at https://support.opensciencegrid.org. Throughout this transition the support email (help@opensciencegrid.org) will be available as a point of contact.<br><br>                                                   
                                                                                                                                                                                   
Please see the service migration page for details: https://opensciencegrid.github.io/technology/policy/service-migrations-spring-2018/#ticket</div><div id="presence" class="pull-right"></div><div class="ticketgui"><script type="text/javascript" src="lib/checktab.js"></script>

<script>
var expanded = false;
function expand_description() {
    var desc = $(".description");
    if(!expanded) {
        expanded = true;
        //expand to minheight
        var min = 250;
        if(desc.height() < min) {
            desc.animate({height: min}, 200);
        }
    }
}

$(document).ready(function() {
    $("input[name='nad']").datepicker({
        dateFormat: 'yy-mm-dd'
    });
});

</script>



<style>
.form-horizontal .control-label {
padding-top: inherit;
font-size:90%;
color:#666;
}
label {
margin-bottom: 0px;
}
.controls {
line-height: 18px;
}
</style>
<form class="form-horizontal" action="https://ticket.opensciencegrid.org/viewer/updatebasic?id=10856" method="post">
<div class="page-header">
    <h3><span class="muted">10856</span> / Many transfer errors from T0 to AGLT2_CALIBDISK and the transfer efficiency is only 6%</h3>
</div>

<div class="row-fluid">
<div class="span5">
    <legend>Contact</legend>
    <div class="control-group">
        <label class="control-label">Full Name</label>
        <div class="controls">CompAtP1Shift </div>
    </div>
    <div class="control-group">
        <label class="control-label">Email</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">Phone</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">CC</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>

    <legend>Details</legend>
    <div class="control-group"><label class="control-label">Associated VO</label><div class="controls">ATLAS</div></div><div class="control-group"><label class="control-label">Submitted Via</label><div class="controls">GGUS</div></div><div class="control-group"><label class="control-label">Submitter</label><div class="controls"> CompAtP1Shift</div></div><div class="control-group"><label class="control-label">Support Center</label><div class="controls">USATLAS</div></div>
    <div class="control-group">
        <label class="control-label">Ticket Type</label>
        <div class="controls">Problem/Request</div>
    </div>
    <div class="control-group">
        <label class="control-label">Priority</label>
        <div class="controls">Elevated</div>
    </div>
    <div class="control-group">
        <label class="control-label">Status</label>
        <div class="controls">
Closed</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action</label>
        <div class="controls">Check for updates</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action Deadline</label>
        <div class="controls flag_red">2011-10-07</div>
    </div>

</div><!--span-->
<div class="span7">
    <legend>Assignees</legend>
    <div class="assignee" style="width: 60%">OSG RA <span class="muted"> / OSG GOC Support Team</span></div><div class="assignee" style="width: 60%">Tanya Levshina <span class="muted"> / OSG Storage Team</span></div><div class="assignee" style="width: 60%">GGUS (Prod)&nbsp;<a target="_blank" href="https://ggus.eu/ws/ticket_info.php?ticket=73463">73463</a> <span class="muted"> / Ticket Exchange</span></div><div class="assignee" style="width: 60%">USATLAS (BNL Prod)&nbsp;<a target="_blank" href="https://rt.racf.bnl.gov/rt/Ticket/Display.html?id=20727">20727</a> <span class="muted"> / Ticket Exchange</span></div>    <br>

    <legend>Assignees</legend>
    TODO
    <br>

    <style>
legend.noborder {
border-bottom: none;
}
</style>

<div id="attachment-list"/>
<script>
$(function () {
    var first = true;
    $.getJSON("attachment/list/10856", function (files) {
        //console.dir(files);
        var html = "<table class=\"table table-condensed\">";
        $(files).each(function() {
            if(first) {
                first = false;
                html += "<legend class=\"noborder\">Attachmenets</legend>";
            }
            html += "<tr class=\"attachment\">";
            html += "<td><img src=\""+this.thumbnail_url+"\"/></td>";
            html += "<td><a href=\""+this.url+"\" target=\"_blank\">"+this.name+"</a></td>";
            html += "<td>"+bytesToSize(this.size, 1)+"</td>";
            html += "</tr>";
        });
        html += "</table>";
        $("#attachment-list").html(html);
    });
});

function download(url) {
    window.open(url, "_blank");
}
</script>


</div><!--span-->
</div><!--row-fluid-->


</form>

</div>
<div id="updates" style="clear: both;">
    <legend>Past Updates
    <div class="btn-toolbar pull-right toolbar">
        <div class="btn-group">
                <a class="btn btn-small" href="https://ticket.opensciencegrid.org/10856?sort=up&amp;"><i class="icon-arrow-up"></i> Sort</a>

        
        <a class="btn btn-small" href="https://ticket.opensciencegrid.org/10856?expandall=true&amp;">Expand Descriptions</a>        <a class="btn btn-small" target="_blank" href="mailto:osg@tick.globalnoc.iu.edu?subject=Open%20Science%20Grid%3A%20Many%20transfer%20errors%20from%20T0%20to%20AGLT2_CALIBDISK%20and%20the%20transfer%20efficiency%20is%20only%206%25%20ISSUE%3D10856%20PROJ%3D71"><i class="icon-envelope"></i> Update w/Email</a>
        </div>
    </div><!--btn-toolbar-->
    </legend>

    <div class='update_description'><i onclick="document.location='10856#1317643256'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-10-03T12:00:56+00:00">Oct 3, 2011 12:00 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1317643256">&nbsp;</a></div><pre>The problem has been found and fixed.   The original path from CERN to AGLT2 was being adversely impacted by some traffic prioritization rules put in place to manage the LHCOPN policy.   This has been successfully addressed last week on Friday, September 30th.  The routing was reverted to prefer the original path and muon calibration transfers have been running well without backlogs since then.

I am closing this ticket.

Shawn McKee/AGLT2

-- by Shawn McKee at Mon Oct 03 11&#58;59&#58;07 UTC 2011

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=73463' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=73463</a></pre></div><div class='update_description'><i onclick="document.location='10856#1317301331'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-09-29T13:02:11+00:00">Sep 29, 2011 01:02 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1317301331">&nbsp;</a></div><pre>We have some progress to report. Detailed perfSONAR-PS testing has indicated a
problem with the existing WAN path between CERN and AGLT2. Because of this CERN
has changed the WAN path preferences to favor another path and this has
resulted in significantly increased transfer-rates since about 12&#58;40 PM (CERN
time) today. You can see the current FTS transfers at&#58;

<a href='https&#58;//fts-monitor.cern.ch/ftsmonitor/fts-t2-service/ftschannel.php?channel=CERN-MICHIGAN' target='_blank' rel='nofollow'>https&#58;//fts-monitor.cern.ch/ftsmonitor/fts-t2-service/ftschannel.php?channel=CERN-MICHIGAN</a>

Rates for some file transfers are now exceeding 70 MiB/sec. We will keep the
current routing in place until we can find the problem along the original path
and fix it.

For now muon calibrations to AGLT2 should be much faster and have significantly
lower latencies for getting datasets.

Shawn
-- by smckee@.... at Thu Sep 29 13&#58;02&#58;03 UTC 2011

GOCTX Source&#58; BNL Ticket&#58; Queue=GLTier2 ID=20727</pre></div><div class='update_description'><i onclick="document.location='10856#1317110342'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-09-27T07:59:02+00:00">Sep 27, 2011 07:59 AM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1317110342">&nbsp;</a></div><pre>I&#39;ve just deleted the data11 CERN-AGLT2 subscriptions and recreated them with source BNL-OSG2_DATATAPE.

Dan (AMOD)
-- by  dvanders/CN=673610/CN=Daniel Colin Van Der Ster
at Tue Sep 27 07&#58;57&#58;15 UTC 2011

Added cross reference to GGUS-Ticket-ID&#58; #74594
See additional information there.
-- by Alessandra Forti at Mon Sep 26 16&#58;20&#58;40 UTC 2011

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=73463' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=73463</a></pre></div><div class='update_description'><i onclick="document.location='10856#1316813472'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-09-23T21:31:12+00:00">Sep 23, 2011 09:31 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1316813472">&nbsp;</a></div><pre>Added attachment CERN_AGLT2_network_diagnosis.pdf

-- by Shawn McKee at Fri Sep 23 21&#58;29&#58;36 UTC 2011

I am updating this ticket with recent results from the perfSONAR-PS monitoring we have put into place.  The attached PDF report summarizes the current situation.  There seems to be a problem with the network path  in use between CERN and AGLT2.  perfSONAR-PS results indicate the problem is likely not at the AGLT2 end since other sites, even across the Atlantic are able to get better transfer rates and have less loss events.

Next steps&#58; we need to find a perfSONAR-PS instance mid-way along the network path so we can setup additional tests to narrow the problem location.

Shawn
-- by Shawn McKee at Fri Sep 23 21&#58;29&#58;36 UTC 2011

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=73463' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=73463</a></pre></div><div class='update_description'><i onclick="document.location='10856#1316538187'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-09-20T17:03:07+00:00">Sep 20, 2011 05:03 PM UTC</time> by <b>Tanya Levshina</b><a class="anchor" name="1316538187">&nbsp;</a></div><pre>This is an automatic reply. I am attending EGI Technical Forum. I will return on September 26th. I will be checking my emails when possible, but please expect a delay in reply.

If you have any questions regarding OSG Storage projects please send e-mail to osg-storage@....

If you have any questions regarding VOMRS   projects please send e-mail to priv-project@.....

If you have any problems with VOMRS instances at CERN  please send e-mail to vomrs-grid-support@.....

Thanks,
Tanya</pre></div><div class='update_description'><i onclick="document.location='10856#1316537977'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-09-20T16:59:37+00:00">Sep 20, 2011 04:59 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1316537977">&nbsp;</a></div><pre>Info on traceroutes from AGLT2 side&#58;

Below are the traceroutes from two of our data server nodes, one at the UM site and one at MSU.

The data source at CERN for one particular transfer was lxfsrb5409.cern.ch.

Traceroute from UM node UMFS01.AGLT2.ORG&#58;

[root@umfs01 ~]# traceroute lxfsrb5409.cern.ch
traceroute to lxfsrb5409.cern.ch (128.142.221.230), 30 hops max, 40 byte packets
1  nile.aglt2.or.230.41.192.in-addr.arpa (192.41.230.2)  1.657 ms  1.649 ms  1.643 ms
2  192.65.196.245 (192.65.196.245)  17.786 ms  17.825 ms  17.861 ms
3  GVA2-CHI.uslhcnet.org (192.65.196.225)  138.145 ms  138.245 ms  138.245 ms
4  GVA1-GVA2.uslhcnet.org (192.65.196.237)  134.589 ms  134.597 ms  134.594 ms
5  e513-e-rbrxl-1-te3.cern.ch (192.65.184.153)  131.295 ms  131.422 ms  131.652 ms
6  * * *
7  * * *
….
28  * * *
29  * * *
30  * * *

Traceroute from MSU node MSUFS01.AGLT2.ORG&#58;

[root@msufs01 ~]# traceroute lxfsrb5409.cern.ch
traceroute to lxfsrb5409.cern.ch (128.142.221.230), 30 hops max, 40 byte packets
1  192.41.236.1 (192.41.236.1)  0.631 ms  1.136 ms  1.196 ms
2  198.32.43.157 (198.32.43.157)  5.669 ms  5.821 ms  5.958 ms
3  198.32.43.206 (198.32.43.206)  123.806 ms  123.916 ms  124.100 ms
4  192.65.196.197 (192.65.196.197)  129.066 ms  129.134 ms  129.129 ms
5  e513-e-rbrxl-1-te3.cern.ch (192.65.184.153)  129.101 ms  129.097 ms  129.091 ms
6  * * *
7  * * *
…
29  * * *
<div id='show_1720411130' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_1720411130'>30  * * *

Can we get the traceroutes from the CERN end?  One set from perfsonar-ps.cern.ch and one from lxfsrb5409.cern.ch ?

Thanks,

Shawn

-- by Shawn McKee at Tue Sep 20 16&#58;58&#58;38 UTC 2011

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=73463' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=73463</a>
</div><script type='text/javascript'>
        $('#show_1720411130').click(function() {
            $('#detail_1720411130').slideDown("normal");
            $('#show_1720411130').hide();
            $('#hide_1720411130').show();
        });
        $('#hide_1720411130').click(function() {
            $('#detail_1720411130').slideUp();
            $('#hide_1720411130').hide();
            $('#show_1720411130').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='10856#1316537917'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-09-20T16:58:37+00:00">Sep 20, 2011 04:58 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1316537917">&nbsp;</a></div><pre>Update&#58;  We are implementing testing from the LHCOPN perfSONAR-PS instances at CERN to AGLT2 to help diagnose the issue.  Full details pasted below from a separate ongoing email thread.   Additionally we are requesting traceroute information from lxfsrb5409.cern.ch to both umfs01.aglt2.org and msufs01.aglt2.org and the same traceroute info from perfsonar-ps.cern.ch to those hosts.

Details follow&#58;

The bandwidth we are seeing for the Muon calibration transfers is about 1.5 MB/sec using 5 streams to send each file.    Since we send 4 files at a time on the FTS channel the total bandwidth is 6MB/sec.    This is insufficient in two ways&#58;  1) large files cannot complete transferring before the 3600 second FTS timeout, and, 2) the latency to get complete large datasets is too long to be useful for our 24 hour muon calibration cycle.   The data-path in this case is from CERN to AGLT2.  Before July 2011, the typical bandwidth per file was 12-15MB/sec.  Something changed in July.    We saw a period in August where the per file transfer rate “soared” to 45-70 MB/sec per file!  No one found any reason for that brief excellent performance.

The latency measurement is interesting for us for the following reason.  The way the OWAMP (latency) tests work is by sending 10 packets/sec (UDP) to each test-point, all the time.  While the one-way delay is measured by using well-configured NTP on each end, the important metric for me is how many of the 600 UDP packets sent each minute are lost.  This is an indicator of the capacity and “clean-ness” of the link.   In the case of congestion along the path  (or misconfiguration along the path) we would see packet loss.   For TCP flow (especially with large round-trip times) the achievable bandwidth can be directly related to the observed packet loss by “Mathis’s” formula&#58;

Thus my interest in determining if packet-loss may be playing a role in limiting the muon calibration transfer rate. Remember the RTT for CERN-AGLT2 is much larger than from CERN to the other 2 muon calibration centers.

Is it true that your two perfSONAR-ps instances share a *single* 1 Gbps “uplink” to the rest of the world?  If this is the case you really need to reconfigure your topology, or, as you note, packet loss may result when the throughput tests are using *all* of the bandwidth, giving a false indication of a problem along the path.    Part of the usefulness of the OWAMP testing is the packet loss.   Even if your topology is bottlenecked by a single 1Gbps uplink serving both nodes, the amount of traffic sent by OWAMP is minor (22 bytes of data per packet+header * 10/sec) so I wouldn’t expect “local” packet loss just from the two local perfsonar instances if there is any reasonable network buffering locally. (Throughput tests typically use at most about 90-95% of the bandwidth on a 1Gbps connection for clean paths between test points)

For access to the web interfaces of perfsonar-ps.cern.ch and perfsonar-ps2.cern.ch can you add this single IP&#58;  141.213.133.204 ?

I will lookup the data source IP at CERN which most recently failed to transfer a file to our site and send you the traceroute to it from a data-destination at both the UM and MSU sites in the next email.

Thanks,

Shawn

-- by Shawn McKee at Tue Sep 20 16&#58;58&#58;03 UTC 2011

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=73463' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=73463</a></pre></div><div class='update_description'><i onclick="document.location='10856#1316009984'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-09-14T14:19:44+00:00">Sep 14, 2011 02:19 PM UTC</time><a class="anchor" name="1316009984">&nbsp;</a></div><pre>Hi,

The current status&#58;

1) The FTS configuration is currently 4 files, 5 streams each. Average file transfer rate is about 1.5 MiB/sec.  This will limit the file size that can be transferred within the 3600 second timeout to about 5.4 GiB.   Of course some files are transferring at rates below 1.5 MiB/sec.  We see larger files (&#62;4 GiB) failing to transfer within the window.  The successful tranfer rate is relatively high (&#62;&#62;6%) but see below.

2) The number of calibration datasets in &#39;Ready&#39; state is increasing because we are unable to transfer the data faster than it is coming in.

3) Our Calibration site is not able to be used because of the increasing data backlog and large dataset latencies

How can we escalate this issue?

We believe the we need a &#34;network test point&#34; on the same subnet as the Calibration data servers at CERN.   The easiest thing to do would be to install a perfSONAR-PS latency instance which we can use for testing between CERN and AGLT2.

Can someone knowledgeable about the calibration data path at CERN provide some details into this ticket?  What are the subnets at CERN which are the source for the data transfers for muon calibration?   We want to verify that the data routing is well understood to make progress on locating the reason for the relatively slow transfers.

As a reminder, prior to July 2011 we were seeing typical file transfer rates of 12-15 MiB/sec.   Also, I showed that there was a brief period in August (I sent a PDF) where the muon calibration FTS file transfers to AGLT2 were running at 50-70 MiB/sec.  No one replied with any ideas about what may have occurred to improve things in that time window.

Shawn McKee/AGLT2

-- by Shawn McKee</pre></div><div class='update_description'><i onclick="document.location='10856#1315407968'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-09-07T15:06:08+00:00">Sep 7, 2011 03:06 PM UTC</time> by <b>Tanya Levshina</b><a class="anchor" name="1315407968">&nbsp;</a></div><pre>This is an automatic reply. I am on vacation. I will return on September 17th. I will read your message when I return.

If you have any questions regarding OSG Storage projects please send e-mail to osg-storage@....

If you have any questions regarding VOMRS   projects please send e-mail to priv-project@.....

If you have any problems with VOMRS instances at CERN  please send e-mail to vomrs-grid-support@.....

Thanks,
Tanya</pre></div><div class='update_description'><i onclick="document.location='10856#1315407752'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-09-07T15:02:32+00:00">Sep 7, 2011 03:02 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1315407752">&nbsp;</a></div><pre>What is the status of this problem? ATLAS is currently data with stable beams. I hope this can be fixed soon.
-- by  CompAtP1Shift at Wed Sep 07 15&#58;01&#58;10 UTC 2011

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=73463' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=73463</a></pre></div><div class='update_description'><i onclick="document.location='10856#1315134967'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-09-04T11:16:07+00:00">Sep 4, 2011 11:16 AM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1315134967">&nbsp;</a></div><pre>Any news on this?
-- by Alessandra Forti at Sun Sep 04 11&#58;14&#58;20 UTC 2011

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=73463' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=73463</a></pre></div><div class='update_description'><i onclick="document.location='10856#1314274593'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-08-25T12:16:33+00:00">Aug 25, 2011 12:16 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1314274593">&nbsp;</a></div><pre>Hi,

I have been watching the transfers. The timeouts happen when the rate is too
low to complete a transfer within the 3600 second timeout on the FTS channel.
See
<a href='https&#58;//fts-monitor.cern.ch/ftsmonitor/fts-t2-service/ftschannel.php?channel=CERN-MICHIGAN&vo=atlas#config' target='_blank' rel='nofollow'>https&#58;//fts-monitor.cern.ch/ftsmonitor/fts-t2-service/ftschannel.php?channel=CERN-MICHIGAN&vo=atlas#config</a>
for channel configuration information.

I did notice a very significant change in the transfer rates yesterday (see
attached PDF). The file transfer rates jumped from 1-2 MiB/sec up to 55-65
MiB/sec for a while. I would like to understand what may have caused that
change. Currently we seem to be back to the very slow rates we have seen since
early July.

There have been perfSONAR tests setup from perfsonar-ps2.cern.ch to
psum01.aglt2.org and psmsu01.aglt2.org. I need to get access to that perfSONAR
node at CERN to explore the test results.

Shawn McKee/AGLT2
-- by smckee@.... at Thu Aug 25 12&#58;16&#58;24 UTC 2011

GOCTX Source&#58; BNL Ticket&#58; Queue=GLTier2 ID=20727</pre></div><div class='update_description'><i onclick="document.location='10856#1314258319'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-08-25T07:45:19+00:00">Aug 25, 2011 07:45 AM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1314258319">&nbsp;</a></div><pre>Hi,

we noticed AGLT2_CALIBDISK is building up backlogs since 17 Aug.  We think it&#39;s still because the transfer is not stable as there are still transfer errors like the following&#58;

===
[FTS] FTS State [Failed] FTS Retries [1] Reason [TRANSFER error during TRANSFER phase&#58; [TRANSFER_TIMEOUT] gri
dftp_copy_wait&#58; Connection timed out] Duration [0]
===

could you please have a look again?  Thanks!

I am re-opening the ticket.

Cheers, Hurng
-- by LEE Hurng-Chun  at Thu Aug 25 07&#58;44&#58;10 UTC 2011

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=73463' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=73463</a></pre></div><div class='update_description'><i onclick="document.location='10856#1313435532'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-08-15T19:12:12+00:00">Aug 15, 2011 07:12 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1313435532">&nbsp;</a></div><pre>Hi Shawn,

thank for detailed update.
that&#39;s the long standing problem. I suggest to close the ticket or to put in on hold.
I&#39;ll update elog.

Elena

-- by elena korolkova at Mon Aug 15 19&#58;11&#58;39 UTC 2011

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=73463' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=73463</a></pre></div><div class='update_description'><i onclick="document.location='10856#1313410818'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-08-15T12:20:18+00:00">Aug 15, 2011 12:20 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1313410818">&nbsp;</a></div><pre>The transfer timeouts are happening because the larger calibration files are
not able to finish transferring within 3600 seconds (the timeout value).

We are working on the problem in the following ways&#58;

1) There has been a request to change the CERN-MICHIGAN FTS channel from 2
files, 5 streams to 4 files, 2 streams (see

<a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=73359' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=73359</a> where the robot cert privilege
request is made)

2) We have seen the prior to a network change at AGLT2 at the beginning of
July, transfers were much faster. We are working with the network providers to
try to isolate any problems created during that transition.

3) We have requested access to or information about any perfSONAR instances at
CERN which might be used to help diagnose/test the network path to AGLT2

It is possible that most transfer failures due to timeouts would stop if the
timeout was doubled to 7200 seconds until we can determine the location of the
problem in the network path.

Shawn McKee
-- by smckee@.... at Mon Aug 15 12&#58;20&#58;11 UTC 2011

GOCTX Source&#58; BNL Ticket&#58; Queue=GLTier2 ID=20727</pre></div><div class='update_description'><i onclick="document.location='10856#1313342197'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2011-08-14T17:16:37+00:00">Aug 14, 2011 05:16 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1313342197">&nbsp;</a></div><pre>many transfer errors from T0 to AGLT2_CALIBDISK

Detailed description&#58;
[FTS] FTS State [Failed] FTS Retries [1] Reason [TRANSFER error during TRANSFER phase&#58; [TRANSFER_TIMEOUT] gri
dftp_copy_wait&#58; Connection timed out] Duration [0]

One of the example&#58;
2011-08-14 16&#58;30&#58;52	data11_7TeV.00186877.physics_Muons.merge.NTUP_MUONCALIB.f394_m932._0202.1	FAILED_TRANSFER
GUID&#58; 	bb22ff26-c257-11e0-ba19-003048f0e3fa
TOOL ID&#58; 	DQ2	ATTEMPT&#58; 	1
SRC SURL&#58; 	<a href='srm&#58;//srm-atlas.cern.ch/castor/cern.ch/grid/atlas/tzero/prod1/perm/data11_7TeV/physics_Muons/00186877/data11_7TeV.00186877.physics_Muons.merge.NTUP_MUONCALIB.f394_m932/data11_7TeV.00186877.physics_Muons.merge.NTUP_MUONCALIB.f394_m932._0202.1' target='_blank' rel='nofollow'>srm&#58;//srm-atlas.cern.ch/castor/cern.ch/grid/atlas/tzero/prod1/perm/data11_7TeV/physics_Muons/00186877/data11_7TeV.00186877.physics_Muons.merge.NTUP_MUONCALIB.f394_m932/data11_7TeV.00186877.physics_Muons.merge.NTUP_MUONCALIB.f394_m932._0202.1</a>
DEST SURL&#58; 	<a href='srm&#58;//head01.aglt2.org&#58;8443/srm/managerv2?SFN=/pnfs/aglt2.org/atlascalibdisk/data11_7TeV/NTUP_MUONCALIB/f394_m932/data11_7TeV.00186877.physics_Muons.merge.NTUP_MUONCALIB.f394_m932/data11_7TeV.00186877.physics_Muons.merge.NTUP_MUONCALIB.f394_m932._0202.1' target='_blank' rel='nofollow'>srm&#58;//head01.aglt2.org&#58;8443/srm/managerv2?SFN=/pnfs/aglt2.org/atlascalibdisk/data11_7TeV/NTUP_MUONCALIB/f394_m932/data11_7TeV.00186877.physics_Muons.merge.NTUP_MUONCALIB.f394_m932/data11_7TeV.00186877.physics_Muons.merge.NTUP_MUONCALIB.f394_m932._0202.1</a>
TRANSFER ID&#58; 	00597d2e-c2a2-11e0-9fb0-acc23dbd5203
CHANNEL&#58; 	<a href='https&#58;//fts-t2-service.cern.ch&#58;8443/glite-data-transfer-fts/services/FileTransfer' target='_blank' rel='nofollow'>https&#58;//fts-t2-service.cern.ch&#58;8443/glite-data-transfer-fts/services/FileTransfer</a>
ERROR MSG&#58; 	[FTS] FTS State [Failed] FTS Retries [1] Reason [TRANSFER error during TRANSFER phase&#58; [TRANSFER_TIMEOUT] gri
dftp_copy_wait&#58; Connection timed out] Duration [0]
ACTIVITY&#58; 	T0 Export

Could you please look at it? Thanks a lot!
Cheers,
Xuai

[Ticket Origin]
<a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=73463' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=73463</a>

[Ticket History]
Changed CC to atlas-muoncalib-oper@....
-- by  CompAtP1Shift at Sun Aug 14 17&#58;16&#58;11 UTC 2011

Sent TEAM notification mail to mail address ball@....;rockwell@....;smckee@....;
-- by  CompAtP1Shift at Sun Aug 14 17&#58;16&#58;11 UTC 2011</pre></div><legend>Similar Recent Tickets <small>modified within the last 30 days</small></legend><div id="similar_tickets"><p class="muted">No similar tickets found.</p></div>
</div>
<script type="text/javascript">
function reset_anchor() {
    $("#updates .selected").removeClass("selected");
    var urls = document.location.toString().split('#'); 
    var anchor = urls[1];
    if(anchor) {
        $("a[name='"+anchor+"']").parents(".update_description").addClass("selected");
    }
}
function submitspam(ticket_id) {
    myret = confirm("Would you like to close this ticket as a security ticket, and submit the ticket content to akismet?");
    if(myret == true) {
        $.ajax("viewer/processspam?id="+ticket_id).done(function() {
            window.location.reload();
        });
    }
}

$(function() {
    reset_anchor();
    var ADDITIONAL_COOKIE_NAME = 'gocticket';
    var options = { path: '/', expires: 365};

    if(window.opener && window.opener.name == "gocticket_list") {
        v = $.cookie("closewindow");
        if(!v) {
            $("#closewindow").attr("checked", "checked"); //on by default
        } else {
            if(v == "checked") {
                $("#closewindow").attr("checked", "checked");
            }
        }
        $("#closewindow").click(function() {
            $.cookie("closewindow", $(this).attr('checked'), options);
        });
    } else {
        $("#closewindow_area").hide();
    }
    function updateTimeago() {
        $("time").timeago();
        setTimeout(updateTimeago, 30*1000);
    }
    updateTimeago();
    $(".description").focus(expand_description);
});
</script>
<hr/>
<footer>
<p>GOC Ticket Version 2.2 | <a href="https://ticket.opensciencegrid.org/goc/submit?app_issue_check=on&amp;app_issue_type=goc&amp;app_goc_url=https%3A%2F%2Fticket.opensciencegrid.org%3A443%2F10856">Report Bugs</a>
 | <a href="https://github.com/opensciencegrid/operations/blob/master/docs/privacy.md">Privacy Policy</a>
</p>

<p> <img align="top" src="images/tag_orange.png"/> Copyright 2018 The Trustees of Indiana University - Developed for Open Science Grid</p>
</footer>


</div><!--container-fluid-->
<script src="https://ticket1.grid.iu.edu:8443/socket.io/socket.io.js"></script>
<script>
var chat = io.connect('https://ticket1.grid.iu.edu:8443');
chat.on('connect', function() {
    chat.emit('authenticate', {nodekey:'', ticketid: 10856});
});
chat.on('peers', function(peers) {
    $("#peers").html("");
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('peer_disconnect', function(pid) {
    $("#peer_"+pid).hide("slow");
});
chat.on('peer_connected', function(peers) {
    //expect only 1 peer connecting, but..
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('submit', function() {
    if(confirm("This ticket was updated. Do you want to refresh?")) {
        history.go(0);
    }
});

function addPeer(pid, peer) {
    var ipinfo = "";
    if(peer.ip != undefined) {
        ipinfo = "<span class=\"ip\">"+peer.ip+"</span>";
    }
    if(chat.io.engine.id == pid) {
        //don't display myself
        return;
    }
    var html = "<li class=\"new\" id=\"peer_"+pid+"\" class=\"peer\">"+peer.name+ipinfo+"</li>";
    $("#peers").prepend(html);
    $("#peers .new").animate({bottom: 0}, 1000, function() {$(this).removeClass("new")});
}

$(function() {
    $("#ticket_form").submit(function() {
        chat.emit('submit');
        return true;
    });
});
</script>
<script>
//used by searchbox
function parseValue(value) {
    var obj = new Object();
    var tokens = value.split("\t");
    obj.str = tokens[0];
    obj.count = tokens[1];
    return obj;
}

$(function() {
    //bootstrap-2.0.4 stuff
    $(".alert-message").alert();
    $(".dropdown-toggle").dropdown();
    $("span[rel='tooltip']").tooltip();
    $("a[rel=popover]").popover();

    //activate menu that user is currently on
    $("#menu_navigator").addClass("active"); 
    $("#submenu_").addClass("active"); 

    //translate zend validation error message to bootstrap
    $(".errors").addClass("alert").addClass("alert-error");

    //enable autocomplete for search box
    $("#search").autocomplete({
        source: function( request, response ) {
            $.ajax({
                url: "search/autocomplete",
                dataType: "text",
                data: {
                    //featureClass: "P",
                    //style: "full",
                    //maxRows: 12,
                    //name_startsWith: request.term
                    q: request.term
                },
                success: function( data ) {
                    response( $.map( data.split("\n"), function( item ) {
                        if(item == "") return null;
                        return {
                            value: item
                        }
                    }));
                }
            });
        },
        select: function(event, ui) {
            document.location = "search?q="+ui.item.value;
        }
    });
    
});
</script>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-69012-13");
pageTracker._trackPageview();
} catch(err) {}
</script>

</body>
