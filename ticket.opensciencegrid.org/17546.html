<!DOCTYPE html>
<html lang="en">
  <head>
  <base href="">
    <title>[17546] cmsprod jobs on fermigridosg1/fnpcosg1.fnal.gov hanging on I/O</title>    <meta charset="utf-8" />
    <meta name="verify-v1" content="na5IcAJsZVOfEkboRxuIiZ1zpZgnZiWra+nKcS7nA/o=" />
    <meta name="google-site-verification" content="DLrk3ft4s8b-S2TloLCL2LD_t6wcTjgSluf5pmiu2kA" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />
    <link href="https://ticket.opensciencegrid.org/rss" rel="alternate" type="application/rss+xml" title="GOC Ticket Update feed" />

    <style type="text/css">
      body {
        padding-top: 50px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
     #search {
            width: 300px;
     }

    </style>

<script src="https://code.jquery.com/jquery-3.0.0.js"></script>
<script src="https://code.jquery.com/jquery-migrate-3.0.1.js"></script>

   <link href="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet"/>
    <script src="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/js/bootstrap.min.js"></script>

    <link href="https://netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"/>
    <link href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/themes/smoothness/jquery-ui.min.css" rel="stylesheet"/>
 <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>


    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/js/select2.min.js"></script>

    <link href="css/ticket.css" rel="stylesheet" />
    <script src="lib/jquery.cookie.js"></script>

    <link href="images/tag_orange.png" rel="icon" type="image/png"/>
  </head>

  <body>
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>

            <a class="brand" style="padding: 6px 0px 0px 6px;" href="http://opensciencegrid.org"><img src="images/osglogo.40x30.png"/></a>
            <ul class="nav">
                <li class="dropdown"><a href="https://ticket.opensciencegrid.org/#" class="dropdown-toggle" data-toggle="dropdown">GOC Ticket <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    <li><a href="https://my.opensciencegrid.org">MyOSG</a></li>
                    <li><a href="https://oim.opensciencegrid.org">OIM</a></li>
                    <li class="active"><a href="https://ticket.opensciencegrid.org/index">Ticket</a></li>
	<li class="divider"></li>
	<li><a href="http://repo.grid.iu.edu">Repo</a></li>
	<li class="divider"></li>
	<li><a href="http://blogs.grid.iu.edu">Blog</a></li>
                    <li><a href="http://display.grid.iu.edu">Display</a></li>
                    <li><a href="http://osggoc.blogspot.com/">News</a></li>
                    </ul>
                </li>
            </ul>
            <ul class="nav pull-right">
                <li><a href="https://ticket.opensciencegrid.org/sso/">Login</a></li>            </ul>

            <div class="nav-collapse">
                <ul class="nav">
			 <li id="menu_submit"><a href="https://ticket.opensciencegrid.org/submit">Submit</a></li><li id="menu_view" class="dropdown"><a href="https://ticket.opensciencegrid.org/\#" class="dropdown-toggle" data-toggle="dropdown">View <b class="caret"></b></a><ul class="dropdown-menu"><li id="submenu_listopen"><a href="https://ticket.opensciencegrid.org/list/open">Open Tickets</a></li><li id="submenu_listrecentclose"><a href="https://ticket.opensciencegrid.org/list/recentclose">Recently Closed Tickets</a></li><li class="divider"></li><li id="submenu_alltickets"><a href="https://ticket.opensciencegrid.org/search?q=&amp;sort=id">All Tickets</a></li></ul></li>                </ul>

                <form class="navbar-search pull-right" action="https://ticket.opensciencegrid.org/viewer">
                    <input id="search" type="text" name="id" class="search-query span2" placeholder="Search Ticket" value=""/>
                </form>
            </div>
        </div>
      </div>
    </div>

<script type='text/javascript' src='lib/jquery.timeago.js'></script>
<script type='text/javascript' src='lib/byte2size.js'></script>
<style>
#updates .toolbar {
position: relative;
margin-top: 0px;
top: -10px;
font-weight: normal;
}
#updates a.anchor {
position: relative;
top: -50px;
}
#updates .selected pre {
animation:selected 2s;
animation-iteration-count: 2;
animation-direction: alternate;
-webkit-animation:selected 2s; 
-webkit-animation-iteration-count: 2;
-webkit-animation-direction: alternate;
box-shadow: inset 1px 1px 20px #9ad;
border: 1px solid #9ab;
margin: 5px 0px;
padding-left: 10px;
}
@keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ab;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
@-webkit-keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ad;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
#updates pre {
background-color: inherit;
line-height: 15px;
padding: 5px;
}
#updates .header {
color: #999;
}
#updates .update_history pre {
background-color: #eee;
color: #666;
font-size: 85%;
}
#updates .clickable {
cursor: pointer;
}
#updates .clickable:hover {
color: #D98719;
}
#updates .meta_information pre {
background-color: #fed;
}
#similar_tickets {
max-height: 300px;
overflow-y: auto;
pointer-events: none;
padding: 5px;
background-color: #f4f4f4;
}
.btn-toolbar {
margin-bottom: 0;
height: 30px;
}
#peers {
position: fixed;
bottom: 0px;
right: 0px;
z-index: 100;
list-style: none;
padding: 5px 0px 0px 5px;
margin: 0px;
background-color: white;
box-shadow: 0px 0px 10px white;
}
#peers li {
background-color: #ccc;
color: #000;
display: inline-block;
padding: 5px 10px;
margin-right: 5px;
position: relative;
}
/*
#peers li:hover {
background-color: #999;
cursor: pointer;
}
*/
#peers span.ip {
padding-left: 5px;
color: #666;
}
#peers .new {
bottom: -30px;
}
/*
#peers .me {
background-color: red;
}
*/
</style>

<div class="container-fluid">
<ul id="peers"></ul>
<div class="alert alert-danger"><a class="close" href="https://ticket.opensciencegrid.org/#" data-dismiss="alert">&times;</a>By the end of May 2018, the ticketing system at https://ticket.opensciencegrid.org will be retired and support will be provided at https://support.opensciencegrid.org. Throughout this transition the support email (help@opensciencegrid.org) will be available as a point of contact.<br><br>                                                   
                                                                                                                                                                                   
Please see the service migration page for details: https://opensciencegrid.github.io/technology/policy/service-migrations-spring-2018/#ticket</div><div id="presence" class="pull-right"></div><div class="ticketgui"><script type="text/javascript" src="lib/checktab.js"></script>

<script>
var expanded = false;
function expand_description() {
    var desc = $(".description");
    if(!expanded) {
        expanded = true;
        //expand to minheight
        var min = 250;
        if(desc.height() < min) {
            desc.animate({height: min}, 200);
        }
    }
}

$(document).ready(function() {
    $("input[name='nad']").datepicker({
        dateFormat: 'yy-mm-dd'
    });
});

</script>



<style>
.form-horizontal .control-label {
padding-top: inherit;
font-size:90%;
color:#666;
}
label {
margin-bottom: 0px;
}
.controls {
line-height: 18px;
}
</style>
<form class="form-horizontal" action="https://ticket.opensciencegrid.org/viewer/updatebasic?id=17546" method="post">
<div class="page-header">
    <h3><span class="muted">17546</span> / cmsprod jobs on fermigridosg1/fnpcosg1.fnal.gov hanging on I/O</h3>
</div>

<div class="row-fluid">
<div class="span5">
    <legend>Contact</legend>
    <div class="control-group">
        <label class="control-label">Full Name</label>
        <div class="controls">Steve Timm</div>
    </div>
    <div class="control-group">
        <label class="control-label">Email</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">Phone</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">CC</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>

    <legend>Details</legend>
    <div class="control-group"><label class="control-label">Associated VO</label><div class="controls">CMS</div></div><div class="control-group"><label class="control-label">Submitted Via</label><div class="controls">GOC Ticket/submit</div></div><div class="control-group"><label class="control-label">Submitter</label><div class="controls">Steve Timm</div></div><div class="control-group"><label class="control-label">Support Center</label><div class="controls">USCMS</div></div>
    <div class="control-group">
        <label class="control-label">Ticket Type</label>
        <div class="controls">Problem/Request</div>
    </div>
    <div class="control-group">
        <label class="control-label">Priority</label>
        <div class="controls">Normal</div>
    </div>
    <div class="control-group">
        <label class="control-label">Status</label>
        <div class="controls">
Closed</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action</label>
        <div class="controls">ENG Action</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action Deadline</label>
        <div class="controls flag_red">2013-11-07</div>
    </div>

</div><!--span-->
<div class="span7">
    <legend>Assignees</legend>
    <div class="assignee" style="width: 60%">FNAL (Prod)&nbsp;<a target="_blank" href="https://fermi.service-now.com/nav_to.do?uri=incident.do?sys_id=INC000000397416">INC000000397416</a> <span class="muted"> / Ticket Exchange</span></div><div class="assignee" style="width: 60%">GGUS (Prod)&nbsp;<a target="_blank" href="https://ggus.eu/ws/ticket_info.php?ticket=98256">98256</a> <span class="muted"> / Ticket Exchange</span></div>    <br>

    <legend>Assignees</legend>
    TODO
    <br>

    <style>
legend.noborder {
border-bottom: none;
}
</style>

<div id="attachment-list"/>
<script>
$(function () {
    var first = true;
    $.getJSON("attachment/list/17546", function (files) {
        //console.dir(files);
        var html = "<table class=\"table table-condensed\">";
        $(files).each(function() {
            if(first) {
                first = false;
                html += "<legend class=\"noborder\">Attachmenets</legend>";
            }
            html += "<tr class=\"attachment\">";
            html += "<td><img src=\""+this.thumbnail_url+"\"/></td>";
            html += "<td><a href=\""+this.url+"\" target=\"_blank\">"+this.name+"</a></td>";
            html += "<td>"+bytesToSize(this.size, 1)+"</td>";
            html += "</tr>";
        });
        html += "</table>";
        $("#attachment-list").html(html);
    });
});

function download(url) {
    window.open(url, "_blank");
}
</script>


</div><!--span-->
</div><!--row-fluid-->


</form>

</div>
<div id="updates" style="clear: both;">
    <legend>Past Updates
    <div class="btn-toolbar pull-right toolbar">
        <div class="btn-group">
                <a class="btn btn-small" href="https://ticket.opensciencegrid.org/17546?sort=up&amp;"><i class="icon-arrow-up"></i> Sort</a>

        
        <a class="btn btn-small" href="https://ticket.opensciencegrid.org/17546?expandall=true&amp;">Expand Descriptions</a>        <a class="btn btn-small" target="_blank" href="mailto:osg@tick.globalnoc.iu.edu?subject=Open%20Science%20Grid%3A%20cmsprod%20jobs%20on%20fermigridosg1%2Ffnpcosg1.fnal.gov%20hanging%20on%20I%2FO%20ISSUE%3D17546%20PROJ%3D71"><i class="icon-envelope"></i> Update w/Email</a>
        </div>
    </div><!--btn-toolbar-->
    </legend>

    <div class='update_description'><i onclick="document.location='17546#1384991957'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-11-20T23:59:17+00:00">Nov 20, 2013 11:59 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1384991957">&nbsp;</a></div><pre>This ticket was closed automatically. If this issue has not been resolved according your expectations or if you need further information, please submit a new ticket referencing this one.

-- by SYSTEM at Wed Nov 20 23&#58;59&#58;02 UTC 2013

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=98256' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=98256</a></pre></div><div class='update_description'><i onclick="document.location='17546#1383742744'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-11-06T12:59:04+00:00">Nov 6, 2013 12:59 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1383742744">&nbsp;</a></div><pre>It turned out that due to a misconfiguration the glideins sent were not the Parrot wrapper ones. After fixing this cms jobs started running normally

-- by stefano.belforte at Wed Nov 06 12&#58;58&#58;38 UTC 2013

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=98256' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=98256</a></pre></div><div class='update_description'><i onclick="document.location='17546#1383239239'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-10-31T17:07:19+00:00">Oct 31, 2013 05:07 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1383239239">&nbsp;</a></div><pre>It turned out that due to a misconfiguration the glideins sent were not the Parrot wrapper ones. After fixing this cms jobs started running normally. I think we can close the ticket unless we want to enable sending pilots through fermigridosg1.fnal.gov again to see if causes problems and track it here. I would propose we close the ticket.

Dirk, do you agree?

Thanks
Preslav

-- by Preslav Konstantinov at Thu Oct 31 17&#58;06&#58;25 UTC 2013

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=98256' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=98256</a></pre></div><div class='update_description'><i onclick="document.location='17546#1383235742'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-10-31T16:09:02+00:00">Oct 31, 2013 04:09 PM UTC</time><a class="anchor" name="1383235742">&nbsp;</a></div><pre>We are seeing the cmsprod jobs that run on fnpcosg1.fnal.gov using the  cpu efficiently now.  so that works fine.
We&#39;ll be glad to work with you if you want to debug the site forwarding gateway fermigridosg1.fnal.gov as well because if you can get that working it would give you access to a lot more slots.  Let us know if you are interested.  as far as I am concerned this ticket can be closed now.

Steve Timm

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=Steve Timm 167</pre></div><div class='update_description'><i onclick="document.location='17546#1383138017'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-10-30T13:00:17+00:00">Oct 30, 2013 01:00 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1383138017">&nbsp;</a></div><pre>We changed the configuration on the CMS side, can we close the ticket?

Thanks,

OLI

-- by oliver.gutsche at Wed Oct 30 12&#58;59&#58;09 UTC 2013

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=98256' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=98256</a></pre></div><div class='update_description'><i onclick="document.location='17546#1382538090'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-10-23T14:21:30+00:00">Oct 23, 2013 02:21 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1382538090">&nbsp;</a></div><pre>We allowed jobs to go to both of these, will restrict it to only use the second one to rule out this causing problems.

-- by Dirk Hufnagel at Wed Oct 23 14&#58;21&#58;10 UTC 2013

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=98256' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=98256</a></pre></div><div class='update_description'><i onclick="document.location='17546#1382537530'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-10-23T14:12:10+00:00">Oct 23, 2013 02:12 PM UTC</time> by <b>Steven Timm</b><a class="anchor" name="1382537530">&nbsp;</a></div><pre>OK.  Be aware that when you submit to FNAL_FERMIGRID that the site gateway fermigridosg1.fnal.gov
accepts your normal pilot job and resubmits it via condor-G matching to the individual sites such as FNAL_GPGRID_2.
This does not usually cause problems for user jobs, especially those running under glideinWMS but it’s something to keep in mind if you continue to have problems.  On the other hand if you submit directly to FNAL_GPGRID_1
(fnpcosg1.fnal.gov) that does not go through the site gateay.

Steve Timm</pre></div><div class='update_description'><i onclick="document.location='17546#1382536403'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-10-23T13:53:23+00:00">Oct 23, 2013 01:53 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1382536403">&nbsp;</a></div><pre>I ran a small probe script at Fermigrid (hostname fnpc5004.fnal.gov, OSG_SITE_NAME=FNAL_GPGRID_2) through the glideinWMS system we use and apparently it did not run under the Parrot wrapper as it should. This explains the failures we see. The glidein experts are aware and are looking into it.

Cheers,
Preslav

-- by Preslav Konstantinov at Wed Oct 23 13&#58;52&#58;40 UTC 2013

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=98256' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=98256</a></pre></div><div class='update_description'><i onclick="document.location='17546#1382453472'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-10-22T14:51:12+00:00">Oct 22, 2013 02:51 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1382453472">&nbsp;</a></div><pre>As I said before, we are using FermiGrid as a testbed to explore opportunistic computing for CMS. The underlying assumption for the most generic opportunistic use case is that we cannot rely on the site to provide anything except an ability for us to submit a job. Therefor the goal of these tests isn&#39;t to find the most efficient way to run at FermiGrid, but to test/debug workflows to be able to run without anything provided by the site. We do have code that auto-detects local proxy servers so we do not communicate directly with CERN for cvmfs and frontier conditions. That code used to work for FermiGrid, we are currently investigating if it still does.

Addressing your points&#58;

1. If cvmfs is mounted locally, the parrot wrapper should probably just use it instead of doing it&#39;s own thing (with some validation checks that it&#39;s actually usable). Will bring this up with the parrot wrapper developer.

2. We should probably add a few well known stratum 1 for the cvmfs configuration, although that depends our ability to round-robin between them and/or pick the &#39;appropriate&#39; one. If we have to stick with one, at least for the US opportunistic &#39;meta-site&#39; it might make sense to always go through Fermilab instead of CERN (although that would mean opportunistic jobs on other OSG sites would also access Fermilab for cvmfs).

3. Parrot makes cvmfs available to the job. It always goes to CERN, but it can use a local proxy, provided it can detect one. This used to work for FermiGrid, but maybe it doesn&#39;t anymore. We are checking. In the meantime, you say the limit is 100 jobs. So if we restrict the number of active jobs to 90 or so, we should not run into auto-blocker problems ? We can try that just to see if it solves the problems we see. Even at the scale we can do some useful testing.

4. SL5 or SL6 should not matter for us

Thanks for the information and support. Hope we can make it work, but I also don&#39;t want to customize the setup too much because then I won&#39;t learn very much for the opportunistic computing use case.

Dirk

-- by Dirk Hufnagel at Tue Oct 22 14&#58;50&#58;41 UTC 2013

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=98256' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=98256</a></pre></div><div class='update_description'><i onclick="document.location='17546#1382449870'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-10-22T13:51:10+00:00">Oct 22, 2013 01:51 PM UTC</time> by <b>Steven Timm</b><a class="anchor" name="1382449870">&nbsp;</a></div><pre>First of all--all nodes of FermiGrid should have the cern cvmfs mounted
in their CVMFS repository.  there should be no reason to use Parrot here.
If you find some where it&#39;s not there, please let me know.

Second of all--we do have a local stratum 1 which is mirroring the
CERN and the OSG repositories so we don&#39;t have to go back to CERN for
that.

Third--where is the parrot server you are trying to access?
At Wisconsin, or at CERN?  If too many workers (100 or more simultaneously
are going after a CERN server directly it could be triggering the Fermilab
site autoblocker and that would also explain the lcg-cp hangs I saw on
Friday, and am also seeing some of this morning.

Fourth--if you see anything running on fnpc6000-series worker nodes
those are our SLF6 nodes in a cluster that is otherwise all SLF5.
So there could be differences between those nodes and the rest.

Hopefully we can work this out..we want to do everything we can to enable
CMS usage on these gatekeepers and make it work for you.  If it will
help to give Fermilab USCMS staff login to the worker nodes, let us know
and we can arrange that.

Steve Timm

On Tue, 22 Oct 2013, Open Science Grid FootPrints wrote&#58;

<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='17546#1382447884'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-10-22T13:18:04+00:00">Oct 22, 2013 01:18 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1382447884">&nbsp;</a></div><pre>These errors seem to both point a something going wrong with the parrot wrapper and not getting access to CERN cvmfs (both the scramv1 executable and the lcg-cp are pulled in from CERN cvmfs). Is it possible that all access to CERN would be blocked from the WN ? Preslav, can you pull the SITECONF we currently get at FermiGrid ? Are we going through a Fermilab proxy or are we accessing the CERN cvmfs directly ?

-- by Dirk Hufnagel at Tue Oct 22 13&#58;17&#58;49 UTC 2013

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=98256' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=98256</a></pre></div><div class='update_description'><i onclick="document.location='17546#1382447106'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-10-22T13:05:06+00:00">Oct 22, 2013 01:05 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1382447106">&nbsp;</a></div><pre>----------- e-mail with large body ------

added in total as mailbody.Tue._22_Oct_2013_15.04.21_.0200.txt

------------ e-mail with large body ------Hi,

Yes, we are running opportunistically an MC workflow on T3_US_Parrot,
which is a metasite in glideinWMS and one of the sites behind it is
Fermigrid. All jobs run under Parrot. Last week we were seeing around
20% success rate but this week it is 0%.

From the wmagent wmstats monitoring we cannot see exactly where the
jobs run, but all the jobs I checked by looking at the stdout and
stderr, ran at Fermigrid (WNs like fnpc6011.fnal.gov,
GLIDEIN_ResourceName=FNAL_FERMIGRID, OSG_SITE_NAME=FNAL_GPGRID_2 or
OSG_SITE_NAME=FNAL_GPGRID_1 in the environment). The stage out via
lcg-cp is not going to CERN but to Wisconsin and then Nebraska as a
fallback. It normally works but not all the time. See below.

We are in fact testing a new retry handler in wmagent, so having a
certain failure rate is exactly what we need. The current 100% failure
is a limit case and also interesting for testing the behaviour of the
retry algorithm. I think it would be beneficial if site admins help
resolve some of the problems so we get some jobs that succeed. The
failures we get are as follows.

The most common error we see is&#58;

Error in CMSSW&#58; 50513
ScramSetupFailure
Message&#58;
Scram Command Diagnostic&#58;
Command &#58; scramv1
Architecture&#58; slc5_amd64_gcc434
Executed&#58; scramv1 project CMSSW CMSSW_4_1_8
<div id='show_176465963' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_176465963'>Exit Status&#58; 3
Stdout&#58;
Stderr&#58; /bin/bash&#58; line 5&#58; scramv1&#58; command not found

ModuleName &#58; WMCore.WMSpec.Steps.WMExecutionFailure
MethodName &#58; __init__
ClassInstance &#58; None
FileName &#58;
/local/stage1/disk18/dir_21109/glide_8JLr49/execute/dir_43313/job/WMCore.zip/WMCore/WMSpec/Steps/WMExecutionFailure.py
ClassName &#58; None
LineNumber &#58; 18
ErrorNr &#58; 50513

For the case of stageout error (to Wisconsin and Nebraska) in stderr I
see diagnostics like&#58;

INFO&#58;root&#58;Beginning report processing for step logArch1
ERROR&#58;root&#58;Cannot find report for step logArch1 in space
/local/stage1/disk16/dir_11621/glide_T11716/execute/dir_19245/job/WMTaskSpace/logArch1
INFO&#58;root&#58;Beginning report processing for step cmsRun1
usage&#58; lcg-cp [-h,--help] [-c,--config config_file] [-n nbstreams]
[-b,--nobdii] [-D,--defaultsetype se|srmv1|srmv2]
[-T,--srcsetype se|srmv1|srmv2] [-U,--dstsetype se|srmv1|srmv2]
[-s,--sst src_spacetokendesc]
[-S,--dst dest_spacetokendesc] [--connect-timeout value]
[--sendreceive-timeout value]
[--bdii-timeout value] [--srm-timeout value] [--checksum]
[--checksum-type type]
[-v,--verbose] [-V,--vo vo] [--version]
[--src-protocols &#60;protocol1,protocol2,...&#62;]
[--dst-protocols &#60;protocol1,protocol2,...&#62;]
src_file  dest_file
<a href='srm&#58;//cmssrm.hep.wisc.edu&#58;8443/srm/v2/server?SFN=/hdfs/store/unmerged/IntegrationTest_131021/BdToMuMu_2MuPtFilter_7TeV-pythia6-evtgen/GEN-SIM/MyFilter-OppTest-v3/00001/DAF1BBC3-DA3A-E311-8812-002590593884.root&#58' target='_blank' rel='nofollow'>srm&#58;//cmssrm.hep.wisc.edu&#58;8443/srm/v2/server?SFN=/hdfs/store/unmerged/IntegrationTest_131021/BdToMuMu_2MuPtFilter_7TeV-pythia6-evtgen/GEN-SIM/MyFilter-OppTest-v3/00001/DAF1BBC3-DA3A-E311-8812-002590593884.root&#58</a>;
[SE][srmRm][SRM_FAILURE] Error&#58;/bin/rm&#58; cannot remove
&#96;/hdfs/store/unmerged/IntegrationTest_131021/BdToMuMu_2MuPtFilter_7TeV-pythia6-evtgen/GEN-SIM/MyFilter-OppTest-v3/00001/DAF1BBC3-DA3A-E311-8812-002590593884.root&#39;&#58;
No such file or directory
Ref-u cmsprod  /bin/rm
/hdfs/store/unmerged/IntegrationTest_131021/BdToMuMu_2MuPtFilter_7TeV-pythia6-evtgen/GEN-SIM/MyFilter-OppTest-v3/00001/DAF1BBC3-DA3A-E311-8812-002590593884.root

Looks like something is missing and an lcg-cp is invoked incorrectly.

Another type of error is just&#58;

in stdout&#58;
WMAgent bootstrap &#58; Tue Oct 22 06&#58;25&#58;18 UTC 2013 &#58; starting...
WMAgent bootstrap &#58; Tue Oct 22 06&#58;25&#58;18 UTC 2013 &#58; arguments validated...
WMAgent bootstrap &#58; Tue Oct 22 06&#58;25&#58;18 UTC 2013 &#58; WMAgent thinks it
found the correct CMSSW setup script

in stderr&#58;
...
...
--- body truncated, see attachment mailbody.Tue._22_Oct_2013_15.04.21_.0200.txt for full text ---

-- by Preslav Konstantinov at Tue Oct 22 13&#58;04&#58;34 UTC 2013

Added attachment mailbody.Tue._22_Oct_2013_15.04.21_.0200.txt
<a href='https&#58;//ggus.eu/pages/windownload.php?attid=ATT103502' target='_blank' rel='nofollow'>https&#58;//ggus.eu/pages/windownload.php?attid=ATT103502</a>

-- by Preslav Konstantinov at Tue Oct 22 13&#58;04&#58;33 UTC 2013

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=98256' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=98256</a>
</div><script type='text/javascript'>
        $('#show_176465963').click(function() {
            $('#detail_176465963').slideDown("normal");
            $('#show_176465963').hide();
            $('#hide_176465963').show();
        });
        $('#hide_176465963').click(function() {
            $('#detail_176465963').slideUp();
            $('#hide_176465963').hide();
            $('#show_176465963').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='17546#1382446742'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-10-22T12:59:02+00:00">Oct 22, 2013 12:59 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1382446742">&nbsp;</a></div><pre>Hi, we were using Fermigrid (and some other OSG sites that allow opportunistic use) to test opportunistic computing for CMS. Develop procedures, test out special code for that use case and so on. None of the workflows we run at Fermigrid stage out to CERN though, we only lcg-cp to either Wisconsin or Nebraska. The workflows we are running are MC workflows, so there is no data input either, just the CMS software is retrieved via parrot/cvmfs and CMS conditions via frontier. Both of these should use a proxy at Fermilab.

I talked with the operator running the workflows and we used to get a 20% success rate for our jobs, so some jobs getting stuck is possible though. Could it be that you were mistaken in your analysis that these jobs you saw were blocked on stageout to CERN ?

At the moment we get 100% failure rate btw, but for various reasons, not stageout problems. Might be unrelated.

-- by Dirk Hufnagel at Tue Oct 22 12&#58;58&#58;08 UTC 2013

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=98256' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=98256</a></pre></div><div class='update_description'><i onclick="document.location='17546#1382445418'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-10-22T12:36:58+00:00">Oct 22, 2013 12:36 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1382445418">&nbsp;</a></div><pre>No access for Dirk, assigning ticket to Dirk, Dave and Preslav.

OLI

-- by oliver.gutsche at Tue Oct 22 12&#58;36&#58;13 UTC 2013

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=98256' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=98256</a></pre></div><div class='update_description'><i onclick="document.location='17546#1382445238'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-10-22T12:33:58+00:00">Oct 22, 2013 12:33 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1382445238">&nbsp;</a></div><pre>Involving Dirk, Dave and Preslav.

OLI

-- by oliver.gutsche at Tue Oct 22 12&#58;33&#58;32 UTC 2013

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=98256' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=98256</a></pre></div><div class='update_description'><i onclick="document.location='17546#1382426132'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-10-22T07:15:32+00:00">Oct 22, 2013 07:15 AM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1382426132">&nbsp;</a></div><pre>Changed concerned VO to&#58; cms

-- by Alessandro Paolini at Tue Oct 22 07&#58;15&#58;14 UTC 2013

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=98256' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=98256</a></pre></div><div class='update_description'><i onclick="document.location='17546#1382390474'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-10-21T21:21:14+00:00">Oct 21, 2013 09:21 PM UTC</time> by <b>echism</b><a class="anchor" name="1382390474">&nbsp;</a></div><pre>GGUS operators,

We received this inquiry&#58;

We have seen a few hundred &#34;cmsprod&#34; jobs recently get submitted to sites FNAL_GPGRID_1 (fnpcosg1.fnal.gov)
and FNAL_FERMIGRID_1 (fermigridosg1.fnal.gov).
Some of them appear to be running OK, others seem to be hung for very long periods of time attempting to do lcg-cp
back to various storage elements which appear to be at CERN.  I am wondering if we have enough of them
running simultaneously such that the Fermilab autoblocker is being triggered.

The submissions are coming from DN
/DC=ch/DC=cern/OU=computers/CN=cmspilotjob/vocms143.cern.ch
via the CERN glidein factory.  Some appear to be attempting to use Parrot to get back to their files.

Please contact the European CMS managers and see if the jobs are running to their satisfaction, if not we will be
glad to help on the FermiGrid side to see what is going wrong.  It is very likely that there are certain
exemptions on the Fermilab side which allow all the nodes in the CMS Tier 1 cluster to access CERN
unrestrictedly but those exemptions do not apply to the general purpose grid cluster on which
these jobs are now running.

Steve Timm</pre></div><div class='update_description'><i onclick="document.location='17546#1382389112'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-10-21T20:58:32+00:00">Oct 21, 2013 08:58 PM UTC</time><a class="anchor" name="1382389112">&nbsp;</a></div><pre>Adding Oliver Gutsche to the ticket.

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=Steve Timm 167</pre></div><div class='update_description'><i onclick="document.location='17546#1382373754'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-10-21T16:42:34+00:00">Oct 21, 2013 04:42 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1382373754">&nbsp;</a></div><pre>We have seen a few hundred &#34;cmsprod&#34; jobs recently get submitted to sites FNAL_GPGRID_1 (fnpcosg1.fnal.gov)
and FNAL_FERMIGRID_1 (fermigridosg1.fnal.gov).
Some of them appear to be running OK, others seem to be hung for very long periods of time attempting to do lcg-cp
back to various storage elements which appear to be at CERN.  I am wondering if we have enough of them
running simultaneously such that the Fermilab autoblocker is being triggered.

The submissions are coming from DN
/DC=ch/DC=cern/OU=computers/CN=cmspilotjob/vocms143.cern.ch
via the CERN glidein factory.  Some appear to be attempting to use Parrot to get back to their files.

Please contact the European CMS managers and see if the jobs are running to their satisfaction, if not we will be
glad to help on the FermiGrid side to see what is going wrong.  It is very likely that there are certain
exemptions on the Fermilab side which allow all the nodes in the CMS Tier 1 cluster to access CERN
unrestrictedly but those exemptions do not apply to the general purpose grid cluster on which
these jobs are now running.

Steve Timm

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=Steve Timm 167</pre></div><legend>Similar Recent Tickets <small>modified within the last 30 days</small></legend><div id="similar_tickets"><p class="muted">No similar tickets found.</p></div>
</div>
<script type="text/javascript">
function reset_anchor() {
    $("#updates .selected").removeClass("selected");
    var urls = document.location.toString().split('#'); 
    var anchor = urls[1];
    if(anchor) {
        $("a[name='"+anchor+"']").parents(".update_description").addClass("selected");
    }
}
function submitspam(ticket_id) {
    myret = confirm("Would you like to close this ticket as a security ticket, and submit the ticket content to akismet?");
    if(myret == true) {
        $.ajax("viewer/processspam?id="+ticket_id).done(function() {
            window.location.reload();
        });
    }
}

$(function() {
    reset_anchor();
    var ADDITIONAL_COOKIE_NAME = 'gocticket';
    var options = { path: '/', expires: 365};

    if(window.opener && window.opener.name == "gocticket_list") {
        v = $.cookie("closewindow");
        if(!v) {
            $("#closewindow").attr("checked", "checked"); //on by default
        } else {
            if(v == "checked") {
                $("#closewindow").attr("checked", "checked");
            }
        }
        $("#closewindow").click(function() {
            $.cookie("closewindow", $(this).attr('checked'), options);
        });
    } else {
        $("#closewindow_area").hide();
    }
    function updateTimeago() {
        $("time").timeago();
        setTimeout(updateTimeago, 30*1000);
    }
    updateTimeago();
    $(".description").focus(expand_description);
});
</script>
<hr/>
<footer>
<p>GOC Ticket Version 2.2 | <a href="https://ticket.opensciencegrid.org/goc/submit?app_issue_check=on&amp;app_issue_type=goc&amp;app_goc_url=https%3A%2F%2Fticket.opensciencegrid.org%3A443%2F17546">Report Bugs</a>
 | <a href="https://github.com/opensciencegrid/operations/blob/master/docs/privacy.md">Privacy Policy</a>
</p>

<p> <img align="top" src="images/tag_orange.png"/> Copyright 2018 The Trustees of Indiana University - Developed for Open Science Grid</p>
</footer>


</div><!--container-fluid-->
<script>
//used by searchbox
function parseValue(value) {
    var obj = new Object();
    var tokens = value.split("\t");
    obj.str = tokens[0];
    obj.count = tokens[1];
    return obj;
}

$(function() {
    //bootstrap-2.0.4 stuff
    $(".alert-message").alert();
    $(".dropdown-toggle").dropdown();
    $("span[rel='tooltip']").tooltip();
    $("a[rel=popover]").popover();

    //activate menu that user is currently on
    $("#menu_navigator").addClass("active"); 
    $("#submenu_").addClass("active"); 

    //translate zend validation error message to bootstrap
    $(".errors").addClass("alert").addClass("alert-error");

    //enable autocomplete for search box
    $("#search").autocomplete({
        source: function( request, response ) {
            $.ajax({
                url: "search/autocomplete",
                dataType: "text",
                data: {
                    //featureClass: "P",
                    //style: "full",
                    //maxRows: 12,
                    //name_startsWith: request.term
                    q: request.term
                },
                success: function( data ) {
                    response( $.map( data.split("\n"), function( item ) {
                        if(item == "") return null;
                        return {
                            value: item
                        }
                    }));
                }
            });
        },
        select: function(event, ui) {
            document.location = "search?q="+ui.item.value;
        }
    });
    
});
</script>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-69012-13");
pageTracker._trackPageview();
} catch(err) {}
</script>

</body>
