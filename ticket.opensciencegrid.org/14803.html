<!DOCTYPE html>
<html lang="en">
  <head>
  <base href="">
    <title>[14803] WLCG detailed Gratia page is not working</title>    <meta charset="utf-8" />
    <meta name="verify-v1" content="na5IcAJsZVOfEkboRxuIiZ1zpZgnZiWra+nKcS7nA/o=" />
    <meta name="google-site-verification" content="DLrk3ft4s8b-S2TloLCL2LD_t6wcTjgSluf5pmiu2kA" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />
    <link href="https://ticket.opensciencegrid.org/rss" rel="alternate" type="application/rss+xml" title="GOC Ticket Update feed" />

    <style type="text/css">
      body {
        padding-top: 50px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
     #search {
            width: 300px;
     }

    </style>

<script src="https://code.jquery.com/jquery-3.0.0.js"></script>
<script src="https://code.jquery.com/jquery-migrate-3.0.1.js"></script>

   <link href="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet"/>
    <script src="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/js/bootstrap.min.js"></script>

    <link href="https://netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"/>
    <link href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/themes/smoothness/jquery-ui.min.css" rel="stylesheet"/>
 <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>


    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/js/select2.min.js"></script>

    <link href="css/ticket.css" rel="stylesheet" />
    <script src="lib/jquery.cookie.js"></script>

    <link href="images/tag_orange.png" rel="icon" type="image/png"/>
    <script src='https://www.google.com/recaptcha/api.js'></script>
  </head>

  <body>
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>

            <a class="brand" style="padding: 6px 0px 0px 6px;" href="http://opensciencegrid.org"><img src="images/osglogo.40x30.png"/></a>
            <ul class="nav">
                <li class="dropdown"><a href="https://ticket.opensciencegrid.org/#" class="dropdown-toggle" data-toggle="dropdown">GOC Ticket <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    <li><a href="https://my.opensciencegrid.org">MyOSG</a></li>
                    <li><a href="https://oim.opensciencegrid.org">OIM</a></li>
                    <li class="active"><a href="https://ticket.opensciencegrid.org/index">Ticket</a></li>
	<li class="divider"></li>
	<li><a href="http://repo.grid.iu.edu">Repo</a></li>
	<li class="divider"></li>
	<li><a href="http://blogs.grid.iu.edu">Blog</a></li>
                    <li><a href="http://display.grid.iu.edu">Display</a></li>
                    <li><a href="http://osggoc.blogspot.com/">News</a></li>
                    </ul>
                </li>
            </ul>
            <ul class="nav pull-right">
                <li><a href="https://ticket.opensciencegrid.org/sso/">Login</a></li>            </ul>

            <div class="nav-collapse">
                <ul class="nav">
			 <li id="menu_submit"><a href="https://ticket.opensciencegrid.org/submit">Submit</a></li><li id="menu_view" class="dropdown"><a href="https://ticket.opensciencegrid.org/\#" class="dropdown-toggle" data-toggle="dropdown">View <b class="caret"></b></a><ul class="dropdown-menu"><li id="submenu_listopen"><a href="https://ticket.opensciencegrid.org/list/open">Open Tickets</a></li><li id="submenu_listrecentclose"><a href="https://ticket.opensciencegrid.org/list/recentclose">Recently Closed Tickets</a></li><li class="divider"></li><li id="submenu_alltickets"><a href="https://ticket.opensciencegrid.org/search?q=&amp;sort=id">All Tickets</a></li></ul></li>                </ul>

                <form class="navbar-search pull-right" action="https://ticket.opensciencegrid.org/viewer">
                    <input id="search" type="text" name="id" class="search-query span2" placeholder="Search Ticket" value=""/>
                </form>
            </div>
        </div>
      </div>
    </div>

<script type='text/javascript' src='lib/jquery.timeago.js'></script>
<script type='text/javascript' src='lib/byte2size.js'></script>
<style>
#updates .toolbar {
position: relative;
margin-top: 0px;
top: -10px;
font-weight: normal;
}
#updates a.anchor {
position: relative;
top: -50px;
}
#updates .selected pre {
animation:selected 2s;
animation-iteration-count: 2;
animation-direction: alternate;
-webkit-animation:selected 2s; 
-webkit-animation-iteration-count: 2;
-webkit-animation-direction: alternate;
box-shadow: inset 1px 1px 20px #9ad;
border: 1px solid #9ab;
margin: 5px 0px;
padding-left: 10px;
}
@keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ab;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
@-webkit-keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ad;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
#updates pre {
background-color: inherit;
line-height: 15px;
padding: 5px;
}
#updates .header {
color: #999;
}
#updates .update_history pre {
background-color: #eee;
color: #666;
font-size: 85%;
}
#updates .clickable {
cursor: pointer;
}
#updates .clickable:hover {
color: #D98719;
}
#updates .meta_information pre {
background-color: #fed;
}
#similar_tickets {
max-height: 300px;
overflow-y: auto;
pointer-events: none;
padding: 5px;
background-color: #f4f4f4;
}
.btn-toolbar {
margin-bottom: 0;
height: 30px;
}
#peers {
position: fixed;
bottom: 0px;
right: 0px;
z-index: 100;
list-style: none;
padding: 5px 0px 0px 5px;
margin: 0px;
background-color: white;
box-shadow: 0px 0px 10px white;
}
#peers li {
background-color: #ccc;
color: #000;
display: inline-block;
padding: 5px 10px;
margin-right: 5px;
position: relative;
}
/*
#peers li:hover {
background-color: #999;
cursor: pointer;
}
*/
#peers span.ip {
padding-left: 5px;
color: #666;
}
#peers .new {
bottom: -30px;
}
/*
#peers .me {
background-color: red;
}
*/
</style>

<div class="container-fluid">
<ul id="peers"></ul>
<div class="alert alert-danger"><a class="close" href="https://ticket.opensciencegrid.org/#" data-dismiss="alert">&times;</a>By the end of May 2018, the ticketing system at https://ticket.opensciencegrid.org will be retired and support will be provided at https://support.opensciencegrid.org. Throughout this transition the support email (help@opensciencegrid.org) will be available as a point of contact.<br><br>                                                   
                                                                                                                                                                                   
Please see the service migration page for details: https://opensciencegrid.github.io/technology/policy/service-migrations-spring-2018/#ticket</div><div id="presence" class="pull-right"></div><div class="ticketgui"><script type="text/javascript" src="lib/checktab.js"></script>

<script>
var expanded = false;
function expand_description() {
    var desc = $(".description");
    if(!expanded) {
        expanded = true;
        //expand to minheight
        var min = 250;
        if(desc.height() < min) {
            desc.animate({height: min}, 200);
        }
    }
}

$(document).ready(function() {
    $("input[name='nad']").datepicker({
        dateFormat: 'yy-mm-dd'
    });
});

</script>



<style>
.form-horizontal .control-label {
padding-top: inherit;
font-size:90%;
color:#666;
}
label {
margin-bottom: 0px;
}
.controls {
line-height: 18px;
}
</style>
<form class="form-horizontal" action="https://ticket.opensciencegrid.org/viewer/updatebasic?id=14803" method="post">
<div class="page-header">
    <h3><span class="muted">14803</span> / WLCG detailed Gratia page is not working</h3>
</div>

<div class="row-fluid">
<div class="span5">
    <legend>Contact</legend>
    <div class="control-group">
        <label class="control-label">Full Name</label>
        <div class="controls">Shawn McKee</div>
    </div>
    <div class="control-group">
        <label class="control-label">Email</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">Phone</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">CC</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>

    <legend>Details</legend>
    <div class="control-group"><label class="control-label">Submitted Via</label><div class="controls">GOC Ticket/submit</div></div><div class="control-group"><label class="control-label">Submitter</label><div class="controls">Shawn McKee</div></div>
    <div class="control-group">
        <label class="control-label">Ticket Type</label>
        <div class="controls">Problem/Request</div>
    </div>
    <div class="control-group">
        <label class="control-label">Priority</label>
        <div class="controls">Normal</div>
    </div>
    <div class="control-group">
        <label class="control-label">Status</label>
        <div class="controls">
Closed</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action</label>
        <div class="controls">Brad (Support person) is looking in to this</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action Deadline</label>
        <div class="controls flag_red">2013-06-30</div>
    </div>

</div><!--span-->
<div class="span7">
    <legend>Assignees</legend>
    <div class="assignee" style="width: 60%">Scott Teige <span class="muted"> / OSG Operations Infrastructure</span></div>    <br>

    <legend>Assignees</legend>
    TODO
    <br>

    <style>
legend.noborder {
border-bottom: none;
}
</style>

<div id="attachment-list"/>
<script>
$(function () {
    var first = true;
    $.getJSON("attachment/list/14803", function (files) {
        //console.dir(files);
        var html = "<table class=\"table table-condensed\">";
        $(files).each(function() {
            if(first) {
                first = false;
                html += "<legend class=\"noborder\">Attachmenets</legend>";
            }
            html += "<tr class=\"attachment\">";
            html += "<td><img src=\""+this.thumbnail_url+"\"/></td>";
            html += "<td><a href=\""+this.url+"\" target=\"_blank\">"+this.name+"</a></td>";
            html += "<td>"+bytesToSize(this.size, 1)+"</td>";
            html += "</tr>";
        });
        html += "</table>";
        $("#attachment-list").html(html);
    });
});

function download(url) {
    window.open(url, "_blank");
}
</script>


</div><!--span-->
</div><!--row-fluid-->


</form>

</div>
<div id="updates" style="clear: both;">
    <legend>Past Updates
    <div class="btn-toolbar pull-right toolbar">
        <div class="btn-group">
                <a class="btn btn-small" href="https://ticket.opensciencegrid.org/14803?sort=up&amp;"><i class="icon-arrow-up"></i> Sort</a>

        
        <a class="btn btn-small" href="https://ticket.opensciencegrid.org/14803?expandall=true&amp;">Expand Descriptions</a>        <a class="btn btn-small" target="_blank" href="mailto:osg@tick.globalnoc.iu.edu?subject=Open%20Science%20Grid%3A%20WLCG%20detailed%20Gratia%20page%20is%20not%20working%20ISSUE%3D14803%20PROJ%3D71"><i class="icon-envelope"></i> Update w/Email</a>
        </div>
    </div><!--btn-toolbar-->
    </legend>

    <div class='update_description'><i onclick="document.location='14803#1373296344'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-07-08T15:12:24+00:00">Jul 8, 2013 03:12 PM UTC</time> by <b>Soichi Hayashi</b><a class="anchor" name="1373296344">&nbsp;</a></div><pre>Closing this ticket.</pre></div><div class='update_description'><i onclick="document.location='14803#1372447030'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-06-28T19:17:10+00:00">Jun 28, 2013 07:17 PM UTC</time><a class="anchor" name="1372447030">&nbsp;</a></div><pre>Yeah, I think it is ok to close this too.

Brad Hurst

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=William B Hurst 1156</pre></div><div class='update_description'><i onclick="document.location='14803#1372344958'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-06-27T14:55:58+00:00">Jun 27, 2013 02:55 PM UTC</time> by <b>Soichi Hayashi</b><a class="anchor" name="1372344958">&nbsp;</a></div><pre>The new version of gratia is released, and <a href='http&#58;//gratiaweb.grid.iu.edu/gratia/wlcg_reporting' target='_blank' rel='nofollow'>http&#58;//gratiaweb.grid.iu.edu/gratia/wlcg_reporting</a> is working again.

I believe other issues described in this ticket are now either resolved or stored in Jira. If so, can we close this ticket?</pre></div><div class='update_description'><i onclick="document.location='14803#1371833400'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-06-21T16:50:00+00:00">Jun 21, 2013 04:50 PM UTC</time><a class="anchor" name="1371833400">&nbsp;</a></div><pre>Production releases are scheduled for next Tuesday, June 25, 2013.

Best Regards,
Brad Hurst

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=William B Hurst 1156</pre></div><div class='update_description'><i onclick="document.location='14803#1371224709'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-06-14T15:45:09+00:00">Jun 14, 2013 03:45 PM UTC</time> by <b>Shawn McKee</b><a class="anchor" name="1371224709">&nbsp;</a></div><pre>FYI, I assume this  isn&#39;t production yet?  Trying to open
<a href='http&#58;//gratiaweb.grid.iu.edu/gratia/wlcg_reporting' target='_blank' rel='nofollow'>http&#58;//gratiaweb.grid.iu.edu/gratia/wlcg_reporting</a> now gives&#58;

Proxy Error

The proxy server received an invalid response from an upstream server.
The proxy server could not handle the request *GET
/gratia/wlcg_reporting&#60;<a href='http&#58;//gratiaweb.grid.iu.edu/gratia/wlcg_reporting&#62' target='_blank' rel='nofollow'>http&#58;//gratiaweb.grid.iu.edu/gratia/wlcg_reporting&#62</a>;
*.

Reason&#58; *Error reading from remote server*

Can you send an update to the ticket once the production instance is
working?  Thanks,

Shawn

On Thu, Jun 13, 2013 at 2&#58;40 PM, Open Science Grid FootPrints &#60;
osg@....&#62; wrote&#58;

<font color='#7F7E6F'>&#62;  [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='14803#1371148814'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-06-13T18:40:14+00:00">Jun 13, 2013 06:40 PM UTC</time><a class="anchor" name="1371148814">&nbsp;</a></div><pre>Once the latest versions in gratia-itb get into production, you will find that the WLCG pages (Detailed and Overview) are working.

Best Regards,
Brad Hurst

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=William B Hurst 1156</pre></div><div class='update_description'><i onclick="document.location='14803#1370357684'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-06-04T14:54:44+00:00">Jun 4, 2013 02:54 PM UTC</time><a class="anchor" name="1370357684">&nbsp;</a></div><pre>Soichi,

Agree, I think we should document the issues in a new JIRA ticket
and incorporate a list of the items that need to be addressed.

These are the current tickets (JIRA and goc) that I think are related to the
issues.  We should create the new ticket and add the current set of
reporters and cc&#39;s as watchers so they can add their comments as it
proceeds....

JIRA tickets
Various issues with gratiaweb interface
<a href='https&#58;//jira.opensciencegrid.org/browse/GRATIAWEB-29' target='_blank' rel='nofollow'>https&#58;//jira.opensciencegrid.org/browse/GRATIAWEB-29</a>

goc tickets
WLCG detailed Gratia page not working
<a href='https&#58;//ticket.grid.iu.edu/goc/14803' target='_blank' rel='nofollow'>https&#58;//ticket.grid.iu.edu/goc/14803</a>

Accounting questions for MWT2
<a href='https&#58;//ticket.grid.iu.edu/goc/14963' target='_blank' rel='nofollow'>https&#58;//ticket.grid.iu.edu/goc/14963</a>

gratia/wlcg_reporting page is not working
<a href='https&#58;//ticket.grid.iu.edu/goc/13300' target='_blank' rel='nofollow'>https&#58;//ticket.grid.iu.edu/goc/13300</a>
- this one is closed but I do not think all items were
addressed.

John Weigand

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=John Weigand 144</pre></div><div class='update_description'><i onclick="document.location='14803#1370288391'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-06-03T19:39:51+00:00">Jun 3, 2013 07:39 PM UTC</time> by <b>Soichi Hayashi</b><a class="anchor" name="1370288391">&nbsp;</a></div><pre>Should we move this ticket to Jira?</pre></div><div class='update_description'><i onclick="document.location='14803#1369945450'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-05-30T20:24:10+00:00">May 30, 2013 08:24 PM UTC</time> by <b>wbhurst@....</b><a class="anchor" name="1369945450">&nbsp;</a></div><pre>-----BEGIN PGP SIGNED MESSAGE-----
Hash&#58; SHA1

Thanks, John, for keeping up with my messages,

The correct URL was the first step to clearing up the problem.
For the first time, I am seeing the pages work with current dates.
Both the wlcg_reporting.py and the jot_reporting.py pages are returning
results. (Files Attached)

In a previous email, John, you indicated that the results were
questionable. Is there a place to check the results?

I will probably need to talk to you before this is over. Would you be
willing to give me your phone number?

Best Regards,
Brad Hurst

On 05/30/2013 02&#58;01 PM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='14803#1369942561'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-05-30T19:36:01+00:00">May 30, 2013 07:36 PM UTC</time><a class="anchor" name="1369942561">&nbsp;</a></div><pre>Brad,

Is there a dev url that you are working this on?
Ashu had given me this one back several months ago...
<a href='http&#58;//hcc-osgdev.unl.edu&#58;8100/gratia/wlcg_reporting' target='_blank' rel='nofollow'>http&#58;//hcc-osgdev.unl.edu&#58;8100/gratia/wlcg_reporting</a>

John Weigand

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=John Weigand 144</pre></div><div class='update_description'><i onclick="document.location='14803#1369940500'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-05-30T19:01:40+00:00">May 30, 2013 07:01 PM UTC</time><a class="anchor" name="1369940500">&nbsp;</a></div><pre><font color='#7F7E6F'>&#62; Are there changes I need to make to the queries beyond the URL?</font>
I would think not.

<font color='#7F7E6F'>&#62; If it is OK, I will try to find a code sample to paste into a comment.</font>
<font color='#7F7E6F'>&#62; This may take a little time to track down.</font>
Not sure what this is about.
I would run against gr13x6 in both functions and see what happens

John Weigand

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=John Weigand 144</pre></div><div class='update_description'><i onclick="document.location='14803#1369939870'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-05-30T18:51:10+00:00">May 30, 2013 06:51 PM UTC</time> by <b>wbhurst@....</b><a class="anchor" name="1369939870">&nbsp;</a></div><pre>-----BEGIN PGP SIGNED MESSAGE-----
Hash&#58; SHA1

Thanks John,

If it is OK, I will try to find a code sample to paste into a comment.
This may take a little time to track down.

Best Regards,
Brad Hurst

On 05/30/2013 01&#58;11 PM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='14803#1369939513'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-05-30T18:45:13+00:00">May 30, 2013 06:45 PM UTC</time> by <b>wbhurst@....</b><a class="anchor" name="1369939513">&nbsp;</a></div><pre>-----BEGIN PGP SIGNED MESSAGE-----
Hash&#58; SHA1

Thanks, John, for your responsiveness and clarity.

- From your description it seems like the data format may have changed too.

Are there changes I need to make to the queries beyond the URL?

Best Regards,
Brad Hurst

On 05/30/2013 10&#58;44 AM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='14803#1369938410'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-05-30T18:26:50+00:00">May 30, 2013 06:26 PM UTC</time><a class="anchor" name="1369938410">&nbsp;</a></div><pre>Just discovered something.  It appears EGI is showing all metrics back through the
beginning of time as HS06 and not SI2K.

This is the page which shows our data and the pledge for a period...
<a href='http&#58;//accounting.egi.eu/reptier2.php' target='_blank' rel='nofollow'>http&#58;//accounting.egi.eu/reptier2.php</a>

What I don&#39;t have on the gr13x6 page is the pledge amount.
Can you see just where the wlcg-reporting code is getting this information.

We may be able to simplify things by me converting all the pre-2012-03 data
on gr13x6 to HS06.

John Weigand

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=John Weigand 144</pre></div><div class='update_description'><i onclick="document.location='14803#1369937493'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-05-30T18:11:33+00:00">May 30, 2013 06:11 PM UTC</time><a class="anchor" name="1369937493">&nbsp;</a></div><pre>Brad,

Another item I just remembered.... actually a bit of a complication.

In the beginning, we sent data up to WLCG normalized by an SI2K normalization factor.
For an period, they required us to still send it up as SI2K and they would multiply by 4 to
derive a HEPSpec06 value.

Then they had us change to using HEPSpec06 in the data we sent.
I believe it was in that transition period of 2012-03.
That is likely what some of the logic is in that the function prior to 2012-03.

I do not know how they were handling this.

Since one of that purposes of the wlcg_reporting page was to show how a resource group/
accounting group was doing against MOU pledge, I assume it all depended on what the
pledges represented as to it used the SI2K or HS06 value.

If you can tell me how the module is handling this, maybe we can simplify things.
I can convert that old data to the summary.dat format but need to know whether the
Normalized values need to be converted to HS06 or not.

Getting messy.... actually always was

John Weigand

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=John Weigand 144</pre></div><div class='update_description'><i onclick="document.location='14803#1369928643'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-05-30T15:44:03+00:00">May 30, 2013 03:44 PM UTC</time><a class="anchor" name="1369928643">&nbsp;</a></div><pre>Brad,

I am responsible for the Gratia-APEL interface and the data you are referencing.

All the data for the interface can be accessed from <a href='http&#58;//gr13x6.fnal.gov&#58;8319/gratia-apel/' target='_blank' rel='nofollow'>http&#58;//gr13x6.fnal.gov&#58;8319/gratia-apel/</a> .

On 2012-03, the interface was modified to support a new APEL protocol which necessitated a
different format for the data the wlcg_reporting site used.  We also changed machines that the
interface ran on.  I told Ashu at that time that all the data was on gr13x6.  So, on your end, he had to
access a different format for prior to 2012-03.

Why he had it still going from gr7x3 is something I cannot answer?  An oversight I assume.
As you can see on the url above, all the files needed are on gr13x6.

Does that answer your question?

On another note, just prior to you taking over, Ashu and I were trying to get an understanding of
the data being displayed on that page as much of it did not look correct even when you could access it.
So, please keep me in the loop as I have a good understanding of, at least, the accounting data being displayed
and what it is suppose to represent.  It is some of the other data that is a little mysterious.

John Weigand

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=John Weigand 144</pre></div><div class='update_description'><i onclick="document.location='14803#1369926122'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-05-30T15:02:02+00:00">May 30, 2013 03:02 PM UTC</time><a class="anchor" name="1369926122">&nbsp;</a></div><pre>Hello,

The link&#58;
&#34;<a href='http&#58;//gr7x3.fnal.gov&#58;8880/gratia-data/interfaces/apel-lcg/%i-%02i.summary.dat&#34' target='_blank' rel='nofollow'>http&#58;//gr7x3.fnal.gov&#58;8880/gratia-data/interfaces/apel-lcg/%i-%02i.summary.dat&#34</a>;
is what is in the &#39;get_apel_data_since201203&#39; function.

While the summary data page&#58;
&#34;<a href='http&#58;//gr13x6.fnal.gov&#58;8319/gratia-apel//2013-03.summary.dat&#34' target='_blank' rel='nofollow'>http&#58;//gr13x6.fnal.gov&#58;8319/gratia-apel//2013-03.summary.dat&#34</a>; with lots of &#39;n/a&#39; entries.

What is the url address I should use use in the code to acquire the APEL data? Where did APEL go?

Best Regards,
Brad Hurst

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=William B Hurst 1156</pre></div><div class='update_description'><i onclick="document.location='14803#1369925172'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-05-30T14:46:12+00:00">May 30, 2013 02:46 PM UTC</time><a class="anchor" name="1369925172">&nbsp;</a></div><pre>The code for wlcg_reporting.py has the following address for the &#39;get_apel_data_since201203&#39; function&#58;
<a href='http&#58;//gr7x3.fnal.gov&#58;8880/gratia-data/interfaces/apel-lcg/%i-%02i.summary.dat' target='_blank' rel='nofollow'>http&#58;//gr7x3.fnal.gov&#58;8880/gratia-data/interfaces/apel-lcg/%i-%02i.summary.dat</a>

Which shows &#39;n/a&#39; for about all data from 2012-05. Where did APEL go?

Best Regards,
Brad Hurst

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=William B Hurst 1156</pre></div><div class='update_description'><i onclick="document.location='14803#1368819461'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-05-17T19:37:41+00:00">May 17, 2013 07:37 PM UTC</time><a class="anchor" name="1368819461">&nbsp;</a></div><pre>Hello Soichi,

I can verify that your email is properly signed and
encrypted.

Thanks to both you, Soichi and Elizabeth for helping
to test this capability.

The problem with my email encryption is something with
the way thunderbird is configured on my end. There is
something odd about it, because thunderbird keeps
putting Soichi under the Servers tab of the certificates.

I am hoping this will encrypt to Soichi, but still
send to Elizabeth. In the event that this fails, I
will allow it to go out unencrypted.

Best Wishes,
Brad Hurst

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=William B Hurst 1156</pre></div><div class='update_description'><i onclick="document.location='14803#1368457638'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-05-13T15:07:18+00:00">May 13, 2013 03:07 PM UTC</time><a class="anchor" name="1368457638">&nbsp;</a></div><pre>Hello Soichi,

I am having trouble connecting with the information you sent to me in the email.

Unfortunately, I cannot communicate with you unless I also have an email from you with a valid signature. Maybe there is a web page somewhere that I could go to to get everyone&#39;s public encryption keys, but I do not know where that is.

Could you send me a signed email, so we can send encrypted messages back and forth?

Best Regards,
Brad Hurst

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=William B Hurst 1156</pre></div><div class='update_description'><i onclick="document.location='14803#1368453420'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-05-13T13:57:00+00:00">May 13, 2013 01:57 PM UTC</time> by <b>Soichi Hayashi</b><a class="anchor" name="1368453420">&nbsp;</a></div><pre>I have reset user/pass for rsvprocess1/rsvprocess-itb.grid.iu.edu. I have also sent the new user/pass to Brad via encrypted email.

madman.uits.indiana.edu no longer exists, so no action there.</pre></div><div class='update_description'><i onclick="document.location='14803#1368450942'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-05-13T13:15:42+00:00">May 13, 2013 01:15 PM UTC</time><a class="anchor" name="1368450942">&nbsp;</a></div><pre>Hi,

For the passwords that were mistakenly posted in plain text below - can we go through and nuke all the corresponding accounts?

Please don&#39;t post passwords over email in the future.

Thanks,

Brian

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=Brian Bockelman</pre></div><div class='update_description'><i onclick="document.location='14803#1368199287'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-05-10T15:21:27+00:00">May 10, 2013 03:21 PM UTC</time><a class="anchor" name="1368199287">&nbsp;</a></div><pre>yes, I can reach the mysql server rsvprocess1.grid.iu.edu on port 49152.

I will update my DBParam.xml file.

Thanks, Soichi.

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=William B Hurst 1156</pre></div><div class='update_description'><i onclick="document.location='14803#1368198907'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-05-10T15:15:07+00:00">May 10, 2013 03:15 PM UTC</time> by <b>Soichi Hayashi</b><a class="anchor" name="1368198907">&nbsp;</a></div><pre>I&#39;ve used CIDR of 129.93.0.0/16. You should be able to connect to rsvprocess1 via port 49152. Can you try?</pre></div><div class='update_description'><i onclick="document.location='14803#1368198166'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-05-10T15:02:46+00:00">May 10, 2013 03:02 PM UTC</time><a class="anchor" name="1368198166">&nbsp;</a></div><pre>Soichi,

I am using NAT and the first router I see is 129.93.227.126

Brad

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=William B Hurst 1156</pre></div><div class='update_description'><i onclick="document.location='14803#1368196288'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-05-10T14:31:28+00:00">May 10, 2013 02:31 PM UTC</time> by <b>Soichi Hayashi</b><a class="anchor" name="1368196288">&nbsp;</a></div><pre>Do you know the IP address range for UNL? If not, what is your public IP address that you are connecting from?</pre></div><div class='update_description'><i onclick="document.location='14803#1368195623'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-05-10T14:20:23+00:00">May 10, 2013 02:20 PM UTC</time><a class="anchor" name="1368195623">&nbsp;</a></div><pre>Soichi,

To assist you in setting up port forwarding through IU for my connectins I am supplying my networking information, below.

ifconfig -a eth0
eth0      Link encap&#58;Ethernet  HWaddr 08&#58;00&#58;27&#58;86&#58;78&#58;94
inet addr&#58;10.0.2.15  Bcast&#58;10.0.2.255  Mask&#58;255.255.255.0
inet6 addr&#58; fe80&#58;&#58;a00&#58;27ff&#58;fe86&#58;7894/64 Scope&#58;Link
UP BROADCAST RUNNING MULTICAST  MTU&#58;1500  Metric&#58;1
RX packets&#58;14057 errors&#58;0 dropped&#58;0 overruns&#58;0 frame&#58;0
TX packets&#58;9476 errors&#58;0 dropped&#58;0 overruns&#58;0 carrier&#58;0
collisions&#58;0 txqueuelen&#58;1000
RX bytes&#58;8427831 (8.0 MiB)  TX bytes&#58;1012059 (988.3 KiB)

[wbhurst@veritas ~&#58; 1002]$ netstat -nr
Kernel IP routing table
Destination     Gateway         Genmask         Flags   MSS Window  irtt Iface
10.9.0.1        10.9.0.9        255.255.255.255 UGH       0 0          0 tun_pki
10.9.0.9        0.0.0.0         255.255.255.255 UH        0 0          0 tun_pki
192.168.4.0     10.9.0.9        255.255.255.0   UG        0 0          0 tun_pki
192.168.3.0     10.9.0.9        255.255.255.0   UG        0 0          0 tun_pki
10.0.2.0        0.0.0.0         255.255.255.0   U         0 0          0 eth0
10.10.1.0       10.9.0.9        255.255.255.0   UG        0 0          0 tun_pki
192.168.122.0   0.0.0.0         255.255.255.0   U         0 0          0 virbr0
10.158.0.0      10.9.0.9        255.255.0.0     UG        0 0          0 tun_pki
10.159.0.0      10.9.0.9        255.255.0.0     UG        0 0          0 tun_pki
10.138.0.0      10.9.0.9        255.255.0.0     UG        0 0          0 tun_pki
10.139.0.0      10.9.0.9        255.255.0.0     UG        0 0          0 tun_pki
0.0.0.0         10.0.2.2        0.0.0.0         UG        0 0          0 eth0

Let me know, if you need anything else.
Brad Hurst

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=William B Hurst 1156</pre></div><div class='update_description'><i onclick="document.location='14803#1368132571'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-05-09T20:49:31+00:00">May 9, 2013 08:49 PM UTC</time> by <b>Soichi Hayashi</b><a class="anchor" name="1368132571">&nbsp;</a></div><pre>Port 3306 is blocked by IU&#39;s border router (last time I checked anyway).. I need to setup a port forwarding from your LAN.</pre></div><div class='update_description'><i onclick="document.location='14803#1368128229'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-05-09T19:37:09+00:00">May 9, 2013 07:37 PM UTC</time><a class="anchor" name="1368128229">&nbsp;</a></div><pre>Thanks, Soichi, for sending me an updated DBParam.xml file.

The mysql server at rsvprocess1.grid.iu.edu, port 3306, is key to resolving the WLCG problems. Right now, I still can not connect to the server. If you can connect to it from your location, then I need to contact a system administrator at Indiana University to get my connections approved. Could you advise me as to your ability to connect?

Best Regards,
Brad Hurst

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=William B Hurst 1156</pre></div><div class='update_description'><i onclick="document.location='14803#1368127339'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-05-09T19:22:19+00:00">May 9, 2013 07:22 PM UTC</time> by <b>Soichi Hayashi</b><a class="anchor" name="1368127339">&nbsp;</a></div><pre>I  have sent ITB configuration to Brad and he received it.</pre></div><div class='update_description'><i onclick="document.location='14803#1368114578'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-05-09T15:49:38+00:00">May 9, 2013 03:49 PM UTC</time> by <b>Soichi Hayashi</b><a class="anchor" name="1368114578">&nbsp;</a></div><pre>They are incorrect.

I will send you my debug DBParam.xml in encrypted email (you want this for your development env right?). Can you send me a signed email?</pre></div><div class='update_description'><i onclick="document.location='14803#1368114364'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-05-09T15:46:04+00:00">May 9, 2013 03:46 PM UTC</time><a class="anchor" name="1368114364">&nbsp;</a></div><pre>apparently my DBParam.xml file has some problems. There are a few that are just incorrect.

&#60;-- ERROR 2005 (HY000)&#58; Unknown MySQL server host red-web.unl.edu (1) --&#62;
&#60;connection name=&#34;gip&#34;&#62;
&#60;attribute name=&#34;Interface&#34;&#62; MySQL &#60;/attribute&#62;
&#60;attribute name=&#34;Database&#34;&#62; gip &#60;/attribute&#62;
&#60;attribute name=&#34;Host&#34;&#62; red-web.unl.edu &#60;/attribute&#62;
&#60;attribute name=&#34;Port&#34;&#62; 3306 &#60;/attribute&#62;
&#60;attribute name=&#34;AuthDBUsername&#34;&#62; brian &#60;/attribute&#62;
&#60;attribute name=&#34;AuthDBPassword&#34;&#62; gip8proj &#60;/attribute&#62;
&#60;/connection&#62;

&#60;-- pings ok, but stalls on connection request --  port blocked? --&#62;
&#60;-- ERROR 2003 (HY000)&#58; Can t connect to MySQL server on rsvprocess1.grid.iu.edu (110) --&#62;
&#60;connection name=&#34;rsv&#34;&#62;
&#60;attribute name=&#34;Interface&#34;&#62; MySQL &#60;/attribute&#62;
&#60;attribute name=&#34;Database&#34;&#62; rsvprocess &#60;/attribute&#62;
&#60;attribute name=&#34;Host&#34;&#62; rsvprocess1.grid.iu.edu &#60;/attribute&#62;
&#60;attribute name=&#34;Port&#34;&#62;49152&#60;/attribute&#62;
&#60;attribute name=&#34;AuthDBUsername&#34;&#62; rsv &#60;/attribute&#62;
&#60;attribute name=&#34;AuthDBPassword&#34;&#62; cocooocococooco &#60;/attribute&#62;
&#60;/connection&#62;

&#60;-- ERROR 2005 (HY000)&#58; Unknown MySQL server host madman.uits.indiana.edu (1) --&#62;
&#60;connection name=&#34;rsvitb&#34;&#62;
&#60;attribute name=&#34;Interface&#34;&#62; MySQL &#60;/attribute&#62;
&#60;attribute name=&#34;Database&#34;&#62; gratia &#60;/attribute&#62;
&#60;attribute name=&#34;Host&#34;&#62; madman.uits.indiana.edu &#60;/attribute&#62;
&#60;attribute name=&#34;Port&#34;&#62;49152&#60;/attribute&#62;
&#60;attribute name=&#34;AuthDBUsername&#34;&#62; rsv-report &#60;/attribute&#62;
&#60;attribute name=&#34;AuthDBPassword&#34;&#62; 9gsbbdrfom &#60;/attribute&#62;
&#60;/connection&#62;

As these connections are important to any further debugging of this problem, can someone advise as to whether these are correct?

<div id='show_1572683734' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_1572683734'>Best Regards,
Brad Hurst

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=William B Hurst 1156
</div><script type='text/javascript'>
        $('#show_1572683734').click(function() {
            $('#detail_1572683734').slideDown("normal");
            $('#show_1572683734').hide();
            $('#hide_1572683734').show();
        });
        $('#hide_1572683734').click(function() {
            $('#detail_1572683734').slideUp();
            $('#hide_1572683734').hide();
            $('#show_1572683734').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='14803#1368108372'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-05-09T14:06:12+00:00">May 9, 2013 02:06 PM UTC</time> by <b>Soichi Hayashi</b><a class="anchor" name="1368108372">&nbsp;</a></div><pre>(Removed Software Triage)</pre></div><div class='update_description'><i onclick="document.location='14803#1368107795'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-05-09T13:56:35+00:00">May 9, 2013 01:56 PM UTC</time> by <b>Tim Cartwright</b><a class="anchor" name="1368107795">&nbsp;</a></div><pre>It seems like there is no need for the Software team to be involved with this ticket at the moment. Is that reasonable? If so, can we drop the Software Support (Triage) assignee?</pre></div><div class='update_description'><i onclick="document.location='14803#1367516042'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-05-02T17:34:02+00:00">May 2, 2013 05:34 PM UTC</time><a class="anchor" name="1367516042">&nbsp;</a></div><pre>Hello,

From the multiple tickets associated with this GratiaWeb failure, I can see this issue is related to related to several other problems.

At present I am still in the process of familiarizing myself with, and testing system interaction processes; like packaging.

However, I expect to begin investigating this problem by next Tuesday.

Best Regards,
Brad Hurst

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=William B Hurst 1156</pre></div><div class='update_description'><i onclick="document.location='14803#1367425464'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-05-01T16:24:24+00:00">May 1, 2013 04:24 PM UTC</time><a class="anchor" name="1367425464">&nbsp;</a></div><pre>Found another related ticket
<a href='https&#58;//ticket.grid.iu.edu/goc/12335' target='_blank' rel='nofollow'>https&#58;//ticket.grid.iu.edu/goc/12335</a>

John Wegiand

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=John Weigand 144</pre></div><div class='update_description'><i onclick="document.location='14803#1367423501'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-05-01T15:51:41+00:00">May 1, 2013 03:51 PM UTC</time><a class="anchor" name="1367423501">&nbsp;</a></div><pre>This is very much related to this ticket  <a href='https&#58;//ticket.grid.iu.edu/goc/14963' target='_blank' rel='nofollow'>https&#58;//ticket.grid.iu.edu/goc/14963</a>
This ticket addresses the wlcg detail page where ticket 14963 is the summary page.
These 2 should be addressed together.
The data on both do not make any sense, at least accounting-wise.

John Weigand

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=John Weigand 144</pre></div><div class='update_description'><i onclick="document.location='14803#1367420692'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-05-01T15:04:52+00:00">May 1, 2013 03:04 PM UTC</time> by <b>Neha Sharma</b><a class="anchor" name="1367420692">&nbsp;</a></div><pre>Hi William

I am assigning this ticket to you since you are taking over after Ashu Guru. CC&#39;ing Brian aswell.

-Neha</pre></div><div class='update_description'><i onclick="document.location='14803#1366836212'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-04-24T20:43:32+00:00">Apr 24, 2013 08:43 PM UTC</time> by <b>Soichi Hayashi</b><a class="anchor" name="1366836212">&nbsp;</a></div><pre>Assigning software team.

Nothing in the GratiaWeb-error.log, and I see following in the GratiaWeb.out

Exception occurred while APEL data&#58; HTTP Error 404&#58; Not Found
Exception occurred while APEL data&#58; HTTP Error 404&#58; Not Found
Exception occurred while APEL data&#58; HTTP Error 404&#58; Not Found
Exception occurred while APEL data&#58; HTTP Error 404&#58; Not Found</pre></div><div class='update_description'><i onclick="document.location='14803#1366830563'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2013-04-24T19:09:23+00:00">Apr 24, 2013 07:09 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1366830563">&nbsp;</a></div><pre>See URL <a href='http&#58;//gratiaweb.grid.iu.edu/gratia/wlcg_reporting' target='_blank' rel='nofollow'>http&#58;//gratiaweb.grid.iu.edu/gratia/wlcg_reporting</a>

This returns a 404.

by Shawn McKee (guest)</pre></div><legend>Similar Recent Tickets <small>modified within the last 30 days</small></legend><div id="similar_tickets"><p class="muted">No similar tickets found.</p></div>
</div>
<script type="text/javascript">
function reset_anchor() {
    $("#updates .selected").removeClass("selected");
    var urls = document.location.toString().split('#'); 
    var anchor = urls[1];
    if(anchor) {
        $("a[name='"+anchor+"']").parents(".update_description").addClass("selected");
    }
}
function submitspam(ticket_id) {
    myret = confirm("Would you like to close this ticket as a security ticket, and submit the ticket content to akismet?");
    if(myret == true) {
        $.ajax("viewer/processspam?id="+ticket_id).done(function() {
            window.location.reload();
        });
    }
}

$(function() {
    reset_anchor();
    var ADDITIONAL_COOKIE_NAME = 'gocticket';
    var options = { path: '/', expires: 365};

    if(window.opener && window.opener.name == "gocticket_list") {
        v = $.cookie("closewindow");
        if(!v) {
            $("#closewindow").attr("checked", "checked"); //on by default
        } else {
            if(v == "checked") {
                $("#closewindow").attr("checked", "checked");
            }
        }
        $("#closewindow").click(function() {
            $.cookie("closewindow", $(this).attr('checked'), options);
        });
    } else {
        $("#closewindow_area").hide();
    }
    function updateTimeago() {
        $("time").timeago();
        setTimeout(updateTimeago, 30*1000);
    }
    updateTimeago();
    $(".description").focus(expand_description);
});
</script>
<hr/>
<footer>
<p>GOC Ticket Version 2.2 | <a href="https://ticket.opensciencegrid.org/goc/submit?app_issue_check=on&amp;app_issue_type=goc&amp;app_goc_url=https%3A%2F%2Fticket.opensciencegrid.org%3A443%2F14803">Report Bugs</a>
 | <a href="https://github.com/opensciencegrid/operations/blob/master/docs/privacy.md">Privacy Policy</a>
</p>

<p> <img align="top" src="images/tag_orange.png"/> Copyright 2018 The Trustees of Indiana University - Developed for Open Science Grid</p>
</footer>


</div><!--container-fluid-->
<script src="https://ticket1.grid.iu.edu:8443/socket.io/socket.io.js"></script>
<script>
var chat = io.connect('https://ticket1.grid.iu.edu:8443');
chat.on('connect', function() {
    chat.emit('authenticate', {nodekey:'', ticketid: 14803});
});
chat.on('peers', function(peers) {
    $("#peers").html("");
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('peer_disconnect', function(pid) {
    $("#peer_"+pid).hide("slow");
});
chat.on('peer_connected', function(peers) {
    //expect only 1 peer connecting, but..
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('submit', function() {
    if(confirm("This ticket was updated. Do you want to refresh?")) {
        history.go(0);
    }
});

function addPeer(pid, peer) {
    var ipinfo = "";
    if(peer.ip != undefined) {
        ipinfo = "<span class=\"ip\">"+peer.ip+"</span>";
    }
    if(chat.io.engine.id == pid) {
        //don't display myself
        return;
    }
    var html = "<li class=\"new\" id=\"peer_"+pid+"\" class=\"peer\">"+peer.name+ipinfo+"</li>";
    $("#peers").prepend(html);
    $("#peers .new").animate({bottom: 0}, 1000, function() {$(this).removeClass("new")});
}

$(function() {
    $("#ticket_form").submit(function() {
        chat.emit('submit');
        return true;
    });
});
</script>
<script>
//used by searchbox
function parseValue(value) {
    var obj = new Object();
    var tokens = value.split("\t");
    obj.str = tokens[0];
    obj.count = tokens[1];
    return obj;
}

$(function() {
    //bootstrap-2.0.4 stuff
    $(".alert-message").alert();
    $(".dropdown-toggle").dropdown();
    $("span[rel='tooltip']").tooltip();
    $("a[rel=popover]").popover();

    //activate menu that user is currently on
    $("#menu_navigator").addClass("active"); 
    $("#submenu_").addClass("active"); 

    //translate zend validation error message to bootstrap
    $(".errors").addClass("alert").addClass("alert-error");

    //enable autocomplete for search box
    $("#search").autocomplete({
        source: function( request, response ) {
            $.ajax({
                url: "search/autocomplete",
                dataType: "text",
                data: {
                    //featureClass: "P",
                    //style: "full",
                    //maxRows: 12,
                    //name_startsWith: request.term
                    q: request.term
                },
                success: function( data ) {
                    response( $.map( data.split("\n"), function( item ) {
                        if(item == "") return null;
                        return {
                            value: item
                        }
                    }));
                }
            });
        },
        select: function(event, ui) {
            document.location = "search?q="+ui.item.value;
        }
    });
    
});
</script>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-69012-13");
pageTracker._trackPageview();
} catch(err) {}
</script>

</body>
