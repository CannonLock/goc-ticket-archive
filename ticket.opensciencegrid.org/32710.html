<!DOCTYPE html>
<html lang="en">
  <head>
  <base href="">
    <title>[32710] OSG production networking data publication to CERN&#39;s AMQ bus has stopped again</title>    <meta charset="utf-8" />
    <meta name="verify-v1" content="na5IcAJsZVOfEkboRxuIiZ1zpZgnZiWra+nKcS7nA/o=" />
    <meta name="google-site-verification" content="DLrk3ft4s8b-S2TloLCL2LD_t6wcTjgSluf5pmiu2kA" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />
    <link href="https://ticket.opensciencegrid.org/rss" rel="alternate" type="application/rss+xml" title="GOC Ticket Update feed" />

    <style type="text/css">
      body {
        padding-top: 50px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
     #search {
            width: 300px;
     }

    </style>

<script src="https://code.jquery.com/jquery-3.0.0.js"></script>
<script src="https://code.jquery.com/jquery-migrate-3.0.1.js"></script>

   <link href="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet"/>
    <script src="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/js/bootstrap.min.js"></script>

    <link href="https://netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"/>
    <link href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/themes/smoothness/jquery-ui.min.css" rel="stylesheet"/>
 <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>


    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/js/select2.min.js"></script>

    <link href="css/ticket.css" rel="stylesheet" />
    <script src="lib/jquery.cookie.js"></script>

    <link href="images/tag_orange.png" rel="icon" type="image/png"/>
  </head>

  <body>
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>

            <a class="brand" style="padding: 6px 0px 0px 6px;" href="http://opensciencegrid.org"><img src="images/osglogo.40x30.png"/></a>
            <ul class="nav">
                <li class="dropdown"><a href="https://ticket.opensciencegrid.org/#" class="dropdown-toggle" data-toggle="dropdown">GOC Ticket <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    <li><a href="https://my.opensciencegrid.org">MyOSG</a></li>
                    <li><a href="https://oim.opensciencegrid.org">OIM</a></li>
                    <li class="active"><a href="https://ticket.opensciencegrid.org/index">Ticket</a></li>
	<li class="divider"></li>
	<li><a href="http://repo.grid.iu.edu">Repo</a></li>
	<li class="divider"></li>
	<li><a href="http://blogs.grid.iu.edu">Blog</a></li>
                    <li><a href="http://display.grid.iu.edu">Display</a></li>
                    <li><a href="http://osggoc.blogspot.com/">News</a></li>
                    </ul>
                </li>
            </ul>
            <ul class="nav pull-right">
                <li><a href="https://ticket.opensciencegrid.org/sso/">Login</a></li>            </ul>

            <div class="nav-collapse">
                <ul class="nav">
			 <li id="menu_submit"><a href="https://ticket.opensciencegrid.org/submit">Submit</a></li><li id="menu_view" class="dropdown"><a href="https://ticket.opensciencegrid.org/\#" class="dropdown-toggle" data-toggle="dropdown">View <b class="caret"></b></a><ul class="dropdown-menu"><li id="submenu_listopen"><a href="https://ticket.opensciencegrid.org/list/open">Open Tickets</a></li><li id="submenu_listrecentclose"><a href="https://ticket.opensciencegrid.org/list/recentclose">Recently Closed Tickets</a></li><li class="divider"></li><li id="submenu_alltickets"><a href="https://ticket.opensciencegrid.org/search?q=&amp;sort=id">All Tickets</a></li></ul></li>                </ul>

                <form class="navbar-search pull-right" action="https://ticket.opensciencegrid.org/viewer">
                    <input id="search" type="text" name="id" class="search-query span2" placeholder="Search Ticket" value=""/>
                </form>
            </div>
        </div>
      </div>
    </div>

<script type='text/javascript' src='lib/jquery.timeago.js'></script>
<script type='text/javascript' src='lib/byte2size.js'></script>
<style>
#updates .toolbar {
position: relative;
margin-top: 0px;
top: -10px;
font-weight: normal;
}
#updates a.anchor {
position: relative;
top: -50px;
}
#updates .selected pre {
animation:selected 2s;
animation-iteration-count: 2;
animation-direction: alternate;
-webkit-animation:selected 2s; 
-webkit-animation-iteration-count: 2;
-webkit-animation-direction: alternate;
box-shadow: inset 1px 1px 20px #9ad;
border: 1px solid #9ab;
margin: 5px 0px;
padding-left: 10px;
}
@keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ab;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
@-webkit-keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ad;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
#updates pre {
background-color: inherit;
line-height: 15px;
padding: 5px;
}
#updates .header {
color: #999;
}
#updates .update_history pre {
background-color: #eee;
color: #666;
font-size: 85%;
}
#updates .clickable {
cursor: pointer;
}
#updates .clickable:hover {
color: #D98719;
}
#updates .meta_information pre {
background-color: #fed;
}
#similar_tickets {
max-height: 300px;
overflow-y: auto;
pointer-events: none;
padding: 5px;
background-color: #f4f4f4;
}
.btn-toolbar {
margin-bottom: 0;
height: 30px;
}
#peers {
position: fixed;
bottom: 0px;
right: 0px;
z-index: 100;
list-style: none;
padding: 5px 0px 0px 5px;
margin: 0px;
background-color: white;
box-shadow: 0px 0px 10px white;
}
#peers li {
background-color: #ccc;
color: #000;
display: inline-block;
padding: 5px 10px;
margin-right: 5px;
position: relative;
}
/*
#peers li:hover {
background-color: #999;
cursor: pointer;
}
*/
#peers span.ip {
padding-left: 5px;
color: #666;
}
#peers .new {
bottom: -30px;
}
/*
#peers .me {
background-color: red;
}
*/
</style>

<div class="container-fluid">
<ul id="peers"></ul>
<div class="alert alert-danger"><a class="close" href="https://ticket.opensciencegrid.org/#" data-dismiss="alert">&times;</a>By the end of May 2018, the ticketing system at https://ticket.opensciencegrid.org will be retired and support will be provided at https://support.opensciencegrid.org. Throughout this transition the support email (help@opensciencegrid.org) will be available as a point of contact.<br><br>                                                   
                                                                                                                                                                                   
Please see the service migration page for details: https://opensciencegrid.github.io/technology/policy/service-migrations-spring-2018/#ticket</div><div id="presence" class="pull-right"></div><div class="ticketgui"><script type="text/javascript" src="lib/checktab.js"></script>

<script>
var expanded = false;
function expand_description() {
    var desc = $(".description");
    if(!expanded) {
        expanded = true;
        //expand to minheight
        var min = 250;
        if(desc.height() < min) {
            desc.animate({height: min}, 200);
        }
    }
}

$(document).ready(function() {
    $("input[name='nad']").datepicker({
        dateFormat: 'yy-mm-dd'
    });
});

</script>



<style>
.form-horizontal .control-label {
padding-top: inherit;
font-size:90%;
color:#666;
}
label {
margin-bottom: 0px;
}
.controls {
line-height: 18px;
}
</style>
<form class="form-horizontal" action="https://ticket.opensciencegrid.org/viewer/updatebasic?id=32710" method="post">
<div class="page-header">
    <h3><span class="muted">32710</span> / OSG production networking data publication to CERN&#39;s AMQ bus has stopped again</h3>
</div>

<div class="row-fluid">
<div class="span5">
    <legend>Contact</legend>
    <div class="control-group">
        <label class="control-label">Full Name</label>
        <div class="controls">Shawn McKee</div>
    </div>
    <div class="control-group">
        <label class="control-label">Email</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">Phone</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">CC</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>

    <legend>Details</legend>
    <div class="control-group"><label class="control-label">Resource Name</label><div class="controls">psds0</div></div><div class="control-group"><label class="control-label">Associated VO</label><div class="controls">Ops</div></div><div class="control-group"><label class="control-label">Submitted Via</label><div class="controls">GOC Ticket/submit</div></div><div class="control-group"><label class="control-label">Submitter</label><div class="controls">Shawn McKee</div></div><div class="control-group"><label class="control-label">Support Center</label><div class="controls">OSG-GOC</div></div><div class="control-group"><label class="control-label">Ticket Links</label><div class="controls"></div></div>
    <div class="control-group">
        <label class="control-label">Ticket Type</label>
        <div class="controls">Problem/Request</div>
    </div>
    <div class="control-group">
        <label class="control-label">Priority</label>
        <div class="controls">Normal</div>
    </div>
    <div class="control-group">
        <label class="control-label">Status</label>
        <div class="controls">
Closed</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action</label>
        <div class="controls">ENG Action</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action Deadline</label>
        <div class="controls flag_red">2017-03-10</div>
    </div>

</div><!--span-->
<div class="span7">
    <legend>Assignees</legend>
    <div class="assignee" style="width: 60%">OSG-GOC <span class="muted"> / OSG Support Centers</span></div>    <br>

    <legend>Assignees</legend>
    TODO
    <br>

    <style>
legend.noborder {
border-bottom: none;
}
</style>

<div id="attachment-list"/>
<script>
$(function () {
    var first = true;
    $.getJSON("attachment/list/32710", function (files) {
        //console.dir(files);
        var html = "<table class=\"table table-condensed\">";
        $(files).each(function() {
            if(first) {
                first = false;
                html += "<legend class=\"noborder\">Attachmenets</legend>";
            }
            html += "<tr class=\"attachment\">";
            html += "<td><img src=\""+this.thumbnail_url+"\"/></td>";
            html += "<td><a href=\""+this.url+"\" target=\"_blank\">"+this.name+"</a></td>";
            html += "<td>"+bytesToSize(this.size, 1)+"</td>";
            html += "</tr>";
        });
        html += "</table>";
        $("#attachment-list").html(html);
    });
});

function download(url) {
    window.open(url, "_blank");
}
</script>


</div><!--span-->
</div><!--row-fluid-->


</form>

</div>
<div id="updates" style="clear: both;">
    <legend>Past Updates
    <div class="btn-toolbar pull-right toolbar">
        <div class="btn-group">
                <a class="btn btn-small" href="https://ticket.opensciencegrid.org/32710?sort=up&amp;"><i class="icon-arrow-up"></i> Sort</a>

        
        <a class="btn btn-small" href="https://ticket.opensciencegrid.org/32710?expandall=true&amp;">Expand Descriptions</a>        <a class="btn btn-small" target="_blank" href="mailto:osg@tick.globalnoc.iu.edu?subject=Open%20Science%20Grid%3A%20OSG%20production%20networking%20data%20publication%20to%20CERN%26%2339%3Bs%20AMQ%20bus%20has%20stopped%20again%20ISSUE%3D32710%20PROJ%3D71"><i class="icon-envelope"></i> Update w/Email</a>
        </div>
    </div><!--btn-toolbar-->
    </legend>

    <div class='update_description'><i onclick="document.location='32710#1490125233'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-03-21T19:40:33+00:00">Mar 21, 2017 07:40 PM UTC</time> by <b>Scott Teige</b><a class="anchor" name="1490125233">&nbsp;</a></div><pre>Resolving, perfsonar now not under change management.</pre></div><div class='update_description'><i onclick="document.location='32710#1488206269'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-02-27T14:37:49+00:00">Feb 27, 2017 02:37 PM UTC</time> by <b>Scott Teige</b><a class="anchor" name="1488206269">&nbsp;</a></div><pre><a href='32653.html' target='_blank' rel='nofollow'>https&#58;//ticket.opensciencegrid.org/32653</a>
In response to cron timing question contains the following&#58;
11 * * * * root chmod -R ugoa+r /net/nas01/Public/logs/psds0

Examined logs for cron, I see a reference for it being loaded, none for it being executed.
Another mystery, executed it manually, permissions are now fine.</pre></div><div class='update_description'><i onclick="document.location='32710#1488039184'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-02-25T16:13:04+00:00">Feb 25, 2017 04:13 PM UTC</time><a class="anchor" name="1488039184">&nbsp;</a></div><pre>Another log file protection problem&#58;

[0] 16&#58;10&#58;30 UTC [smckee@jump&#58;pgsql]$ date
Sat Feb 25 16&#58;12&#58;27 UTC 2017
[0] 16&#58;12&#58;27 UTC [smckee@jump&#58;pgsql]$ ls -al data/postgresql-2017-02-*
-rw-r--r--+ 1 root root 212180867 Feb 25 16&#58;10 data/postgresql-2017-02-01_000000.log
-rw-r--r--+ 1 root root   5311055 Feb 25 16&#58;10 data/postgresql-2017-02-02_000000.log
-rw-r--r--+ 1 root root  26155247 Feb 25 16&#58;10 data/postgresql-2017-02-03_000000.log
-rw-r--r--+ 1 root root 257368631 Feb 25 16&#58;10 data/postgresql-2017-02-04_000000.log
-rw-r--r--+ 1 root root 189903186 Feb 25 16&#58;10 data/postgresql-2017-02-05_000000.log
-rw-r--r--+ 1 root root 103478406 Feb 25 16&#58;10 data/postgresql-2017-02-06_000000.log
-rw-r--r--+ 1 root root 154282418 Feb 25 16&#58;10 data/postgresql-2017-02-07_000000.log
-rw-r--r--+ 1 root root 167993669 Feb 25 16&#58;10 data/postgresql-2017-02-08_000000.log
-rw-r--r--+ 1 root root  85314112 Feb 25 16&#58;10 data/postgresql-2017-02-09_000000.log
-rw-r--r--+ 1 root root  82088716 Feb 25 16&#58;10 data/postgresql-2017-02-10_000000.log
-rw-r--r--+ 1 root root 148503313 Feb 25 16&#58;10 data/postgresql-2017-02-11_000000.log
-rw-r--r--+ 1 root root 159917353 Feb 25 16&#58;10 data/postgresql-2017-02-12_000000.log
-rw-r--r--+ 1 root root       610 Feb 25 16&#58;10 data/postgresql-2017-02-13_000000.log
-rw-r--r--+ 1 root root 195288362 Feb 25 16&#58;10 data/postgresql-2017-02-13_101550.log
-rw-r--r--+ 1 root root 323860974 Feb 25 16&#58;10 data/postgresql-2017-02-14_000000.log
-rw-r--r--+ 1 root root 248204246 Feb 25 16&#58;10 data/postgresql-2017-02-15_000000.log
-rw-r--r--+ 1 root root 274590270 Feb 25 16&#58;10 data/postgresql-2017-02-16_000000.log
-rw-r--r--+ 1 root root 208954953 Feb 25 16&#58;10 data/postgresql-2017-02-17_000000.log
-rw-r--r--+ 1 root root 347426449 Feb 25 16&#58;11 data/postgresql-2017-02-18_000000.log
-rw-r--r--+ 1 root root  17507288 Feb 25 16&#58;11 data/postgresql-2017-02-19_000000.log
-rw-r--r--+ 1 root root 353419321 Feb 25 16&#58;11 data/postgresql-2017-02-20_000000.log
-rw-r--r--+ 1 root root  47479950 Feb 25 16&#58;11 data/postgresql-2017-02-21_000000.log
-rw-------+ 1 root root 274822595 Feb 25 16&#58;11 data/postgresql-2017-02-22_000000.log
-rw-------+ 1 root root 196787819 Feb 25 16&#58;11 data/postgresql-2017-02-23_000000.log
-rw-------+ 1 root root 378689092 Feb 25 16&#58;11 data/postgresql-2017-02-24_000000.log
-rw-------+ 1 root root       250 Feb 25 16&#58;11 data/postgresql-2017-02-25_000000.log

Can someone see if a tweak is needed?  Thanks,

Shawn
<div id='show_223352611' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_223352611'>
by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=mckee/CN=500323/CN=Shawn Mc Kee
</div><script type='text/javascript'>
        $('#show_223352611').click(function() {
            $('#detail_223352611').slideDown("normal");
            $('#show_223352611').hide();
            $('#hide_223352611').show();
        });
        $('#hide_223352611').click(function() {
            $('#detail_223352611').slideUp();
            $('#hide_223352611').hide();
            $('#show_223352611').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='32710#1487769874'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-02-22T13:24:34+00:00">Feb 22, 2017 01:24 PM UTC</time><a class="anchor" name="1487769874">&nbsp;</a></div><pre>Hi Scott,

Thanks, the protection issue is resolved now.

About the &#39;messages&#39; file, it only has stompclt messages starting on the 22nd?   I need the log files cover from the beginning of the 11th through the 19th (the period spanning the two problems we saw).

Thanks,

Shawn

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=mckee/CN=500323/CN=Shawn Mc Kee</pre></div><div class='update_description'><i onclick="document.location='32710#1487705650'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-02-21T19:34:10+00:00">Feb 21, 2017 07:34 PM UTC</time> by <b>Scott Teige</b><a class="anchor" name="1487705650">&nbsp;</a></div><pre>should have what you want. Permissions get reset hourly at *&#58;11
S</pre></div><div class='update_description'><i onclick="document.location='32710#1487687822'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-02-21T14:37:02+00:00">Feb 21, 2017 02:37 PM UTC</time><a class="anchor" name="1487687822">&nbsp;</a></div><pre>Hi Scott,

I have started looking at the logs.  It turns out these logs are not readable&#58;

[0] 14&#58;28&#58;37 UTC [smckee@jump&#58;psds0-mq-issue]$ ls -al /net/nas01/Public/logs/psds0/rsv/consumers/*.log-20170221.gz
-rw-r-----+ 1 root root   20 Feb 21 14&#58;20 /net/nas01/Public/logs/psds0/rsv/consumers/gratia-consumer.log-20170221.gz
-rw-r-----+ 1 root root 5216 Feb 21 14&#58;20 /net/nas01/Public/logs/psds0/rsv/consumers/html-consumer.log-20170221.gz
-rw-r-----+ 1 root root 5302 Feb 21 14&#58;20 /net/nas01/Public/logs/psds0/rsv/consumers/json-consumer.log-20170221.gz

Also I really will need the stompclt logs.  Can you process those messages into a separate file if the /var/log/messages is sensitive?  Something like&#58;
grep &#34;stompclt&#34; /var/log/messages &#62; /net/nas01/Public/logs/psds0/stompclt.log   (Of course you need to find the right search string)

Thanks,

Shawn

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=mckee/CN=500323/CN=Shawn Mc Kee</pre></div><div class='update_description'><i onclick="document.location='32710#1487613284'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-02-20T17:54:44+00:00">Feb 20, 2017 05:54 PM UTC</time><a class="anchor" name="1487613284">&nbsp;</a></div><pre>Hi Scott, stompclt logs directly to /var/log/messages

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=mbabik/CN=555091/CN=Marian Babik</pre></div><div class='update_description'><i onclick="document.location='32710#1487612992'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-02-20T17:49:52+00:00">Feb 20, 2017 05:49 PM UTC</time> by <b>Scott Teige</b><a class="anchor" name="1487612992">&nbsp;</a></div><pre>The logs have been added, should be readable, httpd restarted.
I can&#39;t find anything that looks like logging for stompctl. Suggestions?</pre></div><div class='update_description'><i onclick="document.location='32710#1487604057'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-02-20T15:20:57+00:00">Feb 20, 2017 03:20 PM UTC</time><a class="anchor" name="1487604057">&nbsp;</a></div><pre>Thanks for the info Scott.

I don&#39;t think the problem is load related.   We will need access to the rsv, simplevisor and stompctl logs to see if we can identify the problem (I hope Edgar can help diagnose).  The last time this happened (see attached jpg) was around the same time exactly 1 week before.

There are also a few other requests in this thread to help fix some issues and make future diagnosis more straightforward.   I hope those can get addressed soon.

Thanks,

Shawn

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=mckee/CN=500323/CN=Shawn Mc Kee</pre></div><div class='update_description'><i onclick="document.location='32710#1487600229'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-02-20T14:17:09+00:00">Feb 20, 2017 02:17 PM UTC</time> by <b>Scott Teige</b><a class="anchor" name="1487600229">&nbsp;</a></div><pre>Nothing special for every day but in this particular instance the system recovered when 5 min. average load dropped below 12.
I define a quantity &#34;normalized load&#34; as the 5 min. average load divided by the number of CPUs on the machine. This was
running at &#62;100% for quite some time during the failure, once it dropped to its more normal (but still worrisome) level of ~50%
the service apparently recovered.</pre></div><div class='update_description'><i onclick="document.location='32710#1487597590'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-02-20T13:33:10+00:00">Feb 20, 2017 01:33 PM UTC</time> by <b>Shawn McKee</b><a class="anchor" name="1487597590">&nbsp;</a></div><pre>Hi Scott,

It was restored almost exactly 24 hours after it went down...what happens
at around 10&#58;25 PM each day?

Thanks,

Shawn

On Mon, Feb 20, 2017 at 8&#58;22 AM, Open Science Grid FootPrints &#60;
osg@....&#62; wrote&#58;

<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='32710#1487596970'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-02-20T13:22:50+00:00">Feb 20, 2017 01:22 PM UTC</time> by <b>Scott Teige</b><a class="anchor" name="1487596970">&nbsp;</a></div><pre>On 19/Feb 10&#58;26 PM the rate returned to normal with no intervention by me.

Did someone else intervene?

S</pre></div><div class='update_description'><i onclick="document.location='32710#1487511247'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2017-02-19T13:34:07+00:00">Feb 19, 2017 01:34 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1487511247">&nbsp;</a></div><pre>We had the publication to the CERN message bus stop again last night around 22&#58;16 PM Eastern time.  Emails were sent to 	perfsonar-esmond-mq@.... which includes some of the OSG team.

Rather than just requesting we restart, I wanted to find out the cause of the problem.

I logged into jump and try to check logs on psds0 in /net/nas01/Public/logs/psds0

There are only three sub-directories&#58;  esmond pgsql and httpd.   We need to augment the psds0 log-shipping with the logs
for the rsv probes, the simplevisor and the stompctl processes.

Request1&#58;  Please add the log shipping for these services&#58;  RSV, simplevisor and stompctl

Another problem is that some files are protected against  reading for my &#39;smckee&#39; account&#58;

2017-02-19 13&#58;20&#58;10 UTC [smckee@jump&#58;/net/nas01/Public/logs/psds0]$ ls -al httpd/error_log-20170219
-rw-r-----+ 1 root root 20570 Feb 19 13&#58;16 httpd/error_log-20170219

Request2&#58;  Please make the logs readable by those with access to jump OR put a subset of users into a group which can
read. (At least Edgar, Marian and me to start)

On psds0 httpd error_log2 file we are seeing many errors like&#58;

&#34;[Wed Feb 17 00&#58;02&#58;30 2016] [error] [client 127.0.0.1] File does not exist&#58; /var/www/html/server-status&#34;

I think we need to configure access from localhost to the server-status&#58;

&#60;Location /server-status&#62;
SetHandler server-status
Order deny,allow
Deny from all
Allow from 127.0.0.1
&#60;/Location&#62;
ExtendedStatus On

Request3&#58;  Please add this to the httpd configuration on psds0.  It will at least cut down on the error logging

<div id='show_825816234' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_825816234'>Also found this&#58;

[Thu Feb 18 22&#58;05&#58;02 2016] [error] [client 129.79.53.126] File does not exist&#58; /var/www/html/stamp
[Thu Feb 18 22&#58;05&#58;05 2016] [error] [client 129.79.53.126] File does not exist&#58; /var/www/html/stamp

This is the  rsv2-client.grid.iu.edu trying to reach this location.  Edgar is this a problem?  What causes it?

The main problem right now is that data publication to CERN is again stopped.  I would like to understand why (logs would help)
but we should likely get the service restored ASAP.

Request4&#58;  Restart the affected services on psds0 to get publication restored to CERN&#39;s AMQ.

Let me know what questions or suggestions you might have.  Thanks,

Shawn

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=mckee/CN=500323/CN=Shawn Mc Kee

</div><script type='text/javascript'>
        $('#show_825816234').click(function() {
            $('#detail_825816234').slideDown("normal");
            $('#show_825816234').hide();
            $('#hide_825816234').show();
        });
        $('#hide_825816234').click(function() {
            $('#detail_825816234').slideUp();
            $('#hide_825816234').hide();
            $('#show_825816234').show();
        });
        </script></pre></div><legend>Similar Recent Tickets <small>modified within the last 30 days</small></legend><div id="similar_tickets"><p class="muted">No similar tickets found.</p></div>
</div>
<script type="text/javascript">
function reset_anchor() {
    $("#updates .selected").removeClass("selected");
    var urls = document.location.toString().split('#'); 
    var anchor = urls[1];
    if(anchor) {
        $("a[name='"+anchor+"']").parents(".update_description").addClass("selected");
    }
}
function submitspam(ticket_id) {
    myret = confirm("Would you like to close this ticket as a security ticket, and submit the ticket content to akismet?");
    if(myret == true) {
        $.ajax("viewer/processspam?id="+ticket_id).done(function() {
            window.location.reload();
        });
    }
}

$(function() {
    reset_anchor();
    var ADDITIONAL_COOKIE_NAME = 'gocticket';
    var options = { path: '/', expires: 365};

    if(window.opener && window.opener.name == "gocticket_list") {
        v = $.cookie("closewindow");
        if(!v) {
            $("#closewindow").attr("checked", "checked"); //on by default
        } else {
            if(v == "checked") {
                $("#closewindow").attr("checked", "checked");
            }
        }
        $("#closewindow").click(function() {
            $.cookie("closewindow", $(this).attr('checked'), options);
        });
    } else {
        $("#closewindow_area").hide();
    }
    function updateTimeago() {
        $("time").timeago();
        setTimeout(updateTimeago, 30*1000);
    }
    updateTimeago();
    $(".description").focus(expand_description);
});
</script>
<hr/>
<footer>
<p>GOC Ticket Version 2.2 | <a href="https://ticket.opensciencegrid.org/goc/submit?app_issue_check=on&amp;app_issue_type=goc&amp;app_goc_url=https%3A%2F%2Fticket.opensciencegrid.org%3A443%2F32710">Report Bugs</a>
 | <a href="https://github.com/opensciencegrid/operations/blob/master/docs/privacy.md">Privacy Policy</a>
</p>

<p> <img align="top" src="images/tag_orange.png"/> Copyright 2018 The Trustees of Indiana University - Developed for Open Science Grid</p>
</footer>


</div><!--container-fluid-->
<script>
var chat = io.connect('https://ticket1.grid.iu.edu:8443');
chat.on('connect', function() {
    chat.emit('authenticate', {nodekey:'', ticketid: 32710});
});
chat.on('peers', function(peers) {
    $("#peers").html("");
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('peer_disconnect', function(pid) {
    $("#peer_"+pid).hide("slow");
});
chat.on('peer_connected', function(peers) {
    //expect only 1 peer connecting, but..
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('submit', function() {
    if(confirm("This ticket was updated. Do you want to refresh?")) {
        history.go(0);
    }
});

function addPeer(pid, peer) {
    var ipinfo = "";
    if(peer.ip != undefined) {
        ipinfo = "<span class=\"ip\">"+peer.ip+"</span>";
    }
    if(chat.io.engine.id == pid) {
        //don't display myself
        return;
    }
    var html = "<li class=\"new\" id=\"peer_"+pid+"\" class=\"peer\">"+peer.name+ipinfo+"</li>";
    $("#peers").prepend(html);
    $("#peers .new").animate({bottom: 0}, 1000, function() {$(this).removeClass("new")});
}

$(function() {
    $("#ticket_form").submit(function() {
        chat.emit('submit');
        return true;
    });
});
</script>
<script>
//used by searchbox
function parseValue(value) {
    var obj = new Object();
    var tokens = value.split("\t");
    obj.str = tokens[0];
    obj.count = tokens[1];
    return obj;
}

$(function() {
    //bootstrap-2.0.4 stuff
    $(".alert-message").alert();
    $(".dropdown-toggle").dropdown();
    $("span[rel='tooltip']").tooltip();
    $("a[rel=popover]").popover();

    //activate menu that user is currently on
    $("#menu_navigator").addClass("active"); 
    $("#submenu_").addClass("active"); 

    //translate zend validation error message to bootstrap
    $(".errors").addClass("alert").addClass("alert-error");

    //enable autocomplete for search box
    $("#search").autocomplete({
        source: function( request, response ) {
            $.ajax({
                url: "search/autocomplete",
                dataType: "text",
                data: {
                    //featureClass: "P",
                    //style: "full",
                    //maxRows: 12,
                    //name_startsWith: request.term
                    q: request.term
                },
                success: function( data ) {
                    response( $.map( data.split("\n"), function( item ) {
                        if(item == "") return null;
                        return {
                            value: item
                        }
                    }));
                }
            });
        },
        select: function(event, ui) {
            document.location = "search?q="+ui.item.value;
        }
    });
    
});
</script>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-69012-13");
pageTracker._trackPageview();
} catch(err) {}
</script>

</body>
