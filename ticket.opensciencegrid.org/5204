<!DOCTYPE html>
<html lang="en">
  <head>
  <base href="">
    <title>[5204] dcache - srmcp issues - java.IO.Exception and required 4 slashes</title>    <meta charset="utf-8" />
    <meta name="verify-v1" content="na5IcAJsZVOfEkboRxuIiZ1zpZgnZiWra+nKcS7nA/o=" />
    <meta name="google-site-verification" content="DLrk3ft4s8b-S2TloLCL2LD_t6wcTjgSluf5pmiu2kA" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />
    <link href="https://ticket.opensciencegrid.org/rss" rel="alternate" type="application/rss+xml" title="GOC Ticket Update feed" />

    <style type="text/css">
      body {
        padding-top: 50px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
     #search {
            width: 300px;
     }

    </style>

<script src="https://code.jquery.com/jquery-3.0.0.js"></script>
<script src="https://code.jquery.com/jquery-migrate-3.0.1.js"></script>

   <link href="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet"/>
    <script src="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/js/bootstrap.min.js"></script>

    <link href="https://netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"/>
    <link href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/themes/smoothness/jquery-ui.min.css" rel="stylesheet"/>
 <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>


    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/js/select2.min.js"></script>

    <link href="css/ticket.css" rel="stylesheet" />
    <script src="lib/jquery.cookie.js"></script>

    <link href="images/tag_orange.png" rel="icon" type="image/png"/>
    <script src='https://www.google.com/recaptcha/api.js'></script>
  </head>

  <body>
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>

            <a class="brand" style="padding: 6px 0px 0px 6px;" href="http://opensciencegrid.org"><img src="images/osglogo.40x30.png"/></a>
            <ul class="nav">
                <li class="dropdown"><a href="https://ticket.opensciencegrid.org/#" class="dropdown-toggle" data-toggle="dropdown">GOC Ticket <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    <li><a href="https://my.opensciencegrid.org">MyOSG</a></li>
                    <li><a href="https://oim.opensciencegrid.org">OIM</a></li>
                    <li class="active"><a href="https://ticket.opensciencegrid.org/index">Ticket</a></li>
	<li class="divider"></li>
	<li><a href="http://repo.grid.iu.edu">Repo</a></li>
	<li class="divider"></li>
	<li><a href="http://blogs.grid.iu.edu">Blog</a></li>
                    <li><a href="http://display.grid.iu.edu">Display</a></li>
                    <li><a href="http://osggoc.blogspot.com/">News</a></li>
                    </ul>
                </li>
            </ul>
            <ul class="nav pull-right">
                <li><a href="https://ticket.opensciencegrid.org/sso/">Login</a></li>            </ul>

            <div class="nav-collapse">
                <ul class="nav">
			 <li id="menu_submit"><a href="https://ticket.opensciencegrid.org/submit">Submit</a></li><li id="menu_view" class="dropdown"><a href="https://ticket.opensciencegrid.org/\#" class="dropdown-toggle" data-toggle="dropdown">View <b class="caret"></b></a><ul class="dropdown-menu"><li id="submenu_listopen"><a href="https://ticket.opensciencegrid.org/list/open">Open Tickets</a></li><li id="submenu_listrecentclose"><a href="https://ticket.opensciencegrid.org/list/recentclose">Recently Closed Tickets</a></li><li class="divider"></li><li id="submenu_alltickets"><a href="https://ticket.opensciencegrid.org/search?q=&amp;sort=id">All Tickets</a></li></ul></li>                </ul>

                <form class="navbar-search pull-right" action="https://ticket.opensciencegrid.org/viewer">
                    <input id="search" type="text" name="id" class="search-query span2" placeholder="Search Ticket" value=""/>
                </form>
            </div>
        </div>
      </div>
    </div>

<script type='text/javascript' src='lib/jquery.timeago.js'></script>
<script type='text/javascript' src='lib/byte2size.js'></script>
<style>
#updates .toolbar {
position: relative;
margin-top: 0px;
top: -10px;
font-weight: normal;
}
#updates a.anchor {
position: relative;
top: -50px;
}
#updates .selected pre {
animation:selected 2s;
animation-iteration-count: 2;
animation-direction: alternate;
-webkit-animation:selected 2s; 
-webkit-animation-iteration-count: 2;
-webkit-animation-direction: alternate;
box-shadow: inset 1px 1px 20px #9ad;
border: 1px solid #9ab;
margin: 5px 0px;
padding-left: 10px;
}
@keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ab;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
@-webkit-keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ad;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
#updates pre {
background-color: inherit;
line-height: 15px;
padding: 5px;
}
#updates .header {
color: #999;
}
#updates .update_history pre {
background-color: #eee;
color: #666;
font-size: 85%;
}
#updates .clickable {
cursor: pointer;
}
#updates .clickable:hover {
color: #D98719;
}
#updates .meta_information pre {
background-color: #fed;
}
#similar_tickets {
max-height: 300px;
overflow-y: auto;
pointer-events: none;
padding: 5px;
background-color: #f4f4f4;
}
.btn-toolbar {
margin-bottom: 0;
height: 30px;
}
#peers {
position: fixed;
bottom: 0px;
right: 0px;
z-index: 100;
list-style: none;
padding: 5px 0px 0px 5px;
margin: 0px;
background-color: white;
box-shadow: 0px 0px 10px white;
}
#peers li {
background-color: #ccc;
color: #000;
display: inline-block;
padding: 5px 10px;
margin-right: 5px;
position: relative;
}
/*
#peers li:hover {
background-color: #999;
cursor: pointer;
}
*/
#peers span.ip {
padding-left: 5px;
color: #666;
}
#peers .new {
bottom: -30px;
}
/*
#peers .me {
background-color: red;
}
*/
</style>

<div class="container-fluid">
<ul id="peers"></ul>
<div class="alert alert-danger"><a class="close" href="https://ticket.opensciencegrid.org/#" data-dismiss="alert">&times;</a>By the end of May 2018, the ticketing system at https://ticket.opensciencegrid.org will be retired and support will be provided at https://support.opensciencegrid.org. Throughout this transition the support email (help@opensciencegrid.org) will be available as a point of contact.<br><br>                                                   
                                                                                                                                                                                   
Please see the service migration page for details: https://opensciencegrid.github.io/technology/policy/service-migrations-spring-2018/#ticket</div><div id="presence" class="pull-right"></div><div class="ticketgui"><script type="text/javascript" src="lib/checktab.js"></script>

<script>
var expanded = false;
function expand_description() {
    var desc = $(".description");
    if(!expanded) {
        expanded = true;
        //expand to minheight
        var min = 250;
        if(desc.height() < min) {
            desc.animate({height: min}, 200);
        }
    }
}

$(document).ready(function() {
    $("input[name='nad']").datepicker({
        dateFormat: 'yy-mm-dd'
    });
});

</script>



<style>
.form-horizontal .control-label {
padding-top: inherit;
font-size:90%;
color:#666;
}
label {
margin-bottom: 0px;
}
.controls {
line-height: 18px;
}
</style>
<form class="form-horizontal" action="https://ticket.opensciencegrid.org/viewer/updatebasic?id=5204" method="post">
<div class="page-header">
    <h3><span class="muted">5204</span> / dcache - srmcp issues - java.IO.Exception and required 4 slashes</h3>
</div>

<div class="row-fluid">
<div class="span5">
    <legend>Contact</legend>
    <div class="control-group">
        <label class="control-label">Full Name</label>
        <div class="controls">neha sharma</div>
    </div>
    <div class="control-group">
        <label class="control-label">Email</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">Phone</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">CC</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>

    <legend>Details</legend>
    
    <div class="control-group">
        <label class="control-label">Ticket Type</label>
        <div class="controls">Problem/Request</div>
    </div>
    <div class="control-group">
        <label class="control-label">Priority</label>
        <div class="controls">Normal</div>
    </div>
    <div class="control-group">
        <label class="control-label">Status</label>
        <div class="controls">
Closed</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action</label>
        <div class="controls">Neha to update</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action Deadline</label>
        <div class="controls flag_red">2008-08-07</div>
    </div>

</div><!--span-->
<div class="span7">
    <legend>Assignees</legend>
    <div class="assignee" style="width: 60%">Neha Sharma <span class="muted"> / OSG Storage Team</span></div>    <br>

    <legend>Assignees</legend>
    TODO
    <br>

    <style>
legend.noborder {
border-bottom: none;
}
</style>

<div id="attachment-list"/>
<script>
$(function () {
    var first = true;
    $.getJSON("https://ticket.opensciencegrid.org/attachment/list?id=5204", function (files) {
        //console.dir(files);
        var html = "<table class=\"table table-condensed\">";
        $(files).each(function() {
            if(first) {
                first = false;
                html += "<legend class=\"noborder\">Attachmenets</legend>";
            }
            html += "<tr class=\"attachment\">";
            html += "<td><img src="https://ticket.opensciencegrid.org/\&quot;&quot;+this.thumbnail_url+&quot;\&quot;/"></td>";
            html += "<td><a href="https://ticket.opensciencegrid.org/\&quot;&quot;+this.url+&quot;\&quot;" target=\"_blank\">"+this.name+"</a></td>";
            html += "<td>"+bytesToSize(this.size, 1)+"</td>";
            html += "</tr>";
        });
        html += "</table>";
        $("#attachment-list").html(html);
    });
});

function download(url) {
    window.open(url, "_blank");
}
</script>


</div><!--span-->
</div><!--row-fluid-->


</form>

</div>
<div id="updates" style="clear: both;">
    <legend>Past Updates
    <div class="btn-toolbar pull-right toolbar">
        <div class="btn-group">
                <a class="btn btn-small" href="https://ticket.opensciencegrid.org/5204?sort=up&amp;"><i class="icon-arrow-up"></i> Sort</a>

        
        <a class="btn btn-small" href="https://ticket.opensciencegrid.org/5204?expandall=true&amp;">Expand Descriptions</a>        <a class="btn btn-small" target="_blank" href="mailto:osg@tick.globalnoc.iu.edu?subject=Open%20Science%20Grid%3A%20dcache%20-%20srmcp%20issues%20-%20java.IO.Exception%20and%20required%204%20slashes%20ISSUE%3D5204%20PROJ%3D71"><i class="icon-envelope"></i> Update w/Email</a>
        </div>
    </div><!--btn-toolbar-->
    </legend>

    <div class='update_description'><i onclick="document.location='5204#1218045910'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2008-08-06T18:05:10+00:00">Aug 6, 2008 06:05 PM UTC</time> by <b>Neha Sharma</b><a class="anchor" name="1218045910">&nbsp;</a></div><pre>Thanks Alex,

We use GlobusURL(String url) to parse user input (that is we did not
invent out own parsing here). And it follows what you are describing.
That&#39;s why I am reluctant to introduce ad-hoc workarounds.

As for default port - it is coming. Again this is limitation of GlobusURL
class that does not have setPort() method. But I am willing to correct
that.

Dmitry

On Thu, 31 Jul 2008, Alex Sim wrote&#58;

Try globus-url-copy from Java CoG, and it behaves as what Dmitry describes.
RFC 1738 also notes in 3.2 that the &#34;/&#34; between the host (or port) and
the url-path is NOT part of the url-path.

It&#39;s just that java is being strict to follow the scheme than c.
srm-copy (LBNL implementation of srm client) handles 3 slashes, but it&#39;s
for the user&#39;s convenience. nothing more or less.

Beside the slashes, yes, those are inconvenient. The problem is that
sites do not have the same defaults. However, port number and service
handle can be &#34;fixed by default&#34; in the client configuration file for
srmcp or srm-copy. It&#39;s something that site admin or the user can do
locally if spelling out is inconvenient. Users should know that the same
defaults on their site will not apply to other sites though.

-- Alex
asim at lbl dot gov

On 7/31/08 8&#58;34 AM, Charles Waldman wrote&#58;
Dmitry Litvintsev writes&#58;

<div id='show_1823913766' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_1823913766'>if you need to specify absolute path you use 4 slashes&#58;
srmcp srm&#58;//.....         file&#58;////absolute/path/to/the/file/test.data
(cause again first three will be subtracted and
&#34;/absolute/path/to/the/file/test.data&#34; will remain as file path)
So I do not see any deviation from globus-url-copy behaviour. Am I missing
something?

Dmitry&#58;

I believe you are missing something&#58;

This command&#58;  (3 slashes)

$ globus-url-copy <a href='gsiftp&#58;//uct2-dc1.uchicago.edu/pnfs/uchicago.edu/test/cgwtest.001' target='_blank' rel='nofollow'>gsiftp&#58;//uct2-dc1.uchicago.edu/pnfs/uchicago.edu/test/cgwtest.001</a> file&#58;///tmp/junk

works, and the file is written to the absolute path /tmp/junk (*not* to a
subdir of current directory)

This command&#58;  (3 slashes)

$ srmcp <a href='srm&#58;//uct2-dc1.uchicago.edu&#58;8443/pnfs/uchicago.edu/test/cgwtest.001' target='_blank' rel='nofollow'>srm&#58;//uct2-dc1.uchicago.edu&#58;8443/pnfs/uchicago.edu/test/cgwtest.001</a> file&#58;///tmp/junk

results in java io exception.

Try openining urls like file&#58;///tmp and file&#58;//tmp in your favorite
browser, and see what the behavior is.  The behavior of srmcp seems
to be different than any other program I compare it to, and also
does not agree with the URL specification spelled out at
<a href='http&#58;//www.faqs.org/rfcs/rfc1738.html&#58' target='_blank' rel='nofollow'>http&#58;//www.faqs.org/rfcs/rfc1738.html&#58</a>;

A file URL takes the form&#58;

file&#58;//&#60;host&#62;/&#60;path&#62;

where &#60;host&#62; is the fully qualified domain name of the system on
which the &#60;path&#62; is accessible, and &#60;path&#62; is a hierarchical
directory path of the form &#60;directory&#62;/&#60;directory&#62;/.../&#60;name&#62;.

It would be really nice if the srmcp command was as easy to use as the
globus-url-copy.  (e.g. not having to specify ports when the port used
is the default, not having to add extra slashes).  I find that srmcp
is not very user-friendly - for example, if the &#58;8443 port is omitted,
one gets this cryptic message&#58;

illegal source url for multiple sources mode<a href='srm&#58;//uct2-dc1.uchicago.edu/pnfs/uchicago.edu/test/cgwtest.001' target='_blank' rel='nofollow'>srm&#58;//uct2-dc1.uchicago.edu/pnfs/uchicago.edu/test/cgwtest.001</a>

The extra complexities of the URL format, the need to specify port numbers
even for default ports, and the confusing //// behavior are recurring
complaints with this client, and cause a lot of unneeded confusion.

- Charles
</div><script type='text/javascript'>
        $('#show_1823913766').click(function() {
            $('#detail_1823913766').slideDown("normal");
            $('#show_1823913766').hide();
            $('#hide_1823913766').show();
        });
        $('#hide_1823913766').click(function() {
            $('#detail_1823913766').slideUp();
            $('#hide_1823913766').hide();
            $('#show_1823913766').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='5204#1217984382'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2008-08-06T00:59:42+00:00">Aug 6, 2008 12:59 AM UTC</time> by <b>echism</b><a class="anchor" name="1217984382">&nbsp;</a></div><pre>Neha, this has been inactive for nearly a month now. May we close this ticket?

Please advise,
Elizabeth</pre></div><div class='update_description'><i onclick="document.location='5204#1217276349'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2008-07-28T20:19:09+00:00">Jul 28, 2008 08:19 PM UTC</time> by <b>Tim Silvers</b><a class="anchor" name="1217276349">&nbsp;</a></div><pre>Neha, I don&#39;t see much going on here. Do we still need this ticket?

Tim</pre></div><div class='update_description'><i onclick="document.location='5204#1215634144'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2008-07-09T20:09:04+00:00">Jul 9, 2008 08:09 PM UTC</time> by <b>Neha Sharma</b><a class="anchor" name="1215634144">&nbsp;</a></div><pre>I believe that &#34;srmcp ... -retry_num=0 ...&#34; should only attempt one time.
If you cannot specify this option (e.g. srmcp is invoked from within some
code you cannot modify) then modify our srm config.xml file &#58;

&#60;retry_num&#62; 0 &#60;/retry_num&#62;

define environment variable SRM_CONFIG to point to that file.

I will see what we can do with &#34;///&#34;

Thanks,
Dmitry

On Mon, 7 Jul 2008, Marco Mambelli wrote&#58;

Hi Dimitry,
I did the test. The new version solves problem 2.
The file is copied, in some attempts it takes a while but this may be to
the response time of the server.

As for problem 1 (3 and  not 4 &#39;/&#39; in the URL) it would be nice if at
least the program would not loop into multiple attempts.
Even better if it could work with &#39;file&#58;///...&#39; as well.

Thank you,
Marco

On Thu, 3 Jul 2008, Dmitry Litvintsev wrote&#58;

Hi Marco,

here it is &#58;

<a href='https&#58;//srm.fnal.gov/twiki/pub/SrmProject/SrmClient/srm-2-0-8.tgz' target='_blank' rel='nofollow'>https&#58;//srm.fnal.gov/twiki/pub/SrmProject/SrmClient/srm-2-0-8.tgz</a>

<div id='show_1031659101' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_1031659101'>I am not authorised to copy files uct2-dc1.uchicago.edu

Thanks,
Dmitry

On Thu, 3 Jul 2008, Marco Mambelli wrote&#58;

Dmitry,
If you have a tarball installation I can try it,
else you can try the commands that I used in the test&#58;

For issue (2) it is&#58;
srmcp
gsiftp&#58;//uct2-
dc1.uchicago.edu/pnfs/uchicago.edu/data/tier3/user/user.MonicaDunford/user.MonicaDunford.mSugraGrid_25
x25/user.MonicaDunford.mSugraGrid_25x25_m0_180_m12_330_A0_0_tanBeta_10_sgnMu_p_mTop_175_1
2.0.6.3_0_aod.pool.root
file&#58;////ecache/marco/test_dq2-get/test2-fermi-client2.root

Change the destination path to any local directory.
Thank you,
Marco

On Thu, 3 Jul 2008, Dmitry Litvintsev wrote&#58;

latest is &#39;2.0.8&#39; and available from
<a href='http&#58;//www.dcache.org/downloads/1.8.0/index.shtml' target='_blank' rel='nofollow'>http&#58;//www.dcache.org/downloads/1.8.0/index.shtml</a>

but as you say it is problematic to deal with RPMs lets wait
until it is part of VDT.

On Thu, 3 Jul 2008, Marco Mambelli wrote&#58;

Hi ,
I&#39;m using 2.0.3 that is the latest distributed by VDT (OSG-Client 1.0)

srmcp -version
Storage Resource Manager (SRM) implementation version 2.0.3
Copyright (c) 2002-2008 Fermi National Accelerator Laboratory
Specification Version 2.0 by SRM Working Group (<a href='http&#58;//sdm.lbl.gov/srm-wg' target='_blank' rel='nofollow'>http&#58;//sdm.lbl.gov/srm-wg</a>)

Do you have a pacman package?
Can you tell me where to find it?
It would be problematic to install the RPM

Thank you,
Marco

On Thu, 3 Jul 2008, Dmitry Litvintsev wrote&#58;

Hi Marco,

what version of client you have got?
I believe that (2) in your list has been addressed in the most recent
srmclient RPM available from dcache.org.

This problem has to do with running new client against older dCache
servers. We recently caught it and made a fix for backward compatibility.

Will it be possible for you to try latest client and report to us if
things are better?

On Thu, 3 Jul 2008, Marco Mambelli wrote&#58;

Hi all,
DQ2 clients are hanging when using srmcp
DQ2 is the distributed data management in ATLAS and depending on the
placement of source and destination is using different commands to copy
the files

The same copy (between MWT2_UC SE and local directory) works with lcg-cp
and fails with srmcp (hangs).

I esecuted the commands by hand and attached are the results.
Since I was at it I tested also srm-copy (LBNL)&#58; it works

The problems encountered in srmcp are 2&#58;
1. it has problems with URLs like file&#58;///directory/file
I know that it likes the 4th slash, but the path is generated by DQ2. I
could ask DQ2 developers to fix that but all other programs work with 3
slashes, the fix would be to accomodate srmcp (generate a different file
path when using srmcp)
2. after changing the path there is some other fatal exception, the
program keeps looping but the file seems to be copied&#58;
copy failed with the error
java.io.IOException&#58;
at org.globus.ftp.extended.GridFTPInputStream.readMsg(GridFTPInputStream.java&#58;130)

Then the default behavior of srmcp (multiple retry) is at least
problematic when the program is invoked by 3rd parties.
If stdout/err is not printed while the program is executing users have the
impression that the program is hanging.
And it is worthless to retry with some of the errors (e.g. when there are
problems in the path), they will not go away.

Cheers,
Marco
</div><script type='text/javascript'>
        $('#show_1031659101').click(function() {
            $('#detail_1031659101').slideDown("normal");
            $('#show_1031659101').hide();
            $('#hide_1031659101').show();
        });
        $('#hide_1031659101').click(function() {
            $('#detail_1031659101').slideUp();
            $('#hide_1031659101').hide();
            $('#show_1031659101').show();
        });
        </script></pre></div><legend>Similar Recent Tickets <small>modified within the last 30 days</small></legend><div id="similar_tickets"><p class="muted">No similar tickets found.</p></div>
</div>
<script type="text/javascript">
function reset_anchor() {
    $("#updates .selected").removeClass("selected");
    var urls = document.location.toString().split('#'); 
    var anchor = urls[1];
    if(anchor) {
        $("a[name='"+anchor+"']").parents(".update_description").addClass("selected");
    }
}
function submitspam(ticket_id) {
    myret = confirm("Would you like to close this ticket as a security ticket, and submit the ticket content to akismet?");
    if(myret == true) {
        $.ajax("viewer/processspam?id="+ticket_id).done(function() {
            window.location.reload();
        });
    }
}

$(function() {
    reset_anchor();
    var ADDITIONAL_COOKIE_NAME = 'gocticket';
    var options = { path: '/', expires: 365};

    if(window.opener && window.opener.name == "gocticket_list") {
        v = $.cookie("closewindow");
        if(!v) {
            $("#closewindow").attr("checked", "checked"); //on by default
        } else {
            if(v == "checked") {
                $("#closewindow").attr("checked", "checked");
            }
        }
        $("#closewindow").click(function() {
            $.cookie("closewindow", $(this).attr('checked'), options);
        });
    } else {
        $("#closewindow_area").hide();
    }
    function updateTimeago() {
        $("time").timeago();
        setTimeout(updateTimeago, 30*1000);
    }
    updateTimeago();
    $(".description").focus(expand_description);
});
</script>
<hr/>
<footer>
<p>GOC Ticket Version 2.2 | <a href="https://ticket.opensciencegrid.org/goc/submit?app_issue_check=on&amp;app_issue_type=goc&amp;app_goc_url=https%3A%2F%2Fticket.opensciencegrid.org%3A443%2F5204">Report Bugs</a>
 | <a href="https://github.com/opensciencegrid/operations/blob/master/docs/privacy.md">Privacy Policy</a>
</p>

<p> <img align="top" src="images/tag_orange.png"/> Copyright 2018 The Trustees of Indiana University - Developed for Open Science Grid</p>
</footer>


</div><!--container-fluid-->
<script src="https://ticket1.grid.iu.edu:8443/socket.io/socket.io.js"></script>
<script>
var chat = io.connect('https://ticket1.grid.iu.edu:8443');
chat.on('connect', function() {
    chat.emit('authenticate', {nodekey:'', ticketid: 5204});
});
chat.on('peers', function(peers) {
    $("#peers").html("");
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('peer_disconnect', function(pid) {
    $("#peer_"+pid).hide("slow");
});
chat.on('peer_connected', function(peers) {
    //expect only 1 peer connecting, but..
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('submit', function() {
    if(confirm("This ticket was updated. Do you want to refresh?")) {
        history.go(0);
    }
});

function addPeer(pid, peer) {
    var ipinfo = "";
    if(peer.ip != undefined) {
        ipinfo = "<span class=\"ip\">"+peer.ip+"</span>";
    }
    if(chat.io.engine.id == pid) {
        //don't display myself
        return;
    }
    var html = "<li class=\"new\" id=\"peer_"+pid+"\" class=\"peer\">"+peer.name+ipinfo+"</li>";
    $("#peers").prepend(html);
    $("#peers .new").animate({bottom: 0}, 1000, function() {$(this).removeClass("new")});
}

$(function() {
    $("#ticket_form").submit(function() {
        chat.emit('submit');
        return true;
    });
});
</script>
<script>
//used by searchbox
function parseValue(value) {
    var obj = new Object();
    var tokens = value.split("\t");
    obj.str = tokens[0];
    obj.count = tokens[1];
    return obj;
}

$(function() {
    //bootstrap-2.0.4 stuff
    $(".alert-message").alert();
    $(".dropdown-toggle").dropdown();
    $("span[rel='tooltip']").tooltip();
    $("a[rel=popover]").popover();

    //activate menu that user is currently on
    $("#menu_navigator").addClass("active"); 
    $("#submenu_").addClass("active"); 

    //translate zend validation error message to bootstrap
    $(".errors").addClass("alert").addClass("alert-error");

    //enable autocomplete for search box
    $("#search").autocomplete({
        source: function( request, response ) {
            $.ajax({
                url: "search/autocomplete",
                dataType: "text",
                data: {
                    //featureClass: "P",
                    //style: "full",
                    //maxRows: 12,
                    //name_startsWith: request.term
                    q: request.term
                },
                success: function( data ) {
                    response( $.map( data.split("\n"), function( item ) {
                        if(item == "") return null;
                        return {
                            value: item
                        }
                    }));
                }
            });
        },
        select: function(event, ui) {
            document.location = "search?q="+ui.item.value;
        }
    });
    
});
</script>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-69012-13");
pageTracker._trackPageview();
} catch(err) {}
</script>

</body>
