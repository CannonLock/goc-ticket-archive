<!DOCTYPE html>
<html lang="en">
  <head>
  <base href="">
    <title>[6091] dCache - failure when trying to transfer file from dCache to Bestman based SE</title>    <meta charset="utf-8" />
    <meta name="verify-v1" content="na5IcAJsZVOfEkboRxuIiZ1zpZgnZiWra+nKcS7nA/o=" />
    <meta name="google-site-verification" content="DLrk3ft4s8b-S2TloLCL2LD_t6wcTjgSluf5pmiu2kA" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />
    <link href="https://ticket.opensciencegrid.org/rss" rel="alternate" type="application/rss+xml" title="GOC Ticket Update feed" />

    <style type="text/css">
      body {
        padding-top: 50px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
     #search {
            width: 300px;
     }

    </style>

<script src="https://code.jquery.com/jquery-3.0.0.js"></script>
<script src="https://code.jquery.com/jquery-migrate-3.0.1.js"></script>

   <link href="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet"/>
    <script src="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/js/bootstrap.min.js"></script>

    <link href="https://netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"/>
    <link href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/themes/smoothness/jquery-ui.min.css" rel="stylesheet"/>
 <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>


    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/js/select2.min.js"></script>

    <link href="css/ticket.css" rel="stylesheet" />
    <script src="lib/jquery.cookie.js"></script>

    <link href="images/tag_orange.png" rel="icon" type="image/png"/>
  </head>

  <body>
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>

            <a class="brand" style="padding: 6px 0px 0px 6px;" href="http://opensciencegrid.org"><img src="images/osglogo.40x30.png"/></a>
            <ul class="nav">
                <li class="dropdown"><a href="https://ticket.opensciencegrid.org/#" class="dropdown-toggle" data-toggle="dropdown">GOC Ticket <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    <li><a href="https://my.opensciencegrid.org">MyOSG</a></li>
                    <li><a href="https://oim.opensciencegrid.org">OIM</a></li>
                    <li class="active"><a href="https://ticket.opensciencegrid.org/index">Ticket</a></li>
	<li class="divider"></li>
	<li><a href="http://repo.grid.iu.edu">Repo</a></li>
	<li class="divider"></li>
	<li><a href="http://blogs.grid.iu.edu">Blog</a></li>
                    <li><a href="http://display.grid.iu.edu">Display</a></li>
                    <li><a href="http://osggoc.blogspot.com/">News</a></li>
                    </ul>
                </li>
            </ul>
            <ul class="nav pull-right">
                <li><a href="https://ticket.opensciencegrid.org/sso/">Login</a></li>            </ul>

            <div class="nav-collapse">
                <ul class="nav">
			 <li id="menu_submit"><a href="https://ticket.opensciencegrid.org/submit">Submit</a></li><li id="menu_view" class="dropdown"><a href="https://ticket.opensciencegrid.org/\#" class="dropdown-toggle" data-toggle="dropdown">View <b class="caret"></b></a><ul class="dropdown-menu"><li id="submenu_listopen"><a href="https://ticket.opensciencegrid.org/list/open">Open Tickets</a></li><li id="submenu_listrecentclose"><a href="https://ticket.opensciencegrid.org/list/recentclose">Recently Closed Tickets</a></li><li class="divider"></li><li id="submenu_alltickets"><a href="https://ticket.opensciencegrid.org/search?q=&amp;sort=id">All Tickets</a></li></ul></li>                </ul>

                <form class="navbar-search pull-right" action="https://ticket.opensciencegrid.org/viewer">
                    <input id="search" type="text" name="id" class="search-query span2" placeholder="Search Ticket" value=""/>
                </form>
            </div>
        </div>
      </div>
    </div>

<script type='text/javascript' src='lib/jquery.timeago.js'></script>
<script type='text/javascript' src='lib/byte2size.js'></script>
<style>
#updates .toolbar {
position: relative;
margin-top: 0px;
top: -10px;
font-weight: normal;
}
#updates a.anchor {
position: relative;
top: -50px;
}
#updates .selected pre {
animation:selected 2s;
animation-iteration-count: 2;
animation-direction: alternate;
-webkit-animation:selected 2s; 
-webkit-animation-iteration-count: 2;
-webkit-animation-direction: alternate;
box-shadow: inset 1px 1px 20px #9ad;
border: 1px solid #9ab;
margin: 5px 0px;
padding-left: 10px;
}
@keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ab;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
@-webkit-keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ad;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
#updates pre {
background-color: inherit;
line-height: 15px;
padding: 5px;
}
#updates .header {
color: #999;
}
#updates .update_history pre {
background-color: #eee;
color: #666;
font-size: 85%;
}
#updates .clickable {
cursor: pointer;
}
#updates .clickable:hover {
color: #D98719;
}
#updates .meta_information pre {
background-color: #fed;
}
#similar_tickets {
max-height: 300px;
overflow-y: auto;
pointer-events: none;
padding: 5px;
background-color: #f4f4f4;
}
.btn-toolbar {
margin-bottom: 0;
height: 30px;
}
#peers {
position: fixed;
bottom: 0px;
right: 0px;
z-index: 100;
list-style: none;
padding: 5px 0px 0px 5px;
margin: 0px;
background-color: white;
box-shadow: 0px 0px 10px white;
}
#peers li {
background-color: #ccc;
color: #000;
display: inline-block;
padding: 5px 10px;
margin-right: 5px;
position: relative;
}
/*
#peers li:hover {
background-color: #999;
cursor: pointer;
}
*/
#peers span.ip {
padding-left: 5px;
color: #666;
}
#peers .new {
bottom: -30px;
}
/*
#peers .me {
background-color: red;
}
*/
</style>

<div class="container-fluid">
<ul id="peers"></ul>
<div class="alert alert-danger"><a class="close" href="https://ticket.opensciencegrid.org/#" data-dismiss="alert">&times;</a>By the end of May 2018, the ticketing system at https://ticket.opensciencegrid.org will be retired and support will be provided at https://support.opensciencegrid.org. Throughout this transition the support email (help@opensciencegrid.org) will be available as a point of contact.<br><br>                                                   
                                                                                                                                                                                   
Please see the service migration page for details: https://opensciencegrid.github.io/technology/policy/service-migrations-spring-2018/#ticket</div><div id="presence" class="pull-right"></div><div class="ticketgui"><script type="text/javascript" src="lib/checktab.js"></script>

<script>
var expanded = false;
function expand_description() {
    var desc = $(".description");
    if(!expanded) {
        expanded = true;
        //expand to minheight
        var min = 250;
        if(desc.height() < min) {
            desc.animate({height: min}, 200);
        }
    }
}

$(document).ready(function() {
    $("input[name='nad']").datepicker({
        dateFormat: 'yy-mm-dd'
    });
});

</script>



<style>
.form-horizontal .control-label {
padding-top: inherit;
font-size:90%;
color:#666;
}
label {
margin-bottom: 0px;
}
.controls {
line-height: 18px;
}
</style>
<form class="form-horizontal" action="https://ticket.opensciencegrid.org/viewer/updatebasic?id=6091" method="post">
<div class="page-header">
    <h3><span class="muted">6091</span> / dCache - failure when trying to transfer file from dCache to Bestman based SE</h3>
</div>

<div class="row-fluid">
<div class="span5">
    <legend>Contact</legend>
    <div class="control-group">
        <label class="control-label">Full Name</label>
        <div class="controls">neha sharma</div>
    </div>
    <div class="control-group">
        <label class="control-label">Email</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">Phone</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">CC</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>

    <legend>Details</legend>
    
    <div class="control-group">
        <label class="control-label">Ticket Type</label>
        <div class="controls">Problem/Request</div>
    </div>
    <div class="control-group">
        <label class="control-label">Priority</label>
        <div class="controls">Normal</div>
    </div>
    <div class="control-group">
        <label class="control-label">Status</label>
        <div class="controls">
Closed</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action</label>
        <div class="controls"></div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action Deadline</label>
        <div class="controls flag_red">2009-01-29</div>
    </div>

</div><!--span-->
<div class="span7">
    <legend>Assignees</legend>
    <div class="assignee" style="width: 60%">Kyle Gross <span class="muted"> / OSG GOC Support Team</span></div><div class="assignee" style="width: 60%">Neha Sharma <span class="muted"> / OSG Storage Team</span></div>    <br>

    <legend>Assignees</legend>
    TODO
    <br>

    <style>
legend.noborder {
border-bottom: none;
}
</style>

<div id="attachment-list"/>
<script>
$(function () {
    var first = true;
    $.getJSON("attachment/list/6091", function (files) {
        //console.dir(files);
        var html = "<table class=\"table table-condensed\">";
        $(files).each(function() {
            if(first) {
                first = false;
                html += "<legend class=\"noborder\">Attachmenets</legend>";
            }
            html += "<tr class=\"attachment\">";
            html += "<td><img src=\""+this.thumbnail_url+"\"/></td>";
            html += "<td><a href=\""+this.url+"\" target=\"_blank\">"+this.name+"</a></td>";
            html += "<td>"+bytesToSize(this.size, 1)+"</td>";
            html += "</tr>";
        });
        html += "</table>";
        $("#attachment-list").html(html);
    });
});

function download(url) {
    window.open(url, "_blank");
}
</script>


</div><!--span-->
</div><!--row-fluid-->


</form>

</div>
<div id="updates" style="clear: both;">
    <legend>Past Updates
    <div class="btn-toolbar pull-right toolbar">
        <div class="btn-group">
                <a class="btn btn-small" href="https://ticket.opensciencegrid.org/6091?sort=up&amp;"><i class="icon-arrow-up"></i> Sort</a>

        
        <a class="btn btn-small" href="https://ticket.opensciencegrid.org/6091?expandall=true&amp;">Expand Descriptions</a>        <a class="btn btn-small" target="_blank" href="mailto:osg@tick.globalnoc.iu.edu?subject=Open%20Science%20Grid%3A%20dCache%20-%20failure%20when%20trying%20to%20transfer%20file%20from%20dCache%20to%20Bestman%20based%20SE%20ISSUE%3D6091%20PROJ%3D71"><i class="icon-envelope"></i> Update w/Email</a>
        </div>
    </div><!--btn-toolbar-->
    </legend>

    <div class='update_description'><i onclick="document.location='6091#1233073920'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2009-01-27T16:32:00+00:00">Jan 27, 2009 04:32 PM UTC</time> by <b>Ted Hesselroth</b><a class="anchor" name="1233073920">&nbsp;</a></div><pre>Files did eventually transfer. Should add an activity to investigate this kind of
slowdown generically.</pre></div><div class='update_description'><i onclick="document.location='6091#1232657303'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2009-01-22T20:48:23+00:00">Jan 22, 2009 08:48 PM UTC</time> by <b>Kyle Gross</b><a class="anchor" name="1232657303">&nbsp;</a></div><pre>Any updates?</pre></div><div class='update_description'><i onclick="document.location='6091#1231968646'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2009-01-14T21:30:46+00:00">Jan 14, 2009 09:30 PM UTC</time> by <b>Kyle Gross</b><a class="anchor" name="1231968646">&nbsp;</a></div><pre>Adding Ted</pre></div><div class='update_description'><i onclick="document.location='6091#1231509679'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2009-01-09T14:01:19+00:00">Jan 9, 2009 02:01 PM UTC</time> by <b>Kyle Gross</b><a class="anchor" name="1231509679">&nbsp;</a></div><pre>Ted,

Thanks for the update.  In the future, when you work a ticket, if you could please
change the next action date to reflect when you or I need to next look at the ticket
that would be great.  I&#39;m moving the NAD now.</pre></div><div class='update_description'><i onclick="document.location='6091#1231446610'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2009-01-08T20:30:10+00:00">Jan 8, 2009 08:30 PM UTC</time> by <b>Ted Hesselroth</b><a class="anchor" name="1231446610">&nbsp;</a></div><pre>Files did eventually transfer. The user is satisfied with status quo of automatically
retrying failed transfers, but I will leave this ticket open for another week to consider
how the unreliability might be investigated.</pre></div><div class='update_description'><i onclick="document.location='6091#1229706962'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2008-12-19T17:16:02+00:00">Dec 19, 2008 05:16 PM UTC</time> by <b>Kyle Gross</b><a class="anchor" name="1229706962">&nbsp;</a></div><pre>Moving NAD out to New Year.  These tickets and how they are worked, as a whole, will
be discussed with the storage group.</pre></div><div class='update_description'><i onclick="document.location='6091#1228940782'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2008-12-10T20:26:22+00:00">Dec 10, 2008 08:26 PM UTC</time> by <b>Kyle Gross</b><a class="anchor" name="1228940782">&nbsp;</a></div><pre>Are there any updates on this issue?

Please submit problems, requests, and questions at&#58;
<a href='http&#58;//oim.grid.iu.edu/gocticket' target='_blank' rel='nofollow'>http&#58;//oim.grid.iu.edu/gocticket</a>

Thank You,
OSG Grid Operations Center
goc@...., 317-278-9699
Visit the OSG Support Page&#58;
<a href='http&#58;//www.opensciencegrid.org/ops' target='_blank' rel='nofollow'>http&#58;//www.opensciencegrid.org/ops</a>
RSS&#58; <a href='http&#58;//www.grid.iu.edu/news' target='_blank' rel='nofollow'>http&#58;//www.grid.iu.edu/news</a></pre></div><div class='update_description'><i onclick="document.location='6091#1228334543'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2008-12-03T20:02:23+00:00">Dec 3, 2008 08:02 PM UTC</time> by <b>Neha Sharma</b><a class="anchor" name="1228334543">&nbsp;</a></div><pre>Hello again Abhishek,

The FNAL files did copy to UMD on the fifth attempt by PhEDEx over the
course of ~12 hours.  I had similar problems with files from Nebraska,
but they also copied to UMD after ~half a dozen attempts by PhEDEx.
While it appears that third party pushmode is unreliable, repeated
attempts do seem to make it through eventually in most cases.

With this level of unreliability (and I&#39;m told, unscalability), has
any thought been given to making it possible to do third party
transfers from dCache-&#62;BeStMan without pushmode?  I haven&#39;t a clue
what the impact is of what I&#39;m asking, so if this is something that
would be difficult (impossible?), certainly discard the suggestion!

I suspect that the &#39;permanent&#39; problem is confined to UCSD, perhaps to
the node (or nodes) which was having the certificate problems?  PhEDEx
is still stuck on a handful of files hosted at UCSD, but if pushmode
transfers from other sites are any indicator, it may take a while for
the files to arrive.  I will keep an eye on the transfers and if I am
still unable to grab the &#39;obstinant&#39; files from UCSD after PhEDEx has
banged away for a day, I&#39;ll contact the UCSD admins.

Thanks very much for your help!
Malina

On Sun, Nov 30, 2008 at 6&#58;28 PM, Malina Kirn &#60;m.a.kirn@....&#62; wrote&#58;
Hi Abshishek,

The file will still not copy in third party pushmode - I checked both
at UMD and at FNAL.  Other PhEDEx transfers copying from UCSD are
stuck on a few other files, presumably hosted on the same node?

I&#39;ve been able to identify a handful of files hosted at FNAL that
won&#39;t transfer in third party pushmode.  PhEDEx has only been trying
to grab these files for about half a day, so it&#39;s possible (unlikely?)
<div id='show_185903320' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_185903320'>they may come through later.  Here is one such file&#58;

<a href='srm&#58;//cmssrm.fnal.gov&#58;8443/srm/managerv2?SFN=/11/store/mc/Summer08/InclusiveMu5Pt350/AODSIM/IDEAL_V9_AODSIM_v1/0002/FE1B1E5B-AFA1-' target='_blank' rel='nofollow'>srm&#58;//cmssrm.fnal.gov&#58;8443/srm/managerv2?SFN=/11/store/mc/Summer08/InclusiveMu5Pt350/AODSIM/IDEAL_V9_AODSIM_v1/0002/FE1B1E5B-AFA1-</a>
DD11-B676-003048767E5B.root

Malina

On Sun, Nov 30, 2008 at 11&#58;32 AM, Abhishek Singh Rana &#60;rana@....&#62; wrote&#58;
Hi Malina,

The UCSD file, 380F8ED7-19AF-DD11-97DE-0015171F2448.root, was on a node that
had temporary problems with subdirectory /etc/grid-security/certificates. It
should now be fixed. Please give it a retry.

Thanks,
Abhishek

On 11/30/08 5&#58;57 AM, Malina Kirn wrote&#58;

Hello all,

To test the hypothesis that particular files are causing pushmode to
choke, I logged into FNAL&#39;s cmslpc and used their srmcp client to
perform &#34;srmcp srm&#58;//UCSD srm&#58;//FNAL&#34; transfers.  My tests confirm
that something special about these files prevents them from
transferring in third party push mode.  I believe this also confirms I
don&#39;t have a problem with my site settings at UMD (at least, not a
unique problem), although there may be a problem with the tags I&#39;m
passing to srmcp.  Please correct me if these are not wholly valid
conclusions!

Here are the transfers which worked&#58;

- Pushmode transfer to FNAL of file which UMD was also able to receive
in pushmode&#58;
srmcp -2 -pushmode -debug

&#34;<a href='srm&#58;//srm-3.t2.ucsd.edu&#58;8443/srm/managerv2?SFN=/pnfs/t2.ucsd.edu/data3/cms/phedex/store/mc/Summer08/TTJets-' target='_blank' rel='nofollow'>srm&#58;//srm-3.t2.ucsd.edu&#58;8443/srm/managerv2?SFN=/pnfs/t2.ucsd.edu/data3/cms/phedex/store/mc/Summer08/TTJets-</a>
madgraph/AODSIM/IDEAL_V9_AODSIM_v1/0004/A838D18E-49AF-DD11-9C47-00161725E512.root&#34;

&#34;<a href='srm&#58;//cmssrm.fnal.gov&#58;8443/srm/managerv2?SFN=/resilient/kirn/A838D18E-49AF-DD11-9C47-' target='_blank' rel='nofollow'>srm&#58;//cmssrm.fnal.gov&#58;8443/srm/managerv2?SFN=/resilient/kirn/A838D18E-49AF-DD11-9C47-</a>
00161725E512.root&#34;

- Non pushmode transfer to FNAL of file which gave UMD problems in
pushmode (and can&#39;t be tested at UMD without pushmode, due to
dCache-&#62;BeStMan requiring pushmode)&#58;
srmcp -2 -debug

&#34;<a href='srm&#58;//srm-3.t2.ucsd.edu&#58;8443/srm/managerv2?SFN=/pnfs/t2.ucsd.edu/data3/cms/phedex/store/mc/Summer08/TTJets-' target='_blank' rel='nofollow'>srm&#58;//srm-3.t2.ucsd.edu&#58;8443/srm/managerv2?SFN=/pnfs/t2.ucsd.edu/data3/cms/phedex/store/mc/Summer08/TTJets-</a>
madgraph/AODSIM/IDEAL_V9_AODSIM_v1/0004/380F8ED7-19AF-DD11-97DE-0015171F2448.root&#34;

&#34;<a href='srm&#58;//cmssrm.fnal.gov&#58;8443/srm/managerv2?SFN=/resilient/kirn/notPushmode.root&#34' target='_blank' rel='nofollow'>srm&#58;//cmssrm.fnal.gov&#58;8443/srm/managerv2?SFN=/resilient/kirn/notPushmode.root&#34</a>;

Here are the transfers which didn&#39;t&#58;

- Pushmode transfer to FNAL of file which gave UMD problems in pushmode&#58;
srmcp -2 -pushmode -debug

&#34;<a href='srm&#58;//srm-3.t2.ucsd.edu&#58;8443/srm/managerv2?SFN=/pnfs/t2.ucsd.edu/data3/cms/phedex/store/mc/Summer08/TTJets-' target='_blank' rel='nofollow'>srm&#58;//srm-3.t2.ucsd.edu&#58;8443/srm/managerv2?SFN=/pnfs/t2.ucsd.edu/data3/cms/phedex/store/mc/Summer08/TTJets-</a>
madgraph/AODSIM/IDEAL_V9_AODSIM_v1/0004/380F8ED7-19AF-DD11-97DE-0015171F2448.root&#34;

&#34;<a href='srm&#58;//cmssrm.fnal.gov&#58;8443/srm/managerv2?SFN=/resilient/kirn/pushmode.root&#34' target='_blank' rel='nofollow'>srm&#58;//cmssrm.fnal.gov&#58;8443/srm/managerv2?SFN=/resilient/kirn/pushmode.root&#34</a>;

- Pushmode transfer to FNAL of file which gave UMD problems in
pushmode, setting globus ports&#58;
srmcp -2 -debug -pushmode -globus_tcp_port_range=20000&#58;25000

&#34;<a href='srm&#58;//srm-3.t2.ucsd.edu&#58;8443/srm/managerv2?SFN=/pnfs/t2.ucsd.edu/data3/cms/phedex/store/mc/Summer08/TTJets-' target='_blank' rel='nofollow'>srm&#58;//srm-3.t2.ucsd.edu&#58;8443/srm/managerv2?SFN=/pnfs/t2.ucsd.edu/data3/cms/phedex/store/mc/Summer08/TTJets-</a>
madgraph/AODSIM/IDEAL_V9_AODSIM_v1/0004/380F8ED7-19AF-DD11-97DE-0015171F2448.root&#34;

&#34;<a href='srm&#58;//cmssrm.fnal.gov&#58;8443/srm/managerv2?SFN=/resilient/kirn/pushmodeWithPorts.root&#34' target='_blank' rel='nofollow'>srm&#58;//cmssrm.fnal.gov&#58;8443/srm/managerv2?SFN=/resilient/kirn/pushmodeWithPorts.root&#34</a>;

I wanted to reconfirm that this is not just a UCSD problem, but the
file at FNAL which had been giving me trouble in pushmode is no longer
doing so (another clue?).  I&#39;ve initiated some PhEDEx transfers which
will stage from a site other than UCSD and will email again if I&#39;ve
identified another stubborn file located at another site.

I suspect this issue has not been caught before because most sites
don&#39;t use pushmode and because this occurs for only a small fraction
of files.  It may also be recent - perhaps it&#39;s an OSG 1.0 gridftp
problem, or a recent dCache release problem?  Or, perhaps I&#39;m missing
some necessary tags for srmcp pushmode calls to dCache sites, which
are only needed in rare cases?

Malina
Hi Alan,

Well, if the conclusions in my last email are correct, then it&#39;s
probably not an issue with the settings on my side?  Or at least not
an issue unique to UMD?

I do not set those environment variables in my vdt-local-setup.(c)sh.
I wasn&#39;t aware that they needed setting?  In light of my last email,
do you still think it appropriate for me to try?

Thanks!
Malina

On Sat, Nov 29, 2008 at 11&#58;30 PM, Alan Sill &#60;Alan.Sill@....&#62; wrote&#58;
Have both sides set their GLOBUS_TCP_PORT_RANGE and GLOBUS_TCP_SOURCE_RANGE
variables properly in their $VDT_LOCATION/vdt/etc/vdt-local-setup.(c)sh
files before starting their gridftp servers?

Alan

On Nov 27, 2008, at 9&#58;40 AM, Brian Bockelman wrote&#58;

Hey Abhishek,

Malina had the same error in ticket #5232, which she solved by adding
the following command line option&#58;

-globus_tcp_port_range=20000&#58;25000

i.e.,

srmcp -2 -debug=TRUE -pushmode=true -globus_tcp_port_range=20000&#58;25000
&#34;<a href='srm&#58;//cmssrm.fnal.gov&#58;8443/srm/managerv2?SFN=/resilient/kirn/junk.txt&#34' target='_blank' rel='nofollow'>srm&#58;//cmssrm.fnal.gov&#58;8443/srm/managerv2?SFN=/resilient/kirn/junk.txt&#34</a>;
&#34;<a href='srm&#58;//hepcms-0.umd.edu&#58;8443/srm/v2/server?SFN=/data/se/store/test-' target='_blank' rel='nofollow'>srm&#58;//hepcms-0.umd.edu&#58;8443/srm/v2/server?SFN=/data/se/store/test-</a>
paul.txt4&#34;

Did we try this here?

Brian

On Nov 27, 2008, at 1&#58;58 AM, Abhishek Singh Rana wrote&#58;

Hi Alex, Malina - thanks for the comprehensive ongoing diagnosis.

Hi Ted, Tanya, (Timur), (Brian) - when convenient, can you please
confirm (using more dCache sites and 3rd party push-mode) if GFTP
implementation in dCache indeed works with GFTP in Globus-2.x/4.x?
Can this be related to delegation, or ... ?

Abhishek

On 11/26/08 6&#58;35 PM, Alex Sim wrote&#58;

some success and some not...

I was able to produce an error betweeen UCSD gsiftp server and LBNL
gsiftp server with 3rd party transfers, whereas I was able to
successfully transfer between UMD globus gsiftp server and LBNL.   it
seems that the gsiftp server in UCSD dCache behaves currently
somewhat
differently (?)  from other gsiftp servers in dCache, especially when
3rd party transfer is requested with globus gsiftp servers.   (I had
srmcp to get the following TURL at dCache)

I had LBNL srm-copy from UCSD dCache on srm-3.t2.ucsd.edu to LBNL
bestman on sim.lbl.gov by pushing from UCSD, and it was successful.
I also had LBNL srm-copy from UCSD dCache on srm-3.t2.ucsd.edu to UMD
bestman on hepcms-0.unl.edu by pushing from UCSD, and it was a
success
just now.

srm-copy
<a href='srm&#58;//srm-3.t2.ucsd.edu&#58;8443/srm/managerv2&#92' target='_blank' rel='nofollow'>srm&#58;//srm-3.t2.ucsd.edu&#58;8443/srm/managerv2&#92</a>;?SFN=/pnfs/t2.ucsd.edu/
data4/berkeley-srm/sc08.data/sc08.dat
<a href='srm&#58;//hepcms-0.umd.edu&#58;8443/srm/v2/server&#92' target='_blank' rel='nofollow'>srm&#58;//hepcms-0.umd.edu&#58;8443/srm/v2/server&#92</a>;?SFN=/tmp/asim.test -debug
-pushmode
....
SRM-CLIENT*REQUESTTYPE=copy
SRM-CLIENT*TOTALFILES=1
SRM-CLIENT*TOTAL_SUCCESS=1
SRM-CLIENT*TOTAL_FAILED=0
SRM-CLIENT*REQUEST_TOKEN=-2144614489
SRM-CLIENT*REQUEST_STATUS=SRM_SUCCESS
SRM-CLIENT*REQUEST_EXPLANATION= at Wed Nov 26 18&#58;18&#58;32 PST 2008 state
Done &#58; all files requests have completed
SRM-CLIENT*SOURCEURL[0]=<a href='srm&#58;//srm-3.t2.ucsd.edu&#58;8443/srm/managerv2?SFN=/pnfs/t2.ucsd.edu/data4/berkeley-srm/sc08.data/sc08.dat' target='_blank' rel='nofollow'>srm&#58;//srm-3.t2.ucsd.edu&#58;8443/srm/managerv2?SFN=/pnfs/t2.ucsd.edu/data4/berkeley-srm/sc08.data/sc08.dat</a>
SRM-CLIENT*TARGETURL[0]=<a href='srm&#58;//hepcms-0.umd.edu&#58;8443/srm/v2/server?SFN=/tmp/asim.test' target='_blank' rel='nofollow'>srm&#58;//hepcms-0.umd.edu&#58;8443/srm/v2/server?SFN=/tmp/asim.test</a>
SRM-CLIENT*ACTUALSIZE[0]=80
SRM-CLIENT*FILE_STATUS[0]=SRM_SUCCESS

I also had FNAL srmcp from UCSD dCache on srm-3.t2.ucsd.edu to UMD
bestman on hepcms-0.unl.edu by pushing from UCSD, and it was a
success
just now.

srmcp
<a href='srm&#58;//srm-3.t2.ucsd.edu&#58;8443/srm/managerv2&#92' target='_blank' rel='nofollow'>srm&#58;//srm-3.t2.ucsd.edu&#58;8443/srm/managerv2&#92</a>;?SFN=/pnfs/t2.ucsd.edu/
data4/berkeley-srm/sc08.data/sc08.dat
<a href='srm&#58;//hepcms-0.umd.edu&#58;8443/srm/v2/server&#92' target='_blank' rel='nofollow'>srm&#58;//hepcms-0.umd.edu&#58;8443/srm/v2/server&#92</a>;?SFN=/tmp/asim.test
-debug=true -2 -pushmode=true
...
SRMClientV2 &#58; connecting to srm at
httpg&#58;//srm-3.t2.ucsd.edu&#58;8443/srm/managerv2
SRMClientV2 &#58;  srmCopy, contacting service
httpg&#58;//srm-3.t2.ucsd.edu&#58;8443/srm/managerv2
Wed Nov 26 18&#58;25&#58;50 PST 2008&#58;  srm returned requestToken =
-2144614465
Wed Nov 26 18&#58;25&#58;50 PST 2008&#58; sleeping 5 seconds ...
...
Wed Nov 26 18&#58;26&#58;53 PST 2008&#58; sleeping 5 seconds ...
Wed Nov 26 18&#58;26&#58;58 PST 2008&#58;  copying of
<a href='srm&#58;//srm-3.t2.ucsd.edu&#58;8443/srm/managerv2?SFN=/pnfs/t2.ucsd.edu/' target='_blank' rel='nofollow'>srm&#58;//srm-3.t2.ucsd.edu&#58;8443/srm/managerv2?SFN=/pnfs/t2.ucsd.edu/</a>
data4/berkeley-srm/sc08.data/sc08.dat
to <a href='srm&#58;//hepcms-0.umd.edu&#58;8443/srm/v2/server?SFN=/tmp/asim.test' target='_blank' rel='nofollow'>srm&#58;//hepcms-0.umd.edu&#58;8443/srm/v2/server?SFN=/tmp/asim.test</a>
succeeded
Wed Nov 26 18&#58;26&#58;58 PST 2008&#58; no more pending transfers, breaking
the loop

My srmcp version is somewhat old though which we have from glite pkg
(Storage Resource Manager (SRM) CP Client version 2.0).  anyway, in
these cases, dCache SRM probably makes gsiftp server from local
file to
the remote gsiftp server.

I&#39;m not sure why there was this &#34;Unknown CA&#34; before, but it could
be a
temporary insanity in local UCSD/FNAL CRL, VO/GUMS or certificate
repository...

However, anyone at UCSD can take a look at what&#39;s going on with
gsiftp
server for the 3rd party transfers?  maybe 3rd party gsiftp
transfer is
not supported?

% globus-url-copy -dbg
<a href='gsiftp&#58;//cabinet-4-4-8.t2.ucsd.edu&#58;2811///sc08.data/sc08.dat' target='_blank' rel='nofollow'>gsiftp&#58;//cabinet-4-4-8.t2.ucsd.edu&#58;2811///sc08.data/sc08.dat</a>
<a href='gsiftp&#58;//dm.lbl.gov//tmp/ucsd.data' target='_blank' rel='nofollow'>gsiftp&#58;//dm.lbl.gov//tmp/ucsd.data</a>
debug&#58; starting to size
<a href='gsiftp&#58;//cabinet-4-4-8.t2.ucsd.edu&#58;2811///sc08.data/sc08.dat' target='_blank' rel='nofollow'>gsiftp&#58;//cabinet-4-4-8.t2.ucsd.edu&#58;2811///sc08.data/sc08.dat</a>
debug&#58; connecting to
<a href='gsiftp&#58;//cabinet-4-4-8.t2.ucsd.edu&#58;2811///sc08.data/sc08.dat' target='_blank' rel='nofollow'>gsiftp&#58;//cabinet-4-4-8.t2.ucsd.edu&#58;2811///sc08.data/sc08.dat</a>
debug&#58; response from
<a href='gsiftp&#58;//cabinet-4-4-8.t2.ucsd.edu&#58;2811///sc08.data/sc08.dat&#58' target='_blank' rel='nofollow'>gsiftp&#58;//cabinet-4-4-8.t2.ucsd.edu&#58;2811///sc08.data/sc08.dat&#58</a>;
220 GSI FTP door ready

debug&#58; authenticating with
<a href='gsiftp&#58;//cabinet-4-4-8.t2.ucsd.edu&#58;2811///sc08.data/sc08.dat' target='_blank' rel='nofollow'>gsiftp&#58;//cabinet-4-4-8.t2.ucsd.edu&#58;2811///sc08.data/sc08.dat</a>
debug&#58; response from
<a href='gsiftp&#58;//cabinet-4-4-8.t2.ucsd.edu&#58;2811///sc08.data/sc08.dat&#58' target='_blank' rel='nofollow'>gsiftp&#58;//cabinet-4-4-8.t2.ucsd.edu&#58;2811///sc08.data/sc08.dat&#58</a>;
200 PASS command successful

debug&#58; sending command&#58;
SITE HELP

debug&#58; response from
<a href='gsiftp&#58;//cabinet-4-4-8.t2.ucsd.edu&#58;2811///sc08.data/sc08.dat&#58' target='_blank' rel='nofollow'>gsiftp&#58;//cabinet-4-4-8.t2.ucsd.edu&#58;2811///sc08.data/sc08.dat&#58</a>;
500 Unknown SITE command

debug&#58; sending command&#58;
FEAT

debug&#58; response from
<a href='gsiftp&#58;//cabinet-4-4-8.t2.ucsd.edu&#58;2811///sc08.data/sc08.dat&#58' target='_blank' rel='nofollow'>gsiftp&#58;//cabinet-4-4-8.t2.ucsd.edu&#58;2811///sc08.data/sc08.dat&#58</a>;
211-OK
EOF
PARALLEL
SIZE
SBUF
ERET
ESTO
GETPUT
CKSUM ADLER32,MD5,MD4
MODEX
211 End

debug&#58; sending command&#58;
TYPE I
debug&#58; response from
<a href='gsiftp&#58;//cabinet-4-4-8.t2.ucsd.edu&#58;2811///sc08.data/sc08.dat&#58' target='_blank' rel='nofollow'>gsiftp&#58;//cabinet-4-4-8.t2.ucsd.edu&#58;2811///sc08.data/sc08.dat&#58</a>;
200 Type set to I

debug&#58; sending command&#58;
SIZE ///sc08.data/sc08.dat

debug&#58; response from
<a href='gsiftp&#58;//cabinet-4-4-8.t2.ucsd.edu&#58;2811///sc08.data/sc08.dat&#58' target='_blank' rel='nofollow'>gsiftp&#58;//cabinet-4-4-8.t2.ucsd.edu&#58;2811///sc08.data/sc08.dat&#58</a>;
213 80

debug&#58; operation complete
debug&#58; starting to transfer
<a href='gsiftp&#58;//cabinet-4-4-8.t2.ucsd.edu&#58;2811///sc08.data/sc08.dat' target='_blank' rel='nofollow'>gsiftp&#58;//cabinet-4-4-8.t2.ucsd.edu&#58;2811///sc08.data/sc08.dat</a> to
<a href='gsiftp&#58;//dm.lbl.gov//tmp/ucsd.data' target='_blank' rel='nofollow'>gsiftp&#58;//dm.lbl.gov//tmp/ucsd.data</a>
debug&#58; connecting to <a href='gsiftp&#58;//dm.lbl.gov//tmp/ucsd.data' target='_blank' rel='nofollow'>gsiftp&#58;//dm.lbl.gov//tmp/ucsd.data</a>
debug&#58; response from <a href='gsiftp&#58;//dm.lbl.gov//tmp/ucsd.data&#58' target='_blank' rel='nofollow'>gsiftp&#58;//dm.lbl.gov//tmp/ucsd.data&#58</a>;
220 dm.lbl.gov GridFTP Server 2.3 (gcc32dbg, 1144436882-63) ready.

debug&#58; authenticating with <a href='gsiftp&#58;//dm.lbl.gov//tmp/ucsd.data' target='_blank' rel='nofollow'>gsiftp&#58;//dm.lbl.gov//tmp/ucsd.data</a>
debug&#58; response from <a href='gsiftp&#58;//dm.lbl.gov//tmp/ucsd.data&#58' target='_blank' rel='nofollow'>gsiftp&#58;//dm.lbl.gov//tmp/ucsd.data&#58</a>;
230 User asim logged in.

debug&#58; sending command&#58;
SITE HELP

debug&#58; response from <a href='gsiftp&#58;//dm.lbl.gov//tmp/ucsd.data&#58' target='_blank' rel='nofollow'>gsiftp&#58;//dm.lbl.gov//tmp/ucsd.data&#58</a>;
214-The following commands are recognized&#58;
ALLO    ESTO    RNTO    APPE    DCAU    MODE    SIZE    STRU
TYPE    DELE    SITE    CWD     ERET    FEAT    LIST    NLST
MLSD    MLST    PORT    PROT    EPRT    PWD     QUIT    REST
STAT    SYST    MKD     RMD     CDUP    HELP    NOOP    EPSV
PASV    TREV    SBUF    MDTM    CKSM    OPTS    PASS    SPAS
PBSZ    SPOR    RETR    STOR    USER    RNFR    LANG
214 End

debug&#58; sending command&#58;
FEAT

debug&#58; response from <a href='gsiftp&#58;//dm.lbl.gov//tmp/ucsd.data&#58' target='_blank' rel='nofollow'>gsiftp&#58;//dm.lbl.gov//tmp/ucsd.data&#58</a>;
211-Extensions supported
UTF8
LANG EN
DCAU
PARALLEL
SIZE
MLST
Type
*;Size
*;Modify
*;Perm
*;Charset;UNIX.mode*;UNIX.owner*;UNIX.group*;Unique*;UNIX.slink*;
ERET
ESTO
SPAS
SPOR
REST STREAM
MDTM
211 End.

debug&#58; sending command&#58;
TYPE I
debug&#58; response from <a href='gsiftp&#58;//dm.lbl.gov//tmp/ucsd.data&#58' target='_blank' rel='nofollow'>gsiftp&#58;//dm.lbl.gov//tmp/ucsd.data&#58</a>;
200 Type set to I.

debug&#58; sending command&#58;
PBSZ 1048576

debug&#58; response from <a href='gsiftp&#58;//dm.lbl.gov//tmp/ucsd.data&#58' target='_blank' rel='nofollow'>gsiftp&#58;//dm.lbl.gov//tmp/ucsd.data&#58</a>;
200 PBSZ=1048576

debug&#58; sending command&#58;
PASV

debug&#58; response from <a href='gsiftp&#58;//dm.lbl.gov//tmp/ucsd.data&#58' target='_blank' rel='nofollow'>gsiftp&#58;//dm.lbl.gov//tmp/ucsd.data&#58</a>;
227 Entering Passive Mode (128,3,30,104,24,57)

debug&#58; sending command&#58;
ALLO 80

debug&#58; response from <a href='gsiftp&#58;//dm.lbl.gov//tmp/ucsd.data&#58' target='_blank' rel='nofollow'>gsiftp&#58;//dm.lbl.gov//tmp/ucsd.data&#58</a>;
200 ALLO command successful.

debug&#58; sending command&#58;
STOR //tmp/ucsd.data

debug&#58; sending command&#58;
PORT 128,3,30,104,24,57

debug&#58; response from
<a href='gsiftp&#58;//cabinet-4-4-8.t2.ucsd.edu&#58;2811///sc08.data/sc08.dat&#58' target='_blank' rel='nofollow'>gsiftp&#58;//cabinet-4-4-8.t2.ucsd.edu&#58;2811///sc08.data/sc08.dat&#58</a>;
200 PORT command successful

debug&#58; sending command&#58;
RETR ///sc08.data/sc08.dat

debug&#58; response from
<a href='gsiftp&#58;//cabinet-4-4-8.t2.ucsd.edu&#58;2811///sc08.data/sc08.dat&#58' target='_blank' rel='nofollow'>gsiftp&#58;//cabinet-4-4-8.t2.ucsd.edu&#58;2811///sc08.data/sc08.dat&#58</a>;
150 Opening BINARY data connection for
/pnfs/t2.ucsd.edu/data4/berkeley-srm/sc08.data/sc08.dat

debug&#58; response from <a href='gsiftp&#58;//dm.lbl.gov//tmp/ucsd.data&#58' target='_blank' rel='nofollow'>gsiftp&#58;//dm.lbl.gov//tmp/ucsd.data&#58</a>;
500 Command failed. &#58; globus_xio_gsi&#58; Token size exceeds limit.
Usually
happens when someone tries to establish a insecure connection with a
secure endpoint, e.g. when someone sends plain HTTP to a HTTPS
endpoint
without first establishing a SSL session.

debug&#58; fault on connection to <a href='gsiftp&#58;//dm.lbl.gov//tmp/ucsd.data&#58' target='_blank' rel='nofollow'>gsiftp&#58;//dm.lbl.gov//tmp/ucsd.data&#58</a>;
globus_ftp_client&#58; the server responded with an error
debug&#58; operation complete

error&#58; globus_ftp_client&#58; the server responded with an error
500 Command failed. &#58; globus_xio_gsi&#58; Token size exceeds limit.
Usually
happens when someone tries to establish a insecure connection with a
secure endpoint, e.g. when someone sends plain HTTP to a HTTPS
endpoint
without first establishing a SSL session.

-- Alex
asim at lbl dot gov

On 11/26/08 2&#58;51 PM, Malina Kirn wrote&#58;

Well, my site does almost constantly fail the RSV
&#34;org.osg.certificates.crl-expiry&#34; probe.  I&#39;d been told this
wasn&#39;t my
fault?  I use Grid3 authorization mode (grid mapfile) and, as you&#39;ve
pointed out privately, some services have all upper or all lower
case
for my site name.  Switching everything to lower case would be
enormously difficult - would require complete cluster reinstall.  I
blame my noobliness when I first started (am I allowed to still call
myself a nooblet?).

If this turns out to not be solvable, I do have a workaround.
Unfortunately I can&#39;t tell PhEDEx to just use file&#58;//, because I
then
won&#39;t be registered in our bookkeeping service as hosting the data
as
a true SE.  However, I can write a script which parses the PhEDEx
log
looking for transfers that failed multiple times using &#34;srmcp
srm&#58;//... srm&#58;//...&#34; and just call the equivalent &#34;srmcp srm&#58;//...
file&#58;//...&#34;  The way I have PhEDEx set up right now, it will believe
that it was the service which pulled off the transfer successfully
and
will be happy.  I&#39;ve been doing this manually to finish up some of
my
critical PhEDEx transfers.  Yucky, but doable.

Malina

On Wed, Nov 26, 2008 at 5&#58;19 PM, Alex Sim &#60;asim@....&#62; wrote&#58;

That bestman log shows that request has been handled and TURL was
returned, but no bytes have been transferred during the TURL pin
lifetime, and have closed the TURL.  So, it should be something
to do
with the gsiftp file transfer and &#34;Unknown CA&#34; somehow. It seems
that
the dCache SRM server as the source pushing the file out to UMD got
somehow &#34;unknown CA&#34; at the GSI handshake.

-- Alex
asim at lbl dot gov

On 11/26/08 2&#58;08 PM, Malina Kirn wrote&#58;

I agree that error is fishy.  But it&#39;s odd that it would only
give it
for some files, but not other files located in the same
directory at
the same site, copied at nearly the same time.  It also only
sprouts
up after what feels like a million retries - so I suspect it&#39;s a
red
herring, some sort of &#34;sorry, you&#39;ve tried too many times or for
too
long&#34; error.

Checking my gridftp logs doesn&#39;t show successful or failed
attempts
around that time (9&#58;15 EST) or at any time with the file name.
There
are quite a lot of BeStMan log entries but here is the entry
where it
looks like it&#39;s given up&#58;

2008.11.26-09&#58;07&#58;46EST 2008.11.26-14&#58;07&#58;46GMT Ex
gov.lbl.srm.server.TSRMRequestPut.file-
failed,rid=uscms01&#58;736(PUT)1,
tgt=<a href='srm&#58;//hepcms-0.umd.edu&#58;8443/srm/v2/' target='_blank' rel='nofollow'>srm&#58;//hepcms-0.umd.edu&#58;8443/srm/v2/</a>
server?SFN=/data/se/store/mc/Summer08/TTJets-madgraph/AODSIM/
IDEAL_V9_AODSIM_v1/0004/380F8ED7-19AF-DD11-97DE-0015171F2448.root
pinDur=1800000 timed out!
gov
.lbl
.srm
.storage
.TSRMPhysicalLocation
.waitOnUserToPutFile(TSRMPhysicalLocation.java&#58;275)
gov
.lbl
.srm
.storage
.TSRMPhysicalLocation
.receiveWhenStagingFileIsNull(TSRMPhysicalLocation.java&#58;202)
gov
.lbl
.srm
.storage.TSRMPhysicalLocation.receive(TSRMPhysicalLocation.java&#58;
254)
gov.lbl.srm.server.TSRMLocalFile.receive(TSRMLocalFile.java&#58;1110)
gov.lbl.srm.server.TSRMSourceFile.receive(TSRMSourceFile.java&#58;155)
gov.lbl.srm.server.TSRMRequestPut.runMe(TSRMRequestPut.java&#58;543)
gov.lbl.srm.server.TSRMRequest.run(TSRMRequest.java&#58;237)
EDU.oswego.cs.dl.util.concurrent.PooledExecutor
$Worker.run(Unknown Source)
java.lang.Thread.run(Thread.java&#58;595)

2008.11.26-09&#58;07&#58;46EST 2008.11.26-14&#58;07&#58;46GMT I
gov.lbl.srm.server.TSRMRequestPut.setStatus&#58; SRM_FAILURE
rid=uscms01&#58;736(PUT)1, tgt=<a href='srm&#58;//hepcms-0.umd.edu&#58;8' target='_blank' rel='nofollow'>srm&#58;//hepcms-0.umd.edu&#58;8</a>
443/srm/v2/server?SFN=/data/se/store/mc/Summer08/TTJets-madgraph/
AODSIM/IDEAL_V9_AODSIM_v1/0004/380F8ED7-19AF-
DD11-97DE-0015171F2448.root
pinDur=1800000 exp=
timed out! Thread-1155

Malina

On Wed, Nov 26, 2008 at 4&#58;02 PM, Alex Sim &#60;asim@....&#62; wrote&#58;

It seems that the problem has something to do with unknown CA?

CacheException(rc=666;msg=tranfer failed &#58;Unexpected Exception &#58;
org.globus.common.ChainedIOException&#58; Authentication failed
[Caused
by&#58; Failure unspecified at GSS-API level [Caused by&#58; Unknown
CA]])]

I&#39;m not sure if this authentication is within the dCache or
with gsiftp
file transfer. It might be good to check the transfer server at
UMD for
certificates or CRLs.

Malina, can you check the gsiftp server log to see if there are
any
failed attempts around this time &#34;Wed Nov 26 06&#58;15&#58;50 PST 2008&#34; ?
Also, would you check to see if there are any corresponding
bestman
server side log to see if there are any matching
&#34;srmPrepareToPut&#34;
request and its results?
Because srmCopy operation happens within the SRM server, it&#39;s
hard to
find out what&#39;s going on from the user side. Have you thought
about
using 3rd party transfers with later srmcp?

-- Alex
asim at lbl dot gov

On 11/26/08 8&#58;49 AM, Malina Kirn wrote&#58;

Additionally, I&#39;ve attempted with the LBNL client (srm-copy -
pushmode)
and it, too, cannot retrieve these obstinant files (though it
can
retrieve others in the same directory).  -accesslatency online
or
nearline has no effect either.  As for the FNAL client, the file
copies with no issue when calling &#34;srm-copy srm&#58;//...
file&#58;//...&#34;, so
I don&#39;t believe this is an srm-client issue.

Thanks for any advice you can provide and please let me know
if I can
give any more details.

Malina

On Wed, Nov 26, 2008 at 10&#58;04 AM, Malina Kirn &#60;m.a.kirn@....

wrote&#58;

Hello,

Some files at two dCache sites, FNAL &amp; UCSD, simply won&#39;t
transfer to
my SE (BeStMan) in third party mode.  My file transfer service
(PhEDEx) bangs away with srmcp calls day after day, but the
files
never arrive.  srmcp waits repeatedly then finally gives up
(error at
the end).  The problem only occurs in third party transfers -
calling
&#34;srmcp srm&#58;//... file&#58;//...&#34; brings the file to my site.  I
have asked
the UCSD SE admins to have a look at some of these files to
see if
there&#39;s something special about them.  Here are the special
features
of my calls&#58;

- I am not sure which version of the FNAL srm client I am
using.  It
was installed by OSG 1.0 - can someone tell me how to find
out the
version information?  I tried with an older client,
1.8.0-15p8, but it
didn&#39;t help.
- My site is running OSG 1.0 with the gridftp server provided
by the
OSG CE and BeStMan 2.2.0.11.  Can someone tell me how to find
out the
version information for gsiftp?
- I am using the tags -2, -access_latency=ONLINE, and -
pushmode=TRUE.
--- access_latency=ONLINE is not needed for these transfers,
but I
have it set by default in $SRM_CONFIG for pulling files from
my SE.  I
have attempted the same calls manually with
access_latency=NEARLINE
and had no success.
--- pushmode=TRUE is needed for third party transfers between
dCache &amp; BeStMan sites.  With pushmode=FALSE, files show up
at my site
with zero file size.

I suspect pushmode=TRUE is the source of the problem.  My
guess is
that some special feature of these files in dCache is
preventing them
from transferring in pushmode.  That or some special feature
prevents
BeStMan from pulling the file for reasons other than
pushmode?  Has
anyone encountered an issue like this, or have any
suggestions on
further tests or fixes?

Thanks!
Malina Kirn

Two of the obstinant files&#58;

<a href='srm&#58;//srm-3.t2.ucsd.edu&#58;8443/srm/managerv2?SFN=/pnfs/' target='_blank' rel='nofollow'>srm&#58;//srm-3.t2.ucsd.edu&#58;8443/srm/managerv2?SFN=/pnfs/</a>
t2.ucsd.edu/data3/cms/phedex/store/mc/Summer08/TTJets-
madgraph/AODSIM/IDEAL_V9_AODSIM_v1/0004/380F8ED7-19AF-
DD11-97DE-0015171F2448.root
<a href='srm&#58;//cmssrm.fnal.gov&#58;8443/srm/managerv2?SFN=/resilient/kirn/' target='_blank' rel='nofollow'>srm&#58;//cmssrm.fnal.gov&#58;8443/srm/managerv2?SFN=/resilient/kirn/</a>
transfer-tests.txt

The srmcp error&#58;

SRMClientV2 &#58; connecting to srm at httpg&#58;//srm-3.t2.ucsd.edu&#58;
8443/srm/managerv2
SRMClientV2 &#58; srmCopy , contacting service
httpg&#58;//srm-3.t2.ucsd.edu&#58;8443/srm/managerv2
Wed Nov 26 09&#58;02&#58;44 EST 2008&#58;  srm returned requestToken =
-2144616254
Wed Nov 26 09&#58;02&#58;44 EST 2008&#58; sleeping 5 seconds ...
SRMClientV2 &#58; srmStatusOfCopyRequest , contacting service
httpg&#58;//srm-3.t2.ucsd.edu&#58;8443/srm/managerv2
Wed Nov 26 09&#58;02&#58;49 EST 2008&#58; sleeping 5 seconds ...

...wash, rinse, repeat...

Wed Nov 26 09&#58;13&#58;56 EST 2008&#58; srmCopy update failed, status &#58;
SRM_FAILURE explanation= at Wed Nov 26 06&#58;15&#58;54 PST 2008
state Failed
&#58;  at Wed Nov 26 06&#58;05&#58;46 PST 2008 state AsyncWait &#58; waiting
for files
to complete
RequestFileStatus#-2144616253 failed with error&#58;[  at Wed Nov
26
06&#58;15&#58;50 PST 2008 state Failed &#58; number of retries exceeded&#58;
org.dcache.srm.scheduler.NonFatalJobFailure&#58;
org.dcache.srm.scheduler.NonFatalJobFailure&#58;
CacheException(rc=666;msg=tranfer failed &#58;Unexpected
Exception &#58;
org.globus.common.ChainedIOException&#58; Authentication failed
[Caused
by&#58; Failure unspecified at GSS-API level [Caused by&#58; Unknown
CA]])]

Wed Nov 26 09&#58;13&#58;56 EST 2008&#58;
copyFileRequest[<a href='srm&#58;//srm-3.t2.ucsd.edu&#58;8443/srm/managerv2?SFN=/pnfs/t2.ucsd.edu/data3/cms/phedex/store/mc/Summer08/' target='_blank' rel='nofollow'>srm&#58;//srm-3.t2.ucsd.edu&#58;8443/srm/managerv2?SFN=/pnfs/t2.ucsd.edu/data3/cms/phedex/store/mc/Summer08/</a>
TTJets-madgraph/AODSIM/IDEAL_V9_AODSIM_v1/0004/380F8ED7-19AF-
DD11-97DE-0015171F2448.root
, <a href='srm&#58;//hepcms-0.umd.edu&#58;8443/srm/v2/server?SFN=/data/se/' target='_blank' rel='nofollow'>srm&#58;//hepcms-0.umd.edu&#58;8443/srm/v2/server?SFN=/data/se/</a>
store/mc/Summer08/TTJets-madgraph/AODSIM/
IDEAL_V9_AODSIM_v1/0004/380F8ED7-19AF-
DD11-97DE-0015171F2448.root]
status=SRM_FAILURE explanation=FAILED&#58;  at Wed Nov 26
06&#58;15&#58;50 PST
2008 state Failed &#58; number of retries exceeded&#58;
org.dcache.srm.scheduler.NonFatalJobFailure&#58;
org.dcache.srm.scheduler.NonFatalJobFailure&#58;
CacheException(rc=666;msg=tranfer failed &#58;Unexpected
Exception &#58;
org.globus.common.ChainedIOException&#58; Authentication failed
[Caused
by&#58; Failure unspecified at GSS-API level [Caused by&#58; Unknown
CA]])
Wed Nov 26 09&#58;13&#58;56 EST 2008&#58; java.io.IOException&#58; srmCopy
update
failed, status &#58; SRM_FAILURE explanation= at Wed Nov 26
06&#58;15&#58;54 PST
2008 state Failed &#58;  at Wed Nov 26 06&#58;05&#58;46 PST 2008 state
AsyncWait &#58;
waiting for files to complete
RequestFileStatus#-2144616253 failed with error&#58;[  at Wed Nov
26
06&#58;15&#58;50 PST 2008 state Failed &#58; number of retries exceeded&#58;
org.dcache.srm.scheduler.NonFatalJobFailure&#58;
org.dcache.srm.scheduler.NonFatalJobFailure&#58;
CacheException(rc=666;msg=tranfer failed &#58;Unexpected
Exception &#58;
org.globus.common.ChainedIOException&#58; Authentication failed
[Caused
by&#58; Failure unspecified at GSS-API level [Caused by&#58; Unknown
CA]])]

Alan Sill, Ph.D
Senior Scientist, High Performance Computing Center
Adjunct Professor of Physics
TTU

====================================================================
&#58;  Alan Sill, Texas Tech University  Office&#58; Admin 233, MS 4-1167  &#58;
&#58;  e-mail&#58; Alan.Sill@....   ph. 806-742-4350  fax 806-742-4358  &#58;
====================================================================
</div><script type='text/javascript'>
        $('#show_185903320').click(function() {
            $('#detail_185903320').slideDown("normal");
            $('#show_185903320').hide();
            $('#hide_185903320').show();
        });
        $('#hide_185903320').click(function() {
            $('#detail_185903320').slideUp();
            $('#hide_185903320').hide();
            $('#show_185903320').show();
        });
        </script></pre></div><legend>Similar Recent Tickets <small>modified within the last 30 days</small></legend><div id="similar_tickets"><p class="muted">No similar tickets found.</p></div>
</div>
<script type="text/javascript">
function reset_anchor() {
    $("#updates .selected").removeClass("selected");
    var urls = document.location.toString().split('#'); 
    var anchor = urls[1];
    if(anchor) {
        $("a[name='"+anchor+"']").parents(".update_description").addClass("selected");
    }
}
function submitspam(ticket_id) {
    myret = confirm("Would you like to close this ticket as a security ticket, and submit the ticket content to akismet?");
    if(myret == true) {
        $.ajax("viewer/processspam?id="+ticket_id).done(function() {
            window.location.reload();
        });
    }
}

$(function() {
    reset_anchor();
    var ADDITIONAL_COOKIE_NAME = 'gocticket';
    var options = { path: '/', expires: 365};

    if(window.opener && window.opener.name == "gocticket_list") {
        v = $.cookie("closewindow");
        if(!v) {
            $("#closewindow").attr("checked", "checked"); //on by default
        } else {
            if(v == "checked") {
                $("#closewindow").attr("checked", "checked");
            }
        }
        $("#closewindow").click(function() {
            $.cookie("closewindow", $(this).attr('checked'), options);
        });
    } else {
        $("#closewindow_area").hide();
    }
    function updateTimeago() {
        $("time").timeago();
        setTimeout(updateTimeago, 30*1000);
    }
    updateTimeago();
    $(".description").focus(expand_description);
});
</script>
<hr/>
<footer>
<p>GOC Ticket Version 2.2 | <a href="https://ticket.opensciencegrid.org/goc/submit?app_issue_check=on&amp;app_issue_type=goc&amp;app_goc_url=https%3A%2F%2Fticket.opensciencegrid.org%3A443%2F6091">Report Bugs</a>
 | <a href="https://github.com/opensciencegrid/operations/blob/master/docs/privacy.md">Privacy Policy</a>
</p>

<p> <img align="top" src="images/tag_orange.png"/> Copyright 2018 The Trustees of Indiana University - Developed for Open Science Grid</p>
</footer>


</div><!--container-fluid-->
<script>
//used by searchbox
function parseValue(value) {
    var obj = new Object();
    var tokens = value.split("\t");
    obj.str = tokens[0];
    obj.count = tokens[1];
    return obj;
}

$(function() {
    //bootstrap-2.0.4 stuff
    $(".alert-message").alert();
    $(".dropdown-toggle").dropdown();
    $("span[rel='tooltip']").tooltip();
    $("a[rel=popover]").popover();

    //activate menu that user is currently on
    $("#menu_navigator").addClass("active"); 
    $("#submenu_").addClass("active"); 

    //translate zend validation error message to bootstrap
    $(".errors").addClass("alert").addClass("alert-error");

    //enable autocomplete for search box
    $("#search").autocomplete({
        source: function( request, response ) {
            $.ajax({
                url: "search/autocomplete",
                dataType: "text",
                data: {
                    //featureClass: "P",
                    //style: "full",
                    //maxRows: 12,
                    //name_startsWith: request.term
                    q: request.term
                },
                success: function( data ) {
                    response( $.map( data.split("\n"), function( item ) {
                        if(item == "") return null;
                        return {
                            value: item
                        }
                    }));
                }
            });
        },
        select: function(event, ui) {
            document.location = "search?q="+ui.item.value;
        }
    });
    
});
</script>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-69012-13");
pageTracker._trackPageview();
} catch(err) {}
</script>

</body>
