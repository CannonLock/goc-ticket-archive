<!DOCTYPE html>
<html lang="en">
  <head>
  <base href="">
    <title>[35914] HTCondor-CE questions</title>    <meta charset="utf-8" />
    <meta name="verify-v1" content="na5IcAJsZVOfEkboRxuIiZ1zpZgnZiWra+nKcS7nA/o=" />
    <meta name="google-site-verification" content="DLrk3ft4s8b-S2TloLCL2LD_t6wcTjgSluf5pmiu2kA" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />
    <meta name="robots" content="noindex, nofollow" />

    <style type="text/css">
      body {
        padding-top: 50px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
     #search {
            width: 300px;
     }

    </style>

<script src="https://code.jquery.com/jquery-3.0.0.js"></script>
<script src="https://code.jquery.com/jquery-migrate-3.0.1.js"></script>

   <link href="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet"/>
    <script src="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/js/bootstrap.min.js"></script>

    <link href="https://netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"/>
    <link href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/themes/smoothness/jquery-ui.min.css" rel="stylesheet"/>
 <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>


    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/js/select2.min.js"></script>

    <link href="css/ticket.css" rel="stylesheet" />
    <script src="lib/jquery.cookie.js"></script>

    <link href="images/tag_orange.png" rel="icon" type="image/png"/>
  </head>

  <body>
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>

            <a class="brand" style="padding: 6px 0px 0px 6px;" href="http://opensciencegrid.org"><img src="images/osglogo.40x30.png"/></a>
            <ul class="nav">
                <li class="dropdown"><a href="https://ticket.opensciencegrid.org/#" class="dropdown-toggle" data-toggle="dropdown">GOC Ticket <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    <li><a href="https://my.opensciencegrid.org">MyOSG</a></li>
                    <li><a href="https://oim.opensciencegrid.org">OIM</a></li>
                    <li class="active"><a href="https://ticket.opensciencegrid.org/index">Ticket</a></li>
	<li class="divider"></li>
	<li><a href="http://repo.grid.iu.edu">Repo</a></li>
	<li class="divider"></li>
	<li><a href="http://blogs.grid.iu.edu">Blog</a></li>
                    <li><a href="http://display.grid.iu.edu">Display</a></li>
                    <li><a href="http://osggoc.blogspot.com/">News</a></li>
                    </ul>
                </li>
            </ul>
            <ul class="nav pull-right">
                <li><a href="https://ticket.opensciencegrid.org/sso/">Login</a></li>            </ul>

            <div class="nav-collapse">
                <ul class="nav">
			 <li id="menu_submit"><a href="https://ticket.opensciencegrid.org/submit">Submit</a></li><li id="menu_view" class="dropdown"><a href="https://ticket.opensciencegrid.org/\#" class="dropdown-toggle" data-toggle="dropdown">View <b class="caret"></b></a><ul class="dropdown-menu"><li id="submenu_listopen"><a href="https://ticket.opensciencegrid.org/list/open">Open Tickets</a></li><li id="submenu_listrecentclose"><a href="https://ticket.opensciencegrid.org/list/recentclose">Recently Closed Tickets</a></li><li class="divider"></li><li id="submenu_alltickets"><a href="https://ticket.opensciencegrid.org/search?q=&amp;sort=id">All Tickets</a></li></ul></li>                </ul>

                <form class="navbar-search pull-right" action="https://ticket.opensciencegrid.org/viewer">
                    <input id="search" type="text" name="id" class="search-query span2" placeholder="Search Ticket" value=""/>
                </form>
            </div>
        </div>
      </div>
    </div>

<script type='text/javascript' src='lib/jquery.timeago.js'></script>
<script type='text/javascript' src='lib/byte2size.js'></script>
<style>
#updates .toolbar {
position: relative;
margin-top: 0px;
top: -10px;
font-weight: normal;
}
#updates a.anchor {
position: relative;
top: -50px;
}
#updates .selected pre {
animation:selected 2s;
animation-iteration-count: 2;
animation-direction: alternate;
-webkit-animation:selected 2s; 
-webkit-animation-iteration-count: 2;
-webkit-animation-direction: alternate;
box-shadow: inset 1px 1px 20px #9ad;
border: 1px solid #9ab;
margin: 5px 0px;
padding-left: 10px;
}
@keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ab;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
@-webkit-keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ad;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
#updates pre {
background-color: inherit;
line-height: 15px;
padding: 5px;
}
#updates .header {
color: #999;
}
#updates .update_history pre {
background-color: #eee;
color: #666;
font-size: 85%;
}
#updates .clickable {
cursor: pointer;
}
#updates .clickable:hover {
color: #D98719;
}
#updates .meta_information pre {
background-color: #fed;
}
#similar_tickets {
max-height: 300px;
overflow-y: auto;
pointer-events: none;
padding: 5px;
background-color: #f4f4f4;
}
.btn-toolbar {
margin-bottom: 0;
height: 30px;
}
#peers {
position: fixed;
bottom: 0px;
right: 0px;
z-index: 100;
list-style: none;
padding: 5px 0px 0px 5px;
margin: 0px;
background-color: white;
box-shadow: 0px 0px 10px white;
}
#peers li {
background-color: #ccc;
color: #000;
display: inline-block;
padding: 5px 10px;
margin-right: 5px;
position: relative;
}
/*
#peers li:hover {
background-color: #999;
cursor: pointer;
}
*/
#peers span.ip {
padding-left: 5px;
color: #666;
}
#peers .new {
bottom: -30px;
}
/*
#peers .me {
background-color: red;
}
*/
</style>

<div class="container-fluid">
<ul id="peers"></ul>
<div class="alert alert-danger"><a class="close" href="https://ticket.opensciencegrid.org/#" data-dismiss="alert">&times;</a>By the end of May 2018, the ticketing system at https://ticket.opensciencegrid.org will be retired and support will be provided at https://support.opensciencegrid.org. Throughout this transition the support email (help@opensciencegrid.org) will be available as a point of contact.<br><br>                                                   
                                                                                                                                                                                   
Please see the service migration page for details: https://opensciencegrid.github.io/technology/policy/service-migrations-spring-2018/#ticket</div><div id="presence" class="pull-right"></div><div class="ticketgui"><script type="text/javascript" src="lib/checktab.js"></script>

<script>
var expanded = false;
function expand_description() {
    var desc = $(".description");
    if(!expanded) {
        expanded = true;
        //expand to minheight
        var min = 250;
        if(desc.height() < min) {
            desc.animate({height: min}, 200);
        }
    }
}

$(document).ready(function() {
    $("input[name='nad']").datepicker({
        dateFormat: 'yy-mm-dd'
    });
});

</script>



<style>
.form-horizontal .control-label {
padding-top: inherit;
font-size:90%;
color:#666;
}
label {
margin-bottom: 0px;
}
.controls {
line-height: 18px;
}
</style>
<form class="form-horizontal" action="https://ticket.opensciencegrid.org/viewer/updatebasic?id=35914" method="post">
<div class="page-header">
    <h3><span class="muted">35914</span> / HTCondor-CE questions</h3>
</div>

<div class="row-fluid">
<div class="span5">
    <legend>Contact</legend>
    <div class="control-group">
        <label class="control-label">Full Name</label>
        <div class="controls">Patrick McGuigan</div>
    </div>
    <div class="control-group">
        <label class="control-label">Email</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">Phone</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">CC</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>

    <legend>Details</legend>
    <div class="control-group"><label class="control-label">Submitted Via</label><div class="controls">GOC Ticket/submit</div></div><div class="control-group"><label class="control-label">Submitter</label><div class="controls">Patrick McGuigan</div></div><div class="control-group"><label class="control-label">Ticket Links</label><div class="controls"></div></div>
    <div class="control-group">
        <label class="control-label">Ticket Type</label>
        <div class="controls">Problem/Request</div>
    </div>
    <div class="control-group">
        <label class="control-label">Priority</label>
        <div class="controls">Normal</div>
    </div>
    <div class="control-group">
        <label class="control-label">Status</label>
        <div class="controls">
Closed</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action</label>
        <div class="controls">Waiting for user response</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action Deadline</label>
        <div class="controls flag_red">2018-04-20</div>
    </div>

</div><!--span-->
<div class="span7">
    <legend>Assignees</legend>
    <div class="assignee" style="width: 60%">Scott Teige <span class="muted"> / OSG Operations Infrastructure</span></div><div class="assignee" style="width: 60%">Rob Quick <span class="muted"> / OSG GOC Management</span></div><div class="assignee" style="width: 60%">Software Support (Triage) <span class="muted"> / OSG Software Team</span></div><div class="assignee" style="width: 60%">Brian Lin <span class="muted"> / OSG Software Team</span></div>    <br>

    <legend>Assignees</legend>
    TODO
    <br>

    <style>
legend.noborder {
border-bottom: none;
}
</style>

<div id="attachment-list"/>
<script>
$(function () {
    var first = true;
    $.getJSON("attachment/list/35914", function (files) {
        //console.dir(files);
        var html = "<table class=\"table table-condensed\">";
        $(files).each(function() {
            if(first) {
                first = false;
                html += "<legend class=\"noborder\">Attachmenets</legend>";
            }
            html += "<tr class=\"attachment\">";
            html += "<td><img src=\""+this.thumbnail_url+"\"/></td>";
            html += "<td><a href=\""+this.url+"\" target=\"_blank\">"+this.name+"</a></td>";
            html += "<td>"+bytesToSize(this.size, 1)+"</td>";
            html += "</tr>";
        });
        html += "</table>";
        $("#attachment-list").html(html);
    });
});

function download(url) {
    window.open(url, "_blank");
}
</script>


</div><!--span-->
</div><!--row-fluid-->


</form>

</div>
<div id="updates" style="clear: both;">
    <legend>Past Updates
    <div class="btn-toolbar pull-right toolbar">
    </div><!--btn-toolbar-->
    </legend>

    <div class='update_description'><i onclick="document.location='35914#1524748105'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2018-04-26T13:08:25+00:00">Apr 26, 2018 01:08 PM UTC</time> by <b>Sarah Schmiechen</b><a class="anchor" name="1524748105">&nbsp;</a></div><pre>Closing.</pre></div><div class='update_description'><i onclick="document.location='35914#1524697687'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2018-04-25T23:08:07+00:00">Apr 25, 2018 11:08 PM UTC</time><a class="anchor" name="1524697687">&nbsp;</a></div><pre>This ticket has moved to support.opensciencegrid.org with the new ticket number being 6685. Please close this instance.

by rynge@....</pre></div><div class='update_description'><i onclick="document.location='35914#1524593369'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2018-04-24T18:09:29+00:00">Apr 24, 2018 06:09 PM UTC</time> by <b>Suchandra Thapa</b><a class="anchor" name="1524593369">&nbsp;</a></div><pre>Any updates Patrick?</pre></div><div class='update_description'><i onclick="document.location='35914#1523883668'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2018-04-16T13:01:08+00:00">Apr 16, 2018 01:01 PM UTC</time> by <b>echism</b><a class="anchor" name="1523883668">&nbsp;</a></div><pre>Patrick,

I&#39;m trying to close all my tickets. Where are we on this?

Thanks</pre></div><div class='update_description'><i onclick="document.location='35914#1523287933'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2018-04-09T15:32:13+00:00">Apr 9, 2018 03:32 PM UTC</time> by <b>Brian Lin</b><a class="anchor" name="1523287933">&nbsp;</a></div><pre>Hey Patrick,

How&#39;re things going? Is there anything we can help with?

Thanks,
Brian</pre></div><div class='update_description'><i onclick="document.location='35914#1522359915'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2018-03-29T21:45:15+00:00">Mar 29, 2018 09:45 PM UTC</time> by <b>Patrick McGuigan</b><a class="anchor" name="1522359915">&nbsp;</a></div><pre>Hi Edgar,

Yes,  I have just put about a 1/3 of the cluster (~3,000 job slots) behind the
test CE.  I expect it will take about a day for the batch system and Panda to
come to terms with the new resource allocation.

Patrick

On 03/29/2018 11&#58;39 AM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='35914#1522081489'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2018-03-26T16:24:49+00:00">Mar 26, 2018 04:24 PM UTC</time><a class="anchor" name="1522081489">&nbsp;</a></div><pre>Hi Patrick,

DO you have news on having more racks of comput nodes behidn the CE?

Edgar
OSG Software Support

by emfajardohernandez@....</pre></div><div class='update_description'><i onclick="document.location='35914#1521354734'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2018-03-18T06:32:14+00:00">Mar 18, 2018 06:32 AM UTC</time> by <b>Patrick McGuigan</b><a class="anchor" name="1521354734">&nbsp;</a></div><pre>Hi,

The basics seem to work, but I need scale the system so that it is handling all
the work for our Tier2.  Right now, I only have one rack of compute nodes behind
the CE.  I hope to start scaling up this week while in SLC.

Patrick

On 03/16/2018 10&#58;27 AM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='35914#1521214064'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2018-03-16T15:27:44+00:00">Mar 16, 2018 03:27 PM UTC</time> by <b>Suchandra Thapa</b><a class="anchor" name="1521214064">&nbsp;</a></div><pre>Hi Patrick,

Have things changed in regards to availability?

Suchandra</pre></div><div class='update_description'><i onclick="document.location='35914#1520457792'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2018-03-07T21:23:12+00:00">Mar 7, 2018 09:23 PM UTC</time> by <b>Patrick McGuigan</b><a class="anchor" name="1520457792">&nbsp;</a></div><pre>Hi Elizabeth,

I am having a week from the Old Testament; I wouldn&#39;t be surprised if a plague
of locusts descended on our lab.

I have not had time to work on the CE.

Patrick

On 03/07/2018 11&#58;52 AM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='35914#1520445140'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2018-03-07T17:52:20+00:00">Mar 7, 2018 05:52 PM UTC</time> by <b>echism</b><a class="anchor" name="1520445140">&nbsp;</a></div><pre>Hey Patrick,

How are you doing?

Thanks</pre></div><div class='update_description'><i onclick="document.location='35914#1520266449'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2018-03-05T16:14:09+00:00">Mar 5, 2018 04:14 PM UTC</time> by <b>echism</b><a class="anchor" name="1520266449">&nbsp;</a></div><pre>Patrick,

Are you all set?

Thanks</pre></div><div class='update_description'><i onclick="document.location='35914#1519760704'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2018-02-27T19:45:04+00:00">Feb 27, 2018 07:45 PM UTC</time> by <b>Brian Lin</b><a class="anchor" name="1519760704">&nbsp;</a></div><pre>Patrick,

The response from the developer about those &#34;unremoveable&#34; jobs&#58;

<font color='#7F7E6F'>&#62; This is a bug in the gridmanager. If a job is removed just as the gridmanager is about to submit it, or is removed after a submission attempt fails, the job can end up in this state, where the gridmanager insists on successfully submitting the job to the batch system before removing it.</font>

So you can go ahead and &#96;condor_ce_rm&#96; then &#96;condor_ce_rm -forcex&#96; the jobs that are hanging around. Did you have any other questions?

Thanks,
Brian</pre></div><div class='update_description'><i onclick="document.location='35914#1519669340'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2018-02-26T18:22:20+00:00">Feb 26, 2018 06:22 PM UTC</time> by <b>Brian Lin</b><a class="anchor" name="1519669340">&nbsp;</a></div><pre>Patrick,

1) Thanks, I see them now and it looks like most of them are routed jobs. I&#39;m asking the condor dev to see how we could have gotten into this state and why &#96;condor_ce_rm&#96; alone won&#39;t remove them.

2) Yea, I think the same NFS mount should work provided that you have root squash disabled (<a href='https&#58;//opensciencegrid.github.io/docs/compute-element/install-htcondor-ce/#sharing-the-spool-directory' target='_blank' rel='nofollow'>https&#58;//opensciencegrid.github.io/docs/compute-element/install-htcondor-ce/#sharing-the-spool-directory</a>) if it&#39;s not served from the CE itself.

- Brian</pre></div><div class='update_description'><i onclick="document.location='35914#1519335015'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2018-02-22T21:30:15+00:00">Feb 22, 2018 09:30 PM UTC</time> by <b>Patrick McGuigan</b><a class="anchor" name="1519335015">&nbsp;</a></div><pre>Hi,

Sorry for the delay.  ATLAS issues arose that impact some of what we are trying
to do.

1) The CE is test06.atlas-swt2.org

I&#39;ll hold off deleting anything for now.

2) It looks like there may have been problems with how jobs were configured to
run once they got to the compute node.  There is some evidence that some jobs
were using the job&#39;s spool directory of the NFS server for execution, rather
than honoring OSG_WN_TMP.  The debris from these jobs (on the ATLAS side) are no
longer visible.

I am assuming that the NFS mount that works fairly well (but not perfectly) for
our GRAM gatekeeper should be able to keep up with the HTCondor-CE, as they
should be fairly similar in usage.

Patrick

On 02/19/2018 02&#58;42 PM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='35914#1519315189'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2018-02-22T15:59:49+00:00">Feb 22, 2018 03:59 PM UTC</time> by <b>echism</b><a class="anchor" name="1519315189">&nbsp;</a></div><pre>Hi Patrick! Did you see Brian&#39;s note?

Thanks</pre></div><div class='update_description'><i onclick="document.location='35914#1519072932'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2018-02-19T20:42:12+00:00">Feb 19, 2018 08:42 PM UTC</time> by <b>Brian Lin</b><a class="anchor" name="1519072932">&nbsp;</a></div><pre>1) Try &#96;condor_ce_rm &#60;job id or username&#62;; condor_ce_rm -forcex &#60;job id
or username&#62;&#96;. What&#39;s your CE hostname? I&#39;d like to see what kind of
jobs are exhibiting this behavior before you blow them away.

2) I&#39;ve generally seen this issue when there were shared FS problems (is
root squash disabled for the CE?). To trace the problem, the best thing
to do would be to set &#96;ALL_DEBUG = D_FULLDEBUG&#96; in
/etc/condor-ce/config.d/99-local.conf followed by a condor_ce_reconfig.
Then submit jobs that end up with this held message and trace it through
the logs&#58;

    1. In the example you gave, 12881.0 is the grid job and 12894.0 is
the routed job
    2. Search for the routed job in both
/var/log/condor-ce/GridmanagerLog.&#60;username&#62; and
/var/log/condor-ce/JobRouterLog; search for the grid job in
/var/log/condor-ce/SchedLog. Look out for issues in surrounding lines.

You can also attach any logs if you&#39;d like me to take a look. As for the
class/size, that would depend on how many jobs and nodes you have&#58; I&#39;m
not entirely sure about the size of a gwms/panda pilot but I&#39;d take the
larger of the two, double that, then multiply that by the peak number of
jobs you expect to have at a time.

- Brian</pre></div><div class='update_description'><i onclick="document.location='35914#1518824172'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2018-02-16T23:36:12+00:00">Feb 16, 2018 11:36 PM UTC</time> by <b>Patrick McGuigan</b><a class="anchor" name="1518824172">&nbsp;</a></div><pre>Hi Brian,

Now for somethings completely different&#58;

We got some ATLAS jobs to run against the our new CE.  At the moment new jobs
are not coming in, so it is a convenient time to look at some things.

1) condor_ce_history seems to indicate that we have run 15K+ jobs through the
CE, however there are now 69 jobs that are considered &#34;HELD&#34;.  I know that a
couple of these held jobs were simple tests that I performed when starting
things up, and I would like to get rid of them.

However, when I run condor_ce_rm for either the cluster, or cluster.process id,
the jobs don&#39;t go away.  They disappear from the Held column of condor_ce_q&#39;s
output, but a short time later they are back to being held.  What is the correct
way to clean this debris up.

Is there a general way that one should use to clean up from odd problems that occur?

2) The majority of the held jobs seem to arise out of a problem between HTCondor
and blahp.  The diagnostics (condor_ce_q -af&#58;j HoldReason shows&#58;

12894.0 submission command failed (exit code = 1) (stdout&#58;Error-)
(stderr&#58;/usr/libexec/blahp/blah_common_submit_functions.sh&#58; line 746&#58; cd&#58;
/cluster/grid/htcondor-spool/2881/0/cluster12881.proc0.subproc0&#58; No such file or
directory-Failed to CD to Initial Working Directory.-)

I assume that something in HTCondor is tries to create the job&#39;s workarea and
thinks that this succeeded before calling blahp to get the local job submitted
to torque.  However, it seems that blahp can&#39;t find the directory.

I don&#39;t see these directories on the system.  What log can I inspect in HTCondor
that can provide insight into what went wrong?

Yes, we are using a cluster centric NFS server for spooling files, rather than
<div id='show_1777814788' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_1777814788'>the CE.  If we went with the CE, are there recommendations for the size and
class of a shared area?

I can&#39;t remove these jobs either using condor_rm.

Regards,

Patrick

On 02/12/2018 10&#58;08 AM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font>
</div><script type='text/javascript'>
        $('#show_1777814788').click(function() {
            $('#detail_1777814788').slideDown("normal");
            $('#show_1777814788').hide();
            $('#hide_1777814788').show();
        });
        $('#hide_1777814788').click(function() {
            $('#detail_1777814788').slideUp();
            $('#hide_1777814788').hide();
            $('#show_1777814788').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='35914#1518570371'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2018-02-14T01:06:11+00:00">Feb 14, 2018 01:06 AM UTC</time> by <b>Patrick McGuigan</b><a class="anchor" name="1518570371">&nbsp;</a></div><pre>Hi Brian,

This might be all a giant rabbit hole of my own creation.  I can see that the
lcmaps configuration would match the default OSG GUMS configuration.

I am not sure that the default configuration is correct for our Tier 2&#39;s. Then
we can see if lcmaps provides everything that we need.

Sorry for the noise,

Patrick

On 02/13/2018 01&#58;19 AM, Patrick McGuigan wrote&#58;
<font color='#7F7E6F'>&#62; Hi Brian,</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; Rather than tell you what I think that the default file should contain, I would</font>
<font color='#7F7E6F'>&#62; like to discuss this with everyone else in USAtlas and come up with a good set</font>
<font color='#7F7E6F'>&#62; of defaults.  Particularly if we drop the usatlas4 account.</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; The issue with usatlass3 / 4&#58;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; The problem comes from trying to determine if a user is a member of the vo group</font>
<font color='#7F7E6F'>&#62; /atlas/usatlas when the user only invokes&#58;</font>
<font color='#7F7E6F'>&#62;   voms-proxy-init -voms atlas</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; which produces something like the following attributes&#58;</font>
<font color='#7F7E6F'>&#62; attribute &#58; /atlas/Role=NULL/Capability=NULL</font>
<font color='#7F7E6F'>&#62; attribute &#58; /atlas/lcg1/Role=NULL/Capability=NULL</font>
<font color='#7F7E6F'>&#62; attribute &#58; /atlas/usatlas/Role=NULL/Capability=NULL</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; Our GUMS configuration is able to do this because 1) it knows who are the</font>
<font color='#7F7E6F'>&#62; members of /atlas/usatlas and 2) The user mapper responsible for the mapping to</font>
<div id='show_1468656837' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_1468656837'><font color='#7F7E6F'>&#62; usatlas3 comes before the default user mapper responsible for usatlas4.</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; The lcmaps configuration can not handle this for a couple of reasons&#58;</font>
<font color='#7F7E6F'>&#62; 1) lcmaps_voms_localaccount (as setup by OSG) only looks at the first attribute.</font>
<font color='#7F7E6F'>&#62;     For our proxies this is usually, but not gaurunteed to be&#58;</font>
<font color='#7F7E6F'>&#62;       /atlas/Role=NULL/Capability=NULL</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; 2) One can use &#34;-all-fqans&#34; with lcmaps_voms_localaccount and one has ability to</font>
<font color='#7F7E6F'>&#62; &#34;find&#34; the /atlas/usatlas/Role=NULL/Capability=NULL attribute in a proxy, but I</font>
<font color='#7F7E6F'>&#62; am not sure in what order lcmaps_voms_localaccount processes the attributes for</font>
<font color='#7F7E6F'>&#62; comparison.  This could potentially interfere with trying to match an attribute</font>
<font color='#7F7E6F'>&#62; based on a specific Role.</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; I was able to do something that I think looks correct using the following in</font>
<font color='#7F7E6F'>&#62; /etc/lcmaps.db&#58;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; gridmapfile = &#34;lcmaps_localaccount.mod&#34;</font>
<font color='#7F7E6F'>&#62;                &#34;-gridmap /etc/grid-security/grid-mapfile&#34;</font>
<font color='#7F7E6F'>&#62; banfile = &#34;lcmaps_ban_dn.mod&#34;</font>
<font color='#7F7E6F'>&#62;            &#34;-banmapfile /etc/grid-security/ban-mapfile&#34;</font>
<font color='#7F7E6F'>&#62; banvomsfile = &#34;lcmaps_ban_fqan.mod&#34;</font>
<font color='#7F7E6F'>&#62;                &#34;-banmapfile /etc/grid-security/ban-voms-mapfile&#34;</font>
<font color='#7F7E6F'>&#62; vomsrolefile = &#34;lcmaps_voms_localaccount.mod&#34;</font>
<font color='#7F7E6F'>&#62;                &#34;-gridmap /etc/grid-security/voms-rolefile&#34;</font>
<font color='#7F7E6F'>&#62;            &#34;-all-fqans&#34;</font>
<font color='#7F7E6F'>&#62; vomsgroupfile = &#34;lcmaps_voms_localaccount3.mod&#34;</font>
<font color='#7F7E6F'>&#62;                &#34;-gridmap /etc/grid-security/voms-groupfile&#34;</font>
<font color='#7F7E6F'>&#62;            &#34;-all-fqans&#34;</font>
<font color='#7F7E6F'>&#62; defaultmapfile = &#34;lcmaps_voms_localaccount2.mod&#34;</font>
<font color='#7F7E6F'>&#62;                   &#34;-gridmap /usr/share/osg/voms-mapfile-default&#34;</font>
<font color='#7F7E6F'>&#62; verifyproxynokey = &#34;lcmaps_verify_proxy2.mod&#34;</font>
<font color='#7F7E6F'>&#62;                     &#34;--allow-limited-proxy&#34;</font>
<font color='#7F7E6F'>&#62;                     &#34;--discard_private_key_absence&#34;</font>
<font color='#7F7E6F'>&#62;                     &#34; -certdir /etc/grid-security/certificates&#34;</font>
<font color='#7F7E6F'>&#62; good        = &#34;lcmaps_dummy_good.mod&#34;</font>
<font color='#7F7E6F'>&#62; bad         = &#34;lcmaps_dummy_bad.mod&#34;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; authorize_only&#58;</font>
<font color='#7F7E6F'>&#62; verifyproxynokey -&#62; banfile</font>
<font color='#7F7E6F'>&#62; banfile -&#62; banvomsfile | bad</font>
<font color='#7F7E6F'>&#62; banvomsfile -&#62; gridmapfile | bad</font>
<font color='#7F7E6F'>&#62; gridmapfile -&#62; good | vomsrolefile</font>
<font color='#7F7E6F'>&#62; vomsrolefile -&#62; good | vomsgroupfile</font>
<font color='#7F7E6F'>&#62; vomsgroupfile -&#62; good | defaultmapfile</font>
<font color='#7F7E6F'>&#62; defaultmapfile -&#62; good | bad</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; where /etc/grid-security/voms-rolefile contains&#58;</font>
<font color='#7F7E6F'>&#62; # Production Roles</font>
<font color='#7F7E6F'>&#62; &#34;/atlas/*Role=production/*&#34; usatlas1</font>
<font color='#7F7E6F'>&#62; # Software or SAM Roles</font>
<font color='#7F7E6F'>&#62; &#34;/atlas/*Role=software/*&#34; usatlas2</font>
<font color='#7F7E6F'>&#62; &#34;/atlas/*Role=lcgadmin/*&#34; usatlas2</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; and /etc/grid-security/voms-groupfile contains&#58;</font>
<font color='#7F7E6F'>&#62; &#34;/atlas/usatlas/*&#34; usatlas3</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; and the only ATLAS entry in /usr/share/osg/voms-mapfile-default is&#58;</font>
<font color='#7F7E6F'>&#62; &#34;/atlas/*&#34; usatlas4</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; The downside to this is that we need another copy of the</font>
<font color='#7F7E6F'>&#62; lcmaps_voms_localaccount module and I am not sure if adding another module to</font>
<font color='#7F7E6F'>&#62; the chain will cause any undue issues with mapping (i.e. time to perform a</font>
<font color='#7F7E6F'>&#62; mapping, resource usage, how many copies lcmaps_voms_localaccount can be used).</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; The other caveat to this is that when I look through</font>
<font color='#7F7E6F'>&#62; /usr/share/osg/voms-mapfile-default, we are probably the only VO with this type</font>
<font color='#7F7E6F'>&#62; of use case.  The only other VO I see making a decision based on groups is OSG</font>
<font color='#7F7E6F'>&#62; for separating LIGO from the rest of the VO.  I suspect that it is well</font>
<font color='#7F7E6F'>&#62; established practice for LIGO users to invoke the proxies with&#58;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; voms-proxy-init -voms osg&#58;/osg/LIGO</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; The final word is that USATLAS may want to get rid of the usatlas4 account,</font>
<font color='#7F7E6F'>&#62; since we may not really need to distinguish between US-ATLAS users and the rest</font>
<font color='#7F7E6F'>&#62; of ATLAS users.  If that is the case, then our setup will look a lot like CMS.</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; Regards,</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; Patrick</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62;</font>
<font color='#7F7E6F'>&#62; On 02/12/2018 04&#58;37 PM, Open Science Grid FootPrints wrote&#58;</font>
<font color='#7F7E6F'>&#62;&#62; [Duplicate message snipped]</font>
</div><script type='text/javascript'>
        $('#show_1468656837').click(function() {
            $('#detail_1468656837').slideDown("normal");
            $('#show_1468656837').hide();
            $('#hide_1468656837').show();
        });
        $('#hide_1468656837').click(function() {
            $('#detail_1468656837').slideUp();
            $('#hide_1468656837').hide();
            $('#show_1468656837').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='35914#1518506472'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2018-02-13T07:21:12+00:00">Feb 13, 2018 07:21 AM UTC</time> by <b>Patrick McGuigan</b><a class="anchor" name="1518506472">&nbsp;</a></div><pre>Hi Brian,

Rather than tell you what I think that the default file should contain, I would
like to discuss this with everyone else in USAtlas and come up with a good set
of defaults.  Particularly if we drop the usatlas4 account.

The issue with usatlass3 / 4&#58;

The problem comes from trying to determine if a user is a member of the vo group
/atlas/usatlas when the user only invokes&#58;
voms-proxy-init -voms atlas

which produces something like the following attributes&#58;
attribute &#58; /atlas/Role=NULL/Capability=NULL
attribute &#58; /atlas/lcg1/Role=NULL/Capability=NULL
attribute &#58; /atlas/usatlas/Role=NULL/Capability=NULL

Our GUMS configuration is able to do this because 1) it knows who are the
members of /atlas/usatlas and 2) The user mapper responsible for the mapping to
usatlas3 comes before the default user mapper responsible for usatlas4.

The lcmaps configuration can not handle this for a couple of reasons&#58;
1) lcmaps_voms_localaccount (as setup by OSG) only looks at the first attribute.
For our proxies this is usually, but not gaurunteed to be&#58;
/atlas/Role=NULL/Capability=NULL

2) One can use &#34;-all-fqans&#34; with lcmaps_voms_localaccount and one has ability to
&#34;find&#34; the /atlas/usatlas/Role=NULL/Capability=NULL attribute in a proxy, but I
am not sure in what order lcmaps_voms_localaccount processes the attributes for
comparison.  This could potentially interfere with trying to match an attribute
based on a specific Role.

I was able to do something that I think looks correct using the following in
/etc/lcmaps.db&#58;

<div id='show_311520177' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_311520177'>gridmapfile = &#34;lcmaps_localaccount.mod&#34;
&#34;-gridmap /etc/grid-security/grid-mapfile&#34;
banfile = &#34;lcmaps_ban_dn.mod&#34;
&#34;-banmapfile /etc/grid-security/ban-mapfile&#34;
banvomsfile = &#34;lcmaps_ban_fqan.mod&#34;
&#34;-banmapfile /etc/grid-security/ban-voms-mapfile&#34;
vomsrolefile = &#34;lcmaps_voms_localaccount.mod&#34;
&#34;-gridmap /etc/grid-security/voms-rolefile&#34;
&#34;-all-fqans&#34;
vomsgroupfile = &#34;lcmaps_voms_localaccount3.mod&#34;
&#34;-gridmap /etc/grid-security/voms-groupfile&#34;
&#34;-all-fqans&#34;
defaultmapfile = &#34;lcmaps_voms_localaccount2.mod&#34;
&#34;-gridmap /usr/share/osg/voms-mapfile-default&#34;
verifyproxynokey = &#34;lcmaps_verify_proxy2.mod&#34;
&#34;--allow-limited-proxy&#34;
&#34;--discard_private_key_absence&#34;
&#34; -certdir /etc/grid-security/certificates&#34;
good        = &#34;lcmaps_dummy_good.mod&#34;
bad         = &#34;lcmaps_dummy_bad.mod&#34;

authorize_only&#58;
verifyproxynokey -&#62; banfile
banfile -&#62; banvomsfile | bad
banvomsfile -&#62; gridmapfile | bad
gridmapfile -&#62; good | vomsrolefile
vomsrolefile -&#62; good | vomsgroupfile
vomsgroupfile -&#62; good | defaultmapfile
defaultmapfile -&#62; good | bad

where /etc/grid-security/voms-rolefile contains&#58;
# Production Roles
&#34;/atlas/*Role=production/*&#34; usatlas1
# Software or SAM Roles
&#34;/atlas/*Role=software/*&#34; usatlas2
&#34;/atlas/*Role=lcgadmin/*&#34; usatlas2

and /etc/grid-security/voms-groupfile contains&#58;
&#34;/atlas/usatlas/*&#34; usatlas3

and the only ATLAS entry in /usr/share/osg/voms-mapfile-default is&#58;
&#34;/atlas/*&#34; usatlas4

The downside to this is that we need another copy of the
lcmaps_voms_localaccount module and I am not sure if adding another module to
the chain will cause any undue issues with mapping (i.e. time to perform a
mapping, resource usage, how many copies lcmaps_voms_localaccount can be used).

The other caveat to this is that when I look through
/usr/share/osg/voms-mapfile-default, we are probably the only VO with this type
of use case.  The only other VO I see making a decision based on groups is OSG
for separating LIGO from the rest of the VO.  I suspect that it is well
established practice for LIGO users to invoke the proxies with&#58;

voms-proxy-init -voms osg&#58;/osg/LIGO

The final word is that USATLAS may want to get rid of the usatlas4 account,
since we may not really need to distinguish between US-ATLAS users and the rest
of ATLAS users.  If that is the case, then our setup will look a lot like CMS.

Regards,

Patrick

On 02/12/2018 04&#58;37 PM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font>
</div><script type='text/javascript'>
        $('#show_311520177').click(function() {
            $('#detail_311520177').slideDown("normal");
            $('#show_311520177').hide();
            $('#hide_311520177').show();
        });
        $('#hide_311520177').click(function() {
            $('#detail_311520177').slideUp();
            $('#hide_311520177').hide();
            $('#show_311520177').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='35914#1518475077'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2018-02-12T22:37:57+00:00">Feb 12, 2018 10:37 PM UTC</time> by <b>Brian Lin</b><a class="anchor" name="1518475077">&nbsp;</a></div><pre>Patrick,

Interesting. We had some back and forth with Bob a few months ago and the current defaults are what we landed on. What should the defaults be?

And I&#39;m curious about the details about what you need to differentiate between usatlas3 and usatlas4 that GUMS can do but the LCMAPS VOMS plugin can&#39;t.

Thanks,
Brian</pre></div><div class='update_description'><i onclick="document.location='35914#1518474435'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2018-02-12T22:27:15+00:00">Feb 12, 2018 10:27 PM UTC</time> by <b>Patrick McGuigan</b><a class="anchor" name="1518474435">&nbsp;</a></div><pre>Hi Brian,

I have found some issues with lcmaps-voms and how USATLAS would/should use it.

The provided /usr/share/osg/voms-mapfile-default is probably not correct for
what we want for usatlas1 and usatlas2.  The current configuration can be
overridden with /etc/grid-security/voms-mapfile, but it seems that if we might
want to get the default file correct.

The second issue is more problematic.  The provided lcmaps-voms infrastructure
does not replicate how we use GUMS and can not differentiate usatlas3 and
usatlas4 in the way that GUMS did.

I can go into this in much more detail, but it may be moot.  We are having a
discussion if we need both of these accounts in the future.  If we get rid of
usatlas4, then the lcmaps infrastructure will suffice.

Patrick

On 02/12/2018 10&#58;08 AM, Open Science Grid FootPrints wrote&#58;
<font color='#7F7E6F'>&#62; [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='35914#1518451726'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2018-02-12T16:08:46+00:00">Feb 12, 2018 04:08 PM UTC</time> by <b>Brian Lin</b><a class="anchor" name="1518451726">&nbsp;</a></div><pre>Patrick,

Were there any other HTCondor-CE questions that we could help with? Do you need any further assistance with the transition?

Thanks,
Brian</pre></div><div class='update_description'><i onclick="document.location='35914#1517846390'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2018-02-05T15:59:50+00:00">Feb 5, 2018 03:59 PM UTC</time> by <b>Brian Lin</b><a class="anchor" name="1517846390">&nbsp;</a></div><pre>Patrick,

Did our answers help? Do you have any other questions about the process?

Thanks,
Brian</pre></div><div class='update_description'><i onclick="document.location='35914#1517512730'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2018-02-01T19:18:50+00:00">Feb 1, 2018 07:18 PM UTC</time> by <b>Scott Teige</b><a class="anchor" name="1517512730">&nbsp;</a></div><pre>I&#39;m not really an expert on this but I&#39;d check all three WLCG resource boxes if you want it to behave like gk01.atlas-swt2.org
Here&#58; <a href='https&#58;//oim.grid.iu.edu/oim/resourceedit?id=398' target='_blank' rel='nofollow'>https&#58;//oim.grid.iu.edu/oim/resourceedit?id=398</a>
The individual boxes have a explanation containing 100% of my understanding of what they do.
S</pre></div><div class='update_description'><i onclick="document.location='35914#1517498685'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2018-02-01T15:24:45+00:00">Feb 1, 2018 03:24 PM UTC</time> by <b>echism</b><a class="anchor" name="1517498685">&nbsp;</a></div><pre>Scott,

Do you know about the interop stuff in Patrick&#39;s inquiry? I mean I know what is conventional for people to do in OIM, but I don&#39;t know what is *required* per se.

Thanks</pre></div><div class='update_description'><i onclick="document.location='35914#1517329649'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2018-01-30T16:27:29+00:00">Jan 30, 2018 04:27 PM UTC</time> by <b>Brian Lin</b><a class="anchor" name="1517329649">&nbsp;</a></div><pre>Questions about HTCondor-CE/Torque connection&#58;

1) Yes, two jobs in the CE are expected&#58; <a href='https&#58;//opensciencegrid.github.io/docs/compute-element/htcondor-ce-overview/#on-other-batch-systems' target='_blank' rel='nofollow'>https&#58;//opensciencegrid.github.io/docs/compute-element/htcondor-ce-overview/#on-other-batch-systems</a>
2) 2GB is the default memory requested by a CE and you can configure this default per job route (<a href='https&#58;//opensciencegrid.github.io/docs/compute-element/job-router-recipes/#maximum-memory' target='_blank' rel='nofollow'>https&#58;//opensciencegrid.github.io/docs/compute-element/job-router-recipes/#maximum-memory</a>).
3) Env vars that are passed on are listed in &#34;/var/lib/osg/osg-job-environment.conf&#34;, which can be customized with osg-configure. You&#39;re seeing the SSH* vars because of a quirk of condor_ce_run that passes on the environment of the user who runs it. If you run &#96;condor_ce_trace&#96;, that should give you a better idea of the worker node environment.
4) The default configuration of the blahp should not require torque log access, we get job status updates via pbs_status.py

For the Gratia accounting question, I believe it depends on what version of the gratia-probe RPM you have installed on your production CE.

I don&#39;t think I can answer the AGIS/WLCG questions, you&#39;ll probably have better luck on the ATLAS T2 mailing list.

- Brian</pre></div><div class='update_description'><i onclick="document.location='35914#1517328890'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2018-01-30T16:14:50+00:00">Jan 30, 2018 04:14 PM UTC</time> by <b>Brian Lin</b><a class="anchor" name="1517328890">&nbsp;</a></div><pre>From an e-mail I got from Patrick&#58;

============================

I am hoping to get some better understanding of a couple of things related to bringing up an HTCondor-CE (with a torque based batch system) and bringing up a new CE with ties to ATLAS and WLCG.

To give you an idea of where I am at&#58;

1) I have CE resource defined in OIM as SWT2_CPB_DEV (as test06.atlas-swt2.org).

2) I have partitioned our batch system so that there are a few compute nodes dedicated to batch queues that only the new CE knows about.

3) I have installed the CE software on test06 and I can submit test jobs that mostly behave the way I expect.  More on this later.

4) I have not started any other services on the CE other than condor-ce.

Questions about the linkages between HTCondor and PBS/Torque&#58;
1) Is it normal that a job submitted from a remote host with condor_ce_run -r creates two jobs in htcondor (as seen with condor_ce_q) and one job submitted to the batch system?

2) Somewhere in the default mechanisms of condor_ce_run, condor-ce, or blahp I can see that a simply submitted job&#58;

condor_ce_run -r test06.atlas-swt2.org&#58;9619 /usr/bin/printenv

is creating a PBS submission file that contains constraints on the memory usage of a job&#58;
#PBS -l pmem=2000mb
#PBS -l mem=2000mb
#PBS -l nodes=1&#58;ppn=1

I don&#39;t see this being a default in blahp, so I am curious if condor_ce_run is attaching this to a classad or if condor-ce is defaulting to this value in the absence of a classad?   I would like to understand this before I start getting ATLAS pilots submitted.

3) I am trying to understand where all the environment variables are coming from when a job is constructed for PBS.  I certainly expect OSG* type variables to be exported in the launched job, but I am surprised to see things SSH_CLIENT/SSH_CONNECTION whose values relate to root&#39;s conection on the CE that launched condor-ce.  Is there a way to control what variables condor-ce is exporting to jobs?   I am not sure of the potential pitfalls yet, but I also see environment variables being exported from the clients environment (i.e USER) where condor_ce_run was executed. Is this normal, is there a way to constrain this?  I am not sure I want to constrain them yet, but I am curious if there is a mechanism for doing so.

4) I noticed when looking into 2) above that blahp has code that can access the Torque logs files directly to determine what is happening with a job.  It also looks like it can live without access.  Do you know of any issues related to scaling up to the size of our Tier2 ( 3000 - 6000 jobs) if one does or doesn&#39;t provide access to the logs? This may become moot with later questions concerning job reporting

Questions about have a second CE associated with our site.
<div id='show_697126262' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_697126262'>
The short term plan is get this HTCondor-CE functional to the point where we can get ATLAS to use it a scale or at least near scale.  At that point, we will do a complete reinstall on our very old CE and move production back there.  Longer term, I will probably retire/deactivate the SWT2_CPB_DEV CE.

1) I will need to have SWT2_CPB_DEV CE known to AGIS in ATLAS. How much of the interop will I need to enable to allow AGIS to discover the CE and its queues?

2) Do you know if I enable the RSV forwarding to WLCG, will this be part of SAM?

3) If I am going to forward GRATIA accounting data to WLCG, I saw that I need to make a change to the configuration because I have multiple CE&#39;s.  However, given the very old age of the production CE, how can I tell if the production CE can operate in a multi-CE setup?

4) Since I am not concerned with the long term viability of the DEV CE does it matter what the WLCG resource numbers are?  Can I, or should I, copy the values from the production CE?

Any insights are greatly appreciated,

Patrick
</div><script type='text/javascript'>
        $('#show_697126262').click(function() {
            $('#detail_697126262').slideDown("normal");
            $('#show_697126262').hide();
            $('#hide_697126262').show();
        });
        $('#hide_697126262').click(function() {
            $('#detail_697126262').slideUp();
            $('#hide_697126262').hide();
            $('#show_697126262').show();
        });
        </script></pre></div>
</div>
<script type="text/javascript">
function reset_anchor() {
    $("#updates .selected").removeClass("selected");
    var urls = document.location.toString().split('#'); 
    var anchor = urls[1];
    if(anchor) {
        $("a[name='"+anchor+"']").parents(".update_description").addClass("selected");
    }
}
function submitspam(ticket_id) {
    myret = confirm("Would you like to close this ticket as a security ticket, and submit the ticket content to akismet?");
    if(myret == true) {
        $.ajax("viewer/processspam?id="+ticket_id).done(function() {
            window.location.reload();
        });
    }
}

$(function() {
    reset_anchor();
    var ADDITIONAL_COOKIE_NAME = 'gocticket';
    var options = { path: '/', expires: 365};

    if(window.opener && window.opener.name == "gocticket_list") {
        v = $.cookie("closewindow");
        if(!v) {
            $("#closewindow").attr("checked", "checked"); //on by default
        } else {
            if(v == "checked") {
                $("#closewindow").attr("checked", "checked");
            }
        }
        $("#closewindow").click(function() {
            $.cookie("closewindow", $(this).attr('checked'), options);
        });
    } else {
        $("#closewindow_area").hide();
    }
    function updateTimeago() {
        $("time").timeago();
        setTimeout(updateTimeago, 30*1000);
    }
    updateTimeago();
    $(".description").focus(expand_description);
});
</script>
<hr/>
<footer>
<p>GOC Ticket Version 2.2 | <a href="https://ticket.opensciencegrid.org/goc/submit?app_issue_check=on&amp;app_issue_type=goc&amp;app_goc_url=https%3A%2F%2Fticket.opensciencegrid.org%3A443%2F35914">Report Bugs</a>
 | <a href="https://github.com/opensciencegrid/operations/blob/master/docs/privacy.md">Privacy Policy</a>
</p>

<p> <img align="top" src="images/tag_orange.png"/> Copyright 2018 The Trustees of Indiana University - Developed for Open Science Grid</p>
</footer>


</div><!--container-fluid-->
<script>
//used by searchbox
function parseValue(value) {
    var obj = new Object();
    var tokens = value.split("\t");
    obj.str = tokens[0];
    obj.count = tokens[1];
    return obj;
}

$(function() {
    //bootstrap-2.0.4 stuff
    $(".alert-message").alert();
    $(".dropdown-toggle").dropdown();
    $("span[rel='tooltip']").tooltip();
    $("a[rel=popover]").popover();

    //activate menu that user is currently on
    $("#menu_navigator").addClass("active"); 
    $("#submenu_").addClass("active"); 

    //translate zend validation error message to bootstrap
    $(".errors").addClass("alert").addClass("alert-error");

});
</script>


</body>
