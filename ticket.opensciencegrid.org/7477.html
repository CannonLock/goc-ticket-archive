<!DOCTYPE html>
<html lang="en">
  <head>
  <base href="">
    <title>[7477] dCache/Bestman - 3rd party transfer failing due to incorrect hostname being returned</title>    <meta charset="utf-8" />
    <meta name="verify-v1" content="na5IcAJsZVOfEkboRxuIiZ1zpZgnZiWra+nKcS7nA/o=" />
    <meta name="google-site-verification" content="DLrk3ft4s8b-S2TloLCL2LD_t6wcTjgSluf5pmiu2kA" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />
    <link href="https://ticket.opensciencegrid.org/rss" rel="alternate" type="application/rss+xml" title="GOC Ticket Update feed" />

    <style type="text/css">
      body {
        padding-top: 50px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
     #search {
            width: 300px;
     }

    </style>

<script src="https://code.jquery.com/jquery-3.0.0.js"></script>
<script src="https://code.jquery.com/jquery-migrate-3.0.1.js"></script>

   <link href="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet"/>
    <script src="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/js/bootstrap.min.js"></script>

    <link href="https://netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"/>
    <link href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/themes/smoothness/jquery-ui.min.css" rel="stylesheet"/>
 <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>


    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/js/select2.min.js"></script>

    <link href="css/ticket.css" rel="stylesheet" />
    <script src="lib/jquery.cookie.js"></script>

    <link href="images/tag_orange.png" rel="icon" type="image/png"/>
  </head>

  <body>
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>

            <a class="brand" style="padding: 6px 0px 0px 6px;" href="http://opensciencegrid.org"><img src="images/osglogo.40x30.png"/></a>
            <ul class="nav">
                <li class="dropdown"><a href="https://ticket.opensciencegrid.org/#" class="dropdown-toggle" data-toggle="dropdown">GOC Ticket <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    <li><a href="https://my.opensciencegrid.org">MyOSG</a></li>
                    <li><a href="https://oim.opensciencegrid.org">OIM</a></li>
                    <li class="active"><a href="https://ticket.opensciencegrid.org/index">Ticket</a></li>
	<li class="divider"></li>
	<li><a href="http://repo.grid.iu.edu">Repo</a></li>
	<li class="divider"></li>
	<li><a href="http://blogs.grid.iu.edu">Blog</a></li>
                    <li><a href="http://display.grid.iu.edu">Display</a></li>
                    <li><a href="http://osggoc.blogspot.com/">News</a></li>
                    </ul>
                </li>
            </ul>
            <ul class="nav pull-right">
                <li><a href="https://ticket.opensciencegrid.org/sso/">Login</a></li>            </ul>

            <div class="nav-collapse">
                <ul class="nav">
			 <li id="menu_submit"><a href="https://ticket.opensciencegrid.org/submit">Submit</a></li><li id="menu_view" class="dropdown"><a href="https://ticket.opensciencegrid.org/\#" class="dropdown-toggle" data-toggle="dropdown">View <b class="caret"></b></a><ul class="dropdown-menu"><li id="submenu_listopen"><a href="https://ticket.opensciencegrid.org/list/open">Open Tickets</a></li><li id="submenu_listrecentclose"><a href="https://ticket.opensciencegrid.org/list/recentclose">Recently Closed Tickets</a></li><li class="divider"></li><li id="submenu_alltickets"><a href="https://ticket.opensciencegrid.org/search?q=&amp;sort=id">All Tickets</a></li></ul></li>                </ul>

                <form class="navbar-search pull-right" action="https://ticket.opensciencegrid.org/viewer">
                    <input id="search" type="text" name="id" class="search-query span2" placeholder="Search Ticket" value=""/>
                </form>
            </div>
        </div>
      </div>
    </div>

<script type='text/javascript' src='lib/jquery.timeago.js'></script>
<script type='text/javascript' src='lib/byte2size.js'></script>
<style>
#updates .toolbar {
position: relative;
margin-top: 0px;
top: -10px;
font-weight: normal;
}
#updates a.anchor {
position: relative;
top: -50px;
}
#updates .selected pre {
animation:selected 2s;
animation-iteration-count: 2;
animation-direction: alternate;
-webkit-animation:selected 2s; 
-webkit-animation-iteration-count: 2;
-webkit-animation-direction: alternate;
box-shadow: inset 1px 1px 20px #9ad;
border: 1px solid #9ab;
margin: 5px 0px;
padding-left: 10px;
}
@keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ab;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
@-webkit-keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ad;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
#updates pre {
background-color: inherit;
line-height: 15px;
padding: 5px;
}
#updates .header {
color: #999;
}
#updates .update_history pre {
background-color: #eee;
color: #666;
font-size: 85%;
}
#updates .clickable {
cursor: pointer;
}
#updates .clickable:hover {
color: #D98719;
}
#updates .meta_information pre {
background-color: #fed;
}
#similar_tickets {
max-height: 300px;
overflow-y: auto;
pointer-events: none;
padding: 5px;
background-color: #f4f4f4;
}
.btn-toolbar {
margin-bottom: 0;
height: 30px;
}
#peers {
position: fixed;
bottom: 0px;
right: 0px;
z-index: 100;
list-style: none;
padding: 5px 0px 0px 5px;
margin: 0px;
background-color: white;
box-shadow: 0px 0px 10px white;
}
#peers li {
background-color: #ccc;
color: #000;
display: inline-block;
padding: 5px 10px;
margin-right: 5px;
position: relative;
}
/*
#peers li:hover {
background-color: #999;
cursor: pointer;
}
*/
#peers span.ip {
padding-left: 5px;
color: #666;
}
#peers .new {
bottom: -30px;
}
/*
#peers .me {
background-color: red;
}
*/
</style>

<div class="container-fluid">
<ul id="peers"></ul>
<div class="alert alert-danger"><a class="close" href="https://ticket.opensciencegrid.org/#" data-dismiss="alert">&times;</a>By the end of May 2018, the ticketing system at https://ticket.opensciencegrid.org will be retired and support will be provided at https://support.opensciencegrid.org. Throughout this transition the support email (help@opensciencegrid.org) will be available as a point of contact.<br><br>                                                   
                                                                                                                                                                                   
Please see the service migration page for details: https://opensciencegrid.github.io/technology/policy/service-migrations-spring-2018/#ticket</div><div id="presence" class="pull-right"></div><div class="ticketgui"><script type="text/javascript" src="lib/checktab.js"></script>

<script>
var expanded = false;
function expand_description() {
    var desc = $(".description");
    if(!expanded) {
        expanded = true;
        //expand to minheight
        var min = 250;
        if(desc.height() < min) {
            desc.animate({height: min}, 200);
        }
    }
}

$(document).ready(function() {
    $("input[name='nad']").datepicker({
        dateFormat: 'yy-mm-dd'
    });
});

</script>



<style>
.form-horizontal .control-label {
padding-top: inherit;
font-size:90%;
color:#666;
}
label {
margin-bottom: 0px;
}
.controls {
line-height: 18px;
}
</style>
<form class="form-horizontal" action="https://ticket.opensciencegrid.org/viewer/updatebasic?id=7477" method="post">
<div class="page-header">
    <h3><span class="muted">7477</span> / dCache/Bestman - 3rd party transfer failing due to incorrect hostname being returned</h3>
</div>

<div class="row-fluid">
<div class="span5">
    <legend>Contact</legend>
    <div class="control-group">
        <label class="control-label">Full Name</label>
        <div class="controls">neha sharma</div>
    </div>
    <div class="control-group">
        <label class="control-label">Email</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">Phone</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">CC</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>

    <legend>Details</legend>
    
    <div class="control-group">
        <label class="control-label">Ticket Type</label>
        <div class="controls">Problem/Request</div>
    </div>
    <div class="control-group">
        <label class="control-label">Priority</label>
        <div class="controls">Normal</div>
    </div>
    <div class="control-group">
        <label class="control-label">Status</label>
        <div class="controls">
Closed</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action</label>
        <div class="controls"></div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action Deadline</label>
        <div class="controls flag_red">1970-01-01</div>
    </div>

</div><!--span-->
<div class="span7">
    <legend>Assignees</legend>
    <div class="assignee" style="width: 60%">Neha Sharma <span class="muted"> / OSG Storage Team</span></div>    <br>

    <legend>Assignees</legend>
    TODO
    <br>

    <style>
legend.noborder {
border-bottom: none;
}
</style>

<div id="attachment-list"/>
<script>
$(function () {
    var first = true;
    $.getJSON("attachment/list/7477", function (files) {
        //console.dir(files);
        var html = "<table class=\"table table-condensed\">";
        $(files).each(function() {
            if(first) {
                first = false;
                html += "<legend class=\"noborder\">Attachmenets</legend>";
            }
            html += "<tr class=\"attachment\">";
            html += "<td><img src=\""+this.thumbnail_url+"\"/></td>";
            html += "<td><a href=\""+this.url+"\" target=\"_blank\">"+this.name+"</a></td>";
            html += "<td>"+bytesToSize(this.size, 1)+"</td>";
            html += "</tr>";
        });
        html += "</table>";
        $("#attachment-list").html(html);
    });
});

function download(url) {
    window.open(url, "_blank");
}
</script>


</div><!--span-->
</div><!--row-fluid-->


</form>

</div>
<div id="updates" style="clear: both;">
    <legend>Past Updates
    <div class="btn-toolbar pull-right toolbar">
        <div class="btn-group">
                <a class="btn btn-small" href="https://ticket.opensciencegrid.org/7477?sort=up&amp;"><i class="icon-arrow-up"></i> Sort</a>

        
        <a class="btn btn-small" href="https://ticket.opensciencegrid.org/7477?expandall=true&amp;">Expand Descriptions</a>        <a class="btn btn-small" target="_blank" href="mailto:osg@tick.globalnoc.iu.edu?subject=Open%20Science%20Grid%3A%20dCache%2FBestman%20-%203rd%20party%20transfer%20failing%20due%20to%20incorrect%20hostname%20being%20returned%20ISSUE%3D7477%20PROJ%3D71"><i class="icon-envelope"></i> Update w/Email</a>
        </div>
    </div><!--btn-toolbar-->
    </legend>

    <div class='update_description'><i onclick="document.location='7477#1253118191'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2009-09-16T16:23:11+00:00">Sep 16, 2009 04:23 PM UTC</time> by <b>Neha Sharma</b><a class="anchor" name="1253118191">&nbsp;</a></div><pre>This was an issue with the ordering in /etc/hosts, I put the external IP first, and now it works fine!

Go figure, thanks everyone for your help.

It appears phedex is also now working... as i&#39;m watching the loadtest file grow.

-Patrick

On Sep 11, 2009, at 4&#58;55 PM, Brian Bockelman wrote&#58;

Check the reverse lookup on your SE node.

Try&#58;

host uscms1-se.fltech-grid3.fit.edu

from the SE node.  Does it resolve to the internal or external IP?

Brian

On Sep 11, 2009, at 3&#58;48 PM, Alex Sim wrote&#58;

it seems that your SE node still has some host configuration issue
somewhere...

-- Alex

On 9/11/09 1&#58;41 PM, Patrick Ford wrote&#58;
I just tried this command on our CE (uscms1.fltech-grid3.fit.edu)

[phedex@uscms1 pford]$ srm-copy
<a href='srm&#58;//cmssrm.fnal.gov&#58;8443/srm/managerv2?SFN=/11/store/PhEDEx_LoadTest07/LoadTest07_Prod_FNAL/LoadTest07_FNAL_E7' target='_blank' rel='nofollow'>srm&#58;//cmssrm.fnal.gov&#58;8443/srm/managerv2?SFN=/11/store/PhEDEx_LoadTest07/LoadTest07_Prod_FNAL/LoadTest07_FNAL_E7</a> <a href='srm&#58;//uscms1-se.fltech-' target='_blank' rel='nofollow'>srm&#58;//uscms1-se.fltech-</a>
grid3.fit.edu&#58;8443/srm/v2/server?SFN=/mnt/nas0/OSG/BeStMan/cms/nicolotest5
-3partycopy -debug -dcau false

<div id='show_408907445' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_408907445'>And it works fine!

gridftp log on the SE machine (uscms1-se) indicates the correct DEST
IP as well.
DATE=20090911204022.710384 HOST=uscms1-se.fltech-grid3.fit.edu
PROG=globus-gridftp-server NL.EVNT=FTP_INFO
START=20090911204010.182573 USER=uscms01
FILE=/mnt/nas0/OSG/BeStMan/cms/nicolotest5 BUFFER=0 BLOCK=262144
NBYTES=36587288 VOLUME=/ STREAMS=5 STRIPES=1 DEST=[131.225.205.215]
TYPE=ESTO CODE=226

Weird!
-Patrick

On Sep 11, 2009, at 4&#58;36 PM, Alex Sim wrote&#58;

Hi Tanya,

yes, you tried on your FNAL machine, and he did it on the same node
where his bestman is running, which had previously a problem of hostname
configuration.
also, srmcp worked in the push mode which remote host calls his gsiftp
server, whereas srm-copy was called as 3rd party gsiftp which local
machine is involved.

-- Alex

On 9/11/09 1&#58;31 PM, Tanya Levshina wrote&#58;
Hi Alex,
It works for me on &#34;our&#34; installation of dcache and bestman-gateway.
My understanding is that it works for Patrick for srm Fermi client with
pushmode but not for srm lbnl client.

Tanya

-----Original Message-----
From&#58; owner-osg-int@....
[mailto&#58;owner-osg-int@....] On Behalf Of Alex Sim
Sent&#58; Friday, September 11, 2009 3&#58;28 PM
To&#58; Patrick Ford
Cc&#58; Yujun Wu; Brian Bockelman; Tanya Levshina; &#39;Malina Kirn&#39;;
osg-int@....; OSG STORAGE
Subject&#58; Re&#58; Bestman VDT Setup defaulting to the wrong hostname

Patrick,

can you try the client on some other hosts, like in FNAL or florida if
you have an account.
Since it works for Tanya, it could really be some kind of local
firewall
or something, as Brian mentioned, that local connection has some
priority connection to the internal network... something like that?
As for srm-copy options, you can use either -3partycopy or -pushmode.
You need -dcau false.
If you use -pushmode, it&#39;ll cause FNAL dCache to push the file to
yours.
If -3partycopy is used, client is making 3rd party gsiftp copy.

-- Alex

On 9/11/09 12&#58;43 PM, Patrick Ford wrote&#58;

I was told that with -3partycopy you don&#39;t need pushmode... but it
doesn&#39;t work anyway.

I notice that with all the gridftp transfers that work... the DEST has
an actual value (IP address) in the gridftp.log... but all 3rd party
transfers have this&#58;
DEST=[0.0.0.0]

But I am grasping at straws... this is a very odd problem.

-Patrick

On Sep 11, 2009, at 3&#58;18 PM, Yujun Wu wrote&#58;

Hi Patrick,

Could you please try with &#34;-pushmode&#34; if you have a firewall
in-between?

Regards,
Yujun
On Fri, 11 Sep 2009, Patrick Ford wrote&#58;

I tried that command... the client host and the gridftp host are the
same (uscms1-se). I don&#39;t believe there is a campus firewall because
it always used to work fine on our CE node which is on the exact
same
subnet.

Command still hangs.

-Patrick

On Sep 11, 2009, at 3&#58;09 PM, Brian Bockelman wrote&#58;

Hey Patrick,

This can be caused by a firewall&#58;
a) On your client host
b) on your gridftp host

or anywhere inbetween (such as a campus firewall)

As a test, try flushing your iptables with &#34;iptables -F&#34; on both
hosts and verify with your networking folks there is no firewall.

Brian

On Sep 11, 2009, at 1&#58;45 PM, Patrick Ford wrote&#58;

Hi all,
Here is what I just tried...

[phedex@uscms1-se phedex]$ /sandbox/osg-se/bestman/bin/srm-copy

<a href='srm&#58;//cmssrm.fnal.gov&#58;8443/srm/managerv2?SFN=/11/store/PhEDEx_LoadTest07/Loa' target='_blank' rel='nofollow'>srm&#58;//cmssrm.fnal.gov&#58;8443/srm/managerv2?SFN=/11/store/PhEDEx_LoadTest07/Loa</a>

dTest07_Prod_FNAL/LoadTest07_FNAL_E7

<a href='srm&#58;//uscms1-se.fltech-grid3.fit.edu&#58;8443/srm/v2/server?SFN=/mnt/nas0/OSG/Be' target='_blank' rel='nofollow'>srm&#58;//uscms1-se.fltech-grid3.fit.edu&#58;8443/srm/v2/server?SFN=/mnt/nas0/OSG/Be</a>

StMan/cms/nicolotest2

-3partycopy -debug -dcau false

Gives the error&#58;

org.globus.ftp.exception.ServerException&#58; Server refused
performing
the request. Custom message&#58; Server reported transfer failure
(error code 1) [Nested exception message&#58;  Custom message&#58;
Unexpected reply&#58; 426 Transfer aborted (Transfer failed&#58;
Connection
timed out)] [Nested exception is
org.globus.ftp.exception.UnexpectedReplyCodeException&#58;  Custom
message&#58; Unexpected reply&#58; 426 Transfer aborted (Transfer failed&#58;
Connection timed out)]
org.globus.ftp.exception.ServerException&#58; Server refused
performing
the request. Custom message&#58; Server reported transfer failure
(error code 1) [Nested exception message&#58;  Custom message&#58;
Unexpected reply&#58; 426 Transfer aborted (Transfer failed&#58;
Connection
timed out)].  Nested exception is
org.globus.ftp.exception.UnexpectedReplyCodeException&#58;  Custom
message&#58; Unexpected reply&#58; 426 Transfer aborted (Transfer failed&#58;
Connection timed out)
at
org.globus.ftp.vanilla.TransferMonitor.run(TransferMonitor.java&#58;
154)
DONE Gridftp&#58;
//WAX/11/store/PhEDEx_LoadTest07/LoadTest07_Prod_FNAL/
LoadTest07_FNAL_E7 time took (milliseconds) =203642
SRM-CLIENT&#58; Fri Sep 11 14&#58;23&#58;11 EDT 2009 gsiftp transfer failed
and
error occured

But the following commands work by themselves&#58;

[phedex@uscms1-se phedex]$ /sandbox/osg-se/bestman/bin/srm-copy

<a href='srm&#58;//cmssrm.fnal.gov&#58;8443/srm/managerv2?SFN=/11/store/PhEDEx_LoadTest07/Loa' target='_blank' rel='nofollow'>srm&#58;//cmssrm.fnal.gov&#58;8443/srm/managerv2?SFN=/11/store/PhEDEx_LoadTest07/Loa</a>

dTest07_Prod_FNAL/LoadTest07_FNAL_E7

file&#58;////tmp/nicolotest2 -debug -dcau false

[phedex@uscms1-se phedex]$ /sandbox/osg-se/bestman/bin/srm-copy
file&#58;////tmp/nicolotest2

<a href='srm&#58;//uscms1-se.fltech-grid3.fit.edu&#58;8443/srm/v2/server?SFN=/mnt/nas0/OSG/Be' target='_blank' rel='nofollow'>srm&#58;//uscms1-se.fltech-grid3.fit.edu&#58;8443/srm/v2/server?SFN=/mnt/nas0/OSG/Be</a>

StMan/cms/nicolotest3

-debug -dcau false

So it sounds like gridftp works fine... but 3rd party copy is
screwing up.

Any ideas?
-Patrick

On Sep 11, 2009, at 2&#58;29 PM, Tanya Levshina wrote&#58;

Hi,

It is strange it works for me&#58;
srm-copy

<a href='srm&#58;//gwdca04.fnal.gov&#58;8443/srm/managerv2&#92' target='_blank' rel='nofollow'>srm&#58;//gwdca04.fnal.gov&#58;8443/srm/managerv2&#92</a>;?SFN=/pnfs/fnal.gov/data/fermilab/

tlevshin/test_sh1

<a href='srm&#58;//gw018k1.fnal.gov&#58;10443/srm/v2/server&#92' target='_blank' rel='nofollow'>srm&#58;//gw018k1.fnal.gov&#58;10443/srm/v2/server&#92</a>;?SFN=/mnt/hadoop/fnalgrid/test_sh

3

-3partycopy -debug  -dcau false

could you please send you debug output?

Thanks,
Tanya

----- Original Message -----
From&#58; Patrick Ford &#60;patrick.ford88@....&#62;
Date&#58; Friday, September 11, 2009 1&#58;24 pm
Subject&#58; Re&#58; Bestman VDT Setup defaulting to the wrong hostname
To&#58; Brian Bockelman &#60;bbockelm@....&#62;
Cc&#58; Tanya Levshina &#60;tlevshin@....&#62;, &#39;Malina Kirn&#39;
&#60;m.a.kirn@....

, osg-int@....

Same error&#58;

[phedex@uscms1-se phedex]$ /sandbox/osg-se/bestman/bin/srm-copy

<a href='srm&#58;//cmssrm.fnal.gov&#58;8443/srm/managerv2?SFN=/11/store/PhEDEx_LoadTest07/Loa' target='_blank' rel='nofollow'>srm&#58;//cmssrm.fnal.gov&#58;8443/srm/managerv2?SFN=/11/store/PhEDEx_LoadTest07/Loa</a>

dTest07_Prod_FNAL/LoadTesm&#58;//uscms1-se.fltech-grid3.fit.edu&#58;8443/srm/v2/serv

er?SFN=/mnt/nas0/OSG/BeStMan/cms/nicolotest2

-3partycopy -debug -dcau false

org.globus.ftp.exception.ServerException&#58; Server refused
performing
the request. Custom message&#58; Server reported transfer failure
(error

code 1) [Nested exception message&#58;  Custom message&#58; Unexpected
reply&#58;

426 Transfer aborted (Transfer failed&#58; Connection timed out)]
[Nested

exception is
org.globus.ftp.exception.UnexpectedReplyCodeException&#58;

Custom message&#58; Unexpected reply&#58; 426 Transfer aborted (Transfer
failed&#58; Connection timed out)]
org.globus.ftp.exception.ServerException&#58; Server refused
performing
the request. Custom message&#58; Server reported transfer failure
(error

code 1) [Nested exception message&#58;  Custom message&#58; Unexpected
reply&#58;

426 Transfer aborted (Transfer failed&#58; Connection timed out)].
Nested

exception is
org.globus.ftp.exception.UnexpectedReplyCodeException&#58;

Custom message&#58; Unexpected reply&#58; 426 Transfer aborted (Transfer
failed&#58; Connection timed out)
at org.globus.ftp.vanilla.TransferMonitor.run
(TransferMonitor.java&#58;154)
DONE Gridftp&#58; //WAX/11/store/PhEDEx_LoadTest07/
LoadTest07_Prod_FNAL/
LoadTest07_FNAL_E7 time took (milliseconds) =203642
SRM-CLIENT&#58; Fri Sep 11 14&#58;23&#58;11 EDT 2009 gsiftp transfer
failed and
error occured

-Patrick

On Sep 11, 2009, at 2&#58;16 PM, Brian Bockelman wrote&#58;

Hey Patrick,

For the LBNL client,
1) Remove the -pushmode argument; not needed for -3partycopy
2) Add &#34;-dcau=false&#34;

Brian

On Sep 11, 2009, at 1&#58;13 PM, Tanya Levshina wrote&#58;

Hi,

Do I understand correctly that  dcache -&#62; bestman-gateway
thridparty transfer in push mode works for srm fermi client
and
doesn&#39;t work srm lbnl client  for the same credentials?

Thanks,
Tanya

From&#58; owner-osg-int@.... [mailto&#58;owner-osg-
int@....] On Behalf Of Patrick Ford
Sent&#58; Friday, September 11, 2009 11&#58;49 AM
To&#58; Malina Kirn
Cc&#58; osg-int@....
Subject&#58; Re&#58; Bestman VDT Setup defaulting to the wrong
hostname

I now have another issue that maybe OSG can help with (gridftp
issue).

Nicolo tried a srmcp from FNAL and it worked fine!

Here is the gridftp log with both of our requests.

Respective commands&#58;

srmcp -debug -2 -pushmode

<a href='srm&#58;//cmssrm.fnal.gov&#58;8443/srm/managerv2?SFN=/11/store/PhEDEx_LoadTest07/Loa' target='_blank' rel='nofollow'>srm&#58;//cmssrm.fnal.gov&#58;8443/srm/managerv2?SFN=/11/store/PhEDEx_LoadTest07/Loa</a>

dTest07_Prod_FNAL/LoadTest07_FNAL_E7

<a href='srm&#58;//uscms1-se.fltech-grid3.fit.edu&#58;8443/srm/v2/server?SFN=/mnt/nas0/OSG/Be' target='_blank' rel='nofollow'>srm&#58;//uscms1-se.fltech-grid3.fit.edu&#58;8443/srm/v2/server?SFN=/mnt/nas0/OSG/Be</a>

StMan/cms/store/PhEDEx_LoadTest07/LoadTest07_Debug_US_FNAL/niccotest

[phedex@uscms1-se ~]$ /sandbox/osg-se/bestman/bin/srm-copy

<a href='srm&#58;//cmssrm.fnal.gov&#58;8443/srm/managerv2?SFN=/11/store/PhEDEx_LoadTest07/Loa' target='_blank' rel='nofollow'>srm&#58;//cmssrm.fnal.gov&#58;8443/srm/managerv2?SFN=/11/store/PhEDEx_LoadTest07/Loa</a>

dTest07_Prod_FNAL/LoadTest07_FNAL_E7<a href='srm&#58;//uscms1-se.fltech-grid3.fit.edu&#58;844' target='_blank' rel='nofollow'>srm&#58;//uscms1-se.fltech-grid3.fit.edu&#58;844</a>

3/srm/v2/server?SFN=/mnt/nas0/OSG/BeStMan/cms/nicolotest

-3partycopy -debug -pushmode

DATE=20090911132714.898391 HOST=uscms1-se.fltech-grid3.fit.edu
PROG=globus-gridftp-server NL.EVNT=FTP_INFO
START=20090911132251.170341 USER=uscms01

FILE=/mnt/nas0/OSG/BeStMan/

cms/store/PhEDEx_LoadTest07/LoadTest07_Debug_US_FNAL/niccotest
BUFFER=0 BLOCK=262144 NBYTES=2762262404 VOLUME=/ STREAMS=20
STRIPES=1 DEST=[131.225.205.215] TYPE=STOR CODE=226

DATE=20090911163611.193820 HOST=uscms1-se.fltech-grid3.fit.edu
PROG=globus-gridftp-server NL.EVNT=FTP_INFO
START=20090911163523.735797 USER=uscms01

FILE=/mnt/nas0/OSG/BeStMan/

cms/nicolotest BUFFER=0 BLOCK=262144 NBYTES=0 VOLUME=/
STREAMS=1
STRIPES=1 DEST=[0.0.0.0] TYPE=ESTO CODE=226

What is up with that DEST=[0.0.0.0] ?

With my command (second one) I got the following error&#58;

org.globus.ftp.exception.ServerException&#58; Server refused
performing

the request. Custom message&#58; Server reported transfer failure
(error code 1) [Nested exception message&#58;  Custom message&#58;
Unexpected reply&#58; 426 Transfer aborted (Transfer failed&#58;
Connection

timed out)] [Nested exception is
org.globus.ftp.exception.UnexpectedReplyCodeException&#58;  Custom
message&#58; Unexpected reply&#58; 426 Transfer aborted (Transfer
failed&#58;

Connection timed out)]
org.globus.ftp.exception.ServerException&#58; Server refused
performing

the request. Custom message&#58; Server reported transfer failure
(error code 1) [Nested exception message&#58;  Custom message&#58;
Unexpected reply&#58; 426 Transfer aborted (Transfer failed&#58;
Connection

timed out)].  Nested exception is
org.globus.ftp.exception.UnexpectedReplyCodeException&#58;  Custom
message&#58; Unexpected reply&#58; 426 Transfer aborted (Transfer
failed&#58;

Connection timed out)
at org.globus.ftp.vanilla.TransferMonitor.run
(TransferMonitor.java&#58;154)
DONE Gridftp&#58;

//WAX/11/store/PhEDEx_LoadTest07/LoadTest07_Prod_FNAL/

LoadTest07_FNAL_E7 time took (milliseconds) =203767
SRM-CLIENT&#58; Fri Sep 11 12&#58;39&#58;46 EDT 2009 gsiftp transfer
failed
and

error occured

-Patrick

On Sep 11, 2009, at 7&#58;57 AM, Malina Kirn wrote&#58;

Hi Patrick,

I had exactly this problem about a month ago (on OSG-Storage
list).  I
followed the wonderful instructions at this URL&#58;

<a href='http&#58;//www.xenocafe.com/tutorials/linux/redhat/change_hostname_without_reboo' target='_blank' rel='nofollow'>http&#58;//www.xenocafe.com/tutorials/linux/redhat/change_hostname_without_reboo</a>

t/index.php

to change the hostname advertised by my SE.  You&#39;ll have to
completely
reinstall your OSG SE (and your CE, if they&#39;re both on the
same
node),
as there are some places where the hostname is hard-coded at
install
time which can&#39;t be fixed by simply calling configure-osg
again.

Malina

On Thu, Sep 10, 2009 at 4&#58;31 PM, Patrick Ford

&#60;patrick.ford88@....

wrote&#58;

Hi all,
I have been trying to get Phedex working, but apparently the
problem lies in
Bestman and Gridftp. The loadtest manual transfers
(srm-copy) are

timing
out, and I think the issue lies with gridftp using the Rocks
internal
hostname for our SE machine (dev-0-0.local) rather than the
external
hostname that I have tried to set everywhere (including in the
rocks
database) - which is uscms1-se.fltech-grid3.fit.edu.
Here is the job log extract from Phedex&#58;
&#60;report filename=&#34;&#34;
request-explanation=&#34; at Thu Sep 10 14&#58;48&#58;04 CDT 2009 state
Pending &#58;
created&#34;
request-status=&#34;SRM_SUCCESS&#34; requesttype=&#34;3partycopy&#34;
rids=&#34;-2123761901,put&#58;39&#34; totalfiles=&#34;1&#34;
totalfiles-failed=&#34;1&#34;
totalfiles-per-request=&#34;1&#34; totalfiles-subrequests=&#34;1&#34;
totalfiles-success=&#34;0&#34;&#62;
&#60;file&#62;

&#60;sourceurl&#62;<a href='srm&#58;//cmssrm.fnal.gov&#58;8443/srm/managerv2?SFN=/11/' target='_blank' rel='nofollow'>srm&#58;//cmssrm.fnal.gov&#58;8443/srm/managerv2?SFN=/11/</a>
store/

PhEDEx_LoadTest07/LoadTest07_Prod_FNAL/LoadTest07_FNAL_E7&#60;/
sourceurl&#62;

&#60;targeturl&#62;<a href='srm&#58;//uscms1-se.fltech-grid3.fit.edu&#58;8443/srm/v2/server?' target='_blank' rel='nofollow'>srm&#58;//uscms1-se.fltech-grid3.fit.edu&#58;8443/srm/v2/server?</a>

SFN=/mnt/nas0/OSG/BeStMan/cms/store/loadtestFNALnew&#60;/targeturl&#62;

&#60;transferurl&#62;<a href='gsiftp&#58;//uscms1-se.fltech-grid3.fit.edu//mnt/nas0/OSG/' target='_blank' rel='nofollow'>gsiftp&#58;//uscms1-se.fltech-grid3.fit.edu//mnt/nas0/OSG/</a>

BeStMan/cms/store/loadtestFNALnew&#60;/transferurl&#62;
&#60;expectedsize&#62;2762262404&#60;/expectedsize&#62;
&#60;actualsize/&#62;
&#60;file-status&#62;SRM_SPACE_AVAILABLE&#60;/file-status&#62;
&#60;file-explanation/&#62;
&#60;timetaken/&#62;
&#60;message&#62;org.globus.ftp.exception.ServerException&#58; Server
refused performing the request. Custom message&#58;
Server
reported transfer failure (error code 1) [Nested
exception
message&#58;  Custom message&#58; Unexpected reply&#58; 426
Transfer
aborted (Transfer failed&#58; Connection timed out)]
[Nested
exception is

org.globus.ftp.exception.UnexpectedReplyCodeException&#58;
Custom message&#58; Unexpected reply&#58; 426 Transfer
aborted
(Transfer failed&#58; Connection timed out)]&#60;/message&#62;
&#60;/file&#62;
&#60;/report&#62;
And the gridftp.log&#58;
DATE=20090910195135.627597 HOST=dev-0-0.local PROG=globus-
gridftp-

server
NL.EVNT
=FTP_INFO START=20090910194814.379388 USER=uscms01
FILE=/mnt/nas0/OSG/BeStMan/cm
s/store/loadtestFNALnew BUFFER=0 BLOCK=262144 NBYTES=0
VOLUME=/
STREAMS=1
STRIPE
S=1 DEST=[0.0.0.0] TYPE=ESTO CODE=226

I changed all the entries of dev-0-0.local
to uscms1-se.fltech-grid3.fit.edu in every network system
file I
could find,
and then did a complete reinstall of the VDT Bestman... but
there

are still
entries in the VDT setup files with the wrong hostname.
[root@dev-0-0 sandbox]# grep -r dev-0-0.local osg-se/*
osg-se/bestman/setup/config.log&#58;hostname = dev-0-0.local
osg-se/bestman/setup/config.log&#58;on dev-0-0.local
osg-se/bestman/setup/config.log&#58;on dev-0-0.local
osg-se/bestman/setup/bestman.090910154353.log&#58;hostname =
dev-0-0.local
grep&#58; osg-se/certificat&#58; No such file or directory
osg-se/globus/setup/globus/config.log&#58;hostname = dev-0-0.local
osg-se/globus/setup/globus/config.log&#58;on dev-0-0.local
osg-se/globus/var/log/gridftp.log&#58;DATE=20090910195135.627597
HOST=dev-0-0.local PROG=globus-gridftp-server NL.EVNT=FTP_INFO
START=20090910194814.379388 USER=uscms01
FILE=/mnt/nas0/OSG/BeStMan/cms/store/loadtestFNALnew BUFFER=0
BLOCK=262144
NBYTES=0 VOLUME=/ STREAMS=1 STRIPES=1 DEST=[0.0.0.0] TYPE=ESTO
CODE=226
osg-se/globus/var/gridftp.log&#58;DATE=20090910195135.627597
HOST=dev-0-0.local
PROG=globus-gridftp-server NL.EVNT=FTP_INFO
START=20090910194814.379388
USER=uscms01
FILE=/mnt/nas0/OSG/BeStMan/cms/store/loadtestFNALnew

BUFFER=0
BLOCK=262144 NBYTES=0 VOLUME=/ STREAMS=1 STRIPES=1
DEST=[0.0.0.0]

TYPE=ESTO
CODE=226
osg-se/gratia/probe/gridftp-transfer/ProbeConfig&#58;
ProbeName=&#34;gridftp-transfer&#58;dev-0-0.local&#34;
osg-se/post-install/README&#58;We have set the default to be
&#39;dev-0-0.local&#39;.
You can correct this by
osg-se/vdt/setup/hostname&#58;dev-0-0.local
osg-se/vdt/backup/vdt/vdt/setup/
hostname_001_20090910-153933&#58;dev-0-0.local
osg-se/vdt/backup/vdt/vdt/setup/
hostname_002_20090910-154411&#58;dev-0-0.local
osg-se/vdt/backup/vdt/vdt-app-data/gratia/probe/gridftp-transfer/

ProbeConfig_002_20090910-154411&#58;
SiteName=&#34;dev-0-0.local&#34;
osg-se/vdt-app-data/gratia/probe/gridftp-transfer/ProbeConfig&#58;
ProbeName=&#34;gridftp-transfer&#58;dev-0-0.local&#34;
Please let me know what other information you need from me, I
would

like to
get this solved. I just want the Bestman/Gridftp
installations to

take
the uscms1-se.fltech-grid3.fit.edu address as default. Here is
the
configuration I used for bestman.
$VDT_LOCATION/vdt/setup/configure_bestman --server y &#92;
--user daemon &#92;
--cert /etc/grid-security/containercert.pem &#92;
--key  /etc/grid-security/containerkey.pem &#92;
--http-port 8080 &#92;
--https-port 8443 &#92;
--gums-host uscms1.fltech-grid3.fit.edu &#92;
--gums-port 8443 &#92;
--enable-gateway &#92;
--with-allowed-paths=/mnt/nas0/OSG/BeStMan &#92;
--with-transfer-servers
<a href='gsiftp&#58;//uscms1-se.fltech-grid3.fit.edu' target='_blank' rel='nofollow'>gsiftp&#58;//uscms1-se.fltech-grid3.fit.edu</a>

Please help, SRM transfers with FNAL will not work unless
this is

fixed.
-Patrick

==================================
Patrick Ford
System Administrator - FLTECH/T3_US_FIT
Experimental High Energy Physics
Florida Institute of Technology
==================================
</div><script type='text/javascript'>
        $('#show_408907445').click(function() {
            $('#detail_408907445').slideDown("normal");
            $('#show_408907445').hide();
            $('#hide_408907445').show();
        });
        $('#hide_408907445').click(function() {
            $('#detail_408907445').slideUp();
            $('#hide_408907445').hide();
            $('#show_408907445').show();
        });
        </script></pre></div><legend>Similar Recent Tickets <small>modified within the last 30 days</small></legend><div id="similar_tickets"><p class="muted">No similar tickets found.</p></div>
</div>
<script type="text/javascript">
function reset_anchor() {
    $("#updates .selected").removeClass("selected");
    var urls = document.location.toString().split('#'); 
    var anchor = urls[1];
    if(anchor) {
        $("a[name='"+anchor+"']").parents(".update_description").addClass("selected");
    }
}
function submitspam(ticket_id) {
    myret = confirm("Would you like to close this ticket as a security ticket, and submit the ticket content to akismet?");
    if(myret == true) {
        $.ajax("viewer/processspam?id="+ticket_id).done(function() {
            window.location.reload();
        });
    }
}

$(function() {
    reset_anchor();
    var ADDITIONAL_COOKIE_NAME = 'gocticket';
    var options = { path: '/', expires: 365};

    if(window.opener && window.opener.name == "gocticket_list") {
        v = $.cookie("closewindow");
        if(!v) {
            $("#closewindow").attr("checked", "checked"); //on by default
        } else {
            if(v == "checked") {
                $("#closewindow").attr("checked", "checked");
            }
        }
        $("#closewindow").click(function() {
            $.cookie("closewindow", $(this).attr('checked'), options);
        });
    } else {
        $("#closewindow_area").hide();
    }
    function updateTimeago() {
        $("time").timeago();
        setTimeout(updateTimeago, 30*1000);
    }
    updateTimeago();
    $(".description").focus(expand_description);
});
</script>
<hr/>
<footer>
<p>GOC Ticket Version 2.2 | <a href="https://ticket.opensciencegrid.org/goc/submit?app_issue_check=on&amp;app_issue_type=goc&amp;app_goc_url=https%3A%2F%2Fticket.opensciencegrid.org%3A443%2F7477">Report Bugs</a>
 | <a href="https://github.com/opensciencegrid/operations/blob/master/docs/privacy.md">Privacy Policy</a>
</p>

<p> <img align="top" src="images/tag_orange.png"/> Copyright 2018 The Trustees of Indiana University - Developed for Open Science Grid</p>
</footer>


</div><!--container-fluid-->
<script>
var chat = io.connect('https://ticket1.grid.iu.edu:8443');
chat.on('connect', function() {
    chat.emit('authenticate', {nodekey:'', ticketid: 7477});
});
chat.on('peers', function(peers) {
    $("#peers").html("");
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('peer_disconnect', function(pid) {
    $("#peer_"+pid).hide("slow");
});
chat.on('peer_connected', function(peers) {
    //expect only 1 peer connecting, but..
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('submit', function() {
    if(confirm("This ticket was updated. Do you want to refresh?")) {
        history.go(0);
    }
});

function addPeer(pid, peer) {
    var ipinfo = "";
    if(peer.ip != undefined) {
        ipinfo = "<span class=\"ip\">"+peer.ip+"</span>";
    }
    if(chat.io.engine.id == pid) {
        //don't display myself
        return;
    }
    var html = "<li class=\"new\" id=\"peer_"+pid+"\" class=\"peer\">"+peer.name+ipinfo+"</li>";
    $("#peers").prepend(html);
    $("#peers .new").animate({bottom: 0}, 1000, function() {$(this).removeClass("new")});
}

$(function() {
    $("#ticket_form").submit(function() {
        chat.emit('submit');
        return true;
    });
});
</script>
<script>
//used by searchbox
function parseValue(value) {
    var obj = new Object();
    var tokens = value.split("\t");
    obj.str = tokens[0];
    obj.count = tokens[1];
    return obj;
}

$(function() {
    //bootstrap-2.0.4 stuff
    $(".alert-message").alert();
    $(".dropdown-toggle").dropdown();
    $("span[rel='tooltip']").tooltip();
    $("a[rel=popover]").popover();

    //activate menu that user is currently on
    $("#menu_navigator").addClass("active"); 
    $("#submenu_").addClass("active"); 

    //translate zend validation error message to bootstrap
    $(".errors").addClass("alert").addClass("alert-error");

    //enable autocomplete for search box
    $("#search").autocomplete({
        source: function( request, response ) {
            $.ajax({
                url: "search/autocomplete",
                dataType: "text",
                data: {
                    //featureClass: "P",
                    //style: "full",
                    //maxRows: 12,
                    //name_startsWith: request.term
                    q: request.term
                },
                success: function( data ) {
                    response( $.map( data.split("\n"), function( item ) {
                        if(item == "") return null;
                        return {
                            value: item
                        }
                    }));
                }
            });
        },
        select: function(event, ui) {
            document.location = "search?q="+ui.item.value;
        }
    });
    
});
</script>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-69012-13");
pageTracker._trackPageview();
} catch(err) {}
</script>

</body>
