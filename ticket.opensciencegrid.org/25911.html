<!DOCTYPE html>
<html lang="en">
  <head>
  <base href="">
    <title>[25911] cvmfs upgrade</title>    <meta charset="utf-8" />
    <meta name="verify-v1" content="na5IcAJsZVOfEkboRxuIiZ1zpZgnZiWra+nKcS7nA/o=" />
    <meta name="google-site-verification" content="DLrk3ft4s8b-S2TloLCL2LD_t6wcTjgSluf5pmiu2kA" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />

    <style type="text/css">
      body {
        padding-top: 50px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
     #search {
            width: 300px;
     }

    </style>

<script src="https://code.jquery.com/jquery-3.0.0.js"></script>
<script src="https://code.jquery.com/jquery-migrate-3.0.1.js"></script>

   <link href="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet"/>
    <script src="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/js/bootstrap.min.js"></script>

    <link href="https://netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"/>
    <link href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/themes/smoothness/jquery-ui.min.css" rel="stylesheet"/>
 <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>


    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/js/select2.min.js"></script>

    <link href="css/ticket.css" rel="stylesheet" />
    <script src="lib/jquery.cookie.js"></script>

    <link href="images/tag_orange.png" rel="icon" type="image/png"/>
  </head>

  <body>
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>

            <a class="brand" style="padding: 6px 0px 0px 6px;" href="http://opensciencegrid.org"><img src="images/osglogo.40x30.png"/></a>
            <ul class="nav">
                <li class="dropdown"><a href="https://ticket.opensciencegrid.org/#" class="dropdown-toggle" data-toggle="dropdown">GOC Ticket <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    <li><a href="https://my.opensciencegrid.org">MyOSG</a></li>
                    <li><a href="https://oim.opensciencegrid.org">OIM</a></li>
                    <li class="active"><a href="https://ticket.opensciencegrid.org/index">Ticket</a></li>
	<li class="divider"></li>
	<li><a href="http://repo.grid.iu.edu">Repo</a></li>
	<li class="divider"></li>
	<li><a href="http://blogs.grid.iu.edu">Blog</a></li>
                    <li><a href="http://display.grid.iu.edu">Display</a></li>
                    <li><a href="http://osggoc.blogspot.com/">News</a></li>
                    </ul>
                </li>
            </ul>
            <ul class="nav pull-right">
                <li><a href="https://ticket.opensciencegrid.org/sso/">Login</a></li>            </ul>

            <div class="nav-collapse">
                <ul class="nav">
			 <li id="menu_submit"><a href="https://ticket.opensciencegrid.org/submit">Submit</a></li><li id="menu_view" class="dropdown"><a href="https://ticket.opensciencegrid.org/\#" class="dropdown-toggle" data-toggle="dropdown">View <b class="caret"></b></a><ul class="dropdown-menu"><li id="submenu_listopen"><a href="https://ticket.opensciencegrid.org/list/open">Open Tickets</a></li><li id="submenu_listrecentclose"><a href="https://ticket.opensciencegrid.org/list/recentclose">Recently Closed Tickets</a></li><li class="divider"></li><li id="submenu_alltickets"><a href="https://ticket.opensciencegrid.org/search?q=&amp;sort=id">All Tickets</a></li></ul></li>                </ul>

                <form class="navbar-search pull-right" action="https://ticket.opensciencegrid.org/viewer">
                    <input id="search" type="text" name="id" class="search-query span2" placeholder="Search Ticket" value=""/>
                </form>
            </div>
        </div>
      </div>
    </div>

<script type='text/javascript' src='lib/jquery.timeago.js'></script>
<script type='text/javascript' src='lib/byte2size.js'></script>
<style>
#updates .toolbar {
position: relative;
margin-top: 0px;
top: -10px;
font-weight: normal;
}
#updates a.anchor {
position: relative;
top: -50px;
}
#updates .selected pre {
animation:selected 2s;
animation-iteration-count: 2;
animation-direction: alternate;
-webkit-animation:selected 2s; 
-webkit-animation-iteration-count: 2;
-webkit-animation-direction: alternate;
box-shadow: inset 1px 1px 20px #9ad;
border: 1px solid #9ab;
margin: 5px 0px;
padding-left: 10px;
}
@keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ab;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
@-webkit-keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ad;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
#updates pre {
background-color: inherit;
line-height: 15px;
padding: 5px;
}
#updates .header {
color: #999;
}
#updates .update_history pre {
background-color: #eee;
color: #666;
font-size: 85%;
}
#updates .clickable {
cursor: pointer;
}
#updates .clickable:hover {
color: #D98719;
}
#updates .meta_information pre {
background-color: #fed;
}
#similar_tickets {
max-height: 300px;
overflow-y: auto;
pointer-events: none;
padding: 5px;
background-color: #f4f4f4;
}
.btn-toolbar {
margin-bottom: 0;
height: 30px;
}
#peers {
position: fixed;
bottom: 0px;
right: 0px;
z-index: 100;
list-style: none;
padding: 5px 0px 0px 5px;
margin: 0px;
background-color: white;
box-shadow: 0px 0px 10px white;
}
#peers li {
background-color: #ccc;
color: #000;
display: inline-block;
padding: 5px 10px;
margin-right: 5px;
position: relative;
}
/*
#peers li:hover {
background-color: #999;
cursor: pointer;
}
*/
#peers span.ip {
padding-left: 5px;
color: #666;
}
#peers .new {
bottom: -30px;
}
/*
#peers .me {
background-color: red;
}
*/
</style>

<div class="container-fluid">
<ul id="peers"></ul>
<div class="alert alert-danger"><a class="close" href="https://ticket.opensciencegrid.org/#" data-dismiss="alert">&times;</a>By the end of May 2018, the ticketing system at https://ticket.opensciencegrid.org will be retired and support will be provided at https://support.opensciencegrid.org. Throughout this transition the support email (help@opensciencegrid.org) will be available as a point of contact.<br><br>                                                   
                                                                                                                                                                                   
Please see the service migration page for details: https://opensciencegrid.github.io/technology/policy/service-migrations-spring-2018/#ticket</div><div id="presence" class="pull-right"></div><div class="ticketgui"><script type="text/javascript" src="lib/checktab.js"></script>

<script>
var expanded = false;
function expand_description() {
    var desc = $(".description");
    if(!expanded) {
        expanded = true;
        //expand to minheight
        var min = 250;
        if(desc.height() < min) {
            desc.animate({height: min}, 200);
        }
    }
}

$(document).ready(function() {
    $("input[name='nad']").datepicker({
        dateFormat: 'yy-mm-dd'
    });
});

</script>



<style>
.form-horizontal .control-label {
padding-top: inherit;
font-size:90%;
color:#666;
}
label {
margin-bottom: 0px;
}
.controls {
line-height: 18px;
}
</style>
<form class="form-horizontal" action="https://ticket.opensciencegrid.org/viewer/updatebasic?id=25911" method="post">
<div class="page-header">
    <h3><span class="muted">25911</span> / cvmfs upgrade</h3>
</div>

<div class="row-fluid">
<div class="span5">
    <legend>Contact</legend>
    <div class="control-group">
        <label class="control-label">Full Name</label>
        <div class="controls">Serguei Fedorov</div>
    </div>
    <div class="control-group">
        <label class="control-label">Email</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">Phone</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">CC</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>

    <legend>Details</legend>
    <div class="control-group"><label class="control-label">Submitted Via</label><div class="controls">GOC Ticket/submit</div></div><div class="control-group"><label class="control-label">Submitter</label><div class="controls">Serguei Fedorov</div></div><div class="control-group"><label class="control-label">Ticket Links</label><div class="controls"></div></div>
    <div class="control-group">
        <label class="control-label">Ticket Type</label>
        <div class="controls">Problem/Request</div>
    </div>
    <div class="control-group">
        <label class="control-label">Priority</label>
        <div class="controls">Normal</div>
    </div>
    <div class="control-group">
        <label class="control-label">Status</label>
        <div class="controls">
Closed</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action</label>
        <div class="controls">Software Triage</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action Deadline</label>
        <div class="controls flag_red">2015-06-22</div>
    </div>

</div><!--span-->
<div class="span7">
    <legend>Assignees</legend>
    <div class="assignee" style="width: 60%">Dave Dykstra <span class="muted"> / OSG Security Coordinators</span></div><div class="assignee" style="width: 60%">Software Support (Triage) <span class="muted"> / OSG Software Team</span></div>    <br>

    <legend>Assignees</legend>
    TODO
    <br>

    <style>
legend.noborder {
border-bottom: none;
}
</style>

<div id="attachment-list"/>
<script>
$(function () {
    var first = true;
    $.getJSON("attachment/list/25911", function (files) {
        //console.dir(files);
        var html = "<table class=\"table table-condensed\">";
        $(files).each(function() {
            if(first) {
                first = false;
                html += "<legend class=\"noborder\">Attachmenets</legend>";
            }
            html += "<tr class=\"attachment\">";
            html += "<td><img src=\""+this.thumbnail_url+"\"/></td>";
            html += "<td><a href=\""+this.url+"\" target=\"_blank\">"+this.name+"</a></td>";
            html += "<td>"+bytesToSize(this.size, 1)+"</td>";
            html += "</tr>";
        });
        html += "</table>";
        $("#attachment-list").html(html);
    });
});

function download(url) {
    window.open(url, "_blank");
}
</script>


</div><!--span-->
</div><!--row-fluid-->


</form>

</div>
<div id="updates" style="clear: both;">
    <legend>Past Updates
    <div class="btn-toolbar pull-right toolbar">
    </div><!--btn-toolbar-->
    </legend>

    <div class='update_description'><i onclick="document.location='25911#1434746992'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-06-19T20:49:52+00:00">Jun 19, 2015 08:49 PM UTC</time><a class="anchor" name="1434746992">&nbsp;</a></div><pre>Please close it

-Serguei

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=Serguei Fedorov 787</pre></div><div class='update_description'><i onclick="document.location='25911#1434745458'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-06-19T20:24:18+00:00">Jun 19, 2015 08:24 PM UTC</time> by <b>Suchandra Thapa</b><a class="anchor" name="1434745458">&nbsp;</a></div><pre>Hi Serguei,

Would you mind if we closed this?

Suchandra</pre></div><div class='update_description'><i onclick="document.location='25911#1434730932'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-06-19T16:22:12+00:00">Jun 19, 2015 04:22 PM UTC</time> by <b>Dave Dykstra</b><a class="anchor" name="1434730932">&nbsp;</a></div><pre>I created an upstream ticket for this <a href='https&#58;//sft.its.cern.ch/jira/browse/CVM-869.' target='_blank' rel='nofollow'>https&#58;//sft.its.cern.ch/jira/browse/CVM-869.</a>  Since the operational issue is solved, this ticket can be closed.</pre></div><div class='update_description'><i onclick="document.location='25911#1434728811'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-06-19T15:46:51+00:00">Jun 19, 2015 03:46 PM UTC</time> by <b>Dave Dykstra</b><a class="anchor" name="1434728811">&nbsp;</a></div><pre>The hang during the upgrade is a good hint.  I see that the rpm %post procedure does a cvmfs_config reload.    I will continue to try to reproduce it.</pre></div><div class='update_description'><i onclick="document.location='25911#1434726975'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-06-19T15:16:15+00:00">Jun 19, 2015 03:16 PM UTC</time><a class="anchor" name="1434726975">&nbsp;</a></div><pre>As far as I remember I did not use  &#39;cvmfs_config reload&#39; command, or may be once  accidentally on the one host.  But for sure I did not use that command on all of them.
But I got the  problem on the several hosts ( may be ~ 10 of them), not only on that one.  All of the problematic hosts I just have rebuilt and did clean cvmfs install.
The most critical &#34;eddie&#34; I fixed yesterday by removing /var/run/cvmfs/cvmfs.pause  directory.  There was nothing else in  /var/root/cvmfs, just that cvmfs.pause directory.

When I followed the documented OSG procedure and got the problem it was on the step when new cvmfs rpm was being installed/updated.
The upgrade stopped there and nothing happened even after 30-40 minutes, and I had to press ctrl-c to interrupt the upgrade.

-Serguei

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=Serguei Fedorov 787</pre></div><div class='update_description'><i onclick="document.location='25911#1434725243'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-06-19T14:47:23+00:00">Jun 19, 2015 02:47 PM UTC</time> by <b>Dave Dykstra</b><a class="anchor" name="1434725243">&nbsp;</a></div><pre>Serguei,

If I use your instructions, cvmfs.pause does not get created.  I don&#39;t get a hang even if access another cvmfs directory in between your cvmfs_config umount and service autofs stop.  In fact the only place that cvmfs.pause is created or used is the &#39;cvmfs_config reload&#39; command.  Did you run that somewhere in there?  Even with that, I don&#39;t see how it alone keeps a mount from happening, it just prevents another reload.  Was there anything else in /var/run/cvmfs that you cleaned up?

Dave</pre></div><div class='update_description'><i onclick="document.location='25911#1434724979'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-06-19T14:42:59+00:00">Jun 19, 2015 02:42 PM UTC</time><a class="anchor" name="1434724979">&nbsp;</a></div><pre>Dave,

I think if you try to use my instruction (re-installation with reboot) most likely you will not be able to reproduce the problem, even if cvmfs is actively used.

I got the problem at the beginning only when I followed OSG documented instruction to upgrade&#58; <a href='https&#58;//twiki.grid.iu.edu/bin/view/Documentation/Release3/InstallCvmfs#3_4_Upgrading' target='_blank' rel='nofollow'>https&#58;//twiki.grid.iu.edu/bin/view/Documentation/Release3/InstallCvmfs#3_4_Upgrading</a>
My guess is that happened when cvmfs was actively used on the host during the upgrade opportunistically.  For some hosts I did not have problem even when I used OSG documents.

-Serguei

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=Serguei Fedorov 787</pre></div><div class='update_description'><i onclick="document.location='25911#1434723397'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-06-19T14:16:37+00:00">Jun 19, 2015 02:16 PM UTC</time> by <b>Dave Dykstra</b><a class="anchor" name="1434723397">&nbsp;</a></div><pre>Serguei,

That&#39;s a good find!

What I would like to do next is to find out how to reproduce the situation where /var/run/cvmfs/cvmfs.pause gets left there.  You posted a set of instructions on your upgrade procedure.  I think that was the procedure you used initially, but to be perfectly clear, are you saying that&#39;s what you did before you noticed the problem?  Or is that something you did to try to avoid the problem?  I will try your instructions.  I don&#39;t think you would have had the problem if you had simply replaced osg-release and did a yum install osg-oasis.

I believe the root cause is a similar problem to the one reported at <a href='https&#58;//sft.its.cern.ch/jira/browse/CVM-810' target='_blank' rel='nofollow'>https&#58;//sft.its.cern.ch/jira/browse/CVM-810</a> but for a different lock file, this one on the client.

Dave</pre></div><div class='update_description'><i onclick="document.location='25911#1434686774'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-06-19T04:06:14+00:00">Jun 19, 2015 04:06 AM UTC</time> by <b>serguei.fedorov.1@....</b><a class="anchor" name="1434686774">&nbsp;</a></div><pre>Hello,

I think the issue is resolved.
There was a directory  /var/run/cvmfs/cvmfs.pause, dated  as 06/16/2015
(when the problem occured)

Since I removed&#58;  rm -rf /var/run/cvmfs, cvmfs started to work on the host.

[root@eddie ~]# ls -lrt /cvmfs/cms.cern.ch
total 2936
drwxr-xr-x   9 cvmfs 113   4096 Oct  8  2009 slc5_ia32_gcc434
drwxr-xr-x   7 cvmfs 113   4096 Dec  3  2009 COMP
-rw-rw-r--   1 cvmfs 113 237768 Mar 17  2011 bootstrap_slc5_amd64_gcc434.log
-rw-rw-r--   1 cvmfs 113 235789 Mar 18  2011 bootstrap_slc5_ia32_gcc434.log
drwxr-xr-x   9 cvmfs 113   4096 Oct 26  2011 slc5_amd64_gcc461
-rw-rw-r--   1 cvmfs 113 224804 Dec 19  2011 bootstrap_slc5_amd64_gcc461.log
drwxr-xr-x   9 cvmfs 113   4096 Feb 13  2012 osx107_amd64_gcc462
-rw-rw-r--   1 cvmfs 113 230682 Feb 15  2012 bootstrap_slc5_amd64_gcc462.log

....

[root@eddie ~]# cvmfs_config probe
Probing /cvmfs/atlas.cern.ch... OK
Probing /cvmfs/atlas-condb.cern.ch... OK
Probing /cvmfs/lhcb.cern.ch... OK
Probing /cvmfs/cms.cern.ch... OK
Probing /cvmfs/oasis.opensciencegrid.org... OK
Probing /cvmfs/cms.cern.ch... OK

I see that only one who had experience of weird cvmfs  behavior  - hanging .

I would recommend to put in cvmfs troubleshooting recommendation to check
if /var/run/cvmfs/cvmfs.pause exists.
It looks like the existance of that directory blocks cvmfs and even
complete cvmfs re-installation does not help.
<div id='show_863621549' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_863621549'>
-Serguei

On Thu, Jun 18, 2015 at 11&#58;03 PM, Open Science Grid FootPrints &#60;
osg@....&#62; wrote&#58;

<font color='#7F7E6F'>&#62;  [Duplicate message snipped]</font>
</div><script type='text/javascript'>
        $('#show_863621549').click(function() {
            $('#detail_863621549').slideDown("normal");
            $('#show_863621549').hide();
            $('#hide_863621549').show();
        });
        $('#hide_863621549').click(function() {
            $('#detail_863621549').slideUp();
            $('#hide_863621549').hide();
            $('#show_863621549').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='25911#1434682989'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-06-19T03:03:09+00:00">Jun 19, 2015 03:03 AM UTC</time> by <b>serguei.fedorov.1@....</b><a class="anchor" name="1434682989">&nbsp;</a></div><pre>I forgot to say that /var/log/messages has nothing which could help&#58;

Jun 18 22&#58;17&#58;15 eddie yum[13664]&#58; Installed&#58;
cvmfs-config-osg-1.1-6.osg32.el6.noarch
Jun 18 22&#58;17&#58;16 eddie yum[13664]&#58; Installed&#58;
1&#58;autofs-5.0.5-109.el6_6.1.x86_64
Jun 18 22&#58;17&#58;38 eddie yum[13664]&#58; Installed&#58; cvmfs-2.1.20-1.osg32.el6.x86_64
Jun 18 22&#58;17&#58;38 eddie yum[13664]&#58; Installed&#58; osg-oasis-5-1.osg32.el6.noarch
Jun 18 22&#58;19&#58;31 eddie automount[14671]&#58; lookup_read_master&#58;
lookup(nisplus)&#58; couldn&#39;t locate nis+ table auto.master

I re-installed/upgraded cvmfs from osg3.1 to osg3.2  on the 90 servers
today using following pocedure&#58;

rpm -e osg-release
rm -rf /etc/cvmfs/domain.d/cern.ch.local
chkconfig autofs off
cvmfs_config umount
service autofs stop
rm -rf /var/cache/cvmfs/*.*
yum remove -y osg-oasis
yum remove -y cvmfs
yum remove -y cvmfs-keys
rm -rf /var/cache/cvmfs/*.*
reboot

After reboot.....

rm -rf /etc/cvmfs/domain.d/cern.ch.local
rpm -Uvh <a href='http&#58;//repo.grid.iu.edu/osg/3.2/osg-3.2-el6-release-latest.rpm' target='_blank' rel='nofollow'>http&#58;//repo.grid.iu.edu/osg/3.2/osg-3.2-el6-release-latest.rpm</a>
yum clean all
yum install -y osg-oasis
service autofs restart
chkconfig autofs on
ls -lrt /cvmfs
<div id='show_476752849' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_476752849'>ls -lrt /cvmfs/cms.cern.ch

that worked perfect.

But when I used upgrade procedure in the documentation yesterday it caused
the same hanging problems (on some servers) and nothing helped.

-Serguei

On Thu, Jun 18, 2015 at 10&#58;45 PM, Open Science Grid FootPrints &#60;
osg@....&#62; wrote&#58;

<font color='#7F7E6F'>&#62;  [Duplicate message snipped]</font>
</div><script type='text/javascript'>
        $('#show_476752849').click(function() {
            $('#detail_476752849').slideDown("normal");
            $('#show_476752849').hide();
            $('#hide_476752849').show();
        });
        $('#hide_476752849').click(function() {
            $('#detail_476752849').slideUp();
            $('#hide_476752849').hide();
            $('#show_476752849').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='25911#1434681911'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-06-19T02:45:11+00:00">Jun 19, 2015 02:45 AM UTC</time> by <b>serguei.fedorov.1@....</b><a class="anchor" name="1434681911">&nbsp;</a></div><pre>Dave,

Troubleshooting steps did not help&#58;

[root@eddie ~]# cvmfs_config bugreport
Gathering /etc/cvmfs
Gathering files in quarantaine
ls&#58; cannot access /var/cache/cvmfs&#58; No such file or directory
Gathering stack traces
ls&#58; cannot access /var/cache/cvmfs&#58; No such file or directory
Gathering uname -a
Gathering cat /etc/issue
Gathering hostname -f
Gathering ifconfig -a
Gathering cvmfs2 --version
Gathering grep cvmfs2 /var/log/messages
Gathering grep cvmfs2 /var/log/syslog
Gathering eval find /var/cache/cvmfs -maxdepth 1 -exec ls -lah &#92;{&#92;} &#92;;
Gathering cvmfs_config probe

----- It hangs here

From the different screen

[root@eddie ~]# ps aux|grep cvmfs

root      14702  0.0  0.0 111744   872 ?        S    22&#58;20   0&#58;00
/bin/mount -t cvmfs cms.cern.ch /cvmfs/cms.cern.ch
root      14703  0.0  0.0  14128  1176 ?        S    22&#58;20   0&#58;00
/sbin/mount.cvmfs cms.cern.ch /cvmfs/cms.cern.ch -o rw
root      16523  0.0  0.0 106496  1752 pts/1    S+   22&#58;29   0&#58;00 /bin/bash
/usr/bin/cvmfs_config bugreport
root      16601  0.0  0.0 106496  1708 pts/1    S+   22&#58;29   0&#58;00 /bin/bash
/usr/bin/cvmfs_config probe
root      16677  0.0  0.0 100976   560 pts/1    S+   22&#58;29   0&#58;00 df -P
<div id='show_773156240' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_773156240'>/cvmfs/atlas.cern.ch
root      16678  0.0  0.0 103252   840 pts/1    S+   22&#58;29   0&#58;00 grep -q
^cvmfs2
root      16681  0.0  0.0 111744   876 ?        S    22&#58;29   0&#58;00
/bin/mount -t cvmfs atlas.cern.ch /cvmfs/atlas.cern.ch
root      16682  0.0  0.0  14128  1172 ?        S    22&#58;29   0&#58;00
/sbin/mount.cvmfs atlas.cern.ch /cvmfs/atlas.cern.ch -o rw
root      17327  0.0  0.0 103256   864 pts/0    S+   22&#58;33   0&#58;00 grep cvmfs

Then I did&#58;  kill  16601

On the first screen

/usr/bin/cvmfs_config&#58; line 1100&#58; 16601 Terminated              $cmd &#62;&#62;
$out 2&#62; $err
Gathering mount
Gathering df -h
Gathering ps -ef
Gathering cvmfs_config status
Gathering cvmfs_config showconfig
Gathering cvmfs_config chksetup
Gathering cvmfs_config stat -v
Gathering cvmfs_talk internal affairs
Gathering cat /etc/fuse.conf
Gathering ls -la /usr/bin/fusermount
Gathering ls -la /bin/fusermount
Gathering cat /etc/auto.master
Gathering cat /etc/sysconfig/autofs
Gathering cat /etc/default/autofs
Gathering cat /etc/fstab
Gathering cat /etc/exports
Gathering cat /proc/mounts
Gathering cat /proc/cpuinfo
Gathering cat /etc/hosts
Gathering free -m

System information has been collected in
/tmp/cvmfs-bugreport.UYt2Wy/cvmfs-bugreport.tar.gz
Please attach this file to your problem description and send it as a
JIRA bug report to <a href='https&#58;//sft.its.cern.ch/jira/browse/CVM' target='_blank' rel='nofollow'>https&#58;//sft.its.cern.ch/jira/browse/CVM</a>

I do not have certificate now to use attachement , so I will send
cvmfs-bugreport.tar.gz to your fnal e-mail address

-Serguei

On Thu, Jun 18, 2015 at 10&#58;09 PM, Open Science Grid FootPrints &#60;
osg@....&#62; wrote&#58;

<font color='#7F7E6F'>&#62;  [Duplicate message snipped]</font>
</div><script type='text/javascript'>
        $('#show_773156240').click(function() {
            $('#detail_773156240').slideDown("normal");
            $('#show_773156240').hide();
            $('#hide_773156240').show();
        });
        $('#hide_773156240').click(function() {
            $('#detail_773156240').slideUp();
            $('#hide_773156240').hide();
            $('#show_773156240').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='25911#1434679746'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-06-19T02:09:06+00:00">Jun 19, 2015 02:09 AM UTC</time> by <b>Dave Dykstra</b><a class="anchor" name="1434679746">&nbsp;</a></div><pre>Oh.  I thought you were showing two different views of the same problem.  Ok.  The re-install of the fuse rpm would have fixed the fusermount group.

So for the el6 hanging problem, are there are messages in /var/log/messages?   Try to also going through the steps that I showed in the Troubleshooting section.  If that doesn&#39;t help and you get to the part of making a bugreport for me, it will probably hang again.  Just go to another window and try to find out which process under cvmfs_config is hanging and kill it.  You&#39;ll likely have to do it more than once.

I did test upgrading from osg31 cvmfs-2.1.19 to osg32 cvmfs-2.1.20, but there must be something different about your installation.</pre></div><div class='update_description'><i onclick="document.location='25911#1434677950'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-06-19T01:39:10+00:00">Jun 19, 2015 01:39 AM UTC</time> by <b>serguei.fedorov.1@....</b><a class="anchor" name="1434677950">&nbsp;</a></div><pre>Hi Dave,

The issue with RedHat5 and &#34;failed to create Fuse channel&#34; was resolved by
uninstalling FUSE and installing it back yesterday.  The command fusermount
did not help.

The original issue that is related to hanging ls /cvmfs/cms.cern.ch and and
any other cvmfs repositories still exists.
It happens only with some machines when I do upgrade cvmfs of osg3.1  to
cvmfs osg3.2.  The freshe install cvmfs of any version works fine.

-Serguei

On Thu, Jun 18, 2015 at 9&#58;17 PM, Open Science Grid FootPrints &#60;
osg@....&#62; wrote&#58;

<font color='#7F7E6F'>&#62;  [Duplicate message snipped]</font></pre></div><div class='update_description'><i onclick="document.location='25911#1434676650'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-06-19T01:17:30+00:00">Jun 19, 2015 01:17 AM UTC</time> by <b>Dave Dykstra</b><a class="anchor" name="1434676650">&nbsp;</a></div><pre>Hi Serguei,

Whenever I have seen the &#34;failed to create Fuse channel&#34; error in the past it was a problem with /bin/fusermount.  It is supposed to be owned by root and group fuse&#58;
$ ls -l /bin/fusermount
-rwsr-x--- 1 root fuse 27072 Sep  2  2009 /bin/fusermount

Sometimes people change the fuse group value after the fuse package is installed, and it gets confused.  The cvmfs install should put the cvmfs user into the fuse group in /etc/group.  It&#39;s strange that it happened in conjunction with an upgrade, but maybe you made another change around the same time?

If that&#39;s not the problem, next follow the instructions at
<a href='https&#58;//twiki.grid.iu.edu/bin/view/Documentation/Release3/InstallCvmfs#5_1_Troubleshooting_problems' target='_blank' rel='nofollow'>https&#58;//twiki.grid.iu.edu/bin/view/Documentation/Release3/InstallCvmfs#5_1_Troubleshooting_problems</a>
and see if that helps track down the problem.  If you still can&#39;t figure it out, do cvmfs_config bugreport and attach the tarball it creates to this ticket and I&#39;ll take a look.

Dave</pre></div><div class='update_description'><i onclick="document.location='25911#1434664975'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-06-18T22:02:55+00:00">Jun 18, 2015 10:02 PM UTC</time> by <b>Suchandra Thapa</b><a class="anchor" name="1434664975">&nbsp;</a></div><pre>Hi Dave,

Do you think you might have some tips for this?

Suchandra</pre></div><div class='update_description'><i onclick="document.location='25911#1434556517'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-06-17T15:55:17+00:00">Jun 17, 2015 03:55 PM UTC</time> by <b>Christopher Pipes</b><a class="anchor" name="1434556517">&nbsp;</a></div><pre>Hi Serguei,

I talked to Scott and he said that this should be in the right place for now. I&#39;ll let the software team review this for now and if I find out more I&#39;ll be sure to update the ticket.

Thanks,
Chris</pre></div><div class='update_description'><i onclick="document.location='25911#1434555631'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-06-17T15:40:31+00:00">Jun 17, 2015 03:40 PM UTC</time><a class="anchor" name="1434555631">&nbsp;</a></div><pre>For RedHat5

When I issue the command&#58;

ls /cvmfs/cms.cern.ch
ls&#58; /cvmfs/cms.cern.ch&#58; No such file or directory

in /var/log/messages the log says&#58;

Jun 17 11&#58;35&#58;14 ndcms cvmfs2&#58; (cms.cern.ch) GeoAPI request <a href='http&#58;//cernvmfs.gridpp.rl.ac.uk/cvmfs/cms.cern.ch/api/v1.0/geo/' target='_blank' rel='nofollow'>http&#58;//cernvmfs.gridpp.rl.ac.uk/cvmfs/cms.cern.ch/api/v1.0/geo/</a>@proxy@/cernvmfs.gridpp.rl.ac.uk,cvmfs-stratum-one.cern.ch,cvmfs.fnal.gov,cvmfs.racf.bnl.gov,cvmfs02.grid.sinica.edu.tw failed with error 8 [proxy returned HTTP error]
Jun 17 11&#58;35&#58;14 ndcms cvmfs2&#58; (cms.cern.ch) geographic order of servers retrieved from cvmfs.fnal.gov
Jun 17 11&#58;35&#58;15 ndcms cvmfs2&#58; (cms.cern.ch) failed to create Fuse channel
Jun 17 11&#58;37&#58;01 ndcms cvmfs2&#58; (cms.cern.ch) geographic order of servers retrieved from cvmfs02.grid.sinica.edu.tw
Jun 17 11&#58;37&#58;01 ndcms cvmfs2&#58; (cms.cern.ch) failed to create Fuse channel
Jun 17 11&#58;37&#58;01 ndcms cvmfs2&#58; (oasis.opensciencegrid.org) GeoAPI request <a href='http&#58;//cvmfs-s1bnl.opensciencegrid.org&#58;8000/cvmfs/oasis.opensciencegrid.org/api/v1.0/geo/' target='_blank' rel='nofollow'>http&#58;//cvmfs-s1bnl.opensciencegrid.org&#58;8000/cvmfs/oasis.opensciencegrid.org/api/v1.0/geo/</a>@proxy@/cvmfs-s1bnl.opensciencegrid.org,cvmfs-s1fnal.opensciencegrid.org,cvmfs-s1goc.opensciencegrid.org failed with error 9 [host returned HTTP error]
Jun 17 11&#58;37&#58;01 ndcms cvmfs2&#58; (oasis.opensciencegrid.org) geographic order of servers retrieved from cvmfs-s1goc.opensciencegrid.org
Jun 17 11&#58;37&#58;01 ndcms cvmfs2&#58; (oasis.opensciencegrid.org) failed to create Fuse channel

-Serguei

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=Serguei Fedorov 787</pre></div><div class='update_description'><i onclick="document.location='25911#1434550224'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-06-17T14:10:24+00:00">Jun 17, 2015 02:10 PM UTC</time> by <b>Christopher Pipes</b><a class="anchor" name="1434550224">&nbsp;</a></div><pre>Hi Serguei,

I&#39;m talking with Vince right now. He has some experience with cvmfs, I will make sure this gets routed to the correct people. I think software might be able to answer this but I believe this would be handled by another group.

Thanks,
Chris</pre></div><div class='update_description'><i onclick="document.location='25911#1434495950'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2015-06-16T23:05:50+00:00">Jun 16, 2015 11:05 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1434495950">&nbsp;</a></div><pre>Hello,

I have problem to UPGRADE cvmfs to cvmfs 2.1.20  under osg3.2
Since it is upgraded with the new packages and autofs restarted,
I can not access to any cvmfs repository the ls command hangs without output.

ls /cvmfs/cms.cern.ch  (this hangs).    I worked with cvmfs-2.1.19-1.osg31.el6.x86_64
but does not work with  cvmfs-2.1.20-1.osg32.el6.x86_64

[root@d6copt291 ~]# rpm -aq|grep oasis
osg-oasis-5-1.osg32.el6.noarch
[root@d6copt291 ~]# rpm -aq|grep cvmfs
cvmfs-config-osg-1.1-6.osg32.el6.noarch
cvmfs-2.1.20-1.osg32.el6.x86_64
[root@d6copt291 ~]# rpm -aq|grep osg-release
osg-release-3.2-7.osg32.el6.noarch
[root@d6copt291 ~]# cat /etc/cvmfs/default.local
CVMFS_REPOSITORIES=atlas.cern.ch,atlas-condb.cern.ch,lhcb.cern.ch,cms.cern.ch
CVMFS_CACHE_BASE=/var/cache/cvmfs
CVMFS_QUOTA_LIMIT=10000
CVMFS_HTTP_PROXY=<a href='http&#58;//eddie.crc.nd.edu&#58;3128' target='_blank' rel='nofollow'>http&#58;//eddie.crc.nd.edu&#58;3128</a>

Thanks

-Serguei

by /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=Serguei Fedorov 787</pre></div>
</div>
<script type="text/javascript">
function reset_anchor() {
    $("#updates .selected").removeClass("selected");
    var urls = document.location.toString().split('#'); 
    var anchor = urls[1];
    if(anchor) {
        $("a[name='"+anchor+"']").parents(".update_description").addClass("selected");
    }
}
function submitspam(ticket_id) {
    myret = confirm("Would you like to close this ticket as a security ticket, and submit the ticket content to akismet?");
    if(myret == true) {
        $.ajax("viewer/processspam?id="+ticket_id).done(function() {
            window.location.reload();
        });
    }
}

$(function() {
    reset_anchor();
    var ADDITIONAL_COOKIE_NAME = 'gocticket';
    var options = { path: '/', expires: 365};

    if(window.opener && window.opener.name == "gocticket_list") {
        v = $.cookie("closewindow");
        if(!v) {
            $("#closewindow").attr("checked", "checked"); //on by default
        } else {
            if(v == "checked") {
                $("#closewindow").attr("checked", "checked");
            }
        }
        $("#closewindow").click(function() {
            $.cookie("closewindow", $(this).attr('checked'), options);
        });
    } else {
        $("#closewindow_area").hide();
    }
    function updateTimeago() {
        $("time").timeago();
        setTimeout(updateTimeago, 30*1000);
    }
    updateTimeago();
    $(".description").focus(expand_description);
});
</script>
<hr/>
<footer>
<p>GOC Ticket Version 2.2 | <a href="https://ticket.opensciencegrid.org/goc/submit?app_issue_check=on&amp;app_issue_type=goc&amp;app_goc_url=https%3A%2F%2Fticket.opensciencegrid.org%3A443%2F25911">Report Bugs</a>
 | <a href="https://github.com/opensciencegrid/operations/blob/master/docs/privacy.md">Privacy Policy</a>
</p>

<p> <img align="top" src="images/tag_orange.png"/> Copyright 2018 The Trustees of Indiana University - Developed for Open Science Grid</p>
</footer>


</div><!--container-fluid-->
<script>
//used by searchbox
function parseValue(value) {
    var obj = new Object();
    var tokens = value.split("\t");
    obj.str = tokens[0];
    obj.count = tokens[1];
    return obj;
}

$(function() {
    //bootstrap-2.0.4 stuff
    $(".alert-message").alert();
    $(".dropdown-toggle").dropdown();
    $("span[rel='tooltip']").tooltip();
    $("a[rel=popover]").popover();

    //activate menu that user is currently on
    $("#menu_navigator").addClass("active"); 
    $("#submenu_").addClass("active"); 

    //translate zend validation error message to bootstrap
    $(".errors").addClass("alert").addClass("alert-error");

});
</script>


</body>
